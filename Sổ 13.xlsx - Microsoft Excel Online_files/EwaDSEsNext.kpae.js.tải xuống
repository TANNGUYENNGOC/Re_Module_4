'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1079:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1080:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}vs(){return this.command}}Object(u.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[108])},1081:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1082:function(u,F,a){a.d(F,"a",function(){return"FieldInfoListContextLoaded"});a.d(F,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(F,"d",function(){return"Days from Today"});a.d(F,"g",function(){return"Years from Today"});a.d(F,"c",function(){return"Day of the Week"});a.d(F,"f",function(){return"Month of the Year"});a.d(F,"e",function(){return"End of Month"});a.d(F,"b",function(){return"Next Day"})},1083:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>
{c.a.Ni(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1084:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1085:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(u.b)("DataValidationRuleType",c)},1087:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-facp-text-box{position:absolute}")}},1088:function(u,F,a){a.d(F,"b",function(){return"MinorThemeFont"});
a.d(F,"a",function(){return"MajorThemeFont"})},1090:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1091:function(u,F,a){a.d(F,"a",function(){return n});u=a(0);F=a(238);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(34),h=a(4);class n extends F.a{constructor(m){super(document.createElement("div"));this.rR=this.qJa=this.pJa=this.rJa=this.tJa=this.sJa=!1;this.oJ=null;this.visible=void 0;this.spc=(x,r)=>{this.Tt(x,r)};this.CMa=()=>{this.Za.textBox.HF=!0};this.sza=()=>{this.jz(!0)};this.xzf=()=>{this.Za.textBox.focus()};this.Sh=()=>{f.h(this.$).inRangePicker||(this.se=!1)};this.$=m;f.h(m)&&f.h(m).ha&&f.h(this.$).ha.fH(this.Sh);
this.Zk=b.a.k5(m)}get pI(){return this.ou.pI}get se(){return this.ou.se}set se(m){this.ou.se=m}get Za(){return this.oJ}set Za(m){(this.oJ=m)&&this.oJ.O2d.add(this)}get ZIh(){return b.a.DN(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(m){if(this.visible===m)return m;this.visible=m;return super.set_visible(m)}Tt(){this.wCa(!1);this.ou.Tt()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.rL(this.Sh);this.$=null;super.dispose()}Zh(m,
x,r=!1){m=!1;if((this.W1a||r)&&!this.yxa()&&this.get_visible()&&this.se)switch(this.Zk&&this.ADc(x),x){case 1872288872:this.se=!1;m=!0;break;case -798660877:this.ou.CB(1);m=!0;break;case 137938150:this.ou.CB(-1);m=!0;break;case 2091832999:this.ou.CB(this.pI-1);m=!0;break;case 742457698:this.ou.CB(-(this.pI-1));m=!0;break;case 125627505:m=this.jz(!1);break;case 267796030:b.a.k5(this.$)&&(m=this.jz(!1))}return m}wCa(m){if(this.se||m){var x=f.h(this.$);m=x.domElement;var r=this.oJ.textBox.domElement,
y=d.a(this.$).yi(r.offsetHeight),t=d.a(this.$).yi(r.offsetTop),v=d.a(this.$).yi(r.offsetWidth);r=d.a(this.$).yi(r.offsetLeft);x=x.Ul;var w=h.AFrameworkApplication.ta&&h.AFrameworkApplication.ta.Pa.Ve,C=$get(this.$.Eb+c.a.X0a,this.$.domElement);w&&(C=document.getElementById("EditorContainer"));var B=new Sys.UI.Point(x?this.ou.hbc:0,x?this.ZIh:n.F6h);y=C.offsetTop+B.y+(b.a.DN(this.$)&&x?0:y+t);this.$.t_||(t=$get(c.a.Csa,this.$.domElement),y+=t&&!w?t.offsetHeight:0);t=this.domElement;t.style.top=e.HelperMethods.uc(y);
r=C.offsetLeft+r+B.x;!b.a.DN(this.$)&&this.$.isChromeRtl?t.style.right=e.HelperMethods.uc(x?this.ou.hbc:m.offsetLeft+m.offsetWidth-r-v):t.style.left=e.HelperMethods.uc(r)}}dUa(m){this.ou&&(m&&!this.rR?(this.ou.a$(this.xzf),this.ou.d0b(this.CMa),this.ou.Hob(this.sza),this.rR=!0):this.rR&&(this.ou.Kda(this.xzf),this.ou.Puc(this.CMa),this.ou.rKb(this.sza),this.rR=!1))}ADc(m){switch(m){case -798660877:case 137938150:case 2091832999:case 742457698:this.sJa=!0;break;case 125627505:this.rJa=!0;break;case 267796030:b.a.k5(this.$)&&
(this.pJa=!0)}}}n.hbc=0;n.F6h=1;Object(u.a)(n,"AutoCompleteControl",F.a,[236])},1092:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.rG=f;this.description=d}}Object(u.a)(c,"ListEventArgs",Sys.EventArgs,[])},1093:function(u,F,a){a.d(F,"a",function(){return t});u=a(0);var c=a(15),b=a(27);F=a(839);var e=a(777),f=a(5),d=a(76),h=a(33),n=a(12),m=a(1),x=a(117),r=a(21),y=a(911);class t extends F.a{constructor(v,
w){super(v,w,new y.a(e.a.listItem,e.a.zDb,e.a.CDb,e.a.DDb));this.yec=!1;this.Cmb=this.qp=null;this.CZe=!1;this.visible=void 0;this.LBa(!0);this.CZe=m.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get hbc(){if(h.a.DN(this.$)){var v=document.getElementById(this.$.Eb+f.a.BZe);return!this.CZe||v?n.DOMElementExtensions.getBoundingClientRect(v).x:0}v=m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.jAd):document.getElementById(this.$.Eb+
f.a.jAd+"-"+f.a.swf);c.ULS.shipAssertTag(537170323,0,!!v||this.$.LK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return v?v.offsetWidth:0}get ee(){return this.Cmb}set ee(v){this.Cmb=v}get se(){return void 0!==this.visible?this.visible&&0<this.qp.length:(this.visible=n.DOMElementExtensions.isVisible(this.Lf))&&0<this.qp.length}set se(v){this.visible!==v&&(n.DOMElementExtensions.setVisible(this.Lf,v),n.DOMElementExtensions.setVisible(this.FUa,v),this.visible=
v);const w=r.h(this.$).view;v?this.yec||(w.ot(this.nHa.spc),this.yec=!0):(this.qp.length=0,this.yec&&(w.er(this.nHa.spc),this.yec=!1))}Kya(){var v=460;const w=r.h(this.$);var C=w.domElement,B=this.FUa.style;const z=this.Lf.offsetTop+this.Qj.offsetHeight*this.Qj.sectionRowIndex-this.Lf.scrollTop;B.width="auto";B.whiteSpace="nowrap";B.position="absolute";const A=C.offsetLeft+C.offsetWidth-(this.domElement.offsetLeft+this.Lf.offsetLeft+this.Lf.offsetWidth+3);C=this.domElement.offsetLeft-3-(C.offsetLeft+
this.hbc);v=Math.min(this.FUa.offsetWidth,v,Math.max(A,C));n.DOMElementExtensions.Vv(this.FUa,v);B.whiteSpace="";B.position="absolute";z+3>this.Lf.offsetTop+this.Lf.offsetHeight||z<this.Lf.offsetTop||(v=this.Lf.offsetLeft-3-this.FUa.offsetWidth,B=this.Lf.offsetLeft+this.Lf.offsetWidth+3,n.DOMElementExtensions.updatePosition(this.FUa,C>A!==w.rtl?v:B,z,!1))}CB(v){super.CB(v);this.Kya()}Tt(){this.Kya()}tsa(){const v=this.Jn,w=this.Lf,C=3===d.a.Db||b.a.Dp,B=C?this.uEb:this.pI;this.se=!0;w.style.height=
"auto";this.nHa.set_visible(!0);this.mob(v,C);this.qp.length>B&&(n.DOMElementExtensions.gJ(w,Math.floor(w.offsetHeight*B/this.qp.length)),w.style.overflowY="auto");n.DOMElementExtensions.Vv(w,v.offsetWidth+(this.qp.length>B?x.a.Ou:0))}}Object(u.a)(t,"AutoCompleteListBox",F.a,[])},1094:function(u,F,a){a.d(F,"a",function(){return r});u=a(0);var c=a(224),b=a(14),e=a(108),f=a(239);F=a(238);var d=a(734),h=a(5),n=a(52),m=a(12),x=a(71);class r extends F.a{constructor(y,t,v,w,C,B,z,A,E,I){super(document.createElement("a"));
this.ln=!1;this.gd=L=>{this.raiseEvent("ClickButton",L);return!0};this.onKeyDown=L=>{this.raiseEvent("KeyDown",L);return!1};this.Uw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.iO=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=L=>{x.g(L);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=L=>{x.g(L);this.focused=!0;this.raiseEvent("Focus")};this.Sqh=A;this.hmh=E;this.uJ=r.pb(this.domElement,t,v,w,C,B,z,I);this.Gc.la("contextmenu",L=>{x.g(L)});this.enable();
this.focused=this.hovered=!1;y.appendChild(this.domElement)}bXc(y){this.get_events().addHandler("ClickButton",y)}eMd(y){this.get_events().removeHandler("ClickButton",y)}nXc(y){this.get_events().addHandler("KeyDown",y)}rMd(y){this.get_events().removeHandler("KeyDown",y)}r0b(y){this.get_events().addHandler("PointerOver",y)}BMd(y){this.get_events().removeHandler("PointerOver",y)}q0b(y){this.get_events().addHandler("PointerOut",y)}AMd(y){this.get_events().removeHandler("PointerOut",y)}tob(y){this.get_events().addHandler("Blur",
y)}cKb(y){this.get_events().removeHandler("Blur",y)}a$(y){this.get_events().addHandler("Focus",y)}Kda(y){this.get_events().removeHandler("Focus",y)}get Hl(){return this.uJ}get isEnabled(){return this.ln}enable(){this.domElement&&(this.domElement.classList.remove(d.a.wU),this.domElement.style.cursor="",c.a.instance.sa(b.a.click,this.domElement,this.gd),e.KeyInputManager.instance.sa(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.sa(b.a.pointerOver,this.domElement,this.Uw),f.a.instance.sa(b.a.pointerOut,
this.domElement,this.iO),this.Gc.Oi("blur")||this.Gc.la("blur",this.onBlur),this.Gc.Oi("focus")||this.Gc.la("focus",this.onFocus),this.domElement.title=this.Sqh,this.ln=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.wU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.gd),e.KeyInputManager.instance.Ba(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Uw),f.a.instance.Ba(b.a.pointerOut,this.domElement,
this.iO)),this.domElement.title=this.hmh,this.ln=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.gd),e.KeyInputManager.instance.Ba(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Uw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.iO),this.ln=!1);m.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(y,t,v,w,C,B,z,A){y.removeAttribute("Href");y.setAttribute(h.a.Ld,h.a.pt);y.className=t;y.tabIndex=
A;t=document.createElement("span");t.className=z;t.classList.add(v);t.tabIndex=-1;y.appendChild(t);y=document.createElement("img");y.src=n.a.me(w);y.className=C;y.alt=B;y.tabIndex=-1;t.appendChild(y);return y}}Object(u.a)(r,"ListButton",F.a,[251,2])},1095:function(u,F,a){a.d(F,"a",function(){return d});u=a(0);var c=a(109),b=a(28),e=a(1),f=a(727);class d{constructor(m){this.Bvf=m;this.sW=Object.assign({},n);this.oub=[];this.Vmc=-1;(this.Avf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
m&&(this.sW.countAboveThresholds={},m.forEach(x=>this.sW.countAboveThresholds[x]=0))}static get dZd(){return b.a.Qa.we.m}VTa(){this.Vmc=d.dZd}m4(m,x=null){if(-1!==this.Vmc||Object(f.b)(x))m?(this.job(d.dZd-(x||this.Vmc)),this.Vmc=-1):this.sW.failedCount++}BXe(){this.sW.excludingFirstAction=d.AXe(this.oub);this.oub.push(this.sW.firstAction);this.sW.includingFirstAction=d.AXe(this.oub)}job(m){this.sW.count?1E3>this.sW.count&&this.oub.push(m):this.sW.firstAction=m;this.Avf&&this.Bvf&&this.Bvf.forEach(x=>
{m>x&&this.sW.countAboveThresholds[x]++});this.sW.count++}static AXe(m){const x=Object.assign({},h);0<m.length&&(c.i(m),x.median=m[Math.floor(.5*m.length)],x.P75=m[Math.floor(.75*m.length)],x.P95=m[Math.floor(.95*m.length)],x.max=m[m.length-1],x.average=c.g(m,r=>r)/m.length);return x}}Object(u.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},n={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1137:function(u,F,a){function c(pa){pa.da.Aa(491)?this.formulaAssistanceTelemetryManager.FJ("lm"):r.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager")}function b(pa){var tb=Object(L.h)(pa),Nb=Object(T.a)(pa);const vc=tb.zi;var Ic=tb.fc.rkf;Ic=tb.Ul||Ic;Nb=e((Ic?Nb:vc).textBox.domElement);if(Ic)tb={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(tb=e(tb.domElement),{zoom:pa}=Object(H.a)(pa),1!==pa)for(const kd of[Nb,
tb])for(const xd in kd)kd[xd]*=pa;return{target:Nb,bounds:tb}}function e(pa){const {top:tb,left:Nb,right:vc,bottom:Ic}=pa.getBoundingClientRect();return{top:tb,left:Nb,right:vc,bottom:Ic}}function f(pa){var tb;if(pa){var Nb=new jd(0===pa.kind);pa=null===(tb=null===pa||void 0===pa?void 0:pa.rangeInfo)||void 0===tb?void 0:tb.positionKindInfo;if(!pa)return Nb;Nb.OF=0===pa.firstRow;Nb.NF=0===pa.firstColumn;Nb.GK=0===pa.secondRow;Nb.FK=0===pa.secondColumn;return Nb}}var d=a(9),h=a(0),n=a(694),m=a(49),
x=a(37),r=a(15),y=a(19),t=a(385),v=a(76);class w{}w.Cbd="!";w.CKf="[";w.BKf="]";w.openParen="(";w.closeParen=")";w.Bmg=" /.(*\\".split("");w.n9b="...";w.EHb="param_help_link";w.XFd="param_help_udf";w.ued="function_list_box";w.TJh="function_param_box";w.wed="function_reader_description";w.oed="function_description_box";w.TZe="function_param_table";w.J0i="param_row_";w.urc="param_set";w.kLf="param_row_0";w.lLf="param_row_1";w.UJh="<div id='{0}' class='{1}'></div>";w.SJh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";
w.mLf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";w.QJh="<div id='{0}' class='{1} {2} {3}'></div>";w.OJh="<div id='{0}' class='{1} {2} {3} {4}'></div>";w.Fpf="[@";w.n$g=1;w.m$g=3;w.xjh=500;w.Xuf=50;Object(h.a)(w,"FormulaAssistanceConstants",null,[]);var C=a(13),B=a(284),z=a(8),A=a(5),E=a(92),I=a(11),L=a(21),V=a(358),T=a(113),H=a(34),D=a(440),G=a(229);const J=(pa,tb,
Nb)=>{pa&&(c(pa),Nb?Q(pa,tb,Nb):(Nb=new E.a(-859308420,v.a.Db,pa.Hc,0,null),pa.Ja.Lb(Nb,{[v.a.Jc]:A.a.wV,[v.a.og]:"HelpID="+tb})))},M=(pa,tb,Nb)=>{const vc={};vc[A.a.DQ]=tb;tb={};tb.FunctionName=Nb;vc[A.a.gcd]=tb;pa.Xc(802602464,0,8,vc)},Q=(pa,tb,Nb)=>{if(Nb){if(tb&&(!tb||tb.startsWith("http://")||tb.startsWith("https://"))){if(pa.ma(155)&&(pa=Object(D.a)({LFb:269,new:G.c,registry:pa.da}))&&pa.qCa(tb))return;I.HelperMethods.lf(tb,"_blank",V.a)}}else I.HelperMethods.kW(pa.GG,"XLWAEndUser_"+tb,pa.KS)},
U=pa=>{let tb=z.a.f0;const Nb=pa.da.Aa(368);Nb&&!Object(L.h)(pa).Ul&&(tb=Nb.zoom);return tb};var Z;(function(pa){pa.CategoryList="categoryList";pa.FunctionsMap="functionsMap";pa.FunctionIdsToDisplay="functionIdsToDisplay";pa.RefreshListCallback="refreshListCallback";pa.HelpCallback="helpCallback";pa.feedbackCallback="giveFeedbackCallback";pa.InitialCategory="initialCategory";pa.AllCategoryName="allFunctionsCategoryName"})(Z||(Z={}));Object(h.b)("PropsKeys",Z);class P extends B.a{constructor(pa){super(pa);
this.NZe=(tb,Nb)=>{1===tb&&(this.hide(),Nb=Nb.functionName,tb=0<this.functionInfoManager.f3e(Nb).Params.length,Nb={[v.a.Jc]:Nb,["ibdk"]:!0},tb=new E.a(tb?1117706454:-433697611,0,this.$.Hc,8,null),this.$.Ja.Lb(tb,Nb))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Dcb(this.onFunctionInfoLoaded);this.mef()};this.fai=tb=>{Q(this.$,tb,!1)};this.nPi=tb=>{this.hide();M(this.$,"InsertFunctionDialog",tb)};this.okf=tb=>!this.functionInfoManager.nic(tb);this.Pl=C.a.instance.ga(1031);this.functionInfoManager=
pa.da.Aa(19);this.hg()}get qc(){return"FunctionDialog"}hg(){this.functionInfoManager.OJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.JV?this.mef():this.functionInfoManager.GGa(this.onFunctionInfoLoaded)}mef(){var pa;this.W0b=this.functionInfoManager.qbc.filter(this.okf);const tb=null!==(pa=P.uof)&&void 0!==pa?pa:P.v6g;pa=this.functionInfoManager.med;const Nb=this.functionInfoManager.Kcc(tb).map(vc=>vc.FunctionIndex);this.Mq={[P.vu]:this.qc,[Z.CategoryList]:pa,
[Z.FunctionsMap]:this.cch(),[Z.FunctionIdsToDisplay]:Nb,[Z.RefreshListCallback]:this.CSi.bind(this),[Z.feedbackCallback]:this.nPi.bind(this),[Z.HelpCallback]:this.fai,[Z.InitialCategory]:tb,[Z.AllCategoryName]:P.AllCategoryName};this.initializeAndShow(this.Pl,this.NZe,this.Mq)}cch(){let pa={};this.W0b.forEach(tb=>{pa[tb.FunctionIndex]=tb});return pa}iXj(pa){pa=pa.map(tb=>tb.FunctionIndex);this.Mq[Z.FunctionIdsToDisplay]=pa;this.WUa(this.Pl,this.r5a(this.NZe),this.Mq)}CSi(pa,tb){tb?tb=this.sFh(tb):
(tb=this.functionInfoManager.Kcc(pa).filter(this.okf),P.uof=pa);this.iXj(tb)}sFh(pa=""){pa=pa.toLocaleLowerCase();const tb=this.W0b.filter(({NameUI:Nb})=>Nb.toLocaleLowerCase().startsWith(pa));3<=pa.length&&(tb.push(...this.W0b.filter(Nb=>Nb.NameUI.toLocaleLowerCase().includes(pa)&&!tb.includes(Nb))),tb.push(...this.W0b.filter(Nb=>Nb.Help.toLocaleLowerCase().includes(pa)&&!tb.includes(Nb))));return tb}}P.AllCategoryName=C.a.instance.ga(1030);P.v6g=C.a.instance.ga(1029);P.uof=void 0;Object(h.a)(P,
"FunctionDialog",B.a,[]);var S=a(55),ja=a(68),X=a(33),Y=a(89),va=a(27),N=a(211),ea=a(69),Ca=a(86),la=a(226),Ra=a(52),lb=a(737),Aa=a(12),da=a(71),aa=a(1);const fa=ea.a.muh,Oa=ea.a.tuh,ba=ea.a.uuh,ka=ea.a.KRe,Pa=ea.a.ouh,Fa=ea.a.quh,oa=ea.a.ERe,La=ea.a.ORe,Ea=ea.a.puh,ca=ea.a.HRe;class $a extends N.a{constructor(pa,tb){super(pa,C.a.instance.ga(1031),void 0,void 0,void 0,aa.EwaSettings.ma(390));this.lwb=this.Jqf=this.VZe=this.SZe=this.Fja=this.RZe=this.nwb=this.HKa=this.Gja=this.IKa=null;this.Pld=!1;
this.Yyb=this.$Eb=this.w3b=null;this.onFunctionInfoLoaded=()=>{if(!this.HKa.count){const Nb=this.functionInfoManager.med;for(let vc=0,Ic=Nb.length;vc<Ic;++vc)this.HKa.GY(Nb[vc],Nb[vc],!1).className=ea.a.nuh;this.HKa.selectedIndex=0;Y.a.rc([this.w3b,this.$Eb,this.Yyb]);this.w3b=this.Ce.$d(this.IKa);this.$Eb=this.Ce.$d(this.Gja);this.Yyb=this.Ce.$d(this.lwb);this.w3b.la("change",this.OCf);this.$Eb.la("change",this.aQi);this.$Eb.la("dblclick",this.bQi);this.Yyb.la("click",this.Uca);this.Yyb.la("keyup",
this.iSi);Aa.DOMElementExtensions.setVisible(this.Gja,!0);Aa.DOMElementExtensions.setVisible(this.RZe,!1);this.$.C7c&&Aa.DOMElementExtensions.setVisible(this.Jqf,!0)}this.OCf(null);this.getButton(0).get_element().disabled=!1;this.IKa.disabled=!1;this.OSa();this.Pld=!0};this.Uca=()=>{this.faa&&J(this.$,this.faa.HelpId,this.faa.IsDynamicUdf)};this.iSi=Nb=>{13!==Nb.keyCode&&32!==Nb.keyCode||this.Uca(Nb)};this.OCf=()=>{const Nb=this.functionInfoManager.Kcc(this.HKa.ee.value);this.q4a(Nb);this.Gja.scrollTop=
0;this.o3f()};this.aQi=()=>{this.o3f()};this.bQi=Nb=>{this.faa&&(da.g(Nb),this.close(0))};this.Tc=(Nb,vc)=>{la.b(vc)&&this.sv()};this.functionInfoManager=pa.da.Aa(19);this.formulaAssistanceControl=pa.da.Aa(221);if(this.dwb=X.a.HV(this.$))this.formulaAssistanceManager=pa.da.Aa(464);this.aN=tb}get qc(){return"FunctionDeprecatedDialog"}get faa(){if(!this.Gja||!this.Gja.firstChild)return null;const pa=Number.parseInvariant(this.Gja.children[this.Gja.selectedIndex].value);return this.functionInfoManager.yUh(pa)}initialize(){this.Ib.classList.add(ea.a.luh);
if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7262176_FunctionDeprecatedDialogReduceInnerHtml")){var pa=document.createElement("div");pa.classList.add(ea.a.DRe);var tb=document.createElement("label");tb.setAttribute("for",$a.ned);tb.innerText=C.a.instance.ga(1034)+" ";pa.appendChild(tb);tb=document.createElement("select");tb.id=$a.ned;tb.classList.add(fa);tb.setAttribute("disabled","true");pa.appendChild(tb);this.Ib.appendChild(pa);pa=document.createElement("div");pa.classList.add(Ca.a.Um);pa.innerText=
C.a.instance.ga(1035);this.Ib.appendChild(pa);pa=document.createElement("div");pa.classList.add(ea.a.CRe);tb=document.createElement("select");tb.id=$a.QZe;tb.classList.add(Oa,va.a.Iw?ba:null,y.a.zo,y.a.Ao);tb.size=7;pa.appendChild(tb);tb=document.createElement("div");tb.classList.add(Fa);tb.innerText=C.a.instance.ga(736);pa.appendChild(tb);this.Ib.appendChild(pa);pa=document.createElement("div");pa.classList.add(ea.a.FRe);tb=document.createElement("div");tb.classList.add(ca);tb.style.direction="ltr";
var Nb=document.createElement("span");Nb.classList.add(Ea,y.a.zo);const vc=document.createElement("span");vc.classList.add(y.a.zt,ea.a.GRe);const Ic=document.createElement("img");Ic.title=C.a.instance.mb(3);Ic.classList.add(y.a.DUe);Ic.src=Ra.a.me(13);vc.appendChild(Ic);Nb.appendChild(vc);tb.appendChild(Nb);Nb=document.createElement("span");Nb.id=$a.qed;Nb.classList.add(La);tb.appendChild(Nb);Nb=document.createElement("a");Nb.tabIndex=0;Nb.title=C.a.instance.ga(1036);Nb.classList.add(Pa);tb.appendChild(Nb);
Nb=document.createElement("span");Nb.id=$a.pbc;tb.appendChild(Nb);pa.appendChild(tb);tb=document.createElement("div");tb.classList.add(oa);tb.id=$a.ped;pa.appendChild(tb);this.Ib.appendChild(pa)}else this.Ib.innerHTML=$a.rH();this.Qf||(this.Pt(),this.jsa());super.initialize();pa=Aa.DOMElementExtensions.nk(this.Ib,ca);this.rtl&&(pa.align="right",this.lwb.style.marginLeft="5px");this.Qf&&(pa.style.padding="1px");this.functionInfoManager.OJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&
(this.functionInfoManager.Dcb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.tk(this.Tc));Y.a.rc([this.w3b,this.$Eb,this.Yyb,this.HKa,this.nwb]);super.dispose()}Pt(){this.IKa=Aa.DOMElementExtensions.nk(this.Ib,fa);this.Gja=Aa.DOMElementExtensions.nk(this.Ib,Oa);this.IKa.setAttribute(A.a.Ld,A.a.x1b);this.HKa=new lb.a(this.IKa,!0);this.nwb=new lb.a(this.Gja,!0);this.RZe=Aa.DOMElementExtensions.nk(this.Ib,Fa);this.lwb=Aa.DOMElementExtensions.nk(this.Ib,Pa);this.VZe=Aa.DOMElementExtensions.nk(this.Ib,
La);this.Jqf=Aa.DOMElementExtensions.nk(this.Ib,Ea);this.SZe=$get($a.pbc,this.Ib);this.Fja=Aa.DOMElementExtensions.nk(this.Ib,oa);this.Qf&&(this.Fja.style.paddingLeft="1px");this.functionInfoManager.GGa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Wj(this.Tc)}aR(pa){this.$.da.$a(40,()=>{this.HKa.aR(pa)})}uq(){this.dwb?this.formulaAssistanceManager.p8b():this.formulaAssistanceControl.set_visible(!1);super.uq();this.Pld||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.IKa.disabled&&
this.Pld&&Aa.DOMElementExtensions.setFocus(this.IKa)}commit(){return!0}Srb(){let pa=this.faa.NameDataStrings;const tb=new E.a(-433697611,0,this.$.Hc,8,null);this.$.Ja.Lb(tb,{[v.a.Jc]:pa,["ibdk"]:!0})}$sa(){this.dwb?this.formulaAssistanceManager.Qda():this.formulaAssistanceControl.Fpb()}q4a(pa){this.nwb.clear();const tb=$a.pbc+" "+$a.ped;for(let Nb=0,vc=pa.length;Nb<vc;++Nb){const Ic=this.nwb.GY(pa[Nb].NameUI,pa[Nb].FunctionIndex.toString(),!1);va.a.Iw&&Ic.classList.add(ka);Ic.setAttribute(A.a.SP,
$a.qed);Ic.setAttribute(A.a.KJ,tb)}this.nwb.selectedIndex=0}o3f(){if(this.faa){this.lwb.parentNode.className=ea.a.HRe+(this.functionInfoManager.nic(this.faa)?"-udf":"");var pa=this.faa.NameDataStrings;this.VZe.innerText=pa;this.lwb.innerText=pa;this.Fja.innerText=this.faa.Help;pa=this.faa.Params.split(w.Cbd);this.SZe.innerText=w.openParen+(1<pa.length?w.n9b:pa[0])+w.closeParen}}static rH(){return String.format("<div class='"+ea.a.DRe+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+
Ca.a.Um+"'>{1}</div>\r\n<div class='"+ea.a.CRe+"'>\r\n\t<select id='{16}' class='{17} "+y.a.zo+" "+y.a.Ao+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+ea.a.FRe+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+y.a.zo+"'>\r\n\t\t\t<span class='"+y.a.zt+" "+ea.a.GRe+"'>\r\n\t\t\t\t<img title='{3}' class='"+y.a.DUe+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
C.a.instance.ga(1034),C.a.instance.ga(1035),C.a.instance.ga(736),C.a.instance.mb(3),Ra.a.me(13),C.a.instance.ga(1036),$a.ned,$a.pbc,7,fa,Pa,Fa,oa,La,Ea,ca,$a.QZe,Oa+(va.a.Iw?" "+ba:""),$a.ped,$a.qed)}}$a.pbc="function_dialog_param_string";$a.ped="function_dialog_function_description";$a.qed="function_dialog_function_name";$a.QZe="function_list";$a.ned="function_category";Object(h.a)($a,"FunctionDeprecatedDialog",N.a,[]);var Qa=a(261),Va=a(22);class fb extends B.a{constructor(pa,tb,Nb,vc){super(pa);
this.i4a=tb;this.formulaAuthoringHelper=Nb;this.V9f=vc;this.LJh=(Ic,kd)=>{var xd;if(1===Ic){this.hide();Ic=this.i4a.NameUI;for(kd=null!==(xd=kd.functionArgs)&&void 0!==xd?xd:[];1<kd.length&&Va.a.rh(kd[kd.length-1]);)kd.pop();xd={[v.a.Jc]:Ic,["functionArgs"]:kd,["ibdk"]:!0};kd=new E.a(-433697611,0,this.$.Hc,8,null);this.$.Ja.Lb(kd,xd)}else 2===Ic&&(this.hide(),xd=new E.a(753860909,0,this.$.Hc,8,null),this.$.Ja.Lb(xd))};this.kW=()=>Q(this.$,this.i4a.HelpId,!1);this.FUh=()=>this.formulaAuthoringHelper.hasRepeatingParams(this.i4a)?
Ic=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.V9f,this.i4a,Ic):void 0;this.feedbackCallback=Ic=>M(this.$,"functionArgumentsDialog",Ic);this.Pl=C.a.instance.ga(1032);this.hg()}get qc(){return"FunctionArgumentsDialog"}hg(){this.Rb=1;this.Mq={[Qa.a.vu]:this.qc,["functionInfo"]:this.i4a,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.V9f,this.i4a),["generateArgByIndex"]:this.FUh(),["helpCallback"]:this.kW,["giveFeedbackCallback"]:this.feedbackCallback,["isModal"]:!1,
["rangePickerController"]:Object(L.h)(this.$).yf.Oxb()};this.initializeAndShow(this.Pl,this.LJh,this.Mq)}}Object(h.a)(fb,"FunctionArgumentsDialog",B.a,[]);class Ka{constructor(pa,tb,Nb){this.$=pa;this.Va=tb;this.functionInfoManager=Nb;this.PJh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.PJh.includes(this.menuId)&&this.frame.px(this.menuId)};
this.HV=X.a.HV(this.$);this.nBb=X.a.hkf();this.HV&&(this.formulaAssistanceManager=this.$.da.Aa(464));this.TY={};this.frame=this.$.frame;this.functionInfoManager.GGa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=pa.da.Aa(491)}nc(pa,tb){switch(tb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return pa=
L.h(this.$).zi,pa.A6a||!pa.eb||0>=pa.text.length?!1:!0;default:return!1}}executeCommand(pa,tb,Nb){var vc,Ic;pa=tb.command;const kd=L.h(this.$),xd=kd.zi;switch(pa){case 753860909:case -2060563418:null===(vc=this.formulaAssistanceManager)||void 0===vc?void 0:vc.p8b();kd.inRangePicker&&xd.WE(!1);this.nBb?new P(this.$):(new $a(this.$,xd)).xg();this.formulaAssistanceTelemetryManager.h4a.dialogShownCounter++;break;case 1117706454:null===(Ic=this.formulaAssistanceManager)||void 0===Ic?void 0:Ic.p8b();kd.inRangePicker&&
xd.WE(!1);const ae=this.functionInfoManager.f3e(Nb[v.a.Jc]);vc=Va.a.VTf(ae.Params).split("!")[0];const oe=""!==vc?vc.split(this.$.listSeparator).filter(ye=>"..."!==ye):[];x.TaskExtensions.WJ(m.GetServiceTaskFactory.Oa(this.$.da,520,521,0),ye=>{new fb(this.$,ae,ye.result,oe)},this.$.ka,3);Nb.ibdk?this.formulaAssistanceTelemetryManager.h4a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.h4a.argsDialogOpenedByRibbonCounter++;break;case -433697611:vc=Nb.functionArgs;Nb.ibdk&&
(void 0!==vc?this.formulaAssistanceTelemetryManager.h4a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.h4a.dialogCommitedCounter++);let ve=Nb[v.a.Jc]+w.openParen;this.nBb&&(void 0!==vc&&(ve+=vc.join(this.$.listSeparator)),ve+=w.closeParen);Nb.UILocation&&this.$.Xc(-1075437823,-1,0,null);kd.view.visibleArea.contains(kd.fg(null))||kd.Kt(kd.ha.ra.activeCell,3,"FormulaAssistanceCommandHandler.ExecuteCommand");const Ge=xd.textBox;Nb=xd.textBox.caretPosition;xd.eb&&xd.text?(vc=xd.text,
Ic=Nb?vc.substring(0,Nb):"=",xd.text=Ic+ve+vc.substring(Nb+(Ge.Oy?Ge.Oy.length:0),vc.length),Ge.caretPosition=Ic.length+ve.length):x.TaskExtensions.za(kd.startEdit(!0,1),()=>{xd.text="="+ve;if(this.nBb)kd.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{const ye=ve.length+1;Ge.Udb(ye);Ge.caretPosition=ye}},this.$.ka,11,ja.a.current);kd.Ul&&(Nb=kd.Vb,Nb.text=Ge.text,Nb.setCaretPosition(Ge.caretPosition));this.HV?this.formulaAssistanceManager.Qda():(Nb=xd.d3.get(t.a.mwb),null===Nb||
void 0===Nb?void 0:Nb.aZ(!1));break;case -1334919469:J(this.$,"154468",!1)}return S.Task.Ta(!0)}wc(pa,tb){switch(tb.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.nBb;default:return!1}}KKh(pa,tb){tb=this.Va.fq(tb);const Nb=this.Va.Ec();var vc=this.functionInfoManager.Kcc(pa);if(!vc)return r.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),tb.MC();const Ic=this.nBb?1117706454:
-433697611;for(let kd=0;kd<vc.length;++kd){const xd=vc[kd].NameUI,ae=this.Va.lQ(280,"Formulas."+pa+"MenuItem_"+vc[kd].FunctionIndex.toString(),Ic,null,1,"None",0,0,xd,!1,0);ae.label=xd;const oe=vc[kd].Params.split(w.Cbd);ae.pS(xd+" "+(w.openParen+(1<oe.length?w.n9b:oe[0])+w.closeParen)+"\n"+vc[kd].Help);Nb.buttons.push(ae)}pa=this.Va.Ec();vc=this.Va.lQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,y.a.VUe,3,"Image16by16",1033,0,"Formulas.MoreFunctionsMenuItem",!1,0);pa.buttons.push(vc);tb.tc.push(Nb);
tb.tc.push(pa);return tb.MC()}Kc(pa,tb,Nb){pa=this.xUh(tb);if(-1===pa)return!1;this.menuId=Nb.MenuId;if(!this.functionInfoManager.JV)return this.functionInfoManager.OJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;pa=this.functionInfoManager.med[pa];this.TY[pa]=this.TY[pa]||this.KKh(pa,Nb.MenuId);Nb.MenuItems=this.TY[pa];return!0}xUh(pa){switch(pa){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;
case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Object(h.a)(Ka,"FormulaAssistanceCommandHandler",null,[208]);class hb extends n.a{constructor(pa){super(pa)}ld(){const pa=m.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya),tb=m.GetServiceTaskFactory.create(this.$.da,
153,this.ka,this.Ya);x.TaskExtensions.za(x.TaskExtensions.Ed([pa,tb],this.ka),()=>{this.Zc([new Ka(this.$,pa.result,tb.result)])},this.ka,3)}static la(pa){n.a.Nd(92,new hb(pa))}}Object(h.a)(hb,"FormulaAssistanceCommandHandlerFactory",n.a,[]);var fc=a(222);class dc{constructor(pa,tb){this.JKa=this.qva=this.Aja=null;this.AGf=(Nb,vc)=>{this.iaj(vc.functionName,vc.ved)};this.CGf=(Nb,vc)=>{this.haj(vc.ved,vc.tQd,vc.K0i)};this.BGf=(Nb,vc)=>{Nb=[];for(var Ic of vc.tQd)(!this.cxa||void 0!==Ic&&null!==Ic)&&
(vc=Ic.trim())&&Nb.push(vc);if(!this.cxa||Nb.length){Ic="";for(vc=0;vc<Nb.length;vc++){const kd=this.e0c(Nb[vc]),xd=dc.bHd(vc,Nb.length);Ic+=kd+xd;xd&&(Ic+=this.ariaLiveNotifier.pya)}this.ariaLiveNotifier.readText(Ic)}};this.DGf=(Nb,vc)=>{this.ariaLiveNotifier.kaj(vc.rG,vc.description,vc.selectedIndex.toString(),vc.length.toString())};this.wGf=(Nb,vc)=>{this.ariaLiveNotifier.tRf(vc.description,vc.length)};this.ICf=()=>{this.ariaLiveNotifier.acb(C.a.instance.ga(883),A.a.jHa)};this.ACf=()=>{this.ariaLiveNotifier.readText(C.a.instance.ga(884))};
this.DCf=()=>{this.ariaLiveNotifier.readText(C.a.instance.ga(885))};this.$=tb;this.ariaLiveNotifier=pa;this.$.da.Ga(219,this);this.cxa=X.a.k5(tb)}dispose(){this.r0d();this.JKa=this.qva=this.Aja=null}zZc(pa){pa&&(this.Aja=pa,this.Aja.nre(this.AGf),this.Aja.gse(this.CGf),this.cxa&&this.Aja.fse(this.BGf))}AZc(pa){pa&&(this.qva=pa,this.cxa&&(this.qva.lre(this.ICf),this.qva.jre(this.ACf)),this.qva.kre(this.DCf))}BZc(pa){pa&&(this.JKa=pa,this.JKa.BXc(this.DGf),this.JKa.i0b(this.wGf))}r0d(){var pa,tb,Nb;
this.Aja&&(this.Aja.BVf(this.AGf),this.Aja.ZVf(this.CGf),this.cxa&&this.Aja.YVf(this.BGf));this.JKa&&(this.JKa.FMd(this.DGf),this.JKa.Suc(this.wGf));this.cxa&&(null===(pa=this.qva)||void 0===pa?void 0:pa.AVf(this.ICf),null===(tb=this.qva)||void 0===tb?void 0:tb.yVf(this.ACf));null===(Nb=this.qva)||void 0===Nb?void 0:Nb.zVf(this.DCf)}iaj(pa,tb){if(tb){let Nb="";this.cxa||(Nb+=C.a.instance.mb(57)+this.ariaLiveNotifier.pya);for(let vc=0;vc<tb.length;vc++)Nb+=pa+this.ariaLiveNotifier.pya+this.e0c(tb[vc])+
dc.bHd(vc,tb.length);this.cxa&&(Nb+=C.a.instance.ga(882)+this.ariaLiveNotifier.pya);this.ariaLiveNotifier.readText(Nb)}}haj(pa,tb,Nb){if(pa){let Ic="",kd=0;if(tb){for(let xd=0;xd<tb.length;xd++){if(Nb>=pa[xd].split(this.$.listSeparator).length){kd++;continue}var vc=tb[xd].trim();if(!vc)return;vc=this.e0c(vc);const ae=dc.bHd(xd-kd,tb.length-kd);Ic+=vc+ae;ae&&(Ic+=this.ariaLiveNotifier.pya)}this.ariaLiveNotifier.readText(Ic)}}}e0c(pa){if(!pa)return"";var tb=pa.split(this.$.listSeparator);pa="";for(const Nb of tb){if(dc.yqd(Nb))pa+=
Nb;else{const vc=(tb=dc.Dpi(Nb))?Nb.replace("[","").replace("]",""):Nb;pa+=String.format(tb?C.a.instance.mb(59):C.a.instance.mb(58),vc)}pa+=this.ariaLiveNotifier.pya}return pa}static bHd(pa,tb){return pa>=tb||1===tb?(r.ULS.shipAssertTag(537161997,0,pa<tb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(C.a.instance.mb(55),pa+1,tb)+"\r\n"}static yqd(pa){return Va.a.contains(pa,w.n9b,!0)}static Dpi(pa){return pa.trimStart().startsWith(w.CKf)||pa.trimEnd().endsWith(w.BKf)}}
Object(h.a)(dc,"FormulaAssistanceReadoutHandler",null,[231,2]);class wb extends fc.a{constructor(pa){super();this.$=pa;this.Fb()}create(){const pa=this.$.da;x.TaskExtensions.za(m.GetServiceTaskFactory.Oa(pa,211,212,this.Ya),tb=>{tb=pa.Aa(219)||new dc(tb.result,this.$);this.nb(tb)},this.ka,3)}static la(pa){pa.da.Ga(220,new wb(pa))}}Object(h.a)(wb,"FormulaAssistanceReadoutHandlerFactory",fc.a,[]);var Tb=a(641),xb=a(111),cb=a(980),jb=a(58),qa=a(40),za=a(116);class Na{constructor(){this.PRa={}}qjd(pa){return this.PRa&&
pa in this.PRa?this.PRa[pa]:null}hbg(pa,tb){this.PRa||(this.PRa={});this.PRa[pa]=tb}l_(){this.PRa=null}}Object(h.a)(Na,"FormulaAssistanceContextualPreviewCache",null,[]);var ua=a(60);const Xa=(pa,tb,Nb,vc,Ic,kd,xd=null)=>{xd=pa.Na(1,xd);xd.getPartialCalcResultsParameters=tb;return ua.g(pa,"GetPartialCalcResults",xd,Nb,vc,Ic,kd,4)};class ha{constructor(pa){this.OEi=30;this.calcManager=null;this.Dd=!1;this.aQa=this.THb=this.cbb=null;this.Ay=()=>{this.Nha.l_()};this.$=pa;this.Nha=new Na;this.ZXf=-1;
this.$.ea.OE(this.Ay)}dispose(){this.Dd||(this.$&&(this.$.ea.cE(this.Ay),this.$=null),this.Nha=this.THb=null,this.Dd=!0)}Pfd(pa,tb,Nb,vc){if(tb&&0>=tb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!pa)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
let Ic="="+tb.substring(Nb.start,Nb.end);aa.EwaSettings.ma(581)&&(Ic=this.calcManager.C2h(L.h(this.$).ha.ra.activeCell,pa,Nb));const kd=this.HQh(Ic,Nb);if(aa.EwaSettings.ma(581)){if(kd&&!this.calcManager.isFormulaSubExpressionVolatile(pa))return Promise.resolve(kd)}else if(kd)return Promise.resolve(kd);return this.JQh(Ic,Nb).then(xd=>{if(this.h2c(vc))throw Error.create("OperationCanceledException");if(!xd||xd.dnj||xd.Bna.startsWith("##UNSUPPORTED:"))return this.A1e(tb,Ic,Nb,vc);this.Nha.hbg(Ic,xd.Bna);
return Promise.resolve(xd)})}HQh(pa,tb){return(pa=this.Nha.qjd(pa))?new cb.a(pa,tb.start,tb.end,0):null}JQh(pa,tb){if(!pa||0>=pa.length||!tb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.JZg(L.h(this.$).ha.ra.activeCell,pa,this.OEi,tb)}A1e(pa,tb,Nb,vc){if(!pa||0>=pa.length||!tb||0>=tb.length||!Nb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.aQa)return this.IQh(pa,tb,Nb,vc);const Ic={};Ic.PartialFormula=tb;Ic.Formula=pa;Ic.SourceRange=qa.v(L.h(this.$).ha.ra.activeCell,this.$);return this.aQa=new Promise((kd,xd)=>{this.THb=new Tb.a;this.ZXf=this.$.ea.ze;this.cbb=Xa(this.$.pa.ya,Ic,ae=>{this.AZi(tb,Nb,vc,ae,kd,xd)},ae=>{this.cbb=this.aQa=null;xd(ae)},null,null,null);this.THb.token.register(()=>{this.q0g(xd)})})}AZi(pa,tb,Nb,vc,Ic,kd){this.cbb=this.aQa=null;if(this.ZXf!==this.$.ea.ze)kd(Error.create("OperationCanceledException"));
else if(vc.Result)if(vc=jb.a.ki(vc.Result),!vc||xb.a.isEmpty(vc))Ic(null);else{for(let xd in vc)this.Nha.hbg(xd,vc[xd]);this.h2c(Nb)?kd(Error.create("OperationCanceledException")):(pa=this.Nha.qjd(pa))?(""===pa&&(pa=" "),Ic(new cb.a(pa,tb.start,tb.end,0))):kd(Error.create("SubexpressionNotFoundException"))}else Ic(null)}IQh(pa,tb,Nb,vc){return new Promise((Ic,kd)=>{this.aQa.then(()=>{this.LYf(pa,tb,Nb,vc,Ic,kd)}).catch(()=>{this.LYf(pa,tb,Nb,vc,Ic,kd)})})}LYf(pa,tb,Nb,vc,Ic,kd){if(this.h2c(vc))kd(Error.create("OperationCanceledException"));
else{const xd=this.Nha.qjd(tb);xd?Ic(new cb.a(xd,Nb.start,Nb.end,0)):this.A1e(pa,tb,Nb,vc).then(ae=>{Ic(ae)}).catch(ae=>{kd(ae)})}}q0g(pa){this.cbb&&(za.a.au(this.cbb.qt)?(this.aQa=this.cbb=null,pa(Error.create("PendingWebReqeuestCancelled"))):r.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}l_(){this.r0g();this.Nha&&this.Nha.l_()}r0g(){this.THb&&this.THb.cancel()}h2c(pa){return this.Dd||pa.IK}}Object(h.a)(ha,"FormulaAssistanceContextualPreviewCalculator",null,[2]);
var ta=a(157),wa=a(213);class db{}db.Xuh="ewa-facp-text-box";Object(h.a)(db,"CssClassNames",null,[]);class Jb{constructor(pa){this.Vqa=this.fUa=this.i3a=this.kQ=this.W$=this.Za=null;this.Cld=!1;this.Lc=pa}dispose(){(this.W$||this.kQ)&&this.Obf();this.Za=this.Vqa=null}VWj(pa,tb,Nb,vc){pa&&tb&&vc&&tb.Bna&&!(1>tb.Bna.length)&&(this.Za=pa,this.BUf(),this.i3a=tb,this.fUa=vc,this.fFj(tb,Nb,vc))}Obf(){this.sai();this.BUf();this.fUa=this.i3a=null}fFj(pa,tb,Nb){if(pa.Bna&&!(1>pa.Bna.length)){var vc=this.Lc.da.Aa(266);
if(vc){var Ic=vc.LWh();Ic&&x.TaskExtensions.za(this.IDb,()=>{if(tb)if(aa.EwaSettings.ma(581)&&this.Za.eb&&0<Nb.length){this.izb(pa.FKa,Nb[0].start,null);var kd=this.N7e(Nb[0],Ic),xd=this.Za.text.substring(Nb[0].start,Nb[0].end).trim();xd=this.Za.text.indexOf(xd);xd=this.Za.text.substring(0,xd).lastIndexOf("\n");this.izb(0>xd||1>=Nb.length?Nb[0].start:xd+1,Nb[0].end,kd?String.format(kd,.3):null);for(var ae=1;ae<Nb.length;ae++)kd=this.N7e(Nb[ae],Ic),xd=this.Za.text.substring(Nb[ae].start,Nb[ae].end).trim(),
xd=this.Za.text.indexOf(xd),xd=this.Za.text.substring(Nb[ae-1].end,xd).lastIndexOf("\n"),this.izb(0>xd?Nb[ae-1].end:xd+1+Nb[ae-1].end,Nb[ae].end,kd?String.format(kd,.3):null);xd=this.Za.text.substring(Nb[Nb.length-1].end,pa.sva).indexOf("\n");this.izb(0>xd?Nb[Nb.length-1].end:xd+1+Nb[Nb.length-1].end,pa.sva,null);r.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.izb(pa.FKa,
pa.sva,null),r.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.W$||(this.W$=document.createElement(wa.a.div),this.Za.textBox.domElement.appendChild(this.W$));this.kQ||(this.kQ=document.createElement(wa.a.div),this.kQ.className=db.Xuh,this.Lc.domElement.appendChild(this.kQ));kd=pa.sva;aa.EwaSettings.ma(581)&&this.Za.eb&&Nb&&0<Nb.length&&Nb[0].start<kd&&Nb[0].start!==pa.FKa&&
!this.Za.textBox.Oy.length&&(kd=Nb[0].start);ae=Va.a.contains(this.Za.textBox.Le.id,"FormulaBar",!0)&&Va.a.contains(this.Za.text.substring(pa.FKa,pa.sva),"\n",!0);xd=this.Za.eb?this.Za.textBox.caretPosition:0;kd=excelOnline.utils.getBoundingRectForText(this.Za.textBox.Le,ae?xd:pa.FKa,ae?xd:kd,aa.EwaSettings.ma(581));this.kQ.style.left=I.HelperMethods.uc(kd.left);this.kQ.style.top=I.HelperMethods.uc(kd.top);this.kQ.style.width=I.HelperMethods.uc(kd.width);this.kQ.style.height=I.HelperMethods.uc(kd.height);
dialogControls.renderToolTip(this.W$,`FormulaAssistancePreviewToolTip_${pa.sva}_${pa.sva}`,pa.Bna,this.kQ,0,!1,!1,1)},this.Lc.ka,3)}}}N7e(pa,tb){const Nb=this.Za.text;var vc=Nb.substring(pa.start,pa.end);vc=vc.trim();pa=Nb.indexOf(vc,pa.start);tb=Nb.indexOf(tb,pa);vc=Nb.substring(pa,tb);vc=vc.trim();return this.Za.colors.getItem(pa+"-"+(pa+vc.length))}sai(){this.Za&&this.W$&&this.kQ&&x.TaskExtensions.za(this.IDb,()=>{this.Za.textBox.domElement.contains(this.W$)&&(dialogControls.clearToolTip(this.W$),
this.Za.textBox.domElement.removeChild(this.W$),this.W$=null);this.Lc.domElement.contains(this.kQ)&&(this.Lc.domElement.removeChild(this.kQ),this.kQ=null)},this.Lc.ka,3)}izb(pa,tb,Nb){!this.Za||pa>=tb||(this.Za.textBox.formatText(pa,tb-pa,{["background"]:Nb||"#E3DDCC"}),this.Cld=!0)}BUf(){if(this.Za&&this.i3a&&this.Cld){var pa=this.i3a.sva;aa.EwaSettings.ma(581)&&0<this.fUa.length&&this.fUa[this.fUa.length-1].end>pa&&(pa=this.fUa[this.fUa.length-1].end);this.Za.textBox.formatText(this.i3a.FKa,pa-
this.i3a.FKa,{["background"]:!1});this.Cld=!1}}get IDb(){if(this.Vqa)return this.Vqa;const pa=new ta.a;this.Lc.ky(tb=>{x.TaskExtensions.za(tb.kwd(),()=>{pa.setResult(!0)},this.Lc.ka,3)});return this.Vqa=pa.task}}Object(h.a)(Jb,"FormulaAssistanceContextualPreviewControl",null,[2]);var Pb=a(83),eb=a(47),Ma=a(46);class ob{constructor(pa){this.h8=0;this.Tdd=pa}x8f(pa,tb,Nb){Nb?this.mbh(pa,tb,Nb):this.T9e(pa,tb,Nb,!0)}Flj(){this.h8=0}mbh(pa,tb,Nb){this.h8++;const vc=this.h8;eb.a.instance.create(()=>{this.T9e(pa,
tb,Nb,vc===this.h8)},500,Ma.a.PIh,!0,!0)}T9e(pa,tb,Nb,vc){const Ic=this.Tdd.Pfd(pa,tb);Ic&&Ic.then(kd=>{vc&&this.Tdd.jrd(tb)&&this.Tdd.UWj(pa,kd,Nb)}).catch(kd=>{kd=Object(Pb.a)(Error,kd);"OperationCanceledException"===kd.message?r.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${kd}`):r.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${kd}`)})}}Object(h.a)(ob,"FormulaAssistanceContextualPreviewHoverManager",null,[]);
var Ia=a(175);class Da{constructor(pa){this.Ysb=this.Lha=this.calcManager=this.Za=null;this.T$a=()=>{this.d6a(!1,!1)};this.$=pa;this.cwb=new Jb(pa);this.ebc=new ha(pa);this.fbc=new ob(this);L.h(pa).Vb.Rm(this.T$a);this.$.da.Ga(317,this)}dispose(){this.g1c();Y.a.rc([this.cwb,this.ebc]);this.fbc=this.ebc=this.cwb=null;this.$&&L.h(this.$).Vb.em(this.T$a);this.Lha=this.Za=this.$=null}gFj(pa,tb){tb&&Ia.f(tb.text)&&!(tb.oxa||tb.textBox.Oy||this.Za&&this.Za.textBox.Oy)&&(this.Za=tb,this.calcManager=this.$.da.Aa(266))&&
(r.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),pa=I.HelperMethods.Lwb(pa),pa=this.calcManager.z2h(L.h(this.$).ha.ra.activeCell,this.Za.text,pa.x,pa.y),tb=this.calcManager.getSubExpressionSpan(pa),!tb||tb.end<=tb.start||this.jrd(tb)||(this.Lha=tb,this.fbc.x8f(pa,tb,!0)))}iVd(pa){if(pa&&Ia.f(pa.text))if(pa.textBox.Oy&&pa.textBox.Oy.trim()){if(this.Za=pa,this.calcManager=this.$.da.Aa(266)){r.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");pa={};var tb=this.Za.textBox.Oy.trim();pa.start=this.Za.text.indexOf(tb,this.Za.textBox.caretPosition);pa.end=pa.start+tb.length;(tb=this.calcManager.getFormulaSubExpressionObject(L.h(this.$).ha.ra.activeCell,this.Za.text,this.Za.textBox.Oy))&&!this.jrd(pa)&&(this.Lha=pa,this.fbc.x8f(tb,pa,!1))}}else this.d6a(!1,!0)}d6a(pa,tb){!this.Za||tb&&this.Za.textBox.Oy||(this.Lha=
null,pa&&(this.g1c(),this.ebc.l_(),this.fbc.Flj()),this.cwb&&this.cwb.Obf(),this.Za.oxa||(this.Za.oxa=!1,this.Za=null))}Pfd(pa,tb){if(!this.Za||this.Za.oxa)return null;this.g1c();this.Ysb=new Tb.a;return this.ebc.Pfd(pa,this.Za.text,tb,this.Ysb.token)}UWj(pa,tb,Nb){this.Ysb=null;!pa||!tb||!tb.Bna||0>=tb.Bna.length?this.d6a(!1,!1):(pa=this.calcManager.A2h(L.h(this.$).ha.ra.activeCell,pa,this.Za.text),this.cwb.VWj(this.Za,tb,Nb,pa))}jrd(pa){return this.Lha?pa.start===this.Lha.start&&pa.end===this.Lha.end&&
pa.pre===this.Lha.pre&&pa.post===this.Lha.post:!1}g1c(){this.Ysb&&this.Ysb.cancel()}}Object(h.a)(Da,"FormulaAssistanceContextualPreviewManager",null,[243,2,244]);var nb=a(7),Ua=a(4),W=a(224),sa=a(14),vb=a(187),gc=a(1091),Bc=a(65),Sa=a(777),na=a(31),ib=a(24),Ib=a(66),ec=a(283),qb=a(247),Ha=a(162);class Ab{constructor(pa=!1){this.lT=0;this.Cbe=!1;this.VWa=this.cde=null;this.eyg=pa;this.textEdit=null}$3f(pa){this.lT=0;this.Cbe=pa.IsCompatibility;this.set_name(pa.NameDataStrings);this.VWa=pa.Help}Evj(pa){this.lT=
1;this.set_name(pa.Name)}gvj(pa){this.lT=2;this.set_name(pa.name);this.VWa=pa.tooltip}Jwj(pa){this.lT=3;this.set_name(pa.name);this.VWa=pa.toolTip}w5f(pa){this.lT=4;this.set_name(pa.name)}azj(pa){this.lT=5;this.set_name(pa.name);this.VWa=pa.toolTip}$yj(pa){this.lT=7;this.set_name(pa.name)}zxj(){this.lT=6;this.set_name(C.a.instance.mb(192));this.VWa=C.a.instance.mb(193)}get itemType(){return this.lT}get eli(){return this.Cbe}get name(){return this.label}set_name(pa){return this.cde=pa}get label(){return this.cde}get Fja(){return this.VWa}get XBb(){return this.eyg}static Hfh(){return Object(nb.a)(new Ab(!0),
{})}}Object(h.a)(Ab,"AutoCompleteItem",null,[264]);class Yb{constructor(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(h.a)(Yb,"DefinedNameInfo",null,[]);var Bb=a(165);class Qb{constructor(pa){this.hLe={};this.$=pa}get gLe(){const pa=[];if(!this.$.Cb||!this.$.Cb.items)return pa;let tb=0;const Nb=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&X.a.HV(this.$);for(const vc of this.$.Cb.items)if(vc&&(3===vc.type&&vc.usedRange||
Nb&&2===vc.type)){const Ic=new Yb;Ic.tooltip=vc.sheetName+Bc.a.exclamation+vc.usedRange.toString();Ic.name=vc.name;Ic.namedRange=this.t9g(vc.usedRange);Ic.sheetName=vc.sheetName;Ic.type=this.l9g(vc.type);pa.push(Ic);this.hLe[vc.name.toUpperCase()]=Ic;++tb;if(!aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7395300_FixTableAutoCompleteMissingInfo")&&tb===w.Xuf){r.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${w.Xuf}`);break}}return pa}kTj(pa){var tb=
this.hLe[pa.toUpperCase()];if(!tb)return{returnValue:!1,sheetName:"",range:null};pa=tb.sheetName;tb=this.c9g(tb.namedRange);return{returnValue:!0,sheetName:pa,range:tb}}t9g(pa){if(null!=pa&&void 0!=pa)return{top:pa.top,left:pa.left,bottom:pa.bottom,right:pa.right,maxRows:pa.maxRows,maxColumns:pa.maxColumns,sheetName:void 0}}c9g(pa){if(null!=pa&&void 0!=pa)return new Bb.a(pa.top,pa.left,pa.bottom,pa.right,pa.maxRows,pa.maxColumns)}l9g(pa){switch(pa){case 2:return 0;case 3:return 1;default:return-1}}}
Object(h.a)(Qb,"DefinedNameInfoManager",null,[]);var sc=a(128),kb=a(263),Eb=a(260),Gc=a(238);class zc extends Sys.EventArgs{constructor(pa,tb){super();this.functionName=pa;this.ved=tb}}Object(h.a)(zc,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class yb extends Sys.EventArgs{constructor(pa){super();this.tQd=pa}}Object(h.a)(yb,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class gb extends Sys.EventArgs{constructor(pa,tb,Nb){super();this.ved=pa;this.tQd=tb;
this.K0i=Nb}}Object(h.a)(gb,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Kb=a(259);class sd{constructor(pa,tb,Nb,vc,Ic=null){this.Xka=this.U0c=!1;this.$=pa;this.formulaAssistanceUIControl=tb;this.xZe=Nb;this.lrj=vc;this.k$e=Ic;this.Xka=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Hf(){return this.U0c}set Hf(pa){this.U0c!==pa&&(pa?Kb.a(this.$).di(this):Kb.a(this.$).Zz(this),this.U0c=pa)}get de(){return this.lrj}get mc(){return this.formulaAssistanceUIControl.getRootElement(this.xZe)}kg(pa,
tb){pa=!1;tb||(L.h(this.$).zi.textBox.HF=!0,pa=this.formulaAssistanceUIControl.focus(this.xZe));return pa}mh(pa){const tb=this.mc;return!(void 0===tb||null===tb)&&Aa.DOMElementExtensions.Af(tb,pa)}sj(){this.k$e&&this.k$e();if(this.Xka){const pa=L.h(this.$).zi.textBox;this.selection=pa.selection;pa.removeSelection()}}dk(){this.Xka&&(L.h(this.$).zi.textBox.selection=this.selection)}dispose(){Kb.a(this.$).Zz(this)}}Object(h.a)(sd,"FormulaAssistanceFocusManager",null,[34,2]);var Sb=a(38),yc=a(374),Fc=
a(188),Zc=a(35),Rd=a(282),Ed=a(281),ne=a(913);class ze extends Sb.a{constructor(pa,tb){super();this.Ovg=[];this.yed={};this.zed={};this.hT=null;this.f9=[];this.KKa={};this.eDf=(Nb,vc)=>{r.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.QCf(Nb,!!vc&&1!==vc.FilterType,!0)};this.dDf=()=>{r.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.hT=null};this.NCf=
Nb=>{r.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.FKd(Nb.Hja,!0,!1)};this.cDf=Nb=>{r.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.QCf(Nb,!0,!1)};this.fNc=this.hNc=!1;this.jb=pa;this.pluginScheduler=tb;this.$.da.Ga(19,this)}GGa(pa){this.addHandler("FunctionInfoLoaded",pa)}Dcb(pa){this.removeHandler("FunctionInfoLoaded",pa)}CLg(pa){this.addHandler("FunctionInfoReset",pa)}Tgj(pa){this.removeHandler("FunctionInfoReset",
pa)}get JV(){return this.hNc}get ani(){return this.fNc}get qbc(){var pa=this.hT,tb=ne.a(this.$);if(!tb)return pa;tb=tb.OTh();const Nb=tb.length;if(0>=Nb)return pa;const vc=[];vc.push(...pa);for(pa=0;pa<Nb;pa++){const Ic=tb[pa],kd={};kd.FunctionIndex=vc.length;kd.HelpId=kd.GroupUI=null;kd.Help=Ic.description;kd.IsCommonlyUsed=kd.IsCompatibility=!1;kd.NameDataStrings=Ic.name;kd.NameUI=Ic.name;kd.Params=null;kd.ParamsHelp=null;vc.push(kd)}return vc}get med(){return this.f9}get $(){return this.jb}dispose(){const pa=
this.$.da.Aa(268);pa&&pa.mMd(this.NCf);this.jb=null;super.dispose()}rYf(){this.raiseEvent("FunctionInfoReset")}TNd(){this.rYf();this.hNc=!1;this.hT=null;this.fNc=!0}OJa(pa,tb=!1){if(this.JV)this.ZPf();else{r.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.va.UICultureTag}' from the server.`);let vc=null;(vc=this.$.da.Aa(268))||r.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===vc||void 0===vc?0:vc.Hja)&&0<vc.Hja.length)aa.EwaSettings.ma(120)?
vc.sIh(this.cDf):this.FKd(vc.Hja,!0,!1);else{var Nb=this.$.pa.ya.Wb();pa&&(this.$.ea.Zb||tb)&&!this.ani&&(tb?yc.a(this.$.userOperationManager,(Ic,kd,xd)=>ua.o(this.$.pa.ya,pa,Ed.b(Ic,this.eDf),Ed.a(kd,this.dDf),xd,pa,Nb),Ic=>new Fc.a(130,0,Ic,16),null):ua.o(this.$.pa.ya,pa,this.eDf,this.dDf,null,pa,Nb));!this.JV&&this.$.ea.Zb&&(vc?(r.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.JV}, IsSessionActive=${this.$.ea.Zb}`),
vc.mre(this.NCf)):(r.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),ua.o(this.$.pa.ya,{FilterType:0},this.cDf,null,null,null,Nb),this.fNc=!1))}}}yUh(pa){return 0>pa||pa>=this.hT.length?null:this.hT[pa]}Ugd(pa){return Zc.a.Dc(this.yed,pa.toUpperCase())}f3e(pa){return Zc.a.Dc(this.zed,pa.toUpperCase())}Kcc(pa){return Zc.a.Dc(this.KKa,pa)}nic(pa){return!pa.GroupUI}QCf(pa,tb,Nb){const vc=Rd.a(pa);r.ULS.sendTraceTag(537161955,
0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${vc}`);vc?(L.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.Po(pa.Errors)):(this.FKd(pa.Result,tb,Nb),X.a.IV(this.$)&&!X.a.HV(this.$)&&this.mZj())}FKd(pa,tb,Nb){r.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${pa.length}, isCategorized = ${tb}, partialResult = ${Nb} IsFullyLoaded = ${this.JV}`);this.JV||(this.hT=pa,this.yWg(tb),this.hNc=
!Nb,this.ZPf())}ZPf(){this.raiseEvent("FunctionInfoLoaded")}mZj(){const pa=this.qbc;this.pluginScheduler.notifier().setFunctionsInfo(pa);r.ULS.sendTraceTag(512278604,0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===pa||void 0===pa?void 0:pa.length} functions}`)}yWg(pa){var tb=C.a.instance.ga(1029),Nb=[];this.KKa={};this.f9=[];this.KKa[tb]=Nb;const vc=C.a.instance.ga(1030),Ic=[];this.f9.push(tb);this.f9.push(vc);for(let xd=0,ae=this.hT.length;xd<
ae;xd++){tb=this.hT[xd];tb.IsCompatibility||Ic.push(tb);var kd=tb.NameUI;const oe=tb.NameDataStrings;this.yed[oe.toUpperCase()]||(this.yed[oe.toUpperCase()]=tb);this.zed[kd.toUpperCase()]||(this.zed[kd.toUpperCase()]=tb);if(!this.nic(tb)){if(pa){kd=tb.GroupUI;let ve=Zc.a.Dc(this.KKa,kd);ve||(ve=[],this.KKa[kd]=ve,this.f9.push(kd));ve.push(tb)}tb.IsCommonlyUsed&&Nb.push(tb);tb.IsCompatibility||this.Ovg.push(oe)}}this.KKa[vc]=Ic;pa&&(ze.PTf(Nb,[2,3,0,5,4,9,1,7,8,6]),Nb=Array(14),Nb[0]=0,Nb[1]=1,Nb[2]=
7,Nb[3]=11,Nb[4]=5,Nb[5]=2,Nb[6]=6,Nb[7]=10,Nb[8]=9,Nb[9]=3,Nb[10]=4,Nb[11]=13,Nb[12]=12,Nb[13]=8,ze.PTf(this.f9,Nb),Nb=[],Nb.push(...this.f9),Nb.splice(13,1),this.f9=Nb);Nb=(xd,ae)=>xd.NameUI.localeCompare(ae.NameUI);this.hT=[...this.hT];this.hT.sort((xd,ae)=>xd.NameDataStrings.localeCompare(ae.NameDataStrings));for(let xd=1,ae=this.f9.length;xd<ae&&pa;xd++)this.KKa[this.f9[xd]].sort(Nb);for(let xd=0,ae=this.hT.length;xd<ae;xd++)this.hT[xd].FunctionIndex=xd}static PTf(pa,tb){const Nb=[...pa];for(let vc=
0;vc<Nb.length&&vc<tb.length;vc++)pa[vc]=Nb[tb[vc]]}}Object(h.a)(ze,"FunctionInfoManager",Sb.a,[229,230,2]);var Be=a(239),td=a(95),Se=a(50),$b=a(708);class Xc extends td.a{constructor(pa,tb,Nb,vc=null){super(pa,vc);this.e4=null;this.IOb=this.SXd=!1;this.offsetParent=this.Y7=this.J2a=null;this.DLc=!1;this.$Cd=Ic=>this.I6(Ic);this.ZCd=Ic=>this.$N(Ic);this.GBf=Ic=>{const kd=I.HelperMethods.Do(Ic);kd.button===Sys.UI.MouseButton.leftButton&&2===Ic.tb&&(this.Hqd(kd.target)||this.TTa(kd));return!1};this.e9d=
tb;Nb&&(this.SXd=!0,Be.a.instance.sa(sa.a.pointerDown,this.PNe,this.GBf));this.Efa=!1}get $8b(){return this.Efa}get PNe(){return this.e9d}get o$h(){return this.DLc}dispose(){this.SXd&&(Be.a.instance.Ba(sa.a.Kj,this.PNe,this.GBf),this.SXd=!1);this.IOb&&(this.IOb=!1,Be.a.instance.Ba(sa.a.Sf,this.domElement.ownerDocument.body,this.$Cd),Be.a.instance.Ba(sa.a.Kj,this.domElement.ownerDocument.body,this.ZCd));this.e4=this.e9d=null;super.dispose()}mpe(pa){this.e4?this.e4.push(pa):this.e4=[pa]}Hqd(pa){if(this.e4)for(let tb=
0,Nb=this.e4.length;tb<Nb;++tb)if(Aa.DOMElementExtensions.Af(this.e4[tb],pa))return!0;return!1}TTa(pa){this.$8b||(this.Efa=!0,Va.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.Rrh(),Be.a.instance.sa(sa.a.Sf,this.domElement.ownerDocument.body,this.$Cd),Be.a.instance.sa(sa.a.Kj,this.domElement.ownerDocument.body,this.ZCd),this.IOb=!0,this.drag(!0,pa))}drag(pa,tb){da.g(tb);var Nb=new Se.a(0,0),vc=new Sys.UI.Point(tb.clientX,tb.clientY);
tb=this.domElement.parentNode;vc=$b.a.Vs(Nb,tb,vc,this.isRtl());pa?(Nb=$b.a.yF(Nb,tb,this.domElement,this.isRtl()),this.J2a=$b.a.jE(vc,Nb),this.Y7=vc,this.DLc=!1):!this.o$h&&this.k$h(vc,this.Y7)&&(this.DLc=!0);Nb=$b.a.jE(vc,this.J2a);$b.a.Xdb(tb,this.domElement,Nb,this.isRtl(),pa)}xw(pa){this.IOb&&(this.IOb=!1,Be.a.instance.Ba(sa.a.Sf,this.domElement.ownerDocument.body,this.$Cd),Be.a.instance.Ba(sa.a.Kj,this.domElement.ownerDocument.body,this.ZCd));da.g(pa);this.Efa=!1;this.Y7=this.J2a=null}I6(pa){const tb=
I.HelperMethods.Do(pa);tb.button===Sys.UI.MouseButton.leftButton&&2===pa.tb&&this.xw(tb);return!1}$N(pa){2===pa.tb&&this.drag(!1,I.HelperMethods.Do(pa));return!1}k$h(pa,tb){return tb.x<pa.x-2||tb.x>pa.x+2||tb.y<pa.y-2||tb.y>pa.y+2}Rrh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;Aa.DOMElementExtensions.getLocation(this.offsetParent)}}Object(h.a)(Xc,"BaseDraggableBehavior",td.a,[]);class ed extends Xc{constructor(pa,tb,Nb=null,vc=!1){super(pa,tb,!1,Nb);this.WSa(vc);
this.oj=Va.a.equals("rtl",pa.dir,!0)}setVisible(pa){Aa.DOMElementExtensions.setVisible(this.domElement,pa);pa||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.oj}WSa(pa){const tb=this.domElement.style;tb.cursor="move";tb.position=pa?"relative":"absolute"}}Object(h.a)(ed,"FunctionParamBoxDraggableItem",Xc,[]);class Rc{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(h.a)(Rc,"FormulaArgumentAssistanceCallbacks",
null,[]);class Fd{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(h.a)(Fd,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Nd=a(85),zd=a(108),Sd=a(152);class se{constructor(pa){this.Gt=pa;this.uB=this.hTa=this.Oi=!1;this.onKeyDown=tb=>!this.uB&&tb.keyCode===Nd.a.bfa&&tb.altKey&&tb.ctrlKey?(this.c3a(),tb.stopPropagation(),tb.preventDefault(),!0):!1;this.Cla=tb=>{if(!this.uB)return!1;if(tb.eventName===sa.a.Pb){const Nb=
tb.Ca.ctrlKey?1:tb.Ca.shiftKey?50:10;switch(tb.Ca.keyCode){case Nd.a.mpa:this.$K(0,-Nb);break;case Nd.a.v8:this.$K(0,Nb);break;case Nd.a.w8:this.$K(-Nb,0);break;case Nd.a.JCa:this.$K(Nb,0);break;case Nd.a.JG:case Nd.a.Mh:this.hTa=!0;break;default:return!1}}tb.eventName===sa.a.Fd&&this.hTa&&this.cN(!0);tb.Ca.preventDefault();return!0};this.Mza=tb=>{if(!this.uB)return!1;tb.Ca.preventDefault();this.cN();return!0};this.onBlur=()=>{if(!this.uB)return!1;this.cN();return!0};this.Go=zd.KeyInputManager.instance;
this.pointerInputManager=Be.a.instance}la(pa){(this.root=pa)&&!this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!0)}detach(){this.root&&this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!1)}c3a(){this.root&&(this.target=this.Gt.UGb("move",!0),this.jXd=this.target.getBoundingClientRect(),this.uB=!0,this.hTa=!1,this.Qs(),this.Mya||this.Lsb(),this.target.appendChild(this.Mya))}cN(pa=!1){this.Gt.hpc(pa);this.uB=!1;this.RJb();this.EJb();this.jXd=this.target=
void 0}Qs(){this.Go.capture(this.Cla,null);this.pointerInputManager.Ps(sa.a.pointerDown,this.target,this.Mza,!0);this.target.addEventListener("blur",this.onBlur)}EJb(){this.Go.releaseCapture();this.pointerInputManager.Ws(sa.a.pointerDown,this.target,this.Mza,!0);this.target.removeEventListener("blur",this.onBlur)}RJb(){var pa;this.target&&(null===(pa=this.Mya)||void 0===pa?void 0:pa.parentNode)===this.target&&this.target.removeChild(this.Mya)}$K(pa,tb){const Nb=this.target.getBoundingClientRect();
this.Gt.onMove(pa+Nb.left-this.jXd.left,tb+Nb.top-this.jXd.top)}Lsb(){this.Mya=Sd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(h.a)(se,"FormulaAssistanceMoveAdapter",null,[]);var He=a(276);class Gd{constructor(pa){this.Gt=pa;this.Oi=!1}p5(){return this.Oi&&!!this.uD}gza(pa){this.uD.style.cursor="grabbing";this.XKj=pa.clientPoint.x;this.YKj=pa.clientPoint.y;this.Gt.UGb("drag");return!0}Sca(pa){this.Gt.onMove(pa.clientPoint.x-this.XKj,pa.clientPoint.y-this.YKj);
return!0}Rca(){this.xw()}Qca(){this.xw()}la(pa){if(this.uD=pa)this.uD.style.cursor="grab",He.a.instance.PW(this.uD,this),this.Oi=!0}detach(){this.Oi&&this.uD&&(this.uD.style.cursor="",He.a.instance.t1(this.uD,this),this.Oi=!1)}xw(){this.uD.style.cursor="grab";this.Gt.hpc()}}Object(h.a)(Gd,"FormulaAssistanceDragAdapter",null,[285]);class fe{constructor(pa,tb){this.BKa=pa;this.formulaAssistanceTelemetryManager=tb;this.Oi=!1;this.iHa=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");
this.WL={[$d.Drag]:0,[$d.Move]:0};this.sFc=this.BKa.getWindowEdgeBuffer()+1;this.NEb=new se(this);this.gub=new Gd(this)}la(pa,tb,Nb,vc){this.root=pa;this.render=Nb;this.dismiss=vc;this.detach();tb&&(this.gub.la(tb),this.NEb.la(pa.firstChild),this.Oi=!0)}detach(){this.Oi&&(this.gub.detach(),this.NEb.detach(),this.Oi=!1);Aa.DOMElementExtensions.uf(this.placeholder)}clear(){this.BKa.setOverrideTarget(void 0);this.detach();this.LKb()}UGb(pa,tb=!1){this.WL[pa]+=1;this.NAc=this.root.firstChild.getBoundingClientRect();
this.placeholder=this.root.cloneNode(!0);pa=this.placeholder.firstChild;pa.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);tb&&(this.HQa=document.activeElement,pa.tabIndex=0,pa.focus());this.dismiss();return pa}onMove(pa,tb){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(pa,this.sFc-this.NAc.left),window.innerWidth-this.NAc.right-this.sFc)}px, ${Math.min(Math.max(tb,this.sFc-this.NAc.top),window.innerHeight-this.NAc.bottom-this.sFc)}px)`}hpc(pa=
!0){const tb=this.placeholder.firstChild.getBoundingClientRect(),Nb=this.BKa.getDirectionalHint({top:tb.top,left:tb.left});this.BKa.setOverrideTarget({top:1===Nb?tb.bottom:tb.top,left:tb.left});this.render();window.requestAnimationFrame(()=>{Aa.DOMElementExtensions.uf(this.placeholder);this.HQa&&(pa&&this.HQa.focus(),this.HQa=void 0)})}LKb(){const pa=this.WL[$d.Drag],tb=this.WL[$d.Move];0<pa&&(this.formulaAssistanceTelemetryManager.FJ("d"),this.iHa||(this.formulaAssistanceTelemetryManager.RP.argumentAssistanceDragTotalCounter+=
pa),this.WL[$d.Drag]=0);0<tb&&(this.formulaAssistanceTelemetryManager.FJ("m"),this.iHa||(this.formulaAssistanceTelemetryManager.RP.argumentAssistanceMoveTotalCounter+=tb),this.WL[$d.Move]=0)}}Object(h.a)(fe,"FormulaAssistanceDragControl",null,[]);var $d;(function(pa){pa.Drag="drag";pa.Move="move"})($d||($d={}));Object(h.b)("FormulaAssistanceDragMode",$d);class qe extends Gc.a{constructor(pa,tb,Nb,vc,Ic,kd,xd){super(qe.NKa(X.a.k5(pa),X.a.xgf(),xd));this.$=pa;this.zj=tb;this.functionInfoManager=Nb;
this.formulaAssistanceUIControl=vc;this.formulaAssistanceTelemetryManager=Ic;this.pluginScheduler=kd;this.htmlSanitizationHelper=xd;this.L2a=null;this.NY=0;this.Oq=null;this.aZc=!1;this.Hla=this.Qo=null;this.kTa=!0;this.JK=!1;this.Lba=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Rjf=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=ae=>{this.oQb(ae);1===ae?this.formulaAssistanceTelemetryManager.FJ("c"):
this.formulaAssistanceTelemetryManager.FJ("e")};this.ySa=ae=>{const oe={};oe[A.a.DQ]="ArgumentAssistanceCard";const ve={};ve.FunctionName=ae.functionName;oe[A.a.gcd]=ve;this.$.Xc(802602464,0,8,oe)};this.onDismissClick=()=>{this.kTa=!1;this.Rtb();this.JK&&this.Gt.clear();0===this.NY&&this.oQb(1)};this.jg=()=>{this.kTa=!0;this.JK&&this.Gt.clear()};this.$Pi=ae=>{ae.button===Sys.UI.MouseButton.leftButton&&ae.target&&(da.g(ae),this.L2a&&this.L2a.TTa(ae))};this.Tt=()=>{void 0!==this.Qo&&null!==this.Qo&&
this.Qo()};this.Zk=X.a.k5(pa);this.Dui=X.a.xgf();this.j5=this.Zk&&aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.Zk){this.$Rd();this.Oq=new sd(this.$,this.formulaAssistanceUIControl,0,qb.a.Sdd);this.j5&&L.h(this.$).fc.Rm(this.jg);if(this.JK=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!this.formulaAssistanceUIControl)this.Gt=
new fe(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.L2a=new ed(this.domElement,this.$.dF,void 0,X.a.DN(this.$)),this.Gc.la("mousedown",this.$Pi),pa=$get(w.ued,this.zj),this.zj.insertBefore(this.domElement,pa);L.h(this.$).view.ot(this.Tt)}nre(pa){this.addHandler("FAFunctionNameUpdated",pa)}BVf(pa){this.removeHandler("FAFunctionNameUpdated",
pa)}gse(pa){this.addHandler("FAParameterSelectionChangedOld",pa)}ZVf(pa){this.removeHandler("FAParameterSelectionChangedOld",pa)}fse(pa){this.addHandler("FAParameterSelectionChanged",pa)}YVf(pa){this.removeHandler("FAParameterSelectionChanged",pa)}set_visible(pa){this.Zk?pa||this.Rtb():Sys.UI.Control.prototype.set_visible.call(this,pa);return pa}Rtb(){this.formulaAssistanceUIControl&&(this.Qo=null,this.JK&&this.Gt.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Hla=null,this.Oq.Hf=
!1)}show(pa){this.Zk||(this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceRender"]),this.L2a.setVisible(!!pa),this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]),this.aZc&&(this.aZc=!1,this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")))}GNd(){if(!this.j5||this.kTa){this.j5||this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceComputation"]);var pa=L.h(this.$).zi,tb=
{content:pa.text,caretPosition:pa.textBox.caretPosition};(this.Lba?this.pluginScheduler.getRequester().argumentAssistance(tb,0):this.pluginScheduler.requester().argumentAssistance(tb)).then(Nb=>{0===Nb.kind?Nb.payload?(this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"]),this.LEj(this.ysc(Nb.payload),pa.textBox.domElement)):this.Rtb():this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"],!1);return null})}}update(pa,tb,Nb,vc){if(!this.Zk&&pa){this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.aZc=!0;var Ic=this.$.listSeparator;try{var kd=$get(w.wed,this.zj);const xd=$get(w.oed,this.zj);kd.innerText="";xd.innerText="";const ae=$get(w.TZe,this.zj),oe=pa.Params.split(w.Cbd);kd=[];for(let ve=0,Ge=ae.rows.length;ve<Ge;ve++){const ye=ae.rows[ve];Aa.DOMElementExtensions.setVisible(ye,ve<oe.length);let qf=oe[ve];const Ja=w.J0i+ve+"_",Db=pa.NameDataStrings;$get(Ja+w.EHb,ye).innerText=Db;$get(Ja+w.XFd,ye).innerText=Db;if(qf){const rc=oe[ve].split(Ic),Yc=qe.yqd(rc[rc.length-
1]),qd=qe.Ipi(pa);Yc&&(qd&&(2<rc.length?(rc[rc.length-2]+="1",rc[rc.length-3]+="1"):r.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Db,rc.length.toString(),tb)),qe.LQg(rc,qd,tb,pa));qf=rc.join(Ic.toString()+" ");oe[ve]=qf;Nb<rc.length?(kd[ve]=rc[Nb],r.ULS.shipAssertTag(537162072,0,!!rc[Nb]&&1<=rc[Nb].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
Nb,rc.length,Db,ve),rc[Nb]=`${"<b>"}${rc[Nb]}${"</b>"}`,qf=rc.join(Ic.toString()+" ")):r.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Nb+"currRowParamsArray.Length = "+rc.length+", current row = "+ve);vc&&r.ULS.sendTraceTag(558474578,0,50,`formula '${Db}', ${rc.length} params, isElipsis = ${Yc}, isPairsParamsFormula = ${qd}, currentParameterIndex = ${tb}`)}this.Dui?this.htmlSanitizationHelper.Ri($get(Ja+w.urc,ye),"("+(qf||
"")+")"):$get(Ja+w.urc,ye).innerHTML="("+(qf||"")+")"}vc?this.raiseEvent("FAFunctionNameUpdated",new zc(pa.NameDataStrings,oe)):this.raiseEvent("FAParameterSelectionChangedOld",new gb(oe,kd,Nb));ae.className=Sa.a.Cvh+(this.functionInfoManager.nic(pa)?"-udf":"")}catch(xd){throw r.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",pa.NameDataStrings,tb,xd),xd;}this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"])}}dispose(){this.Zk||
(this.Gc.hD(),Y.a.Ia(this.Gc),L.h(this.$).view.er(this.Tt),Y.a.Ia(this.L2a),this.L2a=null);this.Zk&&Y.a.Ia(this.Oq);this.j5&&L.h(this.$).fc.em(this.jg);this.functionInfoManager=this.$=null;super.dispose()}ysc(pa){const tb=new Fd;tb.functionRenderingInfo=pa;tb.cardMode=this.NY;this.jLd(tb);return tb}jLd(pa){pa.callbacks=new Rc;pa.callbacks.onHelpLink=this.bhd(pa.functionRenderingInfo);pa.callbacks.onCardModeChange=this.onCardModeChange;pa.callbacks.onFeedback=this.ySa;this.j5&&(pa.callbacks.onDismissClick=
this.onDismissClick)}LEj(pa,tb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceRender"]);const Nb={};Nb.zoomLevel=U(this.$);this.formulaAssistanceUIControl.updateContext(Nb);this.Qo=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,tb,pa,()=>{})};this.Qo();this.Dvc();this.Rrc(pa);this.JK&&this.Gt.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Qo,()=>
this.formulaAssistanceUIControl.dismiss(this.domElement));this.Oq.Hf=!0;this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")}}bhd(pa){return()=>{J(this.$,pa.helpID,pa.isUDF)}}$Rd(){const pa=sc.a.get(A.a.upb);this.NY=pa?parseInt(pa,10):qe.b8c;this.formulaAssistanceTelemetryManager.H2f(this.NY)}Rrc(pa){var tb=pa.functionRenderingInfo.functionName;this.Hla&&Va.a.equals(this.Hla,tb,!0)?(tb=kb.a.map(pa.functionRenderingInfo.signatures,
Nb=>{let vc="";0<=Nb.signatureParams.activeParam&&Nb.signatureParams.activeParam<Nb.signatureParams.params.length&&(vc=Nb.signatureParams.params[Nb.signatureParams.activeParam]);return vc}),this.raiseEvent("FAParameterSelectionChanged",new yb(tb))):(this.Hla=tb,pa=kb.a.map(pa.functionRenderingInfo.signatures,Nb=>Nb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new zc(tb,pa)))}oQb(pa){this.NY=pa;try{sc.a.Qu(A.a.upb,pa.toString(),Eb.AFrame.r1)}catch(tb){r.ULS.sendTraceTag(537162070,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${tb.message}`)}}Dvc(){const pa=this.formulaAssistanceUIControl.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.FJ(pa)}static yqd(pa){return Va.a.contains(pa,w.n9b,!0)}static Ipi(pa){return!!pa&&Va.a.W2a(pa.NameDataStrings,"IFS")}static LQg(pa,tb,Nb,vc){try{if(!pa||2>pa.length)r.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${vc.NameDataStrings}', ${pa?pa.length.toString():
"currRowParamsArray == null"} params, isPairsParamsFormula = ${tb}, currentParameterIndex = ${Nb}.`);else{var Ic=pa.pop().toString();for(let kd=pa.length-1;kd<Nb;kd++){const xd=pa[kd].trim();if(tb){const ae=pa[kd-1].trim();pa.push(qe.BLh(ae,xd))}else{const ae=qe.Odf(xd);pa.push(qe.u_e(ae))}}pa.push(Ic)}}catch(kd){throw r.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${vc.NameDataStrings}', ${pa?pa.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${tb}, currentParameterIndex = ${Nb}.
Exception: ${kd}`),kd;}}static BLh(pa,tb){pa=qe.Odf(pa);const Nb=qe.F5e(pa);tb=qe.F5e(tb);return qe.u_e(pa,!0,!!Nb&&!!tb&&Nb!==tb)}static Odf(pa){var tb=pa.match(qe.SBd);pa=Va.a.trimEnd(Va.a.trimStart(pa,w.CKf),w.BKf);if(tb&&tb.length){tb=tb[tb.length-1];const Nb=Number.parseLocale(tb)+1;pa=pa.replace(tb,Nb.toString())}else pa=`${pa}${1}`;return pa}static u_e(pa,tb=!1,Nb=!1){let vc="[{0}]";tb&&(vc=Nb?"[{0}":"{0}]");return String.format(vc,pa)}static F5e(pa){return(pa=pa.match(qe.SBd))&&pa.length?
pa[0]:null}static NKa(pa,tb,Nb){if(pa)return document.createElement("div");pa=String.format(w.mLf,w.kLf,w.XFd,Sa.a.cSe,w.EHb,Sa.a.bSe,w.urc);var vc=String.format(w.mLf,w.lLf,w.XFd,Sa.a.cSe,w.EHb,Sa.a.bSe,w.urc);pa=String.format(w.SJh,w.TJh,Sa.a.ZSe,Sa.a.Tsh,y.a.zo,w.TZe,pa,vc);vc=document.createElement("div");tb?Nb.Ri(vc,pa):vc.innerHTML=pa;return vc.firstChild}}qe.SBd=RegExp("\\d+");qe.b8c=0;Object(h.a)(qe,"FormulaArgumentAssistanceControlDeprecated",Gc.a,[263]);class pe{constructor(){this.eia=this.ota=
this.pta=!1;this.rKf=40;this.PDe=41;this.$0a=this.AFd=this.BFd=this.FHb=0;this.fBf=!0;this.dEd=!1;this.kYe=this.hQd=-1}}Object(h.a)(pe,"ParseContext",null,[]);var Ne=a(419),Le=a(912),gf=a(327);class Ye extends Le.a{constructor(pa,tb,Nb,vc){super(pa,tb);this.formulaAssistanceControl=Nb;this.formulaAssistanceTelemetryManager=vc;this.aKf=!1;this.nTa=null;this.znd=0;this.aJa=this.aIc=null;this.tQ=0;this.Spb=tb.textBox;this.Zk=X.a.k5(pa);this.dfj=aa.EwaSettings.xb()}get BAb(){return Object(Ne.a)($a,this.$.rb.Kh)}get KK(){return this.formulaAssistanceControl.se}set KK(pa){this.formulaAssistanceControl.se=
pa}get A6a(){return this.Za.A6a}get Fci(){var pa=this.Spb.text;let tb=!1;if(0>=pa.length)return tb;const Nb=this.$.Kb.Bc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),vc=L.h(this.$).ha.ra.activeCell.clone();var Ic=pa.charCodeAt(0);this.aJa="";this.tQ=this.I0g(pa,this.Spb.caretPosition);Ic=61===Ic&&-1!==this.tQ;if(!aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Ic&&(tb=!0);else if(Ic){if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Ic=
0;for(var kd=this.tQ-1;1<=kd&&!(this.tQ-kd>Ye.Uuf);kd--)if(Ye.pye.includes(pa.charAt(kd))){Ic=kd;break}Ic=pa.substring(Ic+1,this.tQ);pa=""!==Ic?this.$.Cb.getItemByName(Ic):null;kd=this.tQ;for(var xd=this.tQ+1;xd<=this.Za.textBox.caretPosition;xd++)if("["===this.Za.text.charAt(xd))kd=xd;else break;this.tQ=kd}else{Ic=pa.lastIndexOf("[");kd=0;for(xd=Ic-1;1<=xd&&!(Ic-xd>Ye.Uuf);xd--)if(Ye.pye.includes(pa.charAt(xd))){kd=xd;break}Ic=pa.substring(kd+1,Ic);pa=""!==Ic?this.$.Cb.getItemByName(Ic):null}pa&&
2===pa.type?(tb=!0,this.aJa=Ic):L.h(this.$).Bb.Bj(vc)&&(tb=!0,this.aJa="")}Nb.stop();this.znd=Nb.Ac;r.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.znd} milliseconds`);return tb}get key(){return t.a.mwb}get calcManager(){this.aIc||(this.aIc=this.$.da.Aa(266,!1));return this.aIc}get GUd(){if(null!=this.nTa)return this.nTa;if(!aa.EwaSettings.ma(134))return this.nTa=!1;const pa=
L.h(this.$).ha.ra.activeCell.clone();if(1!==pa.yuf||!pa.left||L.h(this.$).ha.ra.Nic())return!1;let tb=this.formulaAssistanceControl.tableManager.Bn(pa);if(tb)return this.nTa=!1;--pa.left;--pa.right;if(!pa.Kz)return!1;tb=this.formulaAssistanceControl.tableManager.Bn(pa);return this.nTa=!!tb&&pa.top===tb.top&&this.formulaAssistanceControl.tableManager.k$g(tb,L.h(this.$))}Zh(pa,tb){this.formulaAssistanceControl.Za=this.Za;-1470715894!==tb&&-1231471547!==tb||!this.bMe()||(this.KK=!1);return super.Zh(pa,
tb)}nCd(){var pa=this.A6a;if(pa||this.GUd)if(this.formulaAssistanceControl.Za=this.Za,this.formulaAssistanceTelemetryManager.Ypb.formulaAssistanceRequestAttemptedCounter++,this.bMe())if(!pa&&this.GUd)this.formulaAssistanceControl.pwe();else if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.Fci){if(pa=this.$.Kb.Bc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.rwe(),pa.stop(),this.Spb.text.endsWith("[")&&
"["!==this.Spb.text.charAt(this.Spb.text.length-2)){const tb=""===this.aJa?this.formulaAssistanceControl.tableManager.Lg:Object(Pb.a)(gf.a,this.$.Cb.getItemByName(this.aJa));r.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${tb.mj} in ${pa.Ac} ms with cell edit regression time of ${this.znd} ms and popup visibility - ${this.KK}`)}}else this.formulaAssistanceControl.Fpb(),
this.aKf&&(this.aKf=this.KK=!1);else this.formulaAssistanceTelemetryManager.Ypb.formulaAssistanceRequestOptimizedCounter++;else this.KK=!1}uh(){this.dfj||(this.nTa=null,this.GUd&&this.formulaAssistanceControl.TZ())}jg(){this.KK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Mvc();this.Zk&&this.mAi()}QId(pa,tb){return this.formulaAssistanceControl.Zh(pa,tb)}mAi(){aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.kaa&&
!this.formulaAssistanceControl.Iia&&!this.formulaAssistanceControl.woa&&(this.formulaAssistanceTelemetryManager.MJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.kaa=!1);this.formulaAssistanceControl.VI&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter++,this.formulaAssistanceControl.VI=!1);this.formulaAssistanceControl.woa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.woa=!1);this.formulaAssistanceControl.NTa&&
(this.formulaAssistanceTelemetryManager.qK.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.NTa=!1);this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.qK.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1);this.formulaAssistanceControl.bNa&&(this.formulaAssistanceTelemetryManager.qK.isCellContentFormulaCounter++,this.formulaAssistanceControl.bNa=!1)}I0g(pa,tb){let Nb=0,vc;for(;-1!==
Nb;)if(Nb=pa.indexOf("[",Nb+1),-1!==Nb&&Nb<tb&&(vc=pa.indexOf("]",Nb+1),-1===vc||vc>=tb))return Nb;return-1}bMe(){const pa=this.Za.text,tb=this.Za.textBox.caretPosition,Nb=this.formulaAssistanceControl.c6,vc=this.formulaAssistanceControl.jca;if(this.KK&&Va.a.equals(pa,Nb,!0)&&tb===vc)return!1;this.formulaAssistanceControl.c6=pa;this.formulaAssistanceControl.jca=tb;return!0}}Ye.pye=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Ye.Uuf=255;Object(h.a)(Ye,"FormulaAutoCompleteListAutoCompleteBehavior",Le.a,[]);
var $e=a(30),Ya;(function(pa){pa[pa.function=0]="function";pa[pa.field=1]="field";pa[pa.definedName=2]="definedName";pa[pa.letVariable=3]="letVariable";pa[pa.tableColHeaderName=4]="tableColHeaderName";pa[pa.tableSpecialStructRef=5]="tableSpecialStructRef";pa[pa.pendingData=6]="pendingData";pa[pa.tableNamedObject=7]="tableNamedObject"})(Ya||(Ya={}));Object(h.b)("ItemType",Ya);var ra=a(1093),ya=a(1092);class mb{constructor(pa){this.index=pa}execute(pa){pa.push(this.index)}}Object(h.a)(mb,"AppendIndexOperation",
null,[284]);class Hb{execute(){}}Object(h.a)(Hb,"NopIndexOperation",null,[284]);class Zb{constructor(pa,tb){this.M5i=pa;this.Xwf=tb}execute(pa){for(let tb=0;tb<pa.length;tb++)pa[tb]===this.M5i&&(pa[tb]=this.Xwf)}}Object(h.a)(Zb,"ReplaceIndexOperation",null,[284]);var mc=a(79);class Pc{constructor(pa,tb){this.$=pa;this.items=tb;this.qNa=X.a.qNa(this.$)}AIe(pa,tb){const Nb=new mb(tb);if(!this.qNa)return Nb;pa=this.Iui(pa,tb);return null!=pa?this.items[pa].XBb?new Zb(pa,tb):new Hb:Nb}Iui(pa,tb){const Nb=
this.items[tb];r.ULS.shipAssertTag(537162075,0,!!Nb,"Internal error: invalid item index");pa=mc.where(mc.asEnumerable(pa),vc=>this.items[vc].name===Nb.name);return mc.Ct(pa)?mc.first(pa):null}}Object(h.a)(Pc,"FilterItemOperationFactory",null,[]);var fd=a(117),id=a(839);class Dd{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(h.a)(Dd,"CompletionItem",null,[]);const Zd=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${y.a.zo}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${y.a.zo}'>{5}</td>\r\n</tr>`,
bc=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${y.a.zo}'></td>\r\n\t<td id='${"item_type_cell"}' class='${y.a.zo}'>{2}</td>\r\n</tr>`,Qc=`<td>\r\n\t<div class='${y.a.zt}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,pd=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${y.a.zo}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${y.a.zo}'>{2}</td>\r\n</tr>`;
class ce extends ra.a{constructor(pa,tb,Nb,vc,Ic,kd){super(pa,tb);this.htmlSanitizationHelper=Ic;this.Hra=null;this.afb=this.lxc=0;this.Yrb=null;this.UZe=Nb;this.kwb=vc;this.formulaAssistanceControl=kd;this.qp=[];this.zW=[];this.ikf=(this.Zk=X.a.k5(pa))&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");this.Pni=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7253303_ReduceInnerHTMLUsageFormulaAutoCompleteListBox")}BXc(pa){this.addHandler("FLBSelectedRowChanged",
pa)}FMd(pa){this.removeHandler("FLBSelectedRowChanged",pa)}i0b(pa){this.addHandler("ACLBUpdated",pa)}Suc(pa){this.removeHandler("ACLBUpdated",pa)}get Xjc(){return 0<this.afb&&this.afb===this.qp.length}get hsi(){return 0<this.afb}get se(){return super.se}set se(pa){super.se=pa;pa||(this.lxc=0,this.ee=null);0===this.lxc?Aa.DOMElementExtensions.setVisible(this.kwb,pa&&!this.Zk):Aa.DOMElementExtensions.setVisible(this.kwb,!1)}get Qj(){return this.Hra}set Qj(pa){this.dCa(this.Qj);if(pa){this.UZe.innerText=
"";this.Hra=pa;var tb=this.dCa(this.Qj);const Nb=pa.rowIndex+1,vc=$get("description_cell"+Nb,pa);this.kwb.innerText=vc.innerText;const Ic=$get("item_type_cell",pa);this.ee=tb=tb.innerText;this.lxc="field"===Ic.innerText?1:"definedName"===Ic.innerText?2:"letVariable"===Ic.innerText?3:"tableColHeaderName"===Ic.innerText?4:"tableSpecialStructRef"===Ic.innerText?5:"pendingData"===Ic.innerText?6:"tableNamedObject"===Ic.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new ya.a(this.qp.length,Nb,tb,
vc.innerText));this.Ywc(pa)}}get FUa(){return this.kwb}get nHa(){return this.formulaAssistanceControl}get O0(){return this.lxc}dispose(){super.dispose();this.Hra=this.UZe=this.kwb=null}vBc(pa,tb,Nb,vc=0){this.ikf||this.b8(!1);let Ic="";Nb&&(Ic+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${Sa.a.s5g}'>${Nb}</td></tr></table>`);Ic+=`<table class='${this.i6}' aria-live='off'><tbody>`;const kd=new vb.a;for(let ae=0,oe=this.zW.length;ae<oe;ae++)Ic+=this.U7e(pa[this.zW[ae]],ae+1,
tb,vc),this.Zk&&kd.add(this.u1e(pa[this.zW[ae]]));let xd=this.zW.length;for(let ae=0,oe=this.qp.length;ae<oe;ae++)this.zW.includes(this.qp[ae])||(xd++,Ic+=this.U7e(pa[this.qp[ae]],xd,tb,vc),this.Zk&&kd.add(this.u1e(pa[this.qp[ae]])));Ic+="</tbody></table>";this.Pni?this.htmlSanitizationHelper.Ri(this.Lf,Ic):this.Lf.innerHTML=Ic;this.Jn=Aa.DOMElementExtensions.nk(this.domElement,this.i6);this.Zk&&(this.Yrb=kd.toArray());this.ikf?(this.se=!0,this.nHa.set_visible(!0)):(this.b8(!0),this.IOg(!!Nb))}qKa(pa,
tb,Nb,vc="",Ic=0,kd=!1){if(pa){var xd=[],ae=[];this.afb=0;var oe=new Pc(this.$,pa);if(tb){var ve=!!tb&&0<Ic,Ge=ve&&91===tb.charCodeAt(Ic+1)?Ic+2:Ic+1;kd=ve?tb.length===Ge:!1;ve&&tb.length===Ic&&aa.EwaSettings.ma(134)&&(kd=!0);var ye=null;!kd&&ve&&tb.length>Ic+1&&(ye=tb.substring(Ge,tb.length));if(tb)for(let qf=0,Ja=pa.length;qf<Ja;qf++)if(ve=pa[qf].name,!pa[qf].eli){Ge=oe.AIe(xd,qf);pa[qf].XBb&&this.afb++;if(!ye&&!kd||0===pa[qf].itemType)({Udf:xd,tNf:ae}=this.tXe(tb,ve,Nb,Ge,xd,ae));ye&&1===pa[qf].itemType&&
({Udf:xd,tNf:ae}=this.tXe(ye,ve,!0,Ge,xd,ae));kd&&1===pa[qf].itemType&&Ge.execute(xd)}}else for(Nb=0;Nb<pa.length;++Nb)if(pa[Nb].XBb||kd)ye=oe.AIe(xd,Nb),ye.execute(xd),ye.execute(ae),pa[Nb].XBb&&this.afb++;this.zW=ae;this.qp=xd;this.vBc(pa,tb,vc,Ic)}}oYj(pa){if(pa&&!(1<pa.length)){var tb=[],Nb=[];tb.push(0);Nb.push(0);this.zW=tb;this.qp=Nb;this.vBc(pa,"","",0)}}Kya(){this.Qj&&super.Kya()}l9i(pa,tb){this.raiseEvent("ACLBUpdated",new ya.a(pa,void 0,void 0,tb))}rjg(pa){const tb=this.Jn.rows[pa];return(!this.Qj||
this.Qj!==tb)&&pa<this.Jn.rows.length?(this.Qj=tb,!0):!1}static v1e(pa){switch(pa){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(pa){da.g(pa.Ca);0===this.O0||2===this.O0||3===this.O0||4===this.O0||5===this.O0||7===this.O0?(this.raiseEvent(id.a.F5a),this.Kya()):1===this.O0?this.nHa.jz(!1):(this.nHa.jz(!1),pa=L.h(this.$),pa.To(!1),pa.focus());return!0}IOg(pa){this.tsa();if(pa){var tb=this.Jn.offsetWidth+
(this.qp.length>this.pI?fd.a.Ou:0);pa=$get("list_column_header");pa.offsetWidth>tb&&Aa.DOMElementExtensions.Vv(this.Lf,pa.offsetWidth);tb=this.Lf.getElementsByClassName(this.XV);for(let Nb=0;Nb<tb.length;Nb++)tb[Nb].style.width=I.HelperMethods.uc(pa.offsetWidth)}}U7e(pa,tb,Nb,vc){if(1===pa.itemType){const Ic=$e.a.Hg(pa.name),kd=$e.a.Hg(vc?Nb.substring(vc+1,Nb.length):Nb);let xd=0;Ic.substring(0,kd.length).toLowerCase()!==kd.toLowerCase()&&(xd=ce.DKj(Ic,w.Bmg,kd));Nb="";Nb=0<=xd?Nb+(Ic.substring(0,
xd)+"<b>"+Ic.substring(xd,xd+kd.length)+"</b>"+Ic.substring(xd+kd.length,Ic.length)):Nb+Ic;vc=vc?String.format(Qc,y.a.zTe,$e.a.XQ(Ra.a.me(0)),C.a.instance.ga(712)):"";return String.format(bc,vc,tb,Ya[pa.itemType],this.XV,Nb)}if(5===pa.itemType)return String.format(pd,"",tb,Ya[pa.itemType],this.XV,$e.a.Hg(pa.name),$e.a.Hg(pa.Fja));if(4===pa.itemType)return String.format(pd,"(...)",tb,Ya[pa.itemType],this.XV,$e.a.Hg(pa.name));if(6===pa.itemType)return vc=vc?String.format(Qc,y.a.zTe,$e.a.XQ(Ra.a.me(0)),
C.a.instance.ga(712)):"",String.format(Zd,vc,this.XV,$e.a.Hg(pa.name),$e.a.Hg(pa.Fja),tb,Ya[pa.itemType]);vc=String.format(Qc,2===pa.itemType||3===pa.itemType?y.a.Hyh:y.a.Fyh,$e.a.XQ(Ra.a.me(0)),C.a.instance.ga(709));return String.format(Zd,vc,this.XV,$e.a.Hg(pa.name),$e.a.Hg(pa.Fja),tb,Ya[pa.itemType])}u1e(pa){const tb=new Dd;tb.label=pa.label;tb.textEdit=pa.textEdit;tb.kind=ce.v1e(pa.itemType);tb.type=pa.XBb?1:0;if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&
3===tb.kind){const Nb=this.formulaAssistanceControl.zUh(pa.label);tb.detail=Nb?Nb:pa.Fja}else tb.detail=pa.Fja;return tb}tXe(pa,tb,Nb,vc,Ic,kd){Va.a.equals(tb,"Pretend this is the line.",!1)&&0<Ic.length||Va.a.YI(tb,pa)?(vc.execute(Ic),vc.execute(kd)):Nb&&pa.length>=w.n$g&&ce.bkh(tb,w.Bmg,pa)?vc.execute(Ic):!Nb&&pa.length>=w.m$g&&Va.a.contains(tb,pa,!0)&&vc.execute(Ic);return{Udf:Ic,tNf:kd}}static bkh(pa,tb,Nb){for(const vc of tb)if(tb=pa.split(vc),!(2>tb.length))for(const Ic of tb)if(Va.a.YI(Ic,
Nb))return!0;return!1}static DKj(pa,tb,Nb){for(const vc of tb)if(tb=pa.toLowerCase().indexOf((vc+Nb).toLowerCase()),0<tb)return tb+1;return-1}}Object(h.a)(ce,"FormulaAutoCompleteListBox",ra.a,[262]);class ke{constructor(){this.N9=this._name=null}get name(){return this._name}get toolTip(){return this.N9}}Object(h.a)(ke,"LETVariableInfo",null,[]);class Oe{constructor(){this._name=null}get name(){return this._name}}Object(h.a)(Oe,"TableColHeaderNameInfo",null,[]);class Fe{constructor(){this._name=null}get name(){return this._name}}
Object(h.a)(Fe,"TableNamedObjectInfo",null,[]);class Xe{constructor(){this.N9=this._name=null}get name(){return this._name}get toolTip(){return this.N9}}Object(h.a)(Xe,"TableSpecialStructRefInfo",null,[]);var pf=a(172),Ae=a(29),Ie=a(100),Hf=a(909),xe=a(251),Ze=a(51),nf=a(145);class hf{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(h.a)(hf,"FormulaAutoCompleteCallbacks",null,[]);class bb{constructor(){this.callbacks=
this.completionItems=null;this.activeItemIndex=0}}Object(h.a)(bb,"FormulaAutoCompleteRenderingInfo",null,[]);class Lb{}Object(h.a)(Lb,"RunExperimentRequest",null,[]);class nc extends gc.a{constructor(pa,tb,Nb,vc,Ic,kd,xd,ae,oe,ve){super(pa);this.functionInfoManager=tb;this.calcManager=vc;this.instantaneousSupportInformationManager=Ic;this.formulaAssistanceUIControl=xd;this.formulaAssistanceTelemetryManager=ae;this.pluginScheduler=oe;this.ofc=!1;this.U5=this.wud=this.TV=this.Lg=this.oHa=this.Oq=null;
this.U6b=this.YOb=this.eub=this.yNe=this.d4=this.rbc=this.j4a=0;this.xzc=!1;this.Arc=this.hja=null;this.columnName="";this.NAe=this.l8c=!1;this.CKa=[];this.sQ=null;this.kOb=[];this.E8=this.xed=this.Qo=null;this.Iia=this.kaa=this.bNa=this.isCellContentOnlyEqualDuringEdit=this.NTa=this.woa=this.VI=this.Ufa=!1;this.c6=null;this.jca=0;this.I5d=null;this.IEb=0;this.opd=!1;this.onRestoreFocus=()=>{};this.dhb=void 0;this.Lba=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");
this.Rjf=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.qBb=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Bkd=()=>{this.Zk&&this.raiseEvent(nc.Add,null)};this.pXe=()=>{this.hja=!1;this.TV=this.Za.text;this.Xg.qKa(this.yr,this.TV,!0,this.columnName,void 0,!1);1===this.Xg.qp.length&&1===this.Xg.zW.length?(this.set_visible(!1),this.NAe||this.tnd()):this.show()};this.lDf=Ge=>
{if(Rd.a(Ge))-315732528!==Ge.Errors[0].MessageId&&r.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${Ae.a.sc(Ge.Errors)}`);else if((Ge=Ge.Result)&&Ge.length){this.Lg.XO||(this.Lg.XO={},this.Lg.XO.HeadersList=[]);this.Lg.XO.IsFullTableHeaders=!0;for(let ye=0;ye<Ge.length;++ye)this.Lg.XO.HeadersList[ye]={},this.Lg.XO.HeadersList[ye].Index=ye,this.Lg.XO.HeadersList[ye].Name=Ge[ye];this.RMf(!0);this.TV=this.T7e();
this.Xg.qKa(this.yr,this.TV,!0,void 0,void 0,!0);this.show()}else r.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.kDf=Ge=>{Ge=za.a.Pe(Ge.data);r.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${Ae.a.sc(Ge)}`)};this.Oyf=(Ge,ye)=>{this.gridView.eb||this.gridView.ri||this.pPa(null===ye||void 0===ye?void 0:ye.cell)};this.uh=(Ge,ye)=>{this.pPa(null===
ye||void 0===ye?void 0:ye.yja)};this.G6=(Ge,ye)=>{this.nPd(ye.newValue)};this.Pc=()=>{(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Zk)&&this.set_visible(!1)};this.PCf=()=>{this.E8=this.oHa=null};this.Gh=()=>{this.Zk&&this.A2a()};this.onFunctionInfoLoaded=()=>{this.Fpb()};this.hza=()=>{this.Hka?(this.oHa=this.E8=null,this.Fpb()):this.Vg.$k&&this.pwe()};this.Uca=()=>{this.sQ&&J(this.$,this.sQ.HelpId,this.sQ.IsDynamicUdf);return!0};this.Wca=
(Ge,ye)=>{0==ye.Lr&&(170==ye.Tf.operation.operationName&&this.formulaAssistanceTelemetryManager.slc++,this.$.userOperationManager.ko(this.Wca))};this.NPa=(Ge,ye)=>{0==ye.Lr&&(12==ye.Tf.operation.operationName&&this.$.userOperationManager.ur(this.Wca),this.$.userOperationManager.ko(this.NPa))};this.A2a=()=>{this.Zk&&this.Dwd();aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.VI&&(this.kaa=!0);this.PF&&this.Za.eb&&this.pna();this.Qo=null;this.formulaAssistanceUIControl&&
(this.formulaAssistanceUIControl.dismiss(this.W1b),this.Oq.Hf=!1);this.opd=!1};this.NHf=()=>{this.PF&&this.pna();this.u9f();1===this.q1f.type&&aa.EwaSettings.xb()&&!this.Za.text.includes("\n")&&this.JHd(this.q1f)};this.onDismiss=()=>{this.se=!1;this.gridView.zi.textBox.focus()};this.ySa=()=>{const Ge={};Ge[A.a.DQ]=this.Xg.Xjc?"SmartSuggestionsCard":this.Xg.hsi?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Xc(802602464,0,8,Ge)};this.OCd=(Ge,ye)=>{this.Xg.rjg(ye);this.Zk&&(this.tJa=
!0)};this.NCd=Ge=>{this.Zk&&(this.qJa=!0);this.PF?(this.bFe(),this.U_f(),this.gridView.uaa.w2f(),this.gridView.zi.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Ge.textEdit?this.Trb(Ge.textEdit):this.jz(!0)};this.yq=L.h(pa);this.domElement.className=Sa.a.VQe;this.Vg=kd.M5c(pa,Nb);this.H7b=new Qb(pa);this.FDg=Nb;nc.Ufc||(nc.Ufc=nc.NKa());aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252767_ReduceInnerHTMLUsageFormulaAssistanceControl")?
ve.Ri(this.domElement,nc.Ufc):this.domElement.innerHTML=nc.Ufc;this.SBd=RegExp("\\d+");xe.d(this.style,this.$.isChromeRtl);this.zja=new qe(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,ve);tb=$get(w.ued,this.domElement);Nb=$get(w.oed,this.domElement);vc=$get(w.wed,this.domElement);this.Jvg=new ce(this.$,tb,vc,Nb,ve,this);this.Vg.$_b(this.hza);this.functionInfoManager.GGa(this.onFunctionInfoLoaded);this.functionInfoManager.CLg(this.PCf);
this.W1b=this.domElement;this.Zk&&(this.$.xa.Xf(this.Gh),this.Xg.BXc(this.NHf),aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.W1b=document.createElement("div")));this.dUa(!0);this.Lbg(!0);this.$.domElement.appendChild(this.W1b);this.HSc=0;(ve=T.a(pa))&&this.CKa.push(new Ye(pa,ve,this,this.formulaAssistanceTelemetryManager));this.CKa.push(new Ye(pa,this.yq.Vb,this,this.formulaAssistanceTelemetryManager));this.ewb=this.CKa[0];this.erb=this.CKa[this.CKa.length-
1];pa.da.Ga(221,this);this.instantaneousSupportInformationManager||this.$.da.$a(268,Ge=>{this.instantaneousSupportInformationManager=Ge});this.EWe=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);aa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.lX.anyPluginInitialized?r.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):
this.formulaAssistanceTelemetryManager.lX.anyPluginInitialized||(this.IEb=aa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.MTa=X.a.qNa(this.$);this.oDj=X.a.Rpb(this.$);this.sBd=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.w_c=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");X.a.IV(this.$)&&this.pod();X.a.DN(this.$)&&tb.classList.add("ewa-fb-refactor");this.Zk?this.gridView.ha.hH(this.Pc):
this.gridView.ha.TT(this.Pc);this.Oq=new sd(this.$,this.formulaAssistanceUIControl,1,qb.a.Udd,this.Bkd);this.Xpd=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.xni=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1)}lre(pa){this.addHandler(nc.$dd,pa)}AVf(pa){this.removeHandler(nc.$dd,pa)}jre(pa){this.addHandler(nc.Add,pa)}yVf(pa){this.removeHandler(nc.Add,pa)}kre(pa){this.addHandler("FormulaAutoCompleteShown",pa)}zVf(pa){this.removeHandler("FormulaAutoCompleteShown",
pa)}get ou(){return this.Xg}get yr(){return this.E8}get $Lb(){return this.Xg.ee}get PZe(){return this.Xg}get wZe(){return this.zja}get Xg(){return this.Jvg}get W1a(){return this.MTa?this.Za?this.Za.text:null:this.TV}get nkf(){var pa;return 0===(null===(pa=this.jYe)||void 0===pa?void 0:pa.type)}get qsi(){var pa;return 1===(null===(pa=this.jYe)||void 0===pa?void 0:pa.type)}get_visible(){return void 0!==this.dhb?this.dhb:this.dhb=super.get_visible()}set_visible(pa){if(this.dhb===pa)return this.Zk&&!pa&&
this.A2a(),pa;this.zja.set_visible(pa);this.Zk&&!pa&&this.A2a();Sys.UI.Control.prototype.set_visible.call(this,pa);return this.dhb=pa}get se(){return this.ou.se}set se(pa){this.Zk&&!pa&&this.A2a();this.ou.se=pa}get tableManager(){return this.FDg}get Hka(){return 0<this.xZ}get PF(){return this.Ufa}get gridView(){return this.xni?this.yq:L.h(this.$)}get Bb(){return this.gridView.Bb}R_g(pa,tb){this.se&&(pa+=w.openParen,tb++,this.aGd(pa,tb));var Nb=tb===pa.length||pa.charAt(tb)===w.closeParen;if(!(0<tb&&
pa.charAt(tb-1)===w.openParen&&Nb))return r.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${tb} is invalid. Is cell empty: ${!pa.length}. Function exists in cell: ${!!this.sQ}`),!1;Nb=pa.substring(0,tb).lastIndexOf(this.$.listSeparator);const vc=pa.substring(0,tb-1).lastIndexOf(w.openParen);pa=pa.substring(-1===Nb&&-1===vc?1:Math.max(Nb,vc)+1,tb-1).trim();return this.functionInfoManager.Ugd(pa)?!0:(r.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.sQ}`),
!1)}ahi(pa,tb){var Nb=this.R_g(pa,tb);if(!Nb||!this.sQ)return r.ULS.shipAssertTag(537162051,0,!Nb||Nb&&!!this.sQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Twf:0,lYe:0};Nb=this.sQ.Params;Nb=Nb.replace(RegExp("[\\[\\]]","g"),"");const vc=pa.charAt(tb-1)===w.openParen,Ic=vc?"":"(",kd=tb===pa.length?")":"";var xd=this.$.listSeparator;xd=Nb.includes(xd)?Nb.indexOf(xd):Nb.length;return{returnValue:pa.substring(0,tb)+Ic+Nb+kd+pa.substring(tb,
pa.length),Twf:vc?tb:tb+1,lYe:xd}}Tt(pa,tb){this.Zk&&void 0!==this.Qo&&null!==this.Qo&&this.Qo();this.Zk||super.Tt(pa,tb)}get G1b(){return this.I5d}get xZ(){return this.yNe}set xZ(pa){this.yNe=pa;pa||(this.d4=0)}get UCj(){if(null==this.Arc){const pa=this.$.dc;this.Arc=!!pa&&!pa.inEmbedView}return this.Arc}get q1f(){return this.Xg.Yrb[this.Xg.Qj.rowIndex]}get jYe(){var pa,tb;return null===(tb=null===(pa=this.Xg)||void 0===pa?void 0:pa.Yrb)||void 0===tb?void 0:tb[0]}get XZe(){!this.xed&&this.pluginScheduler&&
(this.xed=this.pluginScheduler.getFunctionsShortDescriptions());return this.xed}dispose(){if(this.$){this.dUa(!1);const pa=this.gridView;this.$.userOperationManager.ko(this.Wca);this.$.userOperationManager.ko(this.NPa);pa&&(pa.ha&&(this.Zk?pa.ha.kG(this.Pc):pa.ha.$R(this.Pc),X.a.IV(this.$)&&4!==this.IEb&&(this.qBb?pa.fc.Gk(this.uh):pa.ha.qna(this.Oyf))),pa.view.er(this.spc));this.Zk&&this.$.xa&&this.$.xa.Eg(this.Gh)}this.functionInfoManager&&(this.functionInfoManager.Dcb(this.onFunctionInfoLoaded),
this.functionInfoManager.Tgj(this.PCf));this.Vg&&this.Vg.Kuc(this.hza);this.Zk&&this.Xg&&this.Xg.FMd(this.NHf);X.a.ihc&&this.Za&&this.Za.dKb(this.G6);this.Lbg(!1);Y.a.Ia(this.Xg);Y.a.Ia(this.G1b);Y.a.Ia(this.zja);Y.a.Ia(this.Oq);this.Za=this.functionInfoManager=this.Vg=null;Y.a.rc(this.CKa);this.Lg=this.E8=this.zja=this.CKa=null;super.dispose()}yxa(){return!this.yr}moi(){return!this.oHa}YVj(pa){this.qsi&&1872288872===pa&&(this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionActiveDismissing"]),
this.Iia=!0)}Zh(pa,tb){if(!this.yxa()){aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.YVj(tb);if(this.Zk&&this.PF){if(125627505===tb||267796030===tb)return this.Zk&&this.ADc(tb),this.bFe(),this.U_f(),!1;if(1872288872===tb)return this.pna(),this.se=!1,!0;if(this.Xg.Xjc&&(-798660877===tb||137938150===tb))return!1}if(1!==this.Xg.O0||125627505!==tb&&267796030!==tb)if(6===this.Xg.O0){var Nb=pa.keyCode;13!==Nb&&9!==Nb||this.jz(!1)}else{if(4===this.Xg.O0||5===
this.Xg.O0)return super.Zh(pa,tb,!0);1===this.Xg.zW.length&&(Nb=pa.keyCode,this.NAe=8===Nb||127===Nb||46===Nb?!0:!1)}else{if(this.jz(!1)&&!this.Hka)return this.gridView.ha.Zh(pa,tb);if(125627505===tb&&this.Hka)return!0}}return super.Zh(pa,tb)}Mvc(){this.Vg.bdb();this.E8=null;null==this.hja||this.hja||this.Ulc("NoFieldChosen",1,2,1);this.hja=null;this.xZ=0;this.U5=this.wud=this.Arc=null}Fpb(){this.Rjf&&this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceOverall"]);const pa=!!this.Za&&!Ib.f(this.$.oa);
let tb=null;pa&&(tb=this.Za.text,tb.startsWith("=")&&(this.bNa=!0,1===tb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.oDj&&pa){const Nb={content:tb,caretPosition:null};(this.Lba?this.pluginScheduler.getRequester().functionSuggestion(Nb,0):this.pluginScheduler.requester().functionSuggestion(Nb)).then(vc=>{if(0===vc.kind){r.ULS.shipAssertTag(537162050,0,!!vc&&!!vc.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Ic=mc.toArray(mc.select(mc.asEnumerable(vc.payload.items),
kd=>nc.$8g(kd)));this.gridView.uaa.eSd(vc.payload,tb);this.MTa&&(this.kOb=Ic,Ua.AFrameworkApplication.Og||(this.w_c&&this.Bb.H5(this.gridView.ha.ra.activeCell)?this.formulaAssistanceTelemetryManager.qK.smartSuggestionWouldSuggestInsidePivotCounter++:this.qwe(pa,!0)))}return null})}this.MTa&&pa||this.qwe(pa,!1)}T7e(){if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var pa=this.gridView.Ul?this.ewb.tQ:this.erb.tQ;this.YOb="@"===this.Za.text.charAt(pa+
1)&&this.Za.textBox.caretPosition>pa+1?pa+2:pa+1}else{pa=this.Za.text.lastIndexOf(w.Fpf);const tb=this.Za.text.lastIndexOf("[");this.YOb=pa+1>=tb?pa+2:tb+1}return this.Za.text.substring(this.YOb,this.Za.textBox.caretPosition)}rwe(){this.H9f()&&(this.Yfh(),this.yr&&(this.hja=!1,this.TV=this.T7e(),this.Xg.qKa(this.yr,this.TV,!0,void 0,void 0,!0),this.show(),aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.zja.Rtb()))}pwe(){this.H9f()&&(this.G1b&&
this.G1b.cancel(),this.Vg.r7a?(this.yxa()&&this.nHe(!0),this.get_visible()?this.pXe():this.I5d=pf.AsyncMethodContext.Er(this.pXe,w.xjh,Ma.a.QIh,this.G1b)):this.TZ())}H9f(){return this.Za?0<this.$.rb.JR||!this.Za.text||!this.Za.eb?(this.set_visible(!1),!1):Ib.f(this.$.oa)?!1:!0:!1}Trb(pa){this.Za&&this.se&&(this.Eod(this.Za.text,pa),this.Za.textBox.caretPosition=pa.range.start.character+pa.newText.length,this.set_visible(!1))}jz(){var pa;if(!this.Za||!this.se)return!1;const tb=this.Xg.O0;this.formulaAssistanceTelemetryManager.Ldf(ce.v1e(tb));
let Nb="";var vc=0;const Ic=this.gridView;var kd=this.Za.text,xd=0,ae=this.Xg.ee,oe=!1;if(0===tb||2===tb||3===tb||7===tb)Nb+=kd.substr(0,this.j4a)+this.Xg.ee,0!==tb||this.Xg.ee.endsWith(")")||(Nb+="("),vc=Nb.toString().length,Nb+=kd.substr(this.rbc),2===tb&&(xd=4,ae="DefinedName",oe=!0,this.set_visible(!1));else if(1===tb)if(this.hja=!0,this.Hka){Nb+=kd.substr(0,this.xZ+2);!Nb.toString().endsWith(Bc.a.LU)&&aa.EwaSettings.ma(134)&&(Nb+=Bc.a.LU);xd=this.Xg.ee;xd=xd.replace("'","''");xd=xd.replace("[",
"'[");xd=xd.replace("]","']");if(this.l8c||this.vEh(xd))xd=Bc.a.kxi+xd+Bc.a.coj,oe=!0;Nb+=xd;vc=Nb.length;xd=3;nf.a("PulloutFieldAccepted")}else return this.Za.text=this.Xg.ee,this.set_visible(!1),Ic.To(!1),Ic.focus(),this.Ulc("FieldName",1,1,1),nf.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===tb)r.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),Nb+=kd.substr(0,this.YOb),Va.a.equals(this.Xg.ee,"@ - "+this.instantaneousSupportInformationManager.Ke.ThisRowStructRefString,
!1)?Nb+="@":(Nb+=this.Xg.ee,oe=!0,this.set_visible(!1)),vc=Nb.length;else if(4===tb){r.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");Nb+=kd.substr(0,this.YOb);oe="";vc=!1;var ve=[39,91,93,64,35];for(let Ge=0;Ge<this.Xg.ee.length;Ge++){const ye=this.Xg.ee.charCodeAt(Ge);ve.includes(ye)&&(oe+="'");oe+=this.Xg.ee.charAt(Ge).toString();vc||Va.a.isNumeral(ye)||Va.a.Ejf(ye)||(vc=!0)}ve=this.gridView.Ul?this.ewb.tQ:this.erb.tQ;kd=
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===kd.charAt(ve+1)&&vc:kd.lastIndexOf(w.Fpf)+1>=kd.lastIndexOf("[")&&vc;Nb+=kd?"["+oe+"]":oe;oe=!0;this.set_visible(!1);vc=Nb.toString().length}else if(6===tb)Nb+=kd.substr(0,this.eub);else return r.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Za.text=Nb;this.Za.textBox.caretPosition=vc;this.Za.Nxa()&&(null===(pa=Ic.hs)||void 0===pa?0:pa.rva)&&
Ic.hs.iMb(this.Za.text,this.Za.textBox.caretPosition,this.Za.textBox.caretPosition,this.Za.textBox.Oy.length);Ic.Ul&&(pa=Ic.Vb,pa.text=this.Za.text,pa.setCaretPosition(this.Za.textBox.caretPosition));ae=(null==this.hja?0:this.hja)?"FieldName":ae;this.Xg.Qj.sectionRowIndex>=this.Xg.zW.length?this.Ulc(ae,4,xd,0):this.Ulc(ae,1,xd,0);oe||(5===tb||4===tb?this.rwe():aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7386867_dontShowAutocompleteAfterCommitingTableName")&&7===tb?this.set_visible(!1):this.Fpb());
return!0}TZ(pa=null,tb=null){pa?(this.Vg.bdb(),this.Vg.TZ(pa,!1,!1,tb)):(pa=this.gridView,pa.ha.ra.Pg&&(pa=qa.v(pa.ha.ra.dd,this.$),this.Vg.TZ(pa,!0,!0,tb)))}pna(){this.Ufa=!1;this.Za.DMe()}zUh(pa){pa=this.calcManager.getWorksheetFuncId(pa);return this.XZe?this.XZe.descriptionsMap.get(pa):null}nHe(pa){if(this.moi()){if(this.Vg.r7a&&this.Vg.$k&&(!this.Vg.$k.length||!this.Vg.$k[0].FieldInfoDataList))return;this.jWj(pa)}pa=mc.asEnumerable(this.oHa);pa=mc.concat(pa,this.DWh(this.Za.text));aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&
this.Zk&&(pa=mc.concat(pa,this.LXh()));mc.OBc(pa,tb=>tb.name,new Hf.a);this.MTa&&(pa=mc.concat(mc.asEnumerable(this.kOb),pa),aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.kOb.length?(this.VI||this.formulaAssistanceTelemetryManager.YB(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.VI=!0):this.VI&&this.nkf&&(this.kaa=!0):0<this.kOb.length&&(this.VI=!0),this.kOb=[]);this.E8=mc.toArray(pa)}Yfh(){var pa=this.Za.text;
if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var tb=this.gridView.Ul?this.ewb.aJa:this.erb.aJa,Nb=!0;if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==tb&&(this.Lg=Object(Pb.a)(gf.a,this.$.Cb.getItemByName(tb))),this.Lg||(this.Lg=this.tableManager.Lg,Nb=!1),!this.Lg){r.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");
return}}else this.Lg=Object(Pb.a)(gf.a,this.$.Cb.getItemByName(tb)),this.Lg||(this.Lg=this.tableManager.Lg,Nb=!1);this.Lg.XO&&this.Lg.XO.IsFullTableHeaders?this.RMf(Nb):Ha.d(this.Lg)?(r.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),ec.q(this.$.pa.ya,this.Lg.mj,this.lDf,this.kDf,null,null)):r.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&
this.tableManager.Lg)if(tb=this.calcManager.x5a(this.tableManager.Lg))if(this.calcManager.kte(this.tableManager.Lg,tb)){pa=mc.empty();if(91===this.Za.text.charCodeAt(this.Za.text.length-1)){const vc=this.R1a("@ - "+this.instantaneousSupportInformationManager.Ke.ThisRowStructRefString);pa=mc.concat(pa,(Nb=new vb.a,Nb.add(vc),Nb))}pa=mc.concat(pa,mc.select(mc.asEnumerable(tb.toArray()),vc=>{const Ic=new Ab,kd=new Oe;kd._name=vc.toString();Ic.w5f(kd);return Ic}));this.E8=mc.toArray(pa)}else pa.endsWith("[")&&
"["!==pa.charAt(pa.length-2)&&r.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${tb.count} columns for a table with id ${this.tableManager.Lg.mj} of size ${this.tableManager.Lg.usedRange.right-this.tableManager.Lg.usedRange.left+1}`);else pa.endsWith("[")&&"["!==pa.charAt(pa.length-2)&&r.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}vEh(pa){if(!pa)return!1;
let tb=pa.charCodeAt(0);if(46===tb||48<=tb&&57>=tb||63===tb)return!0;for(let Nb=0;Nb<pa.length;Nb++,tb=pa.charCodeAt(Nb))if(!((aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Va.a.isLetter(tb):Va.a.yrd(tb))||92===tb||95===tb||63===tb||48<=tb&&57>=tb))return!0;return!1}aGd(pa,tb){let Nb=!1,vc=!1;var Ic=!1,kd=0;let xd=0;this.j4a=0;this.rbc=tb;this.U6b=1;for(let ae=tb-1;0<=ae;--ae)switch(pa.charCodeAt(ae)){case 39:vc=!vc;break;case 34:Nb=
!Nb;break;case 91:++kd;Ic=kd>xd;break;case 93:++xd}Ic=Object(nb.a)(new pe,{ota:!Nb,pta:!vc,eia:!Ic,FHb:1});kd=this.e1i(pa,tb,Ic);tb=this.f1i(pa,tb,Ic.ota,Ic.pta,Ic.eia);this.U6b=kd+tb;if(this.HSc=kd-1)this.xzc=!1;this.kFh(pa,Nb,vc,Ic.AFd,Ic.BFd)}pod(){4!==this.IEb&&(this.qBb?this.gridView.fc.Yk(this.uh):this.gridView.ha.eha(this.Oyf));const pa=X.a.eAb()?this.yq.Sb(null):void 0;this.pPa(pa);X.a.ihc&&this.gridView.zi.EZa(this.G6);nc.sPd(this.pluginScheduler);this.MTa&&this.k2g()}ODh(){return this.MTa||
this.EWe}g1i(){var pa=this.U5;if(!this.UCj||!pa)return this.xZ=0,this.oHa=this.E8=null,!1;pa=pa.endsWith(Bc.a.LU);let tb;if(aa.EwaSettings.ma(134)&&({sheetRange:tb}=this.BTj(this.U5.substring(0,this.d4))).returnValue){const Nb=this.U5.substring(0,this.xZ);if(pa&&Nb!==this.wud)return this.wud=Nb,this.xZ=this.U5.length-(pa?1:0),this.TZ(tb,this.U5),this.hja=!1,r.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}DWh(pa){const tb=new vb.a;this.calcManager&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
r.ULS.shipAssertTag(537162014,0,!!this.calcManager.Eta(ib.Range.Qc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.EWe&&(pa=this.calcManager.extractLetVariables(pa,this.Za.textBox.caretPosition)))for(const Nb of pa){pa=new ke;pa._name=Nb;pa.N9=C.a.instance.ga(2213);const vc=new Ab;vc.Jwj(pa);tb.add(vc)}return tb}LXh(){const pa=new vb.a,tb=this.$.Cb.items;for(let vc=0,Ic=tb.length;vc<Ic;vc++){var Nb=tb[vc];if(!Ib.n(Nb))continue;const kd=
new Fe;kd._name=Nb.name;Nb=new Ab;Nb.$yj(kd);pa.add(Nb)}return pa}R1a(pa){const tb=new Ab,Nb=new Xe;Nb._name=pa;tb.azj(Nb);return tb}RMf(pa){const tb=new vb.a,Nb=this.Za.text.charCodeAt(this.Za.text.length-1),vc=this.Za.textBox.caretPosition-1;if(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Za.text.charCodeAt(vc):91===Nb){var Ic=this.R1a("@ - "+this.instantaneousSupportInformationManager.Ke.ThisRowStructRefString);tb.add(Ic)}for(var kd of this.Lg.XO.HeadersList){Ic=
new Ab;const xd=new Oe;xd._name=kd.Name;Ic.w5f(xd);tb.add(Ic)}kd=this.gridView.Ul?this.ewb.tQ:this.erb.tQ;Ic=this.Za.text.charCodeAt(kd+1);(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!pa||vc!==kd&&35!==Ic:!pa||91!==Nb&&35!==Nb)||(pa=this.R1a("#"+this.instantaneousSupportInformationManager.Ke.AllStructRefString),tb.add(pa),pa=this.R1a("#"+this.instantaneousSupportInformationManager.Ke.DataStructRefString),tb.add(pa),pa=this.R1a("#"+this.instantaneousSupportInformationManager.Ke.HeadersStructRefString),
tb.add(pa),pa=this.R1a("#"+this.instantaneousSupportInformationManager.Ke.TotalsStructRefString),tb.add(pa));tb&&(this.E8=tb.toArray())}jWj(pa){let tb=mc.empty();!pa&&this.functionInfoManager.JV&&(tb=mc.concat(tb,mc.select(mc.asEnumerable(this.functionInfoManager.qbc),Nb=>{const vc=new Ab;vc.$3f(Nb);return vc})),pa=this.H7b.gLe,0<pa.length&&(tb=mc.OBc(mc.concat(tb,mc.select(mc.asEnumerable(pa),Nb=>{const vc=new Ab;vc.gvj(Nb);return vc})),Nb=>Nb.name,new Hf.a)));if(this.Vg.r7a&&this.Vg.$k){if(!this.Vg.$k.length||
!this.Vg.$k[0].FieldInfoDataList)return;tb=mc.OBc(mc.concat(tb,mc.select(mc.asEnumerable(this.Vg.$k[0].FieldInfoDataList),Nb=>{const vc=new Ab;vc.Evj(Nb);return vc})),Nb=>Nb.name,new Hf.a);this.columnName=this.Vg.$k[0].ColumnName}this.oHa=mc.toArray(tb)}pPa(pa){var tb;if(1!==this.IEb){var Nb=this.gridView.ha.ra.activeCell;if(Nb){var vc=this.calcManager.Eta(Nb,!this.Xpd);if(vc){var Ic=this.$.xa,kd=vc.sheet.index;0>=Ic.count||0>kd||kd>=Ic.count?r.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Ic.count}, currentSheetIndex = ${kd}.`):
(kd=Ic=null,this.sBd&&void 0!==this.calcManager&&null!==this.calcManager&&(pa=null!==(tb=null===pa||void 0===pa?void 0:pa.cell)&&void 0!==tb?tb:this.gridView.Da.rs(Nb))&&(tb=this.calcManager.mdc(pa.Gj),void 0!==tb&&null!==tb&&(Ic=tb.FormatString,kd=tb.Builtin)),2!==this.IEb&&(this.pluginScheduler.notifier().setActiveCell({colIndex:vc.range.col,rowIndex:vc.range.row,sheetIndex:this.$.xa.getItem(vc.sheet.index).sheetId,docName:vc.sheet.document.name,docPath:vc.sheet.document.path,formatString:Ic,builtIn:kd}),
r.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${vc.range.col}, row: ${vc.range.row}, format: ${Ic}`)))}else r.ULS.sendTraceTag(512278612,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else r.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}}U_f(){this.formulaAssistanceTelemetryManager.jI={lk:this.gridView.ha.ra.activeCell,
F3b:this.gridView.Vb.text,Vrb:!0};this.formulaAssistanceTelemetryManager.iDb=this.$.ea.ze;this.formulaAssistanceTelemetryManager.qlc=this.$.xa.oa.sheetId;this.$.userOperationManager.ur(this.NPa)}k2g(){this.gridView.Ul?this.ewb.aZ(!1):this.erb.aZ(!1)}inf(pa){let tb;tb=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Va.a.isLetter(pa):Va.a.yrd(pa);return 48<=pa&&57>=pa||46===pa||95===pa||tb}show(){if(this.yr){var pa=this.Xg.rjg(0);this.Zk?
0<this.Xg.qp.length?(this.formulaAssistanceTelemetryManager.Mdf(this.Xg.Yrb),pa||this.u9f()):this.A2a():((pa=0<this.Xg.qp.length)&&this.formulaAssistanceTelemetryManager.YB(["autoCompleteRender"]),!this.se&&this.columnName&&pa&&this.Xg.l9i(this.Xg.qp.length,this.columnName),this.se=pa,this.zja.show(this.sQ),this.wCa(!0),this.Xg.Kya(),pa&&this.formulaAssistanceTelemetryManager.yw(["autoCompleteRender"]))}}f1i(pa,tb,Nb,vc,Ic){for(Nb=Object(nb.a)(new pe,{rKf:41,PDe:40,ota:Nb,pta:vc,eia:Ic});tb<pa.length&&
!this.qLf(pa,tb,Nb);++tb);return Nb.FHb}e1i(pa,tb,Nb){for(--tb;0<=tb&&!this.qLf(pa,tb,Nb);--tb);return Nb.FHb}qLf(pa,tb,Nb){const vc=pa.charCodeAt(tb);0>=this.d4&&(this.d4=pa.substring(0,tb).lastIndexOf(Bc.a.LU));46===vc&&(tb<this.d4?this.d4=tb:tb>this.eub&&(this.xZ=this.eub=tb));if(!this.inf(vc)&&!nc.bui(vc)&&(!this.Hka||tb<=this.d4||!nc.eci(vc,Nb))){Nb.fBf&&(Nb.fBf=!1,this.j4a=tb+1);if(Nb.dEd){Nb.BFd=tb+1;if(this.functionInfoManager.Ugd(pa.substring(Nb.BFd,Nb.AFd)))return!0;Nb.dEd=!1}switch(vc){case 39:Nb.pta=
!Nb.pta;break;case 34:Nb.ota=!Nb.ota;break;case 91:Nb.eia=!1;break;case 93:Nb.eia=!0}vc===this.$.listSeparator.toString().charCodeAt(0)&&Nb.pta&&Nb.ota&&!Nb.$0a&&(!this.Hka||Nb.eia)&&(tb<Nb.hQd||-1===Nb.hQd)&&(Nb.FHb+=1,this.U6b++);vc===Nb.PDe&&Nb.ota&&Nb.pta&&(!this.Hka||Nb.eia)?Nb.$0a+=1:vc===Nb.rKf&&Nb.ota&&Nb.pta&&(!this.Hka||Nb.eia)?0<Nb.$0a?--Nb.$0a:(Nb.hQd=Nb.kYe,Nb.kYe=tb,0<tb&&this.inf(pa.charCodeAt(tb-1))&&(Nb.dEd=!0,Nb.AFd=tb)):this.Hka&&46===vc&&tb>this.d4&&(tb<this.d4?this.d4=tb:tb>this.eub&&
(this.xZ=this.eub=tb))}return!1}kFh(pa,tb,Nb,vc,Ic){this.rbc>this.j4a&&0<=this.j4a?tb||Nb||(this.TV=pa.substring(this.j4a,this.rbc)):this.TV=null;vc!==Ic?(pa=pa.substring(Ic,vc),this.sQ&&Va.a.equals(this.sQ.NameDataStrings,pa,!0)||(this.xzc=!0),this.sQ=this.functionInfoManager.Ugd(pa)):(this.xzc=!1,this.sQ=null)}Lbg(pa){const tb=$get(w.kLf+"_"+w.EHb,this.domElement),Nb=$get(w.lLf+"_"+w.EHb,this.domElement);pa&&!this.ofc?(tb&&W.a.instance.sa(sa.a.click,tb,this.Uca),Nb&&W.a.instance.sa(sa.a.click,Nb,
this.Uca),this.ofc=!0):this.ofc&&(tb&&W.a.instance.Ba(sa.a.click,tb,this.Uca),Nb&&W.a.instance.Ba(sa.a.click,Nb,this.Uca),this.ofc=!1)}BTj(pa){let tb;tb=null;var Nb;if(({sheetName:vc,range:Nb}=qa.Z(pa,this.$.ea.xa)).returnValue&&Nb){if(!vc){var vc=Object(Pb.a)(Ie.a,this.$.oa);if(!vc)return{returnValue:!1,sheetRange:tb};vc=vc.name}tb=qa.v(Nb,this.$);tb.SheetName=vc;this.l8c=!1;return{returnValue:!0,sheetRange:tb}}return({sheetName:vc,range:Nb}=this.H7b.kTj(pa)).returnValue?(tb=qa.v(Nb,this.$),tb.SheetName=
vc,this.l8c=!0,{returnValue:!0,sheetRange:tb}):{returnValue:!1,sheetRange:tb}}nPd(pa){pa={content:pa,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Lba?this.pluginScheduler.getRequester().runAuthoringExperiment(pa,0):this.pluginScheduler.requester().runAuthoringExperiment(pa)}tnd(){if(1===this.Xg.zW.length&&this.yr.length){var pa=this.yr[this.Xg.zW[0]];if(1===pa.itemType){var tb=pa.name;pa=this.Za.text;tb=tb.substring(pa.length,tb.length);tb.length&&(this.Za.text=pa+
tb,this.Za.textBox.selectRange(pa.length,this.Za.text.length))}}else r.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.Xg.zW.length})`)}Ulc(pa,tb,Nb,vc){const Ic={};Ic.a=pa;Ic.b=tb;Ic.c=Nb;Ic.d=vc;Ze.b().Qe(38,Ic,!0)}qwe(pa,tb){if(!this.functionInfoManager.JV){if(pa)if(this.aGd(this.Za.text,this.Za.textBox.caretPosition),this.MTa||this.TV){const Nb={};Nb.Filter=this.TV?this.TV.charAt(0).toString():"";Nb.FilterType=1;Nb.IncludeOneOfEachGroupUI=
!1;this.functionInfoManager.OJa(Nb)}else aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!tb)return}0<this.$.rb.JR||this.Za&&!this.Za.eb?this.set_visible(!1):pa&&(this.aGd(this.Za.text,this.Za.textBox.caretPosition),this.zja.update(this.sQ,this.U6b,this.HSc,this.xzc),this.U5=this.Za.text.substring(1,this.Za.textBox.caretPosition),this.d4=this.U5.indexOf(Bc.a.LU),this.xZ=this.U5.lastIndexOf(Bc.a.LU),this.g1i()?
(pa=new Ab,pa.zxj(),this.oHa=this.E8=pa=[pa],this.Xg.oYj(pa),this.show()):((this.ODh()||this.yxa())&&this.nHe(!1),0<this.xZ?this.Xg.qKa(this.yr,this.U5,!1,void 0,this.U5.lastIndexOf(Bc.a.LU),!1):this.Xg.qKa(this.yr,this.TV,!1,void 0,this.xZ,!1),this.show(),this.Zk&&(this.Xg.qp.length||this.gridView.zi.oL?this.zja.Rtb():(this.zja.GNd(),this.Zk&&this.A2a()))))}u9f(){if(0<this.Xg.qp.length){this.formulaAssistanceTelemetryManager.YB(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const pa=
{};pa.zoomLevel=U(this.$);this.formulaAssistanceUIControl.updateContext(pa);this.Qo=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.W1b,this.gridView.zi.textBox.domElement,this.Icc(),()=>{})};this.Qo();this.Zk&&this.Xg.Xjc&&this.raiseEvent(nc.$dd,null);this.opd||this.Xg.Xjc||this.raiseEvent("FormulaAutoCompleteShown");this.opd=this.Oq.Hf=!0}this.formulaAssistanceTelemetryManager.yw(["autoCompleteRender"]);aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.VI&&this.nkf&&(this.kaa=!0)}}Dwd(){this.sJa&&(this.formulaAssistanceTelemetryManager.MJ.selectByArrowKeyCounter++,this.sJa=!1);this.tJa&&(this.formulaAssistanceTelemetryManager.MJ.selectByMouseHoverCounter++,this.tJa=!1);this.rJa&&(this.formulaAssistanceTelemetryManager.MJ.commitByTabKeyCounter++,this.rJa=!1);this.pJa&&(this.formulaAssistanceTelemetryManager.MJ.commitByEnterKeyCounter++,this.pJa=!1);this.qJa&&(this.formulaAssistanceTelemetryManager.MJ.commitByMouseClickCounter++,this.qJa=!1);
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.Iia&&(this.formulaAssistanceTelemetryManager.MJ.dismissSmartSuggestionExplicitlyCounter++,this.Iia=!1)}Icc(){const pa=new bb;pa.completionItems=this.Xg.Yrb;pa.activeItemIndex=this.Xg.Qj?this.Xg.Qj.rowIndex:-1;this.eLd(pa);return pa}eLd(pa){pa.callbacks=new hf;pa.callbacks.onCompletionItemSelected=this.OCd;pa.callbacks.onCompletionItemCommitted=this.NCd;pa.callbacks.onFeedback=this.ySa;pa.callbacks.onDismiss=
this.onDismiss;pa.callbacks.onRestoreFocus=this.onRestoreFocus}JHd(pa){this.Ufa=!0;const tb=pa.textEdit.newText;this.Za.Peb(tb.substring(this.Za.text.length-pa.textEdit.range.start.character,tb.length))}bFe(){aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionAccepted"]);this.jz(!0);this.Ufa=this.se=!1;this.NTa=this.woa=!0}Eod(pa,tb){this.Za.text=pa.substring(0,tb.range.start.character)+tb.newText+
pa.substring(tb.range.end.character,pa.length);this.gridView.Ul&&(this.gridView.Vb.text=this.Za.text)}static sPd(pa){aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?pa.getRequester().runExperiment(new Lb,0):pa.requester().runExperiment(new Lb)}static $8g(pa){const tb=Ab.Hfh(),Nb={IsCompatibility:!1};Nb.NameDataStrings=pa.label;Nb.Help=pa.detail;tb.$3f(Nb);tb.textEdit=pa.textEdit;return tb}static NKa(){const pa=String.format(w.UJh,w.wed,na.a.fSe),tb=String.format(w.QJh,
w.ued,Sa.a.d$b,y.a.Ao,y.a.zo),Nb=String.format(w.OJh,w.oed,Sa.a.d$b,y.a.Ao,Sa.a.ZSe,y.a.zo);return`${pa}
${tb}
${Nb}`}static bui(pa){return 36===pa||58===pa||33===pa||39===pa||32===pa}static eci(pa,tb){return 32===pa||91===pa||!tb.eia}}nc.$dd="FACardOpened";nc.Add="FAFocusOnSmartSuggestionsCard";nc.Ufc=null;Object(h.a)(nc,"FormulaAssistanceControl",gc.a,[238,236,2,239,240]);class Lc{constructor(pa){this.Gt=pa;this.uB=this.hTa=this.Oi=!1;this.onKeyDown=tb=>this.uB||"Space"!==tb.code&&" "!==tb.key||!tb.altKey||!tb.ctrlKey?!1:(this.c3a(),tb.stopPropagation(),tb.preventDefault(),!0);this.Cla=tb=>{if(!this.uB)return!1;
if(tb.eventName===sa.a.Pb){const Nb=tb.Ca.ctrlKey?1:tb.Ca.shiftKey?50:10;switch(tb.Ca.keyCode){case Nd.a.mpa:this.$K(0,-Nb);break;case Nd.a.v8:this.$K(0,Nb);break;case Nd.a.w8:this.$K(-Nb,0);break;case Nd.a.JCa:this.$K(Nb,0);break;case Nd.a.JG:case Nd.a.Mh:this.hTa=!0;break;default:return!1}}tb.eventName===sa.a.Fd&&this.hTa&&this.cN(!0);tb.Ca.preventDefault();return!0};this.Mza=tb=>{if(!this.uB)return!1;tb.Ca.preventDefault();this.cN();return!0};this.onBlur=()=>{if(!this.uB)return!1;this.cN();return!0};
this.Go=zd.KeyInputManager.instance;this.pointerInputManager=Be.a.instance}la(pa){(this.root=pa)&&!this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!0)}detach(){this.root&&this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!1)}c3a(){this.root&&(this.Gt.UGb("move",!0),this.root.focus(),this.uB=!0,this.hTa=!1,this.Qs(),this.Mya||this.Lsb(),this.root.appendChild(this.Mya))}cN(pa=!1){this.uB&&(this.uB=!1,this.Gt.hpc(pa),this.RJb(),this.EJb())}Qs(){this.Go.capture(this.Cla,
null);this.pointerInputManager.Ps(sa.a.pointerDown,this.root,this.Mza,!0);this.root.addEventListener("blur",this.onBlur)}EJb(){this.Go.releaseCapture();this.pointerInputManager.Ws(sa.a.pointerDown,this.root,this.Mza,!0);this.root.removeEventListener("blur",this.onBlur)}RJb(){var pa;null===(pa=this.Mya)||void 0===pa?void 0:pa.remove()}$K(pa,tb){const Nb=this.Gt.getPosition();Nb.x+=pa;Nb.y+=tb;this.Gt.setPosition(Nb)}Lsb(){this.Mya=Sd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",
!0,"")}}Object(h.a)(Lc,"FormulaAssistanceMoveAdapter",null,[]);class od{constructor(pa){this.Gt=pa;this.startOffset={x:0,y:0};this.pag=!0;this.Oi=!1;this.$Yc=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeArgumentAssistanceDragCursorToMove",!1)}p5(){return this.Oi&&!!this.uD}gza(pa){this.$Yc||(this.uD.style.cursor="grabbing");const tb=this.Gt.getPosition();this.pag=tb.renderDown;this.startOffset.x=tb.x-pa.clientPoint.x;this.startOffset.y=tb.y-pa.clientPoint.y;this.Gt.UGb("drag");
return!0}Sca(pa){this.Gt.setPosition({x:pa.clientPoint.x+this.startOffset.x,y:pa.clientPoint.y+this.startOffset.y,renderDown:this.pag});return!0}Rca(){this.xw()}Qca(){this.xw()}la(pa,tb){this.uD=tb;this.root=pa;this.uD&&(this.uD.style.cursor=this.$Yc?"move":"grab",He.a.instance.PW(this.uD,this,!1),this.Oi=!0)}detach(){this.Oi&&this.uD&&(this.uD.style.cursor="",He.a.instance.t1(this.uD,this),this.Oi=!1)}xw(){this.$Yc||(this.uD.style.cursor="grab")}}Object(h.a)(od,"FormulaAssistanceDragAdapter",null,
[285]);class wd{constructor(pa){this.formulaAssistanceTelemetryManager=pa;this.Oi=!1;this.iHa=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.WL={[Pd.Drag]:0,[Pd.Move]:0};this.NEb=new Lc(this);this.gub=new od(this)}get getPosition(){return this.bwg}get setPosition(){return this.mke}la(pa,tb,Nb,vc){this.bwg=Nb;this.mke=vc;this.NEb.la(pa);this.gub.la(pa,tb);this.Oi=!0}detach(){this.Oi&&(this.gub.detach(),this.NEb.detach(),this.Oi=!1)}clear(){var pa;
null===(pa=this.mke)||void 0===pa?void 0:pa.call(this,null);this.detach();this.LKb()}UGb(pa,tb=!1){this.WL[pa]++;tb&&(this.HQa=document.activeElement)}hpc(pa=!0){this.HQa&&(pa&&this.HQa.focus(),this.HQa=null)}LKb(){const pa=this.formulaAssistanceTelemetryManager.RP,tb=this.WL[Pd.Drag],Nb=this.WL[Pd.Move];0<tb&&(this.formulaAssistanceTelemetryManager.FJ("d"),this.iHa||(pa.argumentAssistanceDragTotalCounter+=tb),this.WL[Pd.Drag]=0);0<Nb&&(this.formulaAssistanceTelemetryManager.FJ("m"),this.iHa||(pa.argumentAssistanceMoveTotalCounter+=
Nb),this.WL[Pd.Move]=0)}}Object(h.a)(wd,"FormulaAssistanceDragControl",null,[]);var Pd;(function(pa){pa.Drag="drag";pa.Move="move"})(Pd||(Pd={}));Object(h.b)("FormulaAssistanceDragMode",Pd);class je extends Gc.a{constructor(pa,tb,Nb){super(je.NKa());this.$=pa;this.formulaAssistanceUIControl=tb;this.formulaAssistanceTelemetryManager=Nb;this.showCollapseText=this.isExpanded=!0;this.NY=0;this.Hla=this.Qo=this.Oq=null;this.JK=this.hv=!1;this.setPosition=vc=>{this.formulaAssistanceUIControl.setFixedPosition(vc);
this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Pc=()=>{this.visible=!1};this.onCardModeChange=vc=>{this.oQb(vc);this.showCollapseText=!1;1===vc?this.formulaAssistanceTelemetryManager.FJ("c"):this.formulaAssistanceTelemetryManager.FJ("e")};this.onIsExpandedChange=vc=>{this.Lig(vc);this.showCollapseText=!1;vc?this.formulaAssistanceTelemetryManager.FJ("e"):this.formulaAssistanceTelemetryManager.FJ("c")};this.ySa=vc=>{M(this.$,
"ArgumentAssistanceCard",vc.functionName);this.formulaAssistanceTelemetryManager.FJ("gf")};this.Tt=()=>{this.r_?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Qo&&null!==this.Qo&&this.Qo()};this.onDismissClick=()=>{this.dismiss();this.raiseEvent("DC");this.r_?(this.JK&&this.Gt.clear(),this.isExpanded&&this.Lig(!1)):(this.JK&&this.T8b.clear(),0===this.NY&&this.oQb(1))};this.jg=()=>{this.JK&&(this.r_?this.Gt.clear():this.T8b.clear())};this.r_=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",
!1);this.j5=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.$Rd();this.Oq=new sd(this.$,this.formulaAssistanceUIControl,0,qb.a.Sdd);this.grid=Object(L.h)(pa);this.grid.view.ot(this.Tt);this.grid.ha.hH(this.Pc);if(this.JK=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1))this.r_?this.Gt=new wd(this.formulaAssistanceTelemetryManager):
this.T8b=new fe(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),this.grid.fc.Rm(this.jg);aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}nre(pa){this.addHandler("FAFunctionNameUpdated",pa)}BVf(pa){this.removeHandler("FAFunctionNameUpdated",pa)}gse(pa){this.addHandler("FAParameterSelectionChangedOld",pa)}ZVf(pa){this.removeHandler("FAParameterSelectionChangedOld",pa)}fse(pa){this.addHandler("FAParameterSelectionChanged",
pa)}YVf(pa){this.removeHandler("FAParameterSelectionChanged",pa)}gLg(pa){this.addHandler("DC",pa)}Dgj(pa){this.removeHandler("DC",pa)}get visible(){return this.hv}set visible(pa){pa||this.dismiss();this.hv=pa}dismiss(){this.hv=!1;this.formulaAssistanceUIControl&&(this.Qo=null,this.JK&&(this.r_?this.Gt.detach():this.T8b.detach()),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Hla=null,this.Oq.Hf=!1)}FHj(pa,tb){this.hv=!0;const Nb=this.ysc(pa);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceRender"]);
pa={};pa.zoomLevel=U(this.$);this.formulaAssistanceUIControl.updateContext(pa);const vc=()=>{};aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Qo=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,tb,Nb,vc)},this.Qo()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,tb,Nb,vc);this.Dvc();this.Rrc(Nb);this.JK&&this.T8b.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Qo,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Oq.Hf=!0;this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")}}show(pa,tb){this.r_?this.GHj(pa):this.FHj(pa,tb)}GHj(pa){this.hv=!0;const tb=this.ysc(pa);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceRender"]);const Nb=()=>b(this.$);this.Qo=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
void 0,tb,Nb)};this.Qo();this.Dvc();this.Rrc(tb);this.JK&&this.Gt.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.Oq.Hf=!0;this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Lua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.kG(this.Pc),this.grid.view.er(this.Tt),this.JK&&this.grid.fc.em(this.jg));
Y.a.Ia(this.Oq);this.$=null}ysc(pa){const tb=new Fd;tb.functionRenderingInfo=pa;tb.showCollapseText=this.showCollapseText;this.r_?tb.isExpanded=this.isExpanded:tb.cardMode=this.NY;this.jLd(tb);return tb}jLd(pa){pa.callbacks=new Rc;pa.callbacks.onHelpLink=this.bhd(pa.functionRenderingInfo);this.r_?pa.callbacks.onIsExpandedChange=this.onIsExpandedChange:pa.callbacks.onCardModeChange=this.onCardModeChange;pa.callbacks.onFeedback=this.ySa;this.j5&&(pa.callbacks.onDismissClick=this.onDismissClick)}bhd(pa){return()=>
{J(this.$,pa.helpID,pa.isUDF)}}$Rd(){const pa=sc.a.get(A.a.upb);this.r_?(pa?(this.isExpanded="false"!==pa,this.showCollapseText=!1):(this.isExpanded=je.Pih,this.formulaAssistanceTelemetryManager.G2f()),this.formulaAssistanceTelemetryManager.fuj(this.isExpanded)):(pa?(this.NY=parseInt(pa,10),this.showCollapseText=!1):(this.NY=je.b8c,this.formulaAssistanceTelemetryManager.G2f()),this.formulaAssistanceTelemetryManager.H2f(this.NY))}Rrc(pa){var tb=pa.functionRenderingInfo.functionName;this.Hla&&Va.a.equals(this.Hla,
tb,!0)?(tb=kb.a.map(pa.functionRenderingInfo.signatures,Nb=>{let vc="";0<=Nb.signatureParams.activeParam&&Nb.signatureParams.activeParam<Nb.signatureParams.params.length&&(vc=Nb.signatureParams.params[Nb.signatureParams.activeParam]);return vc}),this.raiseEvent("FAParameterSelectionChanged",new yb(tb))):(this.Hla=tb,pa=kb.a.map(pa.functionRenderingInfo.signatures,Nb=>Nb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new zc(tb,pa)))}oQb(pa){this.NY=pa;try{sc.a.Qu(A.a.upb,
pa.toString(),Eb.AFrame.r1)}catch(tb){r.ULS.sendTraceTag(537162074,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${tb.message}`)}}Lig(pa){this.isExpanded=pa;try{sc.a.Qu(A.a.upb,pa.toString(),Eb.AFrame.r1)}catch(tb){r.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${tb.message}`)}}static NKa(){return document.createElement("div")}Dvc(){const pa=this.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.FJ(pa)}}
je.b8c=0;je.Pih=!0;Object(h.a)(je,"FormulaArgumentAssistanceControl",Gc.a,[269]);var be;(function(pa){pa[pa.Dismissed=0]="Dismissed";pa[pa.Smart=1]="Smart";pa[pa.Simple=2]="Simple";pa[pa.Mixed=3]="Mixed"})(be||(be={}));Object(h.b)("UIState",be);class Qe extends Gc.a{constructor(pa,tb,Nb){super(Qe.NKa());this.$=pa;this.formulaAssistanceUIControl=tb;this.formulaAssistanceTelemetryManager=Nb;this.Oq=this.Za=this.gridView=null;this.kaa=this.Iia=this.qJa=this.pJa=this.rJa=this.tJa=this.sJa=!1;this.yr=
null;this.gX=0;this.Qo=null;this.NTa=this.woa=this.VI=this.Ufa=this.hv=!1;this.eQb=be.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.hv=!1;this.F7a&&this.VI&&this.pNa&&(this.kaa=!0);this.Dwd();this.PF&&this.Za.eb&&this.pna();this.Qo=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Oq.Hf=!1,this.eQb=be.Dismissed)};this.Bkd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.Wca=(vc,Ic)=>{0==Ic.Lr&&(170==Ic.Tf.operation.operationName&&
this.formulaAssistanceTelemetryManager.slc++,this.$.userOperationManager.ko(this.Wca))};this.NPa=(vc,Ic)=>{0==Ic.Lr&&(12==Ic.Tf.operation.operationName&&this.$.userOperationManager.ur(this.Wca),this.$.userOperationManager.ko(this.NPa))};this.wOi=()=>{this.dismiss();this.gridView.zi.textBox.focus()};this.ySa=()=>{const vc={};vc[A.a.DQ]=this.bKf?"SmartSuggestionsCard":this.zWd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Xc(802602464,0,8,vc)};this.jg=()=>{aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",
!1)&&1===this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter&&this.VI&&this.$.Xc(1073817162,-1,0,null);this.pNa&&this.gPg()};this.OCd=(vc,Ic)=>{this.Jgb(Ic);this.tJa=!0};this.Pc=()=>{this.visible=!1};this.NCd=vc=>{this.qJa=!0;this.Trb(vc)};this.Gh=()=>{this.dismiss()};this.Tt=()=>{this.r_?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Qo&&null!==this.Qo&&this.Qo()};this.gridView=L.h(this.$);this.Oq=new sd(this.$,this.formulaAssistanceUIControl,1,qb.a.Udd,this.Bkd);
this.gridView.view.ot(this.Tt);this.gridView.ha.hH(this.Pc);this.$.xa.Xf(this.Gh);this.pNa=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.r_=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.F7a=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.pNa&&this.gridView.fc.Rm(this.jg);
aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement);this.Boi=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")}lre(pa){this.addHandler("FACardOpened",pa)}AVf(pa){this.removeHandler("FACardOpened",pa)}jre(pa){this.addHandler("FAFocusOnSmartSuggestionsCard",pa)}yVf(pa){this.removeHandler("FAFocusOnSmartSuggestionsCard",pa)}kre(pa){this.addHandler("FormulaAutoCompleteShown",pa)}zVf(pa){this.removeHandler("FormulaAutoCompleteShown",
pa)}BXc(pa){this.addHandler("SelectedRowChanged",pa)}FMd(pa){this.removeHandler("SelectedRowChanged",pa)}i0b(pa){this.addHandler("ListBoxUpdated",pa)}Suc(pa){this.removeHandler("ListBoxUpdated",pa)}dispose(){this.$&&(this.$.userOperationManager.ko(this.Wca),this.$.userOperationManager.ko(this.NPa),this.gridView&&(this.gridView.ha&&this.gridView.ha.kG(this.Pc),this.gridView.fc&&this.pNa&&this.gridView.fc.em(this.jg),this.gridView.view.er(this.Tt)),this.$.xa&&this.$.xa.Eg(this.Gh));Y.a.Ia(this.Oq);
this.$=null}UKg(pa){this.addHandler("CVIC",pa)}pgj(pa){this.removeHandler("CVIC",pa)}get visible(){return this.hv}set visible(pa){pa||this.dismiss();this.hv=pa}get PF(){return this.Ufa}get zWd(){var pa,tb;return 1===(null===(tb=null===(pa=this.yr)||void 0===pa?void 0:pa.items[0])||void 0===tb?void 0:tb.type)}get bKf(){return 1===this.yr.items.length&&this.zWd}Zh(pa,tb){if(!this.visible)return!1;this.ADc(tb);let Nb;return(Nb=this.z8h(tb)).Tec?Nb.result:this.yCj(tb)}oyb(pa){if(!this.visible)return!1;
let tb=!1;switch(pa){case 1872288872:this.PF&&this.pna();this.F7a&&this.zWd&&(this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionActiveDismissing"]),this.Iia=!0);this.visible=!1;tb=!0;break;case -798660877:this.Jgb(this.Uxb(this.gX+1));tb=!0;break;case 137938150:this.Jgb(this.Uxb(this.gX-1));tb=!0;break;case 2091832999:this.Jgb(this.Uxb(this.gX+8));tb=!0;break;case 742457698:this.Jgb(this.Uxb(this.gX-8));tb=!0;break;case 125627505:case 267796030:this.Trb(this.yr.items[this.gX]),
tb=!0}return tb}show(pa){this.Za=this.gridView.zi;this.hv=!0;this.gX=0;this.yr=pa;0<this.yr.items.length&&(this.render(),this.Jgb(this.Uxb(this.gX)),this.F7a?this.pNa&&(1===this.yr.items[0].type?(this.VI||this.formulaAssistanceTelemetryManager.YB(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.VI=!0):this.VI&&(this.kaa=!0)):1===this.yr.items[0].type&&this.pNa&&(this.VI=!0));this.formulaAssistanceTelemetryManager.Mdf(pa.items)}pna(){this.Ufa=!1;this.Za.DMe()}yCj(pa){return[1872288872,
-798660877,137938150,2091832999,742457698,125627505,267796030].includes(pa)}z8h(pa){return this.PF?125627505===pa||267796030===pa?(this.Trb(this.yr.items[this.gX]),{Tec:!0,result:!1}):!this.bKf||-798660877!==pa&&137938150!==pa?{Tec:!1}:{Tec:!0,result:!1}:{Tec:!1}}render(){this.formulaAssistanceTelemetryManager.YB(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){if(this.r_){const pa=()=>b(this.$);this.Qo=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,
this.Icc(),pa)}}else{const pa={};pa.zoomLevel=U(this.$);this.formulaAssistanceUIControl.updateContext(pa);this.Qo=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,this.Za.textBox.domElement,this.Icc(),()=>{})}}this.Qo();this.a9i();this.Oq.Hf=!0;this.Yqh()}}Yqh(){this.formulaAssistanceTelemetryManager.yw(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverall");const pa=this.yr.items.some(Nb=>1===Nb.type),tb=this.yr.items.some(Nb=>0===Nb.type);
pa&&tb?this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverallSimpleAndSmart"):pa?this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverallSmartOnly"):tb&&this.formulaAssistanceTelemetryManager.Lua("autoCompleteOverallSimpleOnly")}a9i(){const pa=this.eQb;this.eQb=this.a4h(this.yr.items);pa!==be.Dismissed&&pa!==be.Smart||this.eQb!==be.Simple&&this.eQb!==be.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}G9i(){var pa;if(this.Boi&&0!==this.yr.items.length){var tb=0<=this.gX?this.gX:
0,Nb=this.yr.items[tb];Nb={rG:Nb.label,description:null!==(pa=Nb.detail)&&void 0!==pa?pa:"",selectedIndex:tb+1,length:this.yr.items.length};this.raiseEvent("SelectedRowChanged",Nb)}}Trb(pa){if(this.Za&&this.visible){var tb=pa.textEdit;this.Eod(this.Za.text,tb);this.Za.textBox.caretPosition=tb.range.start.character+tb.newText.length;this.PF&&(this.Ufa=!1,this.pNa&&(this.F7a&&this.formulaAssistanceTelemetryManager.yw(["autoCompleteSmartSuggestionAccepted"]),this.NTa=this.woa=!0),this.Owj(),this.gridView.uaa.w2f(),
this.Za.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:pa.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.Ldf(pa.kind)}}Owj(){this.formulaAssistanceTelemetryManager.jI={lk:this.gridView.ha.ra.activeCell,F3b:this.gridView.Vb.text,Vrb:!0};this.formulaAssistanceTelemetryManager.qlc=this.$.xa.oa.sheetId;this.formulaAssistanceTelemetryManager.iDb=this.$.ea.ze;this.$.userOperationManager.ur(this.NPa)}gPg(){this.F7a&&
this.kaa&&!this.Iia&&!this.woa&&(this.formulaAssistanceTelemetryManager.MJ.dismissSmartSuggestionImplicitlyCounter++,this.kaa=!1);this.VI&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter++,this.VI=!1);this.woa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionSelectedCounter++,this.woa=!1);this.NTa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionCommittedCounter++,this.NTa=!1)}Icc(){const pa=new bb;pa.completionItems=this.yr.items;pa.activeItemIndex=this.gX;
this.eLd(pa);return pa}eLd(pa){pa.callbacks=new hf;pa.callbacks.onCompletionItemSelected=this.OCd;pa.callbacks.onCompletionItemCommitted=this.NCd;pa.callbacks.onFeedback=this.ySa;pa.callbacks.onDismiss=this.wOi;pa.callbacks.onRestoreFocus=this.onRestoreFocus}JHd(pa){this.Ufa=!0;const tb=pa.textEdit.newText;this.Za.Peb(tb.substring(this.Za.text.length-pa.textEdit.range.start.character,tb.length))}Jgb(pa){const tb=this.gX;this.gX=pa;const Nb=this.yr.items[pa];this.PF&&this.pna();tb!==pa&&this.render();
1===Nb.type&&aa.EwaSettings.xb()&&!this.gridView.zi.text.includes("\n")&&this.JHd(Nb);this.G9i()}Uxb(pa){return 0>pa?0:Math.min(pa,this.yr.items.length-1)}Eod(pa,tb){this.Za.text=pa.substring(0,tb.range.start.character)+tb.newText+pa.substring(tb.range.end.character,pa.length);this.gridView.Ul&&(this.gridView.Vb.text=this.Za.text)}Dwd(){this.sJa&&(this.formulaAssistanceTelemetryManager.MJ.selectByArrowKeyCounter++,this.sJa=!1);this.tJa&&(this.formulaAssistanceTelemetryManager.MJ.selectByMouseHoverCounter++,
this.tJa=!1);this.rJa&&(this.formulaAssistanceTelemetryManager.MJ.commitByTabKeyCounter++,this.rJa=!1);this.pJa&&(this.formulaAssistanceTelemetryManager.MJ.commitByEnterKeyCounter++,this.pJa=!1);this.qJa&&(this.formulaAssistanceTelemetryManager.MJ.commitByMouseClickCounter++,this.qJa=!1);this.F7a&&this.Iia&&(this.formulaAssistanceTelemetryManager.MJ.dismissSmartSuggestionExplicitlyCounter++,this.Iia=!1)}ADc(pa){switch(pa){case -798660877:case 137938150:case 2091832999:case 742457698:this.sJa=!0;break;
case 125627505:this.rJa=!0;break;case 267796030:this.pJa=!0}}static NKa(){return document.createElement("div")}a4h(pa){return pa.reduce((tb,Nb)=>tb|=0===Nb.type?be.Simple:be.Smart,be.Dismissed)}}Object(h.a)(Qe,"FormulaAutoCompleteControl",Gc.a,[268,2,239]);var jc=a(727);class Tc{constructor(pa,tb){var Nb,vc;this.Vg=pa;this.$=tb;this.xcg=new Map;this.yYd=null;this.hza=()=>{this.dac.resolve(this.Vg.$k);this.Agg()};this.XCf=()=>{this.dac.reject(null);this.Agg()};this.jg=()=>{this.Vg.bdb();this.avd=null;
this.xcg.clear();this.wFg()};this.lDf=(Ic,kd)=>{if(kd!==this.A5j)r.ULS.sendTraceTag(509678923,0,15,"onGetTableColHeadersSuccess called with a tableName different than the one saved for last request"),this.yBc.reject();else if(Object(Rd.a)(Ic))this.yBc.reject();else{var xd=Ic.Result;Object(jc.b)(xd)&&0!==xd.length?(this.xcg.set(kd,xd),void this.yBc.resolve(Ic.Result)):this.yBc.reject()}};this.kDf=()=>{this.yBc.reject()};null===(vc=null===(Nb=L.h(this.$))||void 0===Nb?void 0:Nb.fc)||void 0===vc?void 0:
vc.Rm(this.jg);this.$Hj=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(pa,tb,Nb,vc){const Ic={G$:pa,zNe:tb};var kd;if(kd=Object(jc.b)(this.avd))kd=this.avd,kd=!(Ic.G$.FirstRow===kd.G$.FirstRow&&Ic.G$.FirstColumn===kd.G$.FirstColumn&&Ic.G$.LastRow===kd.G$.LastRow&&Ic.G$.LastColumn===kd.G$.LastColumn&&Ic.G$.SheetName===kd.G$.SheetName&&Ic.zNe===kd.zNe);kd&&this.Vg.bdb();this.avd=Ic;this.$Hj&&this.Vg.r7a||this.Vg.TZ(pa,
Nb,vc,tb);this.dac=new jc.a;this.Vg.r7a?this.dac.resolve(this.Vg.$k):this.Ccj();return this.dac.promise}dispose(){var pa,tb;null===(tb=null===(pa=L.h(this.$))||void 0===pa?void 0:pa.fc)||void 0===tb?void 0:tb.em(this.jg)}Ccj(){this.Vg.$_b(this.hza);this.Vg.ELg(this.XCf)}Agg(){this.Vg.Kuc(this.hza);this.Vg.Vgj(this.XCf)}wFg(){Object(jc.b)(this.yYd)&&(Ua.AFrameworkApplication.zd.au(this.yYd.qt),this.yYd=null)}}Object(h.a)(Tc,"ServerDataProvider",null,[267]);var ub=a(324),Vb=a(580),tc=a(346),Sc=a(874);
class jd{constructor(pa){this.FK=this.GK=this.NF=this.OF=!1;this.z_=pa}}Object(h.a)(jd,"MarqueeRangeData",null,[]);class pb{constructor(pa,tb,Nb,vc=!1){this.XYd=pa;this.oPb=tb;this.Z7a=vc;Nb?(this.z_=Nb.z_,this.OF=Nb.OF,this.NF=Nb.NF,this.GK=Nb.GK,this.FK=Nb.FK):r.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(h.a)(pb,"MarqueeMetadata",null,[]);const Rb="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class oc{constructor(pa,tb,Nb){this.$=pa;this.pluginScheduler=tb;this.formulaAssistanceTelemetryManager=Nb;this.$mf=this.EK=this.ufb=!1;this.Kha=void 0;this.bS=null;this.uh=()=>{this.Kha=void 0};this.aza=()=>{this.EK=!1;this.Kha=void 0;this.bS=null};this.gridView=L.h(pa);this.gridView.Vb.Rm(this.aza);this.$mf=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094505_updateFormulaHighlightsTelemetry");this.Ksd=(this.z8a=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",
!1))&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7144730_FormulaHighlightsCaching")}get coloredReferencesManager(){this.hWa||(this.hWa=this.$.da.Aa(281));return this.hWa}YTj(pa,tb,Nb){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.lgb(pa,tb,Nb)}lgb(pa,tb,Nb){var vc;this.$mf&&pa.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.ufb||pa.PF)return!1;const Ic=isNullOrUndefined(tb)?pa.text:tb;if(1>=Ic.length)return this.djg(pa,
Ic,Object(jc.b)(tb));Nb=this.l4h(pa,tb,Nb);if(this.z8a&&!this.Ksd&&this.UDj(pa,{content:Ic,selection:Nb}))return!0;Nb=null===(vc=this.X4a(Ic,Nb))||void 0===vc?void 0:vc.formulaHighlights;if(!Nb)return r.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.djg(pa,Ic,Object(jc.b)(tb));const {uOj:kd,l$i:xd,j$i:ae,pEi:oe}=this.lVh(Nb,Ic);this.Hyc(pa,kd,!!tb);tb=pa.textBox.text;if(!Va.a.equals(tb,Ic,!1))return r.ULS.shipAssertTag(38114182,
0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${tb.length}], updatedTextLength [${Ic.length}]`),tb=pa.textBox.caretPosition,pa.textBox.text=Ic,pa.textBox.caretPosition=tb,!0;this.Cz(xd,ae,oe);return this.EK=!0}PEb(pa,tb,Nb){if(!pa||!tb||!Nb)return r.ULS.shipAssertTag(512349463,0,!!pa,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),r.ULS.shipAssertTag(512349462,
0,!!tb,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),r.ULS.shipAssertTag(512349461,0,!!Nb,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const vc=Object(Pb.a)(pb,tb.metadata);if(!vc)return r.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Ic=vc.XYd,kd=vc.oPb,xd=this.gridView.Bb.vqd(Nb)?Nb.Xwb(vc.NF,vc.OF):Nb.xLa(vc.NF,vc.OF,vc.FK,vc.GK);if(!xd)return r.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),
!1;const ae=kd.indexOf("!");-1!==ae&&(xd=kd.substring(0,ae+1)+xd);if(!pa.textBox.changeTextInExistingTextPart(Ic,kd,xd))return r.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;vc.oPb=xd;Ic=!0;for(kd=1;4>=kd;kd++)(xd=L.h(this.$).qb.Cv(3,kd,tb.oU))?(xd.range=Nb,xd.metadata=vc):(r.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Ic=!1);this.gridView.qb.update(!1,!1);this.gridView.Ul&&
(this.gridView.fc.textBox.text=pa.text);this.gridView.fc.NQa(new ub.a({GAb:!0}));return Ic}Joi(pa){if(3!==pa.Rq)return r.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;pa=Object(Pb.a)(pb,pa.metadata);return pa?pa.z_&&!pa.Z7a:(r.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}OBa(pa,tb){r.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+
(tb?"suspending":"resuming")+" colored references");tb&&this.EK&&(this.EK=!1,this.Cz(null,null),pa.textBox.WCe());this.ufb=tb}dispose(){var pa;this.gridView&&this.gridView.Vb&&this.gridView.Vb.em(this.aza);(null===(pa=this.gridView)||void 0===pa?0:pa.fc)&&this.gridView.fc.Gk(this.uh);this.Kha=void 0}jzb(pa){this.formulaAssistanceTelemetryManager.YB(["highlightPreviewRanges"]);var tb=this.X4a(pa,Sc.a);if(isNullOrUndefined(tb))this.Xka&&this.Cz(null,null);else{var Nb=this.bka(),vc=[],Ic=new Zc.a(!1),
kd=[];tb=tb.formulaHighlights;for(const xd of tb)if(tb=xd.kind,0===tb||2===tb||1===tb)tb=qa.B(xd.rangeInfo.sharedRange),Object(jc.b)(tb)&&(vc.push(new tc.a(tb,Nb)),this.SZ(tb,Ic,1),kd.push(new pb(xd.span.start,pa.substring(xd.span.start,xd.span.end),f(xd),!0)));this.Cz(vc,Ic,kd);this.formulaAssistanceTelemetryManager.yw(["highlightPreviewRanges"],!0)}}YXj(pa,tb){pa&&this.formulaAssistanceTelemetryManager.ibc.formulaHighlightsCounter++;tb&&this.formulaAssistanceTelemetryManager.ibc.parenthesesCouplingCounter++}djg(pa,
tb,Nb){this.Cz(null,null);this.Kha=void 0;if(this.EK){this.EK=!1;const vc=pa.textBox.caretPosition;pa.textBox.setPlainText(tb);pa.textBox.caretPosition=Math.min(vc,tb.length);if(Nb)return!0}return!1}UDj(pa,tb){var Nb,vc,Ic,kd;const xd=(null===(Nb=this.Kha)||void 0===Nb?void 0:Nb.aN)===pa&&(null===(vc=this.Kha)||void 0===vc?void 0:vc.K9c.content)===tb.content&&(null===(Ic=this.Kha)||void 0===Ic?void 0:Ic.K9c.selection.index)===tb.selection.index&&(null===(kd=this.Kha)||void 0===kd?void 0:kd.K9c.selection.length)===
tb.selection.length;xd||(this.Kha={K9c:tb,aN:pa});return xd}l4h(pa,tb,Nb){let vc=Nb;Object(jc.b)(tb)?Object(jc.b)(Nb)||(vc={index:tb.length,length:0}):vc=pa.textBox.selection;return vc}X4a(pa,tb){if(this.Ksd&&this.Sqi({content:pa,selection:tb}))return this.bS.result;this.formulaAssistanceTelemetryManager.YB(["formulaHighlightsRequest"]);const Nb=this.pluginScheduler.syncRequester().formulaHighlighting({content:pa,caretPosition:tb.index,selectionLength:tb.length});this.Ksd&&(this.bS={content:pa,selection:tb,
result:Nb});this.formulaAssistanceTelemetryManager.yw(["formulaHighlightsRequest"]);return Nb}SZ(pa,tb,Nb){let vc=tb.getItem(pa.toString());vc||(vc=Rb[tb.count%Rb.length],tb.add(pa.toString(),vc));return String.format(vc,Nb)}KE(pa,tb,Nb,vc,Ic=null,kd=null){r.ULS.shipAssertTag(512349453,0,Nb<=vc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");Nb<vc&&(tb=tb.substring(Nb,vc),pa.push(Object(nb.a)(new Vb.a,{text:tb,color:Ic,backgroundColor:kd})))}Cz(pa,tb,Nb=null){pa&&
pa.length?(r.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+pa.length),pa.reverse(),Nb.reverse(),this.gridView.qb.lx(pa,[3],!0,(vc,Ic)=>{if(vc&&vc.range&&Ic){r.ULS.shipAssertTag(512349448,0,tb.lb(vc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${vc.range.toString()}' doesn't exist in the range to color dictionary`);var kd=this.SZ(vc.range,tb,.1),xd=this.SZ(vc.range,tb,1);this.$.frame&&this.$.frame.xD&&this.$.frame.xD.CN||
(Ic.style.background=kd);Ic.style.borderColor=xd;Nb&&(Ic.setAttribute(A.a.C6a,vc.oU.toString()),vc.metadata=Nb[vc.oU])}else r.ULS.shipAssertTag(512349451,0,!!vc,"FormulaHighlightsControl.HighlightRanges: state is null"),r.ULS.shipAssertTag(512349450,0,!!vc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),r.ULS.shipAssertTag(512349449,0,!!Ic,"FormulaHighlightsControl.HighlightRanges: div is null")})):(pa=this.$.Kb.Bc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Zg([3]),
this.gridView.qb.RSa(new tc.a(null,this.bka()),[3]),pa.stop())}Hyc(pa,tb,Nb){const vc=pa.textBox;vc.HF=!0;var Ic=vc.selection;const kd=Ic.index;Ic=kd+Ic.length;vc.setTextFromTextParts(tb);tb=vc.text.length;vc.selectRange(Math.min(kd,tb),Math.min(Ic,tb));Nb&&pa.NQa(new ub.a);vc.HF=!1}rdc(){return this.gridView.ar&&this.gridView.ar.eG?this.gridView.ar.eG:this.$.oa}bka(){return this.rdc().sheetId}lVh(pa,tb){const Nb=[],vc=new Zc.a(!1),Ic=[],kd=[],xd=[];let ae=!1;var oe=!1;let ve=0;const Ge=this.bka();
for(const ye of pa){this.KE(Ic,tb,ve,ye.span.start,null);switch(ye.kind){case 0:case 1:case 2:pa=qa.B(ye.rangeInfo.sharedRange);if(isNullOrUndefined(pa)){r.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${ye.kind.toString()}`);this.KE(Ic,tb,ye.span.start,ye.span.end,null);break}oe=this.SZ(pa,vc,1);this.KE(Ic,tb,ye.span.start,ye.span.end,oe);Nb.push(new tc.a(pa,Ge));kd.push({Start:ye.span.start,End:ye.span.end});
oe=Ic.length-1;xd.push(new pb(oe,Ic[oe].text,f(ye)));oe=!0;break;case 3:this.KE(Ic,tb,ye.span.start,ye.span.end,null,"rgba(229, 229, 229, 1)"),ae=!0}ve=ye.span.end}this.KE(Ic,tb,ve,tb.length);this.YXj(oe,ae);return{uOj:Ic,l$i:Nb,j$i:vc,pEi:xd}}Sqi(pa){return Object(jc.b)(this.bS)&&this.bS.content===pa.content&&this.bS.selection.index===pa.selection.index&&this.bS.selection.length===pa.selection.length}}Object(h.a)(oc,"FormulaHighlightsControl",null,[266,2]);class Jc{constructor(pa,tb,Nb,vc,Ic,kd,
xd){this.$=pa;this.functionInfoManager=tb;this.calcManager=Nb;this.pluginScheduler=vc;this.formulaAssistanceUIControl=Ic;this.formulaAssistanceTelemetryManager=kd;this.Vg=xd;this.kTa=!0;this.bNa=this.isCellContentOnlyEqualDuringEdit=!1;this.c6=null;this.jca=-1;this.rW=0;this.Lba=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.qBb=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.hdd=aa.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",
!1);this.nEc=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.Sh=(ae,oe)=>{this.gridView.eb||this.gridView.ri||this.pPa(null===oe||void 0===oe?void 0:oe.cell)};this.uh=(ae,oe)=>{this.pPa(null===oe||void 0===oe?void 0:oe.yja)};this.onFunctionInfoLoaded=()=>{this.hdd||this.functionInfoManager.Dcb(this.onFunctionInfoLoaded);this.ojg();this.Qda()};this.ozf=()=>{this.kTa=!1};this.wzf=(ae,oe)=>{var ve=this.Za;ae=ve.text;ve=ve.textBox.caretPosition;0<this.rW&&
this.formulaAssistanceTelemetryManager.MJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.YB(["argumentAssistanceComputation","argumentAssistanceOverall"]);oe.shouldRequestAutocompleteOnCommit?this.E1f(ae,ve):this.GNd(ae,ve)};this.jg=()=>{this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.qK.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1);this.bNa&&(this.formulaAssistanceTelemetryManager.qK.isCellContentFormulaCounter++,
this.bNa=!1);this.kTa=!0;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.p8b()};this.G6=(ae,oe)=>{this.nPd(oe.newValue)};this.Ij=()=>{this.iig()};this.iig=()=>{const ae=this.H7b.gLe;this.pluginScheduler.notifier().setDefinedNamesInfo(ae);r.ULS.sendTraceTag(512278605,0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===ae||void 0===ae?void 0:ae.length} names}`)};this.X4a=(ae,oe)=>{ae=this.pluginScheduler.syncRequester().formulaHighlighting({content:ae,
caretPosition:null===oe||void 0===oe?void 0:oe.index,selectionLength:null===oe||void 0===oe?void 0:oe.length});if(isNullOrUndefined(ae)||isNullOrUndefined(ae.formulaHighlights))r.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(ae)}`);else return ae};this.functionInfoManager=tb;this.formulaAssistanceUIControl=Ic;this.pluginScheduler=vc;this.gridView=L.h(this.$);this.gkf=
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.j5=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.sBd=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.w_c=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Mmi=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.gkf&&(this.H7b=new Qb(pa),
this.gridView.Da.hw(this.Ij),this.iig());this.zqa=new je(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.e9=new Qe(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.jni=X.a.hR(pa);this.RIj=X.a.Rpb(pa);this.Qji=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.rsi=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",!1);this.jni&&(this.Aqa=new oc(this.$,
this.pluginScheduler,this.formulaAssistanceTelemetryManager));pa.da.Ga(464,this);this.calcManager=Nb;X.a.IV(this.$)&&this.pod();this.gridView.fc.Rm(this.jg);this.j5&&this.zqa.gLg(this.ozf);this.Xpd=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.hdd&&(this.functionInfoManager.GGa(this.onFunctionInfoLoaded),this.functionInfoManager.JV?this.ojg():this.functionInfoManager.OJa({}))}get Bja(){return this.e9}get vZe(){return this.zqa}get lB(){return this.Aqa}get lbb(){return this.Za.nqi?
1:0}get Za(){return this.gridView.zi}get Bb(){return this.gridView.Bb}dispose(){if(this.$){const pa=this.gridView;pa&&(pa.ha&&X.a.IV(this.$)&&(this.qBb?pa.fc.Gk(this.uh):pa.ha.qna(this.Sh)),this.gkf&&pa.Da&&pa.Da.ex(this.Ij))}this.gridView.fc.em(this.jg);this.j5&&this.zqa.Dgj(this.ozf);this.e9.pgj(this.wzf);this.functionInfoManager&&this.functionInfoManager.Dcb(this.onFunctionInfoLoaded);X.a.ihc&&this.Za&&this.Za.dKb(this.G6);Y.a.Ia(this.zqa);Y.a.Ia(this.e9);this.e9=this.zqa=this.functionInfoManager=
this.$=null}rlj(){this.jca=-1;this.c6=null}p8b(){this.e9.visible=!1;this.zqa.visible=!1}Zh(){this.Qda();return!1}Qda(){if(!this.Za.oL)if(this.formulaAssistanceTelemetryManager.Ypb.formulaAssistanceRequestAttemptedCounter++,this.iDj()){this.hdd||this.functionInfoManager.JV||(this.functionInfoManager.GGa(this.onFunctionInfoLoaded),this.functionInfoManager.OJa({}));var pa=this.Za,tb=pa.text;pa=pa.textBox.caretPosition;tb.startsWith("=")&&(this.bNa=!0,1===tb.length&&(this.isCellContentOnlyEqualDuringEdit=
!0));!this.j5||this.kTa?(this.formulaAssistanceTelemetryManager.YB("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),this.E1f(tb,pa)):(this.formulaAssistanceTelemetryManager.YB(["autoCompleteComputation","autoCompleteOverall"]),this.Zkj(tb,pa));this.Qji&&this.dlj(tb,pa)}else this.formulaAssistanceTelemetryManager.Ypb.formulaAssistanceRequestOptimizedCounter++}E1f(pa,
tb){const Nb=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:pa,caretPosition:tb},argumentAssistance:{content:pa,caretPosition:tb}});this.rW+=1;this.nEc&&(this.c6=pa,this.jca=tb);Nb.then(vc=>{--this.rW;0===vc.kind&&(this.K9e(vc.payload.argumentAssistance),this.p$e(vc.payload.functionSuggestion,pa));return null})}Zkj(pa,tb){const Nb={content:pa,caretPosition:tb};this.nEc&&(this.c6=pa,this.jca=tb);tb=this.Lba?this.pluginScheduler.getRequester().functionSuggestion(Nb,
this.lbb):this.pluginScheduler.requester().functionSuggestion(Nb);this.rW+=1;tb.then(vc=>{--this.rW;0===vc.kind&&this.p$e(vc.payload,pa);return null})}dlj(pa,tb){tb={content:pa,caretPosition:tb,enableAutocompleteWrapperPlugin:this.rsi&&!this.RIj};this.Lba&&(tb=this.pluginScheduler.getRequester().runPerCharacterExperiment(tb,this.lbb),this.rW+=1,tb.then(Nb=>{--this.rW;if(0===Nb.kind)for(const vc of Nb.payload.results)0===vc.kind&&this.gridView.uaa.eSd(vc.value,pa);return null}))}GNd(pa,tb){const Nb=
{content:pa,caretPosition:tb};this.nEc&&(this.c6=pa,this.jca=tb);pa=this.Lba?this.pluginScheduler.getRequester().argumentAssistance(Nb,this.lbb):this.pluginScheduler.requester().argumentAssistance(Nb);this.rW+=1;pa.then(vc=>{--this.rW;0===vc.kind&&this.K9e(vc.payload)})}iDj(){var pa=this.Za;const tb=pa.text;pa=pa.textBox.caretPosition;if(this.e9.visible&&Va.a.equals(tb,this.c6,!0)&&(!this.Mmi||!Ia.e(tb))&&pa===this.jca)return!1;this.nEc||(this.c6=tb,this.jca=pa);return!0}sPd(){this.Lba?this.pluginScheduler.getRequester().runExperiment(new Lb,
this.lbb):this.pluginScheduler.requester().runExperiment(new Lb)}K9e(pa){pa&&this.Za.eb?(this.formulaAssistanceTelemetryManager.yw(["argumentAssistanceComputation"]),this.zqa.show(pa,this.Za.textBox.domElement)):this.zqa.dismiss()}p$e(pa,tb){pa&&0<pa.items.length&&this.Za.eb&&this.Za.text===this.c6?this.w_c&&this.Bb.H5(this.gridView.ha.ra.activeCell)?(this.formulaAssistanceTelemetryManager.qK.smartSuggestionWouldSuggestInsidePivotCounter++,this.e9.dismiss()):(this.formulaAssistanceTelemetryManager.yw(["autoCompleteComputation"]),
this.e9.show(pa)):this.e9.dismiss();this.gridView.uaa.eSd(pa,tb)}nPd(pa){pa={content:pa,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Lba?this.pluginScheduler.getRequester().runAuthoringExperiment(pa,this.lbb):this.pluginScheduler.requester().runAuthoringExperiment(pa)}pPa(pa){var tb;const Nb=this.gridView.ha.ra.activeCell;if(Nb){var vc=this.calcManager.Eta(Nb,!this.Xpd);if(vc){var Ic=this.$.xa,kd=vc.sheet.index;0>=Ic.count||0>kd||kd>=Ic.count?r.ULS.sendTraceTag(512278608,
0,50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Ic.count}, currentSheetIndex = ${kd}.`):(kd=Ic=null,this.sBd&&void 0!==this.calcManager&&null!==this.calcManager&&(pa=null!==(tb=null===pa||void 0===pa?void 0:pa.cell)&&void 0!==tb?tb:this.gridView.Da.rs(Nb))&&(tb=this.calcManager.mdc(pa.Gj),void 0!==tb&&null!==tb&&(Ic=tb.FormatString,kd=tb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:vc.range.col,rowIndex:vc.range.row,sheetIndex:this.$.xa.getItem(vc.sheet.index).sheetId,
docName:vc.sheet.document.name,docPath:vc.sheet.document.path,formatString:Ic,builtIn:kd}),r.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${vc.range.col}, row: ${vc.range.row}, format: ${Ic}`))}else r.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else r.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}ojg(){const pa=
this.functionInfoManager.qbc;this.pluginScheduler.notifier().setFunctionsInfo(pa);r.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===pa||void 0===pa?void 0:pa.length} functions}`)}pod(){this.qBb?this.gridView.fc.Yk(this.uh):this.gridView.ha.eha(this.Sh);const pa=X.a.eAb()?this.gridView.Sb(null):void 0;this.pPa(pa);X.a.ihc&&this.Za.EZa(this.G6);this.sPd();this.e9.UKg(this.wzf);this.pluginScheduler.setServerDataProvider(new Tc(this.Vg,
this.$));this.Qda()}lgb(pa,tb,Nb){Nb=Object(jc.b)(tb)?this.X4a(tb,Object(jc.b)(Nb)?Nb:Sc.a):this.X4a(pa.text,pa.textBox.selection);return this.Aqa.YTj(pa,tb,Nb)}}Object(h.a)(Jc,"FormulaAssistanceManager",null,[234,2]);a(185);class ud extends fc.a{constructor(pa){super();this.$=pa;this.Fb()}create(){var pa=X.a.IV(this.$);const tb=aa.EwaSettings.ma(368),Nb=aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),vc=X.a.HV(this.$),Ic=this.$.da,kd=m.GetServiceTaskFactory.create(Ic,
134,this.ka,this.Ya),xd=m.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya);let ae;ae=X.a.k5(this.$)?m.GetServiceTaskFactory.create(this.$.da,449,this.$.ka,1):S.Task.Ta(null);let oe;oe=X.a.IV(this.$)?m.GetServiceTaskFactory.create(this.$.da,414,this.$.ka,1):S.Task.Ta(null);let ve;ve=aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&!vc?m.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):S.Task.Ta(null);if(Nb||pa){const Ge=m.GetServiceTaskFactory.Oa(Ic,266,265,this.Ya),
ye=m.GetServiceTaskFactory.Oa(Ic,219,220,this.Ya),qf=m.GetServiceTaskFactory.Oa(Ic,491,492,this.Ya);pa=[Ge,oe,ae,ye,qf,ve];aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&pa.push(kd,xd);x.TaskExtensions.za(x.TaskExtensions.Ed(pa,this.ka),()=>{const Ja=Ic.Aa(19)||new ze(this.$,oe.result),Db=ye.result;if(vc){var rc=Ic.Aa(464);rc||(rc=new Jc(this.$,Ja,Ge.result,oe.result,ae.result,qf.result,xd.result.M5c(this.$,kd.result)),Db.zZc(rc.vZe),Db.AZc(rc.Bja),
aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Db.BZc(rc.Bja))}else rc=Ic.Aa(221),rc||(rc=new nc(this.$,Ja,kd.result,Ge.result,null,xd.result,ae.result,qf.result,oe.result,ve.result),Db.zZc(rc.wZe),Db.BZc(rc.PZe),Db.AZc(rc)),tb&&(Ic.Aa(317)||new Da(this.$));this.nb(Ja)},this.ka,3)}else{const Ge=m.GetServiceTaskFactory.Oa(Ic,219,220,this.Ya),ye=m.GetServiceTaskFactory.Oa(Ic,491,492,this.Ya);pa=[Ge,ae,oe,ve];aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&
pa.push(kd,xd,ye);x.TaskExtensions.za(x.TaskExtensions.Ed(pa,this.ka),()=>{const qf=Ic.Aa(19)||new ze(this.$,oe.result),Ja=Ge.result;let Db=Ic.Aa(221);Db||(Db=new nc(this.$,qf,kd.result,null,null,xd.result,ae.result,ye.result,oe.result,ve.result),Ja.zZc(Db.wZe),Ja.BZc(Db.PZe),Ja.AZc(Db));tb&&(Ic.Aa(317)||new Da(this.$));this.nb(qf)},this.ka,3)}}static la(pa){pa.da.Ga(153,new ud(pa))}}Object(h.a)(ud,"FunctionInfoManagerFactory",fc.a,[]);a.d(F,"a",function(){return Fb});const Fb=()=>{d.a.Fa(pa=>{hb.la(pa);
wb.la(pa);ud.la(pa)})}},1139:function(u,F,a){var c=a(0),b=a(694),e=a(149),f=a(7),d=a(15),h=a(82),n=a(4),m=a(157),x=a(1074),r=a(1072),y=a(718),t=a(5),v=a(464),w=a(561),C=a(76),B=a(58),z=a(908),A=a(132),E=a(40),I=a(188),L=a(60),V=a(49),T=a(751),H=a(142),D=a(37),G=a(116),J=a(209),M=a(92),Q=a(71),U=a(35),Z=a(29),P=a(282),S=a(1),ja=a(184),X=a(13),Y=a(62),va=a(281),N=a(21),ea=a(133),Ca=a(773),la=a(774),Ra=a(124),lb=a(112),Aa=a(51),da=a(34),aa=a(426);class fa{constructor(){this.Sections=this.Id=null}}Object(c.a)(fa,
"AutoFilterMenu",null,[]);class Oa{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(Oa,"MenuItem",null,[]);class ba{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(c.a)(ba,"MenuSection",null,[]);class ka{constructor(){this.isSuccess=!1}}Object(c.a)(ka,"ApplyFilterByValueResponse",null,[]);class Pa{constructor(){this.displayText=
null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(Pa,"FilterByValueItem",null,[]);class Fa{constructor(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(Fa,"GetColorsAndIconsResponse",null,[]);class oa{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(oa,"GetFilterByValueItemsResponse",
null,[]);class La{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(La,"ShowSortFilterMenuParams",null,[]);class Ea{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}}Object(c.a)(Ea,"SortFilterControllerFactoryParams",null,[]);class ca{constructor(){this.top=this.left=0}}Object(c.a)(ca,"TargetPoint",null,[]);var $a=a(55),Qa=a(185),
Va=a(33),fb=a(155),Ka=a(227),hb=a(8);const fc=t.a.x8g;class dc extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateAutoFilterContextMenu",1675506831,1651433993,fc,!0,!1,"AutoFilterContextMenuRoot",Rb,oc,!1,Jc);this.MYc=this.IUa=this.sheetName=this.btb=null;this.I3a=this.Eqf=!1;this.W6c=this.Zab=this.UJe=this.qQa=this.qdc=this.Abd=this.dfb=this.kIb=null;this.eW=()=>{this.xAc();this.$.ea.jo(this.eW)};this.YCf=ud=>{this.I3a||ea.b(this.$).ud(A.a.ZCf,this.vm(),void 0,!0);var Fb={};this.$.pk(Fb);var pa=
this.$.ea.isNamedObjectViewMode;const tb=B.a.ki(this.MYc);tb.SheetName=pa?Fb.NamedObjectName:Fb.SheetName;tb.NamedObjectView=pa;Fb=!!ud.searchText;pa=586;this.I3a&&(Fb&&(tb.ItemListOptions=this.oah(ud.searchText),pa=597),ea.b(this.$).ud(A.a.ZCf,{["UserOperation"]:pa.toString()},void 0,!0));const Nb=this.qDd(Fb),vc=this.IQi(),Ic=this.$.pa.ya.Wb();this.UJe=Ic.RequestId;this.I3a&&this.qdc&&!this.qdc.dequeueUtcTime&&(this.$.userOperationManager.iua(this.qdc),this.l0g());ud=new I.a(pa,0,(kd,xd,ae)=>this.W6c=
L.n(this.$.pa.ya,tb,va.b(kd,Nb),this.I3a?va.a(xd,vc):xd,ae,null,Ic),80);this.qdc=this.$.userOperationManager.Ic(ud,null);this.Zab=this.W6c;this.qQa=this.UJe};this.onMenuItemClick=(ud,Fb,pa)=>{ea.b(this.$).ud(A.a.AVi,this.vm(),void 0,!0);Fb={["CommandValueId"]:Fb,["MenuItemId"]:Fb,["InputMethod"]:pa,["TopCellAddress"]:this.IUa};const tb=new M.a(ud,pa,this.$.isEditMode?2:1,19,null);this.$.Ja.Lb(tb,Fb);d.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${ud}, ${pa}`)};this.focusShiftOnMenuDismiss=
()=>{N.h(this.$).focus()};this.lzf=ud=>{if(ud.checkedItems&&ud.checkedItems.length){ea.b(this.$).ud(A.a.mzf,this.vm(),void 0,!0);var Fb=B.a.ki(this.MYc),pa={};this.$.pk(pa);pa.FirstRow=0;pa.FirstColumn=Fb.Column;var tb=this.$.ea.isNamedObjectViewMode;Fb.NamedObjectView=tb;Fb.SheetName=tb?pa.NamedObjectName:pa.SheetName;var Nb=kd=>{if(Ca.a.zzc(kd)){const xd=Ca.a.Obc(kd);this.ENa?Ca.a.BRa(la.a.applyItemFilter,xd.MessageIdName,lb.a.pHa,!0,Ca.a.isSessionEndingError(xd.MessageId)):d.ULS.sendTraceTag(537167129,
0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${xd.MessageIdName}`)}P.a(kd)||(d.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ea.b(this.$).ud(A.a.SCf,this.vm(),void 0,!0),kd=Object(f.a)(new ka,{isSuccess:!0}),this.dfb.onApplyFilterByValueFinish(kd),this.FS(this.IUa))},vc=this.z5c(Fb,pa),Ic=new I.a(208,0,(kd,xd,ae)=>L.a(this.$.pa.ya,vc,ud.checkedItems,va.b(kd,Nb),xd,ae,null,null),6,()=>new z.a(ud.checkedItems,
vc));this.oGj(()=>{this.$.userOperationManager.Ic(Ic,null)})}else d.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.Dve=ud=>{const Fb=E.o(this.IUa,this.$),pa=E.v(this.IUa,this.$);var tb=Object(f.a)(new x.a,{SortConditionType:ud.type,RowColOffset:Fb.FirstColumn-pa.FirstColumn,SortColor:ud.color,SortIconSet:ud.icon.IconSet,SortIcon:ud.icon.Icon,IsAscending:!0});tb=Object(f.a)(new r.a,{OperationType:1,ActiveCell:Fb,SelectedRange:pa,
SortConditions:[tb],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const Nb={};Nb.SortOptions=tb;Nb.SelectedRange=pa;Nb.OriginalActiveCell=Fb;Nb.ShouldRestoreSelection=!1;Nb.ShouldPromptNamedSheetViewTeachingDialog=!0;d.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${ud.type}`);this.$.Xc(-1089513346,C.a.Db,19,{["CustomSortCommandData"]:Nb})};this.ENa=Ca.a.ppd();this.Dz=S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Yw(){return"PopulateAutoFilterContextMenu"}get QB(){return t.a.SQf}executeCommand(pb,
Rb,oc){pb=Rb.command;switch(pb){case 1701016594:return y.a.ICh(oc),$a.Task.Ta(!0);case 966232027:if(S.EwaSettings.ml()){const Jc=new m.a;D.TaskExtensions.za(V.GetServiceTaskFactory.Oa(this.$.da,8,9,0),ud=>{this.X$e(Rb,oc,ud.result);Jc.setResult(!0)},this.ka,3).continueWith(()=>{Jc.setResult(!1)},5,this.ka,Ka.a.instance);return Jc.task}this.X$e(Rb,oc);return $a.Task.Ta(!0);default:return ja.a(pb)}}X$e(pb,Rb,oc){const Jc=Rb.domEvent;if(Q.e(Jc.rawEvent)&&(Q.g(Jc),Jc.target)){var ud=new H.a(this.$.xa);
if(ud.Td(4096)||ud.Td(2048)){var Fb=B.a.ki(Rb[C.a.og]);this.C7f(Fb)&&(this.Eqf?this.nvc(Jc,Jc.target,Fb,pb,oc):(this.kIb=()=>{this.C7f(Fb)&&(this.mgi(),this.nvc(Jc,Jc.target,Fb,pb,oc),this.I3a=S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.Eqf=!0)},this.xAc()))}}}wc(pb,Rb,oc){if(pb=!!oc)switch(Rb.command){case 1701016594:case 966232027:S.EwaSettings.ml()||v.a(this.$)||(pb=!1,Rb=Aa.b().uj(Rb.command),d.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${Rb}`));
break;default:pb=!1}return pb}TGd(pb){pb.MenuSectionList.push(...this.btb)}mgi(){aa.a(()=>{S.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.dfb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new Ea,{getFilterByValueItemsRequest:this.YCf,applyFilterByValueRequest:this.lzf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:dc.NZc,applySortByColorOrIconRequest:this.Dve})):
this.dfb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new Ea,{getFilterByValueItemsRequest:this.YCf,applyFilterByValueRequest:this.lzf,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:dc.NZc,applySortByColorOrIconRequest:this.Dve}))});this.Abd=h.a.instance.Lh("Common.IExternalUICommandDefinitionMapping")||new w.a(this.$.Eb,this.$)}nvc(pb,Rb,oc,Jc,ud){ea.b(this.$).ud(A.a.nvc,this.vm(),void 0,!0);if(oc){pb=this.PNh(oc,ud);Jc=Sys.UI.DomElement.getBounds(Rb);
Rb=Jc.x+Jc.width;Jc=Jc.y;if(this.Dz&&!oc.IsHeaderSnapped){if(!y.a.Vpd(this.$,oc.Cell))return;oc=y.a.Ofd(this.$,oc.Cell,!0);Rb=oc.x;Jc=oc.y}oc=N.h(this.$).rtl?new Sys.UI.Point(Rb-da.a(this.$).XGa(dc.NZc),Jc):new Sys.UI.Point(Rb,Jc);oc=da.a(this.$).eka(oc);oc=Object(f.a)(new La,{targetPoint:Object(f.a)(new ca,{left:oc.x,top:oc.y}),autoFilterMenu:pb});this.dfb.showSortFilterMenu(oc);this.$.Xc(-544117314,-1,0,null)}else d.ULS.shipAssertTag(537167135,0,!!oc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}C7f(pb){return(null===
pb||void 0===pb?0:pb.Cell.SheetName)?N.h(this.$).C5?pb.Cell.SheetName===this.$.oa.name:pb.Cell.SheetName===this.$.oa.sheetName:!0}PNh(pb,Rb){return(pb=this.QNh(pb,Rb))?this.KOf(pb):null}KOf(pb){const Rb=[];for(const oc of pb.Sections){if(Object(fb.g)(this.$)&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&oc.Title===X.a.instance.ga(1942))continue;const Jc=this.w6i(oc);Rb.push(Jc)}return Object(f.a)(new fa,{Id:pb.Id,Sections:Rb})}w6i(pb){const Rb=[];for(const oc of pb.MenuItems)if(2===
oc.Identifier)this.MYc=oc.CommandData;else switch(oc.Type){case 3:case 2:Rb.push(this.u6i(oc,2===oc.Type));break;case 1:Rb.push(this.v6i(oc))}return Object(f.a)(new ba,{MenuItems:Rb,DisplayType:pb.DisplayType,Id:this.oLh(pb)})}v6i(pb){({label:ud,yMa:Jc}=this.x_e(pb));const Rb=this.KOf(pb.SubMenu),oc=this.n_e(pb);var Jc=this.Abd.Dcc(Jc);var ud=ud||pb.Label;return Object(f.a)(new Oa,{Disabled:pb.Disabled,Type:pb.Type,Identifier:pb.Identifier,Id:oc,CommandData:pb.CommandData,Label:ud,SubMenu:Rb,IsChecked:pb.IsChecked,
IconName:"MissingIcon_20"===Jc?null:Jc})}u6i(pb,Rb){let oc;({label:Rb,yMa:ud,Nr:oc}=this.xbc(pb,Rb&&pb.IsChecked));const Jc=this.Ied(pb,Rb);var ud=this.Abd.Dcc(ud);return Object(f.a)(new Oa,{Disabled:pb.Disabled,Type:pb.Type,Identifier:pb.Identifier,Id:Jc,RibbonCommand:oc,CommandData:pb.CommandData,Label:Rb||pb.Label,SubMenu:null,IsChecked:pb.IsChecked,IconName:"MissingIcon_20"===ud?null:ud})}QNh(pb,Rb){var oc;this.IUa=oc=E.C(pb.Cell);this.sheetName=this.$.oa.sheetName;Rb=Rb||v.a(this.$);if(pb.IsHeaderSnapped)oc=
Rb.nac.fVh(oc);else{Rb=N.h(this.$).Da.tLa(oc);if(!Rb)return this.ENa?Ca.a.BRa(la.a.UQf,Ra.a.v6h,lb.a.Xpb,!0,!1):(pb=N.h(this.$).view.visibleArea,d.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${oc}, visible range: ${pb}`)),null;oc=Rb.autoFilterMenu}if(!oc)return this.ENa?Ca.a.BRa(la.a.UQf,Ra.a.DFi,lb.a.Xpb,!0,!1):d.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.Wtb=pb.Cell.FirstRow+"_"+pb.Cell.FirstColumn;return oc}xAc(){if(this.$.ea.tg){const pb=V.GetServiceTaskFactory.Oa(this.$.da,283,284,1);D.TaskExtensions.za(pb,()=>{this.ENa?pb.result.kn.loadScript("sortFilter").then(()=>{this.kIb()},Rb=>{Y.a.Uk(Rb,"AutoFilterContextMenu.SortFilterScriptLoad");Ca.a.BRa(la.a.xAc,Ra.a.hJj,lb.a.Xpb,!1,!1)}):D.TaskExtensions.za(Qa.c(pb.result.kn.loadScript("sortFilter")),()=>{this.kIb()},this.$.ka,3)},this.$.ka,3)}else this.$.ea.Xk(this.eW)}oah(pb){const Rb={};
Rb.SearchText=pb;Rb.Page=1;Rb.DateNodeType=-1;return Rb}l0g(){this.qQa&&(d.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.qQa}`),L.h(this.$.pa.ya,this.qQa,null,null,null),this.qQa=null);this.Zab&&(n.AFrameworkApplication.zd.au(this.Zab.qt),this.Zab=null)}qDd(pb){return Rb=>{this.Zab=this.qQa=null;if(Ca.a.zzc(Rb)){var oc=Ca.a.Obc(Rb);this.ENa?Ca.a.BRa(pb?la.a.searchAutoFilterItemList:la.a.getAutoFilterItemList,
oc.MessageIdName,lb.a.Xpb,!0,!0):d.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${oc.MessageIdName}`)}if(!P.a(Rb)){d.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");Rb=Rb.Result;oc=new U.a(!0);const Jc=Rb.AutoFilterDateNodes?!0:!1;Rb.AutoFilterItems&&oc.add("AutoFilterItemsCount",Rb.AutoFilterItems.length);Jc&&oc.add("AutoFilterDateItemsCount",Rb.AutoFilterDateNodes.length);
oc.add("Location","contextMenu");ea.b(this.$).ud(A.a.qDd,oc.Gu,void 0,!0);oc=this.I3a?Object(f.a)(new oa,{filterByValueItems:this.qGe(Rb),hasMoreRecords:Rb.ItemListMaxExceeded,searchText:Rb.SearchText}):Object(f.a)(new oa,{filterByValueItems:this.qGe(Rb),hasMoreRecords:Rb.ItemListMaxExceeded});this.dfb.onGetFilterByValueItemsFinish(oc);pb||(d.ULS.shipAssertTag(529063959,0,null!==Rb.FontColors&&null!==Rb.CellColors&&null!==Rb.Icons&&null!==Rb.SelectedSortFontColors&&null!==Rb.SelectedSortCellColors&&
null!==Rb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Rb=Object(f.a)(new Fa,{fontColors:Rb.FontColors,cellColors:Rb.CellColors,icons:Rb.Icons,selectedSortFontColor:0<Rb.SelectedSortFontColors.length?Rb.SelectedSortFontColors[0]:null,selectedSortCellColor:0<Rb.SelectedSortCellColors.length?Rb.SelectedSortCellColors[0]:null,selectedSortIcon:0<Rb.SelectedSortIcons.length?Rb.SelectedSortIcons[0]:null,getColorName:this.getColorName}),
this.dfb.onGetColorsAndIconsFinish(Rb))}}}IQi(){return pb=>{this.Zab=this.qQa=null;pb=G.a.Pe(pb.data);pb=Z.a.sc(pb);d.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${pb}].`)}}qGe(pb){const Rb=this.Z8g(pb),oc=this.g9g(pb.AutoFilterItems),Jc=[],ud=[];let Fb=0,pa=0;pb.HasBlanks&&(pb=dc.N5c(X.a.instance.ga(782),pb.IsBlanksSelected?1:0,t.a.axe),Jc[Fb++]=pb);for(const tb of Rb)Jc[Fb++]=tb;if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const tb of oc)-1!==
Array.indexOf(hb.a.bad,tb.displayText)?ud[pa++]=tb:Jc[Fb++]=tb;else for(const tb of oc)Jc[Fb++]=tb;return Array.prototype.concat(ud,Jc)}Z8g(pb){const Rb=[];if(!pb.AutoFilterDateNodes||!pb.AutoFilterDateNodes.length)return Rb;const oc=[this.b5a(pb.YearKeys,pb.YearValues),this.b5a(pb.MonthKeys,pb.MonthValues),this.b5a(pb.DayKeys,pb.DayValues),this.b5a(pb.HourKeys,pb.HourValues),this.b5a(pb.MinuteKeys,pb.MinuteValues),this.b5a(pb.SecondKeys,pb.SecondValues)];let Jc=!1,ud=!1,Fb=0;var pa=null;const tb=
Array(6);var Nb=null;for(const vc of pb.AutoFilterDateNodes){tb[0]&&(Nb.Year!==vc.Year?(Jc=!0,Fb=0,pa=null):Nb.Month!==vc.Month?(ud=!0,Fb=1,pa=tb[0]):Nb.Day!==vc.Day?(Fb=2,pa=tb[1]):pb.ShowTime&&(Nb.Hour!==vc.Hour?(Fb=3,pa=tb[2]):Nb.Minute!==vc.Minute?(Fb=4,pa=tb[3]):(Fb=5,pa=tb[4])));for(;6>Fb;){let Ic;switch(Fb){case 0:Ic=vc.Year;Nb=oc[0].getItem(Ic.toString());break;case 1:Ic=vc.Month;Nb=oc[1].getItem(Ic.toString());break;case 2:Ic=vc.Day;Nb=oc[2].getItem(Ic.toString());break;case 3:Ic=vc.Hour;
Nb=oc[3].getItem(Ic.toString());break;case 4:Ic=vc.Minute;Nb=oc[4].getItem(Ic.toString());break;case 5:Ic=vc.Second;Nb=oc[5].getItem(Ic.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Nb=dc.N5c(Nb,-1!==vc.NodeType&&Fb>=vc.NodeType?1:0,pa?pa.key+";"+Ic:t.a.OZc+Ic,!1,[]);pa=pa?pa.children:Rb;pa=pa[pa.length]=Nb;tb[Fb]=Nb;switch(Fb){case 5:Fb=6;break;case 2:Fb=pb.ShowTime?Fb+1:6;break;default:Fb++}}Nb=vc}Jc||(tb[0].expanded=!0,ud||(tb[1].expanded=!0));return Rb}g9g(pb){const Rb=
[];if(!pb)return Rb;let oc=0;for(const Jc of pb)Rb[oc++]=dc.N5c(Jc.DisplayString,Jc.Selected?1:0,t.a.PZc+Jc.DisplayString);return Rb}b5a(pb,Rb){const oc=new U.a(!0);if(!pb||!Rb)return oc;const Jc=pb.length<Rb.length?pb.length:Rb.length;for(let ud=0;ud<Jc;ud++)oc.add(pb[ud].toString(),Rb[ud]);return oc}z5c(pb,Rb){const oc={};oc.Location=Rb;oc.FieldId=pb.Id.toString();oc.DataSourceIndex=-1;oc.FilterType=pb.AutoFilterType;oc.AnchorType=0;oc.ChartId=null;oc.AnchorValue1=-1;oc.AnchorValue2=-1;oc.Property=
pb.RichProperty;return oc}FS(pb){Va.a.sla(this.$)&&D.TaskExtensions.za(V.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Rb=>{Rb.result.Nea(pb);d.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.ka,3)}vm(){return{["Location"]:"contextMenu"}}getColorName(pb){return T.a.rLa(J.a.FH(pb))}oGj(pb){D.TaskExtensions.za(V.GetServiceTaskFactory.Oa(this.$.da,309,310,3),Rb=>{Rb.result.xTa().continueWith(oc=>{oc.result&&pb()})},
this.$.ka,3)}static N5c(pb=null,Rb=0,oc=null,Jc=!1,ud=null){return Object(f.a)(new Pa,{displayText:pb?y.a.If(pb):pb,state:Rb,key:oc,parent:null,children:ud,indentationLevel:0,expanded:Jc})}}dc.NZc=268;Object(c.a)(dc,"AutoFilterContextMenu",y.a,[]);var wb=a(725),Tb=a(83),xb=a(187),cb=a(65),jb=a(19);class qa{}qa.qXe=26;qa.Acd=[228,229,0,99,0,95,94];Object(c.a)(qa,"Constants",null,[]);class za{constructor(pb,Rb,oc,Jc){this.lzg=pb;this.Utg=Rb;this.Ytg=oc;this.wDg=Jc}get Noi(){return 3===this.B6b}get Jsi(){return 4===
this.B6b&&!!this.subMenu}get subMenu(){return this.wDg}get jvf(){return this.lzg}get B6b(){return this.Utg}get l7c(){return this.Ytg}}Object(c.a)(za,"FiltersMenuData",null,[]);class Na extends za{constructor(pb,Rb){super(pb,2,0,null);this.bxe=Rb}}Object(c.a)(Na,"AutoFilterFiltersMenuData",za,[]);class ua{}ua.mOj=[new za(100,2,0,null),new za(101,2,1,null),new za(0,3,0,null),new za(170,2,2,null),new za(172,2,4,null),new za(0,3,0,null),new za(174,2,6,null),new za(175,2,7,null),new za(0,3,0,null),new za(108,
0,0,null)];ua.aKi=[new za(100,2,0,null),new za(101,2,1,null),new za(0,3,0,null),new za(102,2,8,null),new za(103,2,10,null),new za(104,2,12,null),new za(0,3,0,null),new za(105,1,0,null),new Na(106,1),new Na(107,2),new za(0,3,0,null),new za(108,0,0,null)];ua.cih=[new za(100,2,0,null),new za(0,3,0,null),new za(112,2,10,null),new za(113,2,8,null),new za(104,2,12,null),new za(0,3,0,null),new Na(110,8),new Na(109,9),new Na(111,10),new za(0,3,0,null),new Na(115,11),new Na(114,12),new Na(116,13),new za(0,
3,0,null),new Na(117,14),new Na(118,15),new Na(119,16),new za(0,3,0,null),new Na(120,17),new Na(121,18),new Na(122,19),new za(0,3,0,null),new Na(123,20),new Na(124,21),new Na(125,22),new za(0,3,0,null),new Na(126,23),new za(127,2,12,[new Na(128,24),new Na(129,25),new Na(130,26),new Na(131,27),new za(0,3,0,null),new Na(132,28),new Na(133,29),new Na(134,30),new Na(135,31),new Na(136,32),new Na(137,33),new Na(138,34),new Na(139,35),new Na(140,36),new Na(141,37),new Na(142,38),new Na(143,39)]),new za(0,
3,0,null),new za(108,0,0,null)];Object(c.a)(ua,"Constants",null,[]);var Xa=a(909),ha=a(79);class ta extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,ta.rEh,!0,!1,ta.mLb,Rb,oc,!1,Jc);this.tm=null}get Yw(){return"PopulateAutoFilterFieldListContextMenu"}get QB(){return t.a.TQf}executeCommand(pb,Rb,oc){pb=Rb.command;switch(pb){case -699941697:this.applyAutoFilterFieldList(Rb,oc);break;case 216058793:break;case -1494291901:break;default:return ja.a(pb)}return $a.Task.Ta(!0)}Ffd(pb,
Rb){return!pb||pb.length<=Rb?(d.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(pb[Rb],10)}wId(pb,Rb,oc,Jc,ud,Fb){const pa=this.Ffd(ud,Fb);0>pa&&d.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(qa.Acd[pa]){case 99:pb=new M.a(-2058042992,Rb.method,Rb.mode,Rb.af,Rb.tabName);this.tm.lH.ivb(this.$,Jc,0,pb);break;case 228:pb=new M.a(504133448,Rb.method,Rb.mode,Rb.af,Rb.tabName);
this.tm.lH.ivb(this.$,Jc,0,pb);break;case 229:pb=new M.a(-798968736,Rb.method,Rb.mode,Rb.af,Rb.tabName);this.tm.lH.ivb(this.$,Jc,0,pb);break;case 233:pb=new M.a(-1677817820,Rb.method,Rb.mode,Rb.af,Rb.tabName);this.tm.lH.ivb(this.$,Jc,0,pb);break;case 95:this.$Of(pb,Rb,Jc,oc,ud,Fb+1);break;case 94:this.tm.lH.Gwi(this.$,Jc)}}$Of(pb,Rb,oc,Jc,ud,Fb){const pa=this.Ffd(ud,Fb);0>pa&&d.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Jc||pa>=
Jc.length)d.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(Jc=Jc[pa],Jc.B6b){case 1:this.tm.lH.Zwi(this.$,oc);break;case 2:(ud=Object(Tb.a)(Na,Jc))?(pb=new M.a(-2058042992,Rb.method,Rb.mode,Rb.af,Rb.tabName),this.tm.lH.ivb(this.$,oc,ud.bxe,pb)):this.tm.lH.upf(this.$,pb,oc,Jc.l7c);break;case 0:this.tm.lH.upf(this.$,pb,oc,Jc.l7c);break;case 4:this.$Of(pb,Rb,oc,Jc.subMenu,ud,Fb+1)}}applyAutoFilterFieldList(pb,Rb){var oc=Rb[wb.a.vG];
if(oc)if(oc=oc.split(cb.a.LU),3>oc.length)d.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var Jc=this.Ffd(oc,1),ud=this.eLa(Jc),Fb=this.evf(Jc).returnValue;Fb?this.wId(Rb,pb,Fb,ud,oc,2):d.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+Jc.toString()+cb.a.LU)}else d.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}wc(pb,
Rb){if(pb=this.$.isEditMode)switch(Rb.command){case 216058793:break;case -699941697:break;case -1494291901:pb=!0;break;default:pb=!1}return pb}a1(pb,Rb,oc){this.$.isEditMode&&((this.tm=Object(Tb.a)(246,oc))||d.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.kZ(),super.a1(pb,Rb,null,null,!0))}G5c(){if(!this.tm||!this.tm.$k||1!==this.tm.$k.length)return d.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;const pb=this.tm.$k[0];let Rb=new xb.a;Rb.add(X.a.instance.ga(249));Rb=ha.OBc(ha.concat(Rb,ha.select(ha.asEnumerable(pb.FieldInfoDataList),oc=>oc.Name)),oc=>oc,new Xa.a);return ha.toArray(Rb)}fieldIndex(pb){if(!this.tm||!this.tm.$k||1!==this.tm.$k.length||!this.tm.$k[0].FieldInfoDataList)return-1;for(let Rb=0;Rb<this.tm.$k[0].FieldInfoDataList.length;++Rb)if(this.tm.$k[0].FieldInfoDataList[Rb].Name===pb)return Rb;return-1}eLa(pb){return 0>pb||!this.tm||!this.tm.$k||1!==this.tm.$k.length||!this.tm.$k[0].FieldInfoDataList||
this.tm.$k[0].FieldInfoDataList.length<pb?null:this.tm.$k[0].FieldInfoDataList[pb].Name}kZ(){var pb=this.G5c();if(!pb||!pb.length)return null;const Rb=this.Va,oc=Rb.Ec();for(let pa=0;pa<pb.length;++pa){const tb=pb[pa],Nb=0<pa?this.fieldIndex(tb):-1,vc=ta.H$f+Nb.toString()+cb.a.LU;let Ic=null;const kd=this.tm.lH.b$h(0<pa?tb:null),xd=this.R5c(Rb,kd,ta.H$f+Nb.toString(),tb);for(let ae=0;ae<qa.Acd.length;++ae){var Jc=qa.Acd[ae],ud=vc+ae.toString();Ic||(Ic=Rb.Ec());switch(Jc){case 228:Ic.buttons.push(Rb.Nc(223,
ud,-699941697,this.tm.lH.tsi(0<pa?tb:null)?jb.a.s$b:jb.a.XJa,8,228,!1,null));break;case 229:Ic.buttons.push(Rb.Nc(224,ud,-699941697,this.tm.lH.usi(0<pa?tb:null)?jb.a.t$b:jb.a.YJa,8,229,!1,null));break;case 233:Ic.buttons.push(Rb.Nc(225,ud,-699941697,jb.a.q$b,1,233,!1,null));break;case 99:Jc=this.LXg(tb);ud=Rb.EIa(ud+(kd?".enabled":".disabled"),Jc,-699941697,null,"None",null,!kd,void 0,!0);ud.rS("Image16by16",8,jb.a.s3a);Ic.buttons.push(ud);break;case 95:var Fb=void 0;const oe=({zXe:Fb,isChecked:Jc}=
this.evf(Nb)).returnValue;if(!oe)return null;Fb=this.R5c(Rb,Jc&&kd,ud,Fb);ud=this.C_e(Fb.menu,Rb,ud+cb.a.LU,oe,Jc&&kd);Fb.menu.tc.push(ud);Ic.buttons.push(Fb);break;case 0:Ic&&(xd.menu.tc.push(Ic),Ic=null);break;default:ud=Rb.EIa(ud,X.a.instance.ga(Jc),-699941697,null,"None",null,!1,void 0,!0),this.$2f(ud,kd&&94===Jc&&this.tm.lH.filter(),X.a.instance.ga(Jc)),Ic.buttons.push(ud)}}xd.menu.tc.push(Ic);oc.buttons.push(xd)}pb=Rb.fq(this.menuId);pb.tc.push(oc);return pb}C_e(pb,Rb,oc,Jc,ud){let Fb=null;
for(let Ic=0;Ic<Jc.length;++Ic){var pa=Jc[Ic],tb=oc+Ic.toString(),Nb=!1;switch(pa.B6b){case 1:Nb=ud&&this.tm.lH.Wh.IsTop10;break;case 2:Nb=Object(Tb.a)(Na,pa);Nb=ud&&this.tm.lH.rli(Nb?Nb.bxe:0,pa.l7c);break;case 0:Nb=ud&&this.tm.lH.Wh.IsCustomSupportedAndNotPresent}Fb||(Fb=Rb.Ec());if(pa.Noi)Fb&&(pb.tc.push(Fb),Fb=null);else if(pa.Jsi){var vc=X.a.instance.ga(pa.jvf);vc=this.R5c(Rb,Nb,tb,vc);vc.menu.tc.push(this.C_e(vc.menu,Rb,tb+cb.a.LU,pa.subMenu,Nb));Fb.buttons.push(vc)}else pa=X.a.instance.ga(pa.jvf),
tb=Rb.EIa(tb,pa,-699941697,null,"None",null,!1,void 0,!0),this.$2f(tb,Nb,pa),Fb.buttons.push(tb)}return Fb}$2f(pb,Rb,oc){Rb?pb.rS("Image16by16",8,jb.a.Wua):pb.rS("None",0,null);pb.pS(oc);pb.label=oc}R5c(pb,Rb,oc,Jc){return Rb?pb.H5c(oc,this.menuId,Jc,798637440,8,jb.a.Wua):pb.tw(oc,this.menuId,Jc,798637440)}rh(pb){return!pb||!pb.length}evf(pb){var Rb=0>pb?0:this.tm.$k[0].FieldInfoDataList[pb].MajorityDataTypeForField;var oc=null;pb=this.tm.lH.a$h(Rb);switch(Rb){case 0:oc=96;Rb=ua.mOj;break;case 1:oc=
95;Rb=ua.aKi;break;case 2:oc=97;Rb=ua.cih;break;default:return d.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,zXe:oc,isChecked:pb}}oc=X.a.instance.ga(oc);return{returnValue:Rb,zXe:oc,isChecked:pb}}LXg(pb){return!pb||this.rh(pb.trim())?X.a.instance.ga(98):pb.length>qa.qXe?String.format(X.a.instance.mb(155),pb.substring(0,qa.qXe)):String.format(X.a.instance.mb(156),pb)}}ta.rEh=t.a.w8g;ta.mLb="AutoFilterFieldListContextMenuRoot";
ta.H$f="ApplyAutoFilterFieldList.";Object(c.a)(ta,"AutoFilterFieldListContextMenu",y.a,[]);var wa=a(549),db=a(838),Jb=a(11),Pb=a(122),eb=a(375),Ma=a(775);class ob extends y.a{constructor(pb,Rb,oc,Jc,ud="PopulateFloatingObjectContextMenu",Fb=-2017893763,pa=1350204367,tb=t.a.D8g,Nb=!0,vc=!1){super(pb,ud,Fb,pa,tb,Nb,vc,tb,Rb,oc,!0,Jc);this.floatingObject=null;this.tb=0;this.Xmc=!0}get Yw(){return"PopulateFloatingObjectContextMenu"}get QB(){return t.a.aRf}executeCommand(pb,Rb,oc){pb=Object(Tb.a)(wa.a,
oc.eventArgs);switch(Rb.command){case -1372040782:oc=N.h(this.$).ha.Sa.$b;d.ULS.shipAssertTag(537167048,0,!!oc);oc&&(this.floatingObject=oc.floatingObject,this.tb=Rb.method,Rb=this.lcc(pb),this.Sp(Rb,!0,pb.tb));break;case 848910589:pb&&(Rb=[db.a.n6f],pb=new Sys.UI.Point(pb.Ca.clientX,pb.Ca.clientY),this.showFloatie(Rb,new Sys.UI.Bounds(pb.x,pb.y,0,0),2))}return $a.Task.Ta(!0)}wc(pb,Rb,oc){switch(Rb.command){case -1372040782:return!!oc&&this.rmf(pb);case 848910589:return pb=N.h(this.$).ha.Sa.$b,!!oc&&
!!pb&&pb.eb;default:return!1}}rmf(pb){switch(pb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}nWc(pb,Rb,oc){eb.a(this.$)?N.h(this.$).ib.tj||(da.a(this.$).JUd()?oc.buttons.push(pb.pb(265)):oc.buttons.push(pb.pb(264))):(this.$.isEditMode&&3===this.tb&&!this.Pac()&&oc.buttons.push(pb.pb(101)),5!==this.floatingObject.type||Pb.a.XH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.$sd()?oc.buttons.push(pb.pb(186)):oc.buttons.push(pb.pb(147))),this.Pac()||this.$sd()||oc.buttons.push(pb.pb(146)),
S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.pKh(oc),this.PLh(oc)),S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&oc.buttons.push(pb.pb(287)),S.EwaSettings.ma(163)&&0===this.floatingObject.type&&oc.buttons.push(pb.pb(249)),5===this.floatingObject.type&&N.h(this.$).ha.Sa.$b.L5()&&this.$.Uba&&this.$.Z2&&oc.buttons.push(pb.pb(273)))}hLa(pb){const Rb=[];if(eb.a(this.$))return Rb;3===pb?(pb=!!this.$.ie.get(5)&&
this.floatingObject.$Xd(),this.Pac()||(this.$.isEditMode?(pb&&Rb.push(db.a.tHh),5===N.h(this.$).ha.Sa.cB.floatingObject.type&&Rb.push(db.a.vAj)):pb&&Rb.push(db.a.copy)),Rb.push(db.a.uHh)):2===pb&&(S.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?N.h(this.$).ha.Sa.$b&&this.H4e(N.h(this.$).ha.Sa.$b,Rb):this.H4e(N.h(this.$).ha.Sa.cB,Rb));return Rb}kZ(){const pb=this.Va,Rb=pb.fq(this.menuId);var oc=eb.a(this.$);if(this.$.isEditMode){var Jc=pb.Ec();this.nWc(pb,
Rb,Jc);Rb.tc.push(Jc)}this.$.ie.get(5)&&this.floatingObject.$Xd()&&!this.Pac()&&!oc&&(Jc=pb.Ec(),this.rHg(pb,Jc),Rb.tc.push(Jc));(Jc=this.$.xa.oa)&&Jc.Gd&&(Jc=Jc.Gd.Hv||Jc.Gd.fI,!S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||!Ma.g(this.$)||this.$.ea.isNamedObjectViewMode||oc||this.$.isMobileMode||Jc||(oc=pb.Ec(),this.oJg(pb,oc),Rb.tc.push(oc)));return Rb}lcc(pb){var Rb=N.h(this.$).ha.Sa.$b;pb=pb&&1!==pb.tb&&pb.clientPoint?pb.clientPoint:
Sys.UI.DomElement.getLocation(Rb.domElement);const oc=this.$.domElement,Jc=N.h(this.$).rtl;(Rb=Jb.HelperMethods.sD(Rb.pg.domElement,oc,Jc))?(pb.y=Math.max(pb.y,Rb.y),pb.x=Math.max(pb.x,Rb.x)):d.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${n.AFrameworkApplication.Og}`);return pb}$sd(){const pb=N.h(this.$).ha.Sa.$b;return!!pb&&pb.eb}rHg(pb,Rb){if(this.$.isEditMode){Rb.buttons.push(pb.pb(42));
Rb.buttons.push(pb.pb(43));const oc=this.$.da.Aa(254,!0);(oc&&2===oc.ZCb()||this.$sd())&&Rb.buttons.push(pb.pb(44))}else Rb.buttons.push(pb.pb(43))}oJg(pb,Rb){Rb.buttons.push(pb.pb(274))}Pac(){return S.EwaSettings.ma(459)&&!!N.h(this.$).ha.Sa.mo}H4e(pb,Rb){5===pb.floatingObject.type?pb.eb?Rb.push(db.a.n6f):Rb.push(db.a.rAj):Rb.push(y.a.BYe)}pKh(pb){const Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(282));Rb.buttons.push(this.Va.pb(281));const oc=this.Va.tw("BringToFront","BringToFrontMenuId",X.a.instance.ga(822),
-1777747317);oc.menu.tc.push(Rb);pb.buttons.push(oc)}PLh(pb){const Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(284));Rb.buttons.push(this.Va.pb(283));const oc=this.Va.tw("SendToBack","SendToBackMenuId",X.a.instance.ga(823),-1777747317);oc.menu.tc.push(Rb);pb.buttons.push(oc)}}Object(c.a)(ob,"FloatingObjectContextMenu",y.a,[]);var Ia=a(789),Da=a(102),nb=a(556),Ua=a(518);const W=t.a.z8g;class sa extends ob{constructor(pb,Rb,oc,Jc){super(pb,Rb,oc,Jc,"PopulateChartContextMenu",-498523270,1640762262,W);
this.isPivotChart=this.refresh=this.GZ=this.Iwa=this.yBa=!1}get Yw(){return"PopulateChartContextMenu"}get QB(){return t.a.VQf}executeCommand(pb,Rb,oc){const Jc=this.$;this.tb=Rb.method;Rb=oc[sa.V1c];if(!(pb&68)){if(!Rb){if(8===pb)Rb=Ua.a(Jc).Vc;else{var ud=N.h(Jc).ha.Sa.$b;if(null===ud||void 0===ud?0:ud.floatingObject)Rb=ud.floatingObject.Vc}if(!Rb)return $a.Task.Ta(!0)}this.isPivotChart=!!(Rb.Attributes&4)}if(this.isPivotChart||Jc.isEditMode)if(this.refresh=this.GZ=this.Iwa=this.yBa=!1,ud=N.h(this.$).ha.Sa.$b,
d.ULS.shipAssertTag(537167107,0,!!ud),ud){this.floatingObject=ud.floatingObject;ud=nb.a(Jc);if(null===ud||void 0===ud?0:ud.eUd)this.yBa=ud=Da.f(Jc.lg),this.Iwa=!ud;ud=Jc.dc;this.GZ=!!Ia.a(Jc)&&!!Rb&&!!(Rb.Attributes&512)&&!(pb&8)&&ud.Y2(32768);ud.allowManualDataRefresh&&ud.allowInteractivity&&(this.refresh=!0);pb=this.lcc(Object(Tb.a)(wa.a,oc.eventArgs));this.Sp(pb,!0)}return $a.Task.Ta(!0)}wc(pb,Rb,oc){return-149612405===Rb.command&&!!oc&&this.rmf(pb)}nWc(pb,Rb,oc){this.isPivotChart&&(this.refresh&&
oc.buttons.push(pb.pb(100)),this.GZ&&oc.buttons.push(pb.pb(99)),this.yBa?oc.buttons.push(pb.pb(59)):this.Iwa&&oc.buttons.push(pb.pb(58)));super.nWc(pb,Rb,oc)}static get V1c(){return"chartMetaData"}}Object(c.a)(sa,"ChartContextMenu",ob,[]);var vb=a(12);const gc=t.a.B8g;class Bc extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateFieldListContextMenu",-1045020714,-170383950,gc,!0,!1,gc,Rb,oc,!1,Jc);this.XL=this.Co=null;this.bYd=this.isOlap=this.NV=this.o_=!1}get Yw(){return"PopulateFieldListContextMenu"}get QB(){return t.a.IJd}executeCommand(pb,
Rb,oc){pb=Rb.command;switch(pb){case 330754562:Rb=oc.domElement;this.isOlap=oc.isOlap;this.XL=oc.versionkey;this.Co=oc.fieldItem;this.o_=oc.isChart;this.NV=oc.isPpm;this.bYd="supportsImplicitMeasures"in oc?oc.supportsImplicitMeasures:!1;N.h(this.$).To(!0);Rb=vb.DOMElementExtensions.getBounds(Rb);Rb=new Sys.UI.Point(Rb.x+Rb.width,Rb.y+Rb.height/2);"isKeyboardInput"in oc&&oc.isKeyboardInput?this.Sp(Rb,!1,1):this.Sp(Rb,!1);break;case 926905850:this.bYd&&this.Co&&5===this.Co.TypeTag&&!this.Co.IsCollapsible&&
d.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");nb.a(this.$).gK(this.Co,8,-1,this.XL,Rb);break;case -67292059:nb.a(this.$).gK(this.Co,1,-1,this.XL,Rb);break;case 745182485:nb.a(this.$).gK(this.Co,2,-1,this.XL,Rb);break;case 359279088:nb.a(this.$).gK(this.Co,4,-1,this.XL,Rb);break;case 547535945:nb.a(this.$).z$i(this.Co);break;default:return ja.a(pb)}return $a.Task.Ta(!0)}wc(pb,Rb,oc){pb=!1;switch(Rb.command){case 330754562:pb=!!oc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:pb=
!0}return pb}kZ(){const pb=this.Va.fq(this.menuId);this.T3i(pb);this.o_||this.isOlap||this.S3i(pb);return pb}T3i(pb){const Rb=this.Va,oc=Rb.Ec();let Jc=!1;S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Jc=this.isOlap&&!this.NV&&this.bYd&&5===this.Co.TypeTag&&!this.Co.IsCollapsible);3!==this.Co.TypeTag&&37!==this.Co.TypeTag||this.Co.IsSet?17===this.Co.TypeTag||this.NV?(oc.buttons.push(Rb.pb(79)),oc.buttons.push(Rb.pb(this.o_?91:80)),oc.buttons.push(Rb.pb(this.o_?
92:81)),oc.buttons.push(Rb.pb(82))):13===this.Co.TypeTag||this.Co.IsSet?(oc.buttons.push(Rb.pb(83)),oc.buttons.push(Rb.pb(this.o_?91:80)),oc.buttons.push(Rb.pb(this.o_?92:81)),oc.buttons.push(Rb.pb(86))):(oc.buttons.push(Rb.pb(79)),oc.buttons.push(Rb.pb(this.o_?91:80)),oc.buttons.push(Rb.pb(this.o_?92:81)),oc.buttons.push(Rb.pb(Jc?82:86))):(oc.buttons.push(Rb.pb(83)),oc.buttons.push(Rb.pb(this.o_?93:84)),oc.buttons.push(Rb.pb(this.o_?94:85)),oc.buttons.push(Rb.pb(82)));pb.tc.push(oc)}S3i(pb){const Rb=
this.Va.Ec();Rb.buttons.push(this.Va.pb(78));pb.tc.push(Rb)}}Object(c.a)(Bc,"FieldListContextMenu",y.a,[]);var Sa=a(419),na=a(66);class ib{constructor(pb){this.$=pb;this.SN={}}get(pb,Rb,oc){const Jc=this.Jfg(pb,"PivotFilterContextMenuCache.Get");return Jc&&this.SN[Jc]?this.SN[Jc][ib.Bhd(Rb,this.$,pb,oc)]:null}set(pb,Rb,oc,Jc){const ud=this.Jfg(pb,"PivotFilterContextMenuCache.Set");ud&&(this.SN[ud]||(this.SN[ud]={}),this.SN[ud][ib.Bhd(Rb,this.$,pb,Jc)]=oc)}c9b(pb){pb in this.SN&&this.SN[pb]&&(this.SN[pb]=
null)}Jfg(pb,Rb){return na.f(this.$.oa)?this.$.activeItemName:(pb=this.ZSj(pb,Rb))?pb.Ad:null}ZSj(pb,Rb){pb=E.C(pb);pb=N.h(this.$).Da.Vva(pb,this.$.activeItemName);d.ULS.shipAssertTag(537167008,0,!!pb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${Rb}`);return pb}static Bhd(pb,Rb,oc,Jc){return S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Jc?Rb.oa.index+"_"+pb.id+
"_"+oc.FirstRow.toString()+"_"+oc.FirstColumn.toString():Rb.oa.index+"_"+pb.id}}Object(c.a)(ib,"PivotFilterContextMenuCache",null,[]);class Ib{constructor(){this.cell=null;this.dataSourceIndex=0;this.Oo=this.pivotName=null}}Object(c.a)(Ib,"ShowPivotFilterData",null,[]);var ec=a(461),qb=a(1294),Ha=a(52);const Ab=t.a.eGe;class Yb extends y.a{constructor(pb,Rb,oc,Jc,ud,Fb,pa,tb=Ab){super(pb,Rb,oc,Jc,tb,!0,!1,"PivotFilterMenuRootName",ud,Fb,!1,pa);this.moc=this.TBd=this.pivotData=this.ynb=this.Bof=this.M6b=
null;this.MY=this.P3b=this.DFb=0;this.btb=null;this.cRi=(Nb,vc)=>{if(vc)if(P.a(Nb))this.Lyd(vc,!1);else if(Nb=Nb.Result){this.Wtb=ib.Bhd(vc,this.$,this.pivotData.cell,this.MY);var Ic=this.fvf(Nb.MenuModel.Sections);this.btb=Ic;Yb.SN.set(this.pivotData.cell,vc,Ic,this.MY);qb.a(this.$).HLj(Nb);this.Lyd(vc,!0)}};this.bRi=(Nb,vc)=>{this.Lyd(vc,!1)};this.tf=(Nb,vc)=>{Yb.SN.c9b(vc.Yc.hash)};this.$m=(Nb,vc)=>{Yb.SN.c9b(vc.Yc.hash)};this.jAa=null;this.SBe=this.P3b=this.UBd=this.DFb=-1;this.Jte=this.MY=0;
this.Dz=S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Yb.SN||(Yb.SN=new ib(this.$),N.h(this.$).Da.nt(this.tf),N.h(this.$).Da.gH(this.$m),N.h(this.$).Da.Z9(this.tf))}Gbd(pb,Rb){const oc=pb.rawEvent,Jc=pb.cell,ud=pb.requiresConfirmation;ec.a(this.$).Px(ud,Fb=>{if(Fb){Fb=oc?new Sys.UI.DomEvent(oc):null;this.pivotData=new Ib;this.pivotData.pivotName=pb.pivotName;this.pivotData.dataSourceIndex=pb.dataSourceIndex;this.pivotData.cell=Jc;this.pivotData.Oo=pb.optionalPivotMenuAnchorParameter;
if(this.pivotData.Oo&&0<this.pivotData.Oo.AnchorType){this.moc=pb.objectId;this.DFb=pb.objectVersion;const pa=this.pivotData.Oo.AnchorType;if(4===pa||5===pa||6===pa||11===pa||9===pa||10===pa||8===pa)this.ynb=pb.location}else this.TBd=this.moc=null,this.UBd=this.DFb=-1;N.h(this.$).To(!0);this.$.pk(Jc);this.a1(Fb,Fb?Fb.target:pb.domElement,this.pivotData,Rb,this.hNa())}});return!0}a1(pb,Rb,oc,Jc){if(Object(Sa.a)(Ib,oc)){this.pivotData=oc;this.M6b=Rb;this.Bof=pb;this.P3b=this.pivotData.Oo?this.pivotData.Oo.AnchorValue1:
-1;this.MY=this.pivotData.Oo?this.pivotData.Oo.AnchorType:0;var ud=!1,Fb=null;Fb=Yb.SN.get(this.pivotData.cell,Rb,this.MY);ud=!!Fb;var pa=!0;switch(this.MY){case 4:case 5:case 6:this.jAa=new Sys.UI.Point(this.ynb.x,this.ynb.y);pa=!1;break;case 7:var tb=Sys.UI.DomElement.getBounds(Rb);pa=tb.x+(0<=tb.x?0:tb.width);tb=tb.y+(0<=tb.y?0:tb.height);this.jAa=new Sys.UI.Point(0<=pa?pa:0,0<=tb?tb:0);pa=!1;break;case 8:case 10:case 9:case 11:this.jAa=new Sys.UI.Point(this.ynb.x,this.ynb.y);break;default:this.jAa=
null}ud&&this.moc===this.TBd&&this.DFb===this.UBd&&this.P3b===this.SBe&&this.MY===this.Jte?(d.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.btb=Fb,this.jAa?this.Sp(this.jAa,this.hNa()):this.Dz?y.a.Vpd(this.$,this.pivotData.cell)&&this.Sp(y.a.Ofd(this.$,this.pivotData.cell,!1),this.hNa()):super.a1(pb,Rb,oc,Jc,this.hNa())):1!==Yb.nTh(Rb)&&(pa&&(Rb.parentNode.menuFetchStates=1,this.Uuj(Rb),this.J2f(!0)),this.$.userOperationManager.Ic(new I.a(126,
0,(Nb,vc,Ic)=>{const kd=this.$;return L.p(kd.pa.ya,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,kd.domElement.id,kd.isChromeRtl,kd.workbookContext.NovMode,va.b(Nb,this.cRi),va.a(vc,this.bRi),Ic,Rb,this.pivotData.Oo)},16),Jc))}}TGd(pb){pb.MenuSectionList.push(...this.btb)}Lyd(pb,Rb){pb.parentNode.menuFetchStates=2;this.J2f(!1);if(Rb){if(this.M6b!==pb||this.EFi())this.Sp(this.jAa,this.hNa());else if(this.Dz&&!this.jAa){if(!y.a.Vpd(this.$,this.pivotData.cell))return;this.Sp(y.a.Ofd(this.$,
this.pivotData.cell,!1),this.hNa())}else super.a1(this.Bof,pb,null,null,this.hNa());this.TBd=this.moc;this.UBd=this.DFb;this.Jte=this.MY;this.SBe=this.P3b}}hNa(){return 8!==this.MY&&9!==this.MY&&10!==this.MY&&11!==this.MY}EFi(){switch(this.pivotData.Oo?this.pivotData.Oo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}J2f(pb){const Rb=this.M6b;if(Rb){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var oc=vb.DOMElementExtensions.QZ(Rb,
"ewaprevsrc","");oc=!!oc&&"null"!==oc}else oc=!!vb.DOMElementExtensions.QZ(Rb,"ewaprevsrc","");pb&&oc||!pb&&!oc||(pb?(Rb.setAttribute("ewaprevsrc",Rb.src),Rb.src=Ha.a.current.fo(99)):(pb=vb.DOMElementExtensions.QZ(Rb,"ewaprevsrc",""),Rb.src=pb,Rb.setAttribute("ewaprevsrc",null)))}}Uuj(pb){this.M6b=pb}static nTh(pb){const Rb=pb.parentNode.menuFetchStates;void 0===Rb&&(pb.parentNode.menuFetchStates=0);return Rb}}Yb.SN=null;Object(c.a)(Yb,"PivotFilterContextMenuBase",y.a,[]);const Bb="FieldList"+t.a.eGe;
class Qb extends Yb{constructor(pb,Rb,oc,Jc){super(pb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Rb,oc,Jc,Bb)}get Yw(){return"PopulateFieldListPivotMenu"}get QB(){return t.a.ZQf}executeCommand(pb,Rb,oc){return this.Gbd(oc,Rb)?$a.Task.Ta(!0):ja.a(Rb.command)}wc(pb,Rb,oc){return-1065117584===Rb.command&&!!oc}}Object(c.a)(Qb,"FieldListPivotContextMenu",Yb,[]);var sc=a(263),kb=a(30),Eb=a(89),Gc=a(754);class zc{}Object(c.a)(zc,"PivotValueFieldSettingsApplyData",null,[]);class yb{}yb.clg="valueFieldSettingTabs";
yb.Ihh="dataFieldCustomLabel";yb.iKe="dataFieldSourceLabel";yb.VVd="showValueAsSelect";yb.TVd="showValueAsBaseFieldSelect";yb.UVd="showValueAsBaseItemSelect";yb.p2d="valueFieldsSettingsFieldName";Object(c.a)(yb,"CssElementIds",null,[]);var gb=a(86);class Kb{constructor(pb,Rb,oc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=pb;this.baseFieldIndex=Rb;this.baseItemIndex=oc}}Object(c.a)(Kb,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class sd{constructor(pb,Rb,oc,
Jc,ud){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=pb;this.activeCell=Rb;this.pivotFieldTitle=oc;this.summarizeBy=Jc;this.showAsValueParameters=ud}getActiveCell(){return this.activeCell}}Object(c.a)(sd,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[108]);var Sb=a(238);class yc{}Object(c.a)(yc,"PivotValueFieldShowValueAsApplyData",null,[]);var Fc=a(737),Zc=a(44);const Rd=`<div id='showValueAsControlBody'><label for='${yb.VVd}' class='${gb.a.Um} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${yb.VVd}' class='${gb.a.zz}'></select></div><div class='showValueAsControlSelectRegion'><label for='${yb.TVd}'>{1}</label><div><select size=6 id='${yb.TVd}' class='${gb.a.zz}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${yb.UVd}'>{2}</label><div><select size=6 id='${yb.UVd}' class='${gb.a.zz}'></select></div></div></div>`;
class Ed extends Sb.a{constructor(pb,Rb,oc,Jc,ud,Fb,pa,tb,Nb){super(pb);this.htmlSanitizationHelper=this.l8d=this.V5d=this.U5d=this.e2b=this.q7b=this.ED=null;this.iBf=()=>{var vc=parseInt(this.X3.ee.value,10);this.$_g(vc)?(this.UP.Qp.disabled=!0,this.VP.Qp.disabled=!0,this.VP.clear(),Ed.Ggf(vc)?(this.UP.Qp.disabled=!1,this.nQb(!S.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):Ed.Hgf(vc)?(this.UP.Qp.disabled=!1,this.VP.Qp.disabled=!1,this.nQb(!0),this.iqf()):this.nQb(!1)):
(vc=Z.a.$c(1,0,0,1127,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Zc.a(this.$).Rr([vc]),this.X3.Ymj())};this.LLi=()=>{0>this.UP.selectedIndex||this.VP.Qp.disabled||(this.nQb(!0),this.iqf())};this.YRi=vc=>{this.ED.$Ta();this.VP.Qp.style.overflowY="scroll";if(vc&&!P.a(vc)){vc=vc.Result;this.VP.clear();for(const Ic of vc.BaseItems)this.VP.GY(Ic.DisplayString,Ic.Id.toString(),Ic.Id===vc.SelectedBaseItem);this.nQb(!1)}};this.get_visible=this.nka;this.set_visible=this.eoa;this.$=Rb;this.cell=oc;this.Oo=
Jc;this.externalSourceIndex=ud;this.Wd=Fb;this.Ata=pa;this.lpi=tb;this.htmlSanitizationHelper=Nb;this.BYj=S.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Jka()}nka(){return this.isVisible}eoa(pb){return this.isVisible=pb}get title(){return X.a.instance.ga(1115)}get Exb(){const pb=this.X3.ee?parseInt(this.X3.ee.value,10):-1,Rb=this.UP.ee?parseInt(this.UP.ee.value,10):-1,oc=this.VP.ee?parseInt(this.VP.ee.value,10):-1;return Object(f.a)(new yc,{SelectedDataFormat:0<=
pb?pb:-1,SelectedBaseField:Rb,SelectedBaseItem:oc})}get UP(){return this.U5d}get VP(){return this.V5d}get X3(){return this.l8d}setFocus(){vb.DOMElementExtensions.setFocus(this.X3.Qp)}render(pb){pb.appendChild(this.domElement)}dispose(){Eb.a.rc([this.X3,this.UP,this.VP,this.q7b,this.e2b]);super.dispose()}Exj(pb){Eb.a.rc([this.q7b,this.e2b]);this.X3.clear();for(const Rb of pb.DataFormatTypes)this.X3.GY(Ed.zRh(Rb),Rb.toString(),Rb===pb.SelectedDataFormat);this.q7b=this.Ce.$d(this.X3.domElement);this.q7b.la("change",
this.iBf);this.UP.clear();for(const Rb of pb.BaseFieldList)this.UP.GY(Rb.DisplayString,Rb.Id.toString(),Rb.Id===pb.SelectedBaseField);this.e2b=this.Ce.$d(S.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?this.UP.domElement:this.X3.domElement);this.e2b.la("change",this.LLi);this.ED=this.Ata.Wsb(this.VP.Qp.parentNode,1E3,null,"",736);S.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.ED.$Ta();this.iBf(null)}aR(pb){this.X3.aR(pb);
this.UP.aR(pb);this.VP.aR(pb)}Jka(){S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.Ri(this.domElement,String.format(Rd,X.a.instance.ga(1116),X.a.instance.ga(1117),X.a.instance.ga(1118))):this.domElement.innerHTML=String.format(Rd,X.a.instance.ga(1116),X.a.instance.ga(1117),X.a.instance.ga(1118));this.l8d=new Fc.a(vb.DOMElementExtensions.getElementById(this.domElement,
yb.VVd),!1);this.U5d=new Fc.a(vb.DOMElementExtensions.getElementById(this.domElement,yb.TVd),!1);this.V5d=new Fc.a(vb.DOMElementExtensions.getElementById(this.domElement,yb.UVd),!1)}$_g(pb){return this.lpi||!Ed.Ggf(pb)&&!Ed.Hgf(pb)?!0:!!this.UP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Ic(new I.a(108,0,(pb,Rb,oc)=>{var Jc=this.$.pa.ya,ud=parseInt(this.UP.ee.value,10);pb=va.b.call(null,pb,this.YRi);const Fb=L.L(Jc,this.cell,this.externalSourceIndex,this.Oo);
Fb.selectedBaseField=ud;return L.g(Jc,"GetPivotValueFieldSettingsShowValueAsBaseItems",Fb,pb,Rb,oc,null,4)},16),this.Wd)}iqf(){this.VP.clear();this.UP.ee&&(this.ED.UTa(),this.VP.Qp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}nQb(pb){const Rb=document.getElementById("WACDialogActionButton");this.BYj&&Rb&&(Rb.disabled=pb)}static zRh(pb){switch(pb){case 0:return X.a.instance.ga(1119);case 1:return X.a.instance.ga(1120);case 2:return X.a.instance.ga(1121);case 3:return X.a.instance.ga(1122);
case 4:return X.a.instance.ga(1123);case 5:return X.a.instance.ga(1124);case 6:return X.a.instance.ga(1125);case 7:return X.a.instance.ga(1126);case 8:return X.a.instance.ga(1128);case 9:return X.a.instance.ga(1129);case 10:return X.a.instance.ga(1130);case 11:return X.a.instance.ga(1131);case 12:return X.a.instance.ga(1132);case 13:return X.a.instance.ga(1133);case 14:return X.a.instance.ga(1134);default:return""}}static Ggf(pb){return 11===pb||12===pb||14===pb||13===pb||4===pb}static Hgf(pb){return 1===
pb||3===pb||2===pb}}Object(c.a)(Ed,"ShowValueAsControl",Sb.a,[257,2]);class ne{}Object(c.a)(ne,"PivotValueFieldSummarizeValueByApplyData",null,[]);const ze="<div id='summarizeValuesByControlBody'>"+`<label class='${gb.a.Um} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${gb.a.Um} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${gb.a.zz}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${t.a.KJ}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class Be extends Sb.a{constructor(pb,Rb){super(pb);this.htmlSanitizationHelper=this.whe=null;this.get_visible=this.nka;this.set_visible=this.eoa;this.htmlSanitizationHelper=Rb;this.Jka()}get Exb(){const pb=this.tl.ee?parseInt(this.tl.ee.value,10):-1;return Object(f.a)(new ne,{Aggregation:0<=pb?pb:-1})}nka(){return this.isVisible}eoa(pb){return this.isVisible=pb}get title(){return X.a.instance.ga(1114)}get enabled(){return!this.tl.Qp.disabled}set enabled(pb){this.tl.Qp.disabled=!pb}get tl(){return this.whe}setFocus(){vb.DOMElementExtensions.setFocus(this.tl.Qp)}render(pb){pb.appendChild(this.domElement)}dispose(){Eb.a.Ia(this.tl);
super.dispose()}focus(){vb.DOMElementExtensions.setFocus(this.tl.Qp)}Dxj(pb){this.tl.SWd();for(const Rb of pb.AggregationTypes){const oc=Rb===pb.SelectedAggregation;this.tl.lWc(Be.aNh(Rb),Rb.toString(),oc,"")}this.tl.k$c();this.tl.Qp.disabled=pb.AggregationsDisabled}Umj(){this.tl.Vmj()}Jka(){S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.Ri(this.domElement,
String.format(ze,X.a.instance.ga(1099),X.a.instance.ga(1100))):this.domElement.innerHTML=String.format(ze,X.a.instance.ga(1099),X.a.instance.ga(1100));this.whe=new Fc.a(vb.DOMElementExtensions.getElementById(this.domElement,Be.hMf),!1)}static aNh(pb){switch(pb){case 0:return X.a.instance.ga(1102);case 1:return X.a.instance.ga(1103);case 2:return X.a.instance.ga(1104);case 3:return X.a.instance.ga(1105);case 4:return X.a.instance.ga(1106);case 5:return X.a.instance.ga(1107);case 6:return X.a.instance.ga(1108);
case 7:return X.a.instance.ga(1109);case 8:return X.a.instance.ga(1110);case 9:return X.a.instance.ga(1111);case 10:return X.a.instance.ga(1112);case 11:return X.a.instance.ga(1113);default:return""}}}Be.hMf="pivotDataFieldSelect";Object(c.a)(Be,"SummarizeValuesByControl",Sb.a,[257,2]);var td=a(211),Se=a(469),$b=a(1238);class Xc extends Gc.a{constructor(pb,Rb,oc,Jc,ud,Fb,pa,tb,Nb,vc){super(ud,X.a.instance.mb(61),!0,2,!0);this.h8f=!0;this.htmlSanitizationHelper=this.STc=this.p7b=this.rtb=this.dga=
this.DTa=this.$me=null;this.yLi=Ic=>{sc.a.any(Ic.Errors,kd=>-103190598===kd.MessageId)&&this.hUa.Umj()};this.XRi=Ic=>{Ic&&!P.a(Ic)&&(Ic=Ic.Result,S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.E3f(this.p7b,X.a.instance.ga(1097)+kb.a.Hg(Ic.ValueFieldSourceName)):this.p7b.innerHTML=X.a.instance.ga(1097)+kb.a.Hg(Ic.ValueFieldSourceName),this.isOlap&&
!this.NV?(this.hUa.enabled=!1,this.dga.activeTab=this.dga.xBc-1):(this.hUa.enabled=!0,this.dga.activeTab=0),this.hUa.Dxj(Ic.PivotValueFieldSettingsSummarizeValueByInfo),this.DTa.Exj(Ic.PivotValueFieldShowValueAsInitialInfo),this.xg())};this.cell=pb;this.Oo=Rb;this.externalSourceIndex=oc;this.blg=Jc;this.Wd=Fb;this.Ata=pa;this.isOlap=tb;this.NV=Nb;this.htmlSanitizationHelper=vc}get qc(){return"ValueFieldSettingsDialog"}get LCa(){return this.$me}get ZEb(){return this.dga}get hUa(){return this.STc}get eC(){return 560}dispose(){this.p7b=
this.rtb=this.DTa=this.STc=null;Eb.a.Ia(this.dga);this.dga=null;super.dispose()}initialize(){let pb="<div id='"+yb.iKe+"' class='"+gb.a.Um+"'></div><div id='"+yb.Ihh+"' class='"+gb.a.Um+"'><label for='"+yb.p2d+"'>{0}</label><input type='text' id='"+yb.p2d+"' value='{1}' class='"+gb.a.zz+" UIFont' /></div><div id='"+yb.clg+"'></div>";pb=String.format(pb,X.a.instance.ga(1098),kb.a.Hg(this.blg));S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
this.htmlSanitizationHelper.Ri(this.Ib,pb):this.Ib.innerHTML=pb;this.Qf||(this.jsa(),this.Pt());this.$me=[-103190598];this.K4h();super.initialize()}close(pb){1===pb&&(this.h8f=!1);super.close(pb)}kMe(pb){this.isDisabled=pb;this.domElement.disabled=pb;const Rb=["input","option","select"];for(let oc=0,Jc=Rb.length;oc<Jc;++oc){const ud=this.domElement.getElementsByTagName(Rb[oc]);for(let Fb=0;Fb<ud.length;++Fb)ud[Fb].disabled=pb}}Pt(){this.rtb=document.getElementById(yb.p2d);this.p7b=vb.DOMElementExtensions.getElementById(this.Ib,
yb.iKe);const pb=vb.DOMElementExtensions.getElementById(this.Ib,yb.clg);this.STc=new Be(document.createElement("div"),this.htmlSanitizationHelper);this.DTa=new Ed(document.createElement("div"),this.$,this.cell,this.Oo,this.externalSourceIndex,this.Wd,this.Ata,!this.isOlap,this.htmlSanitizationHelper);let Rb;this.dga=new $b.a(pb,(Rb=new xb.a,Rb.add(this.hUa),Rb.add(this.DTa),Rb));this.dga.sWf()}dHd(){const pb=new Xc(this.cell,this.Oo,this.externalSourceIndex,this.blg,this.$,this.Wd,this.Ata,this.isOlap,
this.NV,this.htmlSanitizationHelper);pb.initialize();pb.xg()}hRb(){const pb=new Se.a;if(!this.h8f)return pb.isValid=!0,pb;this.rtb.value.length?pb.isValid=!0:(this.kMe(!0),pb.error=Z.a.$c(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.isDisabled=!0,this.Qf||(this.oz.disabled=!0),pb.isValid=!1);return pb}$9e(){this.isDisabled=!1;this.Qf||(this.oz.disabled=!1);this.kMe(!1)}eza(pb){const Rb=new M.a(2105621672,0,this.$.Hc,30,null);this.$.Ja.Lb(Rb);this.VW(5,pb.tb,"Number Format");return!0}uq(){this.Ooa=
String.format(X.a.instance.mb(61),null);super.uq()}setFocus(){if(this.Qf){const pb=vb.DOMElementExtensions.getElementById(this.Ib,Be.hMf);td.a.b0d(pb)}else this.dga.setFocus()}ik(){const pb=this.DTa.Exb,Rb=new Kb(pb.SelectedDataFormat,pb.SelectedBaseField,pb.SelectedBaseItem);return()=>new sd(this.externalSourceIndex,this.cell,this.rtb.value,this.hUa.Exb.Aggregation,Rb)}mH(){const pb=Object(f.a)(new zc,{PivotValueFieldSummarizeValueByApplyData:this.hUa.Exb,PivotValueFieldShowValueAsApplyData:this.DTa.Exb,
PivotValueFieldTitle:this.rtb.value});return(Rb,oc,Jc)=>{var ud=this.$.pa.ya;Rb=va.b(Rb,this.yLi);const Fb=L.L(ud,this.cell,this.externalSourceIndex,this.Oo);Fb.pivotValueFieldSettingsApplyData=pb;return L.g(ud,"ApplyPivotValueFieldSettings",Fb,Rb,oc,Jc,null,0)}}aR(pb){this.$.da.$a(40,()=>{this.DTa.aR(pb)})}K4h(){this.$.userOperationManager.Ic(new I.a(123,0,(pb,Rb,oc)=>{var Jc=this.$.pa.ya;pb=va.b.call(null,pb,this.XRi);const ud=L.L(Jc,this.cell,this.externalSourceIndex,this.Oo);return L.g(Jc,"GetPivotValueFieldSettingsInitial",
ud,pb,Rb,oc,null,4)},16),this.Wd)}}Object(c.a)(Xc,"ValueFieldSettingsDialog",Gc.a,[]);const ed=t.a.C8g;class Rc extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateFieldWellContextMenu",1374696078,495005930,ed,!0,!1,ed,Rb,oc,!1,Jc);this.Oo=this.Co=this.cell=null;this.A3d=this.externalSourceIndex=-1;this.PTa=0;this.yAc=-1;this.XL=null;this.H3a=this.NV=this.isOlap=!1}get Yw(){return"PopulateFieldWellContextMenu"}get QB(){return t.a.JJd}executeCommand(pb,Rb,oc,Jc){pb=Rb.command;switch(pb){case -1453503574:Jc=
oc.domElement;this.Co=oc.fieldItem;this.A3d=oc.zoneCount;this.PTa=oc.sourceAxis;this.yAc=oc.sourceAxisPos;this.Oo=oc.optionalPivotMenuAnchorParameter;this.XL=oc.versionkey;this.isOlap=oc.isOlap;this.NV=oc.isPpm;this.H3a="fieldItemsupportsImplicitMeasures"in oc?oc.fieldItemsupportsImplicitMeasures:!1;this.cell=oc.cell;this.externalSourceIndex=oc.externalSourceIndex;N.h(this.$).To(!0);Jc=vb.DOMElementExtensions.getBounds(Jc);pb=new Sys.UI.Point(Jc.x,Jc.y+Jc.height);this.$.isChromeRtl&&(pb.x+=Jc.width);
"isKeyboardInput"in oc&&oc.isKeyboardInput?this.Sp(pb,!1,1):this.Sp(pb,!1);break;case 495005930:break;case -1170196828:nb.a(this.$).gK(this.Co,this.PTa,this.yAc-1,this.XL,Rb);break;case -889576107:nb.a(this.$).gK(this.Co,this.PTa,this.yAc+2,this.XL,Rb);break;case 2033235475:nb.a(this.$).gK(this.Co,this.PTa,this.A3d,this.XL,Rb);break;case 389774337:nb.a(this.$).gK(this.Co,this.PTa,0,this.XL,Rb);break;case -96230454:nb.a(this.$).gK(this.Co,4,-1,this.XL,Rb);break;case 74086617:nb.a(this.$).gK(this.Co,
1,-1,this.XL,Rb);break;case 1529312473:nb.a(this.$).gK(this.Co,2,-1,this.XL,Rb);break;case 563292088:this.H3a&&d.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");nb.a(this.$).gK(this.Co,8,-1,this.XL,Rb);break;case -1092351914:nb.a(this.$).gK(this.Co,0,-1,this.XL,Rb);break;case -2141589616:const ud=V.GetServiceTaskFactory.Oa(this.$.da,12,477,Jc.L4()),Fb=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
V.GetServiceTaskFactory.Oa(this.$.da,498,499,Jc.L4()):$a.Task.Ta(null);return D.TaskExtensions.za(D.TaskExtensions.Ed([ud,Fb],this.$.ka),()=>{(new Xc(this.cell,this.Oo,this.externalSourceIndex,this.Co.Name,this.$,Rb,ud.result,this.isOlap,this.NV,Fb.result)).initialize()},this.ka);default:return ja.a(pb)}return $a.Task.Ta(!0)}wc(pb,Rb,oc){pb=!1;switch(Rb.command){case -1453503574:pb=!!oc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:pb=
!0}return pb}kZ(){const pb=this.Va.fq(this.menuId);this.$3i(pb,this.yAc,this.A3d);this.a4i(pb,this.PTa);this.b4i(pb);8===this.PTa&&this.Y3i(pb);return pb}$3i(pb,Rb,oc){const Jc=this.Va,ud=Jc.Ec();Rb||Rb!==oc-1?!Rb&&Rb<oc-1?(ud.buttons.push(Jc.pb(64)),ud.buttons.push(Jc.pb(61)),ud.buttons.push(Jc.pb(66)),ud.buttons.push(Jc.pb(63))):0<Rb&&Rb<oc-1?(ud.buttons.push(Jc.pb(60)),ud.buttons.push(Jc.pb(61)),ud.buttons.push(Jc.pb(62)),ud.buttons.push(Jc.pb(63))):0<Rb&&Rb===oc-1&&(ud.buttons.push(Jc.pb(60)),
ud.buttons.push(Jc.pb(65)),ud.buttons.push(Jc.pb(62)),ud.buttons.push(Jc.pb(67))):(ud.buttons.push(Jc.pb(64)),ud.buttons.push(Jc.pb(65)),ud.buttons.push(Jc.pb(66)),ud.buttons.push(Jc.pb(67)));pb.tc.push(ud)}a4i(pb,Rb){const oc=this.Va,Jc=oc.Ec(),ud=1!==Rb&&(!this.isOlap||this.NV||8!==Rb||this.H3a),Fb=2!==Rb&&(!this.isOlap||this.NV||8!==Rb||this.H3a),pa=8!==Rb&&-2!==this.Co.PivotTableIndex&&(!this.isOlap||this.NV||this.H3a);Jc.buttons.push(oc.pb(4===Rb||this.Co.IsSet||-2===this.Co.PivotTableIndex||
this.isOlap&&!this.NV&&8===Rb&&!this.H3a?72:68));8===this.Oo.AnchorType||10===this.Oo.AnchorType?(Jc.buttons.push(oc.pb(ud?95:97)),Jc.buttons.push(oc.pb(Fb?96:98))):(Jc.buttons.push(oc.pb(ud?69:73)),Jc.buttons.push(oc.pb(Fb?70:74)));Jc.buttons.push(oc.pb(pa?71:75));pb.tc.push(Jc)}b4i(pb){const Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(76));pb.tc.push(Rb)}Y3i(pb){const Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(77));pb.tc.push(Rb)}}Object(c.a)(Rc,"FieldWellContextMenu",y.a,[]);var Fd=a(1220);class Nd extends Yb{constructor(pb,
Rb,oc,Jc){super(pb,"PopulatePivotContextMenu",2123758504,912277356,Rb,oc,Jc)}get Yw(){return"PopulatePivotContextMenu"}get QB(){return t.a.eRf}executeCommand(pb,Rb,oc){let Jc=!1;const ud=Rb.command;switch(ud){case 37023044:Jc=this.Gbd(oc,Rb);break;case 541421805:case -569786022:Jc=this.jld(pb,Rb)}return Jc?$a.Task.Ta(!0):ja.a(ud)}wc(pb,Rb,oc){pb=!1;switch(Rb.command){case 37023044:pb=!!oc;break;case 541421805:case -569786022:pb=!0}return pb}jld(pb,Rb){var oc=8===pb,Jc=this.$,ud=Ua.a(Jc),Fb=N.h(Jc).ha.Sa.$b;
let pa=pb=null;oc&&ud?(pb=ud.chartId,pa=ud.Vc):!oc&&Fb&&(pb=Fb.floatingObject.id,pa=Fb.floatingObject.Vc);return Nd.Lve(pa,260)?(oc={},Jc.pk(oc),oc.FirstColumn=oc.FirstRow=-1,Jc={["rawEvent"]:null,["pivotName"]:null,["cell"]:oc,["requiresConfirmation"]:Nd.Lve(pa,64),["dataSourceIndex"]:pa.ExternalSourceIndex},Fb?(ud=Fb.floatingObject,Jc.domElement=Fb.domElement,Jc.objectId=ud.id,Jc.objectVersion=ud.version):ud&&(Jc.domElement=ud.Hl,Jc.objectId=ud.chartId,Jc.objectVersion=ud.VBe),Fb={AnchorType:7},
Fb.ChartId=pb,Fb.AnchorValue1=-1,Fb.AnchorValue2=-1,Jc.optionalPivotMenuAnchorParameter=Fb,this.Gbd(Jc,Rb)):!1}static Lve(pb,Rb){return(pb.Attributes&Rb)===Rb}}Object(c.a)(Nd,"PivotFilterContextMenu",Yb,[]);var zd=a(1293);const Sd=(pb,Rb,oc,Jc,ud,Fb,pa,tb,Nb,vc=null)=>{vc=pb.Na(41,vc);vc.activeCell=Rb;vc.operationType=oc;vc.fieldCaption=Jc;vc.prevFieldCaption=ud;return L.g(pb,"ExecutePivotTableOperation",vc,Fb,pa,tb,Nb,0)},se=(pb,Rb,oc,Jc,ud,Fb,pa,tb=null)=>{tb=pb.Na(41,tb);tb.activeCell=Rb;tb.pivotValueFieldSettingsApplyData=
oc;return L.g(pb,"ApplyValueFieldSettingsToPivotTable",tb,Jc,ud,Fb,pa,0)};var He=a(148),Gd=a(374),fe=a(283),$d=a(28),qe=a(22);const pe=t.a.G8g,Ne=pe+".RemoveField",Le=pe+".Subtotal",gf=pe+".ClearFilter",Ye=pe+".LayoutSameColumn",$e=pe+".LayoutNextColumn";class Ya extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulatePivotTableContextMenu",-1475408662,1114549926,pe,!0,!1,"PivotTableContextMenuRootName",Rb,oc,!0,Jc);this.d3d=this.activeCell=this.jc=null;this.GZ=this.refresh=this.expandCollapse=this.Nqd=
this.hkc=!1;this.tbb=this.vb=this.B1a=this.nA=this.Be=null;this.Rba=!1;this.oRi=ud=>{ud&&!Z.a.dg(ud.Errors)&&this.jc&&(this.jc.fp=ud.Result,this.AMb());this.showPivotTableContextMenu()};this.nRi=()=>{};this.YUi=()=>{this.adb()};this.XUi=()=>{this.adb()};this.ELi=()=>{this.adb()};this.DLi=()=>{this.adb()};this.yy=()=>{this.z0d();this.Rba=!1};this.Zq=()=>{if(this.Rba){d.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const ud=this.jc;this.grid.Bb.xp(this.grid.ha.ra.activeCell)!==ud&&(this.adb(),this.Dai())}};this.goh=new DOMParser;this.PBj=!0;this.grid=N.h(pb);this.Xmc=!0}get Yw(){return"PopulatePivotTableContextMenu"}get QB(){return t.a.fRf}executeCommand(pb,Rb,oc){Rb=Rb.command;pb=null;this.grid=N.h(this.$);this.activeCell=E.o(this.grid.ha.ra.activeCell,this.$);if(this.$.isEditMode&&(this.jc=this.grid.Bb.xp(this.grid.ha.ra.activeCell),!this.jc))return d.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
D.TaskExtensions.iba();this.d3d=this.$.pa.ya;this.B1a=Object(Tb.a)(wa.a,oc.eventArgs);switch(Rb){case 671488277:this.DDj()?this.lZh():(this.adb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.ZSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.ZSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.ZSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.ZSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.ZSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.ZSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:oc=Number.parseInvariant(oc.MenuItemId.split(".")[2]);this.ZSa(11,oc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Xc(-1556797033,C.a.Db,8,null);break;case 1514686611:this.Nwi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:oc=Number.parseInvariant(oc.MenuItemId);this.N3g(oc);break;case 1778578888:oc=Number.parseInvariant(oc.MenuItemId);this.cRg(oc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:pb=ja.a(Rb)}return pb||D.TaskExtensions.iba()}wc(pb,Rb){pb=!1;switch(Rb.command){case 671488277:pb=
Ma.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:pb=!0;break;case 1600778266:pb=!0;break;case -556893687:pb=!0;break;case -1966978671:pb=!0;break;case -1951357930:pb=!0;break;case -1390365353:case -1457478532:pb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:pb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:pb=
!0;break;case -1007663920:case 234234584:case 1194992911:pb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:pb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:pb=S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return pb}DDj(){if(!this.$.isEditMode||this.jc.Xhc)return!1;let pb=this.d7f(!1);return S.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.jc.isOlap||pb:!this.jc.Wic()||pb}nc(pb,Rb){let oc=!1;switch(Rb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:oc=this.tS();break;case -1007663920:case 234234584:oc=this.gCj()||this.tS();break;case 1194992911:oc=this.hCj()||this.tS();break;
case 1217404289:oc=!zd.j(this.vb.LabelOrDateFilterType)||this.tS();break;case -743135194:oc=!zd.m(this.vb.ValueFilterType)&&!zd.l(this.vb.ValueFilterType)||this.tS();break;case 771421327:oc=0===this.vb.LabelOrDateFilterType&&0===this.vb.ValueFilterType&&!this.vb.HasManualFilter||this.tS();break;case 1015867427:oc=!zd.i(this.vb.LabelOrDateFilterType)||this.tS();break;case 1105960559:oc=!zd.k(this.vb.LabelOrDateFilterType)||this.tS()}return oc||super.nc(pb,Rb)}adb(){this.tbb=this.vb=this.Be=null}NXd(){this.grid.QT(this.Zq);
this.$.Ja.KZa(this.yy)}z0d(){this.grid.wO(this.Zq);this.$.Ja.jKb(this.yy)}AMb(){if(this.jc&&this.jc.fp){this.Be=this.jc.fp;this.vb=this.jc.pcc();if(this.S7f()){const pb=this.jc.yL[4===this.Be.CellType?this.jc.B7c-1:this.Be.CurrentFieldIndex-1];pb&&(this.tbb=-2===pb.Index?this.jc.nKe:pb.Caption)}this.rei();this.vb&&8===this.Be.CellArea&&(this.nA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.vb.DataFieldAggregationType,this.nA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.vb.DataFieldFormatType,
this.nA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.vb.BaseFieldIndex,this.nA.PivotValueFieldTitle=this.vb.Caption)}}d7f(pb){return this.jc?this.jc.isOlap&&!this.jc.$Na(!pb):!1}oCj(){const pb=S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.vb.MeasureType&&(!this.jc.glf||pb&&2===this.vb.MeasureType)}kZ(){const pb=this.Va.fq(this.menuId),Rb=this.Va.Ec(),oc=N.h(this.$).Sb(null);if(this.jc)this.Be&&this.jc.fp&&this.Be!==this.jc.fp&&
d.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.vb&&this.vb!==this.jc.pcc()&&d.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return pb;this.tKh(pb);if(this.$.isEditMode){this.refresh&&this.JLh(pb);if(this.Be&&this.vb){var Jc=this.Va.Ec();this.XLh(Jc);this.IKh(Jc);pb.tc.push(Jc)}this.GZ&&Rb.buttons.push(this.Va.pb(99));this.Be&&this.vb&&this.gLh(pb);if(this.expandCollapse){Jc=this.Va.tw("ContextMenu.PivotExpandCollapse",
null,X.a.instance.ga(1163),589118293);const ud=this.Va.Ec();ud.buttons.push(this.Va.pb(243));ud.buttons.push(this.Va.pb(244));ud.buttons.push(this.Va.pb(245));ud.buttons.push(this.Va.pb(246));Jc.menu.tc.push(ud);Jc&&0<ud.buttons.length&&Rb.buttons.push(Jc)}this.Be&&(Jc=this.Va.Ec(),S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.rLh(Jc),this.KLh(Jc),0<Jc.buttons.length&&pb.tc.push(Jc));this.Be&&this.vb&&8===this.Be.CellArea&&8!==this.Be.CellType&&
(Jc=this.Va.Ec(),this.oCj()&&this.ZLh(Jc),3!==this.Be.CellType&&this.ULh(Jc),pb.tc.push(Jc));!this.jc.Wic()&&""!==(null===oc||void 0===oc?void 0:oc.text)&&this.Be&&0===this.Be.CellType&&S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.TLh(pb);this.Ypi()?Rb.buttons.push(this.Va.pb(257)):Rb.buttons.push(this.Va.pb(258));this.Nqd?Rb.buttons.push(this.Va.pb(59)):Rb.buttons.push(this.Va.pb(58))}pb.tc.push(Rb);return pb}pTa(){return this.vb&&this.vb.Caption?20<
this.vb.Caption.length:!1}fLa(pb){return this.vb&&this.vb.Caption?pb?this.vb.Caption.substring(0,20)+"...":this.vb.Caption:""}Wva(pb){return S.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?qe.a.hashCode(pb).toString():pb}XLh(pb){if(this.Be&&this.vb&&4!==this.Be.CellArea){var Rb=this.Ija(this.JH("PivotTableContextMenu.Sort",this.Wva(this.vb.Caption)),-1777747317,0,0!==this.vb.SortInfo,X.a.instance.ga(227)),oc=this.Va.Ec();oc.buttons.push(this.Sd("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.vb.SortInfo,X.a.instance.ga(228)));oc.buttons.push(this.Sd("PivotTableContextMenu.SortDescending",234234584,0,2===this.vb.SortInfo,X.a.instance.ga(229)));1!==this.Be.CellArea&&2!==this.Be.CellArea||oc.buttons.push(this.Sd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.vb.SortInfo||4===this.vb.SortInfo,X.a.instance.ga(154)));Rb.menu.tc.push(oc);Rb&&0<oc.buttons.length&&pb.buttons.push(Rb)}}IKh(pb){if(this.Be&&this.vb&&(1===this.Be.CellArea||2===this.Be.CellArea)){var Rb=
this.CDj();const Fb=this.Ija(this.JH("PivotTableContextMenu.Filter",this.Wva(this.vb.Caption)),-1777747317,0,Rb,X.a.instance.ga(651)),pa=this.Va.Ec();var oc="",Jc=this.pTa(),ud=String.format(X.a.instance.mb(156),this.fLa(Jc));Jc&&(oc=String.format(X.a.instance.mb(156),this.vb.Caption));Rb=this.Wva(this.vb.Caption)+"."+(Rb?"enabled":"disabled");oc=this.Sd(this.JH(gf,Rb),771421327,0,!1,ud,"0",oc,8,jb.a.s3a);Rb=this.Wva(this.vb.Caption)+"."+this.vb.LabelOrDateFilterType.toString();this.vb.IsDateField?
(ud=this.Ija(this.JH("PivotTableContextMenu.DateFilter",Rb),-1777747317,0,0!==this.vb.LabelOrDateFilterType,X.a.instance.ga(97)),this.wKh(ud.menu)):(ud=this.Ija(this.JH("PivotTableContextMenu.LabelFilter",Rb),-1777747317,0,0!==this.vb.LabelOrDateFilterType,X.a.instance.ga(649)),this.fLh(ud.menu));Rb=this.Wva(this.vb.Caption)+"."+this.vb.ValueFilterType.toString();Rb=this.Ija(this.JH("PivotTableContextMenu.ValueFilter",Rb),-1777747317,0,0!==this.vb.ValueFilterType,X.a.instance.ga(650));this.kMh(Rb.menu);
Jc=this.Va.Ec();Jc.buttons.push(this.Sd("PivotTableContextMenu.ManualFilter",1514686611,0,this.vb.HasManualFilter,X.a.instance.ga(94)));pa.buttons.push(oc);pa.buttons.push(ud);pa.buttons.push(Rb);Fb.menu.tc.push(pa);Fb.menu.tc.push(Jc);Fb&&0<pa.buttons.length&&pb.buttons.push(Fb)}}wKh(pb){pb.tc.push(this.Lcc(!0,!1));pb.tc.push(this.DRh());pb.tc.push(this.CRh());pb.tc.push(this.sTh());pb.tc.push(this.vTh());pb.tc.push(this.tTh());pb.tc.push(this.uTh());pb.tc.push(this.wTh());pb.tc.push(this.xTh());
pb.tc.push(this.qRh())}lKh(pb){pb.tc.push(this.Lcc(!0,!0));pb.tc.push(this.h_h());pb.tc.push(this.vXh())}fLh(pb){pb.tc.push(this.Lcc(!0,!1));pb.tc.push(this.v2e(!0));pb.tc.push(this.VNh());pb.tc.push(this.BQh());pb.tc.push(this.t1e(!0));pb.tc.push(this.y0e(!0))}kMh(pb){pb.tc.push(this.Lcc(!1,!1));pb.tc.push(this.v2e(!1));pb.tc.push(this.t1e(!1));pb.tc.push(this.y0e(!1));pb.tc.push(this.E3h())}E3h(){const pb=this.Va.Ec();pb.buttons.push(this.Sd("PivotTableContextMenu.Top10",-1611233597,0,zd.l(this.vb.ValueFilterType),
X.a.instance.ga(105)));return pb}BQh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.Contains",786260386,0,10===this.vb.LabelOrDateFilterType,X.a.instance.ga(652),"10")),pb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.vb.LabelOrDateFilterType,X.a.instance.ga(653),"11")));return pb}VNh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.vb.LabelOrDateFilterType,X.a.instance.ga(654),
"6")),pb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.vb.LabelOrDateFilterType,X.a.instance.ga(655),"7")),pb.buttons.push(this.Sd("PivotTableContextMenu.EndsWith",786260386,0,8===this.vb.LabelOrDateFilterType,X.a.instance.ga(656),"8")),pb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.vb.LabelOrDateFilterType,X.a.instance.ga(657),"9")));return pb}v2e(pb){const Rb=this.Va.Ec();if(this.vb){const oc=pb?zd.c:zd.f;Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.Equals",
oc),786260386,0,pb?4===this.vb.LabelOrDateFilterType:18===this.vb.ValueFilterType,X.a.instance.ga(100),pb?"4":"18"));Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.DoesNotEqual",oc),786260386,0,pb?5===this.vb.LabelOrDateFilterType:19===this.vb.ValueFilterType,X.a.instance.ga(101),pb?"5":"19"))}return Rb}t1e(pb){const Rb=this.Va.Ec();if(this.vb){const oc=pb?zd.c:zd.f;Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.GreaterThan",oc),786260386,0,pb?12===this.vb.LabelOrDateFilterType:20===
this.vb.ValueFilterType,X.a.instance.ga(102),pb?"12":"20"));Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.GreaterThanOrEqualTo",oc),786260386,0,pb?13===this.vb.LabelOrDateFilterType:21===this.vb.ValueFilterType,X.a.instance.ga(658),pb?"13":"21"));Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.LessThan",oc),786260386,0,pb?14===this.vb.LabelOrDateFilterType:22===this.vb.ValueFilterType,X.a.instance.ga(103),pb?"14":"22"));Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.LessThanOrEqualTo",
oc),786260386,0,pb?15===this.vb.LabelOrDateFilterType:23===this.vb.ValueFilterType,X.a.instance.ga(659),pb?"15":"23"))}return Rb}y0e(pb){const Rb=this.Va.Ec();if(this.vb){const oc=pb?zd.c:zd.f;Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.Between",oc),786260386,0,pb?16===this.vb.LabelOrDateFilterType:24===this.vb.ValueFilterType,X.a.instance.ga(104),pb?"16":"24"));Rb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.NotBetween",oc),786260386,0,pb?17===this.vb.LabelOrDateFilterType:25===
this.vb.ValueFilterType,X.a.instance.ga(660),pb?"17":"25"))}return Rb}Lcc(pb,Rb){const oc=this.Va.Ec();if(this.vb){var Jc=X.a.instance.ga(98);const Fb=pb?this.vb.LabelOrDateFilterType.toString():this.vb.ValueFilterType.toString();var ud=["PivotTableContextMenu.ClearFilter",this.Wva(this.vb.Caption),Fb];pb=pb?this.vb.IsDateField?Rb?1015867427:1105960559:1217404289:-743135194;ud.push(pb.toString());ud=ud.join(".");Jc=this.Sd(ud,pb,0,!1,Jc,Fb,Jc,8,jb.a.s3a);oc.buttons.push(Jc)}return oc}DRh(){const pb=
this.Va.Ec();this.vb&&pb.buttons.push(this.Sd(this.JH("PivotTableContextMenu.Equals",zd.d),786260386,0,26===this.vb.LabelOrDateFilterType,X.a.instance.ga(100),"26"));return pb}CRh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.Before",786260386,0,27===this.vb.LabelOrDateFilterType,X.a.instance.ga(112),"27")),pb.buttons.push(this.Sd("PivotTableContextMenu.After",786260386,0,28===this.vb.LabelOrDateFilterType,X.a.instance.ga(113),"28")),pb.buttons.push(this.Sd("PivotTableContextMenu.Between",
786260386,0,29===this.vb.LabelOrDateFilterType,X.a.instance.ga(104),"29")));return pb}sTh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.vb.LabelOrDateFilterType,X.a.instance.ga(110),"30")),pb.buttons.push(this.Sd("PivotTableContextMenu.Today",1778578888,0,31===this.vb.LabelOrDateFilterType,X.a.instance.ga(109),"31")),pb.buttons.push(this.Sd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.vb.LabelOrDateFilterType,X.a.instance.ga(111),
"32")));return pb}vTh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.vb.LabelOrDateFilterType,X.a.instance.ga(115),"33")),pb.buttons.push(this.Sd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.vb.LabelOrDateFilterType,X.a.instance.ga(114),"34")),pb.buttons.push(this.Sd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.vb.LabelOrDateFilterType,X.a.instance.ga(116),"35")));return pb}tTh(){const pb=this.Va.Ec();this.vb&&
(pb.buttons.push(this.Sd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.vb.LabelOrDateFilterType,X.a.instance.ga(117),"36")),pb.buttons.push(this.Sd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.vb.LabelOrDateFilterType,X.a.instance.ga(118),"37")),pb.buttons.push(this.Sd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.vb.LabelOrDateFilterType,X.a.instance.ga(119),"38")));return pb}uTh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.vb.LabelOrDateFilterType,X.a.instance.ga(120),"39")),pb.buttons.push(this.Sd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.vb.LabelOrDateFilterType,X.a.instance.ga(121),"40")),pb.buttons.push(this.Sd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.vb.LabelOrDateFilterType,X.a.instance.ga(122),"41")));return pb}wTh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.NextYear",1778578888,0,42===this.vb.LabelOrDateFilterType,
X.a.instance.ga(123),"42")),pb.buttons.push(this.Sd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.vb.LabelOrDateFilterType,X.a.instance.ga(124),"43")),pb.buttons.push(this.Sd("PivotTableContextMenu.LastYear",1778578888,0,44===this.vb.LabelOrDateFilterType,X.a.instance.ga(125),"44")));return pb}xTh(){const pb=this.Va.Ec();if(this.vb){pb.buttons.push(this.Sd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.vb.LabelOrDateFilterType,X.a.instance.ga(126),"45"));const Rb=this.Ija("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,zd.i(this.vb.LabelOrDateFilterType),X.a.instance.ga(127));this.lKh(Rb.menu);pb.buttons.push(Rb)}return pb}qRh(){const pb=this.Va.Ec();this.vb&&pb.buttons.push(this.Sd("PivotTableContextMenu.CustomFilter",786260386,0,this.zDj(this.vb.LabelOrDateFilterType),X.a.instance.ga(108),"26"));return pb}h_h(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.vb.LabelOrDateFilterType,X.a.instance.ga(128),"46")),pb.buttons.push(this.Sd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.vb.LabelOrDateFilterType,X.a.instance.ga(129),"47")),pb.buttons.push(this.Sd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.vb.LabelOrDateFilterType,X.a.instance.ga(130),"48")),pb.buttons.push(this.Sd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.vb.LabelOrDateFilterType,X.a.instance.ga(131),"49")));return pb}vXh(){const pb=this.Va.Ec();this.vb&&(pb.buttons.push(this.Sd("PivotTableContextMenu.January",1778578888,0,50===this.vb.LabelOrDateFilterType,X.a.instance.ga(132),
"50")),pb.buttons.push(this.Sd("PivotTableContextMenu.February",1778578888,0,51===this.vb.LabelOrDateFilterType,X.a.instance.ga(133),"51")),pb.buttons.push(this.Sd("PivotTableContextMenu.March",1778578888,0,52===this.vb.LabelOrDateFilterType,X.a.instance.ga(134),"52")),pb.buttons.push(this.Sd("PivotTableContextMenu.April",1778578888,0,53===this.vb.LabelOrDateFilterType,X.a.instance.ga(135),"53")),pb.buttons.push(this.Sd("PivotTableContextMenu.May",1778578888,0,54===this.vb.LabelOrDateFilterType,X.a.instance.ga(136),
"54")),pb.buttons.push(this.Sd("PivotTableContextMenu.June",1778578888,0,55===this.vb.LabelOrDateFilterType,X.a.instance.ga(137),"55")),pb.buttons.push(this.Sd("PivotTableContextMenu.July",1778578888,0,56===this.vb.LabelOrDateFilterType,X.a.instance.ga(138),"56")),pb.buttons.push(this.Sd("PivotTableContextMenu.August",1778578888,0,57===this.vb.LabelOrDateFilterType,X.a.instance.ga(139),"57")),pb.buttons.push(this.Sd("PivotTableContextMenu.September",1778578888,0,58===this.vb.LabelOrDateFilterType,
X.a.instance.ga(140),"58")),pb.buttons.push(this.Sd("PivotTableContextMenu.October",1778578888,0,59===this.vb.LabelOrDateFilterType,X.a.instance.ga(141),"59")),pb.buttons.push(this.Sd("PivotTableContextMenu.November",1778578888,0,60===this.vb.LabelOrDateFilterType,X.a.instance.ga(142),"60")),pb.buttons.push(this.Sd("PivotTableContextMenu.December",1778578888,0,61===this.vb.LabelOrDateFilterType,X.a.instance.ga(143),"61")));return pb}gLh(pb){const Rb=this.Va.Ec();if(this.S7f()){var oc=this.jc.yL[4===
this.Be.CellType?this.jc.B7c-1:this.Be.CurrentFieldIndex-1];if(oc&&this.tbb){var Jc=this.Va.tw("ContextMenu.PivotTableLayout",null,X.a.instance.ga(647),-1777747317);var ud=this.Va.Ec();const Fb=String.format(X.a.instance.mb(169),this.tbb),pa=String.format(X.a.instance.mb(170),this.tbb);ud.buttons.push(this.Sd($e,-1457478532,0,!oc.IsCompactLayout,Fb));ud.buttons.push(this.Sd(Ye,-1390365353,0,oc.IsCompactLayout,pa));Jc.menu.tc.push(ud);Jc&&Rb.buttons.push(Jc)}}if(1===this.Be.CellArea||2===this.Be.CellArea)this.vb.Caption&&
(oc="",ud=this.pTa(),Jc=String.format(X.a.instance.mb(159),this.fLa(ud)),ud&&(oc=String.format(X.a.instance.mb(159),this.vb.Caption)),1===this.Be.CellArea?(oc=this.Ija("ContextMenu.PivotTableSubtotal",1801458190,0,this.vb.ShowSubtotal,Jc),Jc=this.Va.Ec(),Jc.buttons.push(this.Va.pb(259)),Jc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.vb.ShowSubtotal&&this.vb.ShowSubtotalAtTop)),Jc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.vb.ShowSubtotal&&
!this.vb.ShowSubtotalAtTop)),oc.menu.tc.push(Jc),oc&&0<Jc.buttons.length&&Rb.buttons.push(oc)):(ud=ud?this.JH(Le,this.Wva(Jc)):Le,Rb.buttons.push(this.Sd(ud,1801458190,0,this.vb.ShowSubtotal,Jc,null,oc)))),Rb.buttons.push(this.Sd("ContextMenu.RepeatItemLabels",-556893687,642,this.vb.RepeatItemLabels));1===this.Be.CellArea&&Rb.buttons.push(this.Sd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.vb.ShowBlankLineAfterEachItem));pb.tc.push(Rb)}TLh(pb){const Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(247));
pb.tc.push(Rb)}rLh(pb){if(this.$.isEditMode&&this.grid){var Rb=this.grid.ha.ra.activeRange;if(Rb.top===Rb.bottom&&Rb.left===Rb.right&&0!==this.Be.MoveItemsMenuState){Rb=this.Ija("PivotTableContextMenu.Move",-1777747317,0,!1,X.a.instance.ga(73));var oc=this.Va.Ec();this.wva(oc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(X.a.instance.mb(162),this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&1));this.wva(oc,"PivotTableContextMenu.MoveUp",713270357,String.format(X.a.instance.mb(163),
this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&2));this.wva(oc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(X.a.instance.mb(160),this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&4));this.wva(oc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(X.a.instance.mb(161),this.Be.MoveItemName),0===(this.Be.MoveItemsMenuState&8));Rb.menu.tc.push(oc);oc=this.Va.Ec();this.wva(oc,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(X.a.instance.mb(167),this.fLa(this.pTa())),
0===(this.Be.MoveItemsMenuState&16));this.wva(oc,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(X.a.instance.mb(164),this.fLa(this.pTa())),0===(this.Be.MoveItemsMenuState&32));this.wva(oc,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(X.a.instance.mb(165),this.fLa(this.pTa())),0===(this.Be.MoveItemsMenuState&64));this.wva(oc,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(X.a.instance.mb(166),this.fLa(this.pTa())),0===(this.Be.MoveItemsMenuState&
128));Rb.menu.tc.push(oc);pb.buttons.push(Rb)}}}KLh(pb){var Rb="";let oc="";var Jc=!1;3===this.Be.CellType?Rb=X.a.instance.ga(644):8===this.Be.CellType?this.jc&&(Rb=String.format(X.a.instance.mb(168),this.jc.nKe)):this.vb&&((Jc=this.pTa())&&(oc=String.format(X.a.instance.mb(168),this.vb.Caption)),Rb=String.format(X.a.instance.mb(168),this.fLa(Jc)));Rb&&(Jc=Jc?this.JH(Ne,this.Wva(Rb)):Ne,Rb=this.Sd(Jc,-1951357930,0,!1,Rb,null,oc,8,jb.a.cbd),pb.buttons.push(Rb))}tKh(pb){const Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(43));
this.vb&&this.Be&&this.$.isEditMode&&(0===this.Be.CellType||4===this.Be.CellType)&&Rb.buttons.push(this.Va.pb(136));if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&S.EwaSettings.ma(103)&&this.grid&&this.grid.ha){const oc=this.grid.ha.ra.selectedRanges;oc&&1===oc.length&&(oc[0].isSingle||this.grid.Bb.QNa(oc[0]))&&this.grid.Bb.Mxa(oc[0])&&!this.grid.Bb.gAb(oc[0])&&Rb.buttons.push(this.Va.pb(this.grid.Bb.Ugf(oc[0])?217:216))}pb.tc.push(Rb)}JLh(pb){const Rb=
this.Va.Ec();Rb.buttons.push(this.Va.pb(100));pb.tc.push(Rb)}ZLh(pb){const Rb=2===this.vb.MeasureType&&!this.vb.IsNumeric,oc=this.Va.tw("ContextMenu.SummarizeValuesBy",null,X.a.instance.ga(645),-249874296),Jc=this.Va.Ec();Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesBySum",-1255320719,1102,0===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Rb));Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCount",1746132849,1103,1===this.vb.DataFieldAggregationType));Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByAverage",
-771066011,1104,2===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Rb));Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMax",835007294,1105,3===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Rb));Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMin",929115636,1106,4===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Rb));Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByProduct",1935475057,1107,5===this.vb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.d7f(!0)||Rb));2!==this.vb.MeasureType&&(Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1108,6===this.vb.DataFieldAggregationType)),Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1109,7===this.vb.DataFieldAggregationType)),Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1110,8===this.vb.DataFieldAggregationType)),Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariant",
1668427539,1111,9===this.vb.DataFieldAggregationType)),Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1112,10===this.vb.DataFieldAggregationType)));this.jc&&this.jc.Wic()&&Jc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1113,11===this.vb.DataFieldAggregationType));oc.menu.tc.push(Jc);pb.buttons.push(oc)}ULh(pb){const Rb=this.Va.tw("ContextMenu.ShowValuesAs",null,X.a.instance.ga(646),-1128612833),oc=this.Va.Ec();oc.buttons.push(this.Sd("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1119,0===this.vb.DataFieldFormatType));oc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1126,7===this.vb.DataFieldFormatType));oc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1125,6===this.vb.DataFieldFormatType));oc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1124,5===this.vb.DataFieldFormatType));oc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1129,9===this.vb.DataFieldFormatType));
oc.buttons.push(this.Sd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1130,10===this.vb.DataFieldFormatType));if(this.jc&&this.jc.yL&&0<this.jc.yL.length||this.jc.Q$&&0<this.jc.Q$.length){const Jc=this.Ija("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1131,11===this.vb.DataFieldFormatType),ud=this.Va.Ec(),Fb=this.YLh();for(let pa=0;pa<Fb.length;pa++){const tb=Fb[pa];ud.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentTotal."+tb.Caption,-2031744961,1131,11===this.vb.DataFieldFormatType&&
this.vb.BaseFieldIndex===tb.Index,tb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+tb.Index))}Jc.menu.tc.push(ud);oc.buttons.push(Jc)}Rb.menu.tc.push(oc);pb.buttons.push(Rb)}showPivotTableContextMenu(){this.Nqd=!0;this.expandCollapse=this.GZ=this.refresh=!1;var pb=this.$,Rb=N.h(pb),oc=ec.a(pb).yLa();if(oc){var Jc=nb.a(pb);if(null===Jc||void 0===Jc?0:Jc.eUd)this.Nqd=Da.f(pb.lg);Jc=pb.dc;this.GZ=oc.supportsBIExplore&&!!Ia.a(pb)&&Jc.Y2(32768);Jc.allowInteractivity&&(pb=Rb.Sb(null),(null===
pb||void 0===pb?0:pb.cell)&&(pb.cell.R0c||pb.cell.P7f)&&(this.expandCollapse=!0),Jc.allowManualDataRefresh&&(this.refresh=!0))}pb=null;oc=1;this.B1a&&1!==this.B1a.tb?(pb=new Sys.UI.Point(this.B1a.clientPoint.x,this.B1a.clientPoint.y),oc=this.B1a.tb):(Rb=Ma.e(Rb,this.$))&&(pb=new Sys.UI.Point(Rb.x+(this.$.isChromeRtl?0:Rb.width),Rb.y+Rb.height));C.a.Db=oc;this.hkc=3===oc;this.Sp(pb,!0,oc);this.Rba=!0;this.NXd()}Dai(){const pb=new M.a(1114549926,0,this.$.Hc,19,null);this.$.Ja.Lb(pb)}lZh(){if(this.jc&&
this.jc.fp){var pb=this.jc.fp.CurrentCol;if(this.jc.fp.CurrentRow===this.activeCell.FirstRow&&pb===this.activeCell.FirstColumn){this.AMb();this.showPivotTableContextMenu();return}}pb=new I.a(228,0,(Rb,oc,Jc)=>fe.l(this.$.pa.ya,this.activeCell,va.b(Rb,this.oRi),va.a(oc,this.nRi),Jc,null),16);this.$.userOperationManager.Ic(pb,null)}Ypi(){if(Va.a.fd(this.$)){var pb=this.$.da.Aa(441);if(pb)return pb.ns}else if(pb=this.$.da.Aa(346))return pb.ns;return!1}JH(pb,Rb){return pb+"."+Rb}performPivotTableOperation(pb,
Rb){const oc=$d.a.Qa.zb;if(!this.jc||!this.vb&&this.Be&&3!==this.Be.CellType)this.vj();else{var Jc=this.jc.isOlap;ec.a(this.$).Px(Jc,ud=>{ud&&this.$.Ic(pb,(Fb,pa,tb)=>Sd(this.d3d,this.activeCell,Rb,this.vb?this.vb.Caption:null,this.tbb,va.b(Fb,this.YUi),va.a(pa,this.XUi),tb,null,this.$.pa.ya.Wb()),oc,0,4,229)})}}applyValueFieldSettingsToPivotTable(pb,Rb=!1){const oc=$d.a.Qa.zb;this.jc&&this.vb?(Rb&&2===this.vb.MeasureType&&d.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
Rb=this.jc.isOlap,ec.a(this.$).Px(Rb,Jc=>{Jc&&this.$.Ic(pb,(ud,Fb,pa)=>se(this.d3d,this.activeCell,this.nA,va.b(ud,this.ELi),va.a(Fb,this.DLi),pa,null,this.$.pa.ya.Wb()),oc,0,4,231)})):this.vj()}Sd(pb,Rb,oc,Jc,ud=null,Fb=null,pa=null,tb=8,Nb=null,vc=!1){Jc&&(pb+=".Checked");vc&&(pb+=".Disabled");this.Va.Apd(pb)&&this.Va.zLd(pb);oc=ud||X.a.instance.ga(oc);pb=this.Va.EIa(pb,oc,Rb,null,"None",Fb,vc,null);pb.byc(null);pa&&pb.pS(pa);Jc?pb.rS("Image16by16",3,jb.a.zaa):Nb?pb.rS("Image16by16",tb,Nb):pb.i4b();
return pb}Ija(pb,Rb,oc,Jc,ud=null){oc=ud||X.a.instance.ga(oc);this.Va.Apd(pb)?this.Va.zLd(pb):this.Va.zLd(pb+".Checked");Jc&&(pb+=".Checked");this.PBj&&(oc=this.goh.parseFromString(oc,"text/html").body.innerText);pb=this.Va.H5c(pb,null,oc,Rb,3,jb.a.zaa);pb.xdf=Jc;!Jc&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&pb.i4b();return pb}rei(){this.nA=Object(f.a)(new zc,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new ne,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new yc,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}ZSa(pb,Rb){this.nA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=pb;this.nA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Rb;this.nA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}YLh(){const pb=[];if(this.jc&&this.jc.Q$&&0<this.jc.Q$.length)for(const Rb of this.jc.Q$)Rb&&pb.push(Rb);if(this.jc&&this.jc.yL&&0<this.jc.yL.length)for(const Rb of this.jc.yL)Rb&&pb.push(Rb);pb.sort((Rb,
oc)=>Rb.Index-oc.Index);return pb}S7f(){if(!this.Be||!this.jc||!this.jc.yL)return!1;const pb=1===this.Be.CellArea||4===this.Be.CellType&&this.Be.IsRowAxis,Rb=4===this.Be.CellType?0<this.jc.B7c:0<this.Be.CurrentFieldIndex;return 1<this.jc.yL.length&&pb&&Rb}hLa(pb){const Rb=[];3===pb?this.$.isEditMode?Rb.push(...[db.a.jMf,db.a.lMf,db.a.I2i]):Rb.push(...[db.a.copy]):2===pb&&Rb.push(db.a.wBe);return Rb}vj(){const pb=Z.a.$c(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Zc.a(this.$).vj(pb)}CDj(){return this.vb?
0!==this.vb.LabelOrDateFilterType||0!==this.vb.ValueFilterType||this.vb.HasManualFilter:!1}zDj(pb){return 62<=pb&&65>=pb}Nwi(){if(this.activeCell&&this.vb&&this.jc){var pb={};pb.cell=this.activeCell;pb.dataSourceIndex=this.jc.externalSourceIndex;pb.fieldId=this.vb.Index.toString();pb.isOlap=this.jc.isOlap;pb.confirmationRequired=this.jc.confirmationRequiredForDataOps;var Rb={};Rb.showPivotFilterDialogCommandData=pb;this.$.Xc(492140419,C.a.Db,19,Rb)}}N3g(pb){this.activeCell&&this.vb&&this.jc&&this.$.userOperationManager.Ic(new I.a(153,
0,(Rb,oc,Jc)=>L.A(this.$.pa.ya,this.activeCell,this.jc.externalSourceIndex,this.vb.Index.toString(),pb,Rb,oc,Jc,null,null)),null)}cRg(pb){!(30>pb||61<pb)&&this.activeCell&&this.vb&&this.jc&&this.$.userOperationManager.Ic(new I.a(152,0,(Rb,oc,Jc)=>L.e(this.$.pa.ya,this.activeCell,this.jc.externalSourceIndex,this.vb.Index.toString(),pb,Rb,oc,Jc,null,null)),null)}applyPivotSort(pb){if(this.jc&&this.vb&&this.activeCell&&this.Be){var Rb=1===this.Be.CellArea||2===this.Be.CellArea;8===this.Be.CellArea?Gd.a(this.$.userOperationManager,
(oc,Jc,ud)=>fe.b(this.$.pa.ya,this.activeCell,pb,this.vb.Caption,oc,Jc,ud,null),oc=>new I.a(1015,0,oc,void 0,null),null):Rb&&(Rb=1===this.Be.CellArea?1:2,this.$.ma(680)?He.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.jc.isOlap?"":this.vb.Caption,Rb,1===pb):He.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),1===
pb))}}tS(){return!this.jc||!this.jc.isActionable}gCj(){return(this.Be||this.jc)&&4!==this.Be.CellType&&(0!==this.Be.CellType||8!==this.Be.CellArea||this.jc.Q$&&this.jc.Q$.length||this.jc.yL&&this.jc.yL.length)?!1:!0}hCj(){return this.Be&&this.jc&&(1===this.Be.CellArea||2===this.Be.CellArea)&&this.jc.kRb&&this.jc.kRb.length?!1:!0}wva(pb,Rb,oc,Jc,ud){pb.buttons.push(this.Sd(Rb,oc,0,!1,Jc,null,null,8,null,ud))}}Object(c.a)(Ya,"PivotTableContextMenu",y.a,[]);class ra{compare(pb,Rb){return(pb||"").localeCompare(Rb||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(ra,"DigitsAsNumberComparer",null,[253]);var ya=a(1082),mb=a(154),Hb=a(348),Zb=a(262),mc=a(24),Pc=a(145);const fd=t.a.I8g;class id extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,fd,!0,!1,"TableFieldListContextMenuRoot",Rb,oc,!1,Jc);this.R6b=null;this.IBd=0;this.tFa=null;this.grid=N.h(pb)}get Yw(){return"PopulateTableFieldListContextMenu"}get QB(){return t.a.hRf}get nL(){this.tFa||(this.tFa=
this.$.da.Aa(261));return this.tFa}executeCommand(pb,Rb,oc){pb=Rb.command;switch(pb){case 639960842:this.applyTableFieldList(oc);this.nL.Sda();break;case -1085236154:d.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.IBd}`);this.nL.Sda();break;case 1833782813:this.nL.showCallout();break;default:return ja.a(pb)}return $a.Task.Ta(!0)}applyTableFieldList(pb){var Rb=pb.MenuItemId.toString();S.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Rb=Rb.replace("'","''"),Rb=Rb.replace("[","'["),Rb=Rb.replace("]","']"));var oc=Object(Tb.a)(String,pb.SourceControlId);const Jc={};Jc.PulloutField=Rb;Jc.PulloutCardPath=pb.SourceCardKeyPath;Jc.PulloutCardSourceRow=pb.SourceCardRow;Jc.PulloutCardSourceColumn=pb.SourceCardColumn;if(this.nL.JN){d.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Jc.ParameterType=2;pb=pb.ColumnIndex;if(void 0===pb||null===pb){if(void 0===oc||null===oc){d.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}pb=0<=this.nL.pPf?this.nL.pPf:parseInt(oc.substring(20+Rb.length+1,oc.length),10);if(isNaN(pb)){d.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${oc}`);return}}Jc.PulloutRichColumnSourceIndex=pb;if(this.tFa.COg){this.oPg(Rb,Jc);return}}else d.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Jc.ParameterType=4,oc=this.nL.selectedRange.right,Va.a.zAb()&&this.tFa.kxa&&(Jc.ParameterType=8,pb=this.nL.ima.top,pb=
mc.Range.gQ(oc)+pb,Rb==ya.d?(Rb="=DAYS("+pb+", TODAY())",Pc.a("DateFormulaPulledOut_DaysFromToday")):Rb==ya.g?(Rb="=IF(TODAY() < "+pb+", DATEDIF(TODAY(), "+pb+', "Y"), DATEDIF('+pb+', TODAY(), "Y"))',Pc.a("DateFormulaPulledOut_YearsFromToday")):Rb==ya.c?(Rb="=TEXT("+pb+', "dddd")',Pc.a("DateFormulaPulledOut_DayOfWeek")):Rb==ya.f?(Rb="=TEXT("+pb+', "mmmm")',Pc.a("DateFormulaPulledOut_MonthOfYear")):Rb==ya.e?(Rb="EOMONTH("+pb+", 0)",Rb="=DATE(YEAR("+Rb+"), MONTH("+Rb+"), DAY("+Rb+"))",Pc.a("DateFormulaPulledOut_EndOfMonth")):
Rb==ya.b&&(Rb="="+pb+" + 1",Pc.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Jc.PulloutCardSourceColumn&&null!==Jc.PulloutCardSourceColumn&&(oc=Jc.PulloutCardSourceColumn+1),Jc.PulloutRichColumnSourceIndex=oc;this.LRd(Rb,Jc)}LRd(pb,Rb,oc=0){d.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.IBd}, SelectedColumnIndex, ${Rb.PulloutRichColumnSourceIndex}`);pb=Object(f.a)(new Zb.a,{Text:pb});this.grid.setCell(pb,this.nL.ima,0,127,Rb,oc);this.grid.focus();
this.R6b=null;this.nL.Sda();this.nL.Tlj()}wc(pb,Rb,oc){if(pb=this.$.isEditMode&&S.EwaSettings.ma(134)&&!!this.nL)switch(Rb.command){case -1085236154:break;case 639960842:pb=!!oc;break;case 1833782813:pb=this.nL.bxa&&this.nL.nDb;break;default:pb=!1}return pb}a1(pb,Rb,oc){this.$.isEditMode&&(this.R6b=this.mLh(Object(Tb.a)(245,oc)),super.a1(pb,Rb,null,null,!1))}kZ(){return this.R6b}G5c(pb){if(!this.nL||!pb||!pb.$k)return d.ULS.shipAssertTag(537166994,0,!!this.nL,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
d.ULS.shipAssertTag(537166993,0,!!pb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),pb&&d.ULS.shipAssertTag(537166992,0,!!pb.$k,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let Rb=new xb.a;for(const Jc of pb.$k){pb=new xb.a;pb.add(Jc.ColumnName);pb.add(Jc.ColumnIndex.toString());let ud=new xb.a;var oc=null;Va.a.zAb()&&this.tFa.kxa?ud=ha.toList(ha.select(ha.asEnumerable(Jc.FieldInfoDataList),Fb=>Fb.Name)):(oc=
S.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new ra:new Xa.a,ud=ha.OBc(ha.concat(ud,ha.select(ha.asEnumerable(Jc.FieldInfoDataList),Fb=>Fb.Name)),Fb=>Fb,oc));oc=new xb.a;oc.add(ha.toArray(ha.concat(pb,ud)));Rb=ha.toList(ha.concat(Rb,oc))}return ha.toArray(Rb)}mLh(pb){var Rb=this.G5c(pb);if(!Rb||!Rb.length)return this.R6b=null;pb=this.Va;const oc=pb.fq(this.menuId);let Jc=pb.Ec();const ud=1<Rb.length,Fb=Va.a.zAb()&&this.tFa.kxa;this.IBd=Rb.length;for(const pa of Rb){Fb?
Jc.title="Calculate Date Information":ud||(Jc.title=pa[0]);Rb=pb.Ec();for(let tb=2,Nb=pa.length;tb<Nb;++tb)!Fb||pa[tb]!=ya.d&&pa[tb]!=ya.e||(oc.tc.push(Jc),Jc=pb.Ec()),(ud?Rb.buttons:Jc.buttons).push(pb.EIa("ApplyTableFieldList."+pa[tb]+"."+pa[1],pa[tb],639960842,null,"None",pa[tb],!1,void 0,!0));if(ud){const tb=pb.tw("ApplyTableFieldList."+pa[0],this.menuId,pa[0],798637440);tb.menu.tc.push(Rb);Jc.buttons.push(tb)}}oc.tc.push(Jc);return oc}oPg(pb,Rb){const oc=Z.a.$c(12,1,0,899,0,2007340793,"RichValuePulloutIntoNonEmptyRange");
if(S.EwaSettings.Jz()){const Jc=new Hb.a(this.$,oc);Jc.MP(()=>{2===Jc.returnValue&&this.LRd(pb,Rb,8)})}else{const Jc=new mb.ErrorDialog(this.$,oc);Jc.MP(()=>{2===Jc.returnValue&&this.LRd(pb,Rb,8)});Jc.xg()}}}Object(c.a)(id,"PulloutFieldListContextMenu",y.a,[]);const Dd=t.a.jRf;class Zd extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateRichTextContextMenu",679816325,1151222423,Dd,!0,!1,Dd,Rb,oc,!0,Jc);this.grid=N.h(pb)}get Yw(){return"PopulateRichTextContextMenu"}get QB(){return t.a.jRf}wc(pb,
Rb,oc){return-1687037502===Rb.command&&!!oc&&this.grid.eb}executeCommand(pb,Rb,oc){this.showRichTextFloatie(oc);return $a.Task.Ta(!0)}hLa(){return[db.a.m1g]}showRichTextFloatie(pb){var Rb=Object(Tb.a)(wa.a,pb.eventArgs);Rb&&(pb=this.hLa(Rb.tb),Rb=new Sys.UI.Point(Rb.Ca.clientX,Rb.Ca.clientY),this.showFloatie(pb,new Sys.UI.Bounds(Rb.x,Rb.y,0,0),2))}}Object(c.a)(Zd,"RichTextContextMenu",y.a,[]);var bc=a(100),Qc=a(574);const pd=t.a.H8g;class ce extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,pd,!0,!1,"SheetTabContextMenuRootName",Rb,oc,!1,Jc);this.Zjc=this.vic=!1}get Yw(){return"PopulateSheetOpsContextMenu"}get QB(){return t.a.kRf}executeCommand(pb,Rb,oc){if(eb.a(this.$))return $a.Task.Ta(!0);this.$.isEditMode&&(pb=oc[t.a.I6f],pb=pb.x&&pb.y?new Sys.UI.Point(pb.x+(this.$.isChromeRtl?10:-10),pb.y):vb.DOMElementExtensions.getLocation(oc[t.a.J6f]),this.Sp(pb,!1));return $a.Task.Ta(!0)}wc(pb,Rb,oc){return-1075099431===Rb.command&&!!oc}kZ(){const pb=this.Va.fq(this.menuId),
Rb=this.$.isEditMode;this.xZj();this.aLh(pb,Rb);this.QKh(pb);this.SLh(pb);return pb}G_b(pb,Rb,oc,Jc){pb.push(this.Va.pb(Rb?oc:Jc))}aLh(pb,Rb){var oc=this.Va;const Jc=oc.Ec();Jc.buttons.push(oc.pb(54));this.G_b(Jc.buttons,this.Zjc,127,56);Jc.buttons.push(oc.pb(55));Rb&&this.G_b(Jc.buttons,this.Zjc,126,125);Jc.buttons.push(oc.pb(158));Rb=this.$.xa.oa;S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.LK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
Rb&&Rb.Gd&&(Rb.Gd.Hv||Rb.Gd.fI||Jc.buttons.push(oc.pb(299)));this.$.ea.iNb&&(S.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?n.AFrameworkApplication.Zsd(Qc.a):this.$.va.ExcelSheetProtectionSettingsEnabled)&&(Rb=Object(Tb.a)(bc.a,this.$.oa))&&na.p(Rb)&&this.$.isEditMode&&(Jc.buttons.push(oc.pb(277)),Rb.isLockPausedInSession?Jc.buttons.push(oc.pb(279)):Rb.ji&&Jc.buttons.push(oc.pb(278)));Rb=oc.tw("ContextMenu.TabColor",null,X.a.instance.ga(518),1841703919);
oc=oc.E5c(467002767,1549407384,541,-221093529,this.QB);Rb.menu.tc.push(oc);Jc.buttons.push(Rb);pb.tc.push(Jc)}QKh(pb){const Rb=this.Va.Ec();this.G_b(Rb.buttons,this.Zjc,114,112);this.G_b(Rb.buttons,!this.vic,115,113);pb.tc.push(Rb)}SLh(pb){if(S.EwaSettings.ma(474)&&!na.e(this.$.xa.oa)){var Rb=this.Va,oc=Rb.Ec();oc.buttons.push(Rb.pb(263));pb.tc.push(oc)}}xZj(){let pb,Rb;({q5c:pb,UGe:Rb}=this.$.p5c());this.Zjc=1===pb;this.vic=0<Rb}}Object(c.a)(ce,"SheetOpsContextMenu",y.a,[]);var ke=a(519);class Oe extends y.a{constructor(pb,
Rb,oc,Jc){super(pb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Rb,oc,!0,Jc)}get Yw(){return"PopulateSlicerContextMenu"}get QB(){return t.a.lRf}nc(pb,Rb){var oc=!0;switch(Rb){case -231711729:oc=!1;break;case -1909381757:oc=this.Ldc();oc=!!oc&&oc.Hmi;break;case 1312363469:oc=!0}return!oc||super.nc(pb,Rb)}executeCommand(pb,Rb,oc){if(!this.$.isEditMode)return D.TaskExtensions.iba();pb=Rb.command;Rb=this.Ldc();let Jc=null;switch(pb){case 2108047455:Rb&&
Rb.qDe();break;case -231711729:d.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Rb&&Rb.q4b();break;case 1312363469:this.showSlicerContextMenu(oc);break;default:Jc=ja.a(pb)}return Jc||D.TaskExtensions.iba()}wc(pb,Rb,oc){pb=!1;switch(Rb.command){case -231711729:case 2108047455:case -1909381757:pb=!0;break;case 1312363469:pb=!!oc}return pb}kZ(){const pb=this.Va.fq(this.menuId);var Rb=this.Va.Ec();Rb.buttons.push(this.Va.pb(252));Rb.buttons.push(this.Va.pb(253));
Rb.buttons.push(this.Va.pb(254));pb.tc.push(Rb);Rb=this.Va.Ec();this.nsi()?Rb.buttons.push(this.Va.pb(266)):Rb.buttons.push(this.Va.pb(267));pb.tc.push(Rb);return pb}nsi(){if(Va.a.fd(this.$)){var pb=this.$.da.Aa(439);if(pb)return pb.ns}else if(pb=this.$.da.Aa(371))return pb.ns;return!1}showSlicerContextMenu(pb){var Rb=Object(Tb.a)(wa.a,pb.eventArgs);pb=this.lcc(Object(Tb.a)(wa.a,pb.eventArgs));Rb=Rb.tb;C.a.Db=Rb;this.Sp(pb,!1,Rb)}B_e(pb){const Rb=this.Va.Ec(),oc=this.Va.Ec();oc.buttons.push(this.Va.pb(255));
oc.buttons.push(this.Va.pb(256));const Jc=this.Va.H5c("ContextMenu.SlicerSort",null,X.a.instance.ga(2173),-814639094,0,jb.a.CTe);Jc.menu.tc.push(oc);Rb.buttons.push(Jc);pb.tc.push(Rb)}TDj(pb){return S.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&pb.Gb.className===jb.a.Oad||S.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===pb.tb}lcc(pb){var Rb=N.h(this.$).ha.Sa.$b;let oc=pb&&1!==pb.tb&&pb.clientPoint?
pb.clientPoint:Sys.UI.DomElement.getLocation(Rb.domElement);if(this.TDj(pb)){var Jc=this.Ldc();Jc&&(pb.Gb.className===jb.a.Oad&&(oc=Jb.HelperMethods.Lwb(pb.Ca)),1===pb.tb&&(oc=da.a(this.$).eka(vb.DOMElementExtensions.getLocation(Jc.frame))))}else if(pb=this.Ldc())pb=this.rUh(pb.frame),(Jc=Jb.HelperMethods.sD(this.$.wf,this.$.domElement,N.h(this.$).rtl,!1))?(pb.x=da.a(this.$).yi(pb.x-Jc.x)+Jc.x,pb.y=da.a(this.$).yi(pb.y-Jc.y)+Jc.y):d.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),
oc.y+=pb.y,oc.x+=pb.x;pb=this.$.domElement;Jc=N.h(this.$).rtl;Rb=Jb.HelperMethods.sD(Rb.pg.domElement,pb,Jc);oc.y=Math.max(oc.y,Rb.y);oc.x=Math.max(oc.x,Rb.x);return oc}Ldc(){const pb=N.h(this.$).ha.Sa.$b;d.ULS.shipAssertTag(537166988,0,!!pb);return ke.a(this.$).OH(pb.floatingObject.id)}rUh(pb){let Rb=new Sys.UI.Point(pb.offsetParent.offsetLeft,pb.offsetParent.offsetTop);var oc=N.h(this.$);if(!oc)return Rb;const Jc=N.h(this.$).rtl;Rb=Jb.HelperMethods.sD(pb,this.$.vr.ownerDocument.body,Jc);oc.NGe(Rb);
Rb.x=Jc?this.$.vr.clientWidth-Rb.x-pb.clientWidth:Rb.x;pb=oc.view.qqb;oc=Jc?-oc.lS.Hca(pb.x):pb.x;Rb.x-=oc;Rb.y-=pb.y;return Rb}}Object(c.a)(Oe,"SlicerContextMenu",y.a,[]);class Fe{constructor(pb,Rb,oc){this.type=pb;this.F8g=Rb;this.Nr=oc}}Object(c.a)(Fe,"TimeSlicerRibbonButtonParameter",null,[]);class Xe extends y.a{constructor(pb,Rb,oc,Jc){super(pb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Xe.mPj,!0,!1,Xe.mLb,Rb,oc,!1,Jc);this.Z1a=0;this.yOe=this.qLa=this.fta=null}get Yw(){return"PopulateTimeSlicerLevelMenu"}get QB(){return t.a.oRf}executeCommand(pb,
Rb,oc){pb=Rb.command;switch(pb){case 2000085697:pb=oc.DOMElement;this.fta=oc.ChangeLevelCallback;this.qLa=oc.GetLevelLabelCallback;this.Z1a=oc.CurrentLevel;const Jc=oc.DomEvent;Q.g(Jc);const ud=oc.location;oc=oc.levelLabelText;this.yOe=vb.DOMElementExtensions.Gz(document.activeElement,"iframe")&&oc?oc.parentNode:null;oc=Sys.UI.DomElement.getBounds(oc);oc.x=ud.x;oc.y=ud.y;this.a1(Jc,pb,oc,Rb,!0);break;case -649826274:this.fta(0);break;case 149600865:this.fta(1);break;case -2012435159:this.fta(2);break;
case -1979934975:this.fta(3);break;case 1634477200:vb.DOMElementExtensions.setFocus(this.yOe);break;default:return ja.a(pb)}return $a.Task.Ta(!0)}wc(pb,Rb,oc){pb=!1;switch(Rb.command){case 2000085697:pb=!!oc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:pb=!0}return pb}a1(pb,Rb,oc){pb=Sys.UI.DomElement.getBounds(Rb);oc.x=da.a(this.$).yi(oc.x);oc.y=da.a(this.$).yi(oc.y);pb.x=da.a(this.$).yi(pb.x);pb.y=da.a(this.$).yi(pb.y);pb=new Sys.UI.Point(pb.x+oc.x,pb.y+
oc.y);this.showContextMenu(new Sys.UI.Bounds(pb.x,pb.y-oc.height,oc.width,oc.height))}kZ(){const pb=this.Va,Rb=pb.fq(this.menuId),oc=pb.Ec();for(let ud=0;3>=ud;ud++){const Fb=this.qLa(ud);var Jc=Xe.KOh(ud);Jc=pb.L$g(Jc.F8g,Jc.Nr,this.Z1a===ud,Xe.sCe);Jc.label=Fb;Jc.pS(Fb);this.Z1a===ud?Jc.rS("Image16by16",8,Xe.sCe):Jc.i4b();oc.buttons.push(Jc)}Rb.tc.push(oc);return Rb}static KOh(pb){let Rb=null;switch(pb){case 0:Rb=new Fe(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Rb=new Fe(88,
"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Rb=new Fe(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:Rb=new Fe(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Rb}}Xe.mPj=t.a.J8g;Xe.mLb="TimeSlicerLevelMenuRootName";Xe.sCe=jb.a.Wua;Object(c.a)(Xe,"TimeSlicerLevelMenu",y.a,[]);var pf=a(319),Ae=a(3);class Ie extends b.a{constructor(pb){super(pb)}ld(){const pb=this.$,Rb=Ka.a.S1a(Aa.b(),this.ka,"Task","IRootUser"),oc=e.a(pb);let Jc=null;Jc=(pa,tb)=>{oc.UVf(Jc);
Rb.setResult(tb.A5b)};oc.Nre(Jc);oc.u5e();const ud=V.GetServiceTaskFactory.create(pb.da,102,pb.ka,this.Ya),Fb=V.GetServiceTaskFactory.Oa(pb.da,342,338,this.Ya);D.TaskExtensions.za(D.TaskExtensions.Ed([Rb.task,ud,Fb],this.ka),()=>{const pa=ud.result,tb=Rb.task.result,Nb=Fb.result;this.Zc([new dc(pb,tb,pa,Nb),new sa(pb,tb,pa,Nb),new Bc(pb,tb,pa,Nb),new Qb(pb,tb,pa,Nb),new Rc(pb,tb,pa,Nb),new ob(pb,tb,pa,Nb),new Fd.GridContextMenu(pb,tb,pa,Nb),new Nd(pb,tb,pa,Nb),new ce(pb,tb,pa,Nb),new Xe(pb,tb,pa,
Nb),new id(pb,tb,pa,Nb),new ta(pb,tb,pa,Nb),new Ya(pb,tb,pa,Nb),new Oe(pb,tb,pa,Nb),new Zd(pb,tb,pa,Nb)])},pb.ka,3)}static initData(){const pb=pf.a.V9;pb(2000085697,20479,0,0);pb(-227942804,Ae.a.lc|24576,0,0);pb(1634477200,Ae.a.lc|131072,0,0);pb(-649826274,4095,0,0);pb(149600865,4095,0,0);pb(-2012435159,4095,0,0);pb(-1979934975,4095,0,0);pb(1247109494,Ae.a.lc|24576,0,0);pb(-2064931494,Ae.a.lc|131072,0,0);pb(-1396319072,Ae.a.Ha,128,0);pb(-425234874,Ae.a.Ha,128,0);pb(-1253126584,Ae.a.Ha,0,0);pb(274207288,
Ae.a.lc|24576,0,0);pb(-1497523576,Ae.a.lc|131072,0,0);pb(-498523270,Ae.a.lc|24576,64,0);pb(1640762262,Ae.a.lc|131072,64,0);pb(-2017893763,Ae.a.lc|24576,0,0);pb(1350204367,Ae.a.lc|131072,0,0);pb(-889576107,Ae.a.qw,128,0);pb(-1170196828,Ae.a.qw,128,0);pb(389774337,Ae.a.qw,128,0);pb(1529312473,Ae.a.qw,128,0);pb(2033235475,Ae.a.qw,128,0);pb(-96230454,Ae.a.qw,128,0);pb(74086617,Ae.a.qw,128,0);pb(563292088,Ae.a.qw,128,0);pb(-1092351914,Ae.a.qw,128,0);pb(-2141589616,Ae.a.qw|16384,128,0);pb(745182485,Ae.a.qw,
0,0);pb(359279088,Ae.a.qw,128,0);pb(-67292059,Ae.a.qw,128,0);pb(926905850,Ae.a.qw,128,0);pb(547535945,Ae.a.qw,128,0);pb(1374696078,Ae.a.lc|24576,0,0);pb(495005930,Ae.a.lc|212992,0,0);pb(-1045020714,Ae.a.lc|24576,0,0);pb(-170383950,Ae.a.lc|212992,0,0);pb(324156914,Ae.a.Ha,0,0);pb(-1085236154,Ae.a.qv,0,0);pb(-751848458,Ae.a.Cl|16384,0,0);pb(216058793,Ae.a.qv,0,0);pb(474690375,Ae.a.Cl|16384,0,0);pb(-1920954846,Ae.a.lc|24576,0,0);pb(723126814,Ae.a.lc|131072,0,0);pb(2108047455,128,128,0);pb(-231711729,
128,128,0);pb(-1909381757,128,128,0);pb(-814639094,128,128,0);pb(1701016594,Ae.a.lc|3072,128,0);pb(-1475408662,Ae.a.lc|24576,0,0);pb(1114549926,Ae.a.lc|131072,32,0)}static la(pb){b.a.Nd(10,new Ie(pb))}}Object(c.a)(Ie,"ContextMenuCommandHandlerFactory",b.a,[]);var Hf=a(222),xe=a(1400),Ze=a(93),nf=a(190);class hf{constructor(pb,Rb){this.nsb=Rb;this.$=pb}dispose(){}maa(){this.nsb.a4()}kD(){this.nsb.kD()}gVd(pb,Rb,oc){Ma.i(this.$,Ma.b);this.nsb.showContextMenu(Object(f.a)(new xe.a,{x:Rb.x,y:Rb.y}),oc,
pb);Ze.EventHandlerManager.instance.Ldd()}Rzc(pb,Rb,oc){Ma.i(this.$,Ma.b);this.nsb.showFloatie(Object(f.a)(new xe.a,{x:Rb.x,y:Rb.y}),pb,oc);nf.a(()=>{Ze.EventHandlerManager.instance.Ldd()},this.$.ka)}fVd(pb,Rb,oc,Jc){Ma.i(this.$,Ma.b);this.nsb.fVd(Object(f.a)(new xe.a,{x:Rb.x,y:Rb.y}),pb,oc,Jc)}}Object(c.a)(hf,"ReactContextMenuController",null,[224,2]);class bb extends Hf.a{constructor(pb){super();this.lef=!1;this.Tnd=()=>{let Rb;(Rb=this.$.da.Aa(342))?this.nb(Rb):this.$.ky(oc=>{oc.ogc().then(Jc=>
{(Rb=this.$.da.Aa(342))?this.nb(Rb):(Rb=new hf(this.$,Jc),this.nb(this.$.da.Ga(342,Rb)))})})};this.$=pb;this.Fb()}dispose(){this.lef&&this.$&&this.$.ea.jo(this.Tnd);super.dispose()}create(){this.$.ea.tg?(d.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.tg}`),this.Tnd(null,null)):(this.lef=!0,this.$.ea.Xk(this.Tnd))}static la(pb){pb.da.Ga(338,new bb(pb))}}Object(c.a)(bb,"ContextMenuControllerFactory",Hf.a,[]);var Lb=
a(156);class nc{constructor(){this.dictionary=this.Wd=null}}Object(c.a)(nc,"RibbonCommandParams",null,[]);class Lc{constructor(){this.menuModel=null;this.EJe=0}}Object(c.a)(Lc,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class od{constructor(){this.jfc={}}XOh(pb){return(pb=this.jfc[pb.toString()])?pb.menuModel:null}wZg(pb,Rb){this.jfc[Rb.toString()]=Object(f.a)(new Lc,{menuModel:pb,EJe:Jb.HelperMethods.Tb()})}c9b(pb){this.jfc[pb.toString()]=null}w3h(pb){return(pb=this.jfc[pb.toString()])?pb.EJe:
-1}}Object(c.a)(od,"FilterMenuCache",null,[]);var wd=a(14),Pd=a(178),je=a(224);class be{constructor(){this.Ad=this.cxe=this.cell=null}}Object(c.a)(be,"AutoFilterEventRegistrationArgs",null,[]);class Qe{constructor(pb){this.L_a=null;this.wUd=!1;this.pDb=0;this.nad=1;this.OQe=0;this.oGb=Rb=>{this.HPf(Rb.domElement,Rb.hashCode)};this.uTf=Rb=>{let oc=0;for(;window.performance.now()-Rb<this.Osh&&0<this.L_a.length;)this.Wpe(this.L_a.shift()),oc++;d.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.nad}, Events Registered in this frame: ${oc}, Events in queue: ${this.L_a.length}`);
0<this.L_a.length?this.pDb=window.requestAnimationFrame(this.uTf):(Rb=window.performance.now()-this.OQe,d.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.nad}, Total time in MS: ${Rb}`),this.nad++,this.pDb=0)};this.onPointerDown=Rb=>{He.a.slim(Rb.Ca.rawEvent);return!1};this.$=pb;this.gridView=N.h(this.$);this.wdi();this.Osh=this.$.va.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.pDb);this.gridView&&
this.gridView.Ouc(this.oGb);this.gridView=null}wdi(){if(this.wUd=Jb.HelperMethods.W7a)this.L_a=[];this.NIg();this.gridView.c0b(this.oGb)}NIg(){for(const pb of this.gridView.Mn){const Rb=pb.OCa;for(let oc in Rb){const Jc=Rb[oc];this.HPf(Jc.domElement,Jc.hashCode)}}}HPf(pb,Rb){if(N.h(this.$).Da.Dm.E2a(Rb))if(pb){pb=pb.querySelectorAll('[id^="'+t.a.zcd+'"]');for(let ud=0;ud<pb.length;ud++){var oc=pb[ud],Jc=oc.getAttribute(t.a.uFh);const Fb=oc.getAttribute(t.a.nFh);d.ULS.shipAssertTag(537167053,0,!!Jc&&
!!Fb,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${oc.id}, BlockHash: ${Rb}`);Jc=mc.Range.Qc(parseInt(Jc,10),parseInt(Fb,10));oc=Object(f.a)(new be,{cell:Jc,cxe:oc,Ad:Rb});this.wUd?(this.L_a.push(oc),this.pDb||(this.OQe=window.performance.now(),this.pDb=window.requestAnimationFrame(this.uTf))):this.Wpe(oc)}}else d.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${Rb}`);
else d.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${Rb}`)}Wpe(pb){const Rb=this.gridView.Da.tLa(pb.cell,pb.Ad);Rb?this.MIg(pb.cxe,Rb):d.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${pb.Ad}, AutoFilter Cell: ${pb.cell}`)}MIg(pb,Rb){Rb.hasAutoFilter?this.KGg(pb,
Rb.uvb):Rb.Y4?this.KIg(pb,Rb.uvb,Rb.isd):d.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Lb.a.instance.sa(wd.a.vf,pb,this.onPointerDown);Pd.a.instance.sa(wd.a.Oya,pb,this.onPointerDown)}KGg(pb,Rb){je.a.instance.sa(wd.a.click,pb,oc=>{Rb&&He.a.hrc(oc.Ca.rawEvent,966232027,Rb,null);return!0})}KIg(pb,Rb,oc){const Jc=B.a.ki(Rb);je.a.instance.sa(wd.a.click,pb,ud=>{oc?He.a.spf(document.getElementById(Jc.EwaElementId),
Jc.Cell,Jc.DataSourceIndex,Jc.FieldId,Jc.IsOlap,Jc.RequiresConfirmation,ud.Ca.rawEvent,Jc.OptionalPivotMenuAnchor):He.a.spfm(ud.Ca.rawEvent,Jc.RequiresConfirmation,Jc.Cell,Jc.DataSourceIndex,Jc.PivotName,Jc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(Qe,"FilterMenuPointerEventsManager",null,[2]);class jc{constructor(pb){this.uXe=null;this.$=pb;this.U9a=new od;S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.uXe=new Qe(this.$))}dispose(){S.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.uXe.dispose();this.$=null}fVh(pb){const Rb=N.h(this.$).Da.y$(pb,this.$.activeItemName);return Rb&&Rb.blockPresentInViewportTimeStamp>this.U9a.w3h(pb.left)?Rb.us(pb).autoFilterMenu:this.U9a.XOh(pb.left)}gSi(pb,Rb,oc){this.U9a&&this.U9a.wZg(pb.menuModel[Rb],oc)}hSi(pb){this.U9a&&this.U9a.c9b(pb)}}Object(c.a)(jc,"FilterMenuManager",
null,[225,2]);var Tc=a(205),ub=a(168);class Vb{constructor(pb,Rb,oc){this.oAc={};this.Dd=!1;this.$l=(Jc,ud=null)=>{this.showContextMenu(ud)};this.aBf=(Jc,ud)=>{ud.HFi===Vb.m6h&&N.h(this.$).focus()};this.ZN=(Jc,ud)=>{Jc=this.$.Ja.Waa(ud.Wd.command);(null===Jc||void 0===Jc?0:Jc.dismissesContextualUI)&&this.a4()};this.BR=()=>{this.$.da.GU(342);D.TaskExtensions.za(V.GetServiceTaskFactory.create(this.$.da,338,this.$.ka,3),Jc=>{Jc=Jc.result;for(let ud of this.oAc)ud.cTf(Jc)},this.$.ka)};this.$=pb;this.contextMenuController=
oc;this.c$d=new jc(this.$);pb.da.Ga(8,this);for(oc=0;oc<Rb.length;oc++)this.oAc[Vb.K8g[oc]]=Rb[oc];this.ha=N.h(pb).ha;this.ha.W_b(this.$l);this.$.Ja.KZa(this.aBf);Lb.a.instance.Kyj();S.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ja.osa(this.ZN);S.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.IY(this.BR)}get nac(){return this.c$d}Nfd(pb){return U.a.Dc(this.oAc,pb)}dispose(){this.Dd?
d.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Dd=!0,this.$&&(this.$.Kl(Vb.ed),this.$.da.GU(8),this.ha&&this.ha.Guc(this.$l),this.$.Ja.jKb(this.aBf),S.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ja&&this.$.Ja.yAa(this.ZN),S.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.B0(this.BR)),this.$=this.ha=null,this.nac.dispose(),
this.oAc=this.c$d=null)}showContextMenu(pb,Rb=null,oc=null){this.yDj(pb)&&(Ma.i(this.$,Ma.j),pb=this.Yah(pb,Rb,oc),this.$.Ja.Lb(pb.Wd,pb.dictionary))}a4(){this.contextMenuController?this.contextMenuController.maa():d.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}yDj(pb){return Zc.a(this.$).oq()?(d.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Zc.a(this.$).GW(ub.a.grid,Tc.a.showContextMenu),!1):!this.$.Ja.bDh&&(!pb||pb.Gb!==N.h(this.$).domElement&&!qe.a.equals(pb.Gb.tagName,"INPUT",!0))}Yah(pb,Rb=null,oc=null){oc={["eventArgs"]:pb,["creationParams"]:oc};pb=pb?pb.tb:-1;const Jc=this.ha.Sa.$b;let ud=1441131127;Jc?(Rb=Jc.floatingObject,d.ULS.shipAssertTag(537167059,0,!!Rb,"floatingObj shouldn't be null."),Vb.std(Rb)?ud=1312363469:Vb.isPivotChart(Rb)?(oc[sa.V1c]=Rb?Rb.Vc:null,ud=-149612405):ud=-1372040782):Vb.Jkf(Rb)?(oc[sa.V1c]=Rb,ud=-149612405):
!Ma.h(this.$)&&Ma.f(N.h(this.$))&&(ud=671488277);Rb=new M.a(ud,pb,this.$.Hc,30,null);return Object(f.a)(new nc,{Wd:Rb,dictionary:oc})}static la(pb){pb.ll(Vb.ed)}static isPivotChart(pb){return!!pb&&0===pb.type&&Vb.Jkf(pb.Vc)}static std(pb){return!!pb&&2===pb.type}static Jkf(pb){return!!pb&&!!(pb.Attributes&4)}}Vb.K8g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Vb.m6h="GridContextMenu";Vb.ed=pb=>{(pb=Object(Tb.a)(7,pb))&&V.GetServiceTaskFactory.create(pb.da,9,pb.ka,0)};Object(c.a)(Vb,"ContextMenuManager",null,[201,2]);class tc extends Hf.a{constructor(pb){super();this.$=pb;this.Fb()}create(){const pb=this.$,Rb=pb.dc;if(Rb.allowSelection||Rb.allowEdits||Rb.allowFiltering||Rb.allowSorting||Rb.allowPivotSpecificOperations){const oc=V.GetServiceTaskFactory.create(pb.da,10,pb.ka,this.Ya),Jc=V.GetServiceTaskFactory.Oa(pb.da,342,338,this.Ya);D.TaskExtensions.za(D.TaskExtensions.Ed([oc,
Jc],this.ka),()=>{this.nb(v.a(pb)||new Vb(pb,oc.result,Jc.result))},this.$.ka,3)}else d.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),pb.da.GU(8),this.nb(null)}static la(pb){pb.da.Ga(9,new tc(pb))}}Object(c.a)(tc,"ContextMenuManagerFactory",Hf.a,[]);var Sc=a(9);a.d(F,"a",function(){return jd});const jd=()=>{Ie.initData();Sc.a.Fa(pb=>{bb.la(pb);tc.la(pb);Ie.la(pb);Vb.la(pb)})}},1151:function(u,F,a){var c=
a(9);u=a(0);var b=a(694),e=a(15);const f=Fa=>{switch(Fa){case 0:Fa="Between";break;case 1:Fa="NotBetween";break;case 2:Fa="Equal";break;case 3:Fa="NotEqual";break;case 4:Fa="GreaterThan";break;case 5:Fa="LessThan";break;case 6:Fa="GreaterThanOrEqual";break;case 7:Fa="LessThanOrEqual";break;default:Fa="Unknown"}return Fa},d=Fa=>{switch(Fa){case 0:Fa="AnyValue";break;case 1:Fa="WholeNumber";break;case 2:Fa="Decimal";break;case 3:Fa="List";break;case 4:Fa="Date";break;case 5:Fa="Time";break;case 6:Fa=
"TextLength";break;case 7:Fa="Custom";break;default:Fa="Unknown"}return Fa};var h=a(132),n=a(40),m=a(374),x=a(188),r=a(283);class y{constructor(Fa=null){this.s5=Fa?Fa.IsIgnoreBlank:!0;this.t5=Fa?Fa.IsInCellDropDown:!0;this.lO=Fa?Fa.LowerBoundary:"";this.mO=Fa?Fa.UpperBoundary:"";this.SB=Fa?Fa.ConditionType:0;this.ruleType=Fa?Fa.RuleType:0;this.n_=Fa?Fa.IsAlertBlocking:!0;this.WT=Fa?Fa.AlertTitle:"";this.VT=Fa?Fa.AlertMessage:"";this.AV=Fa?Fa.InputMessage:"";this.KF=Fa?Fa.InputTitle:"";this.O5=Fa?
Fa.IsShowErrorAlert:!0;this.P5=Fa?Fa.IsShowInputMessage:!0}isEqual(Fa){return Fa?this.s5===Fa.s5&&this.t5===Fa.t5&&this.lO===Fa.lO&&this.mO===Fa.mO&&this.SB===Fa.SB&&this.ruleType===Fa.ruleType&&this.n_===Fa.n_&&this.WT===Fa.WT&&this.VT===Fa.VT&&this.AV===Fa.AV&&this.KF===Fa.KF&&this.O5===Fa.O5&&this.P5===Fa.P5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(u.a)(y,"DataValidationEditDialogState",null,[]);var t=a(282),v=a(184),w=a(281),
C=a(21),B=a(133),z=a(51),A=a(55);class E{constructor(Fa,oa){this.dC=this.i2a=this.selectedRanges=null;this.dOe=!1;this.ei=null;this.tQi=La=>{e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!La||t.a(La)?e.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.i2a=La.Result,this.y5i())};this.jDh=La=>{this.VW("DataValidationEdit.ExpandExisitngDialog",
La);this.dC.c=E.Gia(La);1===La?this.FIa(new y(this.i2a)):2===La?this.FIa(new y):this.hsf()};this.o0i=La=>{this.VW("DataValidationEdit.OverrideExisitngDialog",La);this.dC.c=E.Gia(La);1===La?this.FIa(new y):this.hsf()};this.$=Fa;this.E7c=oa}nc(){return!1}executeCommand(Fa,oa){-1728432249!==oa.command&&v.a(oa.command);this.selectedRanges=n.r(C.h(this.$).ha.ra.selectedRanges,this.$);C.h(this.$).zTa(!0);this.getDataValidationInitialState();this.ei=this.$.Kb.Bc("UserAction","DataValidationEditTimeToDialogOpen");
this.dOe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.dOe=!0);return A.Task.Ta(!0)}wc(Fa,oa){return-1728432249===oa.command}Kc(){return!1}getDataValidationInitialState(){const Fa=this.$.pa.ya.Wb();m.a(this.$.userOperationManager,(oa,La,Ea)=>r.g(this.$.pa.ya,this.selectedRanges,w.b(oa,this.tQi),w.a(La),Ea,Fa),oa=>new x.a(120,0,oa,16),null)}y5i(){var Fa=
this.dC={};let oa;switch(this.i2a.Command){case 0:oa="CreateNew";break;case 1:oa="CreateNewFromRule";break;case 2:oa="ExpandExisitng";break;case 3:oa="OverrideExisitng";break;default:oa="Unknown"}Fa.a=oa;this.ei&&(this.ei.stop(),this.dC.r=this.ei.id);switch(this.i2a.Command){case 0:this.dC.b=!1;this.dC.c="None";this.FIa(new y);break;case 1:this.dC.b=!1;this.dC.c="None";this.FIa(new y(this.i2a));break;case 2:this.dC.b=!0;this.E7c.U$g(this.$,this.jDh);break;case 3:this.dC.b=!0;this.E7c.W$g(this.$,this.o0i);
break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}FIa(Fa){this.E7c.FIa(this.$,this.selectedRanges,Fa,this.i2a.Command);this.mCi(Fa)}mCi(Fa){E.Mtb(Fa,this.dC);this.dC.d=!0;z.b().Qe(48,this.dC,!0)}hsf(){this.dC.d=!1;z.b().Qe(48,this.dC,!0)}VW(Fa,oa){Fa={["ButtonType"]:E.Gia(oa),["DialogName"]:Fa,["Location"]:"dialog",["NumberOfSelectedRanges"]:C.h(this.$).ha.ra.ZF};B.b(this.$).ud(h.a.W7b,Fa)}static Mtb(Fa,oa){oa.e=d(Fa.ruleType);
oa.f=f(Fa.SB);oa.g=!!Fa.lO;oa.h=!!Fa.mO;oa.i=Fa.s5;oa.j=Fa.t5;oa.k=Fa.P5;oa.l=!!Fa.KF;oa.m=!!Fa.AV;oa.n=Fa.O5;oa.o=Fa.n_;oa.p=!!Fa.WT;oa.q=!!Fa.VT}static Gia(Fa){switch(Fa){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(u.a)(E,"DataValidationEditCommandHandler",null,[208]);var I=a(134),L=a(802),V;(function(Fa){Fa[Fa.between=0]="between";Fa[Fa.notBetween=
1]="notBetween";Fa[Fa.equal=2]="equal";Fa[Fa.notEqual=3]="notEqual";Fa[Fa.greaterThan=4]="greaterThan";Fa[Fa.lessThan=5]="lessThan";Fa[Fa.greaterThanOrEqual=6]="greaterThanOrEqual";Fa[Fa.lessThanOrEqual=7]="lessThanOrEqual"})(V||(V={}));Object(u.b)("DataValidationRuleConditionType",V);var T=a(1085),H=a(146),D=a(186);class G{static get qg(){return H.a.iq(G.ol,"")}static get nlh(){return H.a.iq(G.rlh,D.a.ga(1665),D.a.ga(1680),D.a.ga(1681),D.a.ga(1682),D.a.ga(1683),D.a.ga(1684),D.a.ga(1685),D.a.ga(1686),
D.a.ga(1687),D.a.ga(1666),D.a.ga(1690),D.a.ga(1691),D.a.ga(1692),D.a.ga(1693),D.a.ga(1694),D.a.ga(1695),D.a.ga(1696),D.a.ga(1697),D.a.ga(1667),D.a.ga(1668),D.a.ga(1688),D.a.ga(1689),D.a.ga(1679),"255")}static get ulh(){return H.a.iq(G.slh,D.a.ga(1702),D.a.ga(1706),D.a.ga(1707),"255","32")}static get ylh(){return H.a.iq(G.tlh,D.a.ga(1701),D.a.ga(1704),D.a.ga(1703),D.a.ga(1705),D.a.ga(1706),D.a.ga(1707),"255","32")}}G.odg=255;G.ol="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";
G.rlh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
G.slh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
G.tlh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(u.a)(G,"DataValidationEditDialogHtml",null,[]);var J=a(85),M=a(555),Q=a(14),U=a(187),Z=a(238),P=a(12),S=a(13);class ja extends Z.a{constructor(Fa,oa,La){super(oa);this.uFd=this.Yqc=this.gQa=this.Eab=this.AOa=this.z6a=this.Bza=this.Aza=this.jL=this.XT=this.ggc=this.Swa=null;this.VGh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.arj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,
1],[12,12]];this.xpc=Ea=>{let ca=!1;(null===Ea||void 0===Ea?0:Ea.Ca)&&(Ea.Ca.keyCode===J.a.bfa||Ea.Ca.keyCode===J.a.Mh)&&(ca=this.Vca(Ea),this.XT.blur(),this.jL.blur());return ca};this.Vca=()=>{const Ea=this.XT.selectedIndex,ca=this.jL.selectedIndex;this.Yqc.innerText=this.bxb(Ea,ca);this.uFd.innerText=this.Sid(Ea,ca);switch(Ea){case 0:return this.jL.disabled=!0,P.DOMElementExtensions.setVisible(this.Eab,!1),P.DOMElementExtensions.setVisible(this.gQa,!1),P.DOMElementExtensions.setVisible(this.z6a,
!1),P.DOMElementExtensions.setVisible(this.AOa,!1),this.Swa.disabled=!0,!1;case 3:return this.jL.disabled=!0,P.DOMElementExtensions.setVisible(this.Eab,!0),P.DOMElementExtensions.setVisible(this.gQa,!1),P.DOMElementExtensions.setVisible(this.z6a,!0),P.DOMElementExtensions.setVisible(this.AOa,!0),this.Swa.disabled=!1;case 7:return this.jL.disabled=!0,P.DOMElementExtensions.setVisible(this.Eab,!0),P.DOMElementExtensions.setVisible(this.gQa,!1),P.DOMElementExtensions.setVisible(this.z6a,!1),P.DOMElementExtensions.setVisible(this.AOa,
!1),this.Swa.disabled=!1;default:this.Swa.disabled=!1,P.DOMElementExtensions.setVisible(this.Eab,!0),P.DOMElementExtensions.setVisible(this.AOa,!1)}switch(ca){case 0:case 1:P.DOMElementExtensions.setVisible(this.gQa,!0);break;default:P.DOMElementExtensions.setVisible(this.gQa,!1)}this.jL.disabled=!1;this.Yqc.disabled=!1;P.DOMElementExtensions.setVisible(this.z6a,!1);P.DOMElementExtensions.setVisible(this.AOa,!1);return!1};this.get_visible=this.nka;this.set_visible=this.eoa;this.oR=new U.a;this.oR.add(S.a.instance.ga(1667));
this.oR.add(S.a.instance.ga(1668));this.oR.add(S.a.instance.ga(1671));this.oR.add(S.a.instance.ga(1669));this.oR.add(S.a.instance.ga(1670));this.oR.add(S.a.instance.ga(1672));this.oR.add(S.a.instance.ga(1673));this.oR.add(S.a.instance.ga(1674));this.oR.add(S.a.instance.ga(1675));this.oR.add(S.a.instance.ga(1676));this.oR.add(S.a.instance.ga(1677));this.oR.add(S.a.instance.ga(1678));this.oR.add("");this.$=Fa;this.Sk=La;this.Jka()}get title(){return S.a.instance.ga(1698)}get f7g(){return this.XT.selectedIndex}eBa(Fa){this.XT.selectedIndex=
Fa.ruleType;this.jL.selectedIndex=Fa.SB;this.ggc.checked=Fa.t5;this.Swa.checked=Fa.s5;this.Aza.value=Fa.lO;this.Bza.value=Fa.mO;this.Vca(null)}Iqb(Fa){Fa.s5=this.Swa.checked;Fa.t5=this.ggc.checked;Fa.SB=this.jL.selectedIndex;Fa.ruleType=this.XT.selectedIndex;Fa.lO=this.Aza.value;Fa.mO=this.Bza.value}dispose(){this.gk();this.Sk=this.uFd=this.Yqc=this.gQa=this.Eab=this.AOa=this.z6a=this.ggc=this.Bza=this.Aza=this.jL=this.XT=this.Swa=null;super.dispose()}render(Fa){Fa.appendChild(this.domElement)}nka(){return this.isVisible}eoa(Fa){return this.isVisible=
Fa}setFocus(){}bxb(Fa,oa){return this.p5e(Fa,oa,this.VGh)}Sid(Fa,oa){return 0!==oa&&1!==oa?"":this.p5e(Fa,oa,this.arj)}Jka(){this.domElement.innerHTML=G.nlh;this.Swa=P.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.XT=P.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.jL=P.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Aza=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");
this.Bza=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Yqc=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.uFd=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.z6a=P.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.AOa=P.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.Eab=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");
this.gQa=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.ggc=P.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Nj()}p5e(Fa,oa,La){return La.length<Fa||La[Fa].length<oa?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${Fa} operatorOption=${oa}, cannot get label.`),""):this.oR.na(La[Fa][oa])}Nj(){M.a.instance.sa(Q.a.Pb,this.XT,this.xpc);M.a.instance.sa(Q.a.Pb,this.jL,
this.xpc);M.a.instance.sa(Q.a.change,this.XT,this.Vca);M.a.instance.sa(Q.a.change,this.jL,this.Vca);M.a.instance.sa(Q.a.change,this.jL,this.Sk);M.a.instance.sa(Q.a.change,this.XT,this.Sk);M.a.instance.sa(Q.a.change,this.Aza,this.Sk);M.a.instance.sa(Q.a.Pb,this.Aza,this.Sk);M.a.instance.sa(Q.a.change,this.Bza,this.Sk);M.a.instance.sa(Q.a.Pb,this.Bza,this.Sk)}gk(){M.a.instance.Ba(Q.a.Pb,this.XT,this.xpc);M.a.instance.Ba(Q.a.Pb,this.jL,this.xpc);M.a.instance.Ba(Q.a.change,this.XT,this.Vca);M.a.instance.Ba(Q.a.change,
this.jL,this.Vca);M.a.instance.Ba(Q.a.change,this.jL,this.Sk);M.a.instance.Ba(Q.a.change,this.XT,this.Sk);M.a.instance.Ba(Q.a.change,this.Aza,this.Sk);M.a.instance.Ba(Q.a.Pb,this.Aza,this.Sk);M.a.instance.Ba(Q.a.change,this.Bza,this.Sk);M.a.instance.Ba(Q.a.Pb,this.Bza,this.Sk)}static Kja(){let Fa;return Fa=new U.a,Fa.add("operatorInputId1"),Fa.add("operatorInputId2"),Fa}}Object(u.a)(ja,"DataValidationEditConditionsControl",Z.a,[257,2,260]);var X=a(60);const Y=(Fa,oa,La,Ea,ca,$a,Qa,Va=null)=>{Va=Fa.Na(9,
Va);Va.selectedRanges=oa;Va.ruleOptions=La;return X.g(Fa,"CreateOrEditDataValidation",Va,Ea,ca,$a,Qa,0)};var va=a(29),N=a(22),ea=a(175);class Ca extends L.a{constructor(Fa,oa,La,Ea){super(Fa);this.iQd=this.Fvb=null;this.dOa=this.disposed=this.$ka=!1;this.ei=null;this.h1j=(ca,$a)=>{let Qa;this.tcc(ca);if(({errorString:ca,Nq:Qa}=this.l2d()).returnValue)return this.OMa(121,this.ARh(this.$,$a),0,this.Sba,!1),"";this.Ola("OkInvalidByClient",Qa);return ca};this.D7c=ca=>{this.VW(ca);this.ei=this.$.Kb.Bc("UserAction",
"DataValidationEditTimeToDialogTryClose");0===ca&&this.tma()};this.selectedRanges=oa;this.MTb=La;this.command=Ea;3===Ea&&(this.$ka=!0);this.Rb=2;this.$v=!1}get yd(){return this.MTb}get qc(){return"DataValidationEditDialog"}SVd(){var Fa={["RuleType"]:this.yd.ruleType,["RuleOperatorType"]:this.yd.SB,["OperatorInput1"]:this.yd.lO,["OperatorInput2"]:this.yd.mO,["IsIgnoreBlank"]:this.yd.s5,["IsInCellDropDown"]:this.yd.t5,["IsAlertBlocking"]:this.yd.n_,["AlertTitle"]:this.yd.WT,["AlertMessage"]:this.yd.VT,
["InputTitle"]:this.yd.KF,["InputMessage"]:this.yd.AV,["IsShowErrorAlert"]:this.yd.O5,["IsShowInputMessage"]:this.yd.P5};this.pc(2,S.a.instance.ga(1664));Fa={[Ca.vu]:this.qc,["validateDialogValues"]:this.h1j,["RangePickerController"]:C.h(this.$).yf.Oxb(),["isModal"]:!1,["bodyProps"]:Fa};this.initializeAndShow(S.a.instance.ga(1663),this.D7c,Fa);e.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get C3b(){return 3===
this.yd.ruleType}Kja(){return ja.Kja()}ARh(Fa,oa){return(La,Ea,ca)=>{const $a=Fa.pa.ya.Wb();return Y(this.$.pa.ya,this.selectedRanges,this.CXg(),this.L0a(La,this.SCd(oa)),w.a(Ea),ca,$a)}}SCd(Fa){return oa=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let La;t.a(oa)?(e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${oa?va.a.sc(oa.Errors):null}.`),oa.Errors&&1===oa.Errors.length&&
((La=this.Zfd(oa.Errors[0].MessageId))?this.Ola("OkInvalidByServer",oa.Errors[0].MessageIdName):(this.Ola("OkValid","None"),this.hide()),Fa(La)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${va.a.sc(oa.Errors)}`)):this.hide()}}CXg(){const Fa={};Fa.Command=this.command;Fa.RuleType=this.yd.ruleType;Fa.ConditionType=this.yd.SB;Fa.IsIgnoreBlank=this.yd.s5;Fa.IsInCellDropDown=this.yd.t5;Fa.LowerBoundary=this.yd.lO;Fa.UpperBoundary=
this.yd.mO;Fa.IsAlertBlocking=this.yd.n_;Fa.IsShowErrorAlert=this.yd.O5;Fa.IsShowInputMessage=this.yd.P5;Fa.AlertTitle=this.yd.WT;Fa.AlertMessage=this.yd.VT;Fa.InputTitle=this.yd.KF;Fa.InputMessage=this.yd.AV;Fa.ShouldIgnoreFormulaError=this.dOa;return Fa}Zfd(Fa){switch(Fa){case 1173235830:return S.a.instance.ga(1713);case 43935303:return S.a.instance.ga(1714);case -1323438439:return S.a.instance.ga(1716);case 2112020473:return S.a.instance.ga(1710);case -219503282:return S.a.instance.ga(1711);case 1689335445:return S.a.instance.ga(1712);
case 2146493810:return S.a.instance.ga(1715);case -2104909922:return String.format(S.a.instance.mb(105),this.Fvb,this.iQd);case -869372599:return String.format(S.a.instance.mb(104),this.Fvb);case -1181828368:return S.a.instance.ga(1718);case -758480861:return S.a.instance.ga(1719);case -13729088:return S.a.instance.ga(1720);case -846654055:return S.a.instance.ga(1721);case 751854001:return S.a.instance.ga(1722);case -453846397:return S.a.instance.ga(1723);case 1102013489:return S.a.instance.ga(1724);
case 835813260:return S.a.instance.ga(1725);case 1577787509:return S.a.instance.ga(1726);case 2083564019:return S.a.instance.ga(1717);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${Fa.toString()}.`)}return null}tma(){this.Ola("Cancel","None")}VW(Fa){e.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===Fa?"Ok":"Cancel"} was clicked.`);Fa={["ButtonType"]:Ca.Gia(Fa),["DialogName"]:this.qc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:C.h(this.$).ha.ra.ZF};B.b(this.$).ud(h.a.W7b,Fa)}Ola(Fa,oa){const La={};Ca.Mtb(this.yd,La);La.o=Fa;La.p=oa;La.n=this.$ka;this.ei&&(this.ei.stop(),La.q=this.ei.id);z.b().Qe(49,La,!0)}tcc(Fa){this.yd.ruleType=Fa.RuleType;this.yd.SB=Fa.RuleOperatorType;this.yd.lO=Fa.OperatorInput1;this.yd.mO=Fa.OperatorInput2;this.yd.n_=Fa.IsAlertBlocking;this.yd.O5=Fa.IsShowErrorAlert;this.yd.WT=Fa.AlertTitle;this.yd.VT=Fa.AlertMessage;this.yd.P5=Fa.IsShowInputMessage;this.yd.KF=Fa.InputTitle;
this.yd.AV=Fa.InputMessage;this.yd.s5=Fa.IsIgnoreBlank;this.yd.t5=Fa.IsInCellDropDown;this.Fvb=Fa.firstOperatorLabel;this.iQd=Fa.secondOperatorLabel}gRb(Fa,oa,La){let Ea,ca;ca=Ea=null;if(!Fa)return La?(Ea=String.format(S.a.instance.mb(105),this.Fvb,this.iQd),ca="DataValidationEditNoMinMaxError"):(Ea=String.format(S.a.instance.mb(104),this.Fvb),ca="DataValidationEditNoValueError"),{returnValue:!1,errorString:Ea,Nq:ca};if(Fa.length>G.odg)return Ea=S.a.instance.ga(1717),{returnValue:!1,errorString:Ea,
Nq:ca};if(ea.d(Fa))return{returnValue:!0,errorString:Ea,Nq:ca};if(1===oa||2===oa||6===oa){if(!N.a.D5(Fa))return Ea=S.a.instance.ga(1710),{returnValue:!1,errorString:Ea,Nq:ca};if(1===oa&&!N.a.isInteger(Fa))return Ea=S.a.instance.ga(1711),{returnValue:!1,errorString:Ea,Nq:ca};if(6===oa){if(!N.a.isInteger(Fa))return Ea=S.a.instance.ga(1711),{returnValue:!1,errorString:Ea,Nq:ca};if(0>parseInt(Fa,10))return Ea=S.a.instance.ga(1712),{returnValue:!1,errorString:Ea,Nq:ca}}}return{returnValue:!0,errorString:Ea,
Nq:ca}}l2d(){let Fa,oa;oa=Fa=null;const La=this.yd.lO,Ea=this.yd.mO,ca=T.a[this.yd.ruleType];var $a=V[this.yd.SB];if(0===ca)return{returnValue:!0,errorString:Fa,Nq:oa};$a=(0===$a||1===$a)&&3!==ca&&7!==ca;return!({errorString:Fa,Nq:oa}=this.gRb(La,ca,$a)).returnValue||$a&&!({errorString:Fa,Nq:oa}=this.gRb(Ea,ca,$a)).returnValue?{returnValue:!1,errorString:Fa,Nq:oa}:$a&&(1===ca||2===ca||6===ca)&&!ea.d(La)&&!ea.d(Ea)&&parseFloat(La)>parseFloat(Ea)?(Fa=S.a.instance.ga(1715),{returnValue:!1,errorString:Fa,
Nq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:Fa,Nq:oa}}static Gia(Fa){switch(Fa){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Mtb(Fa,oa){oa.a=d(Fa.ruleType);oa.b=f(Fa.SB);oa.c=!!Fa.lO;oa.d=!!Fa.mO;oa.e=Fa.s5;oa.f=Fa.t5;oa.g=Fa.P5;oa.h=!!Fa.KF;oa.i=!!Fa.AV;oa.j=Fa.O5;oa.k=Fa.n_;oa.l=!!Fa.WT;oa.m=!!Fa.VT}}Object(u.a)(Ca,
"DataValidationEditDialog",L.a,[]);var la=a(89);L=a(261);class Ra{}Ra.Xhh="DataValidationDialogPanel";Ra.Whh="DataValidationButtonPanel";Ra.Vhh="DataValidationButtonClearAll";Object(u.a)(Ra,"CssClassNames",null,[]);class lb extends Z.a{constructor(Fa,oa){super(Fa);this.xba=this.yba=this.wba=null;this.zpc=()=>{this.wba.checked?(this.yba.disabled=!1,this.xba.disabled=!1):(this.yba.disabled=!0,this.xba.disabled=!0);return!1};this.get_visible=this.nka;this.set_visible=this.eoa;this.Sk=oa;this.Jka()}get title(){return S.a.instance.ga(1700)}render(Fa){Fa.appendChild(this.domElement)}nka(){return this.isVisible}eoa(Fa){return this.isVisible=
Fa}setFocus(){}dispose(){this.gk();this.Sk=this.yba=this.xba=this.wba=null;super.dispose()}Jka(){this.domElement.innerHTML=G.ulh;this.wba=P.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");P.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.yba=P.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.xba=P.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.wba.checked=!0;this.Nj();this.zpc(null)}eBa(Fa){this.yba.value=
void 0===Fa.KF||null===Fa.KF?"":Fa.KF;this.xba.value=void 0===Fa.AV||null===Fa.AV?"":Fa.AV;this.wba.checked=Fa.P5;this.zpc(null)}Iqb(Fa){Fa.KF=this.yba.value;Fa.AV=this.xba.value;Fa.P5=this.wba.checked}Nj(){M.a.instance.sa(Q.a.change,this.wba,this.zpc);M.a.instance.sa(Q.a.change,this.wba,this.Sk);M.a.instance.sa(Q.a.change,this.yba,this.Sk);M.a.instance.sa(Q.a.Pb,this.yba,this.Sk);M.a.instance.sa(Q.a.change,this.xba,this.Sk);M.a.instance.sa(Q.a.Pb,this.xba,this.Sk)}gk(){M.a.instance.Ba(Q.a.change,
this.wba,this.zpc);M.a.instance.Ba(Q.a.change,this.wba,this.Sk);M.a.instance.Ba(Q.a.change,this.yba,this.Sk);M.a.instance.Ba(Q.a.Pb,this.yba,this.Sk);M.a.instance.Ba(Q.a.change,this.xba,this.Sk);M.a.instance.Ba(Q.a.Pb,this.xba,this.Sk)}}Object(u.a)(lb,"DataValidationEditInputControl",Z.a,[257,2,258]);class Aa extends Z.a{constructor(Fa,oa){super(Fa);this.h$=this.i$=this.tVa=this.Aha=this.g$=null;this.ypc=()=>{this.g$.checked?(this.Aha.disabled=!1,this.tVa.disabled=!1,this.i$.disabled=!1,this.h$.disabled=
!1):(this.Aha.disabled=!0,this.tVa.disabled=!0,this.i$.disabled=!0,this.h$.disabled=!0);return!1};this.get_visible=this.nka;this.set_visible=this.eoa;this.Sk=oa;this.Jka()}get title(){return S.a.instance.ga(1699)}render(Fa){Fa.appendChild(this.domElement)}nka(){return this.isVisible}eoa(Fa){return this.isVisible=Fa}setFocus(){}dispose(){this.gk();this.Sk=this.i$=this.h$=this.tVa=this.Aha=this.g$=null;super.dispose()}Jka(){this.domElement.innerHTML=G.ylh;this.g$=P.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.Aha=P.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.tVa=P.DOMElementExtensions.getElementById(this.domElement,"warningId");this.i$=P.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.h$=P.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.g$.checked=!0;this.Aha.checked=!0;this.Nj();this.ypc(null)}eBa(Fa){this.Aha.checked=Fa.n_;this.tVa.checked=!Fa.n_;this.i$.value=void 0===Fa.WT||null===
Fa.WT?"":Fa.WT;this.h$.value=void 0===Fa.VT||null===Fa.VT?"":Fa.VT;this.g$.checked=Fa.O5;this.ypc(null)}Iqb(Fa){Fa.WT=this.i$.value;Fa.VT=this.h$.value;Fa.n_=this.Aha.checked;Fa.O5=this.g$.checked}Nj(){M.a.instance.sa(Q.a.change,this.g$,this.ypc);M.a.instance.sa(Q.a.change,this.g$,this.Sk);M.a.instance.sa(Q.a.change,this.Aha,this.Sk);M.a.instance.sa(Q.a.change,this.tVa,this.Sk);M.a.instance.sa(Q.a.change,this.i$,this.Sk);M.a.instance.sa(Q.a.Pb,this.i$,this.Sk);M.a.instance.sa(Q.a.change,this.h$,this.Sk);
M.a.instance.sa(Q.a.Pb,this.h$,this.Sk)}gk(){M.a.instance.Ba(Q.a.change,this.g$,this.ypc);M.a.instance.Ba(Q.a.change,this.g$,this.Sk);M.a.instance.sa(Q.a.change,this.Aha,this.Sk);M.a.instance.sa(Q.a.change,this.tVa,this.Sk);M.a.instance.Ba(Q.a.change,this.i$,this.Sk);M.a.instance.Ba(Q.a.Pb,this.i$,this.Sk);M.a.instance.Ba(Q.a.change,this.h$,this.Sk);M.a.instance.Ba(Q.a.Pb,this.h$,this.Sk)}}Object(u.a)(Aa,"DataValidationEditMessagesControl",Z.a,[257,2,259]);class da{constructor(Fa,oa){this.options=
this.cellRange=null;this.cellRange=Fa;this.options=oa}}Object(u.a)(da,"MacroRecorderRangeDataValidationChangedPayload",null,[108]);var aa=a(1238);class fa extends L.a{constructor(Fa,oa,La,Ea){super(Fa);this.G3=this.Fgc=this.gnc=this.ZEb=null;this.dOa=this.disposed=this.$ka=!1;this.ei=null;this.SCd=ca=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");
else{if(t.a(ca)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${ca?va.a.sc(ca.Errors):null}.`);if(ca.Errors&&1===ca.Errors.length){const $a=ca.Errors[0].MessageId,Qa=this.Zfd($a);if(Qa){this.jEj($a)?this.tzj(Qa):this.Rr(Qa);this.Ola("OkInvalidByServer",ca.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${va.a.sc(ca.Errors)}`)}this.Ola("OkValid",
"None");this.hide()}};this.D7c=ca=>{this.VW(ca);2!==ca&&(this.ei=this.$.Kb.Bc("UserAction","DataValidationEditTimeToDialogTryClose"));1===ca?this.kab():2===ca?this.eza():this.tma()};this.Vca=()=>{this.JWj();this.dOa?this.kDe():this.UCe();return this.$ka=!1};this.selectedRanges=oa;this.MTb=La;this.command=Ea;3===Ea&&(this.$ka=!0);this.Rb=2;this.$v=!1;this.qg=G.qg}get yd(){return this.MTb}get qc(){return"DataValidationEditDialog"}SVd(){const Fa={["key"]:this.yd};this.initializeAndShow(S.a.instance.ga(1663),
this.D7c,Fa);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.Fgc=this.gnc=this.G3=null,la.a.Ia(this.ZEb),this.ZEb=null,B.b(this.$)&&B.b(this.$).sXd("DataValidationDialogCorellation"),super.dispose(),this.disposed=!0)}get xy(){return()=>{this.VW(1);this.kab()}}Pv(Fa){super.Pv(Fa);this.pc(2,S.a.instance.ga(1664));Fa=this.rK(2);var oa=this.rK(1),La=this.rK(0),Ea=oa.parentNode;Ea.appendChild(Fa);Ea.appendChild(oa);Ea.appendChild(La);
Fa.parentNode.classList.add(Ra.Whh);Fa.classList.add(Ra.Vhh);Fa=document.getElementById("dataValidationTabsId");oa=new ja(this.$,document.createElement("div"),this.Vca);La=new lb(document.createElement("div"),this.Vca);Ea=new Aa(document.createElement("div"),this.Vca);this.ugi(oa,La,Ea);let ca;this.ZEb=new aa.a(Fa,(ca=new U.a,ca.add(oa),ca.add(La),ca.add(Ea),ca));this.ZEb.sWf();this.zQ=document.getElementById("validationErrorMessageId");this.eBa();B.b(this.$)&&B.b(this.$).aXd("DataValidationDialogCorellation")}SI(){super.SI();
document.getElementById(this.li("WACDialogPanel")).classList.add(Ra.Xhh)}get VY(){return!1}get C3b(){return 3===this.G3.f7g}Kja(){return ja.Kja()}pgd(){return"validationErrorMessageId"}ugi(Fa,oa,La){this.G3=Fa;this.Fgc=oa;this.gnc=La}asj(){const Fa={};Fa.IsClearAll=this.$ka;Fa.Command=this.command;Fa.RuleType=this.yd.ruleType;Fa.ConditionType=this.yd.SB;Fa.IsIgnoreBlank=this.yd.s5;Fa.IsInCellDropDown=this.yd.t5;Fa.LowerBoundary=this.yd.lO;Fa.UpperBoundary=this.yd.mO;Fa.IsAlertBlocking=this.yd.n_;
Fa.IsShowErrorAlert=this.yd.O5;Fa.IsShowInputMessage=this.yd.P5;Fa.AlertTitle=this.yd.WT;Fa.AlertMessage=this.yd.VT;Fa.InputTitle=this.yd.KF;Fa.InputMessage=this.yd.AV;Fa.ShouldIgnoreFormulaError=this.dOa;const oa=this.$.pa.ya.Wb(),La=()=>new da(this.selectedRanges,Fa);m.a(this.$.userOperationManager,(Ea,ca,$a)=>Y(this.$.pa.ya,this.selectedRanges,Fa,w.b(Ea,this.SCd),w.a(ca),$a,oa),Ea=>new x.a(121,0,Ea,void 0,La),null)}jEj(Fa){return 1577787509===Fa}tzj(Fa){this.zQ.innerText=Fa;this.OI(this.rK(0));
this.dOa=!0}kDe(){this.dOa=!1;this.zQ.innerText=""}Zfd(Fa){switch(Fa){case 1173235830:return S.a.instance.ga(1713);case 43935303:return S.a.instance.ga(1714);case -1323438439:return S.a.instance.ga(1716);case 2112020473:return S.a.instance.ga(1710);case -219503282:return S.a.instance.ga(1711);case 1689335445:return S.a.instance.ga(1712);case 2146493810:return S.a.instance.ga(1715);case -2104909922:return String.format(S.a.instance.mb(105),this.G3.bxb(this.yd.ruleType,this.yd.SB),this.G3.Sid(this.yd.ruleType,
this.yd.SB));case -869372599:return String.format(S.a.instance.mb(104),this.G3.bxb(this.yd.ruleType,this.yd.SB));case -1181828368:return S.a.instance.ga(1718);case -758480861:return S.a.instance.ga(1719);case -13729088:return S.a.instance.ga(1720);case -846654055:return S.a.instance.ga(1721);case 751854001:return S.a.instance.ga(1722);case -453846397:return S.a.instance.ga(1723);case 1102013489:return S.a.instance.ga(1724);case 835813260:return S.a.instance.ga(1725);case 1577787509:return S.a.instance.ga(1726);
case 2083564019:return S.a.instance.ga(1717);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${Fa.toString()}.`)}return null}kab(){e.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.tcc();let Fa,oa;if(!({errorString:Fa,Nq:oa}=this.l2d()).returnValue)return this.Rr(Fa),this.Ola("OkInvalidByClient",oa),!1;this.asj();return!0}tma(){this.tcc();this.Ola("Cancel","None");this.hide()}eza(){e.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.dOa?this.kDe():this.UCe();this.zlj();this.$ka=!0}VW(Fa){Fa={["ButtonType"]:fa.Gia(Fa),["DialogName"]:this.qc,["Location"]:"dialog",["NumberOfSelectedRanges"]:C.h(this.$).ha.ra.ZF};B.b(this.$).ud(h.a.W7b,Fa)}zlj(){this.MTb=new y;this.eBa()}eBa(){this.gnc.eBa(this.yd);this.Fgc.eBa(this.yd);this.G3.eBa(this.yd)}tcc(){this.G3.Iqb(this.yd);this.gnc.Iqb(this.yd);this.Fgc.Iqb(this.yd)}Ola(Fa,oa){const La={};fa.Mtb(this.yd,La);La.o=Fa;
La.p=oa;La.n=this.$ka;this.ei&&(this.ei.stop(),La.q=this.ei.id);z.b().Qe(49,La,!0)}gRb(Fa,oa){let La,Ea;Ea=La=null;if(!Fa)return oa?(La=String.format(S.a.instance.mb(105),this.G3.bxb(this.yd.ruleType,this.yd.SB),this.G3.Sid(this.yd.ruleType,this.yd.SB)),Ea="DataValidationEditNoMinMaxError"):(La=String.format(S.a.instance.mb(104),this.G3.bxb(this.yd.ruleType,this.yd.SB)),Ea="DataValidationEditNoValueError"),{returnValue:!1,errorString:La,Nq:Ea};if(Fa.length>G.odg)return La=S.a.instance.ga(1717),{returnValue:!1,
errorString:La,Nq:Ea};if(ea.d(Fa))return{returnValue:!0,errorString:La,Nq:Ea};if(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType){if(!N.a.D5(Fa))return La=S.a.instance.ga(1710),{returnValue:!1,errorString:La,Nq:Ea};if(1===this.yd.ruleType&&!N.a.isInteger(Fa))return La=S.a.instance.ga(1711),{returnValue:!1,errorString:La,Nq:Ea};if(6===this.yd.ruleType){if(!N.a.isInteger(Fa))return La=S.a.instance.ga(1711),{returnValue:!1,errorString:La,Nq:Ea};if(0>parseInt(Fa,10))return La=S.a.instance.ga(1712),
{returnValue:!1,errorString:La,Nq:Ea}}}return{returnValue:!0,errorString:La,Nq:Ea}}l2d(){let Fa,oa;oa=Fa=null;if(this.$ka||0===this.yd.ruleType)return{returnValue:!0,errorString:Fa,Nq:oa};const La=(0===this.yd.SB||1===this.yd.SB)&&3!==this.yd.ruleType&&7!==this.yd.ruleType;return!({errorString:Fa,Nq:oa}=this.gRb(this.yd.lO,La)).returnValue||La&&!({errorString:Fa,Nq:oa}=this.gRb(this.yd.mO,La)).returnValue?{returnValue:!1,errorString:Fa,Nq:oa}:La&&(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType)&&
!ea.d(this.yd.lO)&&!ea.d(this.yd.mO)&&parseFloat(this.yd.lO)>parseFloat(this.yd.mO)?(Fa=S.a.instance.ga(1715),{returnValue:!1,errorString:Fa,Nq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:Fa,Nq:oa}}set xy(Fa){super.xy=Fa}static Gia(Fa){switch(Fa){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Mtb(Fa,oa){oa.a=
d(Fa.ruleType);oa.b=f(Fa.SB);oa.c=!!Fa.lO;oa.d=!!Fa.mO;oa.e=Fa.s5;oa.f=Fa.t5;oa.g=Fa.P5;oa.h=!!Fa.KF;oa.i=!!Fa.AV;oa.j=Fa.O5;oa.k=Fa.n_;oa.l=!!Fa.WT;oa.m=!!Fa.VT}}Object(u.a)(fa,"DataValidationEditDialogDeprecated",L.a,[]);var Oa=a(1);class ba{FIa(Fa,oa,La,Ea){Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new Ca(Fa,oa,La,Ea)).SVd():(new fa(Fa,oa,La,Ea)).SVd()}U$g(Fa,oa){const La=new I.StandardDialog;La.Rb=3;La.zBa(Fa.rb.yva,S.a.instance.ga(1708),oa)}W$g(Fa,
oa){const La=new I.StandardDialog;La.Rb=1;La.sX(Fa.rb.yva,S.a.instance.ga(1709),oa)}}Object(u.a)(ba,"DataValidationEditDialogFactory",null,[232]);class ka extends b.a{constructor(Fa){super(Fa)}ld(){this.Zc([new E(this.$,new ba)])}static la(Fa){b.a.Nd(245,new ka(Fa))}}Object(u.a)(ka,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return Pa});const Pa=()=>{c.a.Fa(ka.la)}},1154:function(u,F,a){function c(ha,ta,wa,db,Jb,Pb){if(0===db)return Object(aa.a)(qa.UnsupportedZeroResize);
if(0>db||0===wa.length)return Object(aa.a)(qa.InvalidInput);if(ha.C$h())return Object(aa.a)(qa.UnsupportedSkeletonInView);const eb=ha.Xd;if(!eb)return Object(aa.a)(qa.NullSPD);var Ma=eb.A3e(wa);if(Ma&&0<Ma.length)return Object(aa.a)(Ma.length.toString()+" "+qa.UnsupportedHiddenInRange);a:{for(const Ia of wa)Jb?Ia.right=Y.a.sh:Ia.bottom=Y.a.fh;Ma=ha.caa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",wa);try{for(Ma.$$rst();Ma.$$mn();)if(Ma.Zn.vJj){var ob=!0;break a}}finally{Ma&&Ma.dispose()}ob=
!1}if(ob)return Object(aa.a)(qa.UnsupportedMergeCell);if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Jb&&"undefined"!==typeof gridRenderer)for(const Ia of wa)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Ia.left);ha=ha.Da;ob=jb.a.create().toString();eb.njg(wa,db,Jb);Pb=ha.rWj(Jb,Pb);ta.Bbj(wa,Jb);ha.F8i(Pb,ob,Jb?"row":"column");return Object(aa.d)(db)}var b=a(9);u=a(0);var e=a(222),f=a(7),d=a(15),h=a(89);a(263);var n=a(187),m=a(419),x=a(83),
r=a(776),y=a(165),t=a(266),v=a(24),w=a(873),C=a(40);class B{}B.aKh="GalleryGeneral";B.cKh="GalleryNumber";B.ZJh="GalleryCurrency";B.XJh="GalleryAccounting";B.fKh="GalleryShortDate";B.bKh="GalleryLongDate";B.hKh="GalleryTime";B.dKh="GalleryPercentage";B.$Jh="GalleryFraction";B.eKh="GalleryScientific";B.gKh="GalleryText";B.OYg="ButtonComma";B.buttonPercentage="ButtonPercentage";B.keyboardNumber="KeyboardNumber";B.keyboardCurrency="KeyboardCurrency";B.keyboardDate="KeyboardDate";B.keyboardTime="KeyboardTime";
B.keyboardPercentage="KeyboardPercentage";Object(u.a)(B,"RibbonFormatKind",null,[]);var z=a(60),A=a(295),E=a(619),I=a(618),L=a(617);class V extends A.a{constructor(ha,ta,wa,db,Jb,Pb,eb,Ma,ob,Ia,Da,nb=null,Ua=null){super(11,0,Ma,Da);this.yIh=ha;this.Qdd=ta;this.format=db;this.activeCell=wa;this.uve=Jb;this.pMf=Pb;this.kMf=eb;this.cGa=ob;this.clientCorrelationId=Ia;this.Xmb=nb;this.ojb=Ua}get Yt(){return this.Xmb}get Eaa(){return this.ojb}get FEc(){return this.cGa}k3(ha){return super.k3(ha)||this.yIh.k3(this.Qdd,
this.activeCell,this.format,this.uve,this.pMf,this.kMf,this.U0b,this.cGa,this.clientCorrelationId,this.Xmb,this.ojb)}ik(){const ha=[];if(this.wec)for(const ta of this.wec)ha.push(L.a(ta));else ha.push(new I.a(this.format,this.Qdd,this.activeCell));return()=>new E.a(ha)}Pfb(){const ha={OperationType:0};ha.FormatCellsMultiRange=this.Qdd;ha.ActiveCell=this.activeCell;ha.Format=this.format;ha.ApplyFormatOnPivotTableValueField=this.uve;ha.PivotTableXluid=this.pMf;ha.PivotTableFieldCaption=this.kMf;return ha}}
Object(u.a)(V,"FormatCellsBatchOperation",A.a,[]);var T=a(33),H=a(208);class D{}D.editCell="Edited";D.dependentCell="Dependents";Object(u.a)(D,"RecalcPriorityGroupType",null,[]);var G=a(199),J=a(1);const M=ha=>{switch(ha.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return d.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},Q=ha=>{if(ha=ha.color){if("String"===Object.getType(ha).getName())return G.a.rp(ha);
if("Number"===Object.getType(ha).getName())return null}else return null;d.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},U=(ha,ta)=>{ha=excelOnlineCalc.calc.getCellValueKind(ha.rangeDelta.data.value);switch(ha){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;ta.numberOfUnsupportedErrorCellTypes++;
return!1;case "Rich":return ta.numberOfUnsupportedRichCellTypes++,!1;default:return d.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${ha}`),!1}},Z=ha=>{ha=excelOnlineCalc.calc.getCellValueKind(ha.rangeDelta.data.value);let ta=0;switch(ha){case "number":ta=1;break;case "string":ta=2;break;case "boolean":ta=3;break;case "Error":ta=4;break;case "Blank":ta=0;break;default:d.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${ha}`)}return ta},
P=ha=>{const ta=ha.value;switch(ha.type){case 2:return void 0===ta||null===ta?"":ta;case 1:return ha=parseFloat(ta),isNaN(ha)?null:ha;case 3:return ha=parseFloat(ta),isNaN(ha)?null:1===ha;case 4:return ha=parseFloat(ta),isNaN(ha)?null:excelOnlineCalc.calc.errorValue(ha);default:return excelOnlineCalc.calc.blankValue}},S=(ha,ta)=>{const wa=ja(ta);var db=!(void 0===ta.rangeDelta.data.format||null===ta.rangeDelta.data.format);d.ULS.shipAssertTag(537162187,0,0===wa||!db,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${ta.priorityGroup}`);
ha=Math.max(ha.cell.Gj,0);db&&(db=excelOnlineCalc.calc.getCellFormatKind(ta.rangeDelta.data.format.format),"number"===db?ha=ta.rangeDelta.data.format.format:"string"===db?d.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===db?d.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):d.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return ha},ja=ha=>{if(ha.priorityGroup===D.editCell)return 0;if(ha.priorityGroup===D.dependentCell)return 1;d.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2},X=ha=>{ha=ja(ha);if(0===ha)return 1;if(1===ha)return 2;d.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0};var Y=a(8);class va{constructor(ha=0,ta="",wa=0,db="",Jb=""){this.YE=ha;this.cellValue=ta;this.ifmt=
wa;this.priorityGroup=db;this.fy=Jb}}Object(u.a)(va,"RecalcAccuracyObject",null,[]);class N{}N.string="String";N.blank="Blank";N.general="General";N.lHh="Flexible";Object(u.a)(N,"FormattedUnitKind",null,[]);class ea{constructor(ha=0,ta=0,wa=0,db=0,Jb=0,Pb=0,eb=0,Ma=0,ob=0,Ia=0,Da=0,nb=0,Ua=0,W=0,sa=0,vb=!1,gc="",Bc=0,Sa=null,na=null,ib=null,Ib=null,ec=null,qb=null,Ha=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=
this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=
this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=ha;this.numberOfNonUpdatedCells=ta;this.numberOfUpdatedCells=wa;this.numberOfCellsUpdatedAlreadyByServer=db;this.numberOfCellsSkippedDueToTimeout=Jb;this.numberOfCellsWithNoFormattedCell=Pb;this.numberOfUnsupportedErrorCellTypes=eb;this.numberOfUnsupportedBlankCellTypes=
Ma;this.numberOfUnsupportedRichCellTypes=ob;this.numberOfSkippedCellsDueToMissingLocaleInfo=Ia;this.totalExecutionTime=Da;this.originalProcessingTimeLimit=nb;this.newProcessingTimeLimit=Ua;this.numberOfEditedRecalcedCellsInBatch=W;this.numberOfDependentRecalcedCellsInBatch=sa;this.isNewTask=vb;this.lastSetCellInstantaneousOperation=gc;this.taskId=Bc;this.isNewNumberFormatter=Sa;this.numberOfRecalcedCellsWithFormattedValue=na;this.numberOfRecalcedCellsWithoutFormattedValue=ib;this.totalNumberFormatterTime=
Ib;this.newNumberFormatterFinalizeFailures=ec;this.numberOfMeasureTextWidthCalls=qb;this.numberOfHashFormattedValues=Ha}}Object(u.a)(ea,"RecalcResultProcessingStatistics",null,[]);class Ca{constructor(ha,ta,wa,db){this.rangeDelta=ha;this.stateId=ta;this.isFinished=wa;this.priorityGroup=db}}Object(u.a)(Ca,"RecalcedCellInfo",null,[]);var la=a(109),Ra=a(11),lb=a(22),Aa=a(55),da=a(68),aa=a(290);class fa{constructor(ha,ta,wa){this.yda=[];this.calcManager=this.nBc=this.lastSetCellInstantaneousOperation=
null;this.XOf=db=>{var Jb;if(db&&db.rangeDeltas){var Pb=this.yda.length;for(let eb=0;eb<db.rangeDeltas.length;eb++)(null===(Jb=db.rangeDeltas[eb])||void 0===Jb?0:Jb.data)&&void 0!==db.rangeDeltas[eb].data.value&&null!==db.rangeDeltas[eb].data.value&&void 0!==db.rangeDeltas[eb].range&&null!==db.rangeDeltas[eb].range&&this.yda.push(new Ca(db.rangeDeltas[eb],db.stateId,db.isFinished,db.priorityGroup));d.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${db.stateId}, priorityGroup=${db.priorityGroup}, recalcFinished=${db.isFinished}, cellsFromCalc=${db.rangeDeltas.length}, initialCellsToRender=${Pb}, recalcedCells=${this.yda.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);
!Pb&&this.yda.length&&this.GGf(!1,0)}};this.$=ha;this.grid=ta;this.sg=wa;this.tda=fa.VKe;this.$.da.$a(268,db=>{this.nBc=db});this.$.da.$a(266,db=>{this.calcManager=db});this.lCb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.sud=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.Bui=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=
this.nBc=this.sg=this.grid=this.$=null}Ccd(ha,ta,wa,db,Jb,Pb,eb){if(!ta)return Object(aa.a)("Null");var Ma=excelOnlineCalc.numfmt.renderCallback(db,Ia=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Ia,Jb,!0,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),eb);let ob=ha.renderValue(ta,Ma);if(!excelOnlineCalc.util.isSuccess(ob))return Object(aa.a)("Finalize");db=null;if(eb=excelOnlineCalc.numfmt.isHashesValue(ob.value)){if(ob=ha.renderHashesValue(ob.value,
Ma),!excelOnlineCalc.util.isSuccess(ob))return Object(aa.a)("Hashes")}else db=fa.KIh(ta,ob.value);Ma=ob.value;ha=excelOnlineCalc.numfmt.renderedValueToString(Ma);ta=M(Ma);Ma=Q(Ma);return Object(aa.d)({text:ha,valueType:wa,fontColor:Ma,Gj:Pb,qPa:db,horizontalAlignment:ta,isHashesValue:eb})}GGf(ha,ta){this.$&&this.grid&&this.calcManager&&this.nBc&&this.calcManager.IB?(ha&&(this.tda=this.nBc.uff),this.T6i(this.grid,this.calcManager.IB,ha,ta),!this.tda&&this.yda.length?Aa.Task.delay(0).jp(wa=>{this.GGf(!0,
wa.id);return!0},0,null,da.a.current):Aa.Task.Ta(!0)):(d.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Aa.Task.Ta(!1))}T6i(ha,ta,wa,db){const Jb=Ra.HelperMethods.Tb();for(wa=new ea(this.yda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.tda,void 0,void 0,void 0,wa,void 0,db,!0,0,0,0,0,0,0);0<this.yda.length;){db=Ra.HelperMethods.Tb()-Jb;if(!this.tda||db>this.tda){wa.numberOfCellsSkippedDueToTimeout=
this.yda.length;break}db=Array.dequeue(this.yda);if(U(db,wa)){var Pb=v.Range.Qc(db.rangeDelta.range.row+1,db.rangeDelta.range.column+1);(Pb=ha.Sb(Pb))?fa.G_g(db.stateId,Pb.cell)?(fa.Znc(ha,Pb,db,wa),this.nRg(ta,Pb,db,wa)):wa.numberOfCellsUpdatedAlreadyByServer++:wa.numberOfCellsWithNoFormattedCell++}}db=Math.round(Ra.HelperMethods.Tb()-Jb);this.WZj(db);this.wMj(wa,db);this.Hkj(wa)}nRg(ha,ta,wa,db){var Jb,Pb,eb,Ma,ob=S(ta,wa);const Ia=wa.rangeDelta.data.formatted,Da=Z(wa),nb=ja(wa);ha=this.Ccd(ha,
Ia,Da,ta.cell.UBa,ta.cell.wia,ob,!1);ob=ta.cell.XFc;if(Object(aa.c)(ha))if(this.lCb&&this.sud){if(0===nb||ta.text!==ha.value.text)this.Bui&&0===nb&&this.tUd(ob,ha.value)&&(ta.cell.formattedText=ob),this.sg.q_a(ta,ha.value),wa=X(wa),this.sg.m$c(ta,this.lastSetCellInstantaneousOperation,1,wa,!0,!0),0===nb&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Axf(ta.range):d.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),
db.numberOfUpdatedCells++}else ta.text!==ha.value.text&&(this.sg.q_a(ta,ha.value),wa=X(wa),this.sg.m$c(ta,this.lastSetCellInstantaneousOperation,1,wa,!0,!0),db.numberOfUpdatedCells++);else switch(ha.reason){case "Null":db.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Jb=db.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Jb?Jb:0)+1;break;case "Hashes":db.numberOfHashFormattedValues=(null!==(Pb=db.numberOfHashFormattedValues)&&void 0!==Pb?Pb:0)+1;break;case "Finalize":db.newNumberFormatterFinalizeFailures=
(null!==(eb=db.newNumberFormatterFinalizeFailures)&&void 0!==eb?eb:0)+1}Object(aa.b)(ha)&&"Null"!==ha.reason&&(db.numberOfRecalcedCellsWithFormattedValue=(null!==(Ma=db.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Ma?Ma:0)+1);db=0===nb?ta.cell.userInput:ta.formulaBarText;Ma=Object(aa.c)(ha)?ha.value.text:"";wa=Object(aa.b)(ha)?ha.reason:"";d.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${ta.range.top}, ${ta.range.left}) 2nd pass formatting, success: ${Object(aa.c)(ha)}, reason: ${wa}, priority: ${nb}, ifmt: ${ta.cell.Gj}, input: '${db?
lb.a.EM(db):"null"}', prediction: '${Ma?lb.a.EM(Ma):"null"}',`)}WZj(ha){this.tda=Math.max(this.tda-Math.max(ha,1),0)}wMj(ha,ta){ha.numberOfNonUpdatedCells=this.yda.length;ha.totalExecutionTime=ta;ha.newProcessingTimeLimit=this.tda;ha.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}Hkj(ha){ha=Sys.Serialization.JavaScriptSerializer.serialize(ha);d.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${ha}`)}static KIh(ha,ta){ha=ha.units;var wa=
ta.units;if(ha.length!==wa.length)return d.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;ta=[];let db=-1;for(let Jb=0;Jb<ha.length;Jb++)switch(ha[Jb].kind){case N.blank:ta.push(...la.h(" ",wa[Jb].str.length));break;case N.string:ta.push(ha[Jb].str);break;case N.lHh:ta.push("");db=Jb;break;case N.general:ta.push(wa[Jb].str);break;default:d.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=db||""===wa[db].str)return null;wa={};wa.Start=ta.slice(0,db).join("");wa.Separator=ha[db].str;wa.End=ta.slice(db+1,ta.length).join("");return wa}static oPh(ha){return ha&&ha&&ha.my?ha.my.UE:Y.a.re}static G_g(ha,ta){if(!ta)return!1;ta=fa.oPh(ta);return ta===Y.a.re||ta===ha}static Znc(ha,ta,wa,db){var Jb=wa.rangeDelta.data.value.toString();const Pb=Z(wa),eb=S(ta,wa);Jb=new va(Pb,Jb,eb,wa.priorityGroup);ta.cell.Znc(Jb,
ha.Da.e6);1===ja(wa)?db.numberOfDependentRecalcedCellsInBatch++:db.numberOfEditedRecalcedCellsInBatch++}tUd(ha,ta){return null==ha?!1:!!ha.TextRuns&&!!ha.Fonts&&ha.Text===ta.text&&2===ta.valueType}}fa.VKe=20;Object(u.a)(fa,"CalcResultProcessor",null,[399,2]);class Oa{constructor(ha,ta=null,wa=""){this.success=ha;this.doc=ta;this.reason=wa}}Object(u.a)(Oa,"GetRibbonNumberFormatResult",null,[]);var ba=a(910);class ka{constructor(ha,ta){this.Ix=null;this.Da=ha;this.F3a=ta}Vdb(ha,ta,wa,db,Jb=!1,Pb=!1){ha&&
(ha.V0(ta,wa,Jb,Pb),ha.verticalAlignment=db)}xMb(ha,ta,wa){this.Ix||(this.Ix=new ba.a(this.Da,this.F3a));this.Ix.xMb(ha,ta,wa)}}Object(u.a)(ka,"FormatCellsActionModelAccessor",null,[398]);var Pa=a(209),Fa=a(28),oa=a(29),La=a(282),Ea=a(251),ca=a(281),$a=a(64);class Qa{constructor(){this.flg=this.I2j=!1;this.source=0;this.Pka=this.sjc=!1}}Object(u.a)(Qa,"FormatCellInstantaneousResult",null,[]);class Va{constructor(ha,ta){this.success=ha;this.fy=ta}}Object(u.a)(Va,"FormatStringResult",null,[]);var fb=
a(21),Ka=a(175),hb=a(1086),fc=a(44),dc=a(521),wb=a(51),Tb=a(201),xb=a(262),cb=a(79),jb=a(171),qa;(function(ha){ha.InvalidInput="invalid input";ha.UnsupportedZeroResize="resizing to 0 - ignore";ha.UnsupportedSkeletonInView="skeleton in view - ignore";ha.NullSPD="ActiveSheetProcessedData is null";ha.UnsupportedHiddenInRange="hiddens in resizeRanges";ha.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(qa||(qa={}));Object(u.b)("InstantaneousRowColumnResizeFailureReason",qa);
var za=a(174);class Na{constructor(ha){this.Ix=this.calcManager=this.py=this.HTa=null;this.Cif=ta=>{if(ta){const wa=Ra.HelperMethods.VO.hasOwnProperty(ta);ta=fb.h(this.$).isFontSupported(ta);return!wa&&ta}d.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.isFontFromFontService: fontName cannot be null");return!1};this.UPi=(ta,wa)=>{if(ta&&!La.a(ta)&&wa){const db=!!ta&&!!ta.RequestTelemetryData;fb.h(this.$).Eh.Yla(wa.toString(),ta.StateId,db?ta.RequestTelemetryData.EcsOperationDuration:0,db?ta.RequestTelemetryData.EcsRequestDuration:
0,db?ta.RequestTelemetryData.WfeRequestDuration:0)}};this.$=ha;this.$.da.$a(268,ta=>{this.py=ta});this.zIh=new ka(fb.h(this.$).Da,this.$);this.Oha=new fa(this.$,fb.h(this.$),this);this.$.da.$a(266,ta=>{this.calcManager=ta});this.xb=J.EwaSettings.xb();this.Vl=J.EwaSettings.Vl();this.lCb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.sud=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.VNa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.Cui=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker");this.rl=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get pva(){return this.zIh}get IB(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.IB}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){h.a.rc([this.HTa,this.Oha]);this.$=this.Oha=this.HTa=null}vTa(ha,
ta,wa,db=!1,Jb="",Pb=0,eb=null){return this.dGj(ha,ta,wa,db,Pb,Jb,eb)}m$c(ha,ta,wa,db,Jb,Pb){ha.cell.my.ZJ|=db;Na.S6g(fb.h(this.$),ha,wa,Jb);this.Oha.lastSetCellInstantaneousOperation=ta;Pb&&(fb.h(this.$).Eh.xS(ta,$a.BasicTelemetryCalculator.cR),J.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&(1===wa&&1===db?fb.h(this.$).Eh.xS(ta,$a.BasicTelemetryCalculator.vff):1!==wa&&fb.h(this.$).Eh.xS(ta,$a.BasicTelemetryCalculator.Jod)))}oea(ha,ta,wa,db=!1,
Jb=null,Pb=null){Pb=Pb||ha.ha.ra.selectedRanges;if(!(-1690267012===ta&&1<Pb.length)){-1690267012===ta&&d.ULS.shipAssertTag(537162176,0,1===Pb.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${Pb.length}`);Pb=ha.caa("FormatCellsAction.ShowInstantaneousFormatting",Pb);try{Pb.$$rst();let eb=!1;for(;Pb.$$mn();){let Ma;const ob=Pb.$$cu().$H?ha.WLb(Pb.$$cu().range):(Ma=new n.a,Ma.add(Pb.$$cu()),Ma);for(let Ia of ob)if(fb.h(this.$),!Ia||Pb.hb.contains(Ia.range))if(this.V8f(ta,
Ia,wa,db,Jb,Pb.$$cu().$H),eb||(ha.Da.EV(),eb=!0),Jb)break}}finally{Pb&&Pb.dispose()}}}q_a(ha,ta,wa=null){wa&&(wa.Pka=!0);wa=!ta.text;const db=lb.a.ukf(ta.text);let Jb;const Pb=ha.$H?fb.h(this.$).WLb(ha.range):(Jb=new n.a,Jb.add(ha),Jb);for(let eb of Pb)this.lRg(this.$,eb,ta.text,ta.horizontalAlignment,ta.fontColor,ta.Gj,ha.cell.Gj,wa,db,ta.valueType,ta.qPa);ha.cell.tEc()}O1i(ha,ta,wa,db,Jb=null){try{const Pb=C.D(ta);let eb=C.D(wa);if(ha.Bb.I7a(Pb)||ha.Bb.I7a(eb))return 8;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&
-185374993!==db&&(ha.Bb.rnf(Pb)||ha.Bb.rnf(eb)))return 18;if(-185374993!==db&&this.vsi(ha,Pb,eb))return 9;if(-185374993!==db&&(ha.Bb.J5(eb)||ha.Bb.CBb(Pb)))return 10;if(1804571062!==db&&ha.Bb.H5(eb))return 11;if(this.boh(eb))return 12;if(this.qti(Pb,eb))return 13;const Ma=this.$.Kb.Bc("UserAction","PasteInstantaneous");Ma.start();dc.a(Ma);Jb&&wb.b().PA(Ma.id,Jb.id,"actions","actions");!Pb.isSingle&&eb.isSingle&&(eb=Na.expandRange(Pb,eb),ha.ha.updateSelection(eb,eb,0));switch(db){case 237279923:case 808159687:if(!this.f2i(Pb,
eb))return 14;this.c5c(ha,Pb,eb,!0,!1);break;case 1804571062:this.c5c(ha,Pb,eb,!0,!1);break;case -185374993:this.c5c(ha,Pb,eb,!1,!0);break;default:return 2}d.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Pb){return d.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(Pb)}`),15}}Q3g(ha,ta){for(const wa of ha)this.F2c(wa,!0,ta)}F2c(ha,ta,wa=""){if(ha){var db=fb.h(this.$);
if(ta){if(ta=db.jk("FormatCellsAction.ClearRangeInstantaneous",ha),db=ha.isSingle?null:ha,ta.$$mn()&&void 0!==ta.$$cu()&&null!==ta.$$cu())for(ha=Object(f.a)(new xb.a,{Text:""}),this.vTa(ta.$$cu(),ha,!1,T.a.urd(this.$),wa,void 0,db);ta.$$mn();)void 0!==ta.$$cu()&&null!==ta.$$cu()&&this.vTa(ta.$$cu(),ha,!1,!1,wa)}else this.oea(db,-1228228458,{},void 0,void 0,[ha])}else d.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}Bbj(ha,ta){if(!ta){ta=
Ra.HelperMethods.Tb();var wa=fb.h(this.$),db=wa.caa("FormatCellsAction.ReformatCells",ha);try{db.$$rst();let Jb=!1;for(;db.$$mn();){const Pb=db.$$cu().cell;if(0===Pb.YE||2===Pb.YE)this.updateSpillInformation(Pb,ha),Jb||(wa.Da.EV(),Jb=!0)}}finally{db&&db.dispose()}d.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${Ra.HelperMethods.Tb()-ta}.`)}}tld(ha,ta){if(this.xb){if(ha.formulaBarText)return!lb.a.equals(ta.Text,ha.formulaBarText,
!1);let wa=ha.cell.formattedText;wa=Ea.a(wa,ha.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(wa,ta).isEqual}return!lb.a.equals(ta.Text,ha.text,!1)}rZe(ha,ta,wa,db){if(void 0===ta||null===ta)return new Va(!1,ha);const Jb={};Jb.value=ha;Jb.type=1;ta=this.Z3a(Jb,ta,wa,db);return Object(aa.b)(ta)?new Va(!1,ha):new Va(!0,ta.value.text)}eGj(ha,ta,wa,db){return c(ha,this,ta,wa,db,!0)}bGj(ha,ta,wa){if(!this.tld(ta,wa))return Object(aa.d)("Skip unchanged cell content");
ta=ta.cell;wa=this.tZe(wa.Text,ta.Gj,ta.UBa,ta.wia,!0);if(Object(aa.b)(wa))ha=wa;else{wa=wa.value;var db=ta.hasRichValueIcon?"Unsupported rich value icon":ta.LX?"Unsupported wrapped text":ta.lnf||null!=ta.RL&&0!==ta.RL?"Unsupported rotated text":!0;!0!==db?ha=Object(aa.a)(db):(ta.isCellWidthFixed?db="Skip fixed width cell":(db=wa.valueType,db=0===db?"Skip empty cell value":2===db?"Skip string cell value":ta.QF&&!ta.lsi?"Skip merged cell":ta.fAc?"Skip shrunk to fit":wa.isHashesValue?"Skip hashes cell value":
!0),!0!==db?ha=Object(aa.d)(db):(wa=ta.t8g(wa.text),wa>ta.offsetWidth?(ta=[ta.getRange().clone()],ha=c(ha,this,ta,wa,!1,!1),ha=Object(aa.b)(ha)?ha:Object(aa.d)(wa)):ha=Object(aa.d)("Column is wide enough")))}return ha}qZe(ha,ta,wa,db,Jb){const Pb={};Pb.value=ha;Pb.type=wa;ta=this.Z3a(Pb,ta,db,Jb);return Object(aa.b)(ta)?new Va(!1,ha):new Va(!0,ta.value.text)}updateSpillInformation(ha,ta){const wa=ha.getRange();let db=!1;for(const Jb of ta)if(wa.left===Jb.left){db=!0;break}ha.IWj(db)}dGj(ha,ta,wa,
db,Jb,Pb="",eb=null){this.lCb&&this.Cui&&(ha.cell.XFc=ta);const Ma=new Qa;Ma.source=0;Ma.Pka=!1;ha.cell.rHb=ha.cell.Gj;let ob=ta.Text;const Ia=!ob,Da=lb.a.ukf(ob);lb.a.Tq(ob)&&(d.ULS.shipAssertTag(537162142,0,!((void 0===ob||null===ob)&&void 0!==ta.TextRuns&&null!==ta.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),ta=Object(f.a)(new xb.a,{Text:""}),ob="");ha.cell.userInput=ob;if(!this.tld(ha,ta))return this.n1g(ha,Jb,Ia,Da,Ma);wa?this.g1g(ha,
ob,this.$.workbookContext.DefaultHyperlinkStyle,Ma):this.a1g(ha,ta,ob,Ia,Da,db,Ma,eb);this.m$c(ha,Pb,Jb,1,Ma.sjc,Ma.Pka);return Ma}n1g(ha,ta,wa,db,Jb){Jb.flg=!0;Jb.sjc=!0;Jb.Pka=!1;0===ta&&fb.h(this.$).Da.EV();0===ha.cell.Cza&&(wa?ha.cell.V0(0,!1):db&&ha.cell.V0(1,!1));this.W_d(ha.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Jb}g1g(ha,ta,wa,db){db.Pka=!0;ha.insertHyperlink(ta,H.a.idd(ta),wa);this.W_d(ha.range,"FormatCellsAction.cellDataEntryCSE")}a1g(ha,ta,wa,db,Jb,Pb,eb,Ma=null){eb.Pka=
!1;const ob=ha.cell;let Ia=!1;this.py||(this.py=this.$.da.Aa(268));this.nSj(this.py,ob.Gj);J.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&Pb&&(Ia=this.afg(this.py,ha,wa,Ma));db||Jb?this.c1g(ha,db,Jb,eb):(db=this.tZe(wa,ob.Gj,ob.UBa,ob.wia,!1,Ia),Object(aa.c)(db)?(this.tUd(ta.TextRuns,ta.Fonts)&&this.e1g(ha,ta,db.value),this.q_a(ha,db.value,eb),this.W_d(ha.range,"FormatCellsAction.cellDataEntryCSE")):this.lCb&&this.sud?this.k1g(ha,ta.Text,eb):this.l1g(ha,ta.Text,eb),
ta=Object(aa.c)(db)?db.value.text:"",Jb=Object(aa.b)(db)?db.reason:"",d.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${ha.range.top}, ${ha.range.left}) 1st pass formatting, success: ${Object(aa.c)(db)}, reason: ${Jb}, ifmt: ${ob.Gj}, input: '${lb.a.k_a(ob.userInput)}', prediction: '${lb.a.k_a(ta)}',`));ob.formulaBarText=wa;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||Pb&&this.afg(this.py,ha,wa,Ma);eb.sjc=!0}c1g(ha,ta,wa,db){db.Pka=!0;ha.text=
"";ha.formulaBarText="";ha.cell.userInput="";this.x3b(ha,null,null,ta,wa)}e1g(ha,ta,wa){ta.Text===wa.text&&2===wa.valueType&&(ha.cell.formattedText=ta)}k1g(ha,ta,wa){wa&&(wa.Pka=!0);ha.text=ta;ha.formulaBarText=ta;this.x3b(ha,1)}l1g(ha,ta,wa){wa&&(wa.Pka=!0);ha.text=ta;ha.formulaBarText=ta;this.x3b(ha,1)}x3b(ha,ta,wa=null,db=!1,Jb=!1,Pb=!1){let eb=ha.horizontalAlignment;wa=null!=wa?wa:ha.verticalAlignment;0===ha.cell.Cza&&(null!=ta||db||Jb||Pb)&&(db?eb=0:Jb||Pb?eb=1:null!=ta&&(eb=ta),this.pva.Vdb(ha,
eb,!1,wa,!0))}W_d(ha,ta){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const wa=fb.h(this.$),db=()=>{this.calcManager?this.calcManager.Axf(ha):d.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${ta}, cell ${ha}`);wa.Vb.em(db)};wa.Vb.Rm(db)}}nSj(ha,ta){(null===ha||void 0===ha?0:ha.Vya)&&ta>=Na.SGh&&ta>ha.Vya.length-1&&(d.ULS.sendTraceTag(537162141,
0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${ta}. Triggering refresh...`),ha.jZe())}afg(ha,ta,wa,db=null){if(void 0===ha||null===ha)return!1;if(this.py.Iod)return d.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing"),!1;const Jb=this.$.da.Aa(266);return Jb?(this.Oha.tda=fa.VKe,ha&&(this.Oha.tda=ha.uff),Jb.UZg(ta,wa,this.Oha.XOf,db)):!1}Z3a(ha,ta,wa,db){var Jb=this.$.da.Aa(266);if(!Jb)return Object(aa.a)("calcManager is null");
if(!Jb.IB)return Object(aa.a)("calcManager.NumberFormatter is null");if(!this.py)return Object(aa.a)("instantaneousManager is null");let Pb;if("number"===typeof ta||"string"===typeof ta){var eb=Jb.f5a(ta);if(!Object(aa.c)(eb))return eb;Pb=eb.value}else Pb=ta;eb=Jb.IB;const Ma=P(ha);if(void 0===Ma||null===Ma)return Object(aa.a)("cellValue is null");Jb=excelOnlineCalc.calc.cellValueToReadOper(Jb.config.mathpack,Ma);if(void 0===Jb||null===Jb)return Object(aa.a)("readOper is null");Jb=eb.applyFormat(Pb,
Jb,J.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Jb)?this.Oha.Ccd(eb,Jb.value,ha.type,wa,db,"number"===typeof ta?ta:-1,!1):Object(aa.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Jb.reason.kind))}tZe(ha,ta,wa,db,Jb,Pb){var eb=this.$.da.Aa(266);if(void 0===eb||null===eb)return Object(aa.a)("calcManager is null");if(void 0===eb.IB||null===eb.IB)return Object(aa.a)("calcManager.NumberFormatter is null");if(void 0===this.py||
null===this.py)return Object(aa.a)("instantaneousManager is null");if(this.lCb&&!Jb&&Pb)return Object(aa.a)("No main thread number formatter");Pb=eb.f5a(ta);if(!Object(aa.c)(Pb))return Pb;var Ma=Pb.value;Pb=eb.IB;ha=Pb.parseEdit(ha,Ma);if(!excelOnlineCalc.util.isSuccess(ha))return Object(aa.a)(`ParseEdit failure: reason=${ha.reason.kind}, features=${ha.reason.features}`);if(ha.value.kind===w.a.formula)return Object(aa.a)("Main thread - skipping formula edit");eb=excelOnlineCalc.numfmt.applyValueEdit(Pb,
eb.localeInfo,Ma,ha.value);if(!excelOnlineCalc.util.isSuccess(eb))return Object(aa.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(eb.reason.kind));ha=ha.value;d.ULS.shipAssertTag(537162190,0,ha.kind!==w.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");ha=excelOnlineCalc.numfmt.getValueEditOperKind(ha);Ma=0;switch(ha){case 0:case 128:Ma=0;break;case 1:Ma=1;break;case 2:Ma=2;break;case 4:Ma=3;break;case 8:Ma=4;break;case 16:case 32:case 64:case 256:d.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${ha} to a CellValueType`);break;default:d.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${ha}`)}return this.Oha.Ccd(Pb,eb.value,Ma,wa,db,"number"===typeof ta?ta:-1,Jb)}vsi(ha,ta,wa){if(ta.width<wa.width){const db=ha.jk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new v.Range(ta.top,ta.left,ta.bottom,ta.left,!0,!0));for(;db.$$mn();){let Jb=db.$$cu();if(Jb&&
Jb.eMa())return d.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(ta.height<wa.height)for(ha=ha.jk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new v.Range(ta.top,ta.left,ta.top,ta.right,!0,!0));ha.$$mn();)if((ta=ha.$$cu())&&ta.iMa())return d.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}c5c(ha,ta,wa,db,Jb){const Pb=ta.DS().FirstRow,eb=ta.DS().LastRow;
var Ma=wa.DS().FirstRow;const ob=wa.DS().LastRow;let Ia=Pb;for(;Ma<=ob;Ma++,Ia++){Ia>eb&&(Ia=Pb);const Da=ta.DS();Da.FirstRow=Da.LastRow=Ia;const nb=wa.DS();nb.FirstRow=nb.LastRow=Ma;this.V9g(ha,y.a.JQ(Da),y.a.JQ(nb),db,Jb)}}f2i(ha,ta){const wa=this.$.da.Aa(266);return void 0!==wa&&null!==wa?(wa.PZg(ha,ta.topLeft,this.Oha.XOf),!0):!1}qti(ha,ta){const wa=ha.right-ha.left+1;ha=ha.bottom-ha.top+1;const db=ta.right-ta.left+1;ta=ta.bottom-ta.top+1;if(db>wa&&ta>ha){if(!(db%wa&&ta%ha))return!0}else if(db===
wa&&ta>ha){if(!(ta%ha))return!0}else if(db>wa&&ta===ha&&!(db%wa))return!0;return!1}boh(ha){if(J.EwaSettings.ma(101)){ha=fb.h(this.$).C1(ha).gridView.getRangeInformation(ha);for(const ta of ha)if(Object(m.a)(t.DynamicArrayRange,ta)&&!Object(x.a)(t.DynamicArrayRange,ta).Rnc)return!0}return!1}LGe(ha,ta,wa,db,Jb,Pb){for(let eb of ta)wa&&(this.Z9g(eb,Jb),eb.setCell(!0)),db&&(Pb=this.s8h(Jb,eb)),Pb||(ha.Da.EV(),Pb=!0);return Pb}nUh(ha,ta,wa){ta=new v.Range(ta,wa,ta,wa,!0,!0);return ha.Sb(ta)}V9g(ha,ta,
wa,db,Jb){if(wa){this.HTa&&wa.equals(this.HTa.range)||(h.a.Ia(this.HTa),this.HTa=ha.jk("FormatCellsAction.CopyBetweenRows",wa));wa=this.HTa;wa.$$rst();var Pb=!1;if(J.EwaSettings.getBooleanFeatureGate(za.a.HJe,!1)){var eb=ta.DS().FirstColumn+1,Ma=ta.DS().LastColumn+1;ta=ta.DS().FirstRow+1;let Ia=eb;for(;wa.$$mn();){Ia>Ma&&(Ia=eb);const Da=this.nUh(ha,ta,Ia);Ia+=1;var ob=void 0;const nb=wa.$$cu().$H?ha.WLb(wa.$$cu().range):(ob=new n.a,ob.add(wa.$$cu()),ob);Da&&(Pb=this.LGe(ha,nb,db,Jb,Da,Pb));cb.lastOrDefault(nb)}}else for(ob=
ha.jk("FormatCellsAction.CopyBetweenRows2",ta);wa.$$mn();)ob.$$mn()||(ob.$$rst(),ob.$$mn()),Ma=ob.$$cu(),ta=wa.$$cu().$H?ha.WLb(wa.$$cu().range):(eb=new n.a,eb.add(wa.$$cu()),eb),Ma&&(Pb=this.LGe(ha,ta,db,Jb,Ma,Pb)),cb.lastOrDefault(ta)}else d.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}p9f(){const ha=oa.a.$c(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");fc.a(this.$).vj(ha)}ZDi(ha,ta){const wa={ValidMembers:32},db=ta.NumberFormat;switch(ha){case 1890566896:if(1001===
db||1002===db||1003===db){wa.NumberFormat=14;wa.NumberFormatOptions={};switch(db){case 1001:wa.NumberFormatOptions.TimeType=2;break;case 1002:wa.NumberFormatOptions.DateType=7;break;case 1003:wa.NumberFormatOptions.DecimalPlaces=0}wa.NumberFormatOptions.NumberFormatCategory=this.aRg(db)}else wa.NumberFormat=db;break;case 1886928607:wa.NumberFormat=13;break;case -992833457:wa.NumberFormat=11;break;case 218524921:wa.NumberFormat=12;break;case 996232352:wa.NumberFormat=14;wa.NumberFormatOptions=Object(f.a)(new r.a,
{DecimalPlaces:0});wa.NumberFormatOptions.NumberFormatCategory=6;break;default:return ta}return wa}formatCells(ha,ta,wa,db=null,Jb=null,Pb=null,eb=null){var Ma;const ob=this.$.Kb.Bc("UserAction","FormatCellsInstantaneous, command = "+wb.b().uj(ha)),Ia=this.$.Kb.Qg("UserAction","FormatCellsInstantaneousFrame");Ia.start();dc.a(Ia);var Da=wb.b().uj(ha);const nb=this.$,Ua=fb.h(nb);var W=Ua.ha.ra,sa=Jb||W.selectedRanges,vb=la.g(sa,ib=>ib.RC);Da=`${Da}, cellCount=${vb}`;fb.h(this.$).Eh.d1(1,ob.id,Da);sa=
C.r(sa,this.$);W=W.activeCell;Da=-168056295===wa.command;var gc=vb=null;if(Da){gc=Ua.Bb.xp(W);if(!gc){this.p9f();return}vb=gc.jda.substring(1,gc.jda.length-1);gc=gc.pcc();if(!gc){this.p9f();return}gc=gc.Caption}Ua.yf.pH(!1,!0);const Bc=C.o(W,nb),Sa=nb.pa.ya.Wb({wca:!0,Cba:1}),na=this.ZDi(wa.command,ta);Da||this.oea(Ua,ha,ta,!1,db,Jb);ob.stop();fb.h(this.$).Eh.xS(ob.id,$a.BasicTelemetryCalculator.cR);wa.rhi=Fa.a.Qa.zb;db=this.$.Kb.Bc("UserAction","FormatCellsUserAction");Jb=this.rl&&this.Cif(null===
(Ma=null===ta||void 0===ta?void 0:ta.Font)||void 0===Ma?void 0:Ma.FontName);this.lAi(ha,wa.taskId,ta,sa,W,db.id,Jb);wb.b().PA(ob.id,db.id,"actions","actions");wb.b().PA(Ia.id,db.id,"actions","actions");nb.userOperationManager.Ic(new V(this,sa,Bc,na,Da,vb,gc,Sa,db,ob.id,64,Pb,eb),wa)}k3(ha,ta,wa,db,Jb,Pb,eb,Ma,ob,Ia,Da){const nb=this.$;return(Ua,W,sa)=>{nb.My();Ua=[Ua,this.UPi];W=[W];Ia&&Ua.push(Ia);Da&&W.push(Da);return z.l(nb.pa.ya,ha,ta,wa,db,Jb,Pb,!1,ca.b(...Ua),ca.a(...W),sa,ob,eb,Ma)}}V8f(ha,
ta,wa,db,Jb,Pb,eb=null){if(ta&&wa){var Ma=wa.Font,ob=wa.HorizontalAlignment,Ia=wa.VerticalAlignment;wa.ValidMembers&2||(ob=ta.horizontalAlignment);wa.ValidMembers&1||(Ia=ta.verticalAlignment);var Da=0!==ob;Na.Cji(ha)&&0===ob&&(ob=this.D3e(ta));var nb=!1;switch(ha){case -394785302:this.pva.Vdb(ta,ob,Da,0);break;case 1041132226:this.pva.Vdb(ta,ob,Da,1);break;case -571165336:this.pva.Vdb(ta,ob,Da,2);break;case -1150205178:case -1142465846:case -286432209:this.pva.Vdb(ta,ob,Da,Ia,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.VNa&&
this.Auj(ta,wa,Da);break;case 1650812936:this.setFillColor(ta,wa,Pb);break;case -287251124:ta.bold=Ma.Bold;break;case -1690267012:fb.h(this.$).ha.ra.Pg&&(Ma=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?eb?eb:fb.h(this.$).ha.ra.dd:fb.h(this.$).ha.ra.dd,this.pva.xMb(ta,wa,Ma));break;case 1970784898:wa=G.a.rp(ta.color,ta.backgroundColor);if(Pa.a.compare(wa,Pa.a.red)&&(lb.a.D5(ta.text)||lb.a.waf(ta.text)))break;wa=Pa.a.FH(Ma.FontColor);ta.color=
Tb.e(G.a.BG(wa));break;case -1925065947:ta.italic=Ma.Italic;break;case -1293291468:ta.fontName=Ma.FontName;this.Vl&&ta.X3f(Ma.FontScheme);break;case 862890474:case 963349338:ta.fontSize=Ma.FontSize;this.$.df();break;case -1077965542:ta.fontSize=Ma.FontSize;break;case 1764140053:ta.underline=Ma.Underline;break;case -1685033574:ta.doubleUnderline=Ma.DoubleUnderline;break;case -1590502662:ta.fontStrikethrough=Ma.Strikethrough;break;case -848953656:case 2045211913:nb=ta.trb();break;case 2105621672:wa=
Object(x.a)(hb.a,Jb);if(!wa)break;Ma=Pa.a.EJh(wa.color);ta.color=Tb.e(G.a.BG(Ma));this.Ave(ta,wa.hoc);break;case -1409276245:this.Ave(ta,wa.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.kRg(ta,wa);break;case -1228228458:ta.trb();ta.clearFormat();this.PYc(ta,0);nb=!0;break;case -730106152:ta.clearFormat();this.PYc(ta,0);break;case 932244020:this.zuj(ta,wa,Pb);break;case -1942512156:case -1920201820:this.ywj(ta,wa)}db||(nb?ta.LJb(!0):ta.setCell(!0))}else d.ULS.shipAssertTag(537162135,
0,!ta,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),d.ULS.shipAssertTag(537162134,0,!wa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}Z9g(ha,ta){ha&&ta?(ha.Drb(ta),ha.$2c(ta),this.PYc(ha,ta.cell.Gj)):d.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}PYc(ha,ta){if(0>ta)this.qca({caller:"ApplyNumberFormatIndexOnCell",cell:ha,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});
else{var wa=this.Z3a(ha.qx,ta,ha.cell.UBa,ha.cell.wia);Object(aa.b)(wa)?this.qca({caller:"ApplyNumberFormatIndexOnCell",cell:ha,kind:"failure",reason:wa.reason}):(this.q_a(ha,wa.value),this.qca({caller:"ApplyNumberFormatIndexOnCell",cell:ha,kind:"success",fy:wa.value,format:ta}))}}Ave(ha,ta){if(void 0===ta||null===ta)this.qca({caller:"ApplyNumberFormatStringOnCell",cell:ha,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var wa=this.Z3a(ha.qx,ta,ha.cell.UBa,
ha.cell.wia);Object(aa.b)(wa)?this.qca({caller:"ApplyNumberFormatStringOnCell",cell:ha,kind:"failure",reason:wa.reason}):(this.q_a(ha,wa.value),this.qca({caller:"ApplyNumberFormatStringOnCell",cell:ha,kind:"success",fy:wa.value,format:ta}))}}kRg(ha,ta=null){if(ta)if(ta=this.x0h(ha,ta),ta.success){var wa=this.Z3a(ha.qx,ta.doc,ha.cell.UBa,ha.cell.wia);Object(aa.b)(wa)?this.qca({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"failure",reason:wa.reason,format:ta.doc}):(this.q_a(ha,wa.value),this.qca({caller:"ApplyNumberFormatCategoryOnCell",
cell:ha,kind:"success",fy:wa.value,format:ta.doc}))}else this.qca({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"failure",reason:ta.reason,format:ta.doc});else this.qca({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}aRg(ha){switch(ha){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<ha?-1:ha}x0h(ha,
ta){if(!this.py||!this.localeInfo||!ta)return ha=this.py?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Oa(!1,void 0,"GetRibbonNumberFormat: "+ha);ta=ta.NumberFormat;switch(ta){case 0:ha=B.aKh;break;case 1:ha=B.cKh;break;case 2:ha=B.ZJh;break;case 3:ha=B.XJh;break;case 4:ha=B.fKh;break;case 5:ha=B.bKh;break;case 6:ha=B.hKh;break;case 7:ha=B.dKh;break;case 8:ha=B.$Jh;break;case 9:ha=B.eKh;break;case 10:ha=B.gKh;break;case 11:case 12:return this.py.jZe(),
this.GRh(ha,ta);case 13:ha=B.OYg;break;case 1006:ha=B.buttonPercentage;break;case 1004:ha=B.keyboardNumber;break;case 1005:ha=B.keyboardCurrency;break;case 1002:ha=B.keyboardDate;break;case 1001:ha=B.keyboardTime;break;case 1003:ha=B.keyboardPercentage;break;case 14:return ha="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",d.ULS.shipAssertTag(537162132,0,!1,ha),new Oa(!1,void 0,ha);default:return ha="GetRibbonNumberFormat: unknown NumberFormatType!",d.ULS.shipAssertTag(537162131,
0,!1,ha),new Oa(!1,void 0,ha)}return ha?(ha=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,ha))?new Oa(!0,ha):new Oa(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new Oa(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}GRh(ha,ta){if(!this.calcManager||!this.IB)return ta=this.calcManager?"numberFormatter is null":"calcManager is null",new Oa(!1,void 0,"GetDecimalChangeNumberFormat: "+ta);ha=
this.calcManager.f5a(ha.cell.Gj);if(!Object(aa.c)(ha))return new Oa(!1,void 0,`getDecimalChangeNumberFormat: ${ha.reason}`);ta=this.IB.changeFormatDecimals(ha.value,11===ta?1:-1);return excelOnlineCalc.util.isSuccess(ta)?void 0===ta.value||null===ta.value?new Oa(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new Oa(!0,ta.value):new Oa(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}qca(ha){const ta=ha.caller,wa=ha.cell;var db=ha.format;db=
null==db?"null":"number"===typeof db?db:"string"===typeof db?lb.a.k_a(db):lb.a.k_a(db.formatString);const Jb=lb.a.k_a(wa.qx.value)||"null",Pb="success"===ha.kind?lb.a.k_a(ha.fy.text):"null";ha=JSON.stringify({caller:ta,"range.top":wa.range.top,"range.left":wa.range.left,result:ha.kind,reason:"success"===ha.kind?"":ha.reason,value:Jb,valueType:wa.qx.type,ifmt:db,prediction:Pb});d.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${ha}`)}lRg(ha,ta,wa,db,Jb,Pb,eb,Ma=!1,ob=!1,Ia=
0,Da=null){const nb=ta.cell;nb.YE=Ia;Ia=ta.text;Ia!==wa&&(nb.text=wa);nb.qPa=Da;Ka.f(Ia)?ta.formulaBarText=Ia:ta.formulaBarText="";ha=fb.h(ha).Bb.Zkf(ta.range);this.x3b(ta,db,null,Ma,ob,ha);Jb&&(ta.color=Tb.e(G.a.BG(Jb)));ta.cell.Gj=Pb;ta.cell.rHb=eb;ta.cell.HAc=Pb}lAi(ha,ta,wa,db,Jb,Pb,eb){const Ma={};Ma.a=this.$.va.UserSessionId;Ma.b=ta;Ma.c=db.Ranges.length;Ma.d=this.Zch(db.Ranges);Ma.e=Jb.toString();Ma.f=ha;Ma.h=Pb;1890566896===ha?Ma.g=wa.NumberFormat.toString():2105621672===ha?Ma.g=wa.NumberFormatOptions.NumberFormatCategory.toString():
this.rl&&-1293291468===ha&&(Ma.g=`{ "isNewFont": ${eb} }`);wb.b().Qe(3,Ma,!0)}Zch(ha){let ta=0,wa=0,db=0;for(let Jb=0;Jb<ha.length;Jb++){const Pb=C.B(ha[Jb]).RC;ta+=Pb;Pb>db&&(db=Pb,wa=Jb)}ha=C.B(ha[wa]).toString();return"TotalCellCount:"+ta+"; Max range:"+ha+"; MaxRangeSize:"+db+";"}zuj(ha,ta,wa){64===(ta.ValidMembers&64)&&this.setFillColor(ha,ta,wa);16===(ta.ValidMembers&16)&&Na.$vj(ha,ta);128===(ta.ValidMembers&128)&&this.pva.xMb(ha,ta,ha.range);if(2===(ta.ValidMembers&2)||1===(ta.ValidMembers&
1)){wa=ta.VerticalAlignment;ta=ta.HorizontalAlignment;const db=0!==ta;J.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!db&&this.D3e(ha);this.pva.Vdb(ha,ta,db,wa)}}setFillColor(ha,ta,wa){(J.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?ha.uV:ha.uV&&ha.yyb&&!ha.Byb&&!ha.Eyb)||(ta=-1===ta.FillColor?wa?G.a.BG(Pa.a.white):null:G.a.BG(Pa.a.FH(ta.FillColor)),ha.backgroundColor=ta?Tb.e(ta):null)}ywj(ha,ta){0!==ha.horizontalAlignment&&
2!==ha.horizontalAlignment||ha.V0(1,!1);0<=ha.indentation+ta.IndentationIncrease&&(ha.indentation+=ta.IndentationIncrease)}Auj(ha,ta,wa){const db=ta.TextOrientation;db!==Y.a.verticalText&&(0>db||180<db)&&d.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${db}`);ha.RL=ta.TextOrientation;wa||ha.V0(0<=ha.RL?1:3,!1)}D3e(ha){ha=this.Z3a(ha.qx,ha.cell.Gj,ha.cell.UBa,ha.cell.wia);return Object(aa.b)(ha)?0:null!=ha.value.horizontalAlignment?
ha.value.horizontalAlignment:0}Mxj(ha,ta,wa){this.Ix||(this.Ix=new ba.a(fb.h(this.$).Da,this.$));this.Ix.xMb(ha,ta,wa)}s8h(ha,ta){const wa=new xb.a;if(ha.cell.formulaBarText&&ha.cell.formulaBarText.startsWith("'"))wa.Text=ha.cell.formulaBarText;else{let db=ha.cellValue;db&&4!==ha.cell.YE||(db=ha.text);wa.Text=db}this.vTa(ta,wa,!1,T.a.urd(this.$));return!0}tUd(ha,ta){return this.xb&&!!ha&&!!ta}static S6g(ha,ta,wa,db){db&&ta.setCell(!0);0===wa&&ha.Da.EV()}static expandRange(ha,ta){ta=ta.clone();ta.height<
ha.height&&(ta.bottom=ta.top+ha.height-1);ta.width<ha.width&&(ta.right=ta.left+ha.width-1);return ta}static Cji(ha){switch(ha){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static $vj(ha,ta){ta=ta.Font;var wa=0!==(ta.ValidMembers&16);const db=0!==(ta.ValidMembers&16),Jb=0!==(ta.ValidMembers&16);ha.bold=0!==(ta.ValidMembers&4);ha.italic=0!==(ta.ValidMembers&8);wa&&(ha.underline=wa);db&&(ha.doubleUnderline=db);Jb&&(ha.fontStrikethrough=
Jb);ha.fontName=ta.FontName;ha.fontSize=ta.FontSize;wa=G.a.rp(ha.color,ha.backgroundColor);Pa.a.compare(wa,Pa.a.red)&&(lb.a.D5(ha.text)||lb.a.waf(ha.text))||(ta=Pa.a.FH(ta.FontColor),ha.color=Tb.e(G.a.BG(ta)))}}Na.SGh=36;Object(u.a)(Na,"FormatCellsAction",null,[313,2]);class ua extends e.a{constructor(ha){super();this.$=ha;this.Fb()}create(){this.nb(new Na(this.$))}static la(ha){ha.da.Ga(18,new ua(ha))}}Object(u.a)(ua,"FormatCellsActionFactory",e.a,[]);a.d(F,"a",function(){return Xa});const Xa=()=>
{b.a.Fa(ua.la)}},1164:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(1),f=a(15),d=a(197),h=a(78),n=a(37),m=a(47),x=a(46),r=a(641),y=a(28),t=a(118);class v{constructor(){this.startTime=y.a.Qa.zb;this.Kx=new r.a}q2e(){return t.a(y.a.Qa,this.startTime)}}Object(u.a)(v,"OngoingAction",null,[]);class w extends h.a{constructor(Xa,ha,ta,wa,db=null){super();this.$Pa=this.Sob=null;this.n0c=0;this.Vqc=null;this.lWi=()=>{const Jb=this.$Pa.q2e();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.Tla}>.OnRunningLong: Operation running for more than ${Jb}ms`);
this.Vqc=m.a.instance.create(this.U6,Math.max(this.tze-Jb,0),x.a.Nne)};this.U6=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.Tla}>.OnTimeout: Operation running for more than ${this.$Pa.q2e()}ms, timing out. Has pending actions: ${this.S6a}`);this.n0c++;this.n0c>this.sze&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.Tla}>.OnTimeout: passed the allowed bypassed count`);this.$Pa.Kx.cancel();this.$Xe()};this.CR=()=>{this.S6a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.Tla}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.RMa}, AggregatedActionParams not null: ${this.S6a}`);
this.Pod()};this.OFg=Xa;this.PFg=ha;this.documentVisibilityObserver=ta;this.Tla=wa;this.PL=db;ta&&this.documentVisibilityObserver.FGa(this.CR);this.m0c=!!ta&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.sze=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ha=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.tze=Xa.Wed(ha);Xa=
e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.ZYg=Math.max(this.tze-ha,0)+Xa}get RMa(){return!!this.$Pa}get S6a(){return!!this.Sob}WLf(Xa){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.Tla}>.PerformThrottledAction: Start. IsActionOngoing: ${this.RMa}, AggregatedActionParams not null: ${this.S6a}`);this.Sob=this.PFg.iYc(Xa,this.Sob);this.Pod()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.uRa(this.CR);
this.$Ae();super.dispose()}M4f(Xa){this.m0c?(this.$Pa=Xa?new v:null,Xa?this.startTimer():this.$Ae()):this.$Pa=Xa?{}:null}$Xe(Xa=null){this.m0c&&Xa&&Xa.IK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.Tla}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.Tla}>.FinishedCallback: Start. IsActionOngoing: ${this.RMa}, AggregatedActionParams not null: ${this.S6a}`),this.M4f(!1),this.Pod())}Pod(){if(!this.FNb()){var Xa=this.Sob;this.Sob=null;
this.M4f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.Tla}>.InternalPerformAction: Calling PerformAction.`);var ha=this.m0c?this.$Pa.Kx.token:d.a.none;n.TaskExtensions.za(this.OFg.wGd(Xa),()=>{this.$Xe(ha)},ha,0,this.PL)}}FNb(){return!this.S6a||this.RMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.si?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.Tla}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}$Ae(){this.Vqc&&this.Vqc.cancel()}startTimer(){this.n0c<=
this.sze&&(this.Vqc=m.a.instance.create(this.lWi,this.ZYg,x.a.Nne))}}Object(u.a)(w,"ActionAggregator",h.a,[516,2]);var C=a(27),B=a(85),z=a(108),A=a(14),E=a(45),I=a(38),L=a(19),V=a(5),T=a(127),H=a(13),D=a(21),G=a(55);class J extends I.a{constructor(Xa){super();this.Mw=this.firstElement=null;this.oNa=!1;this.Zs=null;this.xBj=C.a.Jf;this.rEf=ha=>{const ta=ha.Ca.keyCode;return ta===B.a.Mh?this.XOi():ta===B.a.Yy&&ha.Ca.shiftKey?this.eDh(this.firstElement):!1};this.PJf=ha=>{if(!this.oNa||ha.Ca.keyCode!==
B.a.JG)return!1;J.hcf();G.Task.delay(1).jp(()=>{this.Mw.focus();return!0},0,this.ka);return!0};this.HZi=()=>{document.activeElement&&document.activeElement.id===this.Mw.id||(J.hcf(),G.Task.delay(1).jp(()=>{this.Mw.focus();return!0},0,this.ka))};this.sCf=()=>{this.Veg(this.Mw)};this.qEf=ha=>{ha.stopPropagation();ha.preventDefault();this.oNa&&(this.oNa=!1)};this.$=Xa;(Xa=this.$.ea.dc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Xa.vta}; InWebPart = '${Xa.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${Xa.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Xa&&(Xa.inWebPart||Xa.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Xa.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Xa.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Pbh(),this.Pch(),z.KeyInputManager.instance.sa(A.a.Pb,this.$.domElement,this.PJf));
this.$.da.Ga(238,this)}eMg(Xa){this.addHandler("KBIS",Xa)}nhj(Xa){this.removeHandler("KBIS",Xa)}dispose(){this.firstElement&&E.a.removeHandler(this.firstElement,A.a.focus,this.sCf);this.Zs&&this.Zs.detach("focus");this.Mw&&(E.a.removeHandler(this.Mw,A.a.focus,this.qEf),E.a.removeHandler(this.Mw,A.a.blur,J.onBlur),z.KeyInputManager.instance.Ba(A.a.Pb,this.Mw,this.rEf));z.KeyInputManager.instance.Ba(A.a.Pb,this.$.domElement,this.PJf);this.Zs=this.Mw=this.firstElement=this.$=null;super.dispose()}Pbh(){this.xBj?
(this.firstElement=document.documentElement,this.Zs=T.a.instance.sH(document.parentWindow),this.Zs.la("focus",this.HZi)):(this.firstElement=J.THe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),E.a.addHandler(this.firstElement,A.a.focus,this.sCf))}Pch(){this.Mw=J.THe();this.Mw.id=V.a.bPe;this.Mw.setAttribute(V.a.mv,H.a.instance.ga(862));document.body.appendChild(this.Mw);E.a.addHandler(this.Mw,A.a.focus,this.qEf);E.a.addHandler(this.Mw,A.a.blur,J.onBlur);z.KeyInputManager.instance.sa(A.a.Pb,
this.Mw,this.rEf)}eDh(Xa){this.Veg(Xa);return!1}XOi(){this.oNa=!0;D.h(this.$).focus();D.h(this.$).ha.j$e();this.raiseEvent("KBIS");return!0}Veg(Xa){this.oNa?this.oNa=!1:(this.oNa=!0,Xa&&Xa.focus())}static THe(){const Xa=document.createElement("div");Xa.tabIndex=0;return Xa}static hcf(){document.body.classList.add(L.a.QRe)}static onBlur(){document.body.classList.remove(L.a.QRe)}}Object(u.a)(J,"EmbedViewFocusControl",I.a,[515,2]);var M=a(4),Q=a(1082),U=a(61),Z=a(523),P=a(24),S=a(40),ja=a(374),X=a(188),
Y=a(283),va=a(116),N=a(29),ea=a(282),Ca=a(281),la=a(60);const Ra=(Xa,ha,ta,wa,db,Jb,Pb,eb,Ma,ob,Ia=null)=>{Ia=Xa.Na(1,Ia);Ia.selectedRange=ha;Ia.richValueKeyPath=ta;Ia.singleColumn=wa;Ia.searchForRange=db;Ia.calculateMajorityDataType=Jb;return la.g(Xa,"GetRichValueFieldListContextList",Ia,Pb,eb,Ma,ob,4)};var lb=a(33);class Aa extends I.a{constructor(Xa,ha){super();this.aLb=this.zgd=this.axb=this.yP=null;this.RVb=!1;this.b8d=null;this.jJd=!1;this.BQi=(ta,wa,db)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
db);this.aLb&&this.aLb.stop();this.yP=null;this.raiseEvent(Q.h)};this.CQi=ta=>{ea.a(ta)||(this.aLb&&this.aLb.stop(),this.RVb=!1,(this.yP=ta.Result)&&0<this.yP.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.yP.length} rich value field list context for autocomplete`),this.kXa=!0,this.jtc())};this.kXa=!1;this.jb=Xa;this.DUb=-1;this.tableManager=ha;this.jJd=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&lb.a.HV(Xa)}$_b(Xa){this.addHandler(Q.a,
Xa)}Kuc(Xa){this.removeHandler(Q.a,Xa)}ELg(Xa){this.addHandler(Q.h,Xa)}Vgj(Xa){this.removeHandler(Q.h,Xa)}get r7a(){return this.kXa}get Kyi(){return this.RVb}get MZe(){return this.DUb}get f7c(){return this.b8d}get $(){return this.jb}get $k(){return this.yP}get oTh(){return!!this.axb}dispose(){this.jb=null;this.bdb();super.dispose()}x3i(){var Xa=Array(6);var ha={};ha.Name=Q.f;Xa[0]=ha;ha={};ha.Name=Q.c;Xa[1]=ha;ha={};ha.Name=Q.d;Xa[2]=ha;ha={};ha.Name=Q.g;Xa[3]=ha;ha={};ha.Name=Q.e;Xa[4]=ha;ha={};
ha.Name=Q.b;Xa[5]=ha;ha={ColumnName:"",ColumnIndex:-1};ha.FieldInfoDataList=Xa;Xa=[];Xa[0]=ha;this.JRd(Xa)}TZ(Xa,ha,ta,wa=null){if(Xa){this.d1c();this.m3b();var db=null,Jb=!1;if(!wa&&({Vab:Jb,$k:db}=this.bTj(Xa,ha,ta)).returnValue)if(this.jJd||this.JRd(db),this.RVb=!0,this.yP=db,this.jJd){if(!Jb){this.kXa=!0;this.jtc();return}}else if(this.yP&&0<this.yP.length&&(this.kXa=!0,this.jtc()),!Jb)return;this.Jig(Xa,wa,ha,ta,!1)}}Jig(Xa,ha,ta,wa,db){if(this.$.ea.Zb){this.$.Kb&&(this.aLb=this.$.Kb.Bc("WebServiceCall",
"GetRichValueFieldInfoListContext"));this.axb=null;var Jb=this.$.pa.ya.Wb();this.axb=Ra(this.$.pa.ya,Xa,ha,ta,wa,db,this.CQi,this.BQi,null,Jb)}else this.yP=null}bdb(){this.yP=null;this.kXa=!1;this.d1c();this.m3b();this.axb=null;this.DUb=-1}d1c(){Aa.arb(this.axb)}m3b(){Aa.arb(this.zgd)}jtc(){this.raiseEvent(Q.a)}Bn(Xa){Xa=S.D(Xa);--Xa.left;--Xa.right;return this.tableManager.Bn(Xa)}dLa(Xa){Xa.FirstColumn=Xa.FirstColumn;Xa.LastColumn=Xa.LastColumn;Xa.FirstRow=Xa.FirstRow;Xa.LastRow=Xa.LastRow;this.m3b();
this.zgd=null;return ja.a(this.$.userOperationManager,(ha,ta,wa)=>Y.i(this.$.pa.ya,Xa,Ca.b(ha,db=>{this.LQi(db)}),Ca.a(ta,ta,db=>{this.KQi(db)}),wa,null),ha=>new X.a(264,0,ha,80),null)}KQi(Xa){Xa=va.a.Pe(Xa.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${N.a.sc(Xa)}`)}LQi(Xa){if(ea.a(Xa))-315732528!==Xa.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${N.a.sc(Xa.Errors)}`);
else if(Xa&&Xa.Result){Xa=Xa.Result;var ha=Xa.HasHeaderRow;ha=new Z.AutofilterRange(Xa.TableRange.FirstRow+(ha?1:0)+1,Xa.TableRange.FirstColumn+1,Xa.TableRange.LastRow+1,Xa.TableRange.LastColumn+1,null,null,null,0,ha);this.DUb=Xa.TableRange.FirstColumn;(Xa=this.ZOf(!1,!0,ha))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.JRd(Xa)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}bTj(Xa,
ha,ta){let wa,db;db=null;wa=!1;if(Xa.SheetName!==this.$.ea.oa.sheetName)return{returnValue:!1,Vab:wa,dLa:!1,$k:db};let Jb;this.DUb=-1;if(ta){Jb=this.Bn(Xa);if(!Jb||!Jb.oba)return{returnValue:!1,Vab:wa,dLa:!1,$k:db};var Pb=D.h(this.$).Bb.H6e(Jb);this.b8d=Jb;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Pb&&0<Pb.count)return--Xa.FirstColumn,--Xa.LastColumn,this.zgd=this.dLa(Xa),{returnValue:!0,Vab:wa,dLa:!0,$k:db};Jb.top+=1;
Jb.right=S.D(Xa).right-1}else Jb=new Z.AutofilterRange(Xa.FirstRow+1,Xa.FirstColumn+1,Xa.LastRow+1,Xa.LastColumn+1,null,null,null,0,!1);if(Jb.top>Jb.bottom||Jb.left>Jb.right)return{returnValue:!0,Vab:wa,dLa:!1,$k:db};Xa=D.h(this.$);var eb=Xa.ib.width,Ma=Xa.ib.height;Pb=Xa.view.visibleArea;eb=new U.a(Pb.x-eb,Pb.y-Ma,Pb.width+eb,Pb.height+Ma);Ma=Xa.fg(Jb);if(!Pb||!Ma||!Xa.wjc(Jb))return{returnValue:!1,Vab:wa,dLa:!1,$k:db};eb.contains(Ma)||(wa=!0);db=this.ZOf(ha,ta,Jb);return{returnValue:!0,Vab:wa,dLa:!1,
$k:db}}JRd(Xa){Xa&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Xa.length} rich value field contexts from block cache`);this.RVb=!0;(this.yP=Xa)&&0<this.yP.length&&(this.kXa=!0,this.jtc())}ZOf(Xa,ha,ta){let wa;wa=null;const db=ta.clone();if(ha)for(let Jb=ta.right,Pb=0;Jb>=ta.left;--Jb){if(db.left=Jb,db.right=Jb,ha=this.F2e(db,!0,ta.left)){wa||(wa=[]);wa[Pb]=ha;if(Xa)break;++Pb}}else if(Xa=this.F2e(db,!1))wa=[],wa[0]=Xa;return wa}F2e(Xa,ha,ta=0){var wa=null;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var db=
D.h(this.$).Bb.A0h(Xa);if(db&&0<db.count){var Jb=Array(db.count);wa=0;for(var Pb of db.values)db={},db.Name=Pb,Jb[wa]=db,++wa;Pb="";db=-1;0<Xa.top&&ha&&(Xa=new P.Range(Xa.top-1,Xa.left,Xa.top-1,Xa.left,!1,!1),null!=D.h(this.$).Sb(Xa)&&null!=D.h(this.$).Sb(Xa).originalText&&(Pb=D.h(this.$).Sb(Xa).originalText),db=Xa.left-ta);wa={};wa.ColumnName=Pb;wa.ColumnIndex=db;wa.FieldInfoDataList=Jb}}else if((Pb=D.h(this.$).Bb.H6e(Xa))&&0<Pb.count){Jb=Array(Pb.count);wa=0;for(db of Pb)Pb={},Pb.Name=db,Jb[wa]=
Pb,++wa;Pb="";db=-1;0<Xa.top&&ha&&(Xa=new P.Range(Xa.top-1,Xa.left,Xa.top-1,Xa.left,!1,!1),Pb=D.h(this.$).Sb(Xa).originalText,db=Xa.left-ta);wa={};wa.ColumnName=Pb;wa.ColumnIndex=db;wa.FieldInfoDataList=Jb}return wa}static arb(Xa){Xa&&M.AFrameworkApplication.zd.au(Xa.qt)}}Object(u.a)(Aa,"FieldInfoManager",I.a,[245,2]);class da extends Aa{constructor(Xa,ha,ta,wa){super(Xa,ha);this.P2a=null;this.mCf=()=>{this.Kuc(this.mCf);if(this.$k&&this.$k.length&&this.contextMenuManager){var db=this.contextMenuManager.Nfd("autoFilterRichFieldList"),
Jb=window.document.getElementById(this.P2a);db.a1(null,Jb,this,null,!0)}};this.asg=ta;this.contextMenuManager=wa}get lH(){return this.asg}yTh(Xa,ha){this.P2a=ha;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Xa.FirstRow}, ${Xa.FirstColumn}, ${Xa.LastRow}, ${Xa.LastColumn})`);this.Jig(Xa,null,!0,!1,!0)}}Object(u.a)(da,"FilterInfoManager",Aa,[246,245,2]);var aa=a(839),fa=a(1094),Oa=a(30),
ba=a(89),ka=a(8);class Pa{}Pa.ixh="ewa-sharedUi-launchButton";Pa.lxh="ewa-sharedUi-launchButtonWithText";Pa.jxh="ewa-sharedUi-launchButtonClick";Pa.mxh="ewa-sharedUi-launchButtonWithTextClick";Pa.kxh="ewa-sharedUi-launchButtonText";Object(u.a)(Pa,"CssClassNames",null,[]);var Fa=a(66);a(518);var oa=a(239),La=a(224);I=a(238);var Ea=a(286),ca=a(71),$a=a(11),Qa=a(251),Va=a(34);class fb extends I.a{constructor(Xa,ha,ta,wa,db,Jb,Pb,eb,Ma){super(document.createElement("div"));this.Tof=null;this.WVd=!1;this.htmlSanitizationHelper=
this.mPb=this.ETa=null;this.fO=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.eO=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.IHj=()=>{this.Yne()};this.gd=ob=>{this.raiseEvent(this.cIb,ob);this.bIb();return!0};this.DOi=ob=>{100<t.a(y.a.Qa,this.Tof)&&this.Wkd(new Sys.UI.Point(Math.round(ob.clientX),Math.round(ob.clientY)))};this.aO=ob=>{ca.g(ob.Ca,!1);return!1};this.wZ=this.Ce.HIa();this.set_visible(!1);this.Yjc=db;this.cIb=Jb;this.Tnc=Xa;this.p4b=ha;this.htmlSanitizationHelper=Ma;this.Yjc&&
(this.ETa=m.a.instance.create(this.IHj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));Xa&&this.domElement.classList.add(Xa);this.DHa=document.createElement("div");this.domElement.appendChild(this.DHa);ta&&this.DHa.classList.add(ta);this.K0d(wa);Pb&&(this.mPb=document.createElement("div"),this.domElement.appendChild(this.mPb),this.mPb.classList.add(eb),this.mPb.innerText=Pb,this.domElement.style.padding="3px",oa.a.instance.sa(A.a.pointerDown,this.domElement,this.aO));this.d0a=new Ea.a(this.domElement,
7);La.a.instance.sa(A.a.click,this.domElement,this.gd);e.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&oa.a.instance.sa(A.a.pointerDown,this.domElement,this.aO);Xa=ob=>{ca.g(ob)};this.Gc.la("mouseup",Xa);this.Gc.la("click",Xa);this.Gc.la("dblclick",Xa)}S2(Xa){this.addHandler(this.cIb,Xa)}Jda(Xa){this.get_events().removeHandler(this.cIb,Xa)}vMg(Xa){this.addHandler("OnObjectButtonMouseOver",Xa)}Ehj(Xa){this.get_events().removeHandler("OnObjectButtonMouseOver",
Xa)}uMg(Xa){this.addHandler("OnObjectButtonMouseOut",Xa)}Dhj(Xa){this.get_events().removeHandler("OnObjectButtonMouseOut",Xa)}K0d(Xa){Xa&&(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.Ri(this.DHa,Xa):this.DHa.innerHTML=Xa)}xWj(Xa,ha,ta){e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?
this.htmlSanitizationHelper.QJ(this.DHa):this.DHa.innerHTML="";Xa?Xa.zba(ha,16,16,this.DHa,16,16,void 0,ta):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}yWj(Xa,ha){Xa&&(this.mPb.innerText=Xa);this.domElement.title=ha}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.hD(),ba.a.rc([this.wZ,this.d0a]),La.a.instance.Ba(A.a.click,this.domElement,this.gd),oa.a.instance.Ba(A.a.pointerDown,this.domElement,this.aO),this.ETa&&this.ETa.dispose(),
super.dispose())}$cb(){this.p4b&&this.domElement.classList.remove(this.p4b);this.Tnc&&this.domElement.classList.add(this.Tnc)}bIb(){this.Tnc&&this.domElement.classList.remove(this.Tnc);this.p4b&&this.domElement.classList.add(this.p4b);this.b3a()}b3a(){this.Yjc&&(this.ETa.cancel(),this.Zag(),this.setOpacity(1));this.set_visible(!0)}Sp(Xa,ha,ta,wa,db=!1){Xa=Va.a(wa).yi(Xa);ha=Va.a(wa).yi(ha);Va.a(wa).vyc(this.domElement);this.domElement.style.top=$a.HelperMethods.uc(ha);this.domElement.style.left=this.domElement.style.right=
"";ha=Xa;db&&(ha=Xa-this.domElement.offsetWidth);Qa.c(this.domElement.style,ta,$a.HelperMethods.uc(ha));this.set_visible(!0);this.setOpacity(1);this.Yjc&&(this.WVd=!1,this.BKj(),this.ETa.tq())}hide(){this.$cb();this.set_visible(!1);this.Yjc&&(this.Zag(),this.ETa.cancel())}s9b(){this.Gc.la("mouseover",this.fO,!0);this.Gc.la("mouseout",this.eO,!0)}BKj(){this.wZ.Oi("mousemove")||this.wZ.la("mousemove",this.DOi)}Zag(){this.wZ.Oi("mousemove")&&this.wZ.detach("mousemove")}Wkd(Xa){if(this.domElement.parentNode){var ha=
Sys.UI.DomElement.getBounds(this.domElement);const ta=new Sys.UI.Point(Math.round(ha.x+ha.width),Math.round(ha.y+ha.height));ha=Math.abs(ta.x-Xa.x);Xa=Math.abs(ta.y-Xa.y);Xa=ha>Xa?ha:Xa;this.WVd?this.setOpacity(fb.a_g(Xa)):100>=Xa&&this.Yne()}}Yne(){this.WVd=!0;this.ETa.cancel()}setOpacity(Xa){C.a.setOpacity(this.domElement,Xa);this.Tof=y.a.Qa.zb}static a_g(Xa){return 100>=Xa?1:250<=Xa?0:.01*(100-(Xa-100)/150*100)}}Object(u.a)(fb,"OnObjectButton",I.a,[532,146,2]);var Ka=a(792);const hb=Pa.kxh;class fc extends h.a{constructor(Xa,
ha,ta,wa,db,Jb,Pb,eb,Ma=""){super();this.Nka=null;this.Mcf=!1;this.htmlSanitizationHelper=this.rnc=this.snc=null;this.buttons={};this.KQe={};this.$=Xa;this.svgIconProvider=ha;this.ZMi=ta;this.agc=wa;this.$fc=db;this.altText=Jb;this.cIb=Pb;this.htmlSanitizationHelper=eb;this.buttonText=Ma}get Az(){return Va.a(this.$).XGa(ka.a.EUi)}get O3b(){return ka.a.DUi}get buttonWidth(){return Va.a(this.$).XGa(ka.a.FUi)}dispose(){this.Wmh();this.$=null;super.dispose()}getButton(Xa,ha=!0){return this.Fva(Xa,ha)}Fva(Xa,
ha=!0){const ta=Xa.toString();ta in this.buttons||this.Rch(Xa,ha);return this.buttons[ta]}Sp(Xa,ha,ta,wa,db=!0,Jb=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&Fa.i(this.$.oa)){var Pb=D.h(this.$).lS.domElement;const eb=Xa+this.buttonWidth-Pb.scrollWidth;Pb=ha+this.buttonWidth-Pb.scrollHeight;Xa=0<eb?Xa-eb:Xa;ha=0<Pb?ha-Pb:ha}this.Fva(wa,db).Sp(Xa,ha,ta,this.$,Jb)}hide(){const Xa=this.buttons;for(let ha in Xa)Xa[ha].hide()}s9b(Xa,ha){!this.Mcf&&(ha=this.buttons[ha.toString()])&&(this.snc=(ta,
wa)=>{Xa(wa,!0)},ha.vMg(this.snc),this.rnc=(ta,wa)=>{Xa(wa,!1)},ha.uMg(this.rnc),this.Mcf=!0,ha.s9b())}Rch(Xa,ha){this.Nka=String.format(this.agc===L.a.k$b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Oa.a.Hg(this.agc),Oa.a.Hg(this.$fc),"{0}");var ta=String.format(this.Nka,Oa.a.Hg(this.altText));ha=new fb(""===this.buttonText?Pa.ixh:Pa.lxh,""===this.buttonText?Pa.jxh:Pa.mxh,L.a.zt,
ta,ha,this.cIb,this.buttonText,hb,this.htmlSanitizationHelper);ta=(wa,db)=>{this.ZMi(db,Xa)};ha.S2(ta);this.buttons[Xa.toString()]=ha;this.KQe[Xa.toString()]=ta;ta=D.h(this.$).Df(Xa);ta.domElement.insertBefore(ha.domElement,ta.domElement.firstChild)}Wmh(){for(const Xa of Ka.a(this.buttons)){const ha=this.buttons[Xa];ha.Jda(this.KQe[Xa]);ba.a.Ia(ha);delete this.buttons[Xa];this.snc&&ha.Ehj(this.snc);this.rnc&&ha.Dhj(this.rnc)}}domElement(Xa){return this.Fva(Xa).domElement}b3a(Xa){this.Fva(Xa).b3a()}Gig(Xa,
ha){this.agc=Xa;this.$fc=ha}NQb(Xa,ha,ta=!0){this.Nka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Oa.a.Hg(this.agc),Oa.a.Hg(this.$fc),"{0}");Xa=String.format(this.Nka,Oa.a.Hg(Xa));this.Fva(ha,ta).K0d(Xa)}aVa(Xa,ha,ta){this.Fva(ta,!1).yWj(Xa,ha)}Eig(){this.Nka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Oa.a.Hg(this.$fc),"{1}");const Xa=String.format(this.Nka,void 0,
Oa.a.Hg(void 0));this.Fva(void 0,!1).K0d(Xa)}Fig(Xa,ha,ta){this.Fva(ta,!1).xWj(this.svgIconProvider,Xa,ha)}}Object(u.a)(fc,"OnObjectLaunchButton",h.a,[514,2]);h=a(95);class dc extends h.a{constructor(Xa,ha){super(Xa);this.KDb=null;this.Gmh=()=>{this.display()};this.ddi=Math.max(1,ha)}dispose(){ba.a.Ia(this.KDb);this.KDb=null;super.dispose()}UTa(){ba.a.Ia(this.KDb);this.KDb=m.a.instance.create(this.Gmh,this.ddi,x.a.Oyi)}$Ta(){ba.a.Ia(this.KDb);this.hide()}}Object(u.a)(dc,"LoadingIndicatorBehavior",
h.a,[531,2]);class wb extends dc{constructor(Xa,ha,ta,wa){super(Xa,ha);this.JDb=null;this.xug=ta;this.mai=wa;this.gIg()}dispose(){this.JDb=null;super.dispose()}display(){this.xug(this.JDb)}hide(){this.mai(this.JDb)}gIg(){this.JDb=document.createElement("div");this.domElement.appendChild(this.JDb)}}Object(u.a)(wb,"ShimmerLoadingIndicatorBehavior",dc,[]);var Tb=a(69),xb=a(52),cb=a(12);class jb extends dc{constructor(Xa,ha,ta,wa=null,db=null,Jb=0){super(Xa,ha);this.Owa=this.EOa=null;this.Owa=ta;this.fgc=
wa||xb.a.current.fo(104);this.Gqf=Jb;this.k7c=db;this.fIg()}dispose(){this.EOa=null;super.dispose()}display(){cb.DOMElementExtensions.setVisible(this.EOa,!0)}hide(){cb.DOMElementExtensions.setVisible(this.EOa,!1)}fIg(){this.EOa=document.createElement("div");this.EOa.classList.add(Tb.a.Wvh);const Xa=document.createElement("div");Xa.classList.add(Tb.a.Xvh);this.k7c&&""!=this.k7c&&Xa.classList.add(this.k7c);var ha=0===this.Gqf?"":H.a.instance.ga(this.Gqf);const ta=String.format('<div class="'+Tb.a.Yvh+
'">{0}</div>',ha);this.fgc?(ha=`<img src="${this.fgc}" alt="${ha}" title="${ha}"/>`,this.Owa?this.Owa.Ri(Xa,ha+ta):Xa.innerHTML=ha+ta):this.Owa?this.Owa.Ri(Xa,ta):Xa.innerHTML=ta;this.EOa.appendChild(Xa);this.domElement.appendChild(this.EOa)}}Object(u.a)(jb,"SpinnerLoadingIndicatorBehavior",dc,[]);class qa{constructor(Xa){this.Owa=Xa}j6c(Xa,ha,ta){return new aa.a(Xa,ha,ta)}n6b(Xa,ha,ta,wa,db,Jb,Pb,eb,Ma,ob){return new fa.a(Xa,ha,ta,wa,db,Jb,Pb,eb,Ma,ob)}Wsb(Xa,ha,ta,wa,db=0){return new jb(Xa,ha,this.Owa,
ta,wa,db)}Xhd(Xa){return Xa.da.Aa(238)||new J(Xa)}q6b(Xa,ha,ta,wa,db,Jb,Pb,eb=""){return new fc(Xa,ha,ta,wa,db,Jb,Pb,this.Owa,eb)}M5c(Xa,ha){return new Aa(Xa,ha)}Kbh(Xa,ha,ta,wa){return new da(Xa,ha,ta,wa)}s5c(Xa,ha,ta,wa){return new w(Xa,ha,ta,wa)}}Object(u.a)(qa,"SharedUIControlsFactory",null,[504]);var za=a(49);class Na extends b.a{constructor(Xa){super();this.$=Xa;this.Fb()}create(){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const Xa=
za.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);n.TaskExtensions.za(Xa,()=>{e.EwaSettings.ml()?this.nb(this.$.da.Aa(12)||new qa(Xa.result)):this.nb(new qa(Xa.result))},this.ka,3)}else e.EwaSettings.ml()?this.nb(this.$.da.Aa(12)||new qa(null)):this.nb(new qa(null))}static la(Xa){Xa.da.Ga(477,new Na(Xa))}}Object(u.a)(Na,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(F,"a",function(){return ua});const ua=()=>{c.a.Fa(Na.la)}},1168:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(49),f=a(37),
d=a(1),h=a(813);class n extends b.a{constructor(Ia){super();this.$=Ia;this.Fb()}create(){const Ia=e.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya),Da=e.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Ia,Da],this.ka),()=>{this.nb(this.$.da.Aa(296)||this.$.da.Ga(296,new h.BorderFormatManager(this.$,Ia.result,Da.result)))},this.ka,3)}static la(Ia){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&Ia.da.Ga(468,
new n(Ia))}}Object(u.a)(n,"BorderFormatManagerFactory",b.a,[]);var m=a(694),x=a(15),r=a(263),y=a(171),t=a(826),v=a(27),w=a(39),C=a(30),B=a(96),z=a(260),A=a(357),E=a(354),I=a(98),L=a(187),V=a(8),T;(function(Ia){Ia[Ia.insert=1]="insert";Ia[Ia.delete=2]="delete";Ia[Ia.rows=4]="rows";Ia[Ia.columns=8]="columns";Ia[Ia.cellsShiftHorizontal=16]="cellsShiftHorizontal";Ia[Ia.cellsShiftVertical=32]="cellsShiftVertical";Ia[Ia.insertRows=5]="insertRows";Ia[Ia.insertColumns=9]="insertColumns";Ia[Ia.insertCellsShiftRight=
17]="insertCellsShiftRight";Ia[Ia.insertCellsShiftDown=33]="insertCellsShiftDown";Ia[Ia.deleteRows=6]="deleteRows";Ia[Ia.deleteColumns=10]="deleteColumns";Ia[Ia.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";Ia[Ia.deleteCellsShiftUp=34]="deleteCellsShiftUp";Ia[Ia.insertRowsBelow=37]="insertRowsBelow"})(T||(T={}));Object(u.b)("InsertDeleteCellFlags",T);var H=a(5),D=a(425),G=a(66),J=a(76);class M{constructor(Ia){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=Ia}}Object(u.a)(M,
"MacroRecorderRangeInsertedOrDeletedPayload",null,[108]);var Q=a(1080),U=a(40),Z=a(374),P=a(188),S=a(60),ja=a(283),X=a(142),Y=a(461),va=a(113),N=a(52),ea=a(199),Ca=a(92),la=a(35),Ra=a(29),lb=a(282),Aa=a(257),da=a(11),aa=a(184),fa=a(22),Oa=a(281);class ba{constructor(Ia,Da,nb,Ua,W=0){this.Hvg=Ia;this.Ivg=Da;this.sDg=nb;this.CYb=Ua;this.oIh=W}get yja(){return this.Hvg}get formattedText(){return this.Ivg}get style(){return this.sDg}get size(){return this.CYb}get OZ(){return this.oIh}static IXg(Ia,Da){return new ba(Ia,
Da,null,null,null)}static f0c(Ia,Da){return new ba(Ia,null,Da,null,null)}static JXg(Ia,Da){return new ba(Ia,null,null,Da,null)}static HXg(Ia,Da,nb){return new ba(Ia,null,Da,null,nb)}}Object(u.a)(ba,"CachedPreviewCellGroup",null,[]);var ka=a(83);b=a(284);var Pa=a(100),Fa=a(13);class oa extends b.a{constructor(Ia,Da,nb){super(Ia);this.Pl=null;this.A8c=0;this.Zgi=(Ua,W)=>{if(0===Ua)x.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Ua=
{};var sa="",vb=1035996630;switch(W.selectedKey){case 0:sa=1896159024===this.Nr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:sa=1896159024===this.Nr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.Nr?(sa="InsertRows",vb=-1113896058):(sa="DeleteRows",vb=1554436520);break;case 3:1896159024===this.Nr?(sa="InsertColumns",vb=1415868706):(sa="DeleteColumns",vb=674605324)}x.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${sa}`);
W=new Ca.a(vb,1,2,8,null);Ua[J.a.Jc]=sa;this.$.Ja.Lb(W,Ua)}};this.Nr=Da;this.selectedRanges=nb;this.isRtl=Object(ka.a)(Pa.a,this.$.xa.oa).displayRtl}get qc(){return"InsertDeleteCellsDialog"}hg(){1896159024===this.Nr?(this.Pl=Fa.a.instance.ga(23),this.A8c=0):(this.Pl=Fa.a.instance.ga(22),this.A8c=1);const Ia=this.selectedRanges[0].E_&&!this.selectedRanges[0].R5?0:1;this.Rb=1;this.initializeAndShow(this.Pl,this.Zgi,{[oa.vu]:this.qc,["dialogToDisplay"]:this.A8c,["defaultSelectedKey"]:Ia,["isRtl"]:this.isRtl})}}
Object(u.a)(oa,"InsertDeleteCellsDialog",b.a,[]);const La=(Ia,Da,nb,Ua,W,sa,vb=null)=>{vb=Ia.Na(41,vb);vb.insertDeleteMultiRangeParameters=Da;return S.g(Ia,"InsertDeleteCells",vb,nb,Ua,W,sa,0)};class Ea{constructor(Ia,Da,nb,Ua){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=Ia;this.targetSheetRange=Da;this.fillRangeType=nb;this.fillRangeDirection=Ua}}Object(u.a)(Ea,"MacroRecorderRangeFilledPayload",null,[108]);var ca=a(7),$a=a(24);
class Qa{constructor(){this.VRa=this.xHa=this.tOa=this.HUa=0}}Object(u.a)(Qa,"RangeBorders",null,[]);class Va{constructor(){this.scenario=0;this.HQ=null}}Object(u.a)(Va,"ScenarioInfo",null,[]);var fb=a(910),Ka=a(21),hb=a(262),fc=a(209),dc=a(79);class wb{constructor(Ia,Da){this.$=Ia;this.sg=Da;this.Ix=new fb.a(Ka.h(this.$).Da,this.$);this.uAb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Grd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.Lic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Xif=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.uli=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.Xmf=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.vjc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.jBb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Mic=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Ooi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Bli=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.Tgf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.Uif=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.gpi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.xui=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}Ali(Ia,Da){return!(void 0===Da||null===Da)&&!!(Da.scenario&16384)&&!this.Cli(Ia,Da)&&this.Mgf(Da,Ia)}A4e(){var Ia=w.a.Ud(),Da=Ka.h(this.$),nb=Da.ha.ra.selectedRanges;let Ua=0;var W=
0,sa=nb.length;const vb=new Va;if(1<sa)return vb.scenario=4,vb;if(this.Uif&&Da.Xd.cjc(nb[0]))return vb.scenario=262144,vb;this.Grd&&Ka.h(this.$).rtl&&(Ua|=65536);if(!Da.MK(nb[0]))if(this.uAb)Ua|=32;else return vb.scenario=32,vb;if(Da=Da.Da.Uva(nb[0],this.$.activeItemName)){vb.A_c=Da;for(var gc of Da)if(W+=1,1<W){this.uAb?(Ua|=256,vb.scenario=Ua):vb.scenario=256;if(!this.jBb)return vb;break}}W=Ka.h(this.$).Da.Jja(nb[0]);if(!W)return vb.scenario=32768,vb;gc=W.length;nb=nb[0];Da=nb.bottom-nb.top+1;sa=
nb.right-nb.left+1;const Bc=new Qa;for(let Sa=0;Sa<gc;Sa++)if(this.p_h(W[Sa],nb,Bc),Ua=Ua|(void 0!==W[Sa].text&&null!==W[Sa].text&&""!==W[Sa].text?1:0)|(W[Sa].QF?2:0)|(W[Sa].ywa?8:0)|(W[Sa].zyb?16:0)|(W[Sa].rB?64:0)|(W[Sa].uV?128:0),void 0!==W[Sa].text&&null!==W[Sa].text&&""!==W[Sa].text||W[Sa].ywa)if(void 0===vb.HQ||null===vb.HQ)vb.HQ=Ka.h(this.$).Sb(W[Sa].getRange());else{if(W[Sa].getRange().top<vb.HQ.range.top||W[Sa].getRange().top==vb.HQ.range.top&&W[Sa].getRange().left<vb.HQ.range.left)vb.HQ=
Ka.h(this.$).Sb(W[Sa].getRange());Ua|=16384}Bc.HUa===sa&&(Ua|=512);Bc.xHa===sa&&(Ua|=2048);Bc.tOa===Da&&(Ua|=4096);Bc.VRa===Da&&(Ua|=1024);if(0<Bc.HUa&&Bc.HUa<sa||0<Bc.xHa&&Bc.xHa<sa||0<Bc.tOa&&Bc.tOa<Da||0<Bc.VRa&&Bc.VRa<Da)Ua|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||nb.right!==nb.maxColumns&&nb.bottom!==nb.maxRows||(Ua|=131072);Ia=w.a.Ud()-Ia;x.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${Ia}`);vb.scenario=
Ua;return vb}lvf(Ia,Da){const nb=Ia.command;if(void 0===Da||null===Da)Da=this.A4e();if(!this.Mgf(Da,nb))return!1;Ia=Ka.h(this.$).ha.ra.selectedRanges;var Ua=Ka.h(this.$).Da.Jja(Ia[0]);if(!Ua)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Ua.length&&!Ua[0].QF)return-167499203===nb?(Ua[0].V0(2,!0),!0):!1;Ua=Ka.h(this.$).ha.ra.Ds;const W=this.$.oa.sheetName;let sa=!0;switch(nb){case -167499203:2===(Da.scenario&2)&&this.Lic?this.Pgg(Da.scenario,Ia,
nb):sa=this.IFi(Da,Ia);break;case 1097660126:(Da=this.mvf(Da,Ia))&&0!=Da.length||(sa=!1);break;case 155820588:this.Pgg(Da.scenario,Ia,nb);break;default:return!1}Ka.h(this.$).T4(Ia,Ua,W,null,Ia[0],null,null,0,"MergeCellCommandAction");return this.jBb?sa:!0}Mgf(Ia,Da){const nb=this.oki(Ia,Da);if(!this.Xif)return nb;const Ua=Ka.h(this.$).ha.ra.selectedRanges[0].Ew(!1);x.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${Da.toString()}; Scenario Number: ${Ia.scenario}; IsCSEPossible result: ${nb}; Range: ${Ua}`);
return nb}oki(Ia,Da){if(-255094134===Da)return!1;var nb=Ia.scenario;if(this.Uif&&262144===nb||this.Grd&&65536===(nb&65536))return!1;if(this.Wmf(Da,Ia))return nb=Ka.h(this.$).ha.ra.selectedRanges,0===nb.length?!1:this.Eti(Da,Ia,nb[0]);this.uAb&&32===(nb&32)&&(nb&=-33);if(256==(nb&256))if(this.fpi(Ia))nb&=-257;else return!1;return 32768===nb||4===nb||128===(nb&128)||!this.uAb&&32===nb?!1:-167499203!=Da&&1097660126!==Da||!this.ypd(Ia)?void 0!==Ia.HQ&&null!==Ia.HQ&&Ia.HQ.LX?!1:0===nb?!0:16384===(nb&16384)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(nb&1)&&8!==(nb&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Mic}omi(Ia){return 131072===(Ia.scenario&131072)?!0:!1}fpi(Ia){if(!this.jBb)return!1;let Da="Multi block",nb=!0;this.ypd(Ia)&&(Da+=" with border",nb=!1);this.omi(Ia)&&(nb=!1,Da+=" with entire row or column selected",16384===(Ia.scenario&16384)&&(Da+=" and a data loss scenario"));
nb||x.ULS.sendTraceTag(523511383,0,50,`CSE for ${Da}, is not enabled`);return nb}ypd(Ia){return 16===(Ia.scenario&16)||this.sld(Ia.scenario)||this.Lld(Ia.scenario)||this.Eld(Ia.scenario)||this.Nld(Ia.scenario)||8192===(Ia.scenario&8192)?!0:!1}Cli(Ia,Da){return this.Bli?this.Wmf(Ia,Da):155820588===Ia}Wmf(Ia,Da){return 155820588===Ia||(-167499203===Ia||1097660126===Ia)&&2===(Da.scenario&2)&&this.Lic?!0:!1}Dti(Ia){return this.Nld(Ia.scenario)||this.Eld(Ia.scenario)||this.sld(Ia.scenario)||this.Lld(Ia.scenario)?
!0:!1}n$h(Ia){Ia=Ka.h(this.$).Da.Jja(Ia);if(!Ia||0===Ia.length)return!1;for(let Da=0;Da<Ia.length;Da++)if(Ia[Da].QF&&Ia[Da].LX)return!0;return!1}Eti(Ia,Da,nb){if(1097660126===Ia&&2===(Da.scenario&2))return!1;if(this.xui){if(this.n$h(nb))return!1}else if(this.uli&&void 0!==Da.HQ&&null!==Da.HQ&&Da.HQ.LX)return!1;this.uAb&&32===(Da.scenario&32)&&(Da.scenario&=-33);return 32768===Da.scenario||4===Da.scenario||256===(Da.scenario&256)&&this.Ooi||128===(Da.scenario&128)?!1:2===(Da.scenario&2)?this.Dti(Da)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}p_h(Ia,Da,nb){const Ua=Ia.getRange();if(Ua.top===Da.top)if(Ia.iMa)nb.HUa+=Ua.right-Ua.left+1;else{var W=this.Ix.LQ(Ua,0);if(W)for(const vb of W)vb.cMa&&(nb.HUa+=vb.getRange().right-vb.getRange().left+1)}if(Ua.left===Da.left)if(Ia.eMa)nb.tOa+=Ua.bottom-Ua.top+1;else if(W=this.Ix.LQ(Ua,2))for(var sa of W)sa.gMa&&
(nb.tOa+=sa.getRange().bottom-sa.getRange().top+1);if(Ua.bottom===Da.bottom)if(Ia.cMa)nb.xHa+=Ua.right-Ua.left+1;else if(sa=this.Ix.LQ(Ua,1))for(const vb of sa)vb.iMa&&(nb.xHa+=vb.getRange().right-vb.getRange().left+1);if(Ua.right===Da.right)if(Ia.gMa)nb.VRa+=Ua.bottom-Ua.top+1;else if(Ia=this.Ix.LQ(Ua,3))for(const vb of Ia)vb.eMa&&(nb.VRa+=vb.getRange().bottom-vb.getRange().top+1)}Hej(Ia,Da){for(let nb of Da.A_c){Da=Ia.Ie(nb.pf);Da=Ka.h(this.$).Da.Jja(Da);const Ua=Da.length;for(let W=1;W<Ua;W++){const sa=
Ka.h(this.$).Sb(Da[W].getRange());this.Mic?sa.cell.deleteCellFromModel():(sa.trb(),sa.clearFormat(),sa.cell.Iej());sa.LJb(!0)}}}UZj(Ia,Da){Ia.backgroundColor=Da.backgroundColor;Ia.color=Da.color}$ng(Ia,Da){return{SpansBlocks:!0,OriginRow:Ia,OriginColumn:Da,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}PGg(Ia,Da,nb,Ua,W){nb=Ia.Ie(nb.pf);if(!nb)return x.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),
null;var sa=new $a.Range(Ia.top,Ia.left,nb.top,nb.left,!1,!1);let vb;nb.top==Ia.top?vb=0:(sa.bottom=nb.top-1,vb=Da.yid(sa));nb.left==Ia.left?sa=0:(sa.right=nb.left-1,sa=Da.zid(sa));Da=this.$ng(Ia.top-1,Ia.left-1);Da.OriginDeltaY=vb;Da.OriginDeltaX=sa;Da.Rows=nb.bottom-nb.top;Da.Columns=nb.right-nb.left;Da.Height=W;Da.Width=Ua;nb.top==Ia.top&&nb.left==Ia.left&&(Da.IsOrigin=!0);Ia=Ka.h(this.$).Sb(nb.topLeft);Ia.cell.A4f(Da);return Ia}lSd(Ia,Da){let nb=[];const Ua=Ka.h(this.$).Xd;if(!Ua)return nb;const W=
Ua.yid(Ia),sa=Ua.zid(Ia);if(Da.A_c)for(const vb of Da.A_c)if(Da=this.PGg(Ia,Ua,vb,sa,W))nb.push(Da);else{nb=[];break}return nb}r0h(Ia,Da,nb,Ua){var W=nb.bottom-nb.top,sa=nb.right-nb.left;let vb=[];const gc=Ua.scenario;if(256===(gc&256)){if(vb=this.lSd(nb,Ua),!vb||0==vb.length)return vb}else Da.cell.lSd(W,sa),vb.push(Da);W=this.s3(this.m5(Da),!0,0,gc,"merge");if(void 0!==Ia&&null!==Ia)for(const Bc of vb){sa=Ia.cell.formattedText;const Sa=Object(ca.a)(new hb.a,{TextRuns:sa.TextRuns,Fonts:sa.Fonts});
Sa.Text=void 0!==Ia.cell.originalText&&null!==Ia.cell.originalText?Ia.cell.originalText:void 0!==Ia.cell.userInput&&null!==Ia.cell.userInput?Ia.cell.userInput:sa.Text;W=this.s3(this.m5(Bc),W,1,gc,"merge");this.sg.vTa(Bc,Sa,!1,!0,"MergeCells",1);W=this.s3(this.m5(Bc),W,2,gc,"merge");this.Grd?Bc.Drb(Ia):this.UZj(Bc,Ia);W=this.s3(this.m5(Bc),W,3,gc,"merge");Bc.cell.X9g(Ia.cell);W=this.s3(this.m5(Bc),W,4,gc,"merge");Bc.cell.tEc(!1);W=this.s3(this.m5(Bc),W,6,gc,"merge")}this.Hej(nb,Ua);this.s3(this.m5(Da),
W,5,gc,"merge");return vb}Eld(Ia){return 4096===(Ia&4096)}Nld(Ia){return 512===(Ia&512)}sld(Ia){return 2048===(Ia&2048)}Lld(Ia){return 1024===(Ia&1024)}Ubc(Ia,Da){let nb=null;for(let Ua=0;Ua<Ia.length;Ua++)if(Ia[Ua].BorderPosition===Da){nb=Ia[Ua];break}return nb}yWh(Ia,Da){this.vjc?(Da=this.Ubc(Da.cell.jN().Borders,2))&&Ia.push(Da):(Da=Da.cell.jN().Borders,1<Da.length&&(Da=[Da[1]]),Ia=[...Da,...Ia]);return Ia}F3h(Ia,Da){this.vjc?(Da=this.Ubc(Da.cell.jN().Borders,0))&&Ia.push(Da):(Da=Da.cell.jN().Borders,
1<Da.length&&(Da=[Da[0]]),Ia=[...Da,...Ia]);return Ia}tOh(Ia,Da){Da=this.Ix.LQ(Da.cell.getRange(),1);if(!Da||0===Da.length)return Ia;if(this.vjc){if(Da=Da[0].jN().Borders,Da=this.Ubc(Da,0))Da.BorderPosition=1,Ia.push(Da)}else{let nb=[];0<Da.length&&(nb=Da[0].jN().Borders);nb[0].BorderPosition=1;Ia=[...nb,...Ia]}return Ia}B0h(Ia,Da){Da=this.Ix.LQ(Da.cell.getRange(),3);if(!Da||0===Da.length)return Ia;if(this.vjc){if(Da=Da[0].jN().Borders,Da=this.Ubc(Da,2))Da.BorderPosition=3,Ia.push(Da)}else{let nb=
[];0<Da.length&&(nb=Da[0].jN().Borders);nb[0].BorderPosition=3;Ia=[...nb,...Ia]}return Ia}q_h(Ia,Da,nb){this.Eld(Ia.scenario)&&(Da=this.yWh(Da,nb));this.Nld(Ia.scenario)&&(Da=this.F3h(Da,nb));this.sld(Ia.scenario)&&(Da=this.tOh(Da,nb));this.Lld(Ia.scenario)&&(Da=this.B0h(Da,nb));return Da}RZ(Ia){if(0===Ia.length)return null;let Da=[0,0,0,0],nb=[1,1,1,1],Ua=0;Ia.forEach(function(sa){let vb=sa.BorderPosition;nb[vb]=sa.BorderLineStyle;let gc=new fc.a(sa.Color.Red,sa.Color.Green,sa.Color.Blue);Da[vb]=
gc.BS();Ua|=da.HelperMethods.C4a(sa.BorderPosition)});Ia={};Ia.LineStyle=nb;Ia.Color=Da;let W={};W.BorderFormat=Ia;W.Border=Ua;return W}u4d(Ia,Da,nb=null){let Ua=[];Ua=null!==nb?[...nb]:this.q_h(Da,Ua,Ia);if(Da=this.RZ(Ua))Ia.cell.tcb(Ia.cell.getRange()),this.Ix.KJb(Ia.cell.getRange()),this.sg.oea(Ka.h(this.$),-1690267012,Da,!1,null,[Ia.cell.getRange()])}rqi(Ia){return 512===(Ia.scenario&512)||4096===(Ia.scenario&4096)||1024===(Ia.scenario&1024)||2048===(Ia.scenario&2048)?!0:!1}G3h(Ia){Ia=this.Ix.LQ(Ia.cell.getRange(),
1);return Ia&&0!==Ia.length?Ia[0].iMa?(Ia=Ia[0].jN().Borders[0],Ia.BorderPosition=1,Ia):null:null}H3h(Ia){Ia=this.Ix.LQ(Ia.cell.getRange(),3);return Ia&&0!==Ia.length?Ia[0].eMa?(Ia=Ia[0].jN().Borders[0],Ia.BorderPosition=3,Ia):null:null}c8h(Ia,Da,nb,Ua,W){Da.cell.Sig();if(this.rqi(Ia))this.u4d(Da,Ia);else{const sa=8192===(Ia.scenario&8192),vb=Da.cell.getRange();sa&&this.Tgf?(Da.cell.tcb(),this.Ix.KJb(vb)):W?(W=[],null!==nb&&W.push(nb),null!==Ua&&W.push(Ua),0<W.length?this.u4d(Da,Ia,W):(Da.cell.tcb(),
this.Ix.KJb(vb))):sa&&!this.Tgf&&(Da.cell.tcb(),this.Ix.KJb(vb))}}TVh(Ia,Da){return null===Ia||void 0===Ia?!0:Ia.cell.getRange().top===Da.topLeft.top&&Ia.cell.getRange().left===Da.topLeft.left&&Ia.cell.getRange().bottom===Da.topLeft.bottom&&Ia.cell.getRange().right===Da.topLeft.right?!0:!1}IFi(Ia,Da){Da=this.mvf(Ia,Da);if(this.jBb&&(!Da||0==Da.length))return!1;for(let nb=0;nb<Da.length;nb++)Da[nb].V0(2,!0),this.s3(this.m5(Da[nb]),!0,8,Ia.scenario,"merge");return!0}sYj(Ia){const Da=Ka.h(this.$).Da.Uva(Ia,
this.$.activeItemName);if(Da&&dc.Ct(Da))for(let nb of Da)nb.i1d(Ia,!0)}mvf(Ia,Da){const nb=Ia.HQ,Ua=Ka.h(this.$).Sb(Da[0]);let W=null,sa=null;this.Mic&&(W=this.G3h(Ua),sa=this.H3h(Ua));const vb=this.r0h(nb,Ua,Da[0],Ia);if(this.jBb&&(!vb||0==vb.length))return vb;this.gpi?this.sYj(Da[0]):Ka.h(this.$).Da.y$(Da[0],this.$.activeItemName).i1d(Da[0],!0);this.s3(this.m5(Ua),!0,9,Ia.scenario,"merge");if(this.Mic&&this.ypd(Ia)){Da=this.TVh(nb,Da[0]);for(const gc of vb)this.c8h(Ia,gc,W,sa,Da)}return vb}ZQg(Ia,
Da,nb){if(!(1>Ia.Borders.length)){var Ua=this.RZ(Ia.Borders);nb.forEach(W=>{W=Ka.h(this.$).Sb(W.getRange());this.sg.V8f(-1690267012,W,Ua,!1,null,!1,Da)})}}RUj(Ia,Da,nb){const Ua=Ia.length;for(let sa=0;sa<Ua;sa++){Ia[sa].cell.tEc();const vb=Ia[sa].cell.getRange(),gc=Ka.h(this.$).Da.Jja(vb),Bc=gc.length;if(-167499203===Da&&this.Lic){var W=0;2===Ia[sa].cell.bKd||1===Ia[sa].cell.YE?W=3:2===Ia[sa].cell.YE&&(W=1);Ia[sa].V0(W,!1)}for(W=1;W<Bc;W++)gc[W].attachCellToModel(),gc[W].Drb(Ia[sa]),-167499203===
Da&&this.Lic&&gc[W].V0(null,!1);this.Xmf&&nb&&this.ZQg(nb[sa],vb,gc)}}U_e(Ia,Da){let nb=null;for(let Ua=0;Ua<Ia.length;Ua++)if(Ia[Ua].BorderPosition===Da){nb=Ia[Ua];break}return nb}sOh(Ia,Da){let nb=Ia.cell.jN();Ia.cMa()&&Ia.cell.nRa(1);Ia.gMa()&&Ia.cell.nRa(3);if((Ia=this.Ix.LQ(Da,0))&&Ia[0].cMa){var Ua=Ia[0].jN().Borders;Ua=this.U_e(Ua,1);Ua.BorderPosition=0;nb.Borders.push(Ua);Ia.forEach(W=>{W.nRa(1)})}(Da=this.Ix.LQ(Da,2))&&Da[0].gMa&&(Ia=Da[0].jN().Borders,Ia=this.U_e(Ia,3),Ia.BorderPosition=
2,nb.Borders.push(Ia),Da.forEach(W=>{W.nRa(3)}));return nb}Pgg(Ia,Da,nb){var Ua=Ka.h(this.$).Da.Vva(Da[0],this.$.activeItemName);const W=Ka.h(this.$).Da.y$(Da[0],this.$.activeItemName),sa=[];if(void 0!==Ua&&null!==Ua&&(Da=Ka.h(this.$).Tja(Da[0],Ua),void 0!==Da&&null!==Da)){Da=Da.$$ge();for(Ua=[];Da.$$mn();){var vb=Da.$$cu();if(vb.$H){sa.push(vb);this.s3(this.m5(vb),!0,10,Ia,"unmerge");vb.cell.F3g();const gc=vb.cell.getRange();this.s3(this.m5(vb),!1,11,Ia,"unmerge");W.i1d(gc,!1);this.Xmf&&(vb=this.sOh(vb,
gc),Ua.push(vb))}}0<sa.length&&(W.sf.resetCellLookup(),this.RUj(sa,nb,Ua))}}s3(Ia,Da,nb,Ua,W){if(!this.Xif)return!1;Ia!==Da&&x.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${nb}; Scenario: ${Ua}; Command: ${W}; Expected: ${Da?"populated":"empty"}; Actual: ${Ia?"populated":"empty"}`);return Ia}m5(Ia){return!!Ia.cell.cell.Merge}}Object(u.a)(wb,"MergeCellCommandAction",null,[]);var Tb=a(64),xb=a(175),cb=a(44),jb=a(380),qa=a(288),za=a(51),Na=a(70),
ua=a(55),Xa=a(1088),ha=a(33),ta=a(346),wa=a(145),db=a(212),Jb=a(4),Pb=a(174);class eb{constructor(Ia,Da,nb,Ua,W,sa,vb){this.$=Ia;this.gridView=Da;this.sg=nb;this.OB=Ua;this.borderFormatManager=W;this.moreColorsHelper=sa;this.fontDropdownHelper=vb;this.NC=null;this.u0a=1461300262;this.H5b=this.Bx=this.r0a=this.X9a=this.dbc=null;this.KSi=(gc,Bc,Sa)=>{const na=!!gc&&!!gc.RequestTelemetryData;!lb.a(gc)&&Bc&&Ka.h(this.$).Eh.Yla(Bc,gc.StateId,na?gc.RequestTelemetryData.EcsOperationDuration:0,na?gc.RequestTelemetryData.EcsRequestDuration:
0,na?gc.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){Bc=1;if(33===Sa||17===Sa||9===Sa||5===Sa||37===Sa)Bc=0;this.p1(Bc,gc)}};this.tPi=gc=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.p1(3,gc)};this.xrb=()=>{this.gridView.t7a&&(this.copyPasteInfrastructure&&this.copyPasteInfrastructure.Qhj(this.xrb),
this.gridView.t7a=!1,this.gridView.yf.gm(H.a.SQ),this.gridView.ha.RW(this.Rdd),Ka.h(this.$).$.df())};this.Rdd=()=>{var gc=this.dbc;this.dbc=G.d(this.$.xa.oa);gc===this.dbc&&(this.gridView.ha.RW(this.Rdd),this.copyPasteInfrastructure&&this.copyPasteInfrastructure.T0c(36,Ka.h(this.$).ha.ra.selectedRanges)?(gc=new Ca.a(1804571062,2,2,0,null),this.$.Ja.Lb(gc,{[H.a.skipClipboardAccess]:!0,[H.a.v2c]:!0,[H.a.isFormatPainter]:!0}).continueWith(()=>{this.xrb()})):this.gridView.yf.pH(!1))};this.yc=()=>{this.oK&&
x.ULS.sendTraceTag(509690145,0,50,`GridCommandHandler::onWorkbookClosing: Font Usage Telemetry - {"newFontCount":${this.oK.MAd},"oldFontCount":${this.oK.cCd},"setFontCount":${this.oK.TRd},"hoverFontCount":${this.oK.Nmd},"menuOpenCount":${this.oK.nzd}}`)};this.xb=d.EwaSettings.xb();this.mergeCellCommandAction=new wb(this.$,nb);this.DD=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Vl=d.EwaSettings.Vl();this.rl=ha.a.rl();this.vB=ha.a.vB(this.$);if(this.iic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:7376562_TelemetryForFontUsage"))this.oK=
{MAd:0,cCd:0,TRd:0,Nmd:0,nzd:0},this.$.Xj(this.yc)}get Olf(){return r.a.all(this.gridView.ha.ra.selectedRanges,Ia=>Ia.isRow)}get Klf(){return r.a.all(this.gridView.ha.ra.selectedRanges,Ia=>Ia.hf)}get themesManager(){this.Bx||(this.Bx=this.$.da.Aa(422));return this.Bx}p1(Ia,Da){const nb=this.$.da.Aa(465);nb&&nb.p1(Ia,Da)}eoi(Ia){return 1896159024===Ia||-1554384558===Ia||-1113896058===Ia||1554436520===Ia||1415868706===Ia||674605324===Ia||1035996630===Ia}nc(Ia,Da){return 2054778433===Da&&Ia&1?!Y.a(this.$).yjc:
600686207===Da?!1:this.eoi(Da)&&r.a.any(this.gridView.ha.ra.selectedRanges,nb=>nb.hf||nb.isRow)&&!this.Olf&&!this.Klf?!0:this.Wjc(Ia,Da)}executeCommand(Ia,Da,nb){return this.Lb(Da,nb)}wc(Ia,Da,nb){if(Ia=1===Ia)switch(Da.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ia=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:Ia=
!!nb;break;case 862825906:case 1532790410:case 46555851:case -1522760979:Ia=!0;break;default:Ia=!1}return Ia}Kc(Ia,Da,nb){switch(Da){case "PopulateFontColor":nb.MenuItems=this.OB.ecc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,nb.MenuId);break;case "PopulateFillColor":nb.MenuItems=this.OB.ecc(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,nb.MenuId);break;case "PopulateBorderColor":nb.MenuItems=this.OB.ecc(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,nb.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.w8h(nb);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.rl&&(this.fontDropdownHelper.$wj(nb.MenuId),!this.fontDropdownHelper.Vmi()))return!1;nb.MenuItems=this.fontDropdownHelper.o_e(-1293291468,324978188,-1428968098,nb.MenuId);this.iic&&(this.oK.nzd+=1);break;default:return!1}return!0}Wjc(Ia,Da){const nb=Ka.h(this.$).ha.ra.selectedRanges;return!(new X.a(this.$.xa)).xm(Ia,
Da,nb,this.gridView)}Lb(Ia,Da){var nb=this.gridView;const Ua=Ia.command;var W=f.TaskExtensions.Uj();let sa=!0;switch(Ua){case -1077965542:sa=this.n$e(Da,Ia,!1);break;case 909774670:this.Jqb(Ua);sa=this.n$e(Da,Ia,!0);break;case -1293291468:sa=this.l$e(Da,Ia,!1);break;case 324978188:this.Jqb(Ua);sa=this.l$e(Da,Ia,!0);break;case 862890474:case 963349338:sa=this.Q7h(Ia);break;case -1832800737:sa=this.Gec(Ua,Da,!1,Ia);break;case 1970784898:sa=this.Gec(Ua,Da,!1,Ia);break;case -803000997:sa=this.Gec(Ua,
Da,!1,Ia);break;case -128950598:case 1688184685:this.Jqb(Ua);sa=this.Gec(Ua,Da,!0,Ia);break;case 1597684571:sa=this.nyb(Ua,Da,!1,Ia);break;case 87208751:Da.Color="-1";Da.IntColor=!0;sa=this.nyb(Ua,Da,!1,Ia);break;case -446735083:this.Jqb(Ua);Da.Color="-1";Da.IntColor=!0;sa=this.nyb(Ua,Da,!0,Ia);break;case 1650812936:sa=this.nyb(Ua,Da,!1,Ia);break;case 673562736:this.Jqb(Ua);sa=this.nyb(Ua,Da,!0,Ia);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.XYf(Ua);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:sa=
this.B7h(Ua,Ia);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:sa=this.N6h(Ua,Ia);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:sa=this.r8h(Ua,Ia);break;case -1803452024:case -236759591:sa=this.Fkd(Ua,Da,Ia);break;case -2118943501:sa=this.borderFormatManager.U6h(Da,Ia);break;case 1012765228:sa=this.borderFormatManager.M8h(Da,Ia);break;case 1256700402:sa=
this.borderFormatManager.Jkd(Ia);break;case -1756763834:sa=this.borderFormatManager.Kkd(Ia);break;case -1418159950:sa=this.borderFormatManager.Z9e(Ia);break;case -1920201820:case -1942512156:sa=this.R7h(Ua,Ia);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:sa=this.borderFormatManager.L9e(Da,Ia);this.lFh(Da);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:sa=this.n8h(Ua,Da,Ia);break;case -693675336:case 322710748:break;case 1696566924:sa=
this.C7h(Ia);break;case -167499203:case -255094134:case 1097660126:case 155820588:W=this.handleMergeCellsCommand(this.gridView,Ia);break;case 1896159024:case -1554384558:Da=this.gridView.ha.ra.selectedRanges;if(this.rCj(Ia.command))x.ULS.sendTraceTag(509694159,0,50,"Insert Copied Cells Keyboard Shortcut"),this.copyPasteInfrastructure.bff(null,Ia),W=ua.Task.Ta(!0);else if(this.FDj(Ia,Da))x.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new oa(this.$,
Ua,Da)).hg(),sa=!0;else if(r.a.any(Da,vb=>this.gridView.Bb.y_(vb))){nb="";W=1461300262;const vb=-1554384558===Ua&&this.gridView.Bb.sqi(Da[0]);Da=Da[0].height>Da[0].width&&!vb;switch(Ua){case 1896159024:nb=Da?"InsertColumnsTable":"InsertRowsTable";W=Da?622604322:942362098;break;case -1554384558:nb=Da?"DeleteColumnsTable":"DeleteRowsTable",W=Da?284490184:1405456548}Da=la.a.wq(eb.Bod,nb,1);new Ca.a(W,1,2,6,null);W=this.insertOrDeleteCells(Da,Ia,!0)}else W=this.insertOrDeleteCells(1896159024===Ua?1:2,
Ia,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:W=this.insertOrDeleteCells(la.a.wq(eb.Bod,Da[J.a.Jc],1),Ia,!0);this.vB&&(Ia=Ka.h(this.$),db.d(this.$,Ia.ha.ra.activeCell,Ua,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:W=this.insertOrDeleteCells(la.a.wq(eb.Bod,Da[J.a.Jc],1),Ia,!1);break;case 504848446:W=nb.startEdit(!1,1,Da[H.a.event],void 0,void 0,!0);break;case 1504715724:if(Ka.h(this.$).Ez&&this.borderFormatManager.OU.xB)break;
W=nb.startEdit(!0,0,Da[H.a.event],void 0,void 0,!0);break;case 1872288872:this.xrb();break;case 41465729:W=this.fill(nb.ha.ra.dd,null,0,1,Ia);break;case -1451655532:case 1972143101:W=this.fillDownAbsoluteValueAndStartEdit(nb,Da[H.a.event],-1451655532===Ua);break;case -475861485:W=this.fill(nb.ha.ra.dd,null,nb.rtl?1:2,1,Ia);break;case -978843926:W=this.fill(nb.ha.ra.dd,null,3,1,Ia);break;case 2098035706:W=this.fill(nb.ha.ra.dd,null,nb.rtl?2:1,1,Ia);break;case -2142700828:W=this.fill(nb.ha.sourceRange,
nb.ha.ra.dd,eb.I2e(nb.ha.ra.dd,nb.ha.sourceRange),2,Ia);break;case 1405660955:W=this.fill(nb.ha.sourceRange,nb.ha.ra.dd,eb.I2e(nb.ha.ra.dd,nb.ha.sourceRange),4,Ia);break;case 1983983164:W=this.fill(nb.ha.ra.dd,null,0,0,Ia);break;case 478842689:(Ia=this.$.da.Aa(376))?(Ia.X8i(),sa=!0):x.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:sa=
nb.ha.Lb(null,Ua);break;case -208772570:this.i8h();sa=!0;break;case -987339782:this.b7h();sa=!0;break;case -1770246794:nb.ha.c7h();sa=!0;break;case 748067091:case -381232414:this.f7h(Ua);sa=!0;break;case -1522760979:this.gridView.toggleFormulaView();sa=!0;break;case 886009118:W=this.O7h();break;case 894341014:this.T7h();sa=!0;break;case 862825906:W=this.D$e(1970784898,Ia);break;case 1532790410:W=this.D$e(1650812936,Ia);break;case 46555851:W=this.e8h(Ia);break;default:sa=!1}sa||(W=aa.a(Ua));return W}lFh(Ia){Ia&&
Ia.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(Ia.MenuItemId)&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.pVg(new ta.a(this.gridView.ha.ra.activeRange,G.d(this.$.xa.oa)))}pVg(Ia){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Da=>{void Da.result.MCc(Ia,"BorderActions")},this.$.ka,3)}get copyPasteInfrastructure(){var Ia;null!==(Ia=this.H5b)&&void 0!==Ia?Ia:this.H5b=this.$.da.Aa(254,
!0);this.H5b||x.ULS.sendTraceTag(509682657,0,50,"CopyPasteInfrastructure is null");return this.H5b}rCj(Ia){var Da;return 1896159024===Ia&&(null===(Da=this.copyPasteInfrastructure)||void 0===Da?void 0:Da.oNe())&&Pb.a.Ivi}FDj(Ia,Da){const nb=r.a.all(Da,sa=>!this.gridView.Bb.y_(sa)),Ua=1<Da.length&&!!this.gridView.Bb.vjd(Da),W=r.a.all(Da,sa=>!this.gridView.Bb.H5(sa));Da=!r.a.any(Da,sa=>sa.isRow||sa.hf);return 1===Ia.method&&6===Ia.af&&(nb||Ua)&&W&&Da}fillDownAbsoluteValueAndStartEdit(Ia,Da,nb){const Ua=
Ia.ha.ra.activeCell,W=U.E(Ua,this.gridView.kt);return Ia.startEdit(!0,0,Da).jp(()=>{const sa=Ia.Sb(W),vb=Ia.Sb(Ua);if(!sa||!vb)return x.ULS.shipAssertTag(537159507,0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Ua.toString()} and above cell: ${W.toString()}`),ua.Task.Ta(!1);this.gridView.Vb.text=nb?sa.HS:sa.text;this.gridView.Vb.textBox.setCaretPositionToEnd();return ua.Task.Ta(!0)})}insertOrDeleteCells(Ia,Da,nb){const Ua=y.a.create().toString();var W=
Enum.toString(T,Ia);this.gridView.Eh.d1(17,Ua,W);W=this.gridView.ha.ra.selectedRanges;var sa=this.Olf,vb=this.Klf;if(!this.$.$p(null,!1,void 0,Da.af)&&!vb&&!sa&&5!==Ia&&9!==Ia)return ua.Task.Ta(!0);2===Ia?Ia=vb?10:sa?6:W[0].height>W[0].width?18:34:1===Ia?Ia=vb?9:sa?5:W[0].height>W[0].width?17:33:18===Ia&&sa?Ia=34:34===Ia&&vb&&(Ia=18);W=this.ROg(W,Ia);if((10===Ia||6===Ia)&&!this.$.$p(W,!0,1,Da.af))return ua.Task.Ta(!0);const gc={};gc.InsertDeleteRangeItems=Array(W.length);gc.SheetName=this.$.oa.sheetName;
gc.IsTableCommand=nb;for(nb=0;nb<W.length;nb++){sa=W[nb];vb={};let ib,Ib;Ia&4?(vb.FirstRow=sa.top-1,vb.LastRow=V.a.Mz,vb.FirstColumn=0,vb.LastColumn=V.a.Pw,ib=sa.bottom-sa.top+1,Ib=0,6===Ia?(sa.hf||(vb.FirstRow=sa.bottom),ib=-ib):wa.b("InsertRowsAbove"),37===Ia&&(vb.FirstRow=sa.bottom,wa.b("InsertRowsBelow"))):Ia&8?(vb.FirstRow=0,vb.LastRow=V.a.Mz,vb.FirstColumn=sa.left-1,vb.LastColumn=V.a.Pw,ib=0,Ib=sa.right-sa.left+1,10===Ia&&(sa.isRow||(vb.FirstColumn=sa.right),Ib=-Ib)):Ia&16?(vb.FirstRow=sa.top-
1,vb.LastRow=sa.bottom-1,vb.FirstColumn=sa.left-1,vb.LastColumn=V.a.Pw,ib=0,Ib=sa.right-sa.left+1,18===Ia&&(vb.FirstColumn=sa.right,Ib=-Ib)):(vb.FirstRow=sa.top-1,vb.LastRow=V.a.Mz,vb.FirstColumn=sa.left-1,vb.LastColumn=sa.right-1,ib=sa.bottom-sa.top+1,Ib=0,34===Ia&&(vb.FirstRow=sa.bottom,ib=-ib));const ec={};ec.InsertDeleteRange=vb;ec.DeltaRow=ib;ec.DeltaColumn=Ib;ec.AdjustedSelectedRange=U.j(sa);gc.InsertDeleteRangeItems[nb]=ec}this.gridView.yf.pH(!1);const Bc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");
gc.IsDecoupleRecalc=Bc;const Sa=this.$.pa.ya.Wb(),na=()=>new M(gc);return Z.a(this.$.userOperationManager,(ib,Ib,ec)=>{Bc&&!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.My();return La(this.$.pa.ya,gc,Oa.b(ib,(qb,Ha)=>{this.KSi(qb,Ha,Ia)},()=>{this.qSj(Ia,gc)}),Ib,ec,Ua,Sa)},ib=>new P.a(237,0,ib,void 0,na),Da,d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}qSj(Ia,Da){const nb=this.a3h(Ia);if(nb&&1===
Da.InsertDeleteRangeItems.length){var Ua=Da.InsertDeleteRangeItems[0];1<Ua.DeltaColumn||1<Ua.DeltaRow||(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:7334505_FixLatePSCardFlightCheck")||this.Htd(nb))&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),W=>{const sa=new ta.a(U.B(Ua.AdjustedSelectedRange),G.d(this.$.xa.oa));void W.result.MCc(sa,nb)},this.$.ka,3)}}Htd(Ia){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)?"DeleteColumn"===Ia||"DeleteRow"===Ia?(Jb.AFrameworkApplication.Ip("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",!1)):"InsertColumn"===Ia||"InsertRow"===Ia?(Jb.AFrameworkApplication.Ip("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",
!1)):"InsertCellShiftDown"===Ia||"InsertCellShiftRight"===Ia?(Jb.AFrameworkApplication.Ip("XLS-SmartView-InsertCellTableProactiveSuggestions-Treatment;XLS-SmartView-InsertCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertCellTableProactiveSuggestions",!1)):"DeleteCellShiftUp"===Ia||"DeleteCellShiftLeft"===Ia?(Jb.AFrameworkApplication.Ip("XLS-SmartView-DeleteCellTableProactiveSuggestions-Treatment;XLS-SmartView-DeleteCellTableProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteCellTableProactiveSuggestions",!1)):!1:(Jb.AFrameworkApplication.Ip("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),!1)}a3h(Ia){let Da;switch(Ia){case 5:case 37:Da="InsertRow";break;case 33:Da="InsertCellShiftDown";break;case 9:Da="InsertColumn";break;case 17:Da="InsertCellShiftRight";break;case 6:Da="DeleteRow";break;case 34:Da="DeleteCellShiftUp";break;case 10:Da=
"DeleteColumn";break;case 18:Da="DeleteCellShiftLeft"}return Da}ROg(Ia,Da){return Da&32?this.YZa(Ia,nb=>nb.bottom,nb=>nb.top,(nb,Ua)=>{nb.bottom=Ua},!1,!0):Da&16?this.gridView.rtl?this.YZa(Ia,nb=>nb.left,nb=>nb.right,(nb,Ua)=>{nb.left=Ua},!1,!1):this.YZa(Ia,nb=>nb.right,nb=>nb.left,(nb,Ua)=>{nb.right=Ua},!1,!1):Da&4?this.YZa(Ia,nb=>nb.bottom,nb=>nb.top,(nb,Ua)=>{nb.bottom=Ua},!0,!0):Da&8?this.gridView.rtl?this.YZa(Ia,nb=>nb.left,nb=>nb.right,(nb,Ua)=>{nb.left=Ua},!0,!1):this.YZa(Ia,nb=>nb.right,nb=>
nb.left,(nb,Ua)=>{nb.right=Ua},!0,!1):Ia}YZa(Ia,Da,nb,Ua,W,sa){Ia=U.d(Ia);Ia.sort((vb,gc)=>Da(gc)-Da(vb));if(W){W=[];sa=sa?V.a.fh+1:V.a.sh+1;for(let vb=0;vb<Ia.length;vb++){const gc=Ia[vb];nb(gc)<sa&&(Ua(gc,Math.min(Da(gc),sa-1)),W.push(gc),sa=nb(gc))}Ia=W}return Ia}fill(Ia,Da,nb,Ua,W){const sa=this.$;if(!sa.$p([Da],!0))return ua.Task.Ta(!0);const vb=U.v(Ia,sa),gc=Da?U.v(Da,sa):vb,Bc=this.$.pa.ya.Wb(),Sa=()=>new Ea(vb,gc,Ua,nb);return Z.a(this.$.userOperationManager,(na,ib,Ib)=>{this.$.My();var ec=
this.$.pa.ya;na=Oa.b(na,this.tPi);const qb=ec.Na(9,Bc);qb.sourceRange=vb;qb.targetRange=gc;qb.fillDirection=nb;qb.fillType=Ua;return S.g(ec,"FillRange",qb,na,ib,Ib,null,0)},na=>new P.a(155,0,na,void 0,Sa),W)}n8h(Ia,Da,nb){const Ua={ValidMembers:32};switch(Ia){case 1890566896:Ia=parseInt(Da[J.a.Jc].toString(),10);if(14===Ia)return nb=new Ca.a(2105621672,nb.method,nb.mode,nb.af,nb.tabName),Da[J.a.Jc]=null,this.$.Ja.Lb(nb,Da),x.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),
!0;Ua.NumberFormat=Ia;break;case 1886928607:Ua.NumberFormat=13;break;case -992833457:Ua.NumberFormat=11;break;case 218524921:Ua.NumberFormat=12;break;case 996232352:Ua.NumberFormat=1006;break;default:return x.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+za.b().uj(nb.command)),!1}x.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${za.b().uj(nb.command)} command, with menu item ${Da[J.a.Jc]}.`);this.sg.formatCells(1890566896,Ua,nb);
this.$.df();return!0}Q7h(Ia){var Da=this.gridView.Sb(this.gridView.ha.ra.activeCell);if(this.xb&&this.gridView.eb){Da=this.gridView.zi.W4a(Da?xb.a(Da).Font:null);if(!Da)return x.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.ra.activeCell.toString()} is null while editing`),!1;var nb=Da.FontSize}else if(Da)nb=Da.fontSize;else return!1;Da=Ia.command;let Ua=0;if(862890474===Da)for(;Ua<eb.zKa.length-1&&eb.zKa[Ua]<=nb;)Ua++;
else if(963349338===Da)for(Ua=eb.zKa.length-1;0<Ua&&eb.zKa[Ua]>=nb;)Ua--;x.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${nb} to size ${eb.zKa[Ua]}`);if(nb===eb.zKa[Ua])return!0;nb=eb.Vxc(2);nb.Font.FontSize=eb.zKa[Ua];this.xb&&this.gridView.eb?(this.kpb(Ia,!1,nb),this.$.df()):this.sg.formatCells(Da,nb,Ia);return!0}n$e(Ia,Da,nb){Ia=Ia[Ia[t.a.IsFreeForm]?t.a.Value:J.a.og].toString();if(!eb.o4i.test(Ia))return x.ULS.sendTraceTag(537159499,
0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;Ia=parseFloat(Ia);if(8>Ia||72<Ia)return x.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const Ua=Math.round(2*Ia)/2,W=eb.Vxc(2);W.Font.FontSize=Ua;this.xb&&this.gridView.eb?(this.kpb(Da,nb,W,!0),Ua===Ia||nb||this.$.df()):nb?this.sg.oea(this.gridView,-1077965542,W,nb):(this.sg.formatCells(-1077965542,W,Da),this.U0a());
return!0}l$e(Ia,Da,nb){var Ua=Ia[J.a.og];let W;this.rl?this.fontDropdownHelper.oBc&&this.fontDropdownHelper.oBc[Ua]?W=Ua:(x.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Ua}`),W=da.HelperMethods.VO[Ua]):W=da.HelperMethods.VO[Ua];let sa=0;this.Vl&&(Ia=Ia.MenuItemId,Ia===Xa.b?(Ua==this.themesManager.zG.Kzd&&(W=Ua),sa=2):Ia===Xa.a&&(Ua==this.themesManager.zG.vyd&&(W=Ua),sa=1),x.ULS.sendTraceTag(510247702,1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==
sa}`));if(!W)return!0;Ua=eb.Vxc(1);Ua.Font.FontName=W;this.Vl&&(Ua.Font.FontScheme=sa);this.xb&&this.gridView.eb?(this.kpb(Da,nb,Ua),this.$.df()):nb?(this.sg.oea(this.gridView,-1293291468,Ua,nb),this.iic&&(this.oK.Nmd+=1)):(this.sg.formatCells(-1293291468,Ua,Da),this.iic&&this.Pci(Ua.Font.FontName),this.U0a());return!0}Pci(Ia){this.oK.TRd+=1;this.rl&&this.sg.Cif(Ia)?this.oK.MAd+=1:this.oK.cCd+=1}Gec(Ia,Da,nb,Ua){let W=-803000997===Ia||1688184685===Ia?"black":Da.Color;this.moreColorsHelper&&(-1832800737===
Ia?W=fa.a.compare(W,"WindowText",!0)?this.moreColorsHelper.dcb:"black":nb||(this.moreColorsHelper.dcb=W,this.moreColorsHelper.zda(Da,W,Ua)));Ia=eb.Vxc(32);Ia.Font.FontColor=ea.a.GH(W,la.a.zg(Da,"IntColor"));this.xb&&this.gridView.eb?this.kpb(Ua,nb,Ia,17===Ua.af):nb?this.sg.oea(this.gridView,1970784898,Ia,nb):(this.DD&&({themeColor:Da}=this.getThemeColor(Da)).returnValue&&(Ia.Font.ThemeFontColor=Da,Ia.Font.ColorTypeOption=1),this.sg.formatCells(1970784898,Ia,Ua),this.U0a());return!0}f7h(Ia){var Da=
(new Date).format(748067091===Ia?this.$.va.ShortDateFormat:this.$.va.ShortTimeFormat);const nb=this.gridView.Ul?va.a(this.gridView.$):this.gridView.Vb;Ia=nb.textBox;this.gridView.eb?nb.insertText(Da):(this.gridView.startEdit(!0,0),nb.text=Da,Da=Da.length,Ia.Udb(Da),Ia.caretPosition=Da)}i8h(){this.gridView.MK(this.gridView.ha.ra.activeCell)||this.gridView.pxc||this.gridView.BNa()||this.gridView.Kt(this.gridView.ha.ra.activeCell,3,"GridCommandHandler.HandleMoveViewportToActiveCell")}b7h(){if(!(this.gridView.pxc||
this.gridView.BNa()||this.gridView.eb&&v.a.isMac)){const Ia=this.gridView.ha.ra.C4;this.gridView.gg(U.v(Ia,this.$),Ia,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}C7h(Ia){this.dbc=G.d(this.$.xa.oa);if(this.gridView.t7a)return this.gridView.yf.pH(!1),!!this.copyPasteInfrastructure;if(!this.copyPasteInfrastructure)return x.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.KY(this.Rdd);const Da=String.format(H.a.Xta,
N.a.current.fo(108));this.gridView.yf.gm(Da);Ia=new Ca.a(-911352779,Ia.method,Ia.mode,Ia.af,Ia.tabName);this.$.Ja.Lb(Ia,{[H.a.silentClipboardAccessFailures]:!0,[H.a.isFormatPainter]:!0}).continueWith(nb=>{(6>nb.status||6===nb.status&&!nb.result)&&this.xrb()});this.gridView.t7a=!0;this.copyPasteInfrastructure.PMg(this.xrb);return!0}nyb(Ia,Da,nb,Ua){let W=87208751===Ia?"-1":Da.Color;this.moreColorsHelper&&(1597684571===Ia?W=this.moreColorsHelper.aRa:nb||(this.moreColorsHelper.aRa=W===eb.notSet?eb.r_d:
W,this.moreColorsHelper.zda(Da,W,Ua)));Ia={ValidMembers:64};Ia.FillColor=ea.a.GH(W,la.a.zg(Da,"IntColor"));nb?this.sg.oea(this.gridView,1650812936,Ia,!0):(this.DD&&({themeColor:Da}=this.getThemeColor(Da)).returnValue&&(Ia.ThemeFillColor=Da,Ia.ColorTypeOption=1),this.sg.formatCells(1650812936,Ia,Ua),this.U0a());return!0}T7h(){x.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const Ia=this.$.da.Aa(221);if(Ia){var Da=this.gridView.zi;
if(Da){var nb,Ua,W=({Twf:nb,lYe:Ua}=Ia.ahi(Da.text,Da.textBox.caretPosition)).returnValue;W?(Ia.se=!1,Da.text=W,Da.textBox.selectRange(nb,nb+Ua),x.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):x.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else x.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else x.ULS.sendTraceTag(537159492,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}B7h(Ia,Da){let nb=0;const Ua=this.gridView,W=xb.a(Ua.Sb(null));this.xb&&Ua.eb&&(W.Font=Ua.zi.W4a(W.Font));let sa=W.Font;sa||(sa={ValidMembers:0});switch(Ia){case -287251124:nb|=4;Aa.e(sa,4)?sa.Bold=!sa.Bold:sa.Bold=!0;break;case -1925065947:nb|=8;Aa.e(sa,8)?sa.Italic=!sa.Italic:sa.Italic=!0;break;case 1764140053:nb|=16;Aa.e(sa,16)?sa.Underline=!sa.Underline:sa.Underline=!0;break;case -1685033574:nb|=64;
Aa.e(sa,64)?sa.DoubleUnderline=!sa.DoubleUnderline:sa.DoubleUnderline=!0;break;case -1590502662:nb|=128,Aa.e(sa,128)?sa.Strikethrough=!sa.Strikethrough:sa.Strikethrough=!0}if(!nb)return!1;sa.ValidMembers=nb;W.Font=sa;W.ValidMembers=16;this.xb&&this.gridView.eb?this.kpb(Da,!1,W):(d.EwaSettings.ma(645)||Ua.yf.pH(!1),this.sg.formatCells(Ia,W,Da));this.$.df();return!0}N6h(Ia,Da){let nb=0;const Ua=this.gridView,W=xb.a(Ua.Sb(null));-571165336===Ia||1041132226===Ia||-394785302===Ia?(nb|=1,W.VerticalAlignment=
la.a.wq(eb.g_a,Ia.toString(),2)):eb.Lni(Ia)?(nb|=2,this.L7h(W,Ia)):-1116189897===Ia&&(nb|=8,W.Wrap=W.ValidMembers&8?!W.Wrap:!0);if(!nb)return!1;W.ValidMembers=nb;d.EwaSettings.ma(645)||Ua.yf.pH(!1);this.sg.formatCells(Ia,W,Da);this.$.df();return!0}L7h(Ia,Da){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==Da&&(Da=-1150205178===Da?-286432209:-1150205178);Da=la.a.wq(eb.g_a,Da.toString(),0);Ia.HorizontalAlignment=Da===Ia.HorizontalAlignment?
0:Da}TOf(Ia,Da,nb,Ua){let W=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(W=this.mergeCellCommandAction.lvf(Da,nb))&&Ka.h(this.$).Eh.xS(this.X9a,Tb.BasicTelemetryCalculator.cR);return this.Fub(Ia,Da,!1,W,sa=>{this.TTi(sa,nb,Da,W,Ua)})}handleMergeCellsCommand(Ia,Da){this.X9a=y.a.create().toString();let nb=null;nb=this.mergeCellCommandAction.A4e();var Ua=D.a(Da.command);const W=this.mergeCellCommandAction.Ali(Da.command,nb);let sa=0;W?sa=w.a.Ud():Ka.h(this.$).Eh.d1(4,
this.X9a,Ua+", Scenario = "+nb.scenario.toString());Ua=Ia.ha.ra.selectedRanges;x.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${za.b().uj(Da.command)}, Number of ranges: ${Ua.length}, Ranges: ${U.i(Ua,",",this.$,!1)}`);Ua=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);Ia.yf.pH(!1,Ua);if(10===la.a.wq(eb.nvf,Da.command.toString(),10))return ua.Task.Ta(!1);const vb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",
!1);if(Ua&&vb)return W?(this.A8f(nb,Da,!0,!0,sa),ua.Task.Ta(!0)):this.TOf(Ia,Da,nb,!1);let gc=!1;Ua&&(gc=this.mergeCellCommandAction.lvf(Da,nb))&&Ka.h(this.$).Eh.xS(this.X9a,Tb.BasicTelemetryCalculator.cR);return this.Fub(Ia,Da,!1,gc,Bc=>{this.UTi(Bc,Da,gc)})}Fub(Ia,Da,nb,Ua,W=null){const sa=this.$.pa.ya.Wb(),vb=la.a.wq(eb.nvf,Da.command.toString(),10),gc=U.r(Ia.ha.ra.selectedRanges,Ia.$),Bc=()=>new Q.a(vb,gc),Sa=na=>{const ib=!!na&&!!na.RequestTelemetryData;Ka.h(this.$).Eh.Yla(this.X9a,na.StateId,
ib?na.RequestTelemetryData.EcsOperationDuration:0,ib?na.RequestTelemetryData.EcsRequestDuration:0,ib?na.RequestTelemetryData.WfeRequestDuration:0)};Ia=(na,ib,Ib)=>{this.$.My();na=W?Oa.b(na,W):na;na=Oa.b(na,Sa);return S.d(this.$.pa.ya,vb,gc,nb,na,ib,Ib,null,sa)};return Ua?Z.a(this.$.userOperationManager,Ia,na=>new P.a(156,0,na,64,Bc),Da):Z.a(this.$.userOperationManager,Ia,na=>new P.a(156,0,na,void 0,Bc),Da)}A8f(Ia,Da,nb,Ua=!1,W=0){x.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${nb}`);
var sa=Ka.h(this.$).rtl;sa=Ra.a.$c(3,2,0,sa?635:634,0,514846606,"MergeCellsLoseData");f.TaskExtensions.za(cb.a(this.$).vj(sa),vb=>{vb=vb.result;if(Ua){const gc=w.a.Ud()-W;x.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${gc}, and the user action is : ${vb}`)}0===vb?(x.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),nb?(Ua&&(vb=D.a(Da.command),Ka.h(this.$).Eh.d1(4,this.X9a,vb+", Scenario = "+Ia.scenario.toString())),this.TOf(Ka.h(this.$),
Da,Ia,!0)):this.Fub(this.gridView,Da,!0,!1)):1===vb&&x.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ka,11)}Lzi(Ia,Da,nb,Ua){Da!==Ia&&x.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${Da} and as per server is ${Ia}. The scenario is:- ${nb}, The CSE is done:- ${Ua}`)}UTi(Ia,Da,nb){lb.b(Ia,514846606)&&(x.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),
Na.a(this.$).hd.xM(514846606),Ia=Ka.h(this.$).rtl,Ia=Ra.a.$c(3,2,0,Ia?635:634,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.za(cb.a(this.$).vj(Ia),Ua=>{Ua=Ua.result;0===Ua?(x.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.Fub(this.gridView,Da,!0,nb)):1===Ua&&x.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ka,11))}TTi(Ia,Da,nb,Ua,W){let sa=!1;lb.b(Ia,514846606)&&(sa=!0,Na.a(this.$).hd.xM(514846606),Ua&&W?window.setTimeout(()=>
{this.Fub(this.gridView,nb,!0,!0)},0):this.A8f(Da,nb,!1));this.Lzi(sa,W,Da.scenario,Ua)}Jqb(Ia){if(this.u0a!==Ia&&1461300262!==this.u0a){this.XYf(this.u0a);var Da=za.b().uj(Ia);const nb=za.b().uj(this.u0a);x.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${nb} was restored before caching the style for ${Da} command.`)}this.u0a=Ia;if(this.xb&&this.gridView.eb)this.r0a||(this.r0a=this.gridView.zi.formattedText);else if(!this.NC){this.NC=[];Da=this.gridView.caa("GridCommandHandler.CacheFontStyles",
this.gridView.ha.ra.selectedRanges);try{for(Da.$$rst();Da.$$mn();){const nb=Da.$$cu();if(nb.cell.hasRichText)this.NC.push(ba.IXg(nb,nb.cell.formattedText));else switch(Ia){case 673562736:case -446735083:this.NC.push(ba.f0c(nb,nb.backgroundColor));break;case -128950598:case 1688184685:this.NC.push(ba.f0c(nb,nb.color));break;case 909774670:this.NC.push(ba.JXg(nb,nb.fontSize));break;case 324978188:this.Vl?this.NC.push(ba.HXg(nb,nb.fontName,nb.OZ)):this.NC.push(ba.f0c(nb,nb.fontName))}}}finally{Da&&Da.dispose()}}}fIj(){return this.xb&&
this.gridView.eb?!this.r0a:!this.NC}tki(Ia){return!!this.NC&&this.NC.length>Ia&&!!this.NC[Ia].formattedText}sfd(Ia){return this.NC[Ia].style}ZOh(Ia){return this.NC[Ia].size}YOh(Ia){return this.NC[Ia].OZ}XYf(Ia){if(!this.fIj()){if(this.xb&&this.gridView.eb)this.r0a&&(this.gridView.Vb.formattedText=this.r0a);else{const nb=this.NC.length;for(let Ua=0;Ua<nb;Ua++){let W;var Da=this.NC[Ua].yja.cell.getRange();W=this.gridView.Sb(Da);if(!W){x.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${Da.Ew(!1)}`);
continue}let sa;Da=W.$H?this.gridView.WLb(W.range):(sa=new L.a,sa.add(W),sa);for(let vb of Da)if(vb.cell.hasRichText&&1457172838!==Ia)this.tki(Ua)&&(vb.cell.formattedText=this.NC[Ua].formattedText);else switch(Ia){case 1457172838:vb.backgroundColor=this.sfd(Ua);break;case 2036397036:vb.color=this.sfd(Ua);break;case -1904244080:vb.fontSize=this.ZOh(Ua);break;case -1428968098:vb.fontName=this.sfd(Ua),this.Vl&&vb.X3f(this.YOh(Ua))}}}this.u0a=1461300262;this.U0a()}}U0a(){this.xb&&this.gridView.eb?this.r0a=
null:this.NC=null}R7h(Ia,Da){const nb={IndentationIncrease:0};if(-1942512156===Ia)nb.IndentationIncrease=1;else if(-1920201820===Ia)nb.IndentationIncrease=-1;else return!0;nb.ValidMembers=256;this.sg.formatCells(Ia,nb,Da);return!0}r8h(Ia,Da){var nb=this.gridView.Sb(null);nb=xb.a(nb);var Ua=Ia;!Ka.h(this.$).rtl||-1649235364!==Ia&&524773427!==Ia||(Ua=-1649235364===Ia?524773427:-1649235364);switch(Ua){case -1649235364:Ua=V.a.rotateTextUp45;break;case 524773427:Ua=V.a.pwc;break;case 1886217042:Ua=V.a.rotateTextUp90;
break;case 928057943:Ua=V.a.rwc;break;case -1526602249:Ua=V.a.verticalText;break;default:return!1}nb.ValidMembers=512;const W=nb.TextOrientation;nb.TextOrientation=Ua===W||W===V.a.owc&&Ua===V.a.pwc||W===V.a.qwc&&Ua===V.a.rwc?0:Ua;this.sg.formatCells(Ia,nb,Da);return!0}O7h(){const Ia=Ka.h(this.$),Da=U.r(Ia.ha.ra.selectedRanges,this.$),nb=U.o(Ia.ha.ra.activeCell,this.$);x.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return Z.a(this.$.userOperationManager,(Ua,
W,sa)=>ja.r(this.$.pa.ya,nb,Da,Ua,W,sa,null),Ua=>new P.a(201,0,Ua),null)}D$e(Ia,Da){let nb=null;var Ua=Ka.h(this.$).ha.ra.selectedRanges;Ua=this.gridView.caa("MoreColors",Ua,1,!0);try{for(Ua.$$rst();Ua.$$mn();){const W=Ua.$$cu().cell;if(!W)continue;let sa=eb.black;if(1970784898===Ia)sa=W.color;else if(1650812936===Ia){const vb=W.backgroundColor;sa=fa.a.compare(vb,eb.r_d,!0)&&fa.a.compare(vb,eb.empty,!0)?W.backgroundColor:eb.white}if(!nb)nb=sa;else if(nb!==sa){nb=eb.black;break}}}finally{Ua&&Ua.dispose()}this.xb&&
this.gridView.eb&&1970784898===Ia&&this.gridView.zi.textBox.aye();return this.moreColorsHelper.oDb(Ia,Da,nb)}e8h(Ia){const Da=C.a.n5a(this.borderFormatManager.R3);return this.moreColorsHelper.oDb(-236759591,Ia,Da)}kpb(Ia,Da,nb,Ua=!1){Da?this.gridView.zi.$Nf(nb.Font):(this.aCi(Ia),Ua?window.requestAnimationFrame(()=>{B.FocusManager.instance().vk(z.AFrame.naa);this.gridView.zi.sZe(nb.Font)}):(B.FocusManager.instance().vk(z.AFrame.naa),this.gridView.zi.sZe(nb.Font)),this.U0a())}aCi(Ia){const Da=D.a(Ia.command);
Ia=A.a[Ia.af]+"_"+E.a[Ia.method];const nb=this.gridView.fc.BBe.toString(),Ua=new Map;Ua.set("Command",Da);Ua.set("Source",Ia);Ua.set("Ribbon","React");Ua.set("CellTextRuns",nb);I.Health.instance.recordKpiUsage(qa.a.CIh,0,jb.a.AZf,Ua)}Fkd(Ia,Da,nb){Ia=this.borderFormatManager.Fkd(Ia,Da,nb);this.moreColorsHelper&&this.moreColorsHelper.zda(Da,this.borderFormatManager.R3,nb);return Ia}getThemeColor(Ia){let Da;Da={};let nb=!1;if((Ia.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return x.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Da};let Ua;({themeIndex:Ia,ZBa:Ua,returnValue:nb}=this.themesManager.getThemeColor(Ia.Color));nb&&(Da.ThemeColorIndex=Ia,Da.ThemeColorRow=Ua)}return{returnValue:nb,themeColor:Da}}static get o4i(){return eb.Fhe||(eb.Fhe=RegExp("^[0-9]+[.]?[0-9]*$"))}static get Bod(){return eb.cbe||(eb.cbe={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,
["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get g_a(){return eb.Ahb||(eb.Ahb={["-394785302"]:0,["-571165336"]:2,["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get nvf(){return eb.Vee||(eb.Vee={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static Lni(Ia){return-1150205178===Ia||-1142465846===
Ia||-286432209===Ia||2007171328===Ia}static Vxc(Ia){const Da={},nb={};Da.ValidMembers=16;Da.Font=nb;nb.ValidMembers=Ia;return Da}static I2e(Ia,Da){let nb;nb=Ia.top<Da.top?3:Ia.bottom>Da.bottom?0:-1;return nb=Ia.left<Da.left?1:Ia.right>Da.right?2:nb}}eb.r_d="transparent";eb.notSet="-1";eb.black="#000000";eb.empty="";eb.white="#FFFFFF";eb.cbe=null;eb.Ahb=null;eb.Vee=null;eb.Fhe=null;eb.zKa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(u.a)(eb,"GridCommandHandler",null,[208]);class Ma extends m.a{constructor(Ia){super(Ia)}ld(){const Ia=
e.GetServiceTaskFactory.create(this.$.da,111,this.ka,this.Ya),Da=e.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya),nb=e.GetServiceTaskFactory.create(this.$.da,397,this.ka,this.Ya),Ua=e.GetServiceTaskFactory.Oa(this.$.da,502,503,this.Ya);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const W=e.GetServiceTaskFactory.Oa(this.$.da,296,468,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Ia,Da,nb,W,Ua],this.ka),()=>{this.Zc([new eb(this.$,Ka.h(this.$),
Da.result,Ia.result,W.result,nb.result,Ua.result)])},this.ka,3)}else{const W=e.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Ia,Da,W,nb,Ua],this.ka),()=>{this.Zc([new eb(this.$,Ka.h(this.$),Da.result,Ia.result,new h.BorderFormatManager(this.$,Da.result,W.result),nb.result,Ua.result)])},this.ka,3)}}static la(Ia){m.a.Nd(80,new Ma(Ia))}}Object(u.a)(Ma,"GridCommandHandlerFactory",m.a,[]);a.d(F,"a",function(){return ob});const ob=()=>{c.a.Fa(Ma.la);
c.a.Fa(n.la)}},1174:function(u,F,a){function c(Aa){return Object(y.c)(Aa)?"cache":"client"===Aa.origin||Aa.cached?"client":"server"}function b({x:Aa,y:da},aa,fa=document){let Oa=-1,ba=null;void 0!==fa.caretPositionFromPoint?(Aa=fa.caretPositionFromPoint(Aa,da),null!==Aa&&(Oa=Aa.offset,ba=Aa.offsetNode)):void 0!==fa.caretRangeFromPoint&&(Aa=fa.caretRangeFromPoint(Aa,da),null!==Aa&&(Oa=Aa.startOffset,ba=Aa.startContainer));return null===ba||-1===Oa?(v.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),
-1):aa.contains(ba)?e(aa,ba,Oa):(v.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function e(Aa,da,aa){if(Aa===da)return aa;if(da.textContent!==da.parentElement.textContent)for(;null!==da.previousSibling;)da=da.previousSibling,aa+=da.textContent.length,"div"===da.nodeName.toLowerCase()&&(aa+=1);return e(Aa,da.parentElement,aa)}function f(Aa,da){return Aa.text===da.text&&Aa.start===da.start&&Aa.length===da.length}function d(Aa,da,aa){if(Aa.has(da))return Aa.get(da);
aa=aa();Aa.set(da,aa);return aa}function h(Aa){return JSON.stringify({text:Aa.text,start:Aa.start,length:Aa.length})}function n(Aa){return Object(y.c)(Aa)?"Undefined text":""===Aa?"Empty text":null}var m=a(9);u=a(0);var x=a(222),r=a(163),y=a(727),t=a(21),v=a(15),w=a(11),C=a(22),B=a(13),z=a(216),A=a(34),E=a(33),I=a(1095),L=a(1);class V{constructor(Aa){this.$=Aa;this.YIa=this.jtb=null;this.usage={};this.results={};this.performance={};this.Qrc=-1;this.isEnabled=!1;this.XZc=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7190603_FATMAvoidSilentReopen");
this.yc=(da,aa)=>{this.XZc&&(aa.Of||aa.Ohf)||this.$.sendBeaconTraceTag(388818255,50,!1,this.wZd())};if(this.isEnabled=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7147898_ValuePreviewTelemetry"))this.editBox=Object(t.h)(this.$).Vb,Aa.Xj(this.yc)}static getInstance(Aa){return V.instance||(V.instance=new V(Aa))}set trigger(Aa){this.isEnabled&&(this.jtb=Aa,this.Qrc=I.a.dZd)}set HOd(Aa){this.isEnabled&&(this.YIa=Aa)}setResult(Aa,da){if(this.isEnabled)if(Object(y.c)(this.jtb))v.ULS.sendTraceTag(512258439,
0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else{var aa=da===this.editBox?"cellEditor":"formulaBar",fa=this.jtb;da=this.YIa;var Oa=this.Qrc;Object(y.c)(this.usage[aa])&&(this.usage[aa]={});Object(y.c)(this.usage[aa][fa])&&(this.usage[aa][fa]={success:0,error:0,unavailable:0});aa=this.usage[aa][fa];switch(Aa.kind){case 1:this.AKd(Aa.text);aa.success++;this.jtb=this.YIa=null;this.Qrc=-1;break;case 2:aa.error++;this.jtb=null;this.Qrc=-1;break;case 3:aa.unavailable++}this.yw(da,
Oa)}}AKd(Aa){if(!Object(y.c)(this.YIa)){Object(y.c)(this.results[this.YIa.origin])&&(this.results[this.YIa.origin]=[]);var da=this.results[this.YIa.origin];1E3>da.length&&da.push(Aa.length)}}yw(Aa,da){if(-1!==da){Aa=c(Aa);this.w5e(`${Aa}_request`).m4(!0,da);var aa=this.w5e(`${Aa}_overall`);window.requestAnimationFrame(()=>{aa.m4(!0,da)})}}w5e(Aa){return this.performance[Aa]=this.performance[Aa]||new I.a(T)}wZd(){const Aa={};Object.keys(this.performance).forEach(da=>{this.performance[da].BXe();var aa=
this.performance[da];Aa[da]={metrics:aa.sW,durations:aa.oub}});return`{"usage":${JSON.stringify(this.usage)},"results":${JSON.stringify(this.results)},"performance":${JSON.stringify(Aa)}}`}}Object(u.a)(V,"ValuePreviewTelemetry",null,[]);const T=[50,80,100,130,150,170,200];class H{constructor(Aa,da,aa){this.$=Aa;this.BKa=da;this.ariaLiveNotifier=aa;this.oei();this.editBox=Object(t.h)(this.$).Vb;this.jDj=E.a.hR(this.$)}get telemetry(){return V.getInstance(this.$)}get zoomManager(){this.Cne||(this.Cne=
Object(A.a)(this.$));return this.Cne}dispose(){this.hide()}show(Aa,da,aa){const fa=Object.assign(Object.assign({},da),{aN:Aa,h3d:aa});this.Ceb(fa)&&(this.noa(fa)&&this.hide(),this.fD=fa,this.telemetry.setResult(da,Aa),this.Sy(),aa&&this.ebi())}hide(){if(this.fD){var Aa=this.fD.h3d;this.umh();Aa&&this.ffj();this.fD=void 0}}Ceb(Aa){var da;(da=!this.fD)||(da=this.fD,da=!(da.aN===Aa.aN&&da.kind===Aa.kind&&da.text===Aa.text&&da.start===Aa.start&&da.length===Aa.length&&da.h3d===Aa.h3d));return da}noa(Aa){var da;
if(da=this.fD)da=this.fD,da=!(da.aN===Aa.aN&&da.start===Aa.start&&da.length===Aa.length);return da}ebi(){this.fD.aN.textBox.formatText(this.fD.start,this.fD.length,{background:"rgba(202,234,216,0.6)"})}ffj(){const Aa=this.fD.aN,da=this.fD.start,aa=this.fD.length,fa=Aa.text;fa.length<da+aa?v.ULS.shipAssertTag(521019917,0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${fa.length}:${da}:${aa}`):(Aa.textBox.formatText(da,aa,{background:!1}),this.jDj&&Aa.bC(null))}Sy(){var Aa=
this.fD.text;switch(this.fD.kind){case 1:case 2:Aa={isLoaded:!0,value:Aa};break;case 3:Aa={isLoaded:!1,value:null};break;default:return}this.$Zj();this.BKa.renderValuePreview(this.Us,this.LPb,Aa);this.g2i(Aa)}umh(){this.BKa.dismiss(this.Us)}oei(){this.Us=document.createElement("div");this.LPb=document.createElement("div");this.LPb.style.position="absolute";this.LPb.style.visibility="hidden";this.$.domElement.appendChild(this.LPb)}$Zj(){var Aa=this.fD.aN,da=this.fD.start;const aa=this.fD.length,fa=
C.a.contains(Aa.text.substring(da,da+aa),"\n",!0);Aa=excelOnline.utils.getBoundingRectForText(Aa.textBox.Le,da,fa?da:da+aa,!1);da=new z.a(this.LPb.style);da.ZB.left=this.kAc(Aa.left);da.ZB.top=this.kAc(Aa.top);da.ZB.width=this.kAc(Aa.width);da.ZB.height=this.kAc(Aa.height);da.X2()}kAc(Aa){var da=this.fD.aN;da=Object(y.b)(this.zoomManager)&&da===this.editBox;return w.HelperMethods.uc(da?this.zoomManager.yi(Aa):Aa)}g2i({isLoaded:Aa,value:da}){Aa?this.ariaLiveNotifier.readText(String.format(B.a.instance.mb(179),
da)):this.ariaLiveNotifier.readText(B.a.instance.ga(865))}}Object(u.a)(H,"FormulaAssistanceValuePreviewControl",null,[2]);var D=a(113);class G{constructor(Aa){this.cache=Aa}clearCache(){this.cache=void 0}}Object(u.a)(G,"Cacheable",null,[]);class J extends G{constructor(Aa,da){super();this.$=Aa;this.callbacks=da;this.XBf=(aa,fa)=>{const Oa=this.gridView.zi;if(!(0<(Oa.eb?Oa.textBox.selection:{index:0,length:0}).length))switch(fa.state){case 0:this.onHoverEnter(aa,fa.event);break;case 1:this.onHoverLeave(aa);
break;default:return v.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),fa}};this.WBf=(aa,fa)=>{const Oa=fa.selection;fa={kind:"selection",text:fa.text,start:Oa.index,length:Oa.length};if(0<Oa.length)this.onSelectionChange(aa,fa);else this.OHf(aa,fa)};this.gridView=Object(t.h)(this.$);this.editBox=this.gridView.fc;this.Nj(this.editBox);this.formulaBar=Object(D.a)(this.$);Object(y.b)(this.formulaBar)?this.Nj(this.formulaBar):Object(D.b)(this.$,
aa=>{this.formulaBar=aa;this.Nj(this.formulaBar);v.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return V.getInstance(this.$)}dispose(){this.gk(this.editBox);this.gk(this.formulaBar)}trigger(){const Aa=this.gridView.zi,da=Aa.textBox.selection;this.onSelectionChange(Aa,{kind:"shortcut",text:Aa.text,start:da.index,length:da.length})}Nj(Aa){Aa.sre(this.XBf);Aa.YKg(this.WBf)}gk(Aa){null===Aa||void 0===Aa?void 0:Aa.FVf(this.XBf);null===Aa||
void 0===Aa?void 0:Aa.tgj(this.WBf)}onHoverEnter(Aa,da){da=new Sys.UI.Point(da.clientX,da.clientY);da=b(da,Aa.textBox.Le);if(-1!==da)this.onSelectionChange(Aa,{kind:"hover",text:Aa.text,start:da,length:0})}onHoverLeave(Aa){this.OHf(Aa)}onSelectionChange(Aa,da){this.ACj(da)&&(this.cache=da,this.callbacks.FEd(Aa,{index:da.start,length:da.length}),this.telemetry.trigger=da.kind)}OHf(Aa,da){this.wCj(da)&&(this.clearCache(),this.callbacks.APa(Aa))}ACj(Aa){return!this.cache||!f(this.cache,Aa)}wCj(Aa){return this.cache&&
Aa?"shortcut"!==this.cache.kind||!f(this.cache,Aa):!0}}Object(u.a)(J,"FormulaAssistanceValuePreviewHandler",G,[2]);var M;(function(Aa){Aa[Aa.Failure=0]="Failure";Aa[Aa.Success=1]="Success";Aa[Aa.Error=2]="Error";Aa[Aa.Unavailable=3]="Unavailable"})(M||(M={}));Object(u.b)("ValuePreviewResultKind",M);var Q=a(40),U=a(60);class Z{constructor(Aa,da){this.$=Aa;this.pluginScheduler=da;this.bS=new S(h);this.l2f=new S(h);this.VWi=(aa,fa)=>Oa=>{if(Object(y.c)(Oa.Result))fa("No result");else if(Oa=JSON.parse(Oa.Result),
Object(y.c)(Oa))fa("Failed to deserialize");else if(1!==Object.keys(Oa).length)fa("Invalid response");else{for(var ba in Oa)var ka=Oa[ba];ba=n(ka);Object(y.b)(ba)?fa(ba):aa(ka)}};this.UWi=aa=>()=>{aa("Request failed")};this.gridView=Object(t.h)(this.$);if(this.dwb=E.a.HV(this.$))this.formulaAssistanceManager=Aa.da.Aa(464)}get telemetry(){return V.getInstance(this.$)}clearCache(){this.bS.clear();this.l2f.clear()}request(Aa){return Object(r.a)(this,void 0,void 0,function*(){return d(this.bS,Aa,()=>
Object(r.a)(this,void 0,void 0,function*(){const {kind:da,payload:aa}=yield this.pluginScheduler.getRequester().valuePreview(Aa,this.formulaAssistanceManager?this.formulaAssistanceManager.lbb:0);if(0!==da)return null;if(Object(y.c)(aa))return{kind:0};this.telemetry.HOd={origin:"client"};switch(aa.kind){case 0:return{kind:0};case 1:case 2:return this.g1j(aa);case 3:const fa={text:Aa.text,start:aa.start,length:aa.length};return this.bS.has(fa)?(this.telemetry.HOd={origin:"server",cached:!0},yield this.bS.get(fa)):
Object.assign(Object.assign({},aa),{kind:3,next:()=>this.Ykj(fa,Aa,aa.text)})}}))})}g1j(Aa){const da=n(Aa.text);return Object(y.b)(da)?(v.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${da}, kind:${M[Aa.kind]}`),{kind:0}):Aa}Ykj(Aa,da,aa){return Object(r.a)(this,void 0,void 0,function*(){return d(this.l2f,Aa,()=>{const fa=new Promise(Oa=>Object(r.a)(this,void 0,void 0,function*(){try{const ba=yield this.aZh(aa);this.telemetry.HOd=
{origin:"server"};Oa({kind:1,text:ba,start:Aa.start,length:Aa.length})}catch(ba){v.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${ba}`),Oa({kind:0})}}));fa.then(()=>{this.bS.set(Aa,fa);this.bS.set(da,fa)}).catch(Oa=>{v.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Oa}`)});return fa})})}aZh(Aa){return Object(r.a)(this,void 0,void 0,function*(){return new Promise((da,
aa)=>{const fa={Formula:Aa,PartialFormula:Aa,SourceRange:Object(Q.v)(this.gridView.ha.ra.activeCell,this.$)};P(this.$.pa.ya,fa,this.VWi(da,aa),this.UWi(aa),null,null)})})}}Object(u.a)(Z,"FormulaAssistanceValuePreviewRequester",null,[]);const P=(Aa,da,aa,fa,Oa,ba,ka=null)=>{ka=Aa.Na(1,ka);ka.getPartialCalcResultsParameters=da;return Object(U.g)(Aa,"GetPartialCalcResults",ka,aa,fa,Oa,ba,4)};class S{constructor(Aa){this.xZd=Aa;this.map=new Map}has(Aa){Aa=this.xZd(Aa);return this.map.has(Aa)}get(Aa){Aa=
this.xZd(Aa);return this.map.get(Aa)}set(Aa,da){Aa=this.xZd(Aa);this.map.set(Aa,da);return this}clear(){this.map.clear()}}Object(u.a)(S,"RequestMap",null,[]);class ja{constructor(Aa,da,aa,fa){this.$=Aa;this.FEd=(Oa,ba)=>Object(r.a)(this,void 0,void 0,function*(){const ka={text:Oa.text,start:ba.index,length:ba.length};void this.WOf(ka,this.requester.request.bind(this.requester),Oa,0===ka.length)});this.APa=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};
this.Ay=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(t.h)(this.$);this.control=new H(this.$,aa,fa);this.requester=new Z(this.$,da);this.handler=new J(this.$,{FEd:this.FEd,APa:this.APa});this.Nj()}trigger(){this.handler.trigger()}dispose(){this.gk();this.handler.dispose();this.control.dispose()}Nj(){this.gridView.Vb.Rm(this.reset);this.gridView.ha.eha(this.reset);this.$.ea.OE(this.Ay)}gk(){this.gridView.Vb.em(this.reset);this.gridView.ha.qna(this.reset);this.$.ea.cE(this.Ay)}WOf(Aa,
da,aa,fa){return Object(r.a)(this,void 0,void 0,function*(){const Oa=Object.assign(Object.assign({},Aa),{aN:aa,mUd:fa});this.WIa=Oa;const ba=yield da(Aa);Object(y.c)(ba)||this.Wqi(Oa)&&void this.W8h(ba)})}W8h(Aa){return Object(r.a)(this,void 0,void 0,function*(){const da=this.WIa.text,aa=this.WIa.aN,fa=this.WIa.mUd;switch(Aa.kind){case 0:this.hide();break;case 1:case 2:this.show(aa,Aa,fa);break;case 3:if(!this.Ati(Aa))break;this.show(aa,Aa,fa);void this.WOf({text:da,start:Aa.start,length:Aa.length},
Aa.next,aa,fa);break;default:return Aa}})}show(Aa,da,aa){this.WIa=void 0;this.cri(da)&&(this.control.show(Aa,da,aa),this.dtb=da)}hide(){this.control.hide();this.dtb=this.WIa=void 0}Wqi(Aa){var da;if(da=this.WIa)da=this.WIa,da=da.text===Aa.text&&da.start===Aa.start&&da.length===Aa.length&&da.aN===Aa.aN&&da.mUd===Aa.mUd;return da}cri(Aa){return Object(y.b)(Aa.text)&&""!==Aa.text}Ati(Aa){return!this.dtb||this.dtb.start!==Aa.start||this.dtb.length!==Aa.length||3===this.dtb.kind}}Object(u.a)(ja,"FormulaAssistanceValuePreview",
null,[223,2]);var X=a(49),Y=a(37);class va extends x.a{constructor(Aa){super();this.$=Aa;this.Fb()}static la(Aa){Aa.da.Ga(497,new va(Aa))}create(){let Aa=this.$.da.Aa(496);Aa&&this.nb(Aa);const da=X.GetServiceTaskFactory.Oa(this.$.da,413,414,this.Ya),aa=X.GetServiceTaskFactory.Oa(this.$.da,448,449,this.Ya),fa=X.GetServiceTaskFactory.Oa(this.$.da,19,153,this.Ya),Oa=X.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Ya);Y.TaskExtensions.za(Y.TaskExtensions.Ed([da,aa,fa,Oa],this.ka),()=>{Aa=this.$.da.Aa(496);
Aa||(Aa=new ja(this.$,da.result,aa.result,Oa.result),this.$.da.Ga(496,Aa));this.nb(Aa)},this.ka,3)}}Object(u.a)(va,"FormulaAssistanceValuePreviewFactory",x.a,[]);var N=a(694),ea=a(184),Ca=a(55);class la{constructor(Aa,da){this.formulaAssistanceValuePreview=da;this.gridView=Object(t.h)(Aa)}nc(){return!1}executeCommand(Aa,da){Aa=!1;da=da.command;switch(da){case -46938080:this.formulaAssistanceValuePreview.trigger(),Aa=!0}return Aa?Ca.Task.Ta(!0):ea.a(da)}wc(Aa,da){return-46938080===da.command}Kc(){return!1}}
Object(u.a)(la,"FormulaAssistanceValuePreviewCommandHandler",null,[208]);class Ra extends N.a{constructor(Aa){super(Aa)}ld(){const Aa=X.GetServiceTaskFactory.Oa(this.$.da,496,497,this.Ya);Y.TaskExtensions.za(Aa,()=>{this.Zc([new la(this.$,Aa.result)])},this.ka)}static la(Aa){N.a.Nd(515,new Ra(Aa))}}Object(u.a)(Ra,"FormulaAssistanceValuePreviewCommandHandlerFactory",N.a,[]);a.d(F,"a",function(){return lb});const lb=()=>{m.a.Fa(Aa=>{va.la(Aa);Ra.la(Aa)})}},1180:function(u,F,a){u=a(0);var c=a(15),b=
a(187),e=a(84),f=a(83),d=a(387),h=a(99),n=a(45);class m{constructor(){this.Ada=this.I_e=null}}Object(u.a)(m,"GestureAdapterInfo",null,[]);var x=a(4),r=a(377),y=a(228);class t{constructor(){this.CJc=null}hyi(){if(!this.CJc){var Q="hammer.min.js";x.AFrameworkApplication.fa.aq("IsServerFlavorDebug")&&(Q=x.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=x.AFrameworkApplication.CL(String.format("{0}",Q),5);Q=y.a.create(Q,null,null);r.a.Uia(Q);this.CJc=Q.q9a}return this.CJc}static get instance(){t.Ma||
(t.Ma=new t);return t.Ma}}t.Ma=null;Object(u.a)(t,"HammerJsDependencyLoader",null,[392]);var v=a(14);const w=(Q,U,Z=null)=>{if(void 0===U||null===U)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let P=null;switch(Q){case v.a.pinch:P=new Hammer.Pinch(Z);break;case v.a.pan:P=new Hammer.Pan(Z)}P&&(P.manager=U);return P};var C;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(C||(C={}));Object(u.b)("GestureEvent",
C);var B=a(77);class z extends B.a{constructor(Q,U,Z,P,S,ja,X,Y){super(Q,Z,P,ja);this.gib=U;this.Aga=X;this.XX=Y;this.Svg=S}get shiftKey(){return this.Aga}get ctrlKey(){return this.XX}get clientPoint(){return this.gib}get zva(){return this.Svg}static create(Q,U,Z,P,S,ja){if(Z.rawEvent)if(ja){var X=Z.rawEvent;X=new Sys.UI.Point(X.clientX,X.clientY)}else X=B.a.Mwb(Z);else X=new Sys.UI.Point(Z.clientX,Z.clientY);return new z(Q,X,U,Z,P,S,Z.shiftKey,Z.ctrlKey,ja)}}Object(u.a)(z,"GestureEventArgs",B.a,
[]);class A{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(u.a)(A,"GestureManagerData",null,[]);class E{}E.zpg=2;E.Apg=4;E.Bpg=8;E.Cpg=8;Object(u.a)(E,
"HammerConstants",null,[]);var I=a(93),L=a(206),V=a(30),T=a(79);class H extends n.a{constructor(Q,U){super();this.Gqa=d.a.oMh;this.bRc=!!window.PointerEvent;this.mme=window.hasOwnProperty("ontouchstart");this.WWa=this.ulb=null;this.h9=!1;this.oT=new h.a;this.Plb=new h.a;this.Tvg=new b.a;this.bqa=null;this.cWa=this.rLc=this.T6d=this.lIc=this.WOc=this.Nie=this.Z6d=this.rnb=!1;this.Xkb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.KTc=null;this.Md=I.EventHandlerManager.instance;
this.bRc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.ulb=Object(e.a)(this,this.gqc,"onPointerEvent"),this.WWa=v.a.qMh):this.mme?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.ulb=Object(e.a)(this,this.vza,"onTouchEvent"),this.WWa=v.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.ulb=Object(e.a)(this,this.Rpc,"onMouseEvent"),this.WWa=v.a.pMh);this.Ch=U;this.Dfa=Q;x.AFrameworkApplication.fa&&(this.rnb=x.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),
this.Z6d=x.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.Nie=x.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.WOc=x.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.lIc=x.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.T6d=x.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.rLc=x.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.cWa=this.rnb&&x.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&
x.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}GUh(){return this.bRc?0:this.mme?1:2}Cn(Q){super.Cn(Q);this.Md.Kka(this.WWa,Q,0,this.ulb)}rm(Q){super.rm(Q);this.Md.iJa(Q,this.WWa)}Jcj(Q,U,Z=null){x.AFrameworkApplication.Qic()?t.instance.hyi().continueWith(P=>{this.LKj();if(P.Pf||P.qh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",P.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",P.status);if(this.T6d){P=window.Hammer;
if("undefined"===typeof P){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.YAc();return}if("undefined"===typeof P.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.YAc();return}}if(!Q)throw this.YAc(),Error.argumentNull("source element can not be null");P=L.a.$va(Q,this.Gqa);if(void 0===P||null===P)P=new h.a,L.a.aeb(Q,this.Gqa,P),this.Kcj(Q);var S=null;P.lb(C[0])||(S=Object.assign(new m,{Ada:w(C[0],this,null),I_e:U}),P.add(C[0],S));if(void 0!==
Z&&null!==Z)for(let ja=0;ja<Z.length;ja++)if(P.lb(C[Z[ja]])){const X=P.na(C[Z[ja]]);S.Ada.recognizeWith(X.Ada)}}this.YAc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}LKj(){this.rLc&&(this.Ch?this.KTc=this.Ch.Bc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}YAc(){this.rLc&&(this.KTc?this.KTc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Kcj(Q){this.Tvg.add(Q);
this.Md.Kka(this.WWa,Q,0,this.ulb)}recognize(Q){var U=Array(Q.pointers.length);for(var Z=0;Z<Q.pointers.length;Z++)U[Z]=Q.pointers[Z].target;Z=null;for(this.bqa=this.ZWh(U);void 0!==this.bqa&&null!==this.bqa&&(Z=L.a.$va(this.bqa,this.Gqa),void 0===Z||null===Z);this.bqa=this.bqa.parentNode);if(void 0!==Z&&null!==Z){this.curRecognizer&&this.curRecognizer.state===E.Cpg&&(this.curRecognizer=null);U=Z.keys;for(let P of U){U=Z.na(P);void 0!==U&&null!==U&&void 0!==U.Ada&&null!==U.Ada&&(void 0===this.curRecognizer||
null===this.curRecognizer||U.Ada===this.curRecognizer||U.Ada.canRecognizeWith(this.curRecognizer))&&U.Ada.recognize(Q);const S=U.Ada.state;this.curRecognizer||E.zpg!==S&&E.Apg!==S&&E.Bpg!==S||(this.curRecognizer=U.Ada)}}}emit(Q,U){if("hammer.input"!==Q){this.h9=!1;U=z.create(Q,this.bqa,U.srcEvent,U,3,this.bRc);var Z=L.a.$va(this.bqa,this.Gqa);if(this.Vpi(Q))var P=0;else if(this.Lpi(Q))P=1;else if(this.Ssi(Q))P=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:Z}=Z.Dc(C[P]));void 0!==Z&&null!==Z&&((Z=Z.I_e,Z.rni())?Q.endsWith("start")?this.h9=Z.gQi(U):Q.endsWith("end")?(Z.eQi(U),this.h9=!0):Q.endsWith("cancel")?(Z.dQi(U),this.h9=!0):Q.endsWith("move")&&(this.h9=Z.fQi(U)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(f.a)(Hammer.Recognizer,Q)}ZWh(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];var U=Q[0],Z=!0;for(let P=1;P<Q.length;P++){if(!Q[P])return null;if(U!==Q[P]){Z=
!1;break}}if(Z)return U;U=this.a0e(Q[0]);Z=0;for(const P of Q){Q=this.a0e(P);if(U.na(U.count-1)!==Q.na(Q.count-1))return null;for(let S=U.count-2,ja=Q.count-2;S>=Z&&0<=ja;S--,ja--)if(U.na(S)!==Q.na(ja)){Z=S+1;break}}return U.na(Z)}a0e(Q){const U=new b.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)U.add(Q);return U}R3e(Q){switch(Q){case v.a.vf:case v.a.z$:return 1;case v.a.$f:case v.a.Eha:return 2;case v.a.xe:case v.a.AHa:return 4;case v.a.ECc:case v.a.O_c:return 8}return 0}vza(Q,U,Z){Q=this.R3e(Q);U=
this.GVh(Z);Hammer.inputHandler(this,Q,U);this.h9&&Z.preventDefault();return this.h9}iaf(){return 1<this.oT.count}o3b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.rnb)for(let Q of this.oT)this.EUf(Q.key);else this.oT=new h.a;this.session=null}wIg(Q,U,Z){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.Plb.lb(Q)){try{U.setPointerCapture(Q)}catch(P){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",P)}this.Plb.add(Q,U)}this.oT.ia(Q,
Z);this.cWa&&1<this.oT.count&&this.Dfa&&!this.Dfa.Yqb&&(this.Dfa.Yqb=!0)}EUf(Q){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Plb.lb(Q)){try{this.Plb.na(Q).releasePointerCapture(Q)}catch(U){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",U)}this.Plb.remove(Q)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.oT.remove(Q);this.cWa&&1>=this.oT.count&&this.Dfa&&this.Dfa.Yqb&&(this.Dfa.Yqb=!1)}gqc(Q,
U,Z){var P=Z.rawEvent.pointerType.toString();const S=Z.rawEvent.pointerId.toString();if("touch"!==P)return!1;Q=this.R3e(Q);if(1!==Q&&!this.oT.lb(S))return!1;this.Z6d&&1===Q&&Z.rawEvent.isPrimary&&this.oT.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.o3b());this.rnb?this.wIg(S,U,Z):this.oT.ia(S,Z);this.WOc&&2===Q&&(!this.lIc||this.lIc&&"function"===typeof Z.rawEvent.getCoalescedEvents)&&(U=Z.rawEvent.getCoalescedEvents())&&this.iaf()&&(this.Xkb=Math.max(this.Xkb,
U.length));this.Nie&&(this.h9=!1);P=this.FVh(this.oT,Z,P);Hammer.inputHandler(this,Q,P);if(4===Q||8===Q)this.rnb?this.EUf(S):this.oT.remove(S),this.oT.count||(this.session=null,this.WOc&&-1!==this.Xkb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Xkb),this.Xkb=-1));this.h9&&Z.preventDefault();return this.h9}Rpc(){return!1}GVh(Q){const U=new A;var Z=Q.rawEvent;const P=Z.touches;Z=Z.changedTouches;U.pointers=Array.clone(P);U.pointers=Array.clone(0<P.length?P:Z);U.changedPointers=
Array.clone(Z);U.srcEvent=Q;U.pointerType="touch";return U}FVh(Q,U,Z){const P=new A;P.pointers=T.toArray(Q.values);P.changedPointers=[U];P.pointerType=Z;P.srcEvent=U;return P}Vpi(Q){return V.a.startsWith(Q,v.a.pinch)}Lpi(Q){return V.a.startsWith(Q,v.a.pan)}Ssi(Q){return V.a.startsWith(Q,v.a.swipe)}}Object(u.a)(H,"GestureInputManager",n.a,[337,338]);var D=a(276),G=a(248);class J{constructor(){this.gb=null;this.tx=!1}get name(){return"Common.App.GestureInputManager"}Xh(Q){Q.register(H,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").xc().Fc(()=>
new H(D.a.instance,x.AFrameworkApplication.ta.lE));this.gb=Q}init(){this.tx||(this.gb.resolve("Common.App.GestureManager.GestureInputManager"),this.tx=!0)}dispose(){}static main(){G.a.instance.Ei(new J)}}Object(u.a)(J,"GestureInputManagerPackage",null,[3,4]);a.d(F,"a",function(){return M});const M=()=>{Type.registerNamespace("Common.App.GestureManager");J.main()}},1191:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(27),f=a(89),d=a(30),h=a(419),n=a(238);class m{}m.xuh="ewa-dv";m.yuh="ewa-dv-buttonarea";
m.Qth="ewa-dlb";m.CDb="list-table";m.listItem="list-item";m.zDb="list-item-selected";m.DDb="list-table-touch";m.wuh="ewa-dpb";m.Uoh="dv-prompt-title";m.Toh="dv-prompt-message";Object(u.a)(m,"CssClassNames",null,[]);var x=a(31),r=a(734),y=a(19),t=a(50),v=a(429),w=a(76),C=a(7),B=a(15),z=a(154),A=a(822),E=a(37),I=a(13),L=a(21),V=a(262),T=a(68);class H extends z.ErrorDialog{constructor(fb,Ka,hb){super(fb,H.OQ(Ka,fb,hb));this.Pc=()=>{this.setFocus()};L.h(this.$).ha.hH(this.Pc);(fb=fb.da.Aa(14).K4a(hb))&&
fb.options&1&&B.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){L.h(this.$).ha.kG(this.Pc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var fb=4;break;case 1:fb=3;break;case 2:fb=0;break;default:fb=this.PM}(fb=this.getButton(fb))?fb.get_element().focus():super.setFocus()}Srb(){const fb=L.h(this.$);fb.eb&&fb.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",
0);4===this.returnValue&&this.XWd(1);if(2===this.returnValue||0===this.returnValue){const Ka=fb.Sb(null);if(Ka){fb.Da.EV();const hb=Object(C.a)(new V.a,{Text:Ka.originalText});fb.setCell(hb,Ka.range,0,63,null)}this.$.Xc(-798660877,w.a.Db,8,null)}super.Srb()}$sa(){const fb=L.h(this.$);fb.eb&&fb.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.XWd(0);super.$sa()}XWd(fb){const Ka=L.h(this.$);E.TaskExtensions.za(Ka.startEdit(!1,fb),()=>{const hb=Ka.Vb.textBox;
hb.text&&hb.selectRange(0,hb.text.length)},this.ka,11,T.a.current)}static OQ(fb,Ka,hb){hb=Ka.da.Aa(14).K4a(hb);fb.MessageId=-1083021405;fb.MessageIdName="DataValidationError";fb.MessageIdHash=d.a.mw(fb.MessageIdName);fb.Severity=hb?hb.cad:1;Ka=(null===hb||void 0===hb?0:hb.SJa)?d.a.Hg(hb.SJa):null;hb=(null===hb||void 0===hb?0:hb.error)?d.a.Hg(hb.error):String.format("<p>{0}</p><p>{1}</p>",I.a.instance.ga(895),I.a.instance.ga(896));switch(fb.Severity){case 0:fb.Appearance=18;break;case 1:fb.Appearance=
12;hb+=String.format("<p>{0}</p>",I.a.instance.ga(897));break;default:fb.Appearance=3}fb.Caption=Ka;fb.Description=hb;fb.HelpDescription=I.a.instance.ga(1315);fb.HelpTopicId=A.a.pKe;return fb}}Object(u.a)(H,"DataValidationErrorDeprecatedDialog",z.ErrorDialog,[]);z=a(284);var D=a(1085),G=a(5),J=a(40),M=a(283),Q=a(192),U=a(52),Z=a(29),P=a(282),S=a(1),ja=a(11),X=a(281),Y=a(159);class va extends z.a{constructor(fb,Ka,hb){super(fb);this.VU=this.Mq=null;this.rlf=!1;this.vX=this.Sm=this.zbf=this.errorMessage=
null;this.qKe=fc=>{const dc=this.$;var wb=this.rlf;this.hide();const Tb=L.h(dc);Tb.eb&&Tb.Vb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===fc&&wb&&E.TaskExtensions.za(Tb.startEdit(!1,1),()=>{const xb=Tb.Vb.textBox;xb.text&&xb.selectRange(0,xb.text.length)},this.ka,11,T.a.current);if(1===fc&&!wb){if(wb=Tb.Sb(null)){Tb.Da.EV();const xb=Object(C.a)(new V.a,{Text:wb.cell.userInput});Tb.setCell(xb,wb.range,0,63,null)}dc.Xc(-798660877,w.a.Db,8,null)}2===fc&&E.TaskExtensions.za(Tb.startEdit(!1,
0),()=>{const xb=Tb.Vb.textBox;xb.text&&xb.selectRange(0,xb.text.length)},this.ka,11,T.a.current)};this.yDd=()=>{ja.HelperMethods.kW(this.$.GG,this.error.HelpTopicId,this.$.KS)};this.ZRi=()=>{this.gzb();this.$.Xc(802602464,2,8,this.VU)};this.uQi=()=>{B.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.vQi=fc=>{!fc||P.a(fc)?B.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(fc=this.J0h(fc.Result),this.Mq.errorInformation=fc,this.WUa(this.SJa,this.r5a(this.qKe),this.Mq))};this.hDd=()=>{this.show(this.NTb)};this.yQe=hb;this.sqmManager=Y.a(this.$);this.error=va.OQ(Ka,fb,hb);this.rb.kp=this;this.SJa=(this.tv=fb.da.Aa(14).K4a(this.yQe))&&this.tv.SJa?this.tv.SJa:I.a.instance.ga(1727);this.jvj();this.initializeAndShow(this.SJa,this.qKe,this.Mq)}get qc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.kp&&(this.rb.kp=null);f.a.Ia(this.Sm);this.Sm=null;super.dispose()}jvj(){this.tv&&
this.tv.error?this.errorMessage=this.tv.error:this.tv&&this.tv.options&1?(B.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=I.a.instance.ga(1729),this.zbf=U.a.current.fo(120)):(this.errorMessage=I.a.instance.ga(1728),this.BRh(this.yQe));var fb=this.tv?this.tv.cad:1;this.Mq={[va.vu]:this.qc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.zbf};switch(fb){case 0:this.Rb=1;this.pc(1,"Retry");this.Mq.dialogIcon=
2;this.rlf=!0;break;case 1:this.Rb=4;this.Mq.dialogIcon=1;this.Mq.additionalInformation=I.a.instance.ga(897);break;default:this.Rb=1,this.Mq.dialogIcon=3}this.Mq.helpLink={["type"]:"AppLinkProps",[va.vu]:this.error.HelpTopicId,["text"]:I.a.instance.ga(1315),["handler"]:this.yDd};fb=Z.a.VYc([this.error]);this.VU={[G.a.bac]:!0,[G.a.kcd]:fb,[G.a.lcd]:Y.a(this.$).Mub(this.error.MessageIdHash),[G.a.DQ]:this.qc,["DismissHandler"]:this.hDd};this.Mq.giveFeedbackLink={["type"]:"AppLinkProps",[va.vu]:G.a.lkd,
["text"]:I.a.instance.ga(1766),["handler"]:this.ZRi}}BRh(fb){const Ka=this.$.pa.ya.Wb();M.g(this.$.pa.ya,J.q(fb,this.$),X.b(this.vQi),X.a(this.uQi),null,Ka)}J0h(fb){let Ka;S.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");B.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${D.a[fb.RuleType].toString()}`);switch(fb.RuleType){case 1:switch(fb.ConditionType){case 0:return Ka=I.a.instance.mb(108),
String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ka=I.a.instance.mb(109),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ka=I.a.instance.mb(110),String.format(Ka,fb.LowerBoundary);case 3:return Ka=I.a.instance.mb(111),String.format(Ka,fb.LowerBoundary);case 4:return Ka=I.a.instance.mb(112),String.format(Ka,fb.LowerBoundary);case 5:return Ka=I.a.instance.mb(113),String.format(Ka,fb.UpperBoundary);case 6:return Ka=I.a.instance.mb(114),String.format(Ka,fb.LowerBoundary);
case 7:return Ka=I.a.instance.mb(115),String.format(Ka,fb.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(fb.ConditionType){case 0:return Ka=I.a.instance.mb(116),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ka=I.a.instance.mb(117),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ka=I.a.instance.mb(118),String.format(Ka,fb.LowerBoundary);case 3:return Ka=I.a.instance.mb(119),String.format(Ka,fb.LowerBoundary);case 4:return Ka=I.a.instance.mb(120),
String.format(Ka,fb.LowerBoundary);case 5:return Ka=I.a.instance.mb(121),String.format(Ka,fb.UpperBoundary);case 6:return Ka=I.a.instance.mb(122),String.format(Ka,fb.LowerBoundary);case 7:return Ka=I.a.instance.mb(123),String.format(Ka,fb.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(fb.ConditionType){case 0:return Ka=I.a.instance.mb(124),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ka=I.a.instance.mb(125),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);
case 2:return Ka=I.a.instance.mb(126),String.format(Ka,fb.LowerBoundary);case 3:return Ka=I.a.instance.mb(127),String.format(Ka,fb.LowerBoundary);case 4:return Ka=I.a.instance.mb(128),String.format(Ka,fb.LowerBoundary);case 5:return Ka=I.a.instance.mb(129),String.format(Ka,fb.UpperBoundary);case 6:return Ka=I.a.instance.mb(130),String.format(Ka,fb.LowerBoundary);case 7:return Ka=I.a.instance.mb(131),String.format(Ka,fb.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(fb.ConditionType){case 0:return Ka=
I.a.instance.mb(132),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ka=I.a.instance.mb(133),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ka=I.a.instance.mb(134),String.format(Ka,fb.LowerBoundary);case 3:return Ka=I.a.instance.mb(135),String.format(Ka,fb.LowerBoundary);case 4:return Ka=I.a.instance.mb(136),String.format(Ka,fb.LowerBoundary);case 5:return Ka=I.a.instance.mb(137),String.format(Ka,fb.UpperBoundary);case 6:return Ka=I.a.instance.mb(138),String.format(Ka,
fb.LowerBoundary);case 7:return Ka=I.a.instance.mb(139),String.format(Ka,fb.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(fb.ConditionType){case 0:return Ka=I.a.instance.mb(140),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 1:return Ka=I.a.instance.mb(141),String.format(Ka,fb.LowerBoundary,fb.UpperBoundary);case 2:return Ka=I.a.instance.mb(142),String.format(Ka,fb.LowerBoundary);case 3:return Ka=I.a.instance.mb(143),String.format(Ka,fb.LowerBoundary);case 4:return Ka=
I.a.instance.mb(144),String.format(Ka,fb.LowerBoundary);case 5:return Ka=I.a.instance.mb(145),String.format(Ka,fb.UpperBoundary);case 6:return Ka=I.a.instance.mb(146),String.format(Ka,fb.LowerBoundary);case 7:return Ka=I.a.instance.mb(147),String.format(Ka,fb.UpperBoundary);default:return"we couldn't get the details"}case 3:return Ka=I.a.instance.mb(106),String.format(Ka,fb.LowerBoundary);case 7:return Ka=I.a.instance.mb(107),String.format(Ka,fb.LowerBoundary);default:return"we couldn't get the details"}}XWd(fb){const Ka=
L.h(this.$);E.TaskExtensions.za(Ka.startEdit(!1,fb),()=>{const hb=Ka.Vb.textBox;hb.text&&hb.selectRange(0,hb.text.length)},this.ka,11,T.a.current)}get ka(){this.Sm=this.Sm||new Q.a;return this.Sm.token}static OQ(fb,Ka,hb){Ka=Ka.da.Aa(14).K4a(hb);fb.MessageId=-1083021405;fb.MessageIdName="DataValidationError";fb.MessageIdHash=d.a.mw(fb.MessageIdName);fb.Severity=Ka?Ka.cad:1;fb.HelpDescription=I.a.instance.ga(1315);fb.HelpTopicId=A.a.pKe;return fb}}Object(u.a)(va,"DataValidationErrorDialog",z.a,[82,
83,2,84]);z=a(912);var N=a(385);class ea extends z.a{constructor(fb,Ka,hb){super(fb,Ka);this.dataValidationControl=hb}get BAb(){return Object(h.a)(va,this.$.rb.Kh)}get KK(){return this.dataValidationControl.se}set KK(fb){this.dataValidationControl.se=fb}get A6a(){return!1}get key(){return N.a.F7c}dispose(){this.dataValidationControl=null;super.dispose()}Zh(fb,Ka){this.dataValidationControl.Za=this.Za;const hb=fb.keyCode;return 1461300262!==Ka||16!==hb&&17!==hb&&18!==hb?super.Zh(fb,Ka):!1}nCd(){this.KK&&
(this.dataValidationControl.Za=this.Za,this.dataValidationControl.show(this.dataValidationControl.GN,!0,!0,e.a.Dp||3===w.a.Db))}jg(){}uh(){this.dataValidationControl.show(this.dataValidationControl.GN,!0,!0,e.a.Dp||3===w.a.Db)}QId(fb,Ka){return this.dataValidationControl.Zh(Ka)}}Object(u.a)(ea,"DataValidationListAutoCompleteBehavior",z.a,[]);var Ca=a(263);z=a(839);var la=a(12),Ra=a(117),lb=a(22),Aa=a(911);class da extends z.a{constructor(fb,Ka,hb,fc){super(fb,Ka,new Aa.a(m.listItem,m.zDb,m.CDb,m.DDb));
this.dJa=this.YV=this.$da=this.ee=this.Dmb=null;this.BOa=0;this.sHb=[];this.mXj=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.BDb=hb;this.htmlSanitizationHelper=fc}get Qj(){return this.Dmb}set Qj(fb){this.dCa(this.Dmb);if(fb){this.Dmb=fb;this.BDb.innerText="";this.dCa(this.Dmb);const Ka=this.sHb[fb.rowIndex];this.ee=this.YV[Ka];this.dJa&&(this.$da=this.dJa[Ka],B.ULS.shipAssertTag(537163286,0,!this.sHb.length||!!this.$da,
"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.BDb.innerText=this.ee;this.Ywc(fb)}else this.$da=this.ee=null}get eb(){return L.h(this.$).eb}get editText(){return L.h(this.$).Vb.text}dispose(){super.dispose();this.BDb=this.Dmb=null}Qea(fb,Ka,hb,fc){if(fb&&(!fb||fb.length)){this.b8(!1);this.dJa=fb;this.YV=[];for(var dc=0;dc<fb.length;dc++)this.YV[dc]=fb[dc]?fb[dc].Name:null;dc=`<table class='${this.i6}' aria-live='polite'><tbody>`;var wb="",Tb="";fb=0;
var xb=L.h(this.$).Sb(null);fc=this.eb?fc?fc.text:this.editText:xb?xb.originalText:null;xb=!fc;var cb=0;this.sHb.length=0;var jb=[],qa=[],za=[],Na=fc?fc.split(" "):[""];fc=fc.trim();for(let Xa=0;Xa<this.YV.length;Xa++){const ha=this.YV[Xa];var ua=void 0;const ta=ha.split(" ");ua=Ca.a.all(Na,Jb=>Ca.a.any(ta,Pb=>lb.a.YI(Pb,Jb)));const wa=!ha,db=za.includes(ha);wa||db||this.eb&&!ua||(ua=ha?d.a.Hg(d.a.h$c(ha)):"",ua=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.XV,ua),za.push(ha),this.eb&&
lb.a.YI(ha,fc)?(wb+=ua,jb.push(Xa)):(Tb+=ua,qa.push(Xa)),!xb&&lb.a.equals(fc,ha,!0)&&(fb=this.eb?jb.length-1:cb,xb=!0),cb++)}this.BOa=cb;this.sHb.push(...jb);this.sHb.push(...qa);dc+=wb+Tb+"</tbody></table>";S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7126089_ReduceInnerHTMLUsageForDataValidationListBox")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(this.Lf,dc):this.Lf.innerHTML=dc;dc=this.Jn=la.DOMElementExtensions.nk(this.domElement,
this.i6);this.mob(dc,Ka);this.b8(!0);this.tsa(Ka,hb);this.Qj=0<this.BOa?dc.rows[fb]:null}}HSa(fb){var Ka=!1;this.eb&&fb&&(Ka=!this.BOa,fb.endEdit(Ka,"DataValidationListBox.SetCellContent",0));if(!Ka&&(fb=L.h(this.$),Ka=fb.Sb(null))){let fc=null;if(this.$da&&-1!==this.$da.SheetId&&-1!==this.$da.Row&&-1!==this.$da.Column){var hb={};hb.SheetName=this.$da.SheetId.toString();hb.FirstRow=this.$da.Row;hb.FirstColumn=this.$da.Column;fc={ParameterType:6};fc.SourceRange=hb}hb=Object(C.a)(new V.a,{Text:this.ee});
fb.setCell(hb,Ka.range,0,63,fc)}return!0}tsa(fb,Ka){const hb=fb?this.uEb:this.pI;fb=fb?this.Jlc:this.Klc;0>=this.BOa?this.Lf.style.height=ja.HelperMethods.uc(fb):(this.Lf.style.height="auto",this.BOa>hb?(la.DOMElementExtensions.gJ(this.Lf,this.mXj?Math.floor(fb*hb):Math.floor(this.Lf.offsetHeight*hb/this.BOa)),this.Lf.style.overflowY="auto"):(this.Lf.style.height="auto",this.Lf.style.overflowY="hidden"));la.DOMElementExtensions.Vv(this.Lf,Ka);la.DOMElementExtensions.Vv(this.Jn,Ka-(this.BOa>hb?Ra.a.Ou:
0))}}Object(u.a)(da,"DataValidationListBox",z.a,[]);var aa=a(113),fa=a(251),Oa=a(254),ba=a(1094);const ka=`<p class='${m.Uoh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,Pa=`<p class='${m.Toh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var Fa=y.a.PRe,oa=y.a.PRe,La=y.a.q4g;class Ea extends n.a{constructor(fb,Ka){super(document.createElement("div"));this.O2b=this.UQ=this.rR=!1;this.ai=this.Rh=null;this.Fli=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");
this.Gli=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.Bpd=this.tsd=this.Ard=!1;this.s7b=[];this.htmlSanitizationHelper=null;this.Sh=()=>{this.B8f(!1)};this.LPa=(hb,fc)=>{this.show(this.GN,!this.se,!0,e.a.Dp||3===fc.tb||3===w.a.Db);this.TCd(null,null)};this.TCd=()=>{this.gridView.setFocus()};this.CMa=()=>{this.Za.textBox.HF=!0};this.Tt=()=>{this.Xig()};this.onContentReady=()=>{this.B8f(this.se)};this.yc=()=>{this.ny()};this.sza=()=>{this.HSa()};this.OBf=
()=>{this.Xig()};this.$=fb;this.gridView=L.h(this.$);this.oJ=this.gridView.Vb;this.htmlSanitizationHelper=Ka;Ka="<div id='dv_reader_description' class='"+x.a.fSe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+m.yuh+" "+y.a.zo+"'></div>\r\n<div id='dv_list_box' class='"+m.Qth+" "+y.a.Ao+" "+y.a.zo+"'></div>\r\n<div id='dv_prompt_box' class='"+m.wuh+" "+y.a.zo+"'></div>";this.domElement.className=m.xuh;S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
S.EwaSettings.isChangeGateEnabled("OfficeVSO:7126086_ReduceInnerHTMLUsageForDataValidationControl")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(this.domElement,Ka):this.domElement.innerHTML=Ka;fa.d(this.style,this.isGridRtl);this.Lf=$get("dv_list_box",this.domElement);this.EW=$get("dv_prompt_box",this.domElement);this.Usa=$get("dv_list_button",this.domElement);this.BDb=$get("dv_reader_description",this.domElement);(Ka=aa.a(fb))&&this.s7b.push(new ea(fb,Ka,this));this.s7b.push(new ea(fb,
this.gridView.Vb,this));this.gridView.ha.fH(this.Sh);this.gridView.lv(this.onContentReady);this.gridView.fc.kLg(this.OBf);this.$.Xj(this.yc);Ka=this.gridView.zj;Ka.insertBefore(this.domElement,Ka.firstChild);this.onContentReady(null,null);fb.da.Ga(14,this)}get iCb(){return!!(this.$.qd&16)}get zti(){return this.se||this.GN||this.exa}get se(){return la.DOMElementExtensions.isVisible(this.Lf)}set se(fb){la.DOMElementExtensions.setVisible(this.Lf,fb)}get GN(){return la.DOMElementExtensions.isVisible(this.EW)}set GN(fb){la.DOMElementExtensions.setVisible(this.EW,
fb)}get exa(){return la.DOMElementExtensions.isVisible(this.Usa)&&!!this.Rh&&la.DOMElementExtensions.isVisible(this.Rh.domElement)}set exa(fb){la.DOMElementExtensions.setVisible(this.Usa,fb);this.Rh&&la.DOMElementExtensions.setVisible(this.Rh.domElement,fb)}get Za(){return this.oJ}set Za(fb){this.oJ=fb}get U5a(){return!!this.activeCell&&this.g9c(this.activeCell.range)}get activeCell(){return this.gridView.Sb(null)}get Saf(){return this.U5a&&!!this.tv&&!!(this.tv.options&2)&&!!this.tv.prompt}get Fyb(){return this.U5a&&
!!this.tv&&!!(this.tv.options&1)}get isGridRtl(){return this.gridView.rtl}get tv(){return this.K4a(this.activeCell.range)}get vPa(){const fb=this.activeCell;return fb?this.awa(this.gridView,fb):null}dispose(){this.$&&(this.FOb(!1),this.gridView.ha.rL(this.Sh),this.gridView.Ky(this.onContentReady),this.gridView.fc.Ggj(this.OBf),this.$.Jl(this.yc));this.CIe(!1);this.DIe(!1);f.a.rc(this.s7b);this.s7b=this.Usa=this.Lf=this.EW=this.oJ=this.gridView=this.$=null;super.dispose()}g9c(fb){return!!this.K4a(fb)}Dsb(fb,
Ka){return S.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new va(this.$,fb,Ka):new H(this.$,fb,Ka)}K4a(fb){fb=this.gridView.getRangeInformation(fb);for(let Ka=0;Ka<fb.length;Ka++){const hb=fb[Ka];if(Object(h.a)(v.DataValidationRange,hb))return hb}return null}BNh(){if(!this.U5a)return"";const fb=this.Saf?`${this.tv.iPf} ${this.tv.prompt}`:"",Ka=this.Fyb?I.a.instance.ga(842):"";return String.format(I.a.instance.mb(17),fb,Ka)}Zh(fb){let Ka=!1;if(this.se||(-569786022===
fb||541421805===fb)&&this.Fyb||1872288872===fb&&this.GN)switch(fb){case -569786022:case 541421805:this.show(this.GN,!this.se,!0,e.a.Dp||3===w.a.Db);Ka=!0;break;case 1872288872:this.se?(this.show(this.GN,!1,!0,!1),Ka=!0):this.GN?(this.show(!1,!1,!0,!1),Ka=!0):this.Za&&(this.Za.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Ka=!0);break;case -798660877:this.ai.CB(1);Ka=!0;break;case 137938150:this.ai.CB(-1);Ka=!0;break;case 2091832999:this.ai.CB(this.ai.pI-1);Ka=!0;break;case 742457698:this.ai.CB(-(this.ai.pI-
1));Ka=!0;break;case 125627505:case 267796030:Ka=this.HSa()}return Ka}show(fb,Ka,hb,fc){this.ny();if(this.iCb&&this.U5a){var dc=this.vPa;if(dc){if(fb||Ka||hb)this.isVisible=!0;fa.d(this.style,this.isGridRtl);hb&&this.Fyb&&(this.DIe(!0),this.Oig(dc,!1));Ka&&this.Fyb&&this.wTa(fc,dc);fb&&this.Saf&&this.SGj(dc);this.zti||(this.isVisible=!1)}}}awa(fb,Ka){if(!Ka||!Ka.cell.Pk)return null;var hb=this.gridView.fc.textBox.domElement;var fc=0<la.DOMElementExtensions.getHeight(hb)&&0<la.DOMElementExtensions.getWidth(hb)&&
0<=hb.offsetTop&&0<=hb.offsetLeft;if(fc)hb=la.DOMElementExtensions.awa(hb,fb.zj);else{hb=fb.getCellBounds(Ka.cell);var dc=la.DOMElementExtensions.getBoundingClientRect(fb.zj);hb=new Sys.UI.Bounds(hb.x-dc.x,hb.y-dc.y,hb.width,hb.height)}if(hb)if(fc)2<hb.height&&2<hb.height&&(hb.x+=1,hb.y+=1,hb.height-=2,hb.width-=2);else if(fc=L.h(this.$).sK(Ka.cell))fc=fc.width+1,dc=lb.a.equals(Oa.a.Rwb(Ka.cell,fb.rtl),"right",!0),fb.rtl&&dc&&(hb.x=hb.x+hb.width-fc),Ka.wla&&fb.rtl===dc&&(hb.width=fc);else return null;
return hb}B8f(fb){const Ka=this.U5a;this.FOb(Ka);Ka?this.show(!0,fb,!0,!1):this.ny()}HSa(){let fb=!1;this.se&&(fb=this.ai.HSa(this.Za),this.show(this.GN,!1,!0,!1));return fb}ny(){this.Fli?(this.se&&(this.se=!1),this.exa&&(this.exa=!1),this.GN&&(this.GN=!1),this.isVisible&&(this.isVisible=!1)):this.se=this.exa=this.GN=this.isVisible=!1;this.Ard=this.Bpd=this.tsd=!1}wTa(fb,Ka){this.Fyb&&!this.tv.dJa?this.exa&&this.Rh.disable():(this.CIe(!0),this.ai.Qea(this.tv.dJa,fb,this.KWh(Ka),this.Za),this.wCa(Ka,
!1))}SGj(fb){this.tv.prompt&&(this.GN=!0,this.eZj(this.tv.iPf,this.tv.prompt),this.hjg(fb,!1))}Oig(fb,Ka){const hb=fb.y;this.Usa.style.top=ja.HelperMethods.uc(hb);fb=this.isGridRtl?fb.x-this.Usa.offsetWidth+1:fb.x+fb.width+1;this.Usa.style.left=ja.HelperMethods.uc(fb);Ka?this.exa=this.gridView.skc(new t.a(fb,hb))&&this.Bpd:this.Bpd=!0}wCa(fb,Ka){const hb=fb.y+fb.height;fb=this.isGridRtl?fb.x+fb.width-this.Lf.offsetWidth:fb.x;this.Lf.style.top=ja.HelperMethods.uc(hb);this.Lf.style.left=ja.HelperMethods.uc(fb);
Ka?this.se=this.gridView.skc(new t.a(fb,hb))&&this.Ard:this.Ard=!0}hjg(fb,Ka){const hb=fb.y+fb.height+5;var fc=this.activeCell;fc=fc?fc.width/2:32;fb=this.isGridRtl?fb.x-this.EW.offsetWidth+fc:fb.x+fb.width-fc;this.EW.style.top=ja.HelperMethods.uc(hb);this.EW.style.left=ja.HelperMethods.uc(fb);Ka?this.GN=this.gridView.skc(new t.a(fb,hb))&&this.tsd:this.tsd=!0}eZj(fb,Ka){if(Ka){var hb="";fb&&(hb+=String.format(ka,d.a.Hg(fb)));hb+=String.format(Pa,d.a.Hg(Ka));S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
S.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl2")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(this.EW,hb):this.EW.innerHTML=hb;fb=la.DOMElementExtensions.nk(this.EW,"dv-prompt-titletext");if(Ka=la.DOMElementExtensions.nk(this.EW,"dv-prompt-messagetext")){fb=fb?parseInt(String(Math.max(fb.offsetWidth,Ka.offsetWidth)),10):Ka.offsetWidth;fb+=6;la.DOMElementExtensions.Vv(this.EW,fb);for(let fc=0,dc=this.EW.children.length;fc<dc;fc++)la.DOMElementExtensions.Vv(this.EW.children[fc],
fb)}}}KWh(fb){return this.Gli?fb.width+17-2+1:fb.width+this.Usa.clientWidth-2+1}DIe(fb){this.$&&!this.iCb||!fb?(this.Kbg(!1),f.a.Ia(this.Rh),this.Rh=null):(this.Rh||(this.Rh=new ba.a(this.Usa,Fa,r.a.xia,1,oa,I.a.instance.ga(894),La,I.a.instance.ga(893),"",-1),this.Kbg(!0)),this.exa=!0,this.tv.dJa?this.Rh.isEnabled||this.Rh.enable():this.Rh.disable())}CIe(fb){this.$&&!this.iCb||!fb?(this.dUa(!1),f.a.Ia(this.ai),this.ai=null):(this.ai||(this.ai=new da(this.$,this.Lf,this.BDb,this.htmlSanitizationHelper),
this.dUa(!0)),this.se=!0)}dUa(fb){this.ai&&(fb&&!this.rR?(this.ai.a$(this.TCd),this.ai.d0b(this.CMa),this.ai.Hob(this.sza),this.rR=!0):!fb&&this.rR&&(this.ai.Kda(this.TCd),this.ai.Puc(this.CMa),this.ai.rKb(this.sza),this.rR=!1))}FOb(fb){fb&&!this.UQ?(this.gridView.view.ot(this.Tt),this.UQ=!0):!fb&&this.UQ&&(this.gridView.view.er(this.Tt),this.UQ=!1)}Kbg(fb){this.Rh&&(fb&&!this.O2b?(this.Rh.bXc(this.LPa),this.Rh.nXc(this.LPa),this.Rh.tob(this.CMa),this.O2b=!0):!fb&&this.O2b&&(this.Rh.eMd(this.LPa),
this.Rh.rMd(this.LPa),this.Rh.cKb(this.CMa),this.O2b=!1))}Xig(){if(this.U5a){var fb=this.vPa;fb&&(this.Oig(fb,!0),this.wCa(fb,!0),this.hjg(fb,!0))}}}Object(u.a)(Ea,"DataValidationControl",n.a,[233,2]);var ca=a(49),$a=a(55);class Qa extends b.a{constructor(fb){super();this.$=fb;this.Fb()}create(){const fb=S.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&S.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl")?ca.GetServiceTaskFactory.Oa(this.$.da,
498,499,this.Ya):$a.Task.Ta(null);E.TaskExtensions.za(fb,()=>{this.nb(this.$.da.Aa(14)||new Ea(this.$,fb.result))},this.ka,3)}}Object(u.a)(Qa,"DataValidationControlFactory",b.a,[]);a.d(F,"a",function(){return Va});const Va=()=>{c.a.Fa(fb=>{fb.da.Ga(150,new Qa(fb))})}},1216:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(187);const f={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,
dismissSmartSuggestionImplicitlyCounter:0},d={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},h={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,argumentAssistanceCardIsInitialModeDefault:!1},n={smartSuggestionShownCounter:0,
smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},m={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},x={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},r={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,
smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0};var y;(function(D){D.RenderDown="rd";D.RenderUp="ru";D.Expand="e";D.Collapse="c";D.Drag="d";D.Move="m";D.GiveFeedback="gf";D.InitialModeExpanded="ie";D.InitialModeCollapsed="ic";D.LearnMore="lm"})(y||(y={}));Object(u.b)("argumentAssistanceUsageActions",
y);var t=a(58),v=a(1095),w=a(1),C=a(22),B=a(41),z=a(21),A=a(99),E;(function(D){D[D.function=3]="function";D[D.namedRange=100]="namedRange";D[D.tableHeader=101]="tableHeader";D[D.letVariable=102]="letVariable";D[D.richEntity=103]="richEntity";D[D.lambda=104]="lambda";D[D.customFunction=105]="customFunction";D[D.table=106]="table";D[D.tableSpecialStructRef=107]="tableSpecialStructRef";D[D.richEntityEmptyCellRef=108]="richEntityEmptyCellRef";D[D.rangeRef=109]="rangeRef"})(E||(E={}));Object(u.b)("CompletionItemKind",
E);var I=a(33);const L={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class V{constructor(D){this.$=D;this.jI=null;this.iDb=-1;this.qlc=null;this.slc=0;this.RP=Object.assign({},
h);this.qK=Object.assign({},n);this.MJ=Object.assign({},f);this.Ypb=Object.assign({},d);this.ibc=Object.assign({},m);this.lX=Object.assign({},r);this.Zpb={};this.h4a=Object.assign(Object.assign({},x),{isReactDialog:I.a.hkf()});this.vpb=[];this.XZc=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7190603_FATMAvoidSilentReopen");this.iHa=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.jg=(G,J)=>{null!=this.jI&&(1==Math.abs(this.iDb-this.$.ea.ze)&&(G=
this.$.xa.oa.sheetId,J.Vrb&&J.lk.equals(this.jI.lk)&&this.qlc===G&&this.jI.F3b!==J.F3b&&this.slc++),1<=Math.abs(this.iDb-this.$.ea.ze)&&(this.jI=null,this.iDb=-1,this.qlc=null))};this.yc=(G,J)=>{this.XZc&&(J.Of||J.Ohf)||(this.Fyj(),this.Pyj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.dbb=new A.a;D.Xj(this.yc);z.h(this.$).zi.Rm(this.jg)}dispose(){this.$&&z.h(this.$).zi.em(this.jg)}YB(D){D.forEach(G=>{this.dbb.lb(G)||this.dbb.ia(G,new v.a(L[G]));this.dbb.na(G).VTa()})}yw(D,
G=!0){D.forEach(J=>{this.dbb.lb(J)&&this.dbb.na(J).m4(G)})}H2f(D){this.FJ(0===D?"ie":"ic")}fuj(D){this.FJ(D?"ie":"ic")}G2f(){this.RP.argumentAssistanceCardIsInitialModeDefault=!0}Lua(D){window.requestAnimationFrame(()=>{this.yw([D])})}Mdf(D){D.forEach(G=>{G=E[G.kind];this.klg(G);this.Zpb[G].shownCounter++})}Ldf(D){D=E[D];this.klg(D);this.Zpb[D].committedCounter++}FJ(D){if(this.iHa){const G=this.vpb.length;0===G||this.vpb[G-1][0]!==D?this.vpb.push([D,1]):this.vpb[G-1][1]++}else switch(D){case "e":this.RP.argumentAssistanceExpandCounter++;
break;case "c":this.RP.argumentAssistanceCollapseCounter++;break;case "d":this.RP.argumentAssistanceDragCounter++;break;case "m":this.RP.argumentAssistanceMoveCounter++;break;case "lm":this.RP.argumentAssistanceLearnMoreCounter++;break;case "ie":this.RP.argumentAssistanceCardInitialMode="Expanded";break;case "ic":this.RP.argumentAssistanceCardInitialMode="Collapsed"}}getJsonForLogging(){return"{"+this.TM("SessionDetails",this.lX)+","+this.TM("ArgumentAssistanceUsage",this.RP)+","+this.TM("argumentAssistanceOrderedActions",
this.vpb)+","+this.TM("FormulaSuggestionsUsage",this.qK)+","+this.TM("FunctionDialogUsage",this.h4a)+","+this.TM("AutocompleteCardInteraction",this.MJ)+","+this.TM("AutocompleteRenderOptimization",this.Ypb)+","+this.TM("AutocompleteUsageByKind",this.Zpb)+","+this.TM("FormulaHighlightsUsage",this.ibc)+","+this.o1h()+"}"}Pyj(){this.qK.smartSuggestionKeptCounter=this.qK.smartSuggestionCommittedCounter-this.slc}Fyj(){this.lX.argumentAssistanceFlight=this.Rva("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");
this.lX.autoCompleteUIFlight=this.Rva("Microsoft.Office.Excel.","AutoCompleteNewUI");this.lX.smartFormulaBarAutoCompleteFlight=this.Rva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.lX.smartFormulaBarAutoCompletePluginFlight=this.Rva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.lX.formulaAssistanceRedesignFlight=this.Rva("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.lX.NewInsertFunctionDialogFlight=this.Rva("Microsoft.Office.Excel.",
"NewInsertFunctionDialog");this.lX.coloredReferencesFlight=this.Rva("Microsoft.Office.Excel.","ColoredReferences");this.lX.parenthesesCouplingFlight=this.Rva("Microsoft.Office.Excel.","ParenthesesCoupling");this.lX.smartFormulaSuggestionsFeatureEnabled=I.a.qNa(this.$)}o1h(){const D=new e.a;for(let G of this.dbb)G.value.BXe(),D.add(`"${G.key}":${t.a.hc(G.value.sW)}`);return`"PerfMeasurements": {${D.toArray().join(",")}}`}Rva(D,G){return C.a.contains(this.$.va.FlightHolder.FlightId,G,!0)?w.EwaSettings.getBooleanFeatureGate(D+
G,!1)?"T":"C":"None"}TM(D,G){return`"${D.toString()}":${B.c(G)}`}klg(D){this.Zpb[D]||(this.Zpb[D]={shownCounter:0,committedCounter:0})}}Object(u.a)(V,"FormulaAssistanceTelemetryManager",null,[226]);class T extends b.a{constructor(D){super();this.$=D;this.Fb()}static la(D){D.da.Ga(492,new T(D))}create(){var D;this.nb(null!==(D=this.$.da.Aa(491))&&void 0!==D?D:this.$.da.Ga(491,new V(this.$)))}}Object(u.a)(T,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(F,"a",function(){return H});const H=()=>
{c.a.Fa(D=>{T.la(D)})}},1220:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(276),e=a(93),f=a(39),d=a(263),h=a(549),n=a(4),m=a(83),x=a(419),r=a(718),y=a(8),t=a(31),v=a(19),w=a(61),C=a(5),B=a(789),z=a(1048),A=a(838),E=a(13),I=a(33);class L{constructor(xb,cb,jb,qa,za,Na,ua,Xa){this.$=cb;this.Va=jb;this.ul=qa;this.selectedRanges=za;this.grid=Na;this.Ry=Xa;this.h5=ua;this.mha=d.a.all(za,ha=>ha.isRow);this.xsa=d.a.all(za,ha=>ha.hf);this.pFb=d.a.all(za,ha=>!ha.isRow&&!ha.hf);cb=Na.Bb.vjd(za);this.Ksb=!!cb;
this.WWf=!!cb&&cb.hasActiveFilter;this.menuSection=jb.Ec();xb.tc.push(this.menuSection);this.Aba=this.mha||this.xsa?this.menuSection:jb.Ec();this.hua=this.mha||this.xsa?this.menuSection:jb.Ec()}Ced(){this.XKh();this.AKh();const xb=this.Ry.j8a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.pb(xb?149:148))}cLh(){let xb=0;this.Ksb?this.h5.xm(942362098)?xb=this.Ry.xm(this.ul,942362098,this.selectedRanges,this.grid)?161:169:this.WWf&&(xb=this.Ry.xm(this.ul,-1113896058,this.selectedRanges,
this.grid)?177:181):this.h5.xm(-1113896058)&&(xb=this.mha?this.Ry.xm(this.ul,-1113896058,this.selectedRanges,this.grid)?49:116:this.Ry.xm(this.ul,-1113896058,this.selectedRanges,this.grid)?177:181);0!==xb&&this.Aba.buttons.push(this.Va.pb(xb))}bLh(){let xb;!this.Ksb&&this.h5.xm(-1113896058)&&(xb=this.mha?this.Ry.xm(this.ul,-1113896058,this.selectedRanges,this.grid)?295:296:this.Ry.xm(this.ul,-1113896058,this.selectedRanges,this.grid)?297:298,this.Aba.buttons.push(this.Va.pb(xb)))}YKh(){let xb=0;this.Ksb?
this.h5.xm(622604322)&&(xb=this.grid.rtl?this.Ry.xm(this.ul,622604322,this.selectedRanges,this.grid)?191:192:this.Ry.xm(this.ul,622604322,this.selectedRanges,this.grid)?162:170):this.h5.xm(1415868706)&&(xb=this.xsa?this.Ry.xm(this.ul,1415868706,this.selectedRanges,this.grid)?50:117:this.Ry.xm(this.ul,1415868706,this.selectedRanges,this.grid)?178:182);0!==xb&&this.Aba.buttons.push(this.Va.pb(xb))}WKh(){this.h5.xm(1035996630)&&(this.Ry.xm(this.ul,1035996630,this.selectedRanges,this.grid)?(this.Aba.buttons.push(this.Va.pb(this.grid.rtl?
187:165)),this.Aba.buttons.push(this.Va.pb(166))):(this.Aba.buttons.push(this.Va.pb(this.grid.rtl?188:173)),this.Aba.buttons.push(this.Va.pb(174))))}XKh(){const {GridContextMenu:xb}=a(1220);let cb=null;this.pFb&&(cb=this.Va.tw("ContextMenu.InsertCells",null,E.a.instance.ga(345),1896159024),cb.menu.tc.push(this.Aba));xb.ZKh(this.Aba,this.Va,this.$);this.cLh();n.AFrameworkApplication.Ip("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");I.a.rrd()&&this.bLh();this.YKh();
this.WKh();cb&&0<this.Aba.buttons.length&&this.menuSection.buttons.push(cb)}CKh(){let xb=0;this.Ksb?this.h5.xm(1405456548)?xb=this.Ry.xm(this.ul,1405456548,this.selectedRanges,this.grid)?163:171:this.WWf&&(xb=this.Ry.xm(this.ul,1554436520,this.selectedRanges,this.grid)?179:183):this.h5.xm(1554436520)&&(xb=this.mha?this.Ry.xm(this.ul,1554436520,this.selectedRanges,this.grid)?51:118:this.Ry.xm(this.ul,1554436520,this.selectedRanges,this.grid)?179:183);0!==xb&&this.hua.buttons.push(this.Va.pb(xb))}BKh(){let xb=
0;this.Ksb?this.h5.xm(284490184)&&(xb=this.Ry.xm(this.ul,284490184,this.selectedRanges,this.grid)?164:172):this.h5.xm(674605324)&&(xb=this.xsa?this.Ry.xm(this.ul,674605324,this.selectedRanges,this.grid)?52:119:this.Ry.xm(this.ul,674605324,this.selectedRanges,this.grid)?180:184);0!==xb&&this.hua.buttons.push(this.Va.pb(xb))}zKh(){this.h5.xm(1035996630)&&(this.Ry.xm(this.ul,1035996630,this.selectedRanges,this.grid)?(this.hua.buttons.push(this.Va.pb(this.grid.rtl?189:167)),this.hua.buttons.push(this.Va.pb(168))):
(this.hua.buttons.push(this.Va.pb(this.grid.rtl?190:175)),this.hua.buttons.push(this.Va.pb(176))))}AKh(){let xb=null;this.pFb&&(xb=this.Va.tw("ContextMenu.DeleteCells",null,E.a.instance.ga(409),-1554384558),xb.menu.tc.push(this.hua));this.CKh();this.BKh();this.zKh();xb&&0<this.hua.buttons.length&&this.menuSection.buttons.push(xb)}}Object(u.a)(L,"CellsContextMenuGenerator",null,[]);var V=a(775);class T{constructor(xb){this.ranges=null;this.ranges=xb}}Object(u.a)(T,"MacroRecorderRangeHyperlinkRemovedPayload",
null,[108]);var H=a(527),D=a(24),G=a(102),J=a(76),M=a(74),Q=a(40),U=a(188),Z=a(60),P=a(605),S=a(142),ja=a(37),X=a(461),Y=a(556),va=a(1),N=a(184),ea=a(21),Ca=a(375),la=a(34),Ra=a(49),lb=a(212),Aa=a(22),da=a(30),aa=a(1073),fa=a(908),Oa=a(132),ba=a(374),ka=a(283),Pa=a(162),Fa=a(154),oa=a(348),La=a(92),Ea=a(29),ca=a(282),$a=a(281),Qa=a(133),Va=a(773),fb=a(774),Ka=a(112),hb=a(41),fc=a(55),dc;(function(xb){xb[xb.none=0]="none";xb[xb.once=1]="once";xb[xb.twice=2]="twice"})(dc||(dc={}));Object(u.b)("ToggleState",
dc);class wb{constructor(xb,cb,jb,qa){this.NYc=this.Qfb=this.Sfb=0;this.$=xb;this.gridView=ea.h(this.$);this.namedSheetViewPublic=cb;this.sg=jb;this.instantaneousSupportInformationManager=qa;this.ENa=Va.a.ppd()}unh(){var xb=this.iV();xb={["CommandValueId"]:hb.c(xb)};const cb=new La.a(-2058042992,2,this.$.Hc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ja.Lb(cb,xb)}Lnh(){const xb=new La.a(644342024,2,this.$.Hc,
19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ja.Lb(xb)}znh(){const xb=this.gridView.ha.ra.activeCell,cb=this.$.da.Aa(66).Lg,jb=this.$.da.Aa(66).Awb(xb);return cb||jb?this.Bnh(cb,jb,xb):this.Anh(xb)}Bnh(xb,cb,jb){if(this.V1g(xb,cb,jb))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),fc.Task.Ta(!1);if(null!=
xb&&xb.hasAutoFilter||null!=cb&&cb.Vsa.every(qa=>0!=qa.length))return this.Sfb=dc.none,this.LYc();this.Sfb=dc.once;return this.K8b(dc.once)}Anh(xb){var cb=Q.v(this.gridView.ha.ra.dd,this.$);cb=this.gridView.$.xa.getItemByName(cb.SheetName);const jb=Q.D(cb.Z0);if(this.U1g(jb,xb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),fc.Task.Ta(!1);if(cb.hasAutoFilter){if(jb&&jb.contains(this.gridView.ha.ra.activeCell))return this.Sfb=
dc.none,this.LYc();this.Sfb=dc.twice;return this.K8b(dc.twice)}this.Sfb=dc.once;return this.K8b(dc.once)}K8b(xb){const cb=Q.v(this.gridView.ha.ra.dd,this.$);if(!cb)return fc.Task.Ta(!1);this.Qfb||(this.Qfb=Date.now());const jb=new La.a(368460465,2,this.$.Hc,19,null),qa=this.$.pa.ya.Wb(),za=()=>new aa.a(cb),Na=ua=>{ca.a(ua)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),
xb===dc.twice?this.K8b(dc.once):this.LYc())};return ba.a(this.$.userOperationManager,(ua,Xa,ha)=>ka.B(this.$.pa.ya,cb,$a.b(ua,Na),Xa,ha,null,qa),ua=>new U.a(516,0,ua,64,za),jb)}V1g(xb,cb,jb){return null!=xb&&Pa.d(xb)&&jb.top===xb.usedRange.top||null!=cb&&cb.oba&&jb.top===cb.top?(this.ktc(this.$,223),!0):null!=xb&&Pa.g(xb)&&jb.top===xb.usedRange.bottom?(this.ktc(this.$,224),!0):!1}U1g(xb,cb){if(xb&&xb.contains(cb)&&cb.top===xb.top||!xb&&this.Y0g(cb.top,cb.left))return this.ktc(this.$,225),!0;xb=new D.Range(cb.top,
cb.left,cb.top+1,cb.left+1,!1,!1);return this.gridView.Bb.Gxa(xb)?(this.ktc(this.$,226),!0):!1}ktc(xb,cb){cb=Ea.a.$c(1,1,751,cb,0,147079615,"ContextMenuFilterByCellValueError");va.EwaSettings.Jz()?new oa.a(xb,cb):(xb=new Fa.ErrorDialog(xb,cb),xb.initialize(),xb.xg())}LYc(){this.NYc=Date.now();const xb=this.L4h();if(!xb)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),fc.Task.Ta(!1);const cb=this.iV(),jb={FirstRow:0};jb.FirstColumn=
cb.Column;jb.SheetName=cb.SheetName;Qa.b(this.$).ud(Oa.a.mzf,this.vm(),void 0,!0);const qa=this.z5c(cb,jb),za=ua=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.Sfb,["ApplyFilterTime"]:this.NYc?Date.now()-this.NYc:-1,["ToggleAndApplyFilterTime"]:this.Qfb?Date.now()-this.Qfb:-1,["FilterByValueType"]:cb.AutoFilterType})}`);this.Qfb&&(this.Qfb=0);if(Va.a.zzc(ua)){const Xa=Va.a.Obc(ua);this.ENa?Va.a.BRa(fb.a.filterByCellValue,
Xa.MessageIdName,Ka.a.pHa,!0,Va.a.isSessionEndingError(Xa.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${Xa.MessageIdName}`)}ca.a(ua)?(ua=Ea.a.sc(ua.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${ua}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Qa.b(this.$).ud(Oa.a.SCf,this.vm(),void 0,!0),ua=
{},ua.FirstRow=this.zTh(),ua.FirstColumn=cb.Column,-1!==ua.FirstRow&&(ua=Q.C(ua),this.FS(ua)))},Na=new U.a(208,0,(ua,Xa,ha)=>Z.a(this.$.pa.ya,qa,xb,$a.b(ua,za),Xa,ha,null,null),6,()=>new fa.a(xb,qa));this.namedSheetViewPublic?this.namedSheetViewPublic.xTa().continueWith(ua=>{ua.result&&this.$.userOperationManager.Ic(Na,null)}):this.$.userOperationManager.Ic(Na,null);return fc.Task.Ta(!0)}FS(xb){I.a.sla(this.$)&&ja.TaskExtensions.za(Ra.GetServiceTaskFactory.Oa(this.$.da,430,431,1),cb=>{cb.result.Nea(xb);
c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.ka,3)}vm(){return{["Location"]:"contextMenu"}}iV(){var xb=0,cb=this.gridView.ha.ra.activeCell;var jb=this.$.da.Aa(66).Lg;const qa=this.$.da.Aa(66).Awb(cb);if(jb){var za="Table";xb=jb.objectId}else qa?(za="Table",xb=qa.id):za="Sheet";jb=cb.left;cb={};cb.AutoFilterType=za;cb.Column=jb;cb.Id=xb;za={};this.$.pk(za);za.FirstRow=0;za.FirstColumn=cb.Column;xb=
this.$.ea.isNamedObjectViewMode;cb.NamedObjectView=xb;cb.SheetName=xb?za.NamedObjectName:za.SheetName;cb.ItemListOptions=null;return cb}Y0g(xb,cb){xb=D.Range.Qc(xb,cb);return this.gridView.Da.y$(xb,this.$.oa.name)&&(xb=this.gridView.Da.tLa(xb))&&xb.autoFilterMenu?!0:!1}L4h(){var xb=null;const cb=this.gridView.Sb(this.gridView.ha.ra.activeCell);if(!cb)return null;const jb=cb.cell.HAc;let qa;({category:qa}=this.instantaneousSupportInformationManager.pCa(jb,!1));if(1===cb.qx.type)if(3===qa){if(!cb.cell.qPa)return c.ULS.sendTraceTag(527500290,
0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${qa}. NumFmt is null. `),null;xb=(cb.cell.qPa.Start+cb.cell.qPa.End).trim()}else if(!qa&&(Aa.a.z1a(cb.qx.value,"E")||Aa.a.z1a(cb.originalText,"E"))){xb=this.sg.qZe(cb.qx.value,jb,1,Number.POSITIVE_INFINITY,cb.cell.wia);if(!xb.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${qa}. Failed to acquire formatted value`),null;xb=xb.fy}xb||(xb=cb.originalText);return da.a.l2c(xb)?
["[Blanks]"]:["i"+xb.trim()]}zTh(){const xb=this.gridView.ha.ra.activeCell;var cb=this.$.da.Aa(66).Lg;const jb=this.$.da.Aa(66).Awb(xb);if(cb)return cb.usedRange.top;if(null!=jb)return jb.top;cb=this.$.xa.getItemByName(this.$.oa.sheetName);return(cb=Q.D(cb.Z0))&&cb.contains(xb)?cb.top:-1}z5c(xb,cb){const jb={};jb.Location=cb;jb.FieldId=xb.Id.toString();jb.DataSourceIndex=-1;jb.FilterType=xb.AutoFilterType;jb.AnchorType=0;jb.ChartId=null;jb.AnchorValue1=-1;jb.AnchorValue2=-1;jb.Property=xb.RichProperty;
return jb}}Object(u.a)(wb,"GridContextMenuFilter",null,[]);a.d(F,"GridContextMenu",function(){return Tb});class Tb extends r.a{constructor(xb,cb,jb,qa){super(xb,"PopulateGridContextMenu",1247109494,-2064931494,Tb.u6h,!0,!1,Tb.mLb,cb,jb,!0,qa);this.hkc=this.expandCollapse=this.refresh=this.GZ=this.Iwa=this.yBa=!1;this.qIe=!0;this.grid=ea.h(xb);this.Xmc=!0;if(this.Dhc=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const za=Ra.GetServiceTaskFactory.Oa(this.$.da,
309,310,3),Na=Ra.GetServiceTaskFactory.create(this.$.da,18,this.ka,3);ja.TaskExtensions.za(ja.TaskExtensions.Ed([za,Na],this.ka),()=>{this.$.da.$a(268,ua=>{this.I5a=new wb(xb,za.result,Na.result,ua)})},this.ka,3)}}get Yw(){return"PopulateGridContextMenu"}get QB(){return C.a.cRf}dispose(){super.dispose();this.grid=null}nc(xb,cb){xb=!this.Osd(xb,cb);if(!xb)switch(cb){case -1977666927:xb=null==this.I5a||this.WBj();break;case 1549396389:xb=null==this.I5a||!this.zki();break;case 2045563128:case 1803952894:xb=
null==this.I5a||!this.$.isEditMode&&!this.Aki();break;case -425234874:xb=this.$Bj()}return xb}Osd(xb,cb){const jb=this.grid.ha.ra.selectedRanges;return(new S.a(this.$.xa)).xm(xb,cb,jb,this.grid)}executeCommand(xb,cb,jb){const qa=cb.command;xb=null;switch(qa){case -1396319072:if(cb=this.grid.Sb(null))b.a.instance.b1c(!0),e.EventHandlerManager.instance.Ldd(),Tb.c_i(cb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ra.selectedRanges,cb);break;case 324156914:xb=this.grid.startEdit(!1,
1);break;case 1441131127:this.showGridContextMenu(jb);break;case -1977666927:xb=this.I5a.unh();break;case 1549396389:xb=this.I5a.Lnh();break;case 1803952894:xb=this.I5a.znh();break;default:xb=N.a(qa)}return xb||ja.TaskExtensions.iba()}wc(xb,cb,jb){xb=!1;switch(cb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:xb=!0;break;case 1441131127:xb=!!jb}return xb}kZ(xb=!1){let cb=!1,jb=!1,qa=0;va.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&
(qa=f.a.Ud());const za=this.Va.fq(this.menuId);var Na=this.grid.ha.ra;const ua=Na.Pg,Xa=ua&&Na.dd.hf,ha=ua&&Na.dd.isRow;Na=Na.selectedRanges;const ta=d.a.all(Na,Pb=>Pb.hf),wa=d.a.all(Na,Pb=>Pb.isRow),db=Q.O(Na),Jb=Q.P(Na);this.Kkf(Xa,ha)?(cb=!0,this.FLh(za)):this.$.isEditMode?Ca.a(this.$)?this.GLh(za,Xa,ha):(this.DKh(za,!(ha||Xa||!this.hkc)),this.$Kh(za,Na,xb),this.PKh(za,ta,wa,db,Jb),this.B_e(za,ua,Xa,ha),this.WLh(za),this.g_e(za,Xa,ha),this.vLh(za,ua,Xa,ha,Na),this.GKh(za),this.EKh(za,Na),this.hLh(za),
this.RLh(za,ua),va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.UKh(za)):(jb=!0,Ca.a(this.$)?this.w_e(za):this.lMh(za,ua,Xa,ha,Na));va.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(xb=f.a.Ud()-qa,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${xb}, isPivotMenu: ${cb}, isViewMenu: ${jb}, firstTimeEntry: ${this.qIe}`));this.qIe=!1;return za}hLa(xb){const cb=[];if(Ca.a(this.$))return cb;
if(3===xb){xb=this.grid.ha.ra;const qa=xb.Pg,za=qa&&xb.dd.hf,Na=qa&&xb.dd.isRow;let ua=!1;var jb=!1;let Xa=!1;this.$.isMobileMode&&(jb=xb.selectedRanges,ua=Q.O(jb),jb=Q.P(jb));if(qa){const ha=ea.f(this.grid);ha&&ha.range.contains(xb.dd)&&this.LV(ha)&&(Xa=!0)}this.$.isEditMode?this.Kkf(za,Na)?cb.push(...[A.a.jMf,A.a.lMf]):za||Na?(cb.push(A.a.clipboard),Na?cb.push(A.a.poj):za&&cb.push(A.a.t5g)):(cb.push(...[A.a.edit,A.a.clipboard]),Xa?cb.push(A.a.hyperlink):cb.push(A.a.color),qa&&cb.push(A.a.xTg)):
(cb.push(A.a.copy),Xa&&cb.push(A.a.openHyperlink),!Na||this.$.isMobileMode&&jb?!za||this.$.isMobileMode&&ua||cb.push(A.a.$1j):cb.push(A.a.a2j));cb.push(A.a.l6h)}else 2===xb&&cb.push(A.a.wBe);return cb}Kkf(xb,cb){return(this.yBa||this.Iwa||this.GZ||this.refresh||this.expandCollapse)&&!(xb||cb)}showGridContextMenu(xb){this.expandCollapse=this.refresh=this.GZ=this.Iwa=this.yBa=!1;var cb=this.$,jb=X.a(cb).yLa(),qa=this.grid.ha.ra;const za=qa.Pg;var Na=za&&qa.dd.hf;qa=za&&qa.dd.isRow;if(jb&&!Na&&!qa){Na=
Y.a(cb);if(null===Na||void 0===Na?0:Na.eUd)this.yBa=Na=G.f(cb.lg),this.Iwa=!Na;Na=cb.dc;this.GZ=jb.supportsBIExplore&&!!B.a(cb)&&Na.Y2(32768);Na.allowInteractivity&&(cb=this.grid.Sb(null),(null===cb||void 0===cb?0:cb.cell)&&(cb.cell.R0c||cb.cell.P7f)&&(this.expandCollapse=!0),Na.allowManualDataRefresh&&(this.refresh=!0))}cb=null;jb=1;Na=Object(m.a)(h.a,xb.eventArgs);xb=Object(m.a)(z.a,xb.creationParams);qa=this.FQh();xb?(cb=xb.clientPoint,jb=xb.inputMethod):Na&&1!==Na.tb?(cb=new Sys.UI.Point(Na.clientPoint.x,
Na.clientPoint.y),jb=Na.tb):qa&&(cb=new Sys.UI.Point(qa.x+(this.$.isChromeRtl?0:qa.width),qa.y+qa.height));J.a.Db=jb;this.hkc=3===jb;xb=t.a.evb;this.Sp(cb,!Na||Na.Ca.target.className!==xb,jb)}removeHyperlinksFromRange(xb,cb){if(!va.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.$p(xb,!0)){var jb=Q.r(xb,this.$),qa=this.$.pa.ya.Wb();this.$.userOperationManager.Ic(new U.a(125,0,(za,Na,ua)=>{this.$.My();return Z.b(this.$.pa.ya,jb,"","",
!0,!1,127,za,Na,ua,null,qa)},void 0,()=>new T(jb)),cb);this.grid.yf.pH(!1)}}FQh(){var xb=this.grid.Sb(null);if((null===xb||void 0===xb?0:xb.cell.Pk)&&this.Tjf(xb))return this.grid.getCellBounds(xb.cell);xb=this.grid.ha.ra.activeCell;return(xb=this.yac(new D.Range(xb.top,xb.left,y.a.fh,xb.left,!1,!1),2,!0)||this.yac(new D.Range(1,xb.left,xb.top,xb.left,!1,!1),2,!1)||this.yac(new D.Range(xb.top,xb.right,xb.top,y.a.sh,!1,!1),1,!0)||this.yac(new D.Range(xb.top,1,xb.top,xb.right,!1,!1),1,!1)||null)&&xb.Pk?
this.grid.getCellBounds(xb):Sys.UI.DomElement.getBounds(this.grid.Cwa.mc)}Tjf(xb){var cb=this.grid.rtl,jb=this.$.isChromeRtl;xb=xb.cell;var qa=ea.h(this.$).sK(xb);return qa?(qa=qa.topLeft,cb=qa.x+=cb===jb?xb.offsetWidth:0,jb=qa.y+=xb.offsetHeight,this.grid.view.visibleArea.contains(new w.a(cb,jb,0,0))):!1}yac(xb,cb,jb){xb=this.grid.jk("GridContextMenu.FindFirstCellInViewportArea",xb,cb,jb);try{for(xb.$$rst();xb.$$mn();){const qa=xb.$$cu();if(qa&&this.Tjf(qa))return qa.cell}}finally{xb&&xb.dispose()}return null}FLh(xb){const cb=
this.Va,jb=cb.Ec();this.refresh&&jb.buttons.push(cb.pb(100));this.GZ&&jb.buttons.push(cb.pb(99));this.yBa?jb.buttons.push(cb.pb(59)):this.Iwa&&jb.buttons.push(cb.pb(58));if(this.expandCollapse){let qa;qa=cb.tw("ContextMenu.PivotExpandCollapse",null,E.a.instance.ga(1163),589118293);const za=cb.Ec();za.buttons.push(cb.pb(243));za.buttons.push(cb.pb(244));za.buttons.push(cb.pb(245));za.buttons.push(cb.pb(246));qa.menu.tc.push(za);qa&&0<za.buttons.length&&jb.buttons.push(qa)}xb.tc.push(jb)}B_e(xb,cb,
jb,qa){if(cb&&!jb&&!qa){cb=this.Va.Ec();this.Dhc&&!this.$.LK&&this.Ged(cb);this.Ped(cb);this.$Lh(cb);if(va.EwaSettings.ma(473)&&ea.h(this.$).ha.ra.HK()&&ea.h(this.$).ha.ra.Q5)switch(va.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:cb.buttons.push(this.Va.pb(237));break;case 2:cb.buttons.push(this.Va.pb(238));break;default:cb.buttons.push(this.Va.pb(236))}xb.tc.push(cb)}}Ped(xb){if(this.$.dc.allowSorting&&(!this.$.isMobileMode||
(new S.a(this.$.xa)).Td(2048))){var cb=this.Va.Ec();cb.buttons.push(this.Va.pb(223));cb.buttons.push(this.Va.pb(224));cb.buttons.push(this.Va.pb(292));cb.buttons.push(this.Va.pb(293));cb.buttons.push(this.Va.pb(294));this.$.isMobileMode||cb.buttons.push(this.Va.pb(225));var jb=this.Va.tw("ContextMenu.sort",null,E.a.instance.ga(227),-864298118);jb.menu.tc.push(cb);xb.buttons.push(jb)}}Ged(xb){const cb=this.Va.tw("ContextMenu.filter",null,E.a.instance.ga(1964),2045563128),jb=this.Va.Ec();var qa=this.cVh();
const za=this.Va.pb(234);za.label=qa;jb.buttons.push(za);jb.buttons.push(this.Va.pb(235));qa=this.Va.Ec();qa.buttons.push(this.Va.pb(233));cb.menu.tc.push(jb);cb.menu.tc.push(qa);xb.buttons.push(cb)}$Lh(xb){if(ea.h(this.$).ha.ra.HK()){const cb=this.Va.Ec();cb.buttons.push(this.Va.pb(232));cb.buttons.push(this.Va.pb(285));cb.buttons.push(this.Va.pb(286));const jb=this.Va.tw("ContextMenu.table",null,E.a.instance.ga(1963),-697806646);jb.menu.tc.push(cb);xb.buttons.push(jb)}}r_e(xb,cb,jb,qa,za){if(cb){const ua=
Q.K(za);var Na=ea.f(this.grid);if(Na&&!jb&&!qa){jb=new S.a(this.$.xa);if(Na.range.contains(ua)&&this.LV(Na)){(cb=!Na.wxa&&!jb.ji)&&this.$.isEditMode&&xb.buttons.push(this.Va.pb(45));Na.mba&&xb.buttons.push(this.Va.pb(53));cb&&this.$.isEditMode&&xb.buttons.push(this.Va.pb(47));return}!Na.wxa&&this.$.isEditMode&&(Na=jb.Td(128),xb.buttons.push(this.Va.pb(Na?46:121)))}}this.d$i(za)&&xb.buttons.push(this.Va.pb(48));(Na=this.$.xa.oa)&&Na.Gd&&(Na=Na.Gd.Hv||Na.Gd.fI,!cb||this.$.LK||!va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||!V.g(this.$)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||Na||(cb=Q.K(za),this.c$i(cb)?xb.buttons.push(this.Va.pb(276)):cb.hf||cb.isRow||xb.buttons.push(this.Va.pb(275))))}d$i(xb){for(const cb of xb){xb=this.grid.getRangeInformation(cb);for(let jb=0;jb<xb.length;jb++)if(Object(x.a)(H.HyperlinkRange,xb[jb])){const qa=this.grid.Sb(xb[jb]);if(qa&&this.LV(qa)&&!qa.wxa)return!0}}return!1}c$i(xb){if(ea.h(this.$).ha.ra.HK()){const cb=ea.h(this.$).Bb.Bj(xb);if(cb&&cb.usedRange.equals(xb))return!0}return!1}g_e(xb,
cb,jb){var qa,za;if(1===ea.h(this.$).ha.Oe&&!cb&&!jb){cb=Ca.a(this.$);jb=this.Va;var Na=jb.Ec(),ua=this.$.da.Aa(65);(null===(qa=null===ua||void 0===ua?void 0:ua.Ym)||void 0===qa?0:qa.CF)&&!cb&&Na.buttons.push(jb.pb(227));ua&&ua.isCommentOperationEnabled(3)&&Na.buttons.push(jb.pb(221));(null===(za=null===ua||void 0===ua?void 0:ua.Ym)||void 0===za?0:za.Ild)&&!cb&&Na.buttons.push(jb.pb(228));(null===ua||void 0===ua?0:ua.hasCommentAtActiveCell)?ua.XC.isResolved||Na.buttons.push(jb.pb(159)):ua&&ua.hasCommentAtActiveCell||
(ua&&ua.Ym&&ua.Ym.CF?cb||(Na.buttons.push(jb.pb(229)),Na.buttons.push(jb.pb(230))):(Na.buttons.push(jb.pb(160)),cb||Na.buttons.push(jb.pb(226))));xb.tc.push(Na)}}WLh(xb){if(va.EwaSettings.ma(133)){const cb=this.Va,jb=cb.Ec();jb.buttons.push(cb.pb(250));xb.tc.push(jb)}}$Kh(xb,cb,jb){if(!jb){jb=this.$.Ja.KH();var qa=new S.a(this.$.xa),za=new P.a(jb,cb,this.grid);(new L(xb,this.$,this.Va,jb,cb,this.grid,za,qa)).Ced()}}PKh(xb,cb,jb,qa,za){const Na=(new S.a(this.$.xa)).Td(8),ua=this.Va,Xa=ua.Ec();cb&&
Xa.buttons.push(ua.pb(Na?152:153));jb&&Xa.buttons.push(ua.pb(Na?150:151));cb&&(qa||Xa.buttons.push(ua.pb(Na?109:155)),Xa.buttons.push(ua.pb(Na?111:157)));jb&&(za||Xa.buttons.push(ua.pb(Na?108:154)),Xa.buttons.push(ua.pb(Na?110:156)));xb.tc.push(Xa)}DKh(xb,cb){const jb=this.Va,qa=jb.Ec();xb.tc.push(qa);cb&&qa.buttons.push(jb.pb(102));qa.buttons.push(jb.pb(42));qa.buttons.push(jb.pb(43));cb=this.CLh(jb);xb.tc.push(cb)}CLh(xb){const cb=xb.Ec();cb.title=E.a.instance.ga(1143);cb.N9f=!1;cb.M9f=!1;cb.Zdg=
!1;let jb=5;const qa=I.a.nud(this.$);qa&&(jb=6);xb=xb.bB("PasteOptionsGallery",jb,"Size24by24",cb.title);cb.buttons.push(xb);xb.lu("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1144,void 0,"Paste_24",1,v.a.Iyh);xb.lu("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1145,void 0,"PasteValues_24",1,v.a.Nyh);xb.lu("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"PasteFormulas_24",1,v.a.Kyh);xb.lu("ContextMenu.PasteTranspose",
-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteTranspose_24",1,v.a.Myh);xb.lu("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteFormatting_24",1,v.a.Jyh);qa&&xb.lu("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteLink_24",1,v.a.Lyh);return cb}lMh(xb,cb,jb,qa,za){var Na;const ua=this.Va;var Xa=ua.Ec();Xa.buttons.push(ua.pb(43));xb.tc.push(Xa);this.Dhc&&!this.$.LK&&(Xa=this.Va.Ec(),
this.Ged(Xa),xb.tc.push(Xa));va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.dc.isMobileMode&&this.$.ea.dc.isReadOnlyEditMode&&!this.$.va.IsMeetingLiveSession||(Xa=this.Va.Ec(),this.Ped(Xa),xb.tc.push(Xa),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Xa=this.$.da.Aa(65);if(null===(Na=null===Xa||void 0===Xa?
void 0:Xa.Ym)||void 0===Na?0:Na.CF)Na=this.Va.Ec(),Na.buttons.push(ua.pb(229)),xb.tc.push(Na);Na=this.Va.Ec();this.r_e(Na,cb,jb,qa,za);xb.tc.push(Na);n.AFrameworkApplication.isMobileMode&&!M.a(this.$.va,29)&&(cb=ua.Ec(),cb.buttons.push(ua.pb(272)),xb.tc.push(cb))}vLh(xb,cb,jb,qa,za){const Na=this.Va.Ec();this.wLh(Na);this.r_e(Na,cb,jb,qa,za);0<Na.buttons.length&&xb.tc.push(Na)}wLh(xb){xb.buttons.push(this.Va.pb(135))}UKh(xb){const cb=this.Va.Ec();cb.buttons.push(this.Va.pb(185));xb.tc.push(cb)}RLh(xb,
cb){va.EwaSettings.ma(474)&&cb&&(cb=this.Va.Ec(),cb.buttons.push(this.Va.pb(262)),xb.tc.push(cb))}hLh(xb){var cb=this.grid.ha.ra.selectedRanges;if(cb&&cb.length){var jb=!1;for(var qa=0;qa<cb.length;qa++)if(this.grid.Bb.Mxa(cb[qa])){jb=!0;break}if(jb){jb=!1;for(qa=0;qa<cb.length;qa++){var za=this.grid.Bb.oZh(cb[qa]);if(null!=za&&null!=za[0]){for(var Na=0;Na<za.length;Na++)if(this.grid.Bb.Mxa(za[Na])){jb=!0;break}if(jb)break}}Na=this.Va;qa=Na.Ec();za=Na.Ec();var ua=1===cb.length&&(cb[0].isSingle||this.grid.Bb.QNa(cb[0])),
Xa=!1,ha=!1,ta=!1,wa=!1;for(let db=0;db<cb.length&&!(Xa&&ta&&ha&&wa);db++)!Xa&&this.grid.Bb.spi(cb[db])&&(Xa=!0),!ta&&this.grid.Bb.Kjf(cb[db],!1)&&(ta=!0),!ha&&this.grid.Bb.Dsd(cb[db])&&(ha=!0),!wa&&this.grid.Bb.Ugf(cb[db])&&(wa=!0);va.EwaSettings.ma(103)&&ua&&!this.grid.Bb.gAb(cb[0])&&(wa?qa.buttons.push(Na.pb(217)):qa.buttons.push(Na.pb(216)));wa=Xa;wa=!(new S.a(this.$.xa)).ji&&wa;ta&&!jb&&(va.EwaSettings.ma(129)&&G.l(this.$.lg)&&(va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(va.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?za.buttons.push(Na.pb(220)):za.buttons.push(Na.pb(wa?220:271))),ha&&za.buttons.push(Na.pb(wa?218:269)),ua&&(this.grid.Bb.Dsd(cb[0])||this.grid.Bb.gAb(cb[0]))&&za.buttons.push(Na.pb(wa?219:270))),za.buttons.push(Na.pb(wa?215:268)));0<za.buttons.length&&(cb=Na.tw(Xa?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,E.a.instance.ga(1774),798637440),
cb.menu.tc.push(za),qa.buttons.push(cb));0<qa.buttons.length&&xb.tc.push(qa)}}}EKh(xb,cb){this.grid.Bb.$hf(cb)&&(cb=this.Va.Ec(),this.grid.ha.ra.Zba()?(cb.buttons.push(this.Va.pb(241)),cb.buttons.push(this.Va.pb(239))):cb.buttons.push(this.Va.pb(240)),xb.tc.push(cb))}LV(xb){return xb.cell.hasHyperlink}w_e(xb){this.HLh(xb);var cb=this.Va.Ec();this.Ped(cb);xb.tc.push(cb);this.Dhc&&(cb=this.Va.Ec(),this.Ged(cb),xb.tc.push(cb))}GLh(xb,cb,jb){this.w_e(xb);this.g_e(xb,cb,jb)}HLh(xb){if(this.grid.ha.ra.Pg&&
!this.grid.ib.tj){var cb=this.Va,jb=cb.Ec();la.a(this.$).JUd()?jb.buttons.push(cb.pb(265)):jb.buttons.push(cb.pb(264));xb.tc.push(jb)}}static c_i(xb){const cb=xb.oLa(Tb.Vmd);cb&&cb.Nod&Tb.Vmd&&xb.invoke(Tb.Vmd,null)}static ZKh(xb,cb,jb){(jb=jb.da.Aa(254))?(jb.qrd()&&jb.Uof()&&xb.buttons.push(cb.pb(212)),jb.qrd()&&jb.clc()&&xb.buttons.push(cb.pb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}WBj(){const xb=
this.$.da.Aa(66).Lg,cb=this.grid.ha.ra.activeCell;return null!=xb&&!xb.hasActiveFilter||lb.c(this.$,cb)||!this.Bki(cb)}Bki(xb){const cb=xb.left;var jb=this.Sdc();if(null!=jb&&null!=jb.oac&&jb.oac.includes(cb-1))return!0;jb=this.Kdc();return null!=jb&&Q.D(jb).contains(xb)&&null!=jb.FilteredColumns&&jb.FilteredColumns.includes(cb-1)?!0:!1}zki(){var xb=this.$.da.Aa(66).Lg;const cb=this.Sdc();if(null!=xb)return xb.hasAutoFilter&&xb.hasActiveFilter;if(null!=cb)return null!=cb.oac&&0<cb.oac.length;xb=this.Kdc();
return null!=xb&&null!=xb.FilteredColumns&&0<xb.FilteredColumns.length}Aki(){var xb=this.$.da.Aa(66).Lg;const cb=this.Sdc();if(null!=xb&&xb.hasAutoFilter||null!=cb&&cb.Vsa.every(jb=>0!=jb.length))return!0;xb=Q.D(this.Kdc());return null!=xb&&xb.contains(this.grid.ha.ra.activeCell)?!0:!1}Sdc(){const xb=this.$.da.Aa(66);xb.Bn(this.grid.ha.ra.activeCell);return xb.Awb(this.grid.ha.ra.activeCell)}Kdc(){return this.$.xa.getItemByName(this.$.oa.sheetName).Z0}cVh(){var xb=this.grid.ha.ra.activeCell,cb=0,
jb=!1,qa=this.$.da.Aa(66),za=this.Sdc();qa=qa.Lg;null!=qa?(cb=qa.usedRange.top,jb=!0):null!=za?(cb=za.top,jb=!0):(za=this.Kdc(),null!=za&&Q.D(za).contains(xb)&&(cb=za.FirstRow+1,jb=!0));return jb?(xb=xb.left,cb=D.Range.Qc(cb,xb),cb=this.grid.Sb(cb),jb="",null!=cb&&(jb=cb.text),this.EWg(jb,xb)):E.a.instance.ga(220)}EWg(xb,cb){return null==xb||Aa.a.rh(xb.trim())?String.format(E.a.instance.mb(157),D.Range.gQ(cb)):xb.length>Tb.j4d?String.format(E.a.instance.mb(155),xb.substring(0,Tb.j4d)):String.format(E.a.instance.mb(156),
xb)}$Bj(){const xb=this.grid.ha.ra.selectedRanges;if(!xb||!xb.length)return!0;for(let cb=0;cb<xb.length;cb++)if(!this.grid.Bb.Gxa(xb[cb]))return!1;return!0}}Tb.mLb="GridContextMenuRootName";Tb.u6h=C.a.dGe;Tb.Vmd=192;Tb.j4d=26;Object(u.a)(Tb,"GridContextMenu",r.a,[])},1221:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(89),e=a(1091),f=a(8),d=a(777);class h{}h.YXd="suggested_cells_list_box";Object(u.a)(h,"CssElementIds",null,[]);var n=a(5),m=a(1092);class x{constructor(ja,X){this.$rg=ja;this.Zrg=X}get u$(){return this.$rg}get JZc(){return this.Zrg}}
Object(u.a)(x,"CellAutoCompleteItem",null,[265]);var r=a(4),y=a(83),t=a(912),v=a(385),w=a(40),C=a(1),B=a(22),z=a(21);class A extends t.a{constructor(ja,X,Y){super(ja,X);this.RSb=null;this.Xkc=0;this.j1=this.f9a=null;this.G6=(va,N)=>{if(va=this.cellAutoCompleteControl.items)if(1===va.length&&this.cellAutoCompleteControl.W1a.length<va[0].u$.length&&this.cellAutoCompleteControl.Lwa&&B.a.YI(va[0].u$,this.cellAutoCompleteControl.W1a)&&(N.newValue=va[0].u$),this.Za&&C.EwaSettings.ma(134)){let ea=-1;1<va.length?
ea=this.cellAutoCompleteControl.Pdc(this.Za.text,!0):1===va.length&&(this.cellAutoCompleteControl.Lwa||this.cellAutoCompleteControl.Ifc)&&(ea=0);if(0<=ea&&va.length>ea&&va[ea].JZc){const Ca=w.C(va[ea].JZc);Ca&&z.h(this.$).Bb.Mxa(Ca)&&(N.Sgf=!0,N.rBe=va[ea].JZc)}}};this.YGb=()=>{this.cellAutoCompleteControl.Lwa=!1};this.Za.EZa(this.G6);if(this.kAb=C.EwaSettings.ml())this.RSb=Y;this.j1=this.Ce.$d(this.Za.textBox.domElement);this.j1.la("mousedown",this.YGb)}get BAb(){return!1}get KK(){return this.cellAutoCompleteControl.se}set KK(ja){this.cellAutoCompleteControl.se=
ja}get A6a(){return!1}get key(){return v.a.F1c}get cellAutoCompleteControl(){if(this.kAb)return this.RSb;const {CellAutoCompleteControl:ja}=a(1221);return this.RSb||(this.RSb=Object(y.a)(ja,this.$.da.Aa(1)))}dispose(){this.Za.dKb(this.G6);super.dispose()}aZ(ja){ja&&!this.cellAutoCompleteControl.se||super.aZ(ja)}Zh(ja,X){this.cellAutoCompleteControl.Za=this.Za;this.Xkc=ja.keyCode;if(this.Za.eb){const Y=this.Za.text;B.a.equals(this.f9a,Y,!1)||(this.f9a=Y)}else this.f9a=null;if(237279923===X)return this.cellAutoCompleteControl.se=
!1;C.EwaSettings.ma(134)&&17===this.Xkc&&this.cellAutoCompleteControl.Lwa&&(this.cellAutoCompleteControl.Ifc=!0);return super.Zh(ja,X)}nCd(){var ja;if(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!r.AFrameworkApplication.Og)if(this.cellAutoCompleteControl.Za=this.Za,this.cellAutoCompleteControl.Lwa=!1,this.Za.eb){const X=!B.a.equals(this.f9a,this.Za.text,!0),Y=this.Za.rqd;Y||!X&&229!==this.Xkc?Y&&(this.cellAutoCompleteControl.se&&(this.cellAutoCompleteControl.se=
!1),null===(ja=this.cellAutoCompleteControl.zOa)||void 0===ja?void 0:ja.cancel()):this.cellAutoCompleteControl.lSg(this.Xkc)}else this.f9a=null}uh(){}jg(){this.KK=!1;this.cellAutoCompleteControl.set_visible(!1);this.f9a=null;this.cellAutoCompleteControl.Lwa=!1;this.cellAutoCompleteControl.Ifc=!1;this.cellAutoCompleteControl.zOa&&this.cellAutoCompleteControl.zOa.cancel()}QId(ja,X){return this.cellAutoCompleteControl.Zh(ja,X)}}Object(u.a)(A,"CellAutoCompleteListAutoCompleteBehavior",t.a,[]);var E=a(30);
t=a(1093);var I=a(12),L=a(11),V=a(117);class T extends t.a{constructor(ja,X,Y,va){super(ja,X);this.htmlSanitizationHelper=this.Hra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=Y;if(this.kAb=C.EwaSettings.ml())this.cellAutoCompleteControl=va;this.qp=[]}get Qj(){return this.Hra}set Qj(ja){this.dCa(this.Qj);this.Hra=ja;const X=this.dCa(this.Qj);this.ee=ja?X.innerText:null;this.Ywc(ja)}get se(){return super.se}set se(ja){super.se=ja;ja||(this.Qj=null)}get FUa(){return null}get nHa(){return this.kAb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}dispose(){super.dispose();this.Hra=null}vBc(ja){this.b8(!1);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var X=document.createElement("table");X.classList.add(this.i6);X.e5j=n.a.jHa;var Y=document.createElement("tbody");for(let va=0,N=this.qp.length;va<N;va++){const ea=
document.createElement("tr"),Ca=document.createElement("td");Ca.classList.add(this.XV);const la=document.createElement("span");la.classList.add(T.y3b);la.setAttribute(n.a.rYc,ja[this.qp[va]].u$);la.innerText=ja[this.qp[va]].u$;Ca.appendChild(la);ea.appendChild(Ca);Y.appendChild(ea)}X.appendChild(Y);this.htmlSanitizationHelper.QJ(this.Lf);this.Lf.appendChild(X)}else{X=`<table class='${this.i6}' aria-live='polite'><tbody>`;for(let va=0,N=this.qp.length;va<N;va++)Y=E.a.Hg(ja[this.qp[va]].u$),Y=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.XV,T.y3b,n.a.rYc,Y,E.a.h$c(Y)),X+=Y;X+="</tbody></table>";this.Lf.innerHTML=X}this.Jn=I.DOMElementExtensions.nk(this.domElement,this.i6);this.b8(!0);this.tsa()}qKa(ja,X){if(ja&&ja.length){var Y=[];if(X)for(let va=0,N=ja.length;va<N;va++)B.a.YI(ja[va].u$,X)&&Y.push(va);this.qp=Y;this.vBc(ja)}else this.se=!1,this.Hra=null}Kya(){}KZg(ja,X,Y){let va=Math.min(ja,Math.max(200,Y));X&&ja<Y&&(va+=V.a.Ou);I.DOMElementExtensions.Vv(this.Lf,va);X&&(va-=V.a.Ou);return va}tsa(){super.tsa();var ja=I.DOMElementExtensions.nk(this.get_element(),
this.i6),X=this.qp.length>this.pI,Y=z.h(this.$);if(Y=Y.Sb(Y.ha.ra.activeCell))for(ja=this.KZg(ja.offsetWidth,X,Y.width),X=this.Lf.getElementsByClassName(T.y3b),Y=0;Y<X.length;Y++)X[Y].style.maxWidth=L.HelperMethods.uc(ja);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(ja){if(ja=super.onItemClick(ja)){const X=z.h(this.$);X.To(!1);X.focus()}return ja}}T.y3b=d.a.byh;Object(u.a)(T,"CellAutoCompleteListBox",
t.a,[]);var H=a(24),D=a(66),G=a(113),J=a(172),M=a(46),Q=a(35),U=a(251),Z=a(19);a.d(F,"CellAutoCompleteControl",function(){return S});const P=`<div id='${h.YXd}' class='${d.a.d$b} ${Z.a.Ao}' ></div>`;class S extends e.a{constructor(ja,X,Y){super(ja);this.MDa=null;this.E1c=[];this.o8d=null;this.Ifc=this.Lwa=!1;this.cee=this.Bq=null;this.VNe=()=>{this.YY.qKa(this.items,this.MDa);this.raiseEvent("ACLBUpdated",new m.a(this.items.length));this.show()};this.tableManager=X;this.domElement.className=d.a.VQe;
C.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(X=document.createElement("div"),X.classList.add(d.a.d$b),X.classList.add(Z.a.Ao),X.id=h.YXd,this.domElement.appendChild(X)):this.domElement.innerHTML=P;I.DOMElementExtensions.setVisible(this.domElement,!1);U.d(this.style,this.$.isChromeRtl);this.uif=C.EwaSettings.ml();this.qBe=$get(h.YXd,this.domElement);this.YY=new T(this.$,this.qBe,Y,
this);this.dUa(!0);this.$.domElement.appendChild(this.domElement);this.Npb(ja,G.a(ja));this.Npb(ja,z.h(ja).Vb);this.uif||this.$.da.Ga(1,this);this.Gki=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}i0b(ja){this.addHandler("ACLBUpdated",ja)}Suc(ja){this.removeHandler("ACLBUpdated",ja)}U2(ja){this.addHandler("ACLBSelectionChanged",ja)}Mda(ja){this.removeHandler("ACLBSelectionChanged",ja)}$Lg(ja){this.addHandler("ACLBMatchedItem",ja)}ihj(ja){this.removeHandler("ACLBMatchedItem",
ja)}get ou(){return this.YY}get W1a(){return this.MDa}get ee(){return this.YY.ee}get items(){return this.Bq}get zOa(){return this.cee}get activeCell(){return z.h(this.$).ha.ra.activeCell}get dataValidationControl(){return this.o8d||(this.o8d=this.$.da.Aa(14))}jbg(ja){for(let X=0;X<ja.length;X++){const Y=ja.charCodeAt(X);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?B.a.isLetter(Y):B.a.yrd(Y))return!0}return!1}yxa(){return!this.items}dispose(){if(this.$){this.dUa(!1);
const ja=z.h(this.$);ja&&ja.view.er(this.spc)}b.a.rc([this.YY,this.zOa]);b.a.rc(this.E1c);this.E1c=this.qBe=this.YY=this.Za=null;super.dispose()}Zh(ja,X){let Y=!1;if(this.xCj())switch(X){case -798660877:if(1===this.items.length&&this.ee)break;this.ou.CB(1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,this.Pdc(this.ee),this.ee));Y=this.jz(!1);break;case 137938150:if(1===this.items.length&&this.ee)break;this.ou.CB(-1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,
this.Pdc(this.ee),this.ee));Y=this.jz(!1);break;case 2091832999:this.ou.CB(this.pI-1);Y=this.jz(!1);break;case 742457698:this.ou.CB(-(this.pI-1));Y=this.jz(!1);break;case 125627505:this.Za.textBox.caretPosition=this.Za.text.length;this.se=!1;Y=!0;break;case 267796030:this.jz(!0);break;default:Y=super.Zh(ja,X)}return Y}show(){this.items&&this.items.length&&(this.YY.Qj=this.ee?this.ou.Jn.rows[this.Pdc(this.ee)]:null,this.se=0<this.YY.qp.length,this.wCa(!0),this.YY.Kya())}lSg(ja){const X=!!this.Za&&
!D.f(this.$.oa);this.Ifc=this.Lwa=!1;this.Za&&!this.Za.eb?this.set_visible(!1):X&&!this.Yhh(this.activeCell)&&this.gGj(ja)}Yhh(ja){return!!this.dataValidationControl&&this.dataValidationControl.g9c(ja)}jz(ja){if(!this.Za||!this.se)return!1;const X=this.MDa;if(this.ee){var Y=I.DOMElementExtensions.QZ(I.DOMElementExtensions.nk(this.YY.Qj,T.y3b),n.a.rYc,"");const va=Y.substring(X.length,Y.length);ja?this.Za.text=Y:this.Za.insertTextAt(va,X.length,this.Za.text.length)}Y=z.h(this.$);Y.Ul&&(Y=Y.Vb,Y.text=
this.Za.text,Y.setCaretPosition(this.Za.textBox.caretPosition));ja?this.se=!1:this.Za.textBox.selectRange(X.length,this.Za.text.length);return!0}Pdc(ja,X=!1){if(!this.YY.Jn)return-1;const Y=this.YY.Jn.children[0],va=Y.children.length;let N;for(let ea=0;ea<va;++ea)if(N=Y.children[ea],B.a.equals(N.innerText.trim(),ja,X))return ea;return-1}bHg(ja,X,Y,va,N,ea,Ca){const la=Y.originalText.replace(S.pxf,String.fromCharCode(32)),Ra=new H.Range(ja.top-1,ja.left,ja.bottom-1,ja.right,!1,!1),lb=Ca?Ca.Bn(Y.range):
null;(!Y.$H||Y.range.left===ja.left)&&1<la.length&&!va.lb(la.toUpperCase())&&B.a.YI(la,X)&&!B.a.equals(la,X,!0)&&!S.iYe(X)&&this.jbg(la)&&(!N&&!lb||!N&&lb.equals(Ca.Bn(Ra))||N&&Y.range.Cd(ea)&&Y.range.top!==ea.top)&&(ja=Y.formulaBarText,B.a.equals(ja,Y.text,!1)||!ja)&&(ja={},ja.FirstRow=Y.range.top-1,ja.FirstColumn=Y.range.left-1,Y=new x(la,ja),va.add(la.toUpperCase(),Y))}gGj(ja){this.Bq=this.G2h();this.zOa&&this.zOa.cancel();0<this.Za.text.length&&0!==ja?this.items&&((1<this.items.length||this.se)&&
this.Foh(),8!==ja&&127!==ja&&46!==ja&&(1===this.items.length?this.tnd(!1):this.YY.Qj&&this.jz(!1))):this.se=!1}Foh(){this.se?this.VNe():this.cee=J.AsyncMethodContext.Er(this.VNe,500,M.a.W0g,this.zOa)}tnd(ja){c.ULS.shipAssertTag(537167966,0,!this.yxa()&&1===this.items.length,"Invalid Items");let X=this.items[0].u$,Y=this.Za.text,va=X.substring(Y.length,X.length);if(ja&&!va.length)this.Za.text=X;else if(!ja&&0<va.length)this.Za.appendText(va),this.Za.textBox.selectRange(Y.length,this.Za.text.length);
else return;this.raiseEvent("ACLBMatchedItem",new m.a(this.items.length,0,X));this.Lwa=!0}G2h(){this.Bq=null;const ja=new Q.a(!1);var X=this.activeCell;this.MDa=this.Za.text.replace(S.pxf,String.fromCharCode(32));const Y=this.tableManager.Bn(X),va=X.Cd(Y);if(S.iYe(this.MDa)||!this.jbg(this.MDa))return this.items;const N=new H.Range(1,X.left,X.top-1,X.left,!1,!1);var ea=new H.Range(X.top+1,X.left,f.a.fh,X.left,!1,!1);let Ca;const la=z.h(this.$);ea=la.jk("CellAutoCompleteControl.GetSuggestedCells",
ea);try{const Ra=la.jk("CellAutoCompleteControl.GetSuggestedCells2",N);try{for(const lb of[Ra,ea])for(;lb.$$mn();)Ca=lb.$$cu(),this.bHg(X,this.MDa,Ca,ja,va,Y,this.tableManager)}finally{Ra&&Ra.dispose()}}finally{ea&&ea.dispose()}this.Bq=Array(ja.values.length);for(X=0;X<this.items.length;X++)this.items[X]=ja.values[X];this.items.sort((Ra,lb)=>Ra.u$.localeCompare(lb.u$));return this.items}Npb(ja,X){ja&&X&&this.E1c.push(new A(ja,X,this.uif?this:void 0))}xCj(){return this.Gki?this.W1a&&!this.yxa()&&this.se?
this.get_visible():!1:this.W1a&&!this.yxa()&&this.get_visible()&&this.se}static get pxf(){return S.Lfe||(S.Lfe=new RegExp(String.fromCharCode(160),"g"))}static iYe(ja){ja=0<ja.length?ja.charCodeAt(0):-1;return 35===ja||61===ja||43===ja||45===ja||64===ja}}S.Lfe=null;Object(u.a)(S,"CellAutoCompleteControl",e.a,[235,236,237,2])},1227:function(u,F,a){u=a(0);var c=a(567),b=a(562),e=a(559),f=a(1001);class d{zeh(I,L){if(I&&!(1>I.length)&&L){var V=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});
this.Tbh(I,V.ControlList);L.push(V)}}Tbh(I,L){const V=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(L,V);L=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(V.Menu.MenuSectionList,L);this.eeh(I,L.ControlList)}eeh(I,L){for(let V=0;V<I.length;V++){const T=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",
V),Command:"336231556",DisplayName:I[V].userName,LabelText:I[V].userName,ImageBackColor:I[V].color,PersonaId:I[V].email,IsAnonymous:I[V].isAnonymous});Array.add(L,T)}}}Object(u.a)(d,"PresenceContextMenuSectionBuilder",null,[565]);var h=a(84),n=a(4),m=a(176),x=a(560),r=a(107),y=a(134),t=a(89),v=a(82),w=a(106),C=a(25);class B{constructor(I,L,V,T){this.n6d=this.L1=this.Xi=this.vE=this.I8=null;this.AYb=I;this.ECg=T;this.AYb.ZMa&&(this.Xi=new r.a(3,2,5E3,Object(h.a)(this,this.oTg,"authenticationCheckTask"),
2),n.AFrameworkApplication.Fi.Fg(this.Xi),this.Ig(L,V));this.AYb.rob(()=>{this.uzf()});this.AYb.CZa(()=>{this.vzf()})}get businessBar(){return this.L1||(this.L1=v.a.instance.Lh("CommonUI.IBusinessBar"))}get eze(){return this.n6d||(this.n6d=v.a.instance.Lh("CommonUI.IBusinessBarEntryFactory"))}Ig(I,L){const V=n.AFrameworkApplication.ub;V.Ne(C.a.authenticationLost,w.a.frame,I,96);V.Ne(C.a.Wwe,w.a.frame,L,96);V.Nb(C.a.YAe,w.a.frame,m.ActionManager.$8c);V.Nb(C.a.ZAe,w.a.frame,m.ActionManager.$8c);V.Nb(C.a.Hvd,
w.a.frame,m.ActionManager.$8c)}uzf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);n.AFrameworkApplication.ub.processAction(C.a.authenticationLost,2)}vzf(){this.WNj();n.AFrameworkApplication.ub.processAction(C.a.Wwe,2)}oTg(){this.AYb.authenticationCheck()}WNj(){this.vE&&(this.vE.hide(),this.vE.dispose(),this.vE=null);this.I8&&this.businessBar&&(n.AFrameworkApplication.Og||this.businessBar.removeEntry(this.I8),this.I8.dispose(),this.I8=null)}showDialog(I){t.a.Ia(this.vE);this.vE=new y.StandardDialog;
this.ECg||(this.vE.Lt=!1,this.vE.Rb=0);this.vE.pc(1,CommonUIStrings.l_SignIn);this.vE.sX(CommonUIStrings.l_DefaultDialogTitle,I,Object(h.a)(this,this.vw,"dialogHandler"))}vw(I){1===I?(x.a.b7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),n.AFrameworkApplication.ub.processAction(C.a.Hvd,2)):(this.WUd(),n.AFrameworkApplication.ub.processAction(C.a.ZAe,2))}WUd(){this.businessBar&&this.eze&&(this.I8=this.eze.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,
null),this.I8.closeable=!0,this.I8.addButton(CommonUIStrings.l_SignIn,B.IYg,""),this.I8.N$=Object(h.a)(this,this.LYg,"businessBarEntryCloseHandler"),this.businessBar.DC(this.I8,!1))}LYg(){this.fmh();n.AFrameworkApplication.ub.processAction(C.a.YAe,2)}fmh(){this.Xi&&(n.AFrameworkApplication.Fi.np(this.Xi),this.Xi=null)}dispose(){this.Xi=this.vE=this.I8=null}static IYg(){x.a.b7();n.AFrameworkApplication.ub.processAction(C.a.Hvd,2)}}Object(u.a)(B,"SignOutResponseUI",null,[2]);var z=a(248);class A{get name(){return"Common.App.UI"}Xh(I){I.register(d,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").xc()}init(){}dispose(){t.a.Ia(A.v2);A.v2=null}static main(){z.a.instance.Ei(new A)}}A.v2=null;Object(u.a)(A,"CommonAppUIPackage",null,[3,4]);a.d(F,"a",function(){return E});const E=()=>{Type.registerNamespace("CAUI");A.main()}},1228:function(u,F,a){u=a(0);var c=a(55),b=a(222),e=a(1221),f=a(49),d=a(37),h=a(1),n=a(697);class m extends b.a{constructor(C){super();this.$=C;this.Fb()}create(){const C=
this.$.da,B=f.GetServiceTaskFactory.create(C,134,this.ka,this.Ya),z=f.GetServiceTaskFactory.Oa(C,213,214,this.Ya),A=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")?f.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):c.Task.Ta(null);d.TaskExtensions.za(d.TaskExtensions.Ed([B,z,A],this.ka),()=>{if(h.EwaSettings.ml())this.nb(Object(n.a)(this.$.da,1,()=>{const E=new e.CellAutoCompleteControl(this.$,
B.result,A.result);z.result.la(E);return E}));else{let E=C.Aa(1);E||(E=new e.CellAutoCompleteControl(this.$,B.result,A.result),z.result.la(E));this.nb(E)}},this.ka,3)}static la(C){C.da.Ga(151,new m(C))}}Object(u.a)(m,"CellAutoCompleteControlFactory",b.a,[]);var x=a(15),r=a(13);class y{constructor(C,B){this.K_a=null;this.xGf=(z,A)=>{1<A.length&&(z=r.a.instance.ga(857),this.ariaLiveNotifier.tRf(z,A.length))};this.yGf=(z,A)=>{x.ULS.shipAssertTag(537167961,0,0<=A.selectedIndex&&0<=A.length&&A.selectedIndex<
A.length,"Invalid ListEventArgs: SelectedIndex/Length");x.ULS.shipAssertTag(537167960,0,!!A.rG,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.jaj(A.rG,A.selectedIndex+1,A.length)};this.zGf=(z,A)=>{this.ariaLiveNotifier.UQa(A.rG)};this.ariaLiveNotifier=C;h.EwaSettings.ml()||B.Ga(213,this)}dispose(){this.r0d();this.K_a=null}la(C){C&&(this.K_a=C,C.i0b(this.xGf),C.U2(this.yGf),C.$Lg(this.zGf))}r0d(){this.K_a&&(this.K_a.Suc(this.xGf),this.K_a.Mda(this.yGf),this.K_a.ihj(this.zGf))}}
Object(u.a)(y,"CellAutoCompleteReadoutHandler",null,[241,2]);class t extends b.a{constructor(C){super();this.$=C;this.Fb()}create(){const C=this.$.da;d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(C,211,212,this.Ya),B=>{if(h.EwaSettings.ml())this.nb(Object(n.a)(C,213,()=>new y(B.result,C)));else{const z=C.Aa(213)||new y(B.result,C);this.nb(z)}},this.ka,3)}static la(C){C.da.Ga(214,new t(C))}}Object(u.a)(t,"CellAutoCompleteReadoutHandlerFactory",b.a,[]);var v=a(9);a.d(F,"a",function(){return w});const w=
()=>{v.a.Fa(m.la);v.a.Fa(t.la)}},1229:function(u,F,a){var c=a(9);u=a(0);var b=a(235),e=a(222),f=a(49),d=a(37),h=a(1),n=a(15),m=a(89),x=a(4),r=a(78),y=a(8),t=a(24),v=a(66),w=a(40),C=a(142),B=a(47),z=a(46),A=a(12),E=a(13),I=a(21),L=a(27),V=a(19),T=a(52);class H extends r.a{constructor(U,Z,P,S){super();this.isMac=L.a.isMac;this.kxa=!1;this.$=U;this.ariaLiveNotifier=S;this.wo=P.q6b(U,null,Z,V.a.GTe,T.a.me(9),E.a.instance.ga(1731),"PulloutPointerDown")}Nhg(U){this.kxa!==U&&(this.hide(),(this.kxa=U)?this.wo.Gig(V.a.Nzh,
T.a.me(3)):this.wo.Gig(V.a.GTe,T.a.me(9)))}get Az(){return this.wo.Az}get buttonWidth(){return this.wo.buttonWidth}dispose(){this.wo.dispose();this.$=null;super.dispose()}domElement(U){return this.wo.domElement(U)}getButton(U){return this.wo.getButton(U,!1)}NQb(U,Z){this.wo.NQb(U,Z,!1)}xBa(U,Z){const P=I.h(this.$),S=P.ib.Mi(U);this.wo.NQb(this.kxa?E.a.instance.ga(1733):Z?E.a.instance.ga(1731):E.a.instance.ga(1732),S);Z=this.isMac?Z?E.a.instance.ga(1736):E.a.instance.ga(1737):Z?E.a.instance.ga(1734):
E.a.instance.ga(1735);var ja=P.fg(U,S);U=P.Df(S).Am;if(ja&&0<=ja.x&&0<=ja.y){const X=ja.bottomRight.x+this.Az;ja=ja.topLeft.y-this.Az-this.buttonWidth;if(ja<U.topLeft.y+this.Az){if(P.ib.gCa){this.hide();return}ja=U.topLeft.y+this.Az}this.Sp(X,ja,P.rtl,S);this.ariaLiveNotifier.UQa(Z)}else this.hide()}Sp(U,Z,P,S){this.wo.Sp(U,Z,P,S,!1)}hide(){this.wo.hide()}}Object(u.a)(H,"PulloutLaunchButton",r.a,[]);var D=a(33),G=a(22);class J extends r.a{constructor(U,Z,P,S,ja){super();this.DYa=this.XPc=this.cxc=
this.pGa=this.gS=this.hP=null;this.bie=0;this.UDb=this.yAb=this.KGc=!1;this.Dg=()=>{this.bxa&&(this.gridView?1===this.gridView.ha.Oe?(this.gridView.ha.ra.activeCell.equals(this.pGa)||this.JN||this.ny(),this.Ipb.tq()):this.ny():n.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.uh=()=>{this.ny()};this.ed=()=>{this.qX()};this.yc=()=>{this.ny()};this.gd=()=>{this.showCallout()};this.hza=()=>{if(this.Vg.$k&&this.Vg.$k.length)if(this.k0c)this.Vg.Kyi||(this.KGc=this.Vg.$k[0].BlockingDataForExpand),
this.Vg.oTh&&n.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.bie=this.Vg.f7c&&this.Vg.MZe<this.Vg.f7c.left-1?this.Vg.f7c.left-1-this.Vg.MZe:-1,this.showCallout();else if(this.gridView.ha.ra.Pg){var X=this.gridView.ha.ra.activeCell;if(X&&this.gS){var Y=this.tableManager.Bn(X);this.MNc=!!Y;const va=this.gridView.ha.ra.dd;Y=this.JN&&this.gS.Cd(Y);const N=this.wkd&&!this.JN&&va.equals(this.selectedRange);Y||N?(n.ULS.sendTraceTag(39662912,
0,50,"Field TableWidget shown on grid"),this.eac=!0,h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.JN&&this.tableManager.cka(X)?n.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.JN?this.Fh.xBa(this.gS,this.JN):this.Fh.xBa(va,this.JN):this.Fh.xBa(this.gS,this.JN),this.Mvc())):
n.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.gj=()=>{this.N7a()&&this.Fh.hide();1===this.gridView.ha.Oe&&this.qX()};this.DR=()=>{const X=this.gridView.ha.Oe;this.gridView.ha.ra.activeCell&&1===X&&this.qX()};this.Tt=()=>{if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.JN){if(this.gS&&this.pGa){var X=this.tableManager.Bn(this.pGa);X&&1<X.bottom-X.top&&(--X.bottom,this.gridView.I5(X)&&
this.Ipb.tq())}}else this.gridView.ha.ra.Pg&&this.gridView.I5(this.gridView.ha.ra.dd)&&this.Ipb.tq();else this.gS&&this.pGa&&this.JN&&(X=this.tableManager.Bn(this.pGa))&&1<X.bottom-X.top&&(--X.bottom,this.gridView.I5(X)&&this.Ipb.tq())};this.qX=()=>{if(this.$&&this.gridView){if(this.eac&&this.JN){const X=this.gridView.ha.ra.activeCell;this.gS=this.SXe();const Y=!!this.cxc&&this.cxc.contains(X);if(this.gS&&(X.equals(this.pGa)||Y)){this.Fh.xBa(this.gS,this.JN);return}}this.eac=!1;(this.gS=this.SXe())&&
this.ima&&this.gridView&&this.gridView.Da.rs(this.ima)?(this.k0c=!1,this.TZ()):(this.Vg.d1c(),this.Vg.m3b());this.eac||this.Fh.hide()}};this.$=U;this.tableManager=P;this.contextMenuManager=S;this.Fh=new H(U,this.gd,Z,ja);this.Vg=Z.M5c(U,P);this.eac=this.k0c=!1;this.wkd=h.EwaSettings.ma(134);this.MNc=!0;this.EEa=!1;this.gridView=I.h(this.$);this.gridView.Vb.Yk(this.uh);this.gridView.lv(this.DR);this.$.ll(this.ed);this.$.Xj(this.yc);this.$.QA(this.gj);this.gridView.view.ot(this.Tt);this.gridView.ha.TT(this.Dg);
this.Ipb=B.a.instance.create(this.qX,250,z.a.y7i);n.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Vg.$_b(this.hza);D.a.zAb()&&(this.yAb=!0);this.qX();U.da.Ga(261,this)}get mc(){return this.Fh.domElement(1)}get ima(){return this.XPc}get selectedRange(){return this.DYa}get JN(){return this.MNc}get kxa(){return this.EEa}get pPf(){return this.bie}get nDb(){const U=this.Fh.domElement(this.Xea);return U?A.DOMElementExtensions.isVisible(U):!1}get bxa(){return this.$.isEditMode&&h.EwaSettings.ma(134)?
!(new C.a(this.$.xa)).ji:!1}get COg(){return this.KGc}get Xea(){return this.ima?this.gridView.ib.Mi(this.hP):1}dispose(){this.gridView&&(this.gridView.ha.$R(this.Dg),this.gridView.view.er(this.Tt),this.gridView.Vb&&this.gridView.Vb.Gk(this.uh));if(this.$){const U=this.$;U.Kl(this.ed);U.Jl(this.yc);U.aE(this.gj);I.h(U).Ky(this.DR)}this.Vg&&this.Vg.Kuc(this.hza);m.a.Ia(this.Fh);this.Vg=this.$=this.gridView=this.Ipb=this.Fh=null;super.dispose()}ny(){this.Fh.hide()}Sda(){this.Fh?this.Fh.getButton(this.Xea).$cb():
n.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Tlj(){this.gS=null}LOf(){this.Fh&&this.Fh.hide()}I4h(){if(!this.wkd||1!==this.selectedRange.width)return null;const U=this.selectedRange.clone();for(;this.gridView.I5(U);){U.left+=1;U.right+=1;if(!this.gridView.Df(this.gridView.ib.Mi(U)).ui.Ie(U))break;if(!this.gridView.Da.rs(U))continue;const Z=this.gridView.jk("PulloutManager.GetValidatedRangeToFill",U,2);try{if(J.W0j(Z))return U}finally{Z&&Z.dispose()}}return null}Mvc(){this.Vg.bdb()}showCallout(){this.bxa&&
(this.Vg.r7a?(this.Fh.getButton(this.Xea).bIb(),h.EwaSettings.ml()?d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,8,9,0),U=>{this.o8f(U.result)},this.$.ka,3):this.o8f(this.contextMenuManager)):(this.k0c=!0,this.TZ()))}o8f(U){U.Nfd("tableFieldList").a1(null,this.Fh.domElement(this.Xea),this.Vg,null,!0);this.Mvc()}SXe(){if(!this.bxa||!this.gridView||this.gridView.ha.Sa.$b||!this.gridView.ha.ra.Pg)return null;var U=this.gridView.ha.ra.activeCell,Z=I.h(this.$).ib.Mi(U);if(!U)return null;this.pGa=
U.clone();var P=this.tableManager.Bn(U);this.MNc=!!P;if(this.JN){this.Fh.NQb(E.a.instance.ga(1731),Z);this.hP=J.Wkg(P);if(!this.hP)return null;U=!1;Z=({RY:U}=this.tableManager.RGe(P,this.gridView)).returnValue||U;this.KGc=U;if(Z)return this.cxc=new t.Range(P.top,P.left,P.bottom,P.right,!1,!1),this.XPc=new t.Range(this.hP.top,this.hP.right+1,this.hP.top,this.hP.right+1,!1,!1),this.yAb&&(this.EEa=!1,this.Fh.Nhg(this.EEa)),this.hP}else if(this.wkd){this.DYa=this.gridView.ha.ra.dd.clone();P=this.selectedRange.isSingle&&
I.h(this.$).Bb.Bhf(this.selectedRange);const S=I.h(this.$).Bb.Mxa(this.selectedRange);this.yAb&&(this.EEa=P&&!S);this.Fh.NQb(this.EEa?E.a.instance.ga(1733):E.a.instance.ga(1732),Z);P&&!S&&!this.UDb&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&G.a.equals(x.AFrameworkApplication.uiCulture,"en-us",!0)&&(x.AFrameworkApplication.Ip("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.UDb=!0);this.hP=J.Wkg(this.selectedRange);if(!(this.yAb&&P||S)||
!this.hP||!this.selectedRange||h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.cka(this.selectedRange))return null;this.XPc=this.I4h();if((h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.I5(this.selectedRange):this.gridView.I5(this.hP))&&this.ima)return this.yAb&&this.Fh.Nhg(this.EEa),this.cxc=this.hP,n.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.ima?
this.ima.toString():"null"}, RightColumnHeader, ${this.hP?this.hP.toString():"null"}, ActiveCell, ${U?U.toString():"null"}`),this.hP}return null}TZ(){this.JN?this.Vg.TZ(w.v(this.ima,this.$),!1,!0):this.EEa?this.Vg.x3i():h.EwaSettings.ma(134)&&this.Vg.TZ(w.v(this.selectedRange,this.$),!0,!1)}N7a(){return this.$.ea.isNamedObjectViewMode&&v.f(this.$.oa)}static W0j(U){for(;U.$$mn();)if(U.$$cu().text||U.$$cu().$H||U.$$cu().si||U.Zn.Laf)return!1;return!0}static Wkg(U){return U.right===y.a.sh?null:new t.Range(U.top,
U.right,U.top,U.right,!1,!1)}}Object(u.a)(J,"PulloutManager",r.a,[222,2]);class M extends e.a{constructor(U){super();this.$=U;this.Fb()}create(){c.a.Fa(U=>{const Z=f.GetServiceTaskFactory.Oa(U.da,12,477,this.Ya),P=f.GetServiceTaskFactory.Oa(U.da,66,134,this.Ya),S=f.GetServiceTaskFactory.Oa(U.da,211,212,this.Ya);let ja=b.a.Ta(null);const X=!h.EwaSettings.ml();X&&(ja=f.GetServiceTaskFactory.Oa(U.da,8,9,this.Ya));d.TaskExtensions.za(d.TaskExtensions.Ed([Z,P,ja,S],U.ka),()=>{X?this.nb(this.$.da.Aa(261)||
new J(this.$,Z.result,P.result,ja.result,S.result)):this.nb(this.$.da.Aa(261)||new J(this.$,Z.result,P.result,null,S.result))},U.ka)})}static la(U){U.da.Ga(262,new M(U))}}Object(u.a)(M,"PulloutManagerFactory",e.a,[]);a.d(F,"a",function(){return Q});const Q=()=>{c.a.Fa(U=>{U.ma(134)&&M.la(U)})}},1238:function(u,F,a){u=a(0);var c=a(187);class b{VMj(t,v){t.set_visible(!1);v.set_visible(!0)}}Object(u.a)(b,"DefaultTabSwitchBehaviour",null,[273]);class e{}e.INj="TabsContainer";e.rNj="TabTitlesContainer";
e.pNj="TabTitle";e.qNj="TabTitleText";e.xYd="TabTitleActive";Object(u.a)(e,"MultitabControlStyles",null,[]);var f=a(84),d=a(45),h=a(85),n=a(87),m=a(56);class x{constructor(t,v,w){this.wk=t;this.Yp=v;this.tIc=w;this.Tfa=document.createElement("a");m.a.gyc(this.Tfa,this.Yp);Sys.UI.DomElement.addCssClass(this.Tfa,e.qNj);Sys.UI.DomElement.addCssClass(this.wk,e.pNj);this.wk.appendChild(this.Tfa);this.Tfa.tabIndex=0;this.zDc();d.a.addHandler(this.wk,"click",this.tIc);d.a.addHandler(this.wk,"keyup",Object(f.a)(this,
this.rab,"onTitleKeyUp"))}get mc(){return this.wk}get title(){return this.Yp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.wk,e.xYd)}set isActive(t){this.setActive(t)}dispose(){d.a.removeHandler(this.wk,"keyup",Object(f.a)(this,this.rab,"onTitleKeyUp"));d.a.removeHandler(this.wk,"click",this.tIc);this.wk=this.Tfa=null}setActive(t){t?Sys.UI.DomElement.addCssClass(this.wk,e.xYd):Sys.UI.DomElement.removeCssClass(this.wk,e.xYd);this.Tfa&&this.Tfa.setAttribute(n.a.sha,t)}rab(t){t.keyCode!==
h.a.Mh&&t.keyCode!==h.a.bfa||this.tIc(t)}zDc(){this.wk.setAttribute(n.a.Ld,n.a.ds);this.Tfa.setAttribute(n.a.mv,this.Yp);this.Tfa.setAttribute(n.a.Ld,n.a.Apb)}}Object(u.a)(x,"TabTitleControl",null,[2]);var r=a(39);a.d(F,"a",function(){return y});class y{constructor(t,v=null,w=null){this.$mb=this.hnb=null;this.G1=-1;this.wk=t;this.Gga=v||new c.a;this.DDg=w||new b;this.RFa=new c.a;t=0;for(let C of this.Gga)this.fud(this.G1)||(this.G1=t),v=t++,this.RFa.add(new x(document.createElement("li"),C.title,
this.Fbh(v)))}get xBc(){return this.Gga.count}get activeTab(){return this.G1}set activeTab(t){this.rcg(t)}get mc(){return this.wk}get visible(){return r.a.isVisible(this.wk)}set visible(t){this.wk.style.visibility=t?"visible":"hidden"}sWf(){this.hnb=document.createElement("ul");this.hnb.className=e.rNj;this.$mb=document.createElement("div");this.$mb.className=e.INj;for(let t=0;t<this.xBc;++t){const v=this.Gga.na(t),w=this.RFa.na(t);v.set_visible(!1);w.isActive=!1;const C=document.createElement("div");
v.render(C);this.$mb.appendChild(C);this.hnb.appendChild(w.mc)}this.mc.appendChild(this.hnb);this.mc.appendChild(this.$mb);this.fud(this.G1)&&(this.RFa.na(this.G1).isActive=!0,this.Gga.na(this.G1).set_visible(!0))}dispose(){for(let t=0;t<this.xBc;++t)this.Gga.na(t).dispose(),this.RFa.na(t).dispose();this.RFa=this.Gga=this.wk=this.$mb=this.hnb=null}setFocus(){this.Gga.na(this.G1).setFocus()}fud(t){return 0<=t&&t<this.xBc}rcg(t){this.G1!==t&&this.fud(t)&&(this.DDg.VMj(this.Gga.na(this.G1),this.Gga.na(t)),
this.RFa.na(this.G1).isActive=!1,this.RFa.na(t).isActive=!0,this.G1=t,this.setFocus())}Fbh(t){return()=>{this.rcg(t)}}}Object(u.a)(y,"MultitabControl",null,[261,2])},1251:function(u,F,a){var c=a(9);u=a(0);var b=a(7),e=a(222),f=a(49),d=a(37);class h{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(u.a)(h,"FormulaAssistanceUIContext",null,[]);var n=a(185);class m extends e.a{constructor(r){super();this.wqj="formulaAssistance";this.$=r;this.Fb()}create(){let r=this.$.da.Aa(448);if(r)this.nb(r);
else{var y=f.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Ya);d.TaskExtensions.za(y,()=>{d.TaskExtensions.za(n.c(y.result.kn.loadScript(this.wqj)),()=>{r=this.$.da.Aa(448);if(!r){const t=Object(b.a)(new h,{isFeedbackAllowed:this.$.isFeedbackEnabled});r=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(t));this.$.iCe(()=>{const v={};v.isFeedbackAllowed=this.$.isFeedbackEnabled;r.updateContext(v)})}this.nb(r)},this.$.ka,3)},this.$.ka,3)}}static la(r){r.da.Ga(449,new m(r))}}
Object(u.a)(m,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(F,"a",function(){return x});const x=()=>{c.a.Fa(r=>{m.la(r)})}},1252:function(u,F,a){var c=a(9);u=a(0);var b=a(55),e=a(222),f=a(49),d=a(37),h=a(21),n=a(15),m=a(31),x=a(210),r=a(24),y=a(66),t=a(1),v=a(1089),w=a(11),C=a(156),B=a(14),z=a(178),A=a(224),E=a(148),I=a(65),L=a(88);class V{constructor(D,G,J){this.pOa=1;this.S9=[];this.active=!1;this.htmlSanitizationHelper=null;this.YAb=!1;this.onPointerDown=M=>{E.a.slim(M.Ca.rawEvent);return!1};
this.Vw=()=>{const M=this.gridView.Mjd();if(!(0>=M||M===this.pOa||this.gridView.ir)){var Q=!1,U=[],Z=[];for(var P=this.S9.length-1;0<=P;P--){var S=this.S9[P];if(this.Ljd(S)>M||S.bottom<M)U.push(S),this.S9.splice(P,1),Q=!0}for(P=this.tableManager.rangeList.length-1;0<=P;P--){S=this.tableManager.rangeList[P];const ja=this.Ljd(S);ja<=M&&S.bottom>=M&&!(ja<=this.pOa&&S.bottom>=this.pOa)&&S.oba&&(Z.push(S),Q=!0)}if(Q){S=this.gridView.prc;for(let ja of S)for(let X of ja)for(let Y of X)this.YAb?this.y2g(Y,
U,Z):this.z2g(Y,U,Z,Q)}else n.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.pOa=M}};this.FDf=(M,Q)=>{Q.isRow||Q.LXc(this.efc)};this.GDf=(M,Q)=>{Q.isRow||(this.tableManager.rangeList.length||this.deactivate(),Q.OMd(this.efc))};this.efc=(M,Q)=>{if(this.Td())this.activate();else if(M=this.active,this.deactivate(),!M){n.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");
return}(Q=Q.Hr)&&this.E$f(Q.a5,Q)};this.rGf=(M,Q)=>{!this.gridView.ir&&(this.Td()?this.activate():(M=this.active,this.deactivate(),M||n.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Q=Q.Hr)&&(M=v.a(Q.a5),this.E$f(M,Q)&&Q.YRd(M))};this.ue=()=>{this.gridView.ib.X4?this.deactivate():this.activate()};this.tableManager=D;this.gridView=G;this.$=G.$;this.htmlSanitizationHelper=J;D.yXc(this.rGf);G.ILg(this.FDf);G.JLg(this.GDf);this.$.xa.Xf(this.ue);
this.$.Cb.Xf(this.ue);this.zve(M=>{M.LXc(this.efc)});this.YAb=this.gridView.Vka;this.Td()&&(this.activate(),this.Vw(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.DMd(this.rGf),this.gridView.Xgj(this.FDf),this.gridView.Ygj(this.GDf),this.$.xa.Eg(this.ue),this.$.Cb.Eg(this.ue),this.zve(D=>{D.OMd(this.efc)}));this.gridView=this.tableManager=this.S9=null}qCc(D,G,J){if(!y.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.gCa)return!0;const M=
J.y8e();var Q=M.length;if(M[Q-1]<D.left)return!1;var U=w.HelperMethods.jw(new x.a(M),0,Q,D.left,w.HelperMethods.HB);if(0>U)return!1;const Z=D.vZd;Q=Math.min(Z.length+U,Q);let P=0;for(;U<Q;U++){const S=M[U];G?(J.updateCellText(U,Z[P]),this.Kpe(D,P,S)):(J.updateCellText(U,r.Range.gQ(S)),this.WNe(S));G&&J.mwj();J.en("HeaderSnappingFeature::toggleHeaderSnapping",U);P++}D.EBa=G;return!0}rCc(D,G,J,M){if(!y.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.gCa)return!0;if(!J.length)return!1;
var Q=M.length;if(M[Q-1]<D.left)return!1;var U=w.HelperMethods.jw(new x.a(M),0,Q,D.left,w.HelperMethods.HB);if(0>U)return!1;const Z=D.vZd,P=!!D.Vsa&&0<D.Vsa.length,S=!!D.menuModel&&0<D.menuModel.length;for(let Y=U,va=0,N=Math.min(Z.length+U,Q);Y<N;Y++,va++)if(Q=J[Y]){var ja=null;(U=Q.getElementsByClassName(m.a.qbd))&&(ja=U[0]);if(ja&&ja.innerText){if(U=Q.getElementsByClassName(m.a.fte))for(var X=U.length-1;0<=X;X--)Q.removeChild(U[X]);U=M[Y];G?(ja.innerText=Z[va],Q.classList.add(m.a.bVe),P&&D.Vsa[va]&&
(ja=document.createElement("div"),t.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&t.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")&&this.htmlSanitizationHelper?(this.htmlSanitizationHelper.Ri(ja,D.Vsa[va]),X=D.Vsa[va].split(I.a.hQg),n.ULS.shipAssertTag(509678873,0,3===X.length,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain command data for ShowAutoFilterMenu"),X=L.a.If(X[1]),this.eHg(ja.firstChild,
X),C.a.instance.sa(B.a.vf,ja.firstChild,this.onPointerDown),z.a.instance.sa(B.a.Lp,ja.firstChild,this.onPointerDown)):ja.innerHTML=D.Vsa[va],S&&D.menuModel[va]&&this.Kpe(D,va,U),Q.appendChild(ja.firstChild))):(Q.classList.remove(m.a.bVe),ja.textContent=r.Range.gQ(U),this.WNe(U))}}D.EBa=G;return!0}eHg(D,G){A.a.instance.sa(B.a.click,D,J=>{G&&E.a.hrc(J.Ca.rawEvent,966232027,G,this.$.get_id());return!0})}Kpe(D,G,J){this.$.da.$a(8,M=>{M.nac.gSi(D,G,J)})}WNe(D){this.$.da.$a(8,G=>{G.nac.hSi(D)})}z2g(D,G,
J,M){const Q=D.Mt,U=v.a(D.a5);let Z;for(let P=G.length-1;0<=P;P--)Z=G[P],this.rCc(Z,!1,U,Q)&&G.splice(P,1);for(G=J.length-1;0<=G;G--)Z=J[G],this.rCc(Z,!0,U,Q)&&this.S9.push(Z);M&&D.YRd(U)}y2g(D,G,J){if(D.D_g()){for(var M=G.length-1;0<=M;M--)this.qCc(G[M],!1,D)&&G.splice(M,1);for(G=J.length-1;0<=G;G--)M=J[G],this.qCc(M,!0,D)&&this.S9.push(M)}}E$f(D,G){const J=this.YAb?G.y8e():G.Mt;var M=J[0];const Q=J[J.length-1],U=this.g4h(M,Q);let Z=!1;for(let P=this.S9.length-1;0<=P;P--){const S=this.S9[P];Q>=S.left&&
M<=S.right&&(this.YAb?this.qCc(S,!1,G):this.rCc(S,!1,D,J),this.S9.splice(P,1),Z=!0)}for(let P=0,S=U.length;P<S;P++)if(M=U[P],this.YAb?this.qCc(M,!0,G):this.rCc(M,!0,D,J))this.S9.push(U[P]),Z=!0;return Z}activate(){this.Td()&&!this.active&&(this.gridView.view.ot(this.Vw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.er(this.Vw),this.active=!1)}Td(){return y.b(this.$.oa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.ib.lP&&0<this.tableManager.rangeList.length}zve(D){const G=this.gridView.prc;
for(let J of G)for(let M of J)for(let Q of M)D(Q)}g4h(D,G){const J=[];if(!this.active)return J;this.pOa=this.gridView.Mjd();for(let M=this.tableManager.rangeList.length-1;0<=M;M--){const Q=this.tableManager.rangeList[M];Q.bottom>=this.pOa&&this.Ljd(Q)<=this.pOa&&Q.left>=D&&Q.right<=G&&Q.oba&&J.push(Q)}return J}Ljd(D){const G=this.gridView.Bb.Bj(D);return G&&this.tableManager.Pif(D,G.usedRange.topLeft)?D.top+1:D.top}}Object(u.a)(V,"HeaderSnappingFeature",null,[2]);class T extends e.a{constructor(D){super();
this.$=D;this.Fb()}create(){const D=f.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),G=t.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&t.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")?f.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):b.Task.Ta(null);d.TaskExtensions.za(d.TaskExtensions.Ed([G],this.ka),()=>{d.TaskExtensions.za(d.TaskExtensions.Ed([D],this.ka),()=>{this.nb(this.$.da.Aa(68)||new V(D.result,
h.h(this.$),G.result))},this.ka,11)},this.ka,3)}static la(D){D.da.Ga(67,new T(D))}}Object(u.a)(T,"HeaderSnappingFactory",e.a,[]);a.d(F,"a",function(){return H});const H=()=>{c.a.Fa(T.la)}},1277:function(u,F,a){var c=a(9);u=a(0);var b=a(15),e=a(875),f=a(27),d=a(197),h=a(222),n=a(227),m=a(1),x=a(51),r=a(55),y=a(185),t=a(33);class v{constructor(){this._list={}}addHandler(A,E){var I;this._list[A]=[...(null!==(I=this._list[A])&&void 0!==I?I:[]),E]}removeHandler(A,E){const I=this._list[A];void 0!==I&&(E=
I.indexOf(E),0<=E&&(this._list[A]=[...I.slice(0,E),...I.slice(E+1)]))}getHandler(A){const E=this._list[A];return E&&0!==E.length?(I,L)=>{for(const V of E)V(I,L)}:null}static CKb(){Sys.EventHandlerList.prototype.addHandler=v.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=v.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=v.prototype.removeHandler}}Object(u.a)(v,"EventHandlerListOptimized",null,[]);class w{constructor(){this._list={}}addHandler(A,E){this.invalidate(A);
void 0===this._list[A]?this._list[A]=[E]:this._list[A].push(E)}invalidate(A){void 0!==this.xA&&this.xA.delete(A)}removeHandler(A,E){const I=this._list[A];void 0!==I&&0!==I.length&&(E=I.indexOf(E),0<=E&&(this.invalidate(A),I.splice(E,1)))}getHandler(A){void 0===this.xA&&(this.xA=new Map);var E=this.xA.get(A);return void 0===E?(E=this.makeHandler(A),this.xA.set(A,E),E):E}makeHandler(A){A=this._list[A];if(!A||0===A.length)return null;const E=[...A];return(I,L)=>{for(let V=0;V<E.length;++V)E[V](I,L)}}static CKb(){Sys.EventHandlerList.prototype.addHandler=
w.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=w.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=w.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=w.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=w.prototype.invalidate}}Object(u.a)(w,"EventHandlerListMemoized",null,[]);class C{constructor(A){this.a=A;this.preventDefault=C.FKf.preventDefault;this.stopPropagation=C.FKf.stopPropagation;const E=this.type=A.type.toLowerCase();this.rawEvent=
A;this.altKey=A.altKey;"undefined"!==typeof A.button&&(this.button="undefined"!==typeof A.which?A.button:4===A.button?Sys.UI.MouseButton.middleButton:2===A.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);"keypress"===E?this.charCode=A.charCode||A.keyCode:this.keyCode=A.keyCode&&46===A.keyCode?127:A.keyCode;this.clientX=A.clientX;this.clientY=A.clientY;this.ctrlKey=A.ctrlKey;this.target=A.target?A.target:A.srcElement;this.screenX=A.screenX;this.screenY=A.screenY;this.shiftKey=
A.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const A=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-A.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const A=
Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-A.y}}}static CKb(){Sys.UI.DomEvent=C;C.registerClass("Sys.UI.DomEvent",void 0,void 0)}}C.addHandler=Sys.UI.DomEvent.addHandler;C.addHandlers=Sys.UI.DomEvent.addHandlers;C.removeHandler=Sys.UI.DomEvent.removeHandler;C.clearHandlers=Sys.UI.DomEvent.clearHandlers;C._removeHandler=Sys.UI.DomEvent._removeHandler;C._clearHandlers=Sys.UI.DomEvent._clearHandlers;C._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;
C.FKf=Sys.UI.DomEvent.prototype;C.registerClass=function(A,E,I){this.prototype.constructor=this;this.__typeName=A;this.__class=!0;E&&(this.__baseType=E,this.__basePrototypePending=!0);Sys.__upperCaseTypes[A.toUpperCase()]=this;if(I){this.__interfaces=[];for(let L=2,V=arguments.length;L<V;L++)this.__interfaces.push(arguments[L])}return this};Object(u.a)(C,"DomEventLazy",null,[202]);class B extends h.a{constructor(A){super();this.$=A;this.s6b=null;this.Fb()}create(){b.ULS.sendTraceTag(537154643,0,50,
"PluginSchedulerFactory.Create: Loading scheduler slice");e.a.then(this.meh(),A=>{this.nb(A)})}meh(){if(this.s6b)return this.s6b;const A=n.a.S1a(x.b(),d.a.none,"LoadResource","x10Scheduler loading");if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var E=String.prototype;if(void 0===E.startsWithOriginal||void 0===E.endsWithOriginal)if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const I=document.createElement("frame");
document.body.appendChild(I);const L=I.contentWindow.String.prototype;document.body.removeChild(I);E.startsWithOriginal=L.startsWith;E.endsWithOriginal=L.endsWith}else E.startsWithOriginal=function(I,L=0){return this.lastIndexOf(I,L)===L},E.endsWithOriginal=function(I){return-1!==this.indexOf(I,this.length-I.length)};E.startsWith=E.startsWithOriginal;E.endsWith=E.endsWithOriginal}m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&v.CKb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",
!1)&&w.CKb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&C.CKb();if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.Iw)return E=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,E),A.setResult(E),this.s6b=A.task;this.$.da.$a(266,()=>{this.$.da.$a(283,I=>{const L=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();I=y.b(r.Task.Ta(I.kn));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(I,0),t.a.Rpb(this.$)?
excelOnlineCalc.x10.ensureGroupAttached(I,2):0]).then(V=>V.some(T=>0<T)).then(V=>{this.$.da.Ga(413,L);A.setResult(L);m.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&this.$.da.$a(491,T=>{T.lX.anyPluginInitialized=V})})})});return this.s6b=A.task}static la(A){A.da.Ga(414,new B(A))}}Object(u.a)(B,"PluginSchedulerFactory",h.a,[]);a.d(F,"a",function(){return z});const z=()=>{c.a.Fa(A=>{B.la(A)})}},1278:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(697),f=a(49),d=a(37);
class h extends b.a{constructor(m){super();this.$=m;this.Fb()}static la(m){m.da.Ga(521,new h(m))}create(){const m=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,266,265,0),()=>{this.nb(Object(e.a)(this.$.da,520,m))},this.$.ka,3)}}Object(u.a)(h,"FormulaAuthoringHelperFactory",b.a,[]);a.d(F,"a",function(){return n});const n=()=>{c.a.Fa(m=>{h.la(m)})}},1440:function(u,F,a){a.r(F);var c=a(1079),b=a(0),e=a(694),f=a(15),d=a(179),
h=a(60);const n=(Bb,Qb,sc,kb,Eb,Gc)=>{if(Qb){const zc=Bb.textBox;Bb.eb||Bb.startEdit(Qb,!0);Bb.ssd=!0;Bb.text=sc;zc.caretPosition=Eb;Eb<Gc&&(kb&&Bb.GBa(),zc.selectRange(0,Gc+1),zc.selectRange(Eb,Gc))}};var m=a(76);class x{constructor(Bb,Qb){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=Bb;this.type=Qb}s5a(){return this.sharedSheetRange}}Object(b.a)(x,"MacroRecorderAutoSumPayload",null,[108]);var r=a(40),y=a(374),t=a(188),v=a(49),w=a(37),C=a(154),B=a(348),z=a(29),A=a(1),E=a(184),I=a(281),
L=a(21),V=a(124),T=a(564),H=a(55);class D extends d.a{constructor(Bb){super();this.JLi=Qb=>{const sc=L.h(this.$);if(Qb=Qb.Result){let kb=r.D(Qb.NewSelection),Eb=r.D(Qb.NewActiveCell);if(kb&&Eb)if(!Qb.Committed&&Qb.AutoSumFormula){const Gc=sc.Sb(Eb);Gc&&(sc.ha.updateSelection(kb,Eb,60),kb=Eb=r.D(Qb.MarkedArea),sc.hK=2,n(sc.fc,Gc,Qb.AutoSumFormula,!!kb,Qb.FormulaMarkStart,Qb.FormulaMarkEnd),kb&&Eb&&sc.ha.updateSelection(kb,Eb,0),sc.fc.ssd=!1,w.TaskExtensions.za(v.GetServiceTaskFactory.create(this.$.da,
153,this.ka,0),zc=>{zc.result.OJa(null)},this.ka,3))}else sc.ha.updateSelection(kb,Eb,60)}};this.$=Bb}nc(){return!1}executeCommand(Bb,Qb,sc){Bb=Qb.command;switch(Bb){case 1220954656:case 505713221:Qb=this.cNe(0,Qb);break;case -1537138325:Qb=this.cNe(parseInt(sc[m.a.Jc].toString(),10),Qb);break;default:Qb=E.a(Bb)}return Qb}wc(Bb,Qb){if(Bb=1===Bb)switch(Qb.command){case 1220954656:case 505713221:case -1537138325:break;default:Bb=!1}return Bb}Kc(){return!1}cNe(Bb,Qb){const sc=L.h(this.$);sc.yf.pH(!1);
if(!L.h(this.$).ha.ra.Pg)return Qb=L.h(this.$).ha.ra.ZF,f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${Bb} due to discontinuous selection. Number of selected ranges is ${Qb}`),this.Pza(),H.Task.Ta(!1);const kb=sc.BF();if(!kb)return null;const Eb=r.v(sc.ha.ra.dd,this.$),Gc=r.o(sc.ha.ra.activeCell,this.$),zc=r.o(kb,this.$),yb=this.$.pa.ya.Wb(),gb=()=>new x(Eb,Bb);return this.$.$p(sc.ha.ra.selectedRanges,!0)?y.a(this.$.userOperationManager,(Kb,sd,Sb)=>
{var yc=this.$.pa.ya;Kb=I.b(Kb,this.JLi);const Fc=yc.Na(9,yb);Fc.selectedRange=Eb;Fc.activeCell=Gc;Fc.autoSumType=Bb;Fc.topLeftCell=zc;return h.g(yc,"AutoSum",Fc,Kb,sd,Sb,Bb,0)},Kb=>new t.a(502,0,Kb,64,gb),Qb):H.Task.Ta(!1)}Pza(){T.a(V.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var Bb=z.a.$c(1,1,751,2186,0,371863010,"DiscontinuousSelectionBlocking");A.EwaSettings.Jz()?new B.a(this.$,Bb):(Bb=new C.ErrorDialog(this.$,Bb),Bb.initialize(),Bb.xg())}}Object(b.a)(D,"AutoSumCommandHandler",
d.a,[208]);class G extends e.a{constructor(Bb){super(Bb)}ld(){this.Zc([new D(this.$)])}static la(Bb){e.a.Nd(96,new G(Bb))}}Object(b.a)(G,"AutoSumCommandHandlerFactory",e.a,[]);var J=a(9),M=a(171),Q=a(263),U=a(38),Z=a(324),P=a(1080),S=a(282),ja=a(64);class X extends U.a{constructor(Bb,Qb,sc){super();this.TMi=(kb,Eb)=>{if(!S.a(kb)&&Eb){const Gc=!!kb&&!!kb.RequestTelemetryData;L.h(this.$).Eh.Yla(Eb.toString(),kb.StateId,Gc?kb.RequestTelemetryData.EcsOperationDuration:0,Gc?kb.RequestTelemetryData.EcsRequestDuration:
0,Gc?kb.RequestTelemetryData.WfeRequestDuration:0)}};this.$=Bb;this.tableManager=Qb;this.sg=sc}LKg(Bb){this.addHandler("ekcvc",Bb)}hgj(Bb){this.removeHandler("ekcvc",Bb)}nc(){return!1}executeCommand(Bb,Qb){Bb=Qb.command;switch(Bb){case -730106152:Qb=this.Gkd(Qb,3);break;case -1228228458:Qb=this.Gkd(Qb,4);break;case -848953656:case 2045211913:if(this.fqi()){Qb=H.Task.Ta(!0);break}Qb=this.Gkd(Qb,1);break;default:Qb=E.a(Bb)}return Qb}wc(Bb,Qb){if(Bb=1===Bb)switch(Qb.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;
default:Bb=!1}return Bb}Kc(){return!1}Gkd(Bb,Qb){const sc=L.h(this.$),kb=sc.ha.ra.selectedRanges,Eb=Bb.command,Gc=M.a.create().toString();if(!this.$.$p(kb,!0)&&-730106152!==Eb)return H.Task.Ta(!0);const zc=r.r(kb,this.$);this.cGj(Eb,sc,kb,Gc);A.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.J8i();const yb=this.$.pa.ya.Wb({wca:!0,Cba:1}),gb=()=>new P.a(Qb,zc);return y.a(this.$.userOperationManager,(Kb,sd,Sb)=>{this.$.My();return h.d(this.$.pa.ya,Qb,
zc,!1,I.b(Kb,this.TMi),sd,Sb,Gc,yb)},Kb=>new t.a(508,0,Kb,67,gb),Bb)}cGj(Bb,Qb,sc,kb){if(-848953656!==Bb&&2045211913!==Bb&&-730106152!==Bb&&-1228228458!==Bb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${Bb}.`);else if(!Q.a.any(sc,Gc=>0<Qb.getRangeInformation(Gc).length)){var Eb=Q.a.any(sc,Gc=>this.tableManager.Ftd(Gc));if(-730106152!==Bb&&-1228228458!==Bb||!Eb)this.bKj(Qb,Bb,kb,sc),-730106152!==Bb&&-1228228458!==Bb||this.sg.oea(Qb,-730106152,{}),
-1228228458!==Bb&&2045211913!==Bb&&-848953656!==Bb||this.sg.Q3g(sc,kb),Qb.Eh.xS(kb,ja.BasicTelemetryCalculator.cR)}}bKj(Bb,Qb,sc,kb){let Eb="";switch(Qb){case -1228228458:Eb="ClearAll";break;case 2045211913:case -848953656:Eb="ClearContent";break;case -730106152:Eb="ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Qb}.`)}Qb=kb.length;kb=r.b(kb);Bb.Eh.d1(15,sc,Eb+(", ranges to clear: "+Qb+", cells to clear: "+
kb))}J8i(){this.raiseEvent("ekcvc",new Z.a)}fqi(){if(L.h(this.$).Ez){const Bb=this.$.da.Aa(296);return!!Bb&&Bb.OU.xB}return!1}}Object(b.a)(X,"ClearCommandHandler",U.a,[208,558]);class Y extends e.a{constructor(Bb){super(Bb)}ld(){const Bb=v.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),Qb=v.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya);w.TaskExtensions.za(w.TaskExtensions.Ed([Bb,Qb],this.ka),()=>{const sc=new X(this.$,Bb.result,Qb.result);this.Zc([sc]);this.$.da.Ga(313,sc)},
this.ka,3)}static la(Bb){e.a.Nd(101,new Y(Bb))}}Object(b.a)(Y,"ClearCommandHandlerFactory",e.a,[]);var va=a(1227),N=a(1081),ea=a(1139),Ca=a(1083),la=a(1084),Ra=a(1151),lb=a(89),Aa=a(222),da=a(4),aa=a(106),fa=a(45),Oa=a(11),ba=a(84),ka=a(146);class Pa{}Pa.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(Pa,"FileUploadDialogHTML",null,[]);var Fa=a(152),oa=a(25);class La extends ka.a{constructor(Bb){super(!1,!1,La.Wu);this.ayd=!1;this.Stf=!0;this.atf=0;this.Rb=1;this.pc(1,CommonUIStrings.l_Send);this.pc(0,CommonUIStrings.l_NoThanks);this.qg=Pa.HTML;this.Usf=Bb;this.Fe=La.iZg}vj(Bb,Qb,sc,kb=!1,Eb=!0){this.ayd=kb;this.mFj(Qb);this.atf=Bb;Eb&&da.AFrameworkApplication.mG(Bb)}mFj(Bb){if(La.Wu)this.UGj(Bb);else{var Qb={};Qb[La.eZg]=Bb;Qb[La.kZg]=CommonUIStrings.l_SendFileErrorReportMessage;Qb[La.lZg]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Qb[La.w0c]="";Qb[La.hZg]=CommonUIStrings.l_UserReportLinkText;Qb[La.T2b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ba.a)(this,this.nxi,"legacyDialogHandler"),Qb);this.mX(La.qZg)}}UGj(Bb){Bb={["id"]:this.Fe,["bodyControls"]:{["reportErrorCheckboxProps"]:this.ayd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.Stf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:da.AFrameworkApplication.ena,["target"]:"_blank"}}},["errorMessage"]:Bb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ba.a)(this,this.HJd,"reactDialogHandler"),Bb)}X$a(){if(!La.Wu){var Bb=document.getElementById(La.nZg);Bb&&(Bb.className=La.mZg,Bb.appendChild(Fa.createClusteredImage(32,32,La.jZg,null,!0,CommonUIStrings.l_DialogError)));
if(Bb=document.getElementById(La.oZg))Bb.innerText=CommonUIStrings.l_PrivacyStatement,Bb.href=da.AFrameworkApplication.ena,fa.a.addHandler(Bb,"click",Object(ba.a)(this,this.oVi,"onPrivacyClickHandler"));this.Stf||(Bb=document.getElementById(La.w0c))&&Bb.parentNode&&Bb.parentNode.removeChild(Bb);this.ayd||(Bb=document.getElementById(La.gZg))&&Bb.parentNode&&Bb.parentNode.removeChild(Bb)}}SI(){La.Wu||(super.SI(),document.getElementById(this.li("WACDialogPanel")).style.width=String.format("{0}px",400))}nxi(Bb,
Qb){const sc=Qb[La.w0c]||"";let kb=!0;void 0!==Qb[La.T2b]&&null!==Qb[La.T2b]&&(kb=Qb[La.T2b]);this.vw(Bb,sc,kb)}HJd(Bb,Qb){this.vw(Bb,Qb.text||"",Qb.reportErrorChecked)}vw(Bb,Qb,sc){this.Usf&&(sc&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.atf),this.Usf(Bb,Qb,sc))}oVi(Bb){da.AFrameworkApplication.ub.Zd(oa.a.FIb,2,Bb)}get VY(){return!1}static get Wu(){return da.AFrameworkApplication.ta.Pa.Iv&&da.AFrameworkApplication.ta.Pa.Gqi}}La.eZg="WACDialogErrorMessage";La.kZg=
"WACDialogErrorReportMessage";La.lZg="WACDialogErrorTextPrompt";La.w0c="WACDialogInput";La.oZg="WACDialogPrivacyText";La.nZg="WACDialogIconPanel";La.jZg="CancelRequest_32x32x32";La.mZg="WACDialogIcon";La.qZg="WACDialogTextPanel";La.T2b="WACDialogSendFileCheckbox";La.gZg="WACDialogSendFileCheckboxContainer";La.hZg="WACDialogSendFileCheckboxText";La.iZg="FileUploadErrorDialog";Object(b.a)(La,"FileUploadErrorDialog",ka.a,[]);class Ea extends U.a{constructor(Bb){super();this.eOf=0;this.yH=null;this.$ej=
Qb=>{this.qgj(Qb)};this.g5g=(Qb,sc)=>{if(1===Qb&&this.yH.FileCollectionErrorStateId){Qb=this.$.pa.ya;var kb=this.yH.MessageId,Eb=this.yH.OriginalEcsServerId,Gc=this.yH.FileCollectionErrorStateId;const zc=Qb.Na(0);zc.errorMessageId=kb;zc.ecsServerId=Eb;zc.fileCollectionErrorStateId=Gc;zc.userComment=sc;Qb.N0c("CollectFile",zc,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=Bb}VKg(Bb){this.addHandler("fileCollectionComplete",Bb)}qgj(Bb){this.removeHandler("fileCollectionComplete",
Bb)}f5g(Bb,Qb,sc){this.eOf=Qb;this.yH=Bb;this.VKg(sc);da.AFrameworkApplication.ena=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;Bb=new La(this.g5g);da.AFrameworkApplication.ub.Nb(oa.a.FIb,aa.a.frame,Ea.q6i);Bb.vj(0,"",null,!1,!1)}static q6i(Bb,Qb,sc,kb,Eb){fa.a.qu(Eb);da.AFrameworkApplication.ena&&Oa.HelperMethods.lf(da.AFrameworkApplication.ena,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(Ea,"FileCollectionOperation",U.a,[559,2]);class ca extends Aa.a{constructor(Bb){super();
this.oUb=null;this.$=Bb;this.Fb()}get yEh(){return this.oUb||(this.oUb=new Ea(this.$))}create(){w.TaskExtensions.za(v.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),()=>{this.nb(this.yEh)},this.ka,3)}dispose(){lb.a.Ia(this.oUb);this.oUb=null;super.dispose()}static la(Bb){Bb.da.Ga(125,new ca(Bb))}}Object(b.a)(ca,"FileCollectionCommandHandlerFactory",Aa.a,[]);var $a=a(1154),Qa=a(1087),Va=a(1251),fb=a(7),Ka=a(644);class hb{}Object(b.a)(hb,"FreezePanesCommandParameters",null,[]);var fc=a(8),
dc=a(183),wb=a(24),Tb=a(389),xb=a(28),cb=a(268),jb=a(270),qa=a(117);const za=(Bb,Qb,sc,kb,Eb,Gc,zc=null)=>{zc=Bb.Na(9,zc);zc.freezeSettings=Qb;return h.g(Bb,"FreezeOrUnfreezePanes",zc,sc,kb,Eb,Gc,0)};class Na{constructor(Bb){this.freezeOptions=null;this.freezeOptions=Bb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(Na,"MacroRecorderSheetPaneFrozenPayload",null,[108]);var ua=a(44);class Xa{constructor(Bb,Qb){this.lbc=this.MId=null;this.KCf=()=>{A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Ovc();if(this.lbc){const sc=cb.a(xb.a.Qa.we,this.lbc);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${sc}`);this.lbc=null}this.vKf()};this.$=Bb;this.gridView=L.h(Bb);this.ED=Qb.Wsb(this.$.domElement,500,null,null);this.RLa=this.QLa=-1}nc(Bb,Qb){let sc=!1;switch(Qb){case 1844679312:sc=1!==Bb&&!this.gridView.ib.X4}return sc}executeCommand(Bb,Qb){Bb=this.gridView.ib;const sc=this.gridView.bkd();
da.AFrameworkApplication.ta.Pa.Kw&&this.$.D_&&(1844679312===Qb.command||340334732===Qb.command||-806625837===Qb.command)&&Ka.ShyRibbon.OJ(1,2);switch(Qb.command){case 1844679312:return this.setFreezePanes(Qb,sc,Bb.tj);case 340334732:return Bb.Fac?H.Task.Ta(!1):this.ewj(Qb,sc);case -806625837:return Bb.gCa?H.Task.Ta(!1):this.fwj(Qb,sc)}return H.Task.Ta(!1)}wc(Bb,Qb){Bb=!1;switch(Qb.command){case 1844679312:case 340334732:case -806625837:case 1745254833:Bb=!0}return Bb}Kc(){return!1}setFreezePanes(Bb,
Qb,sc){if(sc)return this.txc(Bb,!1,0,0,0,0,Qb,null);var kb=this.gridView.ha.ra;sc=kb.activeCell.clone();kb=kb.activeRange;kb.hf&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${sc.top}) and firstUnfreezeCell.Bottom (${sc.bottom}) to equal topLeftRange.Top (${Qb.top})`),sc.top=sc.bottom=Qb.top);kb.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${sc.left}) and firstUnfreezeCell.Right (${sc.right}) to equal topLeftRange.Left (${Qb.left})`),
sc.left=sc.right=Qb.left);sc.top===Qb.top&&sc.left===Qb.left&&(sc=wb.Range.Qc(sc.top+1,sc.left));kb=sc.top-1;const Eb=sc.left-1,Gc=kb-(Qb.top-1),zc=Eb-(Qb.left-1);return this.j1j(sc,Gc,zc)?this.txc(Bb,!0,kb,Eb,Gc,zc,Qb,sc):(this.$.df(),this.vKf(),H.Task.Ta(!0))}ewj(Bb,Qb){return this.txc(Bb,!0,0,Qb.left,0,1,Qb,null)}fwj(Bb,Qb){return this.txc(Bb,!0,Qb.top,0,1,0,Qb,null)}j1j(Bb,Qb,sc){const kb=this.gridView.fg(Bb),Eb=this.gridView.view.visibleArea;return!kb||Eb.topLeft.y>kb.bottomRight.y||Eb.topLeft.x>
kb.bottomRight.x||Eb.bottomRight.y<kb.bottomRight.y||Eb.bottomRight.x<kb.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${Bb}, rangeViewportArea=${kb?kb.toString():"null"}, visibleArea=${Eb.toString()}`),Bb=z.a.$c(1,0,26,1486,0,2105967339,"FreezePaneSelectionNotInViewErr"),A.EwaSettings.Jz()?new B.a(this.$,Bb):(Bb=new C.ErrorDialog(this.$,Bb),Bb.initialize(),Bb.xg()),!1):0>=
Qb&&0>=sc?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),Bb=L.h(this.$).rtl?1488:1487,Qb=L.h(this.$).rtl?-2131054257:-1953454131,Bb=z.a.$c(1,0,26,Bb,0,Qb,"FreezePaneA1SelectedErr"),A.EwaSettings.Jz()?new B.a(this.$,Bb):(Bb=new C.ErrorDialog(this.$,Bb),Bb.initialize(),Bb.xg()),!1):!0}txc(Bb,Qb,sc,kb,Eb,Gc,zc,yb){this.MId=ua.a(this.$).Y9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.QT(this.KCf);this.ED.UTa();
this.gridView.FKj(Qb?"":"UnsetFreezePane");this.Ayj(Bb,Qb,this.gridView.ib);const gb=Object(fb.a)(new hb,{SheetName:this.$.oa.name,Freeze:Qb,FrozenRows:Eb,FrozenColumns:Gc,FirstRow:sc,FirstColumn:kb});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Qb}, FrozenRows=${Eb}, FrozenColumns=${Gc}, FirstRow=${sc}, FirstColumn=${kb} `);const Kb=()=>new Na(gb);this.lbc=xb.a.Qa.we;return y.a(this.$.userOperationManager,(sd,Sb,yc)=>{if(A.EwaSettings.ma(59)){var Fc=
window.performance;Fc.clearMarks();Fc.mark("FreezePanes request sent")}(Fc=this.gridView.kt)?(Fc=this.zsh(gb,Fc,zc,yb),this.RRj(Fc)):this.$.My();return za(this.$.pa.ya,gb,sd,Sb,yc,Qb)},sd=>new t.a(151,0,sd,void 0,Kb),Bb)}zsh(Bb,Qb,sc,kb){f.ULS.shipAssertTag(537159580,1,!!Qb,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!Bb.Freeze)return null;const Eb=jb.a();Eb.State=1;Eb.IsEstimated=!0;let Gc=!1,zc=!1;const yb=Qb.jV(wb.Range.Qc(sc.top,sc.left));
let gb=Bb.FrozenRows;var Kb=Bb.FrozenColumns;1!==Bb.FrozenRows||Bb.FrozenColumns?Bb.FrozenRows||1!==Bb.FrozenColumns?(Kb=Qb.jV(wb.Range.Qc(Bb.FirstRow+1,Bb.FirstColumn+1)),Qb=Qb.jV(wb.Range.Qc(sc.top,sc.left)),Eb.Width=Kb.yj-yb.yj,Eb.Height=Kb.Pj-yb.Pj,0<Bb.FrozenRows&&(Eb.AbsoluteTop=Kb.Pj,zc=!0),0<Bb.FrozenColumns&&(Eb.AbsoluteLeft=Kb.yj,Gc=!0),gb=Kb.zL-Qb.zL,Kb=Kb.TJ-Qb.TJ):(Eb.Width=Qb.zid(dc.a.Qc(sc.top,sc.left)),kb=wb.Range.Qc(sc.top,sc.left+1),Eb.AbsoluteLeft=yb.yj+Eb.Width,Gc=!0):(Eb.Height=
Qb.yid(dc.a.Qc(sc.top,sc.left)),kb=wb.Range.Qc(sc.top+1,sc.left),Eb.AbsoluteTop=yb.Pj+Eb.Height,zc=!0);zc&&(Eb.FirstFrozenRow=sc.top,Eb.FirstScrollableRow=kb.top);Gc&&(Eb.FirstFrozenColumn=sc.left,Eb.FirstScrollableColumn=kb.left);Eb.VisibleRows=gb;Eb.VisibleColumns=Kb;return Eb}RRj(Bb){H.Task.delay(this.$.va.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.oa&&this.$.ea&&(this.$.ea.DX(fc.a.re,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Tb.b(this.$.oa,Bb,-1,void 0,!0))})}Ayj(Bb,
Qb,sc){if(!A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(Bb.command){case 1844679312:if(Qb||-1===this.QLa&&-1===this.RLa)this.QLa=sc.Fx-sc.width+this.gridView.scrollLeft,this.RLa=sc.Gx-sc.height+this.gridView.scrollTop;break;case 340334732:if(Qb||-1===this.QLa)this.QLa=sc.Fx-sc.width+this.gridView.scrollLeft;break;case -806625837:if(Qb||-1===this.RLa)this.RLa=sc.Gx-sc.height+this.gridView.scrollTop}}Ovc(){const Bb=this.gridView.ib;0<Bb.width?
this.gridView.scrollLeft=qa.a.C2b(this.gridView.domElement,L.h(this.$).rtl,0):-1!==this.QLa&&(this.gridView.scrollLeft=this.QLa,this.QLa=-1);0<Bb.height?this.gridView.scrollTop=0:-1!==this.RLa&&(this.gridView.scrollTop=this.RLa,this.RLa=-1)}vKf(){this.ED.$Ta();lb.a.Ia(this.MId);this.MId=null;this.gridView.wO(this.KCf)}}Object(b.a)(Xa,"FreezePanesCommandHandler",null,[208]);class ha extends e.a{constructor(Bb){super(Bb)}ld(){w.TaskExtensions.za(v.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya),
Bb=>{this.Zc([new Xa(this.$,Bb.result)])},this.$.ka)}static la(Bb){Bb.da.Ga(116,new ha(Bb))}}Object(b.a)(ha,"FreezePanesCommandHandlerFactory",e.a,[]);var ta=a(1168),wa=a(27),db=a(562),Jb=a(559),Pb=a(30),eb=a(995),Ma=a(1088);a(315);var ob=a(13),Ia=a(33);class Da{constructor(Bb,Qb){this.$=Bb;this.fontServiceManager=Qb;this.menuId=this.l0c=this.VO=this.nva=null;this.Fdd=0;this.pGi="+mn-lt";this.tDi="+mj-lt";this.TPi=()=>{this.u3f()};this.lVi=sc=>{this.Nkf=!0;this.$.ky(kb=>{kb.yQa("FontName_New")});
f.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${sc}`)};this.kki=!!String.fromCodePoint&&!wa.a.Gv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Nkf=!1;this.Vl=A.EwaSettings.Vl();this.gridView=L.h(this.$);(this.rl=Ia.a.rl())&&this.fontServiceManager&&(this.fontServiceManager.gic?this.u3f():this.fontServiceManager.Pre(this.TPi))}get themesManager(){this.Bx||(this.Bx=this.$.da.Aa(422));return this.Bx}u3f(){this.VO=this.fontServiceManager.oBc;this.nva=
this.fontServiceManager.nIh;this.Fdd=2}get oBc(){return this.VO}o_e(Bb,Qb,sc,kb=null){const Eb=Object.assign(new db.a,{Id:"FontDropdownMenu"});Eb.MenuSectionList=[];if(this.Vl&&this.themesManager){this.themesManager.tcd(kb);if((null==this.themesManager.zG||this.themesManager.Ltd)&&!A.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return Eb;kb=Object.assign(new Jb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:ob.a.instance.ga(1332),ControlList:this.n3h(Bb,Qb,sc)});Eb.MenuSectionList.push(kb)}kb=
Object.assign(new Jb.a,{ControlsId:"FontsMenuSectionControl"});if(this.Vl||this.rl)kb.Title=ob.a.instance.ga(1333);kb.ControlList=this.bUh(Bb,Qb,sc);Eb.MenuSectionList.push(kb);return Eb}n3h(Bb,Qb,sc){var kb;const Eb=[];var Gc=this.gridView.ha.Sa.$b;Gc=5===(null===(kb=null===Gc||void 0===Gc?void 0:Gc.floatingObject)||void 0===kb?void 0:kb.type);let zc,yb;this.themesManager.zG?(zc=this.themesManager.zG.Kzd,yb=this.themesManager.zG.vyd):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(kb=this.tJe(yb,
1,Gc,Bb,Qb,sc))&&Eb.push(kb);(Bb=this.tJe(zc,2,Gc,Bb,Qb,sc))&&Eb.push(Bb);return Eb}tJe(Bb,Qb,sc,kb,Eb,Gc){var zc=2===Qb?this.pGi:this.tDi;let yb;if(Bb)sc=sc?zc:Pb.a.Xe(Bb),zc=Pb.a.Xe(Oa.HelperMethods.Wdc(Bb,Qb)),yb=Pb.a.Xe(Bb);else{if(!A.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return null;sc=sc?zc:void 0;zc=Pb.a.Xe(String.fromCodePoint(0));yb="msofp"}return Object.assign(new eb.a,{MenuItemId:2===Qb?Ma.b:Ma.a,CommandValueId:sc,LabelText:zc,LabelCss:String.format("font-size:12pt;font-family:{0};",
yb),Styles:Da.Bxb(yb),AriaLabel:zc,Alt:zc,Command:kb.toString(),CommandPreviewId:Eb.toString(),CommandRevertId:Gc.toString(),Disabled:!Bb})}bUh(Bb,Qb,sc){if(this.l0c)return this.l0c.P7c;let kb;const Eb=Oa.HelperMethods.t6(()=>{const Gc=this.kki&&!this.Nkf;let zc=!1;this.nva||(this.Gef(),zc=!0);kb=this.UHe(Bb,Qb,sc,this.nva,Gc,zc);kb.pzc&&!zc&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Gef(),kb=this.UHe(Bb,
Qb,sc,this.nva,Gc,kb.pzc));this.rl&&!kb.pzc&&(this.l0c=kb);Gc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.lVi)});10<Eb&&f.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${Eb}`);return kb.P7c}UHe(Bb,Qb,sc,kb,Eb,Gc){const zc=[];let yb;const gb=this.rl&&!Gc;yb=gb?"msofpNew":"msofp";for(let Fc in kb){var Kb=Fc,sd=kb[Fc],Sb=Pb.a.Xe(Kb),yc=void 0;if(gb)if(yc=this.VO?this.VO[Kb]:null)yc=Pb.a.Xe(yc);else return f.ULS.sendTraceTag(520710161,
1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Kb}`),{pzc:!0,P7c:[]};else yc=Pb.a.Xe(Oa.HelperMethods.VO[Kb]);Kb=Pb.a.Xe(Kb);Eb||(sd=0);Sb=Object.assign(new eb.a,{MenuItemId:Sb,CommandValueId:Sb,LabelText:Eb&&0<sd?Pb.a.Xe(String.fromCodePoint(sd)):yc,LabelCss:String.format("font-size:12pt;font-family:{0};",Eb&&0<sd?yb:Kb),Styles:Da.Bxb(Eb&&0<sd?yb:Kb),AriaLabel:yc,Alt:yc,Command:Bb.toString(),CommandPreviewId:Qb.toString(),CommandRevertId:sc.toString()});
zc.push(Sb)}return{pzc:Gc,P7c:zc}}$wj(Bb){this.menuId=Bb}Vmi(){return 2!==this.Fdd&&3!==this.Fdd?!1:!0}Gef(){this.nva={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,
["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,
["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static Bxb(Bb){const Qb={};Qb["font-family"]=Bb;Qb["font-size"]="12pt";Bb={};Bb.optionText=Qb;return Bb}}Object(b.a)(Da,"FontDropdownHelper",null,[567]);var nb=a(697);class Ua extends Aa.a{constructor(Bb){super();this.$=Bb;this.Fb()}create(){A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.$a(504,Bb=>{this.nb(Object(nb.a)(this.$.da,
502,()=>new Da(this.$,Bb)))}):this.nb(Object(nb.a)(this.$.da,502,()=>new Da(this.$,null)))}static la(Bb){Bb.da.Ga(503,new Ua(Bb))}}Object(b.a)(Ua,"FontDropdownHelperFactory",Aa.a,[]);var W=a(1252),sa=a(1090),vb=a(1228),gc=a(1191),Bc=a(1137),Sa=a(1164),na=a(1277),ib=a(1229),Ib=a(1216);class ec{constructor(Bb){this.$=Bb}nc(){return!1}executeCommand(Bb,Qb){Bb=!1;Qb=Qb.command;switch(Qb){case 1910465940:Bb=!0}return Bb?H.Task.Ta(!0):E.a(Qb)}wc(Bb,Qb){switch(Qb.command){case 1910465940:return!0;default:return!1}}Kc(){return!1}}
Object(b.a)(ec,"NameManagerCommandHandler",null,[208]);class qb extends e.a{constructor(Bb){super(Bb)}ld(){this.Zc([new ec(this.$)])}static la(Bb){e.a.Nd(493,new qb(Bb))}}Object(b.a)(qb,"NameManagerCommandHandlerFactory",e.a,[]);var Ha=a(1174),Ab=a(1180),Yb=a(1278);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(c.a)();J.a.Fa(G.la);J.a.Fa(Y.la);Object(va.a)();Object(N.a)();Object(ea.a)();Object(Ca.a)();Object(la.a)();Object(Ra.a)();J.a.Fa(ca.la);Object($a.a)();Object(Qa.a)();Object(Va.a)();(()=>{J.a.Fa(Bb=>{ha.la(Bb)})})();Object(ta.a)();Object(W.a)();Object(sa.a)();Object(vb.a)();Object(gc.a)();Object(Bc.a)();
Object(Sa.a)();Object(na.a)();Object(ib.a)();Object(Ab.a)();Object(Ib.a)();Object(Ha.a)();Object(Yb.a)();(()=>{J.a.Fa(Bb=>{qb.la(Bb)})})();(()=>{J.a.Fa(Bb=>{Ua.la(Bb)})})()},718:function(u,F,a){a.d(F,"a",function(){return M});u=a(0);var c=a(7),b=a(15),e=a(562),f=a(89),d=a(559),h=a(378),n=a(591),m=a(567),x=a(111),r=a(263),y=a(82),t=a(419),v=a(1399);F=a(78);var w=a(19),C=a(5),B=a(775),z=a(76),A=a(40),E=a(59),I=a(142),L=a(113),V=a(1),T=a(11),H=a(22),D=a(13),G=a(21),J=a(34);class M extends F.a{constructor(Q,
U,Z,P,S,ja,X,Y,va,N,ea,Ca){super();this.Xmc=!1;this.gIc=this.WKc=this.contextMenuController=null;this.Sqd=!1;this.lwc=this.Wtb=null;this.kD=()=>{this.contextMenuController?this.contextMenuController.kD():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.bhg()};this.jb=Q;this.ivf=S;this.pmb=N;this.HMf=ja;this.populateOnlyOnce=X;this.c$h=ea;this.cTf(Ca)}get contextMenuRoot(){return this.lwc}get $(){return this.jb}get Va(){return this.pmb}get menuId(){return this.$.Eb+
this.ivf}get fwb(){this.WKc||(this.WKc=L.a(this.$));return this.WKc}get grb(){this.gIc||(this.gIc=G.h(this.$).Vb);return this.gIc}nc(Q,U){Q=!0;switch(U){case 1651433993:case 1675506831:case 966232027:Q=this.Td(4096)||this.Td(2048);break;case 2045563128:Q=this.Td(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:Q=this.Td(8192)}return!Q}Kc(Q,U,Z){Z.IsShadowMenuOpen||B.i(this.$,B.d);Q=!1;U===this.Yw&&(Z.IsShadowMenuOpen||B.i(this.$,B.a),U=Object(c.a)(new e.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]}),this.TGd(U,Z.IsShadowMenuOpen),Z.MenuItems=U,Z.IsShadowMenuOpen||B.i(this.$,B.c),Q=!0);Q&&this.Xmc&&T.HelperMethods.D2b&&!Z.IsShadowMenuOpen&&B.k(this.$);return Q}TGd(Q,U){(U=this.kZ(U))?(this.Scf(U),Q.MenuSectionList.push(...U.MC().MenuSectionList),this.QIg(Q)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}kZ(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}a1(Q,U,Z,P,S){Q=Sys.UI.DomElement.getBounds(U);U=new Sys.UI.Point(Q.x,Q.y+Q.height);this.$.isChromeRtl&&(U.x+=Q.width);this.Sp(U,S)}Sp(Q,U,Z=0){U&&(Q=J.a(this.$).eka(Q));U=!0;if(this.c$h){let P;3===Z?(P=this.hLa(3))&&0<P.length?(U=!1,this.showFloatie(P,new Sys.UI.Bounds(Q.x,Q.y,0,0),Z)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===Z&&this.$.isEditMode&&
((P=this.hLa(2))&&0<P.length?P[0]!==M.BYe?(U=!1,this.hVd(P,new Sys.UI.Bounds(Q.x,Q.y,0,0),Z)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}U&&this.showContextMenu(new Sys.UI.Bounds(Q.x,Q.y,0,0),Z)}hLa(){return null}pid(Q,
U=null){let Z="";3===Q?Z="touch":2===Q&&(Z="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!E.a.Bg&&E.a.Bg.PK,["IsReactMLR"]:!!E.a.Bg&&E.a.Bg.OV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:Z,["FloatieGroups"]:JSON.stringify(U)}}showContextMenu(Q,U=0){const Z=this.pid(U);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(Z)}`);this.contextMenuController?this.QB!==C.a.IJd&&this.QB!==C.a.JJd||0===
U?this.contextMenuController.gVd(this.QB,Q,z.a.Db):this.contextMenuController.gVd(this.QB,Q,U):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(Q,U,Z){const P=this.pid(Z,Q);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(P)}`);this.contextMenuController?(this.kTf(),this.contextMenuController.Rzc(Q,U,Z)):(Q=JSON.stringify(Q),
b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${Q}.`))}hVd(Q,U,Z){var P=this.pid(Z,Q);P=JSON.stringify(P);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${P}`);this.contextMenuController?(this.kTf(),this.contextMenuController.fVd(Q,U,Z,this.QB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}cTf(Q){this.contextMenuController=
Q}dispose(){this.$&&this.$.Ja.ucb(this);this.jb=null;this.bhg();this.lwc&&(f.a.Ia(this.lwc),this.lwc=null);super.dispose()}GKh(Q){var U=this.$.da.Aa(204);U&&(U=U.nLh(this.ivf))&&Q.tc.push(U)}Td(Q){return(new I.a(this.$.xa)).Td(Q)}Scf(Q){for(const U of Q.tc)if(Object(t.a)(247,U)){Q=U;Q.title&&(Q.title=M.If(Q.title));for(const Z of Q.buttons)Object(t.a)(248,Z)?(Q=Z,Q.label=M.If(Q.label),Q.pS(M.If(Q.alt))):Object(t.a)(249,Z)&&this.Scf(Z.menu)}}fvf(Q,U=!1){const Z=[];for(const P of Q)Z.push(this.dD(P,
U));return Z}dD(Q){const U=[];for(const Z of Q.MenuItems)switch(Z.Type){case 3:U.push(this.xah(Z));break;case 2:U.push(this.hgh(Z));break;case 1:U.push(this.Ubh(Z))}return Object(c.a)(new d.a,{ControlList:U,Title:Q.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Ied(Q,U){U=[this.Wtb,Q.RibbonCommand.toString(),U?this.t3e(U):this.t3e(Q.Label),Q.Disabled?Q.Disabled.toString():"False"];let Z=Q.CommandData;Z=H.a.hashCode(Z).toString();
U.push(Z,Q.Identifier.toString());U=U.join("_");Q.IsChecked&&(U+="_Checked");return U}oLh(Q){const U=[this.Wtb,H.a.hashCode(Q.Title).toString()];for(const Z of Q.MenuItems)U.push(Z.RibbonCommand.toString());return U.join("_")}n_e(Q){var U=Q.Label;U=H.a.hashCode(U).toString();U=[this.Wtb,U];V.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&Q.Id&&U.push(H.a.hashCode(Q.Id).toString());U=U.join("_");Q.IsChecked&&(U+="_Checked");return U}xah(Q){let U,
Z,P;({label:Z,yMa:P,Nr:U}=this.xbc(Q,!1));const S=this.Ied(Q,Z);return Object(c.a)(new h.a,{Command:Q.Disabled?(-251203935).toString():U.toString(),ExternalId:S,Id:S,Image16by16Class:P,LabelText:Z||Q.Label,MenuItemId:Q.CommandData,CommandValueId:Q.CommandData})}hgh(Q){let U,Z,P;({label:Z,yMa:P,Nr:U}=this.xbc(Q,Q.IsChecked));const S=this.Ied(Q,Z);return Object(c.a)(new n.a,{Command:Q.Disabled?(-251203935).toString():U.toString(),ExternalId:S,Id:S,Image16by16Class:P,LabelText:Z||Q.Label,MenuItemId:Q.CommandData,
CommandValueId:Q.CommandData,IsChecked:Q.IsChecked})}Ubh(Q){let U;var Z;({label:U,yMa:Z}=this.x_e(Q));const P=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});P.MenuSectionList.push(...this.fvf(Q.SubMenu.Sections,!0));const S=this.n_e(Q);Q=U||Q.Label;return Object(c.a)(new m.a,{ExternalId:S,Id:S,LabelText:Q,PopulateOnlyOnce:!1,Menu:P,Image16by16Class:Z,ImageIsVisible:!!Z})}x_e(Q){let U,Z;({label:Q,yMa:U,Nr:Z}=this.xbc(Q,!0));return{label:Q,yMa:U,Nr:Z}}xbc(Q,U){let Z;switch(Q.Identifier){case 26:Z=
912804500;U=w.a.KUe;Q=D.a.instance.ga(1942);break;case 3:Z=-1902148570;U=U?w.a.zaa:null;Q=D.a.instance.ga(1902);break;case 4:Z=-1902148570;U=U?w.a.zaa:null;Q=D.a.instance.ga(1903);break;case 5:Z=-1902148570;U=U?w.a.zaa:null;Q=null;break;case 1:Z=-1677817820;U=w.a.q$b;Q=D.a.instance.ga(233);break;case 2:Z=-1649376918;U=Q.IsChecked?w.a.Wua:null;Q=D.a.instance.ga(2116);break;case 23:Z=1701016594;U=Q.IsChecked?w.a.Wua:null;Q=D.a.instance.ga(2116);break;case 6:Z=-87741481;U=null;Q=D.a.instance.ga(2117);
break;case 7:Z=1948650742;U=w.a.uTe;Q=D.a.instance.ga(1940);break;case 8:Z=1933713114;U=w.a.tTe;Q=D.a.instance.ga(1941);break;case 14:Z=504133448;U=w.a.XJa;Q=D.a.instance.ga(145);break;case 30:Z=504133448;U=w.a.XJa;Q=D.a.instance.Ua(743);break;case 32:Z=504133448;U=w.a.XJa;Q=D.a.instance.ga(149);break;case 34:Z=504133448;U=w.a.XJa;Q=D.a.instance.ga(151);break;case 27:Z=1701016594;U=U?w.a.s$b:w.a.XJa;Q=D.a.instance.ga(145);break;case 15:Z=-798968736;U=w.a.YJa;Q=D.a.instance.ga(147);break;case 31:Z=
-798968736;U=w.a.YJa;Q=D.a.instance.Ua(744);break;case 33:Z=-798968736;U=w.a.YJa;Q=D.a.instance.ga(150);break;case 35:Z=-798968736;U=w.a.YJa;Q=D.a.instance.ga(152);break;case 28:Z=1701016594;U=U?w.a.t$b:w.a.YJa;Q=D.a.instance.ga(147);break;case 21:Z=-2058042992;U=w.a.s3a;Q=null;break;case 29:Z=1701016594;U=w.a.s3a;Q=null;break;case 9:Z=1701016594;Q=U=null;break;case 11:Z=-1494291901;Q=U=null;break;case 25:Z=-1045020714;U=Q.IsChecked?w.a.Wua:null;Q=null;break;case 13:Z=1701016594;U=Q.IsChecked?w.a.Wua:
null;Q=D.a.instance.ga(154);break;case 16:Z=1701016594;U=w.a.i$b;Q=D.a.instance.ga(1078);break;case 17:Z=1701016594;U=w.a.r3a;Q=null;break;case 18:Z=1701016594;U=w.a.q3a;Q=null;break;case 19:Z=1701016594;U=w.a.j$b;Q=D.a.instance.ga(1083);break;case 20:Z=1701016594;U=w.a.Nad;Q=D.a.instance.ga(1084);break;case 24:Z=1675506831;Q=U=null;break;case 22:Z=Q.RibbonCommand;U=Q.IsChecked?w.a.zaa:null;Q=null;break;case 36:Z=1461300262;U=null;Q=D.a.instance.ga(153);break;case 38:Z=Q.RibbonCommand;U=w.a.bbd;Q=
D.a.instance.ga(1813);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(Q)}`),Z=1461300262,Q=U=null}return{label:Q,yMa:U,Nr:Z}}t3e(Q){return H.a.hashCode(Q+T.HelperMethods.Qtj).toString()}QIg(Q){if(!this.$.ea.amIAlone){var U=this.$.da.Aa(25);if(U&&!x.a.isEmpty(U.ICa)&&(U=U.X4h(),!r.a.rh(U))){var Z=[];y.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").zeh(U,Z);Q.MenuSectionList.push(...Z)}}}kTf(){this.Sqd||(this.fwb&&this.fwb.g0b(this.kD),
this.grb&&this.grb.g0b(this.kD),this.Sqd=!!this.fwb||!!this.grb)}bhg(){this.fwb&&this.fwb.Ruc(this.kD);this.grb&&this.grb.Ruc(this.kD);this.Sqd=!1}static Vpd(Q,U){U=A.C(U);Q=G.h(Q).Da.tLa(U);return!(null===Q||void 0===Q||!Q.Pk)}static Ofd(Q,U,Z){U=A.C(U);var P=G.h(Q).Da.tLa(U);U=G.h(Q).getCellBounds(P);const S=P.ATg;P=P.zTg;let ja=U.x+S.x;U=U.y+S.y;Z&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(G.h(Q).rtl||(ja+=P),U-=P);return new Sys.UI.Point(ja,U)}static ICh(Q){try{Object(v.a)(Q.CommandValueId)}catch(U){}}static If(Q){const U=
M.vua.parseFromString(Q,"text/html");return U?U.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),Q)}}M.vua=new DOMParser;M.BYe="Unsupported";Object(u.a)(M,"ContextMenuBase",F.a,[208,250,2])},775:function(u,F,a){a.d(F,"j",function(){return"ContextMenuPerf.A"});a.d(F,"b",function(){return"ContextMenuPerf.B"});a.d(F,"d",function(){return"ContextMenuPerf.C1"});a.d(F,"a",function(){return"ContextMenuPerf.C2"});a.d(F,"c",function(){return"ContextMenuPerf.D"});a.d(F,
"e",function(){return x});a.d(F,"f",function(){return t});a.d(F,"h",function(){return v});a.d(F,"i",function(){return w});a.d(F,"k",function(){return C});a.d(F,"g",function(){return z});var c=a(15),b=a(323),e=a(8),f=a(61),d=a(24),h=a(11),n=a(21),m=a(1);const x=(A,E)=>{var I=A.Sb(null);if((null===I||void 0===I?0:I.cell.Pk)&&r(I,A,E))return A.getCellBounds(I.cell);I=A.ha.ra.activeCell;return(E=y(new d.Range(I.top,I.left,e.a.fh,I.left,!1,!1),2,!0,A,E)||y(new d.Range(1,I.left,I.top,I.left,!1,!1),2,!1,
A,E)||y(new d.Range(I.top,I.right,I.top,e.a.sh,!1,!1),1,!0,A,E)||y(new d.Range(I.top,1,I.top,I.right,!1,!1),1,!1,A,E)||null)&&E.Pk?A.getCellBounds(E):Sys.UI.DomElement.getBounds(A.Cwa.mc)},r=(A,E,I)=>{var L=E.rtl,V=I.isChromeRtl;A=A.cell;return(I=n.h(I).sK(A))?(I=I.topLeft,L=I.x+=L===V?A.offsetWidth:0,V=I.y+=A.offsetHeight,E.view.visibleArea.contains(new f.a(L,V,0,0))):!1},y=(A,E,I,L,V)=>{A=L.jk("ContextMenuHelper.FindFirstCellInViewportArea",A,E,I);try{for(A.$$rst();A.$$mn();){const T=A.$$cu();if(T&&
r(T,L,V))return T.cell}}finally{A&&A.dispose()}return null},t=A=>A.Bb.H5(A.ha.ra.activeCell),v=A=>{A=n.h(A).ha.ra;return A.Pg&&(A.dd.isRow||A.dd.hf)},w=(A,E)=>{h.HelperMethods.R_c&&window.performance.mark(E)},C=()=>{if(b.a.rqb){const A=B("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),E=B("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),I=B("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${A}], PrepInfraWork=[${E}], EWAPopulation =[${I}]`)}},
B=(A,E,I)=>{window.performance.measure(A,E,I);E=window.performance.getEntriesByName(A);E.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${A}] returned no measures.`);return E[E.length-1]?E[E.length-1].duration:-1},z=A=>m.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?A.qd&33554432?!0:!1:!0},777:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{}c.VQe="ewa-ac";c.Tsh="ewa-ac-param";c.bSe="ewa-function-help-link";c.d$b=
"ewa-lb";c.XRe="ewa-fb-refactor";c.listItem="list-item";c.zDb="list-item-selected";c.DDb="list-table-touch";c.CDb="list-table";c.byh="ewa-suggested-cell-name";c.s5g="columnName-header";c.ZSe="ewa-tt";c.Cvh="ewa-function-link-container";c.cSe="ewa-function-udf-name";c.rtl="rtl";Object(u.a)(c,"CssClassNames",null,[])},813:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(818),e=a(725),f=a(5),d=a(76),h=a(52),n=a(199),m=a(35),x=a(1),r=a(13);class y{constructor(Q,U,Z,P,S,ja,X,Y){this.osg=Q;this.psg=U;this.nsg=
Z;this.Qga=P;this.pDg=S;this.Hzg=ja;this.Hkb=X;this.Hyg=Y}get kye(){return this.osg}get u2b(){return this.psg}get jye(){return this.nsg}get width(){return this.Qga}get SLj(){return this.pDg}get mKi(){return this.Hzg}get lineHeight(){return this.Hkb}get Kxi(){return this.Hyg}static sWg(){return new y("BorderStyleSolidLine",1957,1,"1","",1,8,0)}static oWg(){return new y("BorderStyleDashedLine",1958,3,"1","5,3",1,8,0)}static pWg(){return new y("BorderStyleDottedLine",1959,4,"1","1,1",1,8,0)}static rWg(){return new y("BorderStyleMediumLine",
1960,2,"2","",1,8,0)}static tWg(){return new y("BorderStyleThickLine",1961,5,"3","",1,8,0)}static qWg(){return new y("BorderStyleDoubleLine",1962,6,"1","",2,8,3)}}Object(u.a)(y,"BorderLineStyleProperties",null,[]);class t{constructor(){this.iconName=this.title=this.key=null}}Object(u.a)(t,"BorderLineStyleProps",null,[]);class v{constructor(Q){Q.vTf()}getBorderLineStyleProps(){const Q=a(813).BorderFormatManager.a0a,U=Array(Object.keys(Q).length);let Z=0;for(let ja in Q){var P=ja,S=Q[ja];U[Z]=new t;
U[Z].key=P;P=S;U[Z].title=r.a.instance.ga(P.u2b);U[Z].iconName=P.kye;Z++}return U}}Object(u.a)(v,"BorderMenuController",null,[361]);var w=a(263),C=a(85),B=a(239),z=a(14),A=a(108),E=a(24),I=a(47),L=a(46),V=a(209),T=a(11),H=a(21),D=a(34),G=a(40);class J{constructor(Q,U){this.xIb=this.ribbonCommandInfo=this.cellFormat=this.es=this.qb=this.ha=null;this.$tc=!1;this.bOf=this.JMa=this.cId=this.Iae=this.Vza=this.bna=null;this.w2b=this.Bua=this.hOf=0;this.borderStyle=this.b0a=this.borderColor=null;this.xB=
!1;this.currentSelectedRange=this.wbb=null;this.E0=()=>{if(!this.xB||H.h(this.$).Ez)this.xB=!1,H.h(this.$).Ez=!1,this.Bua=0,H.h(this.$).yf.gm(f.a.SQ),1===this.$.Ja.KH()&&(H.h(this.$).T4(x.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?G.d(this.cId):w.a.clone(this.cId),this.hOf,this.$.oa?this.$.oa.sheetName:null,null,this.bOf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",!0),H.h(this.$).zTa(!0)),this.Uv(),this.o0d(),this.gk(),this.$tc=!1,this.Vza=this.bna=null,this.es&&
(this.es.cancel(),this.es.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=Z=>{try{if(Z=this.Vd(Z),H.h(this.$).Ez=!0,this.bna={},this.Vza={},this.wbb=null,this.uqb(this.w2b),2===Z.tb){const P=H.h(this.$).ha.io(Z.clientPoint,Z.Gb,5,void 0,void 0,!1);P&&(this.currentSelectedRange=this.JMa=P,this.vcj())}}catch(P){H.h(this.$).Ez=!1}return!0};this.Hh=Z=>{try{Z=this.Vd(Z);const P=H.h(this.$).ha.io(Z.clientPoint,Z.Gb,5,void 0,void 0,
!1),S=H.h(this.$).Da.rs(P);if(!this.xIb||S&&(S.$Q!==this.xIb.$Q||S.ZQ!==this.xIb.ZQ))if(this.xB=!0,this.xIb=S,P){let ja=new E.Range(this.JMa.top,this.JMa.left,this.JMa.top,this.JMa.left,!0,!1);ja.union(P);ja=H.h(this.$).ha.o_h(ja);this.B2b(P);this.VYf(this.wbb,ja);if(this.bottomRightCorner(ja.bottom,ja.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;const X=new E.Range(ja.top,ja.left,ja.bottom+1,
ja.right+1,!0,!1),Y=H.h(this.$).caa("DrawBorderBehavior.OnPointerMove",[X]);if(this.bna&&this.Vza)for(;Y.$$mn();){const va=Y.$$cu(),N=va.cell.getRange().toString();N in this.bna&&1!==this.Bua||(this.bna[N]=va,this.Vza[N]=va.cell.jN())}this.wbb=X;this.currentSelectedRange=ja;H.h(this.$).T4([ja],0,this.$.oa.sheetName,null,ja.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",!0);this.sg.oea(H.h(this.$),-1690267012,this.cellFormat,!0,null,[ja])}return!0}catch(P){return H.h(this.$).Ez=!1}};this.Rf=
Z=>{Z=this.Vd(Z);(Z=H.h(this.$).ha.io(Z.clientPoint,Z.Gb,5,void 0,void 0,!1))?this.xB&&(this.B2b(Z),this.JMa.union(Z),3===this.Bua?this.uqb(0):this.uqb(this.w2b),H.h(this.$).T4([this.JMa],0,this.$.oa.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.sg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.Bua?this.uqb(0):this.uqb(this.w2b),H.h(this.$).T4([this.currentSelectedRange],0,this.$.oa.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",
!0),this.sg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.xB=!1;this.o0d();this.Vza=this.bna=null;return!0};this.onKeyDown=Z=>{Z=this.Vd(Z);if(this.xB||[17,16,18,20].includes(Z.Ca.keyCode))return!0;this.E0();return!1};this.onKeyUp=Z=>{Z=this.Vd(Z);if(Z.Ca.keyCode===C.a.JG&&this.xB)return this.xB=!1,this.VYf(this.wbb,this.currentSelectedRange,!0),this.o0d(),!0;if(this.xB||Z.Ca.keyCode===C.a.B1||Z.Ca.keyCode===C.a.dGc||Z.Ca.keyCode===C.a.cGc||[17,16,18,20,37,39,38,40,33,34,9,
13].includes(Z.Ca.keyCode)||Z.Ca.keyCode===C.a.G4d||Z.Ca.keyCode===C.a.C4d||Z.Ca.keyCode===C.a.y4d)return!0;this.E0();return!1};this.ZN=(Z,P)=>{H.h(this.$).Ez&&!this.dci.includes(P.Wd.command)&&(Z=JSON.stringify(P.Wd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${Z} `),this.E0())};this.$=Q;this.sg=U}get dci(){return this.Iae||(this.Iae=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,
-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}VFg(Q){c.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=H.h(this.$).ha;this.qb=H.h(this.$).qb;this.ribbonCommandInfo=Q;this.cId=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?G.d(this.ha.ra.selectedRanges):w.a.clone(this.ha.ra.selectedRanges);this.hOf=this.ha.ra.Ds;this.bOf=this.ha.ra.activeCell.clone();this.qb&&this.qb.hmd();
this.Qs();this.Nj()}dispose(){this.E0();this.xIb=this.ribbonCommandInfo=this.cellFormat=null}uqb(Q){var {BorderFormatManager:U}=a(813);this.cellFormat={};const Z={};this.borderColor=this.borderColor||U.V7c;var P=n.a.GH(this.borderColor,!1);Z.Color=[P,P,P,P];x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.b0a&&(Z.ThemeBorderColor=[this.b0a,this.b0a,this.b0a,this.b0a],Z.ColorTypeOption=1);P=a(813).BorderFormatManager.a0a;this.borderStyle=this.borderStyle||U.borderStyleSolidLine;
U=P[this.borderStyle].jye;Z.LineStyle=[U,U,U,U];this.cellFormat.BorderFormat=Z;this.cellFormat.ValidMembers=128;this.cellFormat.Border=Q}Qs(){for(const Q of H.h(this.$).Mn)B.a.instance.sa(z.a.pointerDown,Q.domElement,this.onPointerDown);A.KeyInputManager.instance.sa(z.a.Pb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.sa(z.a.Fd,document.documentElement,this.onKeyUp)}vcj(){for(const Q of H.h(this.$).Mn)B.a.instance.sa(z.a.Kj,Q.domElement,this.Hh),B.a.instance.sa(z.a.Sf,Q.domElement,
this.Rf);B.a.instance.sa(z.a.Sf,document.documentElement,this.Rf);B.a.instance.sa(z.a.Fy,document.documentElement,this.Rf);this.$tc=!0}Uv(){try{for(const Q of H.h(this.$).Mn)B.a.instance.Ba(z.a.pointerDown,Q.domElement,this.onPointerDown);A.KeyInputManager.instance.Ba(z.a.Pb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.Ba(z.a.Fd,document.documentElement,this.onKeyUp)}catch(Q){H.h(this.$).Ez=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${Q}`)}}o0d(){if(this.$tc)try{this.$tc=
!1;for(const Q of H.h(this.$).Mn)B.a.instance.Ba(z.a.Kj,Q.domElement,this.Hh),B.a.instance.Ba(z.a.Sf,Q.domElement,this.Rf);B.a.instance.Ba(z.a.Sf,document.documentElement,this.Rf);B.a.instance.Ba(z.a.Fy,document.documentElement,this.Rf)}catch(Q){H.h(this.$).Ez=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${Q}`)}}Nj(){this.$.xa.Xf(this.E0);H.h(this.$).Vb.Yk(this.E0);H.h(this.$).FC(this.E0);this.$.Ja.osa(this.ZN)}gk(){this.$.xa.Eg(this.E0);
H.h(this.$).Vb.Gk(this.E0);H.h(this.$).bE(this.E0);this.$.Ja.yAa(this.ZN)}VYf(Q,U,Z=!1){if(Q&&this.bna&&this.Vza)for(Q=H.h(this.$).caa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[Q]);Q.$$mn();){var P=Q.$$cu().cell.getRange();if(Z||!U.contains(P)||1===this.Bua){P=P.toString();const S=m.a.Dc(this.bna,P);if(S){const ja=m.a.Dc(this.Vza,P);this.setBorders(S,ja);delete this.bna[P];delete this.Vza[P]}}}}setBorders(Q,U){var Z=Q.cell;const P=Z.getRange();Z.tcb();P.right!==this.wbb.right&&(Z=new E.Range(P.top,
P.left-1,P.bottom,P.left-1,!0,!1),H.h(this.$).Da.rs(Z).nRa(3));P.bottom!==this.wbb.bottom&&(Z=new E.Range(P.top-1,P.left,P.top-1,P.right,!0,!1),H.h(this.$).Da.rs(Z).nRa(1));if(null===U||void 0===U?0:U.Borders.length){Z={};let X=0;const Y=Array(4),va=Array(4);for(var S=0;4>S;S++)Y[S]=1,va[S]=0;for(var ja of U.Borders)U=ja.BorderPosition,Y[U]=ja.BorderLineStyle,S=new V.a(ja.Color.Red,ja.Color.Green,ja.Color.Blue),va[U]=S.BS(),X|=T.HelperMethods.C4a(ja.BorderPosition);Z.LineStyle=Y;Z.Color=va;ja={};
ja.BorderFormat=Z;ja.Border=X;this.sg.Mxj(Q,ja,P)}}B2b(Q){const U=new E.Range(Math.max(1,Q.top-1),Math.max(1,Q.left-1),Q.bottom+1,Q.right+1,!1,!1);H.h(this.$).MK(U)||this.es&&this.es.Ep||(this.es=I.a.instance.create(()=>{H.h(this.$).Kt(U,60,"DrawBorderBehavior.BringRangeIntoView")},40,L.a.Aoh))}bottomRightCorner(Q,U){return 1048576<=Q||16384<=U?!0:!1}Vd(Q){return D.a(this.$).Vd(Q)}}Object(u.a)(J,"DrawBorderBehavior",null,[2]);a.d(F,"BorderFormatManager",function(){return M});class M{constructor(Q,
U,Z){this.DSb=null;this.hG={};this.sTb=this.Bx=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=Q;this.W7d=M.V7c;this.X7d=M.borderStyleSolidLine;this.sg=U;this.Va=Z;x.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.OU=new J(this.$,this.sg);this.DD=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get OIa(){return this.X7d}get R3(){return this.W7d}get Rta(){return this.sTb}get themesManager(){this.Bx||
(this.Bx=this.$.da.Aa(422));return this.Bx}L9e(Q,U){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${U.command.toString()}`);const Z={},P={};var S=n.a.GH(this.R3,!1);P.Color=[S,S,S,S];this.DD&&this.Rta&&(P.ThemeBorderColor=[this.Rta,this.Rta,this.Rta,this.Rta],P.ColorTypeOption=1);Q=-600086683===U.command?"OutsideBorders":Q[d.a.Jc];P.LineStyle=m.a.Dc(M.mNf,Q);P.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${Q}`):
(S=M.a0a[this.OIa].jye,P.LineStyle=[S,S,S,S],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.OIa}`));S=m.a.wq(M.qVg,Q,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${Q}, the border color selected is ${this.R3}`);Z.BorderFormat=P;4!==S&&8!==S||!this.$.oa.displayRtl||(S=4===S?8:4);Z.ValidMembers=128;Z.Border=S;this.sg.formatCells(-1690267012,
Z,U);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${U.command.toString()}`);return!0}Fkd(Q,U,Z){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${Q.toString()} is being executed, the previous border color is ${this.R3}`);if(this.DD){if((U.SqmControlId||"").includes("ThemeColorPicker")){let P,S;({themeIndex:P,ZBa:S}=this.themesManager.getThemeColor(U.Color)).returnValue?(this.sTb={},this.Rta.ThemeColorIndex=P,this.Rta.ThemeColorRow=S):this.sTb=null}else this.sTb=
null;this.OU.b0a=this.Rta}this.W7d=-1803452024===Q?M.V7c:U.Color;this.OU.borderColor=this.R3;this.nPe(Z);this.$.df();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${Q.toString()} is being executed, the updated border color is ${this.R3}`);return!0}w8h(Q){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const U=this.Va.fq();var Z=this.Va.Ec();U.tc.push(Z);const P=this.Va.bB("StyleDashGallery",1,"Size120by20");Z.buttons.push(P);Z=M.a0a;for(let S in Z){const ja=
S,X=Z[S],Y=r.a.instance.ga(X.u2b);P.lu(ja,-2118943501,"QueryBorderStyle",X.u2b,ja,ja,void 0,void 0,Y)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");Q.MenuItems=U.MC();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}U6h(Q,U){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.OIa}`);Q=Q[d.a.Jc];if(M.Pti(Q))this.X7d=Q,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.OIa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${Q}`),!0;this.OU.borderStyle=this.OIa;this.nPe(U);this.$.df();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.OIa}`);return!0}Jkd(Q){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.GVc(Q,64,this.R3,110,1);return!0}Kkd(Q){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.GVc(Q,112,this.R3,111,2);return!0}Z9e(Q){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.GVc(Q,112,"white",112,3);return!0}B8h(Q){this.pwj(this.sVg,Q,Q.MenuItemId?Q.MenuItemId:M.borderStyleSolidLine)}pwj(Q,U,Z){Z in Q?(Q=Q[Z],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${Z}`),
this.rwj(U,Q)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${Z}' in BorderLineStyleButtons dictionary`)}M8h(Q,U){const Z=Q[d.a.Jc];return"DrawBorder"===Z?this.Jkd(U):"DrawBorderGrid"===Z?this.Kkd(U):"EraseBorder"===Z?this.Z9e(U):this.L9e(Q,U)}vTf(){this.DSb||this.uWg()}rOh(){return new v(this)}get sVg(){this.vTf();return this.DSb}uWg(){this.DSb={};let Q=0;const U=M.a0a;for(let Z in U){const P=U[Z],S=P.kye;r.a.instance.ga(P.u2b);this.DSb[S]=S;this.mcb(S,()=>
appChrome.buildBorderStyleIconNew(P.SLj,P.width,P.mKi,P.lineHeight,P.Kxi));Q++}}mcb(Q,U){if(!(Q in this.hG)){const Z={};U=U();Z[Q]=U;appChrome.api.registerIconProvider(()=>Z);this.hG[Q]=!0}return Q}rwj(Q,U){Q.MenuItemId&&(Q[b.a.On]=Q.MenuItemId===this.OIa,Q[e.a.Icon]=U)}GVc(Q,U,Z,P,S){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.g2g(Q,S)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.OU.E0()):(H.h(this.$).Ez&&this.OU.E0(),h.a.current&&(P=String.format(f.a.Xta,h.a.current.fo(P)),H.h(this.$).yf.gm(P)),this.OU.w2b=U,this.OU.borderColor=Z,H.h(this.$).Ez=!0,this.OU.VFg(Q),this.OU.Bua=S)}nPe(Q){if(Q)switch(this.OU.Bua){case 2:this.Kkd(Q);break;default:this.Jkd(Q)}}g2g(Q,U){return this.OU.Bua===U&&-236759591!==Q.command&&-2118943501!==Q.command?!0:!1}static get a0a(){return M.g6d||(M.g6d={["BorderStyleSolidLine"]:y.sWg(),["BorderStyleDashedLine"]:y.oWg(),["BorderStyleDottedLine"]:y.pWg(),
["BorderStyleMediumLine"]:y.rWg(),["BorderStyleThickLine"]:y.tWg(),["BorderStyleDoubleLine"]:y.qWg()})}static get qVg(){return M.f6d||(M.f6d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get mNf(){return M.Ihe||
(M.Ihe={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:M.Yih,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static Pti(Q){return Q?Q in M.mNf||Q in M.a0a:!1}}M.f6d=null;M.g6d=null;M.Ihe=null;M.V7c="black";M.borderStyleSolidLine="BorderStyleSolidLine";M.Yih=[1,1,1,1];Object(u.a)(M,"BorderFormatManager",null,[317])},838:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{}c.edit="Edit";c.clipboard=
"Clipboard";c.copy="Copy";c.color="Color";c.xTg="AutoFill";c.poj="RowOperations";c.t5g="ColumnOperations";c.a2j="ViewModeRowOperations";c.$1j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.vAj="ShapeStyle";c.tHh="FloatingObjectClipboard";c.jMf="PivotTableCopyDelete";c.lMf="PivotTableFieldListActions";c.wBe="CellFloatie";c.rAj="ShapeFloatie";c.contextMenu="ContextMenu";c.l6h="GridContextMenu";c.I2i="PivotTableContextMenu";c.uHh="FloatingObjectContextMenu";c.m1g=
"CellRTEFloatie";c.n6f="ShapeRTEFloatie";Object(u.a)(c,"FloatieGroupIdentifiers",null,[])},839:function(u,F,a){a.d(F,"a",function(){return m});u=a(0);var c=a(89),b=a(224),e=a(14),f=a(239);F=a(238);var d=a(12),h=a(71),n=a(21);class m extends F.a{constructor(x,r,y){super(r);this.Llc=this.rR=!1;this.Jn=this._selectedRowListBox=this.yOa=null;this.cEf=t=>this.onItemClick(t);this.KDd=t=>{h.g(t.Ca);this.raiseEvent(m.F5a);this.raiseEvent(m.tRd);return!0};this.onScroll=t=>{h.g(t);this.mJd();this.raiseEvent(m.F5a)};
this.onBlur=t=>{h.g(t);this.mJd()};this.onPointerDown=()=>{this.mJd();this.raiseEvent(m.F5a);this.raiseEvent(m.vQa);return!1};this.rGb=t=>{const v=t.Ca;if(v.button===Sys.UI.MouseButton.leftButton||v.button===Sys.UI.MouseButton.rightButton||v.type.includes("touch"))this.Qj=this.acc(v),this.onPointerDown(t);this.raiseEvent(m.xud);return!1};this.jb=x;this.yDb=y;this.LBa(!0)}a$(x){this.get_events().addHandler(m.F5a,x)}Kda(x){this.get_events().removeHandler(m.F5a,x)}d0b(x){this.get_events().addHandler(m.cnd,
x)}Puc(x){this.get_events().removeHandler(m.cnd,x)}Hob(x){this.get_events().addHandler(m.tRd,x)}rKb(x){this.get_events().removeHandler(m.tRd,x)}Fob(x){this.get_events().addHandler(m.vQa,x)}nKb(x){this.get_events().removeHandler(m.vQa,x)}mXc(x){this.get_events().addHandler(m.xud,x)}qMd(x){this.get_events().removeHandler(m.xud,x)}get Qj(){return this._selectedRowListBox}set Qj(x){this.dCa(this._selectedRowListBox);x?(this._selectedRowListBox=x,this.dCa(this._selectedRowListBox),this.Ywc(x)):this._selectedRowListBox=
null}get XV(){return this.yDb.ListCellClass}get i6(){return this.yDb.ListTableClass}get pI(){return 8}get uEb(){return 5}get Klc(){return 24}get Jlc(){return 35}get Lf(){return this.domElement}get $(){return this.jb}dispose(){this.b8(!1);this.LBa(!1);c.a.rc([this.yOa]);this.yOa=null;super.dispose()}acc(x){return d.DOMElementExtensions.Egd(x.target,"tr",!0)}CB(x){if(x){if(!this.Qj){var r=this.Jn;if(!r||!r.rows.length)return;this.Qj=r.rows[0];0<x?x--:x++}r=this.Qj;for(let y=0,t=Math.abs(x);y<t;y++)if(0>
x){if(!r.previousSibling)break;r=r.previousSibling}else{if(!r.nextSibling)break;r=r.nextSibling}r&&(this.Qj=r)}}mob(x,r){d.DOMElementExtensions.toggleCssClass(x,this.yDb.ListTableClassInTouch,r)}b8(x){const r=this.Jn;r&&(x&&!this.Llc?(b.a.instance.sa(e.a.click,r,this.cEf),b.a.instance.sa(e.a.Dk,r,this.KDd),f.a.instance.sa(e.a.pointerDown,r,this.rGb),this.Llc=!0):this.Llc&&(b.a.instance.Ba(e.a.click,r,this.cEf),b.a.instance.Ba(e.a.Dk,r,this.KDd),f.a.instance.Ba(e.a.pointerDown,r,this.rGb),this.Llc=
!1))}dCa(x){let r=null;x&&(r=d.DOMElementExtensions.nk(x,this.yDb.ListCellClass))&&r.classList.toggle(this.yDb.ListCellSelectedClass);return r}LBa(x){this.Lf&&(x&&!this.rR?(this.yOa=this.Ce.$d(this.Lf),this.yOa.la("scroll",this.onScroll),this.yOa.la("blur",this.onBlur),f.a.instance.sa(e.a.pointerDown,this.domElement,this.onPointerDown),this.rR=!0):this.rR&&(c.a.Ia(this.yOa),this.yOa=null,f.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.rR=!1))}onItemClick(x){return this.KDd(x)}Ywc(x){if(x){var r=
x.offsetTop,y=this.Lf.scrollTop;r<y?this.Q0f(!0):r+x.offsetHeight>y+this.Lf.clientHeight&&this.Q0f(!1)}}Q0f(x){this.Lf.scrollTop=x?this.Qj.offsetTop:this.Qj.offsetTop+this.Qj.offsetHeight-this.Lf.clientHeight}mJd(){n.h(this.$).eb&&this.raiseEvent(m.cnd)}}m.F5a="GotFocus";m.cnd="IgnoreBlur";m.tRd="SetCell";m.vQa="PointerDown";m.xud="ItemPointerDown";Object(u.a)(m,"ListBox",F.a,[272,2])},909:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,
f,!0)}}Object(u.a)(b,"IgnoreCaseComparer",null,[253])},910:function(u,F,a){a.d(F,"a",function(){return f});u=a(0);var c=a(24),b=a(11),e=a(175);class f{constructor(d,h){this.Da=d;this.F3a=h}xMb(d,h,n){const m=h.Border;h=h.BorderFormat;let x=0,r=!1;if(0===m)d.cell.tcb(),this.KJb(d.cell.getRange());else{for(let y=0;3>=y;y++)f.FBj(d,n,y,m)&&(x|=b.HelperMethods.C4a(y),this.J0d(d.cell.getRange(),y,h),r=!0);b.HelperMethods.gR(m,16)&&!e.c(d,0,n)&&(x|=2,this.J0d(d.cell.getRange(),0,h),r=!0);b.HelperMethods.gR(m,
32)&&!e.c(d,2,n)&&(x|=4,this.J0d(d.cell.getRange(),2,h),r=!0);r&&(n=d.cell.my.pf,b.HelperMethods.gR(x,2)&&this.A7f(d,n,0)&&(x&=-3),b.HelperMethods.gR(x,1)&&this.z7f(d,n,1)&&(x&=-2),b.HelperMethods.gR(x,4)&&this.A7f(d,n,2)&&(x&=-5),b.HelperMethods.gR(x,8)&&this.z7f(d,n,3)&&(x&=-9),d.cell.setBorders(h,x,!1))}}LQ(d,h){d=f.V_e(d,h);return d.Kz?(d=this.Da.Jja(d))&&d.length?d:null:null}KJb(d){for(let n=0;3>=n;n++){var h=f.V_e(d,n);if(!h.Kz)continue;h=this.Da.Jja(h);if(!h||!h.length)continue;const m=f.q5e(n);
for(let x=0;x<h.length;x++)h[x].nRa(m)}}J0d(d,h,n){if(d=this.LQ(d,h)){var m=f.q5e(h),x=b.HelperMethods.C4a(m);for(let r=0;r<d.length;r++){const y=d[r];this.hki(y,m)&&f.setBorders(y,n,x,h,m)}}}hki(d,h){const n=d.my.pf;var m=d.getRange();m=this.LQ(m,h);let x=!1,r=!1,y=!1,t=!1;m&&(x=f.H7a(m,!0),r=f.H7a(m,!1),t=f.Hrd(m),y=1===m.length?!0:!1);switch(h){case 0:return f.wji(d,n,t,r,y);case 1:return f.tji(d,n,t,x,y);case 2:return f.uji(d,n,t,x,y);case 3:return f.vji(d,n,t,r,y)}return!1}A7f(d,h,n){if(!d.cell.QF)return!1;
const m=d.range,x=this.LQ(m,n),r=e.c(d,n,h);let y=!1;h=0===n?m.top<h.top:m.left<h.left;!f.kBb(d.cell)&&x&&1!==x.length&&(y=(0===n?f.H7a(x,!0):f.H7a(x,!1))?!1:!0);return!r&&y||h?!0:!1}z7f(d,h,n){const m=d.cell,x=this.LQ(m.getRange(),n);d=e.c(d,n,h);h=!1;if(x){const y=f.H7a(x,!0);var r=f.H7a(x,!1);const t=y&&!r;r=r&&!y;1!==n||f.mCb(m)?3!==n||f.aBb(m)||f.MBj(m,x,r,t)&&(h=!0):f.LBj(m,x,y,r)&&(h=!0)}return!d&&h||f.kBb(m)?!0:!1}static nWg(d,h,n){const m={};m.LineStyle=Array(4);m.LineStyle[n]=d.LineStyle[h];
m.Color=Array(4);m.Color[n]=d.Color[h];return m}static Jgf(d,h,n,m,x){return b.HelperMethods.gR(d,x)&&e.c(h,n,m)}static FBj(d,h,n,m){return f.Jgf(m,d,n,h,b.HelperMethods.C4a(n))||f.Jgf(m,d,n,h,64)||112===m}static setBorders(d,h,n,m,x){h=f.nWg(h,m,x);d.setBorders(h,n,!1)}static V_e(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,
d.right+1,d.bottom,d.right+1,!1,!1)}return d}static q5e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static H7a(d,h){for(let n=0;n<d.length;n++){const m=d[n];if(m.QF)return h?f.aBb(m):f.mCb(m)}return!1}static kBb(d){const h=d.my.pf,n=d.getRange();return d.QF&&(n.top<h.top||n.bottom>h.bottom||n.left<h.left||n.right>h.right)?!0:!1}static Hrd(d){for(let h=0;h<d.length;h++)if(f.kBb(d[h]))return!0;return!1}static LBj(d,h,n,m){if(!d.QF){if(!n||f.Hrd(h))return!0}else if(f.aBb(d)&&
(1===h.length&&f.ERg(d,h[0])||!n))return!0;return m}static MBj(d,h,n,m){if(!d.QF){if(!n||f.Hrd(h))return!0}else if(f.mCb(d)&&(1===h.length&&f.FRg(d,h[0])||!n))return!0;return d.wla||m}static wji(d,h,n,m,x){const r=d.getRange();return f.aBb(d)?f.kBb(d)||x:h.top===r.top||!m||n}static tji(d,h,n,m,x){const r=d.getRange();return f.aBb(d)?h.bottom===r.bottom&&x:m&&!n||h.bottom===r.bottom}static uji(d,h,n,m,x){const r=d.getRange();return f.mCb(d)?f.kBb(d)||x:h.left===r.left||!m||n}static vji(d,h,n,m,x){const r=
d.getRange();return d.wla?!1:f.mCb(d)?h.right===r.right&&x:m&&!n||h.right===r.right}static aBb(d){return 0<d.getRange().right-d.getRange().left}static mCb(d){return 0<d.getRange().bottom-d.getRange().top}static FRg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static ERg(d,h){d=d.getRange();h=h.getRange();return d.left===h.left&&d.right===h.right}}Object(u.a)(f,"BorderModelAccessorHelper",null,[])},912:function(u,F,a){a.d(F,"a",function(){return d});u=a(0);var c=a(89);
F=a(95);var b=a(47),e=a(46),f=a(71);class d extends F.a{constructor(h,n){super(n.textBox.domElement);this.KZc=null;this.GLi=()=>{this.nCd()};this.RBf=(m,x)=>{this.jg(m,x)};this.VBf=(m,x)=>{this.uh(m,x)};this.jb=h;this.oJ=n;n.d3&&(n.d3.add(this),n.Yk(this.VBf),n.Rm(this.RBf))}get $(){return this.jb}get Za(){return this.oJ}dispose(){const h=this.oJ;if(null===h||void 0===h?0:h.d3)h.d3.remove(this),h.Gk(this.VBf),h.em(this.RBf);c.a.Ia(this.KZc);this.oJ=null;super.dispose()}Zh(h,n){switch(n){case -1470715894:case -1231471547:this.aZ(!1);
break;default:if(this.QId(h,n))return f.g(h),!0;d.mpi(n)||this.aZ(!1)}return!1}aZ(){c.a.Ia(this.KZc);this.KZc=b.a.instance.create(this.GLi,10,e.a.Rxi)}uh(){this.aZ(!1)}static mpi(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(u.a)(d,"ListAutoCompleteBehavior",F.a,[276,2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/e7a3a4a685882ceaf41608be852e8e2b/EwaDSEsNext.kpae.js.map