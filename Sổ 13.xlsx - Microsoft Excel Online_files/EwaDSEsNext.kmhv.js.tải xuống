'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1050:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1051:function(u,F,a){a.d(F,"a",function(){return h});u=a(0);var c=a(15),b=a(84);F=a(146);var e=a(4),f=a(45),d=a(30);class h extends F.a{constructor(n,m,x,r,y,t,v=null){super();this.sJ=null;this.La=m;this.TX=r;this.Oga=t;this.ob=n;this.dt=y;this.ef=x;this.njb=this.ob.qa("SaveToHostWithExtraCharsInFileName");this.Nh=v;this.pc(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.ef}sMe(n,m){this.GL(1,!!n&&n!==m);this.sJ=document.getElementById(h.hXe);f.a.addHandler(this.sJ,"change",Object(b.a)(this,
this.lpc,"onFileNameChange"));f.a.addHandler(this.sJ,"input",Object(b.a)(this,this.lpc,"onFileNameChange"));this.sJ.focus()}hac(n){return this.njb?(new RegExp("["+this.P9b('\\/:*?"<>|')+"]")).test(n):(new RegExp("["+this.P9b('\\/:*?"<>|#{}%~&')+"]")).test(n)}P9b(n){return n.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Nkd(){const n=d.a.Pq(e.AFrameworkApplication.sm.sn);this.GL(1,!!this.sJ&&""!==this.sJ.value&&this.sJ.value!==n)}lpc(){this.sJ&&window.setTimeout(()=>{this.Nkd()},0)}gac(n,m){if(1!==
n)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{n=m[h.hXe];m=h.PKf in m?m[h.PKf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.Mtc(n),m);const x=d.a.H4(e.AFrameworkApplication.fileName);(n=n?n.trim():null)&&""!==n&&""!==x||1===this.ta.state?this.hac(n)?this.dt.create().displayError(1,n,m):this.Oga.zoa(n+x,m,this.Nh):this.dt.create().displayError(2,n,m)}}dispose(){this.sJ&&
(f.a.removeHandler(this.sJ,"change",Object(b.a)(this,this.lpc,"onFileNameChange")),f.a.removeHandler(this.sJ,"input",Object(b.a)(this,this.lpc,"onFileNameChange")),this.sJ=null);super.dispose()}}h.hXe="txtFileName";h.PKf="chkOverwrite";Object(u.a)(h,"FileNameDialogBase",F.a,[])},1052:function(u,F,a){a.d(F,"a",function(){return r});u=a(0);var c=a(15),b=a(157),e=a(84),f=a(4),d=a(642),h=a(836),n=a(377),m=a(106),x=a(25);class r{constructor(y,t,v,w){this.HXb=null;this.YBg=y;this.ob=v;this.yge=t;this.eee=
new b.a;this.Ch=w}y8a(){return this.ob.qa("SaveToCloudStorageUIIsEnabled")}K_e(){return x.a.saveToCloudStorage}d3b(){n.a.UKd(Object(e.a)(this,this.d0f,"saveToCloudActionDispatcher"));n.a.v$c([new h.a(x.a.saveToCloudStorage,m.a.frame,0)],this.yge.g5a())}Ig(){const y=this.yge.g5a();y?(y.b$(()=>{this.eee.setResult(!0)}),this.d3b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}mSf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}d0f(y,
t,v,w,C){return t.contextId!==m.a.frame||y!==this.K_e()?2:this.y8a()?1===v?d.SessionStatusManager.instance.W5a||f.AFrameworkApplication.x5?8:32:2===v?(this.mSf(),C&&C.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ch&&(this.HXb=this.Ch.Bc("DialogShown","SaveToOneDriveReponseTime")),this.eee.task.continueWith(()=>{this.HXb&&(this.HXb.stop(),this.HXb=null);this.YBg.start(C)}),32):8:8}}Object(u.a)(r,"SaveToCloudStorageActor",null,[426])},
1053:function(u,F,a){a.d(F,"a",function(){return y});u=a(0);var c=a(15),b=a(84),e=a(1054),f=a(4),d=a(41),h=a(39),n=a(240),m=a(376),x=a(164),r=a(768);class y{constructor(t,v,w,C,B){this.c9=this.Nm=this.yDa=null;this.iEa=!1;this.Nh=this.Nga=null;this.LUc=t;this.Wlb=v;this.dt=w;this.ef=C;this.Ch=B}$Nb(){this.ef&&1===this.ef.state||(this.Nm=this.Wlb(),this.Nm.message=CommonUIStrings.l_CommentProgressTooltip,this.Nm.Rb=5,this.Nm.Lt=!1,this.Nm.BBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}vJa(){this.Nm&&
(this.Nm.close(),this.Nm=null)}uS(){1!==f.AFrameworkApplication.ta.state&&this.dt().displayError(e.a.default)}dRa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.lf(this.c9,h.a.IX(3),void 0,"UploadToCloudManager.RedirectToFolder")}cRa(t){let v=!1,w=!1;f.AFrameworkApplication.fa&&(v=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),w=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
t,v);if(v&&w){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const C={};C[m.a.YQa]="1";C[m.a.documentUrl]=t;f.AFrameworkApplication.pV().execute(B=>{B.Rj(x.a.tua,C)})}else h.a.lf(t,h.a.IX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}zoa(t,v,w=null,C=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ch&&(this.Nga=this.Ch.Bc("DialogShown","SaveToOneDriveUploadTime"));this.$Nb();this.c9=v;this.yDa=this.LUc.create(t,
w,C);this.Nh=C;this.BQ()}BQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.yDa.execute(Object(b.a)(this,this.wWi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.vWi,"onSaveToCloudUploadFailed"))}wWi(t){this.vJa();this.iEa=!1;if(t&&t.data&&t.data.ve){var v;if(({Ft:v}=d.d(t.data.ve)).returnValue)if(t=v,t.StatusCode!==n.a.nP&&t.StatusCode!==n.a.Xsb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.uS();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.cRa(t.NewDocumentUrl):this.dRa()}catch(w){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",w.toString())}this.VHb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:r.a.hgb(t.data.ve)}),this.uS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.uS()}vWi(t){5!==t.data.status&&12!==t.data.status||
this.iEa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",t.data.status),this.vJa(),this.uS(),this.VHb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.iEa=!0,this.BQ())}VHb(){this.Nga&&(this.Nga.stop(),this.Nga=null)}}Object(u.a)(y,"UploadToCloudManager",null,[314])},1054:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{}c.default=0;Object(u.a)(c,"SaveToCloudErrorCodes",null,[])},1055:function(u,F,a){a.d(F,"a",
function(){return d});u=a(0);var c=a(15),b=a(84),e=a(1054),f=a(82);class d{constructor(h,n,m,x,r,y){this.Nh=null;this.QCg=h;this.v2=n;this.qnb=m;this.ob=x;this.tSb=r;this.dt=y}start(h){this.Nh=h;if("SharePointOnlineConsumer"===this.ob.Xa("FileSource")){const n=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(n){n.start(null,h);return}}this.v2.ZMa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.r_g()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.QCg.create().uQ()}vj(){this.dt().displayError(e.a.default)}r_g(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let h={["client_id"]:this.ob.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.tSb||2===this.tSb)h={["client_id"]:this.ob.appSettings.UploadToSkyDriveClientId};WL.init(h);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.J6,"onFailure"))}catch(h){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",h,h.stack),this.vj()}}onSuccess(h){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");h&&h.data&&h.data.folders&&this.qnb.zoa(h.data.folders[0].id,h.data.folders[0].urls.viewInBrowser,null,this.Nh)}J6(h){if(h&&
h.error){if("user_canceled"===h.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",h.error.code,h.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vj()}}Object(u.a)(d,"SaveToCloudManager",null,[427])},1056:function(u,F,a){a.d(F,"a",function(){return f});u=a(0);var c=a(15),b=a(39),e=a(80);a=a(707);class f extends a.a{constructor(d,
h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.tya;this.Bwa=!0}get linkText(){return f.Ctf}Ema(d){super.Ema(d);b.a.openWindow(4,e.a.MH(f.Btf))}KD(d){super.KD(d);f.Txd&&f.Txd(null)}static initialize(d,h,n,m){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.tya=d;f.Ctf=h;f.Btf=n;f.Txd=m}}f.tya=null;f.Ctf=null;f.Btf=null;f.Txd=null;Object(u.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1057:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{}c.$sh="ewa-bb";c.ath="ewa-bb-entry";c.bth="ewa-bb-react";c.XQe="ewa-bb-entry-body";c.cRe="ewa-bb-icon";c.ZQe="ewa-bb-entry-icon";c.bRe="ewa-bb-entry-title";c.aRe="ewa-bb-entry-message";c.X9b="ewa-bb-entry-button";c.$Qe="ewa-bb-entry-link";c.YQe="ewa-bb-entry-close";c.Y9b="ewa-bb-entry-button-holder";c.WQe="ewa-bb-content";Object(u.a)(c,"CssClassNames",null,[])},1058:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);
a=a(707);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.Bpa;this.message=c.ypa}get actionButton(){return c.xpa}Zm(b){super.Zm(b);(b=c.zpa)&&b(null)}static initialize(b,e,f,d){c.Bpa=b;c.ypa=e;c.xpa=f;c.zpa=d}}c.Bpa=null;c.ypa=null;c.xpa=null;c.zpa=null;Object(u.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1059:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);a=a(707);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.Bpa;this.message=
c.ypa}get actionButton(){return c.xpa}Zm(b){super.Zm(b);(b=c.zpa)&&b(null)}static initialize(b,e,f,d){c.Bpa=b;c.ypa=e;c.xpa=f;c.zpa=d}}c.Bpa=null;c.ypa=null;c.xpa=null;c.zpa=null;Object(u.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1060:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);a=a(707);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.Bpa;this.message=c.ypa}get actionButton(){return c.xpa}Zm(b){super.Zm(b);(b=c.zpa)&&b(null)}static initialize(b,
e,f,d){c.Bpa=b;c.ypa=e;c.xpa=f;c.zpa=d}}c.Bpa=null;c.ypa=null;c.xpa=null;c.zpa=null;Object(u.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1061:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);a=a(707);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.mEb;this.message=c.tya}get actionButton(){return c.F9a}Zm(b){super.Zm(b);c.vya&&c.vya(null)}static initialize(b,e,f,d){c.mEb=b;c.tya=e;c.F9a=f;c.vya=d}}c.mEb=null;c.tya=null;c.F9a=null;c.vya=null;Object(u.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1062:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);a=a(707);class c extends a.a{constructor(b,e){super(b,e);c.F9a&&c.vya&&(this.zs=!0);this.title=c.mEb;this.message=c.tya}get actionButton(){return c.F9a}Zm(b){super.Zm(b);c.vya&&c.vya(null)}static initialize(b,e,f,d){c.mEb=b;c.tya=e;c.F9a=f;c.vya=d}}c.mEb=null;c.tya=null;c.F9a=null;c.vya=null;Object(u.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1064:function(u,
F,a){a.d(F,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.ohb=function(){function b(){return m()&&(B()||3<=(v()?z("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(){qa||(qa=!0,za=h("Windows Phone"))}function h(wa){wa=(new RegExp(wa+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var db=-1;return null!=wa&&2<=wa.length&&(db=parseFloat(wa[1]),
isNaN(db)&&(db=-1)),db}function n(){return"function"==typeof navigator.msLaunchUri&&!f()&&!C()&&!x()}function m(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function x(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function r(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function y(){return r()?8==window.document.documentMode:!1}function t(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function v(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function w(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function C(){var wa=window.navigator.userAgent.toLowerCase();return 0<=wa.indexOf("android")&&0<=wa.indexOf("chrome")}function B(){return 3<=(t()?z("firefox/"):0)}function z(wa){var db=window.navigator.userAgent.toLowerCase(),Jb=db.indexOf(wa),Pb,eb;return 0<=Jb?(Pb=Jb+wa.length,eb=db.length,parseInt(db.substring(Pb,eb))):0}function A(wa,db,Jb,Pb,eb){if(Pb&&null!=db)db();
else if(n())navigator.msLaunchUri(wa,db,Jb);else if(!(w()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&m())||x())I(wa,db,Jb);else if(w()&&eb)a:{try{window.open(wa,"_self")}catch(Ma){null!=Jb&&Jb();break a}null!=db&&db()}else E(wa,db,Jb)}function E(wa,db,Jb){var Pb=document.getElementById("OICLinkTag"),eb;null==Pb&&(Pb=document.createElement("a"),Pb.id="OICLinkTag",Pb.style.visibility="hidden",Pb.href="",Pb.target=0==(xb.Options&
ua.SupportsTopTargetNavigation)||xb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Pb),null!=Pb.addEventListener&&Pb.addEventListener("click",function(Ma){null!=Ma.stopPropagation&&Ma.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(eb=function(Ma){var ob=document.createEvent("MouseEvent");return ob.initMouseEvent(Ma,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),ob},eb.prototype=Event.prototype,window.MouseEvent=eb),Pb.href=wa,Pb.dispatchEvent(new MouseEvent("click"))}catch(Ma){null!=
Jb&&Jb();return}null!=db&&db()}function I(wa,db,Jb){var Pb=document.getElementById("OICFrame");null==Pb&&(Pb=document.createElement("iframe"),Pb.className="ObjectInDialog",Pb.style.visibility="hidden",Pb.src="about:blank",document.body.appendChild(Pb),Pb.id="OICFrame");try{Pb.contentWindow.location.href=wa}catch(eb){null!=Jb&&Jb();return}null!=db&&db()}function L(wa){return 0!=(wa.Options&ua.SkipProtocolHandler)||y()}function V(wa){return wa===Na.ReadOnly||wa===Na.ReadWrite}function T(wa,db,Jb,Pb){var eb,
Ma;try{if(eb=new ActiveXObject(lb),eb)return Ma=eb.ViewDocument3(window.self,wa,db,Pb),Ma?(N(ha.O14ActiveX),Xa.None):Xa.Failed}catch(ob){}if(ua.O14Only===(Jb&ua.O14Only))return xb.DescriptiveUnattemptedEnums?Xa.O14AttemptFailure:Xa.Unattempted;try{if(eb=new ActiveXObject(Aa),eb)return Ma=eb.ViewDocument3(window.self,wa,db,Pb),Ma?(N(ha.O12ActiveX),Xa.None):Xa.Failed}catch(ob){}if(ua.O12UpOnly===(Jb&ua.O12UpOnly))return xb.DescriptiveUnattemptedEnums?Xa.O12UpOnlyFail:Xa.Unattempted;try{if(eb=new ActiveXObject(da),
eb)return Ma=V(db)?eb.ViewDocument2(window.self,wa,Pb):eb.EditDocument2(window.self,wa,Pb),Ma?(N(ha.O11ActiveX),Xa.None):Xa.Failed}catch(ob){}return xb.DescriptiveUnattemptedEnums?Xa.ActiveXUnattempted:Xa.Unattempted}function H(wa,db,Jb,Pb,eb){var Ma,ob,Ia;wa==ta.Visio&&Jb==Na.ReadWrite&&(Jb=Na.WriteOnly);wa=eb;(Pb=Pb||f()&&!(d(),8<=za))||(Ma="",Ma+=V(Jb)?La+Ea:ca,Ma+=$a,wa+=G(Ma));wa+=G(db);xb.NewTelemetryDataIsEnabled&&(ob=xb.SessionOrigin?"|or|"+xb.SessionOrigin:"",ob+=xb.ClickTime?"|ct|"+xb.ClickTime:
"",ob+=xb.CorrelationId?"|cid|"+xb.CorrelationId:"",wa+=G(ob),xb.CorrelationIdForWinClient&&(wa+=G(xb.CorrelationIdForWinClient)));db=window.location.href;Jb=Va;Pb=db.toLowerCase().indexOf("&"+Jb+"=");var Da;Jb=-1==Pb?void 0:(Ia=Pb+(Jb.length+2),Da=db.indexOf("&",Ia),-1==Da)?db.substr(Ia):db.substring(Ia,Da);if(null!=Jb&&"undefined"!=typeof Jb){Ia="";try{Ia=decodeURIComponent(Jb)}catch(nb){}0<Ia.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ia)&&(wa+=Qa,wa+=Ia)}return wa}
function D(wa,db,Jb,Pb,eb,Ma){var ob=X(wa),Ia;return null==ob?(ea(xb.DescriptiveUnattemptedEnums?Xa.ProtocolHandlerIsNull:Xa.Unattempted,xb.Application),!1):(Ia=H(wa,db,Jb,Pb,ob),A(Ia,J,M,eb,Ma),!0)}function G(wa){if(m()&&w()){var db="";try{db=decodeURI(wa)}catch(Jb){}if(db==wa)return encodeURI(wa)}return wa}function J(){N(ha.ProtocolHandler)}function M(){xb.Options|=ua.SkipProtocolHandler;va(xb,fc,dc)}function Q(){null!=wb&&wb(ha.RoamingProtocolHandler)}function U(){null!=Tb&&Tb(Xa.ControlNeeded)}
function Z(){var wa=document.getElementById(Pa),db;if(null==wa){if(db=aa,m()&&3<=(v()?z("version/"):0)&&P(fa,!0)&&(db=fa),!P(db,!0))if(m()&&P(ka,!0))db=ka;else return null;wa=document.createElement("object");wa.id=Pa;wa.type=db;wa.style.width="0px";wa.style.height="0px";wa.style.setProperty("visibility","hidden","");document.body.appendChild(wa);wa=document.getElementById(Pa)}return wa}function P(wa,db){var Jb=window.navigator.mimeTypes,Pb;return null==Jb?!1:(Pb=Jb[wa],Pb)?db&&!Pb.enabledPlugin?!1:
!0:!1}function S(wa){try{if(null!=new ActiveXObject(wa))return!0}catch(db){}return!1}function ja(wa){switch(wa){case ta.OneNote:return oa;default:return""}}function X(wa){if(wa!=ta.OneNote&&f()&&!(d(),8<=za))return"office:";switch(wa){case ta.Excel:return"ms-excel:";case ta.OneNote:return"onenote:";case ta.PowerPoint:return"ms-powerpoint:";case ta.Visio:return"ms-visio:";case ta.Word:return"ms-word:";case ta.Project:return"ms-project:";case ta.Publisher:return"ms-publisher:";case ta.Infopath:return"ms-infopath:";
case ta.Access:return"ms-access:";default:return""}}function Y(wa){switch(wa){case ta.Excel:return"root\\office15\\excel.exe";case ta.PowerPoint:return"root\\office15\\powerpnt.exe";case ta.Visio:return"root\\office15\\visio.exe";case ta.Word:return"root\\office15\\winword.exe";case ta.Project:return"root\\office15\\winproj.exe";case ta.Publisher:return"root\\office15\\mspub.exe";case ta.Infopath:return"root\\office15\\infopath.exe";case ta.Access:return"root\\office15\\msaccess.exe";default:return null}}
function va(wa,db,Jb){if(xb=wa,fc=db,dc=Jb,wa.DocumentUrl){var Pb=Jb=db=wa.DocumentUrl;try{Pb=decodeURIComponent(wa.DocumentUrl)}catch(nb){}try{Jb=encodeURI(wa.DocumentUrl)}catch(nb){}xb.NewTelemetryDataIsEnabled||(db=db+""+wa.CorrelationIdForWinClient,Pb+=wa.CorrelationIdForWinClient,Jb+=wa.CorrelationIdForWinClient);wa.Mode===Na.ReadWrite&&ua.CheckoutRequired===(wa.Options&ua.CheckoutRequired)&&(wa.Mode=Na.ForceCheckout);ua.HostIsEditOnly===(wa.Options&ua.HostIsEditOnly)&&(wa.Mode=Na.WriteOnly);
if(L(wa)?0:m()&&(wa.Application==ta.OneNote||P(Oa,!1)||P(ba,!1))||n()||C()||!(b()||B()||"ActiveXObject"in window&&!f()||w())||15<=Ca())D(wa.Application,wa.EncodeUrl?Jb:db,wa.Mode,wa.Application==ta.OneNote,wa.SilentExternalHandler,wa.NavigateUsingWindowOpen);else{var eb;if(eb=y())a:{var Ma=wa.EncodeUrl?db:Pb,ob=wa.Mode,Ia=ja(wa.Application);try{eb=(new ActiveXObject(Ra)).ViewDocument3(window.self,Ma,ob,Ia);break a}catch(nb){}eb=!1}if(eb)N(ha.O15ActiveX);else{if(b()||B()){var Da=wa.EncodeUrl?db:Pb;
Pb=wa.Mode;eb=ja(wa.Application);Ma=Z();if(null==Ma)Da=xb.DescriptiveUnattemptedEnums?Xa.PluginIsNull:Xa.Unattempted;else{ob=!1;try{ob=Ma.ViewDocument3(window.self,Da,Pb,eb)}catch(nb){}if(!ob)try{ob=V(Pb)?Ma.ViewDocument2(window.self,Da,eb):Ma.EditDocument2(window.self,Da,eb)}catch(nb){}Da=ob?(N(ha.NpapiPlugin),Xa.None):Xa.Failed}}else{try{Da=new ActiveXObject(Fa),null!=Da&&Da.SaveSSOCreds()}catch(nb){}Da=T(wa.EncodeUrl?db:Pb,wa.Mode,wa.Options,ja(wa.Application))}if(Da!=Xa.None){if(Pb=wa.CouldUseRoamingApps)cb||
(cb=!0,jb=h("Windows NT")),Pb=6.1<=jb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(r()||B()||w());if(Pb&&wa.Application!=ta.OneNote){if(!c.ohb.q4j()){ea(Xa.ControlNeeded,xb.Application);return}if(wa.RoamingAppsLauncher){"undefined"==typeof wa.RoamingAppsLauncher||null==wa.RoamingAppsLauncher?ea(xb.DescriptiveUnattemptedEnums?Xa.RoamingLauncherIsNull:Xa.Unattempted,xb.Application):"undefined"==typeof wa.RoamingBitsUrl||null==wa.RoamingBitsUrl?c.ohb.B4j(wa.DocumentUrl,wa.RoamingAppsLauncher,
wa.Application,wa.ApplicationParameters,fc,dc):c.ohb.Uog(wa.DocumentUrl,wa.RoamingAppsLauncher,wa.RoamingApplicationExe,wa.ApplicationParameters,wa.RoamingPlatform,wa.RoamingBitsUrl,fc,dc);return}if(!wa.ContinueIfLauncherIsNull){ea(Xa.LauncherNeeded,xb.Application);return}}ua.NoProtocolHandlerFallback==(wa.Options&ua.NoProtocolHandlerFallback)||L(wa)||r()||m()&&!(xb.DescriptiveUnattemptedEnums?Da>=Xa.O14Unattempted&&Da<=Xa.DocumentUrlIsNull:Da==Xa.Unattempted)?ea(Da,xb.Application):D(wa.Application,
wa.EncodeUrl?Jb:db,wa.Mode,wa.Application==ta.OneNote,wa.SilentExternalHandler,wa.NavigateUsingWindowOpen)}}}}else ea(xb.DescriptiveUnattemptedEnums?Xa.DocumentUrlIsNull:Xa.Unattempted,xb.Application)}function N(wa){null!=fc&&fc(wa)}function ea(wa,db){"undefined"==typeof db&&(db=null);null!=dc&&dc(wa,db)}function Ca(){var wa=0;if(b()||B()||w()){var db=Z();try{null!=db&&(wa=db.GetOfficeVersion())}catch(Jb){}}else S(Ra)?wa=15:S(lb)?wa=14:S(Aa)?wa=12:S(da)&&(wa=11);return wa}function la(){return m()&&
(P(aa,!0)||P(fa,!0))}var Ra="SharePoint.OpenDocuments.5",lb="SharePoint.OpenDocuments.4",Aa="SharePoint.OpenDocuments.3",da="SharePoint.OpenDocuments.2",aa="application/x-sharepoint",fa="application/x-sharepoint-webkit",Oa="application/x-sharepoint-protocolhandler",ba="application/x-sharepoint-webkit-protocolhandler",ka="application/officelive",Pa="npSharePointPlugin",Fa="IDBHO.IDBHOCtrl",oa="OneNote.Notebook",La="ofv|",Ea="ofc|",ca="ofe|",$a="u|",Qa="|f|",Va="wdlor",fb="",Ka="",hb="",fc,dc,wb,Tb,
xb,cb,jb,qa,za,Na={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ua={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Xa={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
ha={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},ta={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Na,OpenDocumentOptions:ua,OpenDocumentFailureType:Xa,OpenDocumentControl:ha,OfficeApplication:ta,EditDocumentInClient:va,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=ta.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Ca,
IsO14MacPluginInstalled:la,OfferOfficeInDialog:function(){return e()&&11>=Ca()},OfferOfficeNoIntrusive:function(){return e()&&15>Ca()},OfferMacOffice:function(){return m()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!la()},InstallRoamingControl:function(){t()?window.InstallTrigger.install({Office:{URL:Ka}}):I(hb,null,null)},CanUseRoamingControl:function(){var wa,db,Jb;if(n())return!0;if(w())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(t())return wa=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(wa),db=document.createEvent("Events"),db.initEvent("RoamingOfficeInstalled",!0,!1),wa.dispatchEvent(db),!!wa.getAttribute("installed");if(r())try{return Jb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Jb.HrExists()}catch(Pb){}return!1},InitUrls:function(wa,db,Jb){fb=wa;Ka=Jb;hb=db},LaunchRoamingApps:function(wa,db,Jb,Pb,eb,Ma){c.ohb.Uog(wa,db,Y(Jb),Pb,"x86",fb,eb,Ma)},LaunchRoamingApps2:function(wa,
db,Jb,Pb,eb,Ma,ob,Ia){var Da="",nb;if(null!=Pb&&(Da+=" "+Pb),null!=wa&&(Da+=' "'+wa+'"'),n()||w())wb=ob,Tb=Ia,ob='office: "'+(Ma+'" "')+(Jb+'" "ROAMING"'),ob+=' "'+db+'"',ob+=' "'+eb+'"',ob+=" "+Da,A(ob,Q,U,!1,!1);else if(t())wa=document.createElement("RoamingExtensionElement"),wa.setAttribute("cabUrl",Ma),wa.setAttribute("app",Jb),wa.setAttribute("licensingEntitlements",db),wa.setAttribute("platform",eb),wa.setAttribute("args",Da),document.documentElement.appendChild(wa),db=document.createEvent("Events"),
db.initEvent("RoamingOfficeLaunch",!0,!1),wa.dispatchEvent(db),null!=ob&&ob(ha.RoamingFFExtension);else if(r()){if(nb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=nb)try{nb.HrConfigureSingle(Ma,Jb,db,eb,Da),null!=ob&&ob(ha.RoamingActiveX)}catch(Ua){}}else null!=Ia&&Ia(Xa.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:E,OpenDocumentWithProtocolHandler:D,OpenDocumentWithProtocolHandlerNoCallBack:function(wa,db,Jb,Pb){var eb=X(wa),Ma;return null==eb?
(ea(xb.DescriptiveUnattemptedEnums?Xa.ProtocolHandlerNoCallbackIsNull:Xa.Unattempted,xb.Application),!1):(Ma=H(wa,db,Jb,Pb,eb),A(Ma,null,null,!1,!1),!0)}}}();c.ClientUtils=c.ohb},1065:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);var c=a(39);class b{constructor(e,f){this._url=e;this.Wzg=f}Cwe(){}Z8c(){this.Wzg?c.a.downloadFile(this._url):c.a.lf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,[275,
2])},1066:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1067:function(u,F,a){a.d(F,"a",function(){return d});u=a(0);var c=a(1195),b=a(4),e=a(54),f=a(82);class d{constructor(h,n,m,x,r,y){this.mY=h;this.nY=n;this.$Lc=m;this.rE=x;this.KTb=r;this.VVa=y}get R8f(){return!this.nY&&!this.$Lc}get jyf(){return 2===this.VVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get wQe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Zcf(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Hwa(){return CommonUIStrings.l_OICErrorHelpLink}get Abf(){return"OICFailure"}get icon(){return 3}get LZb(){return 2===
this.VVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Pl(){return CommonUIStrings.l_DefaultDialogTitle}L$i(h){this.Gyf(h)}txi(h){this.Gyf(h)}Gyf(h){let n=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").vlc(this.VVa),n=3):2===h&&((!this.$Lc||this.$Lc(this.rE))&&this.nY&&c.a.instance.Hdh(this.nY,this.mY,this.rE),n=5);(0===h||1===h)&&this.mY&&this.mY(this.rE);b.AFrameworkApplication.yvc(e.a.pKf,this.KTb,n);this.dispose()}dispose(){this.rE=
this.nY=this.mY=null}}Object(u.a)(d,"AOICErrorDialogWithTrial",null,[2])},1068:function(u,F,a){a.d(F,"a",function(){return d});u=a(0);var c=a(1359),b=a(4),e=a(41),f=a(80);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}VQd(){return e.c([this.Vaa(),this])}execute(h,n,m){let x="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(x=f.a.Bl(x,"wdEnableRoaming","1"));b.AFrameworkApplication.zd.Pm(x,2,this.VQd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.Jxb(),h,n,m,void 0,void 0,void 0,void 0,"6")}}Object(u.a)(d,"ARoamingAppsRequest",null,[])},1069:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1070:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1071:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1077:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.ioi=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.jUa=(e.DirectPrintSupportedMimeTypes||
"").split(b.D8c);this.kUa=(e.DirectPrintSupportedPlugins||"").split(b.D8c);this.xci=(e.DirectPrintImmersivePreviewPlugins||"").split(b.D8c);this.Thf=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.Nki=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.U2g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Azd=14;this.Dvf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.Azd=parseInt(f[0]),this.Dvf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.D8c=",";Object(u.a)(b,"DirectPrintBrsSettings",null,[])},1078:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(u.a)(c,"PrintPreviewPaneProps",null,[])},1142:function(u,F,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1342),h=a(694),n=a(49),m=a(37),x=a(1),r=a(902),y=a(66),t=a(40),v=a(184),w=a(21),C=a(375),B=a(573);class z{constructor(Ha,Ab){this.iId=0;this.Kae=!1;this.rA=Ha;this.ignorePrintArea=Ab}get rA(){return this.iId}set rA(Ha){0<=Ha&&2>=Ha?this.iId=Ha:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.iId=1)}get ignorePrintArea(){return this.Kae}set ignorePrintArea(Ha){Ha||!Ha?this.Kae=Ha:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(z,"PdfPrintDialogBrowserSessionState",null,[]);var A=a(7),E=a(134),I=a(171),L=a(98),V=a(1397);class T{constructor(Ha,Ab){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Ha;this.addToPrintArea=Ab}}Object(b.a)(T,"MacroRecorderPrintAreaSetPayload",null,[108]);var H=a(374),D=a(188),G=a(11),J=a(13),M=a(281),Q=
a(64);class U{constructor(Ha){this.sharedSheetCell=null;this.sharedSheetCell=Ha}}Object(b.a)(U,"MacroRecorderPageBreakInsertedPayload",null,[108]);class Z{constructor(Ha){this.sharedSheetCell=null;this.sharedSheetCell=Ha}}Object(b.a)(Z,"MacroRecorderPageBreakRemovedPayload",null,[108]);class P{constructor(Ha){this.sheetName=null;this.sheetName=Ha}getSheetName(){return this.sheetName}}Object(b.a)(P,"MacroRecorderPageBreaksAllResetPayload",null,[108]);class S{constructor(Ha){this.sheetName=null;this.sheetName=
Ha}getSheetName(){return this.sheetName}}Object(b.a)(S,"MacroRecorderPrintAreaClearedPayload",null,[108]);var ja=a(60);const X=(Ha,Ab,Yb,Bb,Qb,sc,kb,Eb=null)=>{Eb=Ha.Na(9,Eb);Eb.sheetName=Ab;Eb.printSettings=Yb;return ja.g(Ha,"SetSheetPrintSettings",Eb,Bb,Qb,sc,kb,0)},Y=(Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=Ha.Na(1,kb);kb.ConvertInParameters=Ab;return ja.g(Ha,"ConvertWorkbookToPrintPdf",kb,Yb,Bb,Qb,sc,4)},va=(Ha,Ab,Yb,Bb,Qb,sc,kb,Eb=null)=>{Eb=Ha.Na(1,Eb);Eb.sheetName=Ab;Eb.printOptions=Yb;return ja.g(Ha,
"SetPrintOptions",Eb,Bb,Qb,sc,kb,0)},N=(Ha,Ab,Yb,Bb,Qb,sc,kb,Eb=null)=>{Eb=Ha.Na(1,Eb);Eb.sheetName=Ab;Eb.locale=Yb;return ja.g(Ha,"GetPrintSettings",Eb,Bb,Qb,sc,kb,4)},ea=(Ha,Ab,Yb,Bb,Qb,sc,kb,Eb=null)=>{Eb=Ha.Na(1,Eb);Eb.selectedRanges=Ab;Eb.addToPrintArea=Yb;return ja.g(Ha,"SetPrintArea",Eb,Bb,Qb,sc,kb,0)},Ca=(Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=Ha.Na(1,kb);kb.sheetName=Ab;return ja.g(Ha,"ClearPrintArea",kb,Yb,Bb,Qb,sc,0)},la=(Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=Ha.Na(9,kb);kb.sheetCell=Ab;return ja.g(Ha,
"InsertPageBreak",kb,Yb,Bb,Qb,sc,0)},Ra=(Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=Ha.Na(9,kb);kb.sheetCell=Ab;return ja.g(Ha,"RemovePageBreak",kb,Yb,Bb,Qb,sc,0)},lb=(Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=Ha.Na(9,kb);kb.sheetName=Ab;return ja.g(Ha,"ResetAllPageBreaks",kb,Yb,Bb,Qb,sc,0)};var Aa=a(124),da=a(112),aa=a(51),fa=a(189);class Oa{constructor(){this.Col=this.Row=null}}Object(b.a)(Oa,"PageBreaksInformation",null,[]);class ba{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(ba,"RowColBreak",null,[]);
class ka{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(ka,"SharedRange",null,[]);var Pa=a(177),Fa=a(55);class oa{constructor(Ha){this.ribbonCommandInfo=this.mHb=null;this.VRj=(Ab,Yb,Bb)=>{Yb=!!Ab&&!!Ab.RequestTelemetryData;w.h(this.$).Eh&&w.h(this.$).Eh.Yla(this.OLa.na(this.ribbonCommandInfo.command),Ab.StateId,Yb?Ab.RequestTelemetryData.EcsOperationDuration:0,Yb?Ab.RequestTelemetryData.EcsRequestDuration:0,Yb?Ab.RequestTelemetryData.WfeRequestDuration:0);
G.HelperMethods.v_&&this.W1g(Bb)};this.$=Ha;this.OLa=new Pa.a;this.rwa=new Pa.a;this.rwa.add(78661008,12);this.rwa.add(275604654,13);this.rwa.add(-13332329,14);this.rwa.add(-837651977,9);this.rwa.add(-1778266776,10);this.rwa.add(845325699,11)}executeCommand(Ha,Ab,Yb,Bb,Qb=null,sc=null,kb=null){this.ribbonCommandInfo=Ab;this.aKj(Ab.command);Ha=M.b(Qb,this.VRj);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Ab.command} command execution started`);switch(Ab.command){case 78661008:return this.U$e(Ab,
Ha,sc,kb,!1);case 275604654:return this.U$e(Ab,Ha,sc,kb,!0);case -13332329:return this.S9e(Ab,Ha,sc,kb);case -837651977:return this.U7h(Ab,Ha,sc,kb);case -1778266776:return this.R8h(Ab,Ha,sc,kb);case 845325699:return this.P$e(Ab,Ha,sc,kb)}return v.a(Ab.command)}wc(Ha,Ab){switch(Ab.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Ha;case 845325699:case -13332329:return!0}return!1}b5f(Ha,Ab,Yb){const Bb=w.h(this.$);var Qb=Bb.Da;const sc=t.r(Bb.ha.ra.selectedRanges,this.$);
if((Qb=Qb.rD())&&Qb.length){for(const kb of Qb){Qb=kb;const Eb=Qb.sf;if(!Eb)continue;const Gc=t.j(Qb.pf),zc=[];for(const yb of sc.Ranges){if(yb.FirstRow>Gc.LastRow+1||yb.LastRow<Gc.FirstRow||yb.FirstColumn>Gc.LastColumn+1||yb.LastColumn<Gc.FirstColumn)continue;const gb=this.RZh(Gc,yb,Eb),Kb=this.QZh(Gc,yb,Eb);zc.push(Object(A.a)(new ka,{FirstRow:gb.FirstRow,FirstColumn:Kb.FirstColumn,LastRow:gb.LastRow,LastColumn:Kb.LastColumn}))}0<zc.length&&!Yb?Eb.setPrintArea(zc):0<zc.length&&Yb?Eb.addToPrintArea(zc):
!Yb&&Eb.hasPrintArea()&&Eb.clearPrintArea();!Eb.isDirty()&&Eb.hasPageLayout()&&Eb.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Qb.Ad,4)}this.WPb(Bb,Ha,Ab)}}O3g(Ha,Ab){const Yb=w.h(this.$);var Bb=w.h(this.$).Da.rD();if(Bb&&Bb.length){for(const Qb of Bb){Bb=Qb;const sc=Bb.sf;sc&&(sc.clearPrintArea(),!sc.isDirty()&&sc.hasPageLayout()&&sc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Bb.Ad,4))}this.WPb(Yb,Ha,Ab)}}ghi(Ha,Ab){const Yb=w.h(this.$);var Bb=Yb.Da;
const Qb=t.o(Yb.ha.ra.activeCell,this.$);if(Qb){var sc=Bb.rD();if(sc&&sc.length){Bb=null;for(var kb of sc){let Eb=kb,Gc=Eb.sf;if(!Gc)continue;let zc=t.j(Eb.pf);if(!(Qb.FirstRow>zc.LastRow||Qb.FirstRow<zc.FirstRow||Qb.FirstColumn>zc.LastColumn||Qb.FirstColumn<zc.FirstColumn)&&(Bb=this.Udh(Gc,zc,Qb),Gc.insertPageBreak(Bb),!Gc.isDirty()&&Gc.hasPageLayout()&&Gc.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Eb.Ad,4),Bb))break}if(!Bb)for(const Eb of sc)if(Bb=Eb,kb=Bb.sf)Bb=t.j(Bb.pf),
Bb=this.KIe(kb,Bb,Qb),kb.insertPageBreak(Bb);this.WPb(Yb,Ha,Ab)}}}vfj(Ha,Ab){const Yb=w.h(this.$);var Bb=Yb.Da;const Qb=t.o(Yb.ha.ra.activeCell,this.$);if(Qb&&(Bb=Bb.rD())&&Bb.length){for(const kb of Bb){Bb=kb;const Eb=Bb.sf;if(Eb){var sc=t.j(Bb.pf);(sc=this.KIe(Eb,sc,Qb))&&Eb.removePageBreak(sc);!Eb.isDirty()&&Eb.hasPageLayout()&&Eb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+Bb.Ad,4)}}this.WPb(Yb,Ha,Ab)}}plj(Ha,Ab){const Yb=w.h(this.$);var Bb=Yb.Da.rD();if(Bb&&Bb.length){for(const Qb of Bb){Bb=
Qb;const sc=Bb.sf;sc&&(sc.resetAllPageBreak(),!sc.isDirty()&&sc.hasPageLayout()&&sc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Bb.Ad,4))}this.WPb(Yb,Ha,Ab)}}U$e(Ha,Ab,Yb,Bb,Qb){if(!Qb){var sc=this.$.Cb.getItemByName("PRINT_AREA");if(sc&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${sc.type}`),2===sc.type))return this.Mii(),Fa.Task.Ta(!0)}sc=w.h(this.$).ha.ra;const kb=t.r(sc.selectedRanges,
this.$);if(1===kb.Ranges.length&&!Qb){if(sc.Zba())return this.h9h(Ha,kb,Ab,Yb,Bb,Qb),Fa.Task.Ta(!0);if(t.R(kb.Ranges[0]))return this.$.xa.oa.hasPrintArea?this.S9e(Ha,Ab,Yb,Bb):Fa.Task.Ta(!0)}this.b5f(Ha.command,Bb,Qb);return this.cgf(Ha,Ab,Yb,kb,Qb)}S9e(Ha,Ab,Yb,Bb){this.O3g(Ha.command,Bb);return this.yii(Ha,Ab,Yb)}U7h(Ha,Ab,Yb,Bb){this.ghi(Ha.command,Bb);return this.Jii(Ha,Ab,Yb)}R8h(Ha,Ab,Yb,Bb){const Qb=t.r(w.h(this.$).ha.ra.selectedRanges,this.$);if(t.R(Qb.Ranges[0]))return this.P$e(Ha,Ab,Yb,
Bb);this.vfj(Ha.command,Bb);return this.Nii(Ha,Ab,Yb)}P$e(Ha,Ab,Yb,Bb){this.plj(Ha.command,Bb);return this.Qii(Ha,Ab,Yb)}cgf(Ha,Ab,Yb,Bb,Qb){const sc=this.$.pa.ya,kb=()=>new T(Bb,Qb);return H.a(this.$.userOperationManager,(Eb,Gc,zc)=>ea(sc,Bb,Qb,M.b(Eb,Ab),M.a(Gc,Yb),zc,null),Eb=>new D.a(241,0,Eb,64,kb),Ha)}yii(Ha,Ab,Yb){const Bb=this.$.xa.oa.name,Qb=this.$.pa.ya,sc=()=>new S(Bb);return H.a(this.$.userOperationManager,(kb,Eb,Gc)=>Ca(Qb,Bb,M.b(kb,Ab),M.a(Eb,Yb),Gc,null),kb=>new D.a(243,0,kb,64,sc),
Ha)}Jii(Ha,Ab,Yb){const Bb=w.h(this.$),Qb=t.o(Bb.ha.ra.activeCell,this.$),sc=()=>new U(Qb);return H.a(this.$.userOperationManager,(kb,Eb,Gc)=>la(this.$.pa.ya,Qb,M.b(kb,Ab),M.a(Eb,Yb),Gc,null),kb=>new D.a(244,0,kb,64,sc),Ha)}Nii(Ha,Ab,Yb){const Bb=w.h(this.$),Qb=t.o(Bb.ha.ra.activeCell,this.$),sc=()=>new Z(Qb);return H.a(this.$.userOperationManager,(kb,Eb,Gc)=>Ra(this.$.pa.ya,Qb,M.b(kb,Ab),M.a(Eb,Yb),Gc,null),kb=>new D.a(245,0,kb,64,sc),Ha)}Qii(Ha,Ab,Yb){const Bb=this.$.xa.oa.name,Qb=()=>new P(Bb);
return H.a(this.$.userOperationManager,(sc,kb,Eb)=>lb(this.$.pa.ya,Bb,M.b(sc,Ab),M.a(kb,Yb),Eb,null),sc=>new D.a(246,0,sc,64,Qb),Ha)}RZh(Ha,Ab,Yb){if(!Ha||!Ab||!Yb)return null;const Bb=new ka;Bb.FirstRow=Ab.FirstRow===Ha.LastRow+1?Yb.getRowIndex(Ha.LastRow+1)+1:Ab.FirstRow<Ha.FirstRow?0:Yb.getRowIndex(Ab.FirstRow+1);Bb.LastRow=Ab.FirstRow===Ha.LastRow+1||Ab.LastRow>Ha.LastRow?Yb.getRowIndex(Ha.LastRow+1)+1:Yb.getRowIndex(Ab.LastRow+1);return Bb}QZh(Ha,Ab,Yb){if(!Ha||!Ab||!Yb)return null;const Bb=
new ka;Bb.FirstColumn=Ab.FirstColumn===Ha.LastColumn+1?Yb.getColumnIndex(Ha.LastColumn+1)+1:Ab.FirstColumn<Ha.FirstColumn?0:Yb.getColumnIndex(Ab.FirstColumn+1);Bb.LastColumn=Ab.FirstColumn===Ha.LastColumn+1||Ab.LastColumn>Ha.LastColumn?Yb.getColumnIndex(Ha.LastColumn+1)+1:Yb.getColumnIndex(Ab.LastColumn+1);return Bb}Udh(Ha,Ab,Yb){if(!Ab||!Yb||!Ha)return null;const Bb=Ha.getPrintArea();if(!Bb||!Bb.length)return null;const Qb=Ha.getRowIndex(Yb.FirstRow+1),sc=Ha.getColumnIndex(Yb.FirstColumn+1);let kb=
null,Eb=null;for(const Gc of Bb)if(Qb>=Gc.FirstRow&&Qb<=Gc.LastRow&&sc>=Gc.FirstColumn&&sc<=Gc.LastColumn){if(Yb.FirstRow===Gc.FirstRow&&Yb.FirstColumn===Gc.FirstColumn)return new Oa;Qb>Gc.FirstRow&&(kb=Object(A.a)(new ba,{Index:Qb-1,Min:Gc.FirstColumn-1,Max:Math.min(Gc.LastColumn,Ha.getColumnIndex(Ab.LastColumn+1))}));sc>Gc.FirstColumn&&(Eb=Object(A.a)(new ba,{Index:sc-1,Min:Gc.FirstRow-1,Max:Math.min(Gc.LastRow,Ha.getRowIndex(Ab.LastRow+1))}));break}return kb||Eb?Object(A.a)(new Oa,{Row:kb?[kb]:
null,Col:Eb?[Eb]:null}):null}jfh(Ha,Ab,Yb){if(!Ab||!Yb||!Ha)return null;let Bb=null;Yb.FirstRow>Ab.FirstRow&&Yb.FirstRow<=Ab.LastRow?Bb=Object(A.a)(new ba,{Index:Ha.getRowIndex(Yb.FirstRow+1)-1,Min:-1,Max:-1}):Yb.FirstRow===Ab.LastRow+1&&(Bb=Object(A.a)(new ba,{Index:Ha.getRowIndex(Ab.LastRow+1),Min:-1,Max:-1}));return Bb}Eah(Ha,Ab,Yb){if(!Ab||!Yb||!Ha)return null;let Bb=null;Yb.FirstColumn>Ab.FirstColumn&&Yb.FirstColumn<=Ab.LastColumn?Bb=Object(A.a)(new ba,{Index:Ha.getColumnIndex(Yb.FirstColumn+
1)-1,Min:-1,Max:-1}):Yb.FirstColumn===Ab.LastColumn+1&&(Bb=Object(A.a)(new ba,{Index:Ha.getColumnIndex(Ab.LastColumn+1),Min:-1,Max:-1}));return Bb}KIe(Ha,Ab,Yb){if(!Yb||!Ha||!Ab)return null;const Bb=this.jfh(Ha,Ab,Yb);Ha=this.Eah(Ha,Ab,Yb);return Bb||Ha?Object(A.a)(new Oa,{Row:Bb?[Bb]:null,Col:Ha?[Ha]:null}):null}Mii(){const Ha=new E.StandardDialog;Ha.Rb=0;Ha.pc(1,J.a.instance.ga(4));Ha.Zl(J.a.instance.ga(569),J.a.instance.ga(570),1,null)}aKj(Ha){if(this.rwa.lb(Ha)&&(G.HelperMethods.v_&&(this.mHb=
this.$.Kb.Bc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.OLa.lb(Ha)&&this.OLa.remove(Ha),this.OLa.add(Ha,I.a.create().toString()),w.h(this.$).Eh)){const Ab=aa.b()?aa.b().uj(Ha):"";w.h(this.$).Eh.d1(this.rwa.na(Ha),this.OLa.na(Ha),Ab)}}W1g(Ha){if(this.mHb&&Ha){const Ab=this.mHb.Ac;this.mHb.stop();this.mHb=null;switch(Ha){case "SetPrintArea":this.nrb(Ab,1700,Ha);break;case "ClearPrintArea":this.nrb(Ab,1500,Ha);break;case "InsertPageBreak":this.nrb(Ab,1500,Ha);break;case "RemovePageBreak":this.nrb(Ab,
1600,Ha);break;case "ResetAllPageBreaks":this.nrb(Ab,1700,Ha)}}}nrb(Ha,Ab,Yb){Ha>Ab&&(Ab=Object(A.a)(new fa.a,{extendedProperties:new Map}),Ab.extendedProperties.set("OperationName",Yb),Ab.extendedProperties.set("OperationExecutionTime",Ha.toString()),L.Health.instance.recordQosError(Aa.a.MIj,[da.a.HIj],!1,!0,!0,!1,Ab))}h9h(Ha,Ab,Yb,Bb,Qb,sc){const kb=new E.StandardDialog,Eb=new V.a(J.a.instance.ga(567),J.a.instance.ga(568),J.a.instance.ga(6),J.a.instance.ga(5));kb.Rb=1;kb.pc(1,Eb.confirmButton);
kb.pc(0,Eb.cancelButton);kb.Zl(Eb.title,Eb.body,3,Gc=>{1===Gc&&(this.b5f(Ha.command,Qb,sc),this.cgf(Ha,Yb,Bb,Ab,sc))})}WPb(Ha,Ab,Yb){Yb();this.OLa.lb(Ab)&&Ha.Eh.xS(this.OLa.na(Ab),Q.BasicTelemetryCalculator.cR)}}Object(b.a)(oa,"PrintAreaBreakManager",null,[433]);var La=a(386),Ea=a(89),ca=a(27);class $a{constructor(){this.margin=this.H0=this.dda=this.orientation=this.rA=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.I2a=!1;this.NoColor=null}equals(Ha){return Ha?this.orientation===Ha.orientation&&
this.dda===Ha.dda&&this.H0===Ha.H0&&this.margin===Ha.margin&&this.sheetPrintOptions===Ha.sheetPrintOptions&&this.I2a===Ha.I2a&&this.NoColor===Ha.NoColor:!1}static KGe(Ha,Ab){Ha&&Ab&&(Ab.rA=Ha.rA,Ab.orientation=Ha.orientation,Ab.dda=Ha.dda,Ab.H0=Ha.H0,Ab.margin=Ha.margin,Ab.ignorePrintArea=Ha.ignorePrintArea,Ab.sheetPrintOptions=Ha.sheetPrintOptions,Ab.I2a=Ha.I2a,Ab.NoColor=Ha.NoColor)}}Object(b.a)($a,"PrintSettingsContainer",null,[]);var Qa=a(8),Va=a(58),fb=a(300),Ka=a(967),hb=a(208),fc=a(116),dc=
a(154),wb=a(348),Tb=a(38),xb=a(29),cb=a(22),jb=a(766),qa=a(784),za=a(187),Na=a(640),ua=a(554);class Xa{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(Xa,"PrintSettingMarginOption",null,[]);class ha{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(ha,"PrintSettingMarginValue",null,[]);class ta{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(ta,"PrintSettingOption",null,[]);class wa{constructor(Ha){this.$Ii=
[.75,.75,.7,.7,.3,.3];this.QHi=[.75,.75,.25,.25,.3,.3];this.X2j=[1,1,1,1,.5,.5];this.Hee=this.Eje=this.Zge=this.Ige=this.nne=this.f7=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.hm=Ha;this.Rfi();this.Xfi()}get whatToPrintOptions(){return this.nne}get orientationOptions(){return this.Ige}get paperSizeOptions(){return this.Zge}get scalingOptions(){return this.Eje}get marginDetailedOptions(){return this.Hee}dispose(){}Ixb(Ha){if(!Ha)return null;const Ab=new ha;Ab.left=Ha.Left;
Ab.right=Ha.Right;Ab.top=Ha.Top;Ab.bottom=Ha.Bottom;Ab.header=Ha.Header;Ab.footer=Ha.Footer;return Ab}q6c(Ha){e.ULS.shipAssertTag(537154186,0,6===Ha.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Ab={};Ab.Top=Ha[0];Ab.Bottom=Ha[1];Ab.Left=Ha[2];Ab.Right=Ha[3];Ab.Header=Ha[4];Ab.Footer=Ha[5];return Ab}Xfi(){this.nne=[Object(A.a)(new ta,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1226)}),Object(A.a)(new ta,{printSettingOptionKey:2,
printSettingOptionText:this.hm.ga(1219)}),Object(A.a)(new ta,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1218)})];this.Ige=[Object(A.a)(new ta,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1229)}),Object(A.a)(new ta,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1228)})];this.Zge=[Object(A.a)(new ta,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1231)}),Object(A.a)(new ta,{printSettingOptionKey:5,printSettingOptionText:this.hm.ga(1232)}),Object(A.a)(new ta,
{printSettingOptionKey:6,printSettingOptionText:this.hm.ga(1239)}),Object(A.a)(new ta,{printSettingOptionKey:7,printSettingOptionText:this.hm.ga(1233)}),Object(A.a)(new ta,{printSettingOptionKey:8,printSettingOptionText:this.hm.ga(1234)}),Object(A.a)(new ta,{printSettingOptionKey:9,printSettingOptionText:this.hm.ga(1235)}),Object(A.a)(new ta,{printSettingOptionKey:11,printSettingOptionText:this.hm.ga(1236)}),Object(A.a)(new ta,{printSettingOptionKey:12,printSettingOptionText:this.hm.ga(1237)}),Object(A.a)(new ta,
{printSettingOptionKey:13,printSettingOptionText:this.hm.ga(1238)}),Object(A.a)(new ta,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1230)})];this.Eje=[Object(A.a)(new ta,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1247)}),Object(A.a)(new ta,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1248)}),Object(A.a)(new ta,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1249)}),Object(A.a)(new ta,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1250)})];
this.Hee=[Object(A.a)(new Xa,{printSettingOption:Object(A.a)(new ta,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1253)}),marginValue:this.Ixb(this.normal)}),Object(A.a)(new Xa,{printSettingOption:Object(A.a)(new ta,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1254)}),marginValue:this.Ixb(this.wide)}),Object(A.a)(new Xa,{printSettingOption:Object(A.a)(new ta,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1255)}),marginValue:this.Ixb(this.narrow)}),Object(A.a)(new Xa,
{printSettingOption:Object(A.a)(new ta,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1256)}),marginValue:this.Ixb(this.f7)})]}Rfi(){this.normal=this.q6c(this.$Ii);this.narrow=this.q6c(this.QHi);this.wide=this.q6c(this.X2j)}}wa.qjh=1;wa.ajh=1;wa.f8c=9;wa.fjh=2;wa.Zih=0;wa.Sih=!1;wa.Nih=!1;wa.gJa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(wa,"PrintSettingsManagerBase",null,[2]);var db=a(121),Jb=a(282);class Pb{constructor(Ha,Ab){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=Ha;this.sheetPrintOptions=Ab}getSheetName(){return this.sheetName}}Object(b.a)(Pb,"MacroRecorderSheetPrintOptionsSavedPayload",null,[108]);class eb{constructor(Ha,Ab){this.printSettings=this.sheetName=null;this.sheetName=Ha;this.printSettings=Ab}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(eb,"MacroRecorderSheetPrintSettingsSavedPayload",null,[108]);class Ma extends wa{constructor(Ha,Ab,Yb,Bb,Qb,sc){super(Qb);this.t$f=
this.Dd=!1;this.oEd=kb=>{this.XD.oEd(kb)};this.yEd=kb=>{this.XD.yEd(kb)};this.uWi=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.tWi=kb=>{kb=fc.a.Pe(kb.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${xb.a.sc(kb)}.`)};this.Tz=(kb,Eb)=>{2===Eb.Lr?this.Kv.clear():1===Eb.Lr&&this.Kv&&this.Kv.contains(Eb.Tf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${db.a(Eb.Tf.operation.operationName)} returned, it took ${Eb.Tf.dequeueUtcTime.getTime()-Eb.Tf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.Kv.remove(Eb.Tf))};this.XD=Ha;this.Yab=Yb;this.$=Ab;this.sheetName=Bb;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.va.UICultureTag;this.I0i=this.o9g();this.$.userOperationManager.ur(this.Tz);this.Kv=new za.a;this.aI=sc}Dii(Ha){this.Eii(Ab=>{Ha&&(Ab=this.WZh(Ab),
Ha(Ab))})}FPd(Ha,Ab){if(Ha){var Yb=new z(Ha.rA,Ha.ignorePrintArea);this.upj(Yb);!Ab||this.t$f?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Ab?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Ab=this.YZh(Ha.H0),Ab.IsLandscape=2===Ha.orientation,Ab.PaperSize=Ha.dda,this.aI&&(Ab.NoColor=Ha.NoColor),Ab.PageMargin=this.nid(Ha.margin),Ab.SheetPrintOptions=wa.gJa,Ab.SheetPrintOptions.PrintGrid=Ha.sheetPrintOptions.PrintGrid,
Ab.SheetPrintOptions.HorizontalCenter=Ha.sheetPrintOptions.HorizontalCenter,Ab.SheetPrintOptions.VerticalCenter=Ha.sheetPrintOptions.VerticalCenter,Ab.SheetPrintOptions.PrintHeaders=Ha.sheetPrintOptions.PrintHeaders,this.tpj(Ab))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}nid(Ha){let Ab={};0===Ha?Ab=this.normal:1===Ha?Ab=this.wide:2===Ha?Ab=this.narrow:3===Ha&&(Ab=this.f7);return Ab}Uii(Ha){if(Ha){e.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Ab=this.$.pa.ya,Yb=this.$.pa.ya.Wb(),Bb=new D.a(598,0,(Qb,sc,kb)=>va(Ab,this.$.xa.oa.name,Ha,M.b(this.oEd,Qb),M.a(this.yEd,sc),kb,Yb),64,()=>new Pb(this.$.xa.oa.name,Ha));this.$.userOperationManager.Ic(Bb,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Dd||(this.Dd=!0,this.$.userOperationManager.ko(this.Tz),
this.yY())}upj(Ha){this.Yab.rA=Ha.rA;this.Yab.ignorePrintArea=Ha.ignorePrintArea}Eii(Ha){const Ab=sc=>{Jb.a(sc)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${xb.a.sc(sc.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Ha(sc.Result))},Yb=sc=>{sc=fc.a.Pe(sc.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${xb.a.sc(sc)}.`);
Ha(null)},Bb=this.$.pa.ya.Wb();var Qb=new D.a(247,0,(sc,kb,Eb)=>N(this.$.pa.ya,this.sheetName,this.locale,M.b(sc,Ab),M.a(kb,Yb),Eb,Bb),80);Qb=this.$.userOperationManager.Ic(Qb,null);this.Kv.add(Qb)}tpj(Ha){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Ab=this.$.pa.ya.Wb();this.$.userOperationManager.Ic(new D.a(226,0,(Yb,Bb,Qb)=>X(this.$.pa.ya,this.sheetName,Ha,M.b(Yb,this.uWi),M.a(Bb,this.tWi),Qb,Ab),
void 0,()=>new eb(this.sheetName,Ha)),null)}iqi(Ha){return this.xhf(Ha)||!this.Fkf(Ha.PaperSize)}fHh(Ha){this.xhf(Ha)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Ha.ScalingWidth=Ma.hjh,Ha.ScalingHeight=Ma.gjh,Ha.ScalingPercent=Ma.YKe,Ha.FitToPage=Ma.Oih);this.Fkf(Ha.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${Ha.PaperSize.toString()} present in file which is unsupported by XLO.`),
Ha.PaperSize=Ma.f8c);return Ha}UZh(Ha){if(Ha.FitToPage){if(1===Ha.ScalingWidth&&1===Ha.ScalingHeight)return 1;if(!Ha.ScalingWidth&&1===Ha.ScalingHeight)return 3}else return 0;return 2}TZh(Ha){return this.Yrd(Ha,this.normal)?0:this.Yrd(Ha,this.wide)?1:this.Yrd(Ha,this.narrow)?2:3}Yrd(Ha,Ab){return Ha.Left===Ab.Left&&Ha.Right===Ab.Right&&Ha.Top===Ab.Top&&Ha.Bottom===Ab.Bottom&&Ha.Header===Ab.Header&&Ha.Footer===Ab.Footer}YZh(Ha){const Ab={};Ab.ScalingPercent=Ma.YKe;Ab.FitToPage=0!==Ha;2===Ha?(Ab.ScalingWidth=
1,Ab.ScalingHeight=0):3===Ha?(Ab.ScalingWidth=0,Ab.ScalingHeight=1):1===Ha&&(Ab.ScalingWidth=1,Ab.ScalingHeight=1);return Ab}Fkf(Ha){return this.I0i.contains(Ha.toString())}xhf(Ha){return 100!==Ha.ScalingPercent||Ha.FitToPage&&(1<Ha.ScalingWidth||1<Ha.ScalingHeight)}o9g(){const Ha=new Na.a(ua.a.ak());for(let Ab=0;Ab<this.paperSizeOptions.length;Ab++)Ha.add(this.paperSizeOptions[Ab].printSettingOptionKey.toString());return Ha}WZh(Ha){let Ab=null;if(Ha){const Yb=this.Yab.rA,Bb=this.Yab.ignorePrintArea;
this.iqi(Ha)&&(this.t$f=!0,Ha=this.fHh(Ha));Ab=new $a;Ab.rA=Yb;Ab.ignorePrintArea=Bb;Ab.orientation=Ha.IsLandscape?2:1;Ab.dda=Ha.PaperSize;Ab.H0=this.UZh(Ha);Ab.sheetPrintOptions=wa.gJa;Ab.sheetPrintOptions.PrintGrid=Ha.SheetPrintOptions.PrintGrid;Ab.I2a=Ha.Draft;this.aI&&(Ab.NoColor=Ha.NoColor);Ab.sheetPrintOptions.HorizontalCenter=Ha.SheetPrintOptions.HorizontalCenter;Ab.sheetPrintOptions.VerticalCenter=Ha.SheetPrintOptions.VerticalCenter;Ab.sheetPrintOptions.PrintHeaders=Ha.SheetPrintOptions.PrintHeaders;
Ab.margin=this.TZh(Ha.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Ab.margin}`);3===Ab.margin&&(this.f7={},this.f7.Left=Ha.PageMargin.Left,this.f7.Right=Ha.PageMargin.Right,this.f7.Top=Ha.PageMargin.Top,this.f7.Bottom=Ha.PageMargin.Bottom,this.f7.Header=Ha.PageMargin.Header,this.f7.Footer=Ha.PageMargin.Footer)}return Ab}yY(){if(this.Kv){for(let Ha of this.Kv)this.$&&this.$.userOperationManager&&(Ha.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${db.a(Ha.operation.operationName)}.`),
this.$.userOperationManager.iua(Ha)),this.Kv.remove(Ha);this.Kv=null}}}Ma.hjh=1;Ma.gjh=0;Ma.YKe=100;Ma.f8c=9;Ma.Oih=!0;Object(b.a)(Ma,"PrintSettingsManager",wa,[]);var ob=a(70);class Ia{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Ia,"PrintSettingsTaskPaneCallbacks",null,[]);class Da{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(Da,"SelectedPrintSettings",null,[]);class nb{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(nb,"PrintOperationCallbacks",null,[]);class Ua{constructor(){this.onBackToSheet=null}}Object(b.a)(Ua,"PrintPreviewPaneCallbacks",
null,[]);var W=a(1078);class sa{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(sa,"UniversalPrintAppSettings",null,[]);var vb=a(423),gc=a(33);class Bc{constructor(Ha,Ab,Yb,Bb){this.activeCell=this.selectedRange=this.vg=this.graphServiceEndpoint=null;this.EIb=0;this.rda=this.Lv=null;this.TH=new $a;this.Ok=new $a;this.kca=0;this.V8a=null;this.ROb=!1;this.g4a=this.DHb=null;this.rsd=!1;this.U7a=
this.wBb=!0;this.Rma=this.Dza=this.$8a=null;this.wAb=!1;this.S8a=null;this.i7a=this.xNc=!1;this.sPi=Qb=>{if(!(Qb&&Qb.data&&Qb.data.ve&&Qb.data.responseHeaders&&Qb.data.ve.length)){var sc=Qb?Qb.data?Qb.data.ve?Qb.data.responseHeaders?Qb.data.ve.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.vg&&(Qb=this.gSa(J.a.instance.ga(1207)),
this.ABa(Qb,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${sc}`);this.vNd&&(Qb=Object(A.a)(new fa.a,{extendedProperties:new Map}),Qb.extendedProperties.set("InvalidParameterName",sc),L.Health.instance.recordQosError(Aa.a.mOf,[da.a.nOf],!1,!0,!0,!1,Qb))}else if(0<this.kca&&Qb.data.id===this.kca){if(Qb.data.responseHeaders["Content-Type"]&&(cb.a.contains(Qb.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||cb.a.contains(Qb.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var kb=null;cb.a.contains(Qb.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(kb=this.sah(Qb));sc={};this.bBf(kb);Qb.data.responseHeaders["Total-Pdf-PageCount"]?(kb=parseInt(Qb.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.wAb||(this.lId>=kb?this.Rma=kb:this.wAb=!0),this.U7a&&this.vg&&this.vg.setPageRangeSettings(kb,this.lId,this.wAb,
this.Dza,this.Rma)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else sc=Va.a.ki(Qb.data.ve),xb.a.p$(sc.Errors)||ob.a(this.$).hd.xM(sc.Errors[0].MessageId),this.lbj(sc.Errors),this.vg&&(kb=this.gSa(sc.Errors[0].Description),-1831476778===sc.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.ABa(kb,0,J.a.instance.ga(1210))):
this.ABa(kb,0)),297284985===sc.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${sc.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${sc.Errors[0].MessageId}`);Qb=Qb.data.state;Qb.DSe(sc,Qb.userContext,Qb.methodName)}};this.rPi=Qb=>{if(0<this.kca&&Qb.data.id===this.kca){var sc=fc.a.Pe(Qb.data);this.vg&&this.ABa(this.gSa(sc[0].Description),
1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${xb.a.sc(sc)}]`);sc=Qb.data.state;sc.eja(Qb,sc.userContext,sc.methodName);this.$.userOperationManager.Fla.operation.kBa(()=>this.ROb)}};this.RNi=Qb=>{Qb.Errors&&0<Qb.Errors.length&&this.vg?(xb.a.p$(Qb.Errors)||ob.a(this.$).hd.xM(Qb.Errors[0].MessageId),this.ABa(this.gSa(Qb.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${Qb.Errors[0].MessageId}`)):
(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.bBf(null))};this.QNi=Qb=>{Qb=fc.a.Pe(Qb.data);this.vg&&this.ABa(this.gSa(Qb[0].Description),1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${xb.a.sc(Qb)}]`);this.$.userOperationManager.Fla.operation.kBa(()=>this.ROb)};this.CFf=(Qb,sc)=>{if(sc)switch(sc.d6i){case 1:if(this.Ok&&this.g4a)switch(Qb=this.g4a.Ac,this.g4a.stop(),
this.g4a=null,this.Ok.rA){case 1:this.$1c(Qb,4800,"ActiveSheet");break;case 0:this.$1c(Qb,6100,"CurrentSelection");break;case 2:this.$1c(Qb,7500,"EntireWorkbook")}break;case 0:this.DHb&&(Qb=this.DHb.Ac,this.DHb.stop(),2400<Qb&&(sc=Object(A.a)(new fa.a,{extendedProperties:new Map}),sc.extendedProperties.set("PaneLoadTime",Qb.toString()),L.Health.instance.recordQosError(Aa.a.LIj,[da.a.B$f],!1,!0,!0,!1,sc)),this.Lv.Dii(kb=>{this.LGj(kb)}))}};this.Tz=(Qb,sc)=>{(1===sc.Lr&&this.$8a===sc.Tf||2===sc.Lr)&&
this.hOd()};this.$=Ha;this.i8b=Ab;this.x3=Yb;this.CFb=Bb;this.vNd=G.HelperMethods.v_;this.Ra=new Tb.a;this.lId=this.$.va.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.wEj();this.zfi();this.Zji=this.a2g();this.Bti=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1);this.aI=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);if(this.isUniversalPrintEnabled=!!Bb&&Bb.YMa()&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.ie.get(116))this.graphServiceEndpoint=this.$.va.GraphServiceEndpoint;this.isExportPdfMode=!1}get hqi(){return this.xNc}cNg(Ha){this.Ra.addHandler("ppocek",Ha)}cij(Ha){this.Ra.removeHandler("ppocek",Ha)}KGj(Ha,Ab,Yb){this.Nlj();this.$.userOperationManager.ur(this.Tz);
this.rda=Ha;this.Ra.raiseEvent("ppocek");this.isExportPdfMode=Yb;this.rda.SelectedRanges&&this.rda.SelectedRanges.Ranges&&0<this.rda.SelectedRanges.Ranges.length&&this.rda.SelectedRanges.Ranges[0]&&(this.selectedRange=t.B(this.rda.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.Lv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Lv=new Ma(this,this.$,Ab,this.$.xa.oa.name,J.a.instance,this.aI);e.ULS.shipAssertTag(537154267,0,!this.vg,
"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.vg=new qa.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.vg.Ymh();this.vg.MGj(this.isExportPdfMode);this.vg.xMg(this.CFf)}bXh(){this.Lv.f7&&4<=this.Lv.marginDetailedOptions.length&&(this.Lv.marginDetailedOptions[3].marginValue=this.Lv.Ixb(this.Lv.f7));return this.Lv.marginDetailedOptions}$6f(){return!!this.rda&&!!this.rda.ObjectId||!w.h(this.$).ha.ra.Pg}ZZh(){const Ha=Object(A.a)(new Da,
{selectedWhatToPrint:wa.qjh,selectedOrientation:wa.ajh,selectedPaperSize:wa.f8c,selectedScaling:wa.fjh,selectedMargin:wa.Zih,selectedIgnorePrintArea:wa.Sih,selectedPrintGridlines:wa.gJa.PrintGrid,selectedDraft:wa.Nih,selectedHorizontalCenter:wa.gJa.HorizontalCenter,selectedVerticalCenter:wa.gJa.VerticalCenter,selectedRowAndColumnHeadings:wa.gJa.PrintHeaders});this.TH?(Ha.selectedWhatToPrint=this.TH.rA,Ha.selectedOrientation=this.TH.orientation,Ha.selectedPaperSize=this.TH.dda,Ha.selectedScaling=this.TH.H0,
Ha.selectedMargin=this.TH.margin,Ha.selectedIgnorePrintArea=this.TH.ignorePrintArea,Ha.selectedPrintGridlines=this.TH.sheetPrintOptions.PrintGrid,Ha.selectedDraft=this.TH.I2a,this.aI&&(Ha.selectedColor=this.TH.NoColor?0:1),Ha.selectedHorizontalCenter=this.TH.sheetPrintOptions.HorizontalCenter,Ha.selectedVerticalCenter=this.TH.sheetPrintOptions.VerticalCenter,Ha.selectedRowAndColumnHeadings=this.TH.sheetPrintOptions.PrintHeaders):e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");
return Ha}$5e(){return Object(A.a)(new Ua,{onBackToSheet:()=>{this.uma()}})}VZh(){return Object(A.a)(new W.a,{backActionButtonText:J.a.instance.ga(1206),printPreviewPaneCallbacks:this.$5e(),logger:new La.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(A.a)(new nb,{onClosePreviewer:()=>{this.uma()},getGraphServiceAuthorizationToken:this.Mbc(),onLocalPrint:()=>{this.nGf()},onNotifyPrintJobStatus:(Ha,Ab)=>{this.onNotifyPrintJobStatus(Ha,Ab)}}),universalPrintAppSettings:Object(A.a)(new sa,
{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.fki()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}XZh(){return Object(A.a)(new Ia,{onSettingChange:Ha=>{this.nVi(Ha)},onPrint:()=>{this.nGf()}})}nVi(Ha){this.EIb++;Ha?(this.vg&&this.vg.CHj(),this.Ok.rA=Ha.selectedWhatToPrint,this.Ok.H0=Ha.selectedScaling,this.Ok.orientation=Ha.selectedOrientation,this.Ok.dda=Ha.selectedPaperSize,this.Ok.margin=Ha.selectedMargin,
this.aI&&(this.Ok.NoColor=!Ha.selectedColor),this.Ok.ignorePrintArea=Ha.selectedIgnorePrintArea,this.txj(Ha.selectedPageStart,Ha.selectedPageEnd),this.Lv&&this.u$h(this.Ok,Ha)?(this.Ok.sheetPrintOptions=wa.gJa,this.Ok.sheetPrintOptions.PrintGrid=Ha.selectedPrintGridlines,this.Ok.sheetPrintOptions.HorizontalCenter=Ha.selectedHorizontalCenter,this.Ok.sheetPrintOptions.VerticalCenter=Ha.selectedVerticalCenter,this.Ok.sheetPrintOptions.PrintHeaders=Ha.selectedRowAndColumnHeadings,this.Lv.Uii(this.Ok.sheetPrintOptions)):
this.Yod()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}uma(){this.i7a&&(this.ROb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.EIb} times before clicking on backToWorkbook icon`);this.mGf();this.GCe()}nGf(){e.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.EIb} times before clicking on print button.`);
e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Ok.margin}, Initial margin value : ${this.TH.margin}`);if(this.useMSPdfViewer)this.oOf();else if(this.U7a)try{this.vg.printPdf(),this.j3c()}catch(Ha){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.oOf()}else this.i8b.JGj(this.i6b(!0)),this.j3c()}oOf(){const Ha=this.i6b(!0);this.j3c();G.HelperMethods.lf(Ha,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){Ea.a.Ia(this.Ra)}Yod(){if(this.$.f7a)this.Aii();
else{this.yY();this.lZf();var Ha=null;this.pfi();e.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$8a=this.$.userOperationManager.Ic(new D.a(223,0,(Ab,Yb,Bb)=>{Ab=new fb.a(Ab,null,Yb,Bb,null,!0,!1,"GetFileCopyFileHandler","");Ab.correlationID=I.a.create().toString();Ha=Ab;this.kca=this.x3.bha(this.i6b(this.U7a?!1:!0,this.Zji?"Base64":"Pdf"),1,null,null,Bc.FEh,!1,2,this.sPi,this.rPi,Ha,void 0,void 0,void 0,12E4);Ab.requestId=
this.kca;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.kca}.`);return Fa.Task.Ta(!0)},80),null)}}j3c(){this.mGf();this.GCe()}oEd(Ha){xb.a.Lq(Ha.Errors)?this.vg.showErrorMessageForPrintOptions(J.a.instance.ga(1257)):(e.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Yod(),this.vg&&this.vg.hideErrorMessageForPrintOptions())}yEd(Ha){this.vg&&this.vg.showErrorMessageForPrintOptions(J.a.instance.ga(1257));
Ha=fc.a.Pe(Ha.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${xb.a.sc(Ha)}.`)}Aii(){e.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.yY();const Ha=this.$.pa.ya.Wb();this.$8a=this.$.userOperationManager.Ic(new D.a(133,0,(Ab,Yb,Bb)=>{const Qb={};Qb.WhatToPrint=this.Ok.rA;Qb.UseNamedAction=this.i8b.f8f();Qb.SelectedSheetName=this.$.xa.oa.name;
Qb.ActiveCell=this.activeCell;Qb.SelectedRanges=[this.selectedRange];Qb.IsPdfDocumentRequired=!1;Qb.Orientation=this.Ok.orientation;Qb.PaperSize=this.Ok.dda;Qb.Scaling=this.Ok.H0;Qb.RichValuesEnabled=!0;Qb.IgnorePrintArea=this.Ok.ignorePrintArea;Qb.Preview=!0;this.aI&&(Qb.NoColor=this.Ok.NoColor);this.T6f()&&(Qb.PaginationStartPage=this.Dza,Qb.PaginationEndPage=this.Rma,Qb.OutputTotalPdfPageCount=!0);const sc=this.Lv.nid(this.Ok.margin);sc&&(Qb.PageMargin={},Qb.PageMargin.Top=sc.Top,Qb.PageMargin.Bottom=
sc.Bottom,Qb.PageMargin.Left=sc.Left,Qb.PageMargin.Right=sc.Right,Qb.PageMargin.Header=sc.Header,Qb.PageMargin.Footer=sc.Footer);return this.V8a=Y(this.$.pa.ya,Qb,M.b(this.RNi,Ab),M.a(this.QNi,Yb),Bb,Ha)},80),null)}GCe(){this.$.userOperationManager.ko(this.Tz);this.yY();this.lZf();e.ULS.shipAssertTag(537154261,0,!!this.vg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.vg&&(this.vg.Ghj(this.CFf),this.vg.gnh(),this.vg=null);this.rda=
null;this.Lv&&(this.Lv.dispose(),this.Lv=null);this.g4a=this.DHb=null;this.xNc=!1;this.Ra&&this.Ra.raiseEvent("ppocek")}sCj(){return this.$.isEditMode&&!!this.TH&&!!this.Ok&&2!==this.Ok.rA&&this.v$h()}FPd(){e.ULS.shipAssertTag(537154260,0,!!this.Lv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Lv&&this.Lv.FPd(this.Ok,this.sCj())}i6b(Ha,Ab="Pdf"){const Yb=new Sys.StringBuilder;Yb.append(Ka.a(this.$,Ab,!0));hb.a.zk(Yb,Qa.a.APf,""+this.Ok.rA);Ha&&this.i8b.f8f()&&
hb.a.zk(Yb,Qa.a.z_j,"1");hb.a.zk(Yb,Qa.a.g8i,this.$.xa.oa.name);0===this.Ok.rA&&(hb.a.zk(Yb,Qa.a.f8i,this.selectedRange),hb.a.zk(Yb,Qa.a.Y7i,this.activeCell));hb.a.zk(Yb,Qa.a.a8i,""+this.Ok.orientation);hb.a.zk(Yb,Qa.a.b8i,""+this.Ok.dda);hb.a.zk(Yb,Qa.a.e8i,""+this.Ok.H0);hb.a.zk(Yb,Qa.a.d8i,"1");hb.a.zk(Yb,Qa.a.X7i,this.Ok.ignorePrintArea?"1":"0");hb.a.zk(Yb,Qa.a.c8i,"1");this.NQg(Yb);this.aI&&hb.a.zk(Yb,Qa.a.$7i,this.Ok.NoColor?"1":"0");this.MQg(Yb);cb.a.equals(Ab,"Pdf",!0)&&(Yb.append("&#toolbar=0"),
Yb.append("&zoom=100"));Ha=Yb.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${Ha}`);return Ha}txj(Ha,Ab){Ha||Ab?(this.wAb=!0,this.Dza=Ha,this.Rma=Ab):this.yYf()}NQg(Ha){this.T6f()&&(hb.a.zk(Ha,Qa.a.i8i,""+this.Dza),hb.a.zk(Ha,Qa.a.h8i,""+this.Rma),hb.a.zk(Ha,Qa.a.j8i,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.Dza} to ${this.Rma}`))}T6f(){return null!=
this.Dza&&0<this.Dza&&null!=this.Rma&&0<this.Rma}MQg(Ha){if(this.Lv&&this.Ok){const Ab=this.Lv.nid(this.Ok.margin);Ab&&hb.a.zk(Ha,Qa.a.Z7i,""+Ab.Top+" "+Ab.Bottom+" "+Ab.Left+" "+Ab.Right+" "+Ab.Header+" "+Ab.Footer)}}bBf(Ha){this.vg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.oa&&(this.U7a?(Ha||(Ha=this.i6b(!1)),this.vg.uyi(Ha)):this.EGj()))}v$h(){return!this.TH.equals(this.Ok)}mGf(){!this.ROb&&
0<this.EIb&&(this.rsd?this.FPd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,0,!!this.vg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.vg&&this.vg.Fai()}vj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.vg){var Ha=this.gSa(J.a.instance.ga(1));this.ABa(Ha,1)}else Ha=xb.a.$c(1,0,26,
0,1,-1100324317,"GetPrintSettingsFailedError"),x.EwaSettings.Jz()?new wb.a(this.$,Ha):(new dc.ErrorDialog(this.$,Ha)).xg()}LGj(Ha){Ha?(0===Ha.rA&&this.$6f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.rda.ObjectId?"floatingObject":"discontinuousRange"}.`),Ha.rA=1),$a.KGe(Ha,this.TH),$a.KGe(Ha,this.Ok),e.ULS.shipAssertTag(537154248,0,!!this.vg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.vg&&(this.rsd=!0,this.vg.NGj(),this.Yod())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.vj())}$1c(Ha,Ab,Yb){Ha>Ab&&(Ab=Object(A.a)(new fa.a,{extendedProperties:new Map}),Ab.extendedProperties.set("WtpSelectedValue",Yb),Ab.extendedProperties.set("FullyRenderedPdfLoadTime",Ha.toString()),L.Health.instance.recordQosError(Aa.a.KIj,[da.a.B$f],!1,!0,!0,!1,Ab))}yY(){this.$8a&&(0<this.kca||this.V8a)&&(e.ULS.sendTraceTag(537154246,
0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.kca}.`),this.$.userOperationManager.iua(this.$8a),this.V8a?fc.a.au(this.V8a.qt):this.x3.au(this.kca),this.hOd())}hOd(){this.V8a=this.$8a=null}pfi(){this.vNd&&this.Ok&&(this.g4a=this.$.Kb.Bc("UserAction",(1===this.Ok.rA?"ActiveSheet":0===this.Ok.rA?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}yYf(){this.wAb=!1;this.Dza=1;this.Rma=this.lId}gSa(Ha){if(Ha)return Ha.replace("&#39;",
"'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Ha}EGj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.wBb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let Ha=this.gSa(J.a.instance.ga(1212));this.ABa(Ha,3)}}ABa(Ha,Ab,Yb=null){this.vg.gA(Ha,Ab,Yb)}zfi(){this.U7a=this.wBb=!0;e.ULS.sendTraceTag(557061534,
0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.wBb}, isPdfPreviewSupportedInPreviewer: ${this.U7a}`)}Nlj(){this.S8a=null;this.hOd();this.yYf();this.DHb=this.$.Kb.Bc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.EIb=0;this.rsd=this.i7a=this.ROb=!1;this.xNc=!0}wEj(){const Ha=this.ati()||this.pti();e.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${Ha}`);return Ha}a2g(){let Ha=
15;ca.a.ZH&&ca.a.tub&&(Ha=parseFloat(ca.a.tub));return 14<Ha&&this.wBb}ati(){var Ha;if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModifyTeamsHostCheck",!1)){const Ab="teams"===(null===(Ha=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.n8])||void 0===Ha?void 0:Ha.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${ca.a.Fz} isTeamsUIHost: ${Ab} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);return ca.a.Fz||
Ab}return ca.a.Fz||f.AFrameworkApplication.isUnifiedHostMode}pti(){return!this.$.ie.get(111)}lZf(){this.S8a&&(URL.revokeObjectURL(this.S8a),this.S8a=null)}sah(Ha){var Ab=Ha.data.ve;Ha=this.$.Kb.Bc("UserAction","PrintPreviewBlobFileCreation");var Yb=window.self.atob(Ab);Ab=new Uint8Array(Ab.length);for(let Bb=0;Bb<Yb.length;Bb++)Ab[Bb]=Yb.charCodeAt(Bb)&255;Yb=new Blob([Ab],{type:"application/pdf"});this.S8a=URL.createObjectURL(Yb);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${Ha.Ac} ms. Blob size: ${Yb.size}`);
Ha.stop();return this.S8a+"#toolbar=0&zoom=100"}lbj(Ha){if(this.vNd&&xb.a.eh(Ha,Bc.V1i)){const Ab=Object(A.a)(new fa.a,{extendedProperties:new Map});Ab.extendedProperties.set("ErrorMessageIdName",Ha[0].MessageIdName);L.Health.instance.recordQosError(Aa.a.mOf,[da.a.nOf],!1,!0,!0,!1,Ab)}}u$h(Ha,Ab){return Ha.sheetPrintOptions.PrintGrid!==Ab.selectedPrintGridlines||Ha.sheetPrintOptions.HorizontalCenter!==Ab.selectedHorizontalCenter||Ha.sheetPrintOptions.VerticalCenter!==Ab.selectedVerticalCenter||Ha.sheetPrintOptions.PrintHeaders!==
Ab.selectedRowAndColumnHeadings}uSj(){this.Bti&&this.$.Xc(1936706533,-1,0,null)}fki(){return!!this.$.va&&!!this.$.va.DocumentHostInfo&&"TestHost"===this.$.va.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.CFb.UL("Print",this.graphServiceEndpoint).then(Ha=>Ha?(Ha.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${Ha.ErrorCode}, Error message : ${Ha.ErrorMessage}`),Ha):Object(A.a)(new jb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(Ha=>{let Ab=new jb.a;Object.getType(Ha)===Object.getType(Ab)?Ab=Ha:(Ab.ErrorMessage=Ha.toString(),Ab.ErrorCode="exception");return Promise.resolve(Ab)})}Mbc(){return()=>{const Ha=Promise.resolve("");try{if(this.CFb&&this.CFb.YMa())return this.getToken().then(Ab=>
Ab.IsSuccess?Promise.resolve(Ab.Token):Ha,()=>Ha)}catch(Ab){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return Ha}}onNotifyPrintJobStatus(Ha,Ab){Ha=vb.a.BC.notificationBar.O3(Ha,!1);"pending"==Ab&&(Ha.displayTimeoutSeconds=3,this.uSj());if(gc.a.a8a())switch(Ab){case "failure":Ha.image=1;break;case "success":Ha.image=3;break;default:Ha.image=0}else Ha.image=0;vb.a.BC.notificationBar.DC(Ha)}}Bc.V1i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Bc.FEh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(Bc,"PrintPreviewManager",null,[431,2,432]);class Sa{constructor(Ha,Ab,Yb){this.ignorePrintArea=!1;this.PRj=()=>{const Bb=w.h(this.$).Da;this.cTc=!0;Bb.BBd()};this.TUi=()=>{this.Zkd()};this.SUi=(Bb,Qb,sc)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${sc} failed to execute`);
this.Zkd()};this.$=Ha;this.ea=Ha.ea;this.i8b=Ab;this.Yab=new z(1,this.ignorePrintArea);this.XD=Ab=new Bc(Ha,Ab,f.AFrameworkApplication.zd,Yb);this.$.da.Ga(418,Ab);this.kOf=new oa(Ha);this.$.da.Ga(384,this);this.cTc=!1}get c7f(){return this.cTc}nc(){return!1}executeCommand(Ha,Ab,Yb,Bb){const Qb=Ab.command;return 1588554917===Qb||1531172830===Qb||-2050819419===Qb?(Ab.HAb=!0,C.a(this.$)&&this.$.da.Aa(423).Yzc(!1),this.Inh(Ab)?Fa.Task.Ta(!0):v.a(Qb)):this.kOf.executeCommand(Ha,Ab,Yb,Bb,this.TUi,this.SUi,
this.PRj)}wc(Ha,Ab){switch(Ab.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.cla,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);case -2050819419:return x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);default:return this.kOf.wc(Ha,Ab)}}Kc(){return!1}Inh(Ha){return this.$.ea.Zb?this.Jnh(Ha):!1}Jnh(Ha){e.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const Ab=this.$.Kb.Bc("UserAction","DoPrintHtml");var Yb=this.$;Yb=this.SZh(Yb,this.ea.isNamedObjectViewMode?Yb.Cb.oa.sheetName:Yb.xa.oa.name);if(B.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const Bb=1531172830===Ha.command||-2050819419===Ha.command;
this.XD.KGj(Yb,this.Yab,Bb);e.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${Bb} Command: ${r.a[Ha.command]}`)}Ab.stop();this.Zkd();return!0}SZh(Ha,Ab){const Yb={};Yb.SessionId=this.ea.sessionId;Yb.UsedRangeTooBig=!1;var Bb=w.h(Ha),Qb=Bb.ha;const sc=Qb.Oe;if(y.e(Ha.oa))Yb.Type=0,Yb.ObjectId=Ha.oa.name,Yb.UseSelection=!1;else if(y.g(Ha.oa))Yb.Type=1,Yb.ObjectId=Ha.oa.imageId,Yb.UseSelection=!0;else if(2===sc||4===sc||64===sc)Bb=Qb.Sa.$b.floatingObject,
Yb.Type=1,Yb.SheetName=Ab,Yb.ObjectId=Bb.id,Yb.UseSelection=!0;else if(sc&470)Yb.ObjectId=Qb.Sa.$b.floatingObject.id,Yb.SheetName=Ab;else if(y.i(Ha.oa)){Yb.Type=2;Yb.SheetName=Ab;if(Qb.ra.Pg)if(Qb=Qb.ra.dd,Yb.SelectedRanges=t.q(Qb,Ha),20<Qb.RC)Yb.UseSelection=!0;else{Ab=0;Bb=Bb.jk("PrintCommandHandler.DoPrintHtml",Qb);try{for(Bb.$$rst();Bb.$$mn()&&2>Ab;)Bb.$$cu().text&&Ab++;Yb.UseSelection=2<=Ab}finally{Bb&&Bb.dispose()}}else Yb.UseSelection=!1,Yb.SelectedRanges=t.q(Qb.ra.activeRange,Ha);this.ea.isNamedObjectViewMode&&
(Yb.UsedRange=t.v(Ha.oa.usedRange,Ha))}Yb.Title=Ha.workbookContext.WorkbookFileName;return Yb}Zkd(){w.h(this.$);if(!this.c7f){this.cTc=!0;const Ha=this.$.Kb.Bc("UserAction","HandlePageLayoutRendering");this.cSj();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${Ha.Ac} ms.`);Ha.stop()}}cSj(){const Ha=w.h(this.$).Da,Ab=Ha.rD();let Yb=!1,Bb=0;for(let Qb=0;Qb<Ab.length;Qb++){const sc=Ab[Qb],kb=sc.sf;kb&&kb.hasPageLayout()&&(Yb=!0,kb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
sc.Ad,4),Bb++)}Yb&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Ab.length}, number of blocks that require re-rendering is ${Bb}`),Ha.BBd())}}Object(b.a)(Sa,"PrintCommandHandler",null,[208,409]);var na=a(1077),ib=a(1289),Ib=a(1290);class ec extends h.a{constructor(Ha){super(Ha)}ld(){var Ha=f.AFrameworkApplication.fa.appSettings,Ab=this.$.va.DirectPrintSetting;Ha.DirectPrintIsEnabled=Ab.DirectPrintIsEnabled.toString();Ha.DirectPrintProbeIsEnabled=
Ab.DirectPrintProbeIsEnabled.toString();Ha.DirectPrintEnabledForInternetExplorer=Ab.DirectPrintEnabledForInternetExplorer.toString();Ha.DirectPrintSupportedMimeTypes=Ab.DirectPrintSupportedMimeTypes;Ha.DirectPrintSupportedPlugins=Ab.DirectPrintSupportedPlugins;Ha.DirectPrintImmersivePreviewPlugins=Ab.DirectPrintImmersivePreviewPlugins;Ha.DirectPrintMinimalSupportedEdgeVersion=Ab.DirectPrintMinimalSupportedEdgeVersion;Ha.DirectPrintEnabledForEdge=Ab.DirectPrintEnabledForEdge.toString();Ha=new na.a(Ha);
let Yb=null;Ab=null;try{Ab=window.navigator.mimeTypes}catch(Qb){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let Bb=null;try{Bb=window.navigator.plugins}catch(Qb){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Yb=new Ib.a(Ha,Ab,Bb,Ib.a.Vhf,Ib.a.pmf,new ib.a(f.AFrameworkApplication.ta.yX),f.AFrameworkApplication.ta.lE,Ib.a.qmf,(Qb,sc)=>new d.a(Qb,!1,sc),!1);if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&
x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.ie.get(116)){const Qb=n.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya);m.TaskExtensions.za(Qb,()=>{const sc=new Sa(this.$,Yb,Qb.result);this.Zc([sc])},this.$.ka)}else this.Zc([new Sa(this.$,Yb,null)])}static la(Ha){h.a.Nd(73,new ec(Ha))}}Object(b.a)(ec,"PrintCommandHandlerFactory",h.a,[]);a.d(F,"a",function(){return qb});const qb=()=>{c.a.Fa(ec.la)}},1147:function(u,F,a){var c=a(9),b=
a(0),e=a(222),f=a(49),d=a(37),h=a(15),n=a(89),m=a(83),x=a(242),r=a(621),y=a(208),t=a(116),v=a(35),w=a(39),C=a(238),B=a(44),z=a(6),A=a(36),E=a(70),I=a(590);class L extends C.a{constructor(qb,Ha){super(qb);this.u_j=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.nGb=()=>{const Ab=this.$Sh();if(Ab){this.$.BI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const Yb=E.a(this.$).hd.activityState;Yb[A.a.rZa]=z.a.download;Yb[I.a.XVc]=this.command}B.a(this.$).Rr(Ab.Errors)}};
this.iframe=qb;this.$=Ha;this.Gc.la("load",this.nGb)}get cci(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(qb,Ha){const Ab={};(qb=this.IDh(qb,Ab))&&w.a.qsc("dlfr",qb,Ab);this.command=Ha}IDh(qb,Ha){var Ab=qb.split("?");if(2!==Ab.length)return qb=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),qb;Ab=Ab[1].split("&");for(const Bb of Ab){var Yb=
Bb.split("=",2);if(2!==Yb.length){qb=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}Ab=Yb[0];this.u_j.includes(Ab)&&(Yb=decodeURIComponent(Yb[1]),Ha[Ab]=Yb,qb=y.a.ZJb(qb,Ab))}return qb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}$Sh(){try{return this.iframe.contentWindow.ewaResult}catch(qb){if(!this.$.ea.dc.isDivSyndicated){const Ha=window.document.referrer.match(RegExp("://(.[^/]+)/"));
h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<Ha.length?Ha[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.f7a}`);throw qb;}return null}}static Fwe(qb){let Ha=document.createElement("iframe");Ha.id="ewaFileLoader";Ha.style.cssText="height:0;width:0;display:none";Ha.src="about:blank";Ha.setAttribute("name","dlfr");Ha=qb.domElement.appendChild(Ha);return new L(Ha,
qb)}}Object(b.a)(L,"FileLoader",C.a,[]);var V=a(143),T=a(55);class H{constructor(qb,Ha){this.Tc=()=>{v.a.zg(E.a(this.$).hd.activityState,V.a.$Bd)||this.fva.reset()};this.$=Ha;this.umc=qb;this.ea=Ha.ea;this.ea.Wj(this.Tc);this.fva=L.Fwe(this.$)}noh(){const qb=this.EYg(this.$),Ha=this.$.userOperationManager.operationCount;0<Ha&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${Ha}`);this.$.userOperationManager.x4("DownloadACopyOperation.DownloadForkedFile");this.umc&&h.ULS.sendTraceTag(537154821,
0,50,"DownloadACopyOperation - Dataloss scenario");this.fva.downloadFile(qb,-21742208);d.TaskExtensions.za(T.Task.delay(1),()=>{this.ldf()},this.fva.ka,3)}dispose(){this.ea&&this.ea.tk(this.Tc);this.$=this.ea=null}ldf(qb=null){qb||(qb=this.$.Kb.Bc("LoadResource","DownloadACopyOperation"));!this.fva.cci&&qb.Ac<H.zuf?window.setTimeout(()=>{this.ldf(qb)},H.ooh):(qb.Ac>=H.zuf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),E.a(this.$).hd.QM())}EYg(qb){const Ha=new Sys.StringBuilder,
Ab=qb.workbookContext,Yb=qb.va;Ha.append(qb.Tna);Ha.append(Yb.FileHandlerRelativeUri);Ha.append("?id=");Ha.append(encodeURIComponent(y.a.ZJb(Ab.WorkbookUri,"sc")));qb.ea.Zb&&(Ha.append("&sessionId="),Ha.append(encodeURIComponent(qb.ea.sessionId)));Ha.append("&workbookType=FullForkedWorkbook");Ha.append("&dataloss=");Ha.append(this.umc?"true":"false");t.a.gpb(Ha,Yb);return Ha.toString()}}H.zuf=1E5;H.ooh=100;Object(b.a)(H,"DownloadACopyOperation",null,[2]);class D extends x.a{constructor(qb,Ha,Ab=!1){super(qb,
Ha);this.dEb=null;this.pEd=Yb=>{this.unsubscribe(Bb=>{Yb.remove_disposing(Bb)});this.ih(z.a.Yj);this.Jp()};this.umc=Ab}execute(qb){const Ha=Object(m.a)(7,qb.Ge);if(!Ha.cla)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.$od(qb),this.ih(z.a.idle),1;this.dEb||(this.dEb=new H(this.umc,Ha));this.dEb.noh();h.ULS.shipAssertTag(537154817,0,3!==E.a(Ha).gi.zu,"The current activity should not be closed.");return 1}$od(qb){const Ha=
Object(m.a)(7,qb.Ge),Ab=new r.a(Ha);this.subscribe(qb,this.pEd,Yb=>{Ab.add_disposing(Yb)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Ab.initialize();Ab.xg()}dispose(){n.a.Ia(this.dEb);this.dEb=null;super.dispose()}}Object(b.a)(D,"DownloadAForkedCopyActivity",x.a,[]);class G extends e.a{constructor(qb){super();this.$=qb;this.Fb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),
()=>{this.nb(new D(z.a.H2a,z.a.Yj,!0))},this.ka)}}Object(b.a)(G,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class J extends e.a{constructor(qb){super();this.$=qb;this.Fb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),()=>{this.nb(new D(z.a.unmergeableDownloadCopy,z.a.bpa))},this.ka)}}Object(b.a)(J,"DownloadAForkedCopyActivityFactory",e.a,[]);var M=a(84),Q=a(4),U=a(80),Z=a(27),P=a(106),S=a(25);class ja{constructor(qb,Ha,Ab){this.La=qb;this.Nxg=Ha;
this.k2=Ab}Ig(){this.La.Nb(S.a.tryMacOffice,P.a.frame,Object(M.a)(this,this.OYi,"onTryMacOffice"));this.La.Nb(S.a.Xfg,P.a.frame,Object(M.a)(this,this.qJf,"onTryMacOfficeFromViewer"));this.La.Nb(S.a.Wfg,P.a.frame,Object(M.a)(this,this.qJf,"onTryMacOfficeFromViewer"))}OYi(qb,Ha,Ab,Yb,Bb){if(1===Ab)return 32;Bb?(qb=Bb.SourceControlId,"btnjTryMacOfficeForWordEditor"===qb?w.a.lf(U.a.VZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===qb&&w.a.lf(U.a.VZ(22),"_blank",
void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.zpf();return 32}qJf(qb,Ha,Ab){if(1===Ab)return 32;switch(qb){case S.a.Xfg:w.a.lf(U.a.VZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case S.a.Wfg:w.a.lf(U.a.VZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}zpf(){w.a.lf(ja.lDi,"_blank",void 0,"LaunchMacTrialWindow")}get tzc(){return this.Nxg&&Z.a.isMac&&!Z.a.aqi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get SCj(){return this.tzc}static get lDi(){return U.a.MH("522401")}}
Object(b.a)(ja,"MacOfficeOffer",null,[467]);var X=a(82);class Y{constructor(qb,Ha,Ab){this.La=qb;this.Rxg=Ha;this.gHc=null;(this.oZb=Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&X.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Yb=>{this.gHc=Yb});this.k2=Ab}Ig(){this.La.Nb(S.a.tryOffice,P.a.frame,Object(M.a)(this,this.PYi,"onTryOffice"));this.La.Nb(S.a.tryOfficeThroughTellMe,
P.a.frame,Object(M.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Nb(S.a.$fg,P.a.frame,Object(M.a)(this,this.agg,"tryOfficeThroughViewer"));this.La.Nb(S.a.Zfg,P.a.frame,Object(M.a)(this,this.agg,"tryOfficeThroughViewer"))}PYi(qb,Ha,Ab,Yb,Bb){if(this.oZb&&1===Ab)return this.isFreemiumUpsellEnabled&&this.xNb?32:8;2===Ab&&(Bb?(qb=Bb.SourceControlId,"btnjTryOfficeForWordEditor"===qb?w.a.lf(U.a.VZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
qb?w.a.lf(U.a.VZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.vlc()):this.vlc());return 32}tryOfficeThroughTellMe(qb,Ha,Ab,Yb,Bb){if(this.oZb&&1===Ab)return this.isFreemiumUpsellEnabled&&this.xNb?32:8;2===Ab&&(Bb?(qb=Bb.SourceControlId,w.a.lf(U.a.MH("862405")+this.YYh(qb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):w.a.lf(U.a.MH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}agg(qb,Ha,Ab){if(this.oZb&&1===Ab)return this.isFreemiumUpsellEnabled&&
this.xNb?32:8;if(2===Ab)switch(qb){case S.a.$fg:w.a.lf(U.a.VZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case S.a.Zfg:w.a.lf(U.a.VZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get iyf(){return this.xNb}get zKi(){return this.xNb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get xNb(){return this.Rxg&&!Z.a.isMac}get isFreemiumUpsellEnabled(){let qb=!1;this.gHc&&(qb=this.gHc.isFreemiumUpsellEnabled());return qb}vlc(qb=null){let Ha=0;qb&&(Ha=qb);w.a.lf(Y.IWh(Ha),"_blank",void 0,
"LaunchOfficeOffer")}YYh(qb){let Ha=0;switch(qb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Ha=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Ha=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Ha=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Ha=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Ha=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Ha=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Ha=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Ha=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Ha=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Ha=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Ha=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Ha=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Ha=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Ha=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Ha=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Ha=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Ha=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Ha=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Ha=29}return 0===Ha?"":String.format("&pc={0:D}",Ha)}static IWh(qb){if(Z.a.$g)switch(qb){case 1:return U.a.MH("393806");case 2:return U.a.MH("393810");case 3:return U.a.MH("393809");case 5:return U.a.MH("393805")}else if(Z.a.Ap)switch(qb){case 1:return U.a.MH("521979");case 3:return U.a.MH("521980");case 5:return U.a.MH("521978");
case 2:return U.a.MH("522490")}else{if(2===qb)return U.a.MH("517778");if(1===qb)return U.a.VZ(30)}return U.a.MH("522402")}}Object(b.a)(Y,"OfficeTrialExperience",null,[463]);class va{Xh(qb){qb.register(Y,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").xc().Fc(()=>new Y(Q.AFrameworkApplication.ub,Q.AFrameworkApplication.sBb,Q.AFrameworkApplication.lcid));qb.register(ja,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").xc().Fc(()=>new ja(Q.AFrameworkApplication.ub,
Q.AFrameworkApplication.Jic,Q.AFrameworkApplication.lcid))}}Object(b.a)(va,"OpenInClientConfiguration",null,[4]);var N=a(553),ea=a(1359),Ca=a(38),la=a(1195),Ra=a(146),lb=a(152),Aa=a(224),da=a(14),aa=a(85),fa=a(108),Oa=a(87);const ba=qb=>{for(let Ha=0;Ha<qb.children.length;Ha++){const Ab=qb.children[Ha];Ab.style.position="relative";Ab.style.top=(Ab.parentNode.offsetHeight-Ab.offsetHeight)/2+"px"}},ka=qb=>qb.Ca.keyCode===aa.a.Mh||qb.Ca.keyCode===aa.a.bfa?(qb.Gb.click(),!0):!1,Pa=(qb,Ha,Ab,Yb,Bb,Qb,
sc)=>{const kb=document.createElement("a");kb.className="ProtocolLaunchingDialogButtonAnchor";kb.className+=" OICDialog";kb.id=qb;kb.setAttribute(Oa.a.Ld,Oa.a.pt);kb.style.padding="0";kb.style.margin="0";Yb&&Fa(Bb,Ha,Ab,Yb,kb);qb=document.createElement("span");qb.className="ProtocolLaunchingDialogButtonLabel";qb.innerText=Bb;kb.appendChild(qb);kb.tabIndex=0;Qb&&Aa.a.instance.sa(da.a.click,kb,Qb);sc&&fa.KeyInputManager.instance.sa(da.a.Fd,kb,sc);return kb},Fa=(qb,Ha,Ab,Yb,Bb)=>{var Qb=document.createElement("img");
Qb.alt=qb;Qb.className=lb.getImageClassWithCluster(Ab,Yb);Qb.src=Ha;Qb.setAttribute(Oa.a.Ld,Oa.a.ds);qb=document.createElement("span");qb.className="ProtocolLaunchingDialogImg32Container";qb.appendChild(Qb);Qb=document.createElement("span");Qb.className="ProtocolLaunchingDialogIconContainer";Qb.appendChild(qb);Bb.appendChild(Qb)};class oa{static get qg(){return Ra.a.iq(oa.ol,CommonUIStrings.l_OICLaunchDialogTitle)}}oa.ol="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(oa,"OICLaunchDialogHtml",null,[]);class La extends Ra.a{constructor(qb){super();this.$Va=this.uDa=null;this.jqa=!1;this.Dq=qb;this.qg=oa.qg;this.Rb=5;this.Fe="OICLaunchDialog";this.showDialog("",Object(M.a)(this,this.MKi,"oicLaunchDialogResultHandler"));this.v4f();this.mX("ProtocolLaunchingDialogTitle");4!==Q.AFrameworkApplication.ta.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.OI(this.uDa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}X$a(){this.uDa=Pa("BtnRichClient",this.Dq.Ytb,this.Dq.yzb,this.Dq.rnd,CommonUIStrings.l_OICLaunchRichClient,Object(M.a)(this,this.gHf,"onRichClientButtonClick"),ka);document.getElementById("OICLaunchRichClient").appendChild(this.uDa);ba(this.uDa);this.$Va=Pa("BtnReturn",this.Dq.Ytb,this.Dq.yzb,this.Dq.ydf,CommonUIStrings.l_OICReturnToOnlineClient,Object(M.a)(this,this.dHf,"onReturnButtonClick"),
ka);document.getElementById("OICReturnToApp").appendChild(this.$Va);ba(this.$Va)}dHf(){this.hide();this.Dq.idb();return!0}gHf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();Q.AFrameworkApplication.ub.processAction(S.a.RRa,2);return!0}MKi(){this.Dq.idb()}dispose(){this.jqa||(this.uDa&&(Aa.a.instance.Ba(da.a.click,this.uDa,Object(M.a)(this,this.gHf,"onRichClientButtonClick")),fa.KeyInputManager.instance.Ba(da.a.Fd,this.uDa,ka)),this.$Va&&(Aa.a.instance.Ba(da.a.click,
this.$Va,Object(M.a)(this,this.dHf,"onReturnButtonClick")),fa.KeyInputManager.instance.Ba(da.a.Fd,this.$Va,ka)),super.dispose(),this.jqa=!0)}}Object(b.a)(La,"OICLaunchDialog",Ra.a,[]);class Ea{static get qg(){return Ra.a.iq(Ea.ol,CommonUIStrings.l_OICDialogTitle)}}Ea.ol="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(Ea,"ProtocolLaunchingDialogV2Html",null,[]);a(421);var ca=a(107);class $a extends Ra.a{constructor(qb){super();this.ZVa=this.pfa=null;this.jqa=!1;this.Ppa=null;this.Dq=qb;this.qg=Ea.qg;this.Rb=5;this.Fe="ProtocolLaunchingDialog";this.mJc="OICRetryDialog";Q.AFrameworkApplication.Fi.$5a&&Q.AFrameworkApplication.Fi.Wvc();Q.AFrameworkApplication.Fi.Fg(new ca.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(M.a)(this,this.SId,"protocolLaunchingDialogResultHandler"));
this.v4f();this.mX("Issues");this.WYe();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}X$a(){const qb=document.getElementById("Issues");if(qb){Fa("",this.Dq.Ytb,this.Dq.yzb,this.Dq.rnd,qb);const Ha=document.createElement("span");Ha.className="WACDialogSectionTitle";Ha.innerText=5===this.Dq.jKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;qb.appendChild(Ha);ba(qb);qb.style.display="none"}Q.AFrameworkApplication.ta.Pa.mkd?
(this.ZVa=Pa("GiveFeedback",this.Dq.Ytb,this.Dq.yzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(M.a)(this,this.rpc,"onGiveFeedbackClick"),Object(M.a)(this,this.oDf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.ZVa),ba(this.ZVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===Q.AFrameworkApplication.ta.Pa.editMode||Q.AFrameworkApplication.Ylh?document.getElementById("ButtonEdit").style.display="none":
(this.pfa=Pa("Edit",this.Dq.Ytb,this.Dq.yzb,"",2===Q.AFrameworkApplication.ta.Pa.Hj?4===Q.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===Q.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(M.a)(this,this.QBf,"onEditClick"),Object(M.a)(this,this.UBf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.pfa),ba(this.pfa));0===
Q.AFrameworkApplication.ta.Pa.editMode&&!Q.AFrameworkApplication.sBb&&qb&&(qb.style.display="none")}YYe(){return this.Ppa?(this.OI(this.Ppa),!0):!1}WYe(){return this.pfa?(this.OI(this.pfa),!0):!1}UBf(qb){return this.xCd(qb,0)}oDf(qb){return this.xCd(qb,2)}cHf(qb){return this.xCd(qb,1)}xCd(qb,Ha){let Ab=!1;if(qb.Ca.keyCode===aa.a.Mh||qb.Ca.keyCode===aa.a.bfa)qb.Gb.click(),Ab=!0;else if(qb.Ca.keyCode===Sys.UI.Key.down||qb.Ca.keyCode===Sys.UI.Key.up)switch(Ha){case 1:Ab=this.WYe();break;case 0:Ab=this.YYe()}return Ab}QBf(){this.hide();
4===Q.AFrameworkApplication.ta.Pa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Dq.idb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Dq.Lkd());return!0}rpc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Dq.s$e();return!0}qqc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";Q.AFrameworkApplication.ub.processAction(S.a.RRa,2);return!0}SId(){this.Dq.idb()}switchToBackupMode(){var qb=
document.getElementById("ProtocolLaunchingDialogTitle");if(qb){qb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(qb=document.getElementById("Issues"))qb.style.display="block";(qb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!qb.children.length&&(this.Ppa=Pa("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(M.a)(this,this.qqc,"onRetryOICClick"),Object(M.a)(this,this.cHf,"onRetryOICKeyUp")),qb.appendChild(this.Ppa),ba(this.Ppa),this.pfa||this.YYe())}}dispose(){this.jqa||(this.pfa&&
(Aa.a.instance.Ba(da.a.click,this.pfa,Object(M.a)(this,this.QBf,"onEditClick")),fa.KeyInputManager.instance.Ba(da.a.Fd,this.pfa,Object(M.a)(this,this.UBf,"onEditKeyUp"))),this.ZVa&&(Aa.a.instance.Ba(da.a.click,this.ZVa,Object(M.a)(this,this.rpc,"onGiveFeedbackClick")),fa.KeyInputManager.instance.Ba(da.a.Fd,this.ZVa,Object(M.a)(this,this.oDf,"onGiveFeedbackKeyUp"))),this.Ppa&&(Aa.a.instance.Ba(da.a.click,this.Ppa,Object(M.a)(this,this.qqc,"onRetryOICClick")),fa.KeyInputManager.instance.Ba(da.a.Fd,
this.Ppa,Object(M.a)(this,this.cHf,"onRetryOICKeyUp"))),super.dispose(),this.jqa=!0)}}Object(b.a)($a,"ProtocolLaunchingDialog",Ra.a,[]);var Qa=a(134),Va=a(427);class fb extends Qa.StandardDialog{constructor(qb){super();this.Dq=qb;this.Fe="ProtocolLaunchingDialog";Q.AFrameworkApplication.Fi.$5a&&Q.AFrameworkApplication.Fi.Wvc();Q.AFrameworkApplication.ta.Pa.mkd&&this.tpe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(M.a)(this,this.rpc,"onGiveFeedbackClick"));fb.raf?(this.Rb=12,this.pc(1,
CommonUIStrings.l_CloseFile),this.pc(2,CommonUIStrings.l_OICDialogContinueHere),this.pc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Rb=4,this.pc(1,CommonUIStrings.l_OICDialogContinueHere),this.pc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.DEb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Dq.jKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(M.a)(this,this.SId,"protocolLaunchingDialogResultHandler"),null)}rpc(qb){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.lCf(qb)}qqc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");Q.AFrameworkApplication.ub.processAction(S.a.RRa,2)}SId(qb){fb.raf?3===qb?this.dZf():2===qb||0===qb?this.continueEditing():1===qb&&this.G4g():2===qb?this.dZf():(1===qb||0===qb)&&this.continueEditing()}G4g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");Q.AFrameworkApplication.ub.Zd(S.a.close,2,Va.a)}dZf(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(M.a)(this,
this.qqc,"onRetryOICClick"),0)}continueEditing(){4===Q.AFrameworkApplication.ta.Pa.editMode||Q.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===Q.AFrameworkApplication.ta.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Dq.idb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Dq.Lkd())}static get raf(){return Q.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===Q.AFrameworkApplication.ub.processAction(S.a.close,
1)}}Object(b.a)(fb,"StandardProtocolLaunchingDialog",Qa.StandardDialog,[]);var Ka=a(1240);class hb{}Object(b.a)(hb,"EditDocumentInClientParams",null,[]);class fc{static M9c(qb,Ha,Ab,Yb,Bb,Qb,sc=!1,kb=!1,Eb="",Gc=!1,zc=!1,yb=!1,gb="",Kb="",sd="",Sb=!1){const yc=new hb;yc.DocumentUrl=qb;yc.Mode=Ha;yc.Options=Ab;yc.Application=Yb;yc.SilentExternalHandler=sc;yc.EncodeUrl=kb;yc.CorrelationIdForWinClient=Eb;yc.NavigateUsingWindowOpen=Gc;yc.DescriptiveUnattemptedEnums=zc;yc.NoBrowserModalDialogs=yb;yc.SessionOrigin=
gb;yc.CorrelationId=Kb;yc.ClickTime=sd;yc.NewTelemetryDataIsEnabled=Sb;MSOJS.ClientUtils.EditDocumentInClient(yc,Bb,Qb)}}Object(b.a)(fc,"ClientUtils",null,[]);var dc=a(98),wb=a(145),Tb=a(474),xb=a(171),cb=a(823),jb=a(376),qa=a(164),za=a(72),Na=a(189);class ua{constructor(qb){this.jga=this.d9d=this.fWa=null;this.Djb=!1;this.gPc=this.ige=null;this.YSb=this.tE=this.gYb="";this.application=this.qC=0;this.MMj=this.fYd=!1;this.y_j=qb&&Q.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");Q.AFrameworkApplication.ub.E4(S.a.RRa)||
Q.AFrameworkApplication.ub.Nb(S.a.RRa,P.a.frame,Object(M.a)(this,this.pnj,"retryOpenInClientAction"));this.c$f=!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.qa("SilentExternalHandler")}get jKf(){return this.qC}Fyc(qb,Ha="",Ab=""){this.tE=Ab||xb.a.create().toString();this.gYb=Ha||Tb.a.d5e();this.YSb=qb}pnj(qb,Ha,Ab){return Ha.contextId!==P.a.frame?2:1===Ab?32:this.RRa()}get options(){let qb=0;Q.AFrameworkApplication.mlj&&(qb|=1);Q.AFrameworkApplication.openInClientEditOnly&&(qb|=4);this.JMj()&&
(qb|=64);return qb}JMj(){return!(2===this.application&&Q.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get Ytb(){return Q.AFrameworkApplication.tB}get yzb(){return Q.AFrameworkApplication.x6a}get ydf(){return""}get rnd(){return""}get icg(){return Q.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get aCc(){return this.ige||(this.ige=X.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.fYd||this.GCh()}idb(){this.MMj||this.YCh()}QRf(qb){this.y_j&&Z.a.$g?new La(this):
this.V4b(qb)}V4b(qb){const Ha=({lCa:qb}=this.uwi(qb)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Ha,qb);return Ha}rHa(qb,Ha,Ab,Yb,Bb,Qb){this.fWa=qb;this.d9d=Ha;this.jga=Qb;this.application=Ab;this.qC=Yb;Q.AFrameworkApplication.downloadCopyOnOpenInClient?this.wpf():Q.AFrameworkApplication.limitedEdit&&!Q.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?Q.AFrameworkApplication.x9f():this.lUg(Bb)}get LKi(){return!!Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}RRa(){this.LKi&&this.mzi();return this.V4b(this.Djb)}T1f(){const qb=new cb.a(qa.a.openInClient);qb.Values["ui-language"]=Q.AFrameworkApplication.lcid.toString();qb.Values[Ka.a.c7c]=Q.AFrameworkApplication.userSessionId;return this.jga.value.send(qb)?32:8}mzi(){dc.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Na.a,{inStaging:!0}))}Msj(qb){const Ha=new cb.a(qa.a.o2j);Ha.Values["ui-language"]=Q.AFrameworkApplication.lcid.toString();
Ha.Values[Ka.a.c7c]=Q.AFrameworkApplication.userSessionId;Ha.Values[jb.a.n2j]=qb;this.jga.value.send(Ha)}uwi(qb){this.Djb=qb;this.Msj(5===this.qC?ua.n_i:ua.p_i);return 5===this.qC?this.twi():this.ywi()}twi(){this.Dpf();return{returnValue:32,lCa:"HostEditUrl,"}}ywi(){let qb;var Ha=qb="";Q.AFrameworkApplication.kqe&&(Ha="|f|"+Q.AFrameworkApplication.userSessionId);const Ab=Q.AFrameworkApplication.fa.qa("IsAssignmentMode")&&Q.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
Q.AFrameworkApplication.isUnifiedHostMode||Z.a.Pxa,Yb=Q.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),Bb=Q.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(Q.AFrameworkApplication.ub.Onc){var Qb=Q.AFrameworkApplication.ub.b_(3588168074);Qb&&this.Fyc(Qb.epochClickTime,Qb.sessionOrigin,Qb.correlationId);this.Frf()}if(Q.AFrameworkApplication.nNf){qb+="NewOrder,";Qb=8;this.jga&&this.jga.value&&this.jga.value.isEnabled()&&Q.AFrameworkApplication.P1d&&(qb+="Post,",Qb=this.T1f());if(32===
Qb)return{returnValue:Qb,lCa:qb};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return Q.AFrameworkApplication.sm.Aab?(h.ULS.shipAssertTag(5566816,211,!!Q.AFrameworkApplication.sm.Aab),qb+="HostUrl,",{returnValue:Q.AFrameworkApplication.ta.j$a(Q.AFrameworkApplication.sm.Aab),lCa:qb}):this.fWa?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",Q.AFrameworkApplication.userSessionId),qb+="DocUrl,",fc.M9c(this.fWa,this.qC,
this.options,this.application,Object(M.a)(this,this.TBf,"onEditInClientSuccess"),Object(M.a)(this,this.SBf,"onEditInClientFailure"),this.c$f,Q.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ha,Ab,Yb,Bb,this.gYb,this.tE,this.YSb,Q.AFrameworkApplication.ub.Onc),{returnValue:32,lCa:qb}):{returnValue:8,lCa:qb}}qb+="OldOrder,";if(!this.fWa&&Q.AFrameworkApplication.sm.Aab)return this.jga&&this.jga.value&&this.jga.value.isEnabled()&&Q.AFrameworkApplication.P1d?(qb+="Post,",Ha=this.T1f()):(h.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Ha=8),32!==Ha?(h.ULS.shipAssertTag(22595484,211,!!Q.AFrameworkApplication.sm.Aab),qb+="HostUrl,",{returnValue:Q.AFrameworkApplication.ta.j$a(Q.AFrameworkApplication.sm.Aab),lCa:qb}):{returnValue:Ha,lCa:qb};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",Q.AFrameworkApplication.userSessionId);qb+="DocUrl,";fc.M9c(this.fWa,this.qC,this.options,this.application,Object(M.a)(this,this.TBf,"onEditInClientSuccess"),
Object(M.a)(this,this.SBf,"onEditInClientFailure"),this.c$f,Q.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ha,Ab,Yb,Bb,this.gYb,this.tE,this.YSb,Q.AFrameworkApplication.ub.Onc);return{returnValue:32,lCa:qb}}aXf(qb){Q.AFrameworkApplication.Tn.setDw(8981,qb)}TBf(qb){this.aXf(qb);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===qb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.icg||this.Dpf(),this.Frf()):this.fYd||this.closeApplication()}SBf(qb,Ha=0){h.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",qb,Ha);if(5===qb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Ab=!!this.d9d&&!this.Djb;let Yb=0;1===qb&&(Yb=2);6<=qb&&13>=qb&&(Yb=1,1===Ha&&(this.fYd=!0));this.aCc.zKi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",Yb),la.a.instance.Idh(this.Djb?Object(M.a)(this,this.Eyf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.Fyf,"oicErrorDialogHandlerNoCloseForced"),
Ab?Object(M.a)(this,this.tEf,"onLaunchDownload"):null,this.gMe(!1)?Object(M.a)(this,this.Kbi,"iHaveOfficeButtonHandler"):null,Yb,Ha)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Yb),la.a.instance.Gdh(this.Djb?Object(M.a)(this,this.Eyf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.Fyf,"oicErrorDialogHandlerNoCloseForced"),Ab?Object(M.a)(this,this.tEf,"onLaunchDownload"):null,Yb))}}Frf(){try{const qb=[Object.assign(new za.a,{name:"CorrelationId",string:this.tE}),
Object.assign(new za.a,{name:"SessionOrigin",string:this.gYb}),Object.assign(new za.a,{name:"ClickTime",string:this.YSb}),Object.assign(new za.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];wb.a("OpenInClientCompleted",!0,0,qb)}catch(qb){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+qb.toString())}}Dpf(){Q.AFrameworkApplication.ta&&Q.AFrameworkApplication.ta.Pa.Iv&&Q.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new fb(this):new $a(this)}Eyf(){this.closeApplication()}Fyf(){this.idb()}tEf(){this.wpf()}Kbi(){return this.gMe(!0)}gMe(qb){const Ha=
(Z.a.tjf||Z.a.ZH)&&!!Q.AFrameworkApplication.h8b;Ha&&qb&&(w.a.lf(Q.AFrameworkApplication.h8b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Ha}}ua.p_i="OpenInDesktop";ua.n_i="OpenInBrowser";Object(b.a)(ua,"AOpenInClientOperation",null,[]);var Xa=a(5),ha=a(204),ta=a(76),wa=a(59),db=a(328),Jb=a(47),Pb=a(46),eb=a(192),Ma=a(92),ob=a(29),Ia=a(11),Da=a(21),nb=a(478),Ua=a(250),W=a(253),sa=a(150),vb=a(589);class gc extends ua{constructor(qb,Ha,Ab){super(!0);this.Ra=new Ca.a;this.j9c=this.hZe=
!1;this.W4b=this.Sm=this.WDe=null;this.Tc=()=>{v.a.zg(E.a(this.$).hd.activityState,V.a.$Bd)||this.fva.reset()};this.QOi=Yb=>{this.aXf(Yb)};this.POi=()=>{this.uFj()};this.$=qb;this.ea=qb.ea;this.wK=Ha;this.businessBar=Ab;this.ea.Wj(this.Tc);this.fva=L.Fwe(this.$);this.v7g();qb.da.Ga(55,this);this.Bga=X.a.instance.Ub("Common.ISystemInitiatedFeedback")}get ydf(){return"EditInExcelWebApp_32x32x32"}get ka(){this.Sm=this.Sm||new eb.a;return this.Sm.token}get rnd(){return"excel32"}get icg(){return this.ea.dc.inWebPart}M6g(){this.QRf(this.hZe)}P8g(){const qb=
this.$;d.TaskExtensions.za(this.wK.value,Ha=>{this.rHa(qb.workbookContext.ClientUrl,Q.AFrameworkApplication.yZ,1,qb.isEditMode?2:0,!0,new N.a(()=>Ha.result))},this.ka,3)}Lkd(){0!==wa.a.Bg.editMode&&(this.$.rb.uy=!1)}s$e(){const qb={};qb[Xa.a.bac]=!1;qb[Xa.a.DQ]="OpenInExcel";this.$.Xc(802602464,ta.a.Db,8,qb)}J4c(){if(this.ea.Zb){var qb=this.$;qb.isEditMode&&d.TaskExtensions.za(this.wK.value,Ha=>{this.rHa(qb.workbookContext.ClientUrl,Q.AFrameworkApplication.yZ,1,2,!1,new N.a(()=>Ha.result))},this.ka,
3)}}gGe(){this.ea.Zb&&d.TaskExtensions.za(this.wK.value,qb=>{this.rHa(this.$.workbookContext.ClientUrl,Q.AFrameworkApplication.yZ,1,this.$.isEditMode?2:0,!1,new N.a(()=>qb.result))},this.ka,3)}Fyc(qb){super.Fyc(qb)}openInExcelClient(){this.ea.Zb&&(this.$.isEditMode||d.TaskExtensions.za(this.wK.value,qb=>{this.rHa(this.$.workbookContext.ClientUrl,Q.AFrameworkApplication.yZ,1,0,!1,new N.a(()=>qb.result))},this.ka,3))}openInBrowser(){this.ea.Zb&&d.TaskExtensions.za(this.wK.value,qb=>{this.rHa(this.$.workbookContext.ClientUrl,
Q.AFrameworkApplication.yZ,1,5,!1,new N.a(()=>qb.result))},this.ka,3)}downloadFile(qb){const Ha=this.Zye(qb);this.fva.downloadFile(Ha,qb);this.Pzi()}Pzi(){Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.Bga&&this.Bga.execute(qb=>qb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}fKf(qb,Ha=0){if(this.ea.Zb){var Ab=this.$;E.a(Ab).$Ma?this.gKf(qb,Ab):0<Ha?this.EKj(qb,
Ab,Ha):this.m8f(Ab)}}rHa(qb,Ha,Ab,Yb,Bb,Qb){this.$.rb.uy=!this.$.dc.inWebPart;this.hZe=Bb;this.W4b=null;this.j9c=!1;this.qUg(qb,Ha,Yb,Bb,Qb)}V4b(qb){const Ha=this.$.dc;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${Ha.inEmbedView}, InWebPart:${Ha.inWebPart}, DivSyndicated:${Ha.isDivSyndicated}, Mode:${this.$.isEditMode?ha.a.edit:ha.a.view}`);return gc.ekf()?(this.w4b(),fc.M9c(this.fWa,this.qC,this.options,1,this.QOi,this.POi,!1,Q.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),
32):super.V4b(qb)}GCh(){this.gYf();const qb=this.$;if(!this.ea.dc.inWebPart&&this.ea.Zb&&!qb.isEditMode){const Ha=new Ma.a(2145659238,ta.a.Db,this.$.Hc,0,null);this.WDe=Jb.a.instance.create(()=>{qb.Ja.Lb(Ha)},0,Pb.a.q_i)}}dispose(){this.ea&&this.ea.tk(this.Tc);n.a.rc([this.Ra,this.WDe,this.Sm]);this.$=this.ea=null}YCh(){this.gYf()}wpf(){Jb.a.instance.create(()=>{this.$.Ja.Lb(new Ma.a(-2028960985,ta.a.Db,0,30,null))},0,Pb.a.r_i,!0,!0)}lUg(qb){const Ha=this.$,Ab=E.a(this.$).hd.activityState;Ab[nb.a.woe]=
!0;Ha.isEditMode&&this.ea.Zb?(this.w4b(),B.a(Ha).Ls(new Ua.a(z.a.ey,5,()=>{Ha.BI(!1);Ab[W.a.Hq]=z.a.y4b;Ab[nb.a.rGg]=qb;Ab[V.a.ddd]=!0;Ha.isEditMode&&(Ab[V.a.KT]=1,Ab[V.a.DY]=!0,Ab[sa.a.s_b]=!0,Ab[sa.a.cWc]=!0);Ab[nb.a.zoe]=1455037301}))):this.QRf(qb)}aag(){const qb=Q.AFrameworkApplication.yZ;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.j$a(qb,!0)){const Ha=this.$.ea.dc;h.ULS.sendTraceTag(537154773,0,50,`Url:[${qb}] IsEmbedded:[${Ha.inEmbedView}] InWebPart:[${Ha.inWebPart}] DivSyndicated:[${Ha.isDivSyndicated}], Mode:[${this.$.isEditMode?
ha.a.edit:ha.a.view}]`)}}else this.fva.downloadFile(qb,-2028960985);this.j9c=!0;this.w4b()}Swi(){this.aCc.iyf&&this.aCc.vlc(1)}Twi(){this.aCc.iyf&&Ia.HelperMethods.lf(U.a.VZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}$wi(){Ia.HelperMethods.lf(U.a.VZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}axi(){Ia.HelperMethods.lf(U.a.VZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}Zye(qb){const Ha=new Sys.StringBuilder,Ab=this.$.workbookContext,
Yb=this.$.va;Ha.append(this.$.Tna);Ha.append(Yb.FileHandlerRelativeUri);Ha.append("?id=");Ha.append(encodeURIComponent(y.a.ZJb(Ab.WorkbookUri,"sc")));this.$.ea.Zb&&(Ha.append("&sessionId="),Ha.append(encodeURIComponent(this.$.ea.sessionId)));switch(qb){case -974518828:Ha.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Ha.append("&workbookType=FullWorkbook");break;case -1059172980:Ha.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:Ha.clear()}qb=!(this.$.isChangeGateEnabled("OfficeVSO:7396073_ShortenUrlToPreventOdsFailure")&&
-1059172980===qb);t.a.gpb(Ha,Yb,qb);return Ha.toString()}v7g(){ea.a.instance.H2g();const qb=this.$.va;MSOJS.ClientUtils.InitUrls(qb.RoamingAppsX86RootUrl,qb.RoamingAppsControlInstallerUrl,qb.RoamingAppsFirefoxExtensionUrl)}gYf(){const qb=this.$;this.ea.Zb||db.a.WId(qb,E.a(qb).hd);this.w4b();this.W4b&&this.W4b(this,this.j9c);qb.frame.Zt.rm(this.$.frame.Yaa());qb.frame.yX.rm(this.$.frame.Yaa());qb.rb.uy=!1;Da.h(qb).focus()}qUg(qb,Ha,Ab,Yb,Bb){const Qb=this.$;Q.AFrameworkApplication.ta&&!gc.ekf()&&(Qb.frame.Zt.Cn(Qb.frame.Yaa()),
Qb.frame.yX.Cn(Qb.frame.Yaa()));super.rHa(qb,Ha,1,Ab,Yb,Bb)}w4b(){const qb=this.$;E.a(qb).gi.activityName===z.a.openInExcelClient&&E.a(qb).hd.QM()}uFj(){const qb=ob.a.$c(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");B.a(this.$).Rr([qb])}EKj(qb,Ha,Ab){let Yb=null;const Bb=window.setTimeout(()=>{E.a(Ha).Huc(Yb);this.m8f(Ha)},Ab);Yb=()=>{E.a(Ha).$Ma&&(E.a(Ha).Huc(Yb),window.clearTimeout(Bb),this.gKf(qb,Ha))};E.a(Ha).eXc(Yb)}m8f(qb){const Ha=ob.a.$c(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");
B.a(qb).Rr([Ha])}gKf(qb,Ha){B.a(Ha).Ls(new Ua.a(z.a.ey,5,()=>{Ha.BI(!1);const Ab=E.a(Ha).hd,Yb=Ab.activityState;Yb[W.a.Hq]=z.a.GNe;Yb[vb.a.u_b]=Ha.ea.dc.hasUnsupportedFeaturesForEdit;Yb[I.a.XVc]=qb;Ab.rr(ob.a.t4(this.businessBar.Z9c,[1437034227]))}))}static ekf(){return 1<wa.a.getRegisteredEwaInstances().length}}Object(b.a)(gc,"OpenInExcelOperation",ua,[448,2]);class Bc extends e.a{constructor(qb){super();this.$=qb;this.Fb();Bc.u7g()}create(){if(this.$.da.Aa(55))this.nb(this.$.da.Aa(55));else{var qb=
f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),Ha=f.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya);d.TaskExtensions.za(T.Task.jJ(qb,Ha),()=>{this.nb(new gc(this.$,new N.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Ya)),Ha.result))},this.ka,3)}}static u7g(){Bc.Hyf||(Bc.Hyf=!0,(new va).Xh(X.a.instance),X.a.instance.resolve("Common.IOfficeTrialExperience").Ig(),X.a.instance.resolve("Common.IMacOfficeOffer").Ig())}}Bc.Hyf=!1;Object(b.a)(Bc,"OpenInClientFactory",e.a,
[]);var Sa=a(114),na=a(390);class ib extends Sa.a{constructor(qb,Ha){super(qb,Ha)}execute(qb){const Ha=Object(m.a)(7,qb.Ge);d.TaskExtensions.za(f.GetServiceTaskFactory.create(Ha.da,56,Ha.ka,0),Ab=>{Ha.downloadCopyOnOpenInClient?(qb.activityState[na.a.xoe]=!0,Ab.result.aag()):Ab.result.P8g()},Ha.ka,3);return 1}}Object(b.a)(ib,"OpenInExcelClientActivity",Sa.a,[]);class Ib extends e.a{constructor(qb){super();this.$=qb;qb.da.Ga(56,new Bc(qb));this.Fb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.Ya),()=>{this.nb(new ib(z.a.openInExcelClient,z.a.idle))},this.ka)}}Object(b.a)(Ib,"OpenInExcelClientActivityFactory",e.a,[]);a.d(F,"a",function(){return ec});const ec=()=>{c.a.Fa(qb=>{qb.da.Ga(57,new Ib(qb));qb.da.Ga(60,new J(qb));qb.da.Ga(63,new G(qb))})}},1150:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(85),e=a(4),f=a(108),d=a(14),h=a(89),n=a(54),m=a(30),x=a(27),r=a(12),y=a(238),t=a(1057),v=a(5),w=a(259),C=a(1058),B=a(707),z=a(1263),A=a(92);class E extends B.a{constructor(xb,
cb,jb){super(xb,cb);this.zs=!0;this.command=jb}Zm(xb){super.Zm(xb);this.businessBar.$.Ja.Lb(new A.a(this.command,xb,this.businessBar.$.Hc,10,null))}}Object(u.a)(E,"CommandActionBusinessBarEntry",B.a,[]);class I extends E{constructor(xb,cb,jb){super(xb,cb,jb)}KD(xb){super.KD(xb)}}Object(u.a)(I,"EditAttemptReadOnlyBusinessBarEntry",E,[]);var L=a(44);class V extends B.a{constructor(xb,cb,jb,qa){super(xb,cb);this.error=jb;this.options=qa;this.error&&this.options&2&&(this.message=this.error.Description);
this.error&&this.options&1&&(this.title=this.error.Caption);this.zs=!(qa&4)}Zm(xb){super.Zm(xb);this.error.Appearance&=-33;L.a(this.businessBar.$).Rr([this.error])}}Object(u.a)(V,"ErrorBusinessBarEntry",B.a,[]);class T extends V{constructor(xb,cb,jb,qa,za){super(xb,cb,jb,qa);this.command=za;this.tV=!0}dW(xb){super.dW(xb);this.businessBar.$.Ja.Lb(new A.a(this.command,xb,this.businessBar.$.Hc,10,null))}}Object(u.a)(T,"ErrorAndCommandBusinessBarEntry",V,[]);var H=a(13);class D{constructor(xb,cb,jb,qa,
za,Na,ua,Xa,ha){this.vJ=this.C8=this.pP=0;this.Asg=xb;this.VPj=cb;this.AP=jb;this.Pwg=ua;this.Qjb=m.a.mw(ha);this.Qug=ha;this.o6d=Xa;0!==qa&&(this.pP=qa);0!==za&&(this.C8=za);0!==Na&&(this.vJ=Na)}get title(){return D.ga(this.VPj)}get message(){return D.ga(this.AP)}get messageId(){return this.AP}get n0a(){return this.Asg}get actionButton(){return D.ga(this.pP)}get ysa(){return D.ga(this.C8)}get link(){return D.ga(this.vJ)}get Ek(){return this.Pwg}get M2b(){return this.o6d}get hash(){return this.Qjb}get alt(){const {BusinessBarControl:xb}=
a(1150);switch(this.Ek){case xb.Wia:return D.ga(26);case xb.oA:return D.ga(25);case xb.Ci:return D.ga(24);default:return D.ga(0)}}get S$c(){return this.Qug}set M2b(xb){this.o6d=xb}static ga(xb){return H.a.instance.ga(xb)}}Object(u.a)(D,"EwaBusinessBarEntry",null,[]);class G extends D{constructor(xb,cb,jb,qa,za,Na,ua,Xa){super(xb,0,cb,jb,qa,za,Na,ua,Xa)}get title(){return""}}Object(u.a)(G,"EwaNoTitleBusinessBarEntry",D,[]);var J=a(71);class M extends B.a{constructor(xb,cb){super(xb,cb);this.tV=this.zs=
!0}Zm(xb){super.Zm(xb);this.set_visible(!1);this.businessBar.$.EI();this.businessBar.$.Ja.Lb(new A.a(1038998010,xb,this.businessBar.$.Hc,10,null))}dW(xb){super.dW(xb);this.businessBar.$.Ja.Lb(new A.a(-722953877,xb,this.businessBar.$.Hc,10,null))}KD(xb){this.businessBar.removeEntry(55);J.g(xb)}}Object(u.a)(M,"ExternalLinksEnableContentBusinessBarEntry",B.a,[]);class Q extends B.a{constructor(xb,cb){super(xb,cb);this.zs=!0;this.tV=!1}Zm(xb){super.Zm(xb);this.businessBar.$.Ja.Lb(new A.a(-722953877,xb,
this.businessBar.$.Hc,10,null))}KD(xb){this.businessBar.removeEntry(5);J.g(xb)}}Object(u.a)(Q,"ExternalLinksShowErrorBusinessBarEntry",B.a,[]);var U=a(11);class Z extends B.a{constructor(xb,cb,jb){super(xb,cb);this.Zyb=jb;this.zs=!0}Zm(xb){super.Zm(xb);U.HelperMethods.kW(this.businessBar.$.GG,this.Zyb,this.businessBar.$.KS)}}Object(u.a)(Z,"HelpButtonBusinessBarEntry",B.a,[]);class P extends B.a{constructor(xb,cb,jb){super(xb,cb);this.Zyb=jb;this.Bwa=!0}Ema(xb){super.Ema(xb);U.HelperMethods.kW(this.businessBar.$.GG,
this.Zyb,this.businessBar.$.KS)}}Object(u.a)(P,"HelpTextBusinessBarEntry",B.a,[]);var S=a(76);class ja extends B.a{constructor(xb,cb,jb,qa){super(xb,cb);this.Zyb=jb;this.command=qa;this.Bwa=!0;this.zs=1461300262!==qa}Zm(xb){super.Zm(xb);this.businessBar.$.Ja.Lb(new A.a(this.command,xb,this.businessBar.$.Hc,10,null))}Ema(xb){super.Ema(xb);const cb=new A.a(-859308420,xb,this.businessBar.$.Hc,12,null);this.businessBar.$.Ja.Lb(cb,{[S.a.og]:"HelpID="+this.Zyb,["InputMethod"]:xb,[S.a.Jc]:v.a.wV,[v.a.Loa]:!0})}}
Object(u.a)(ja,"HelpTextTaskPaneAndCommandBusinessBarEntry",B.a,[]);class X extends B.a{constructor(xb,cb){super(xb,cb);this.tV=this.zs=!0}Zm(xb){super.Zm(xb);this.set_visible(!1);this.businessBar.$.EI();this.businessBar.$.Ja.Lb(new A.a(-1081442996,xb,this.businessBar.$.Hc,10,null))}dW(xb){super.dW(xb);this.businessBar.$.Ja.Lb(new A.a(1702917262,xb,this.businessBar.$.Hc,10,null))}KD(xb){this.businessBar.removeEntry(59);J.g(xb)}}Object(u.a)(X,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",B.a,
[]);var Y=a(1060);class va extends B.a{constructor(xb,cb){super(xb,cb);(this.policyManager=xb.$.da.Aa(274))?(this.message=this.policyManager.fsc,this.title=this.policyManager.title,this.Bwa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Ema(xb){super.Ema(xb);(xb=this.policyManager.BTi)&&xb(null)}}Object(u.a)(va,"PolicyBusinessBarEntry",B.a,[]);var N=a(1059),ea=a(1062),
Ca=a(1061);a(421);var la=a(145),Ra=a(25);class lb extends B.a{constructor(xb,cb){super(xb,cb);this.zs=!0;this.title=""}Zm(xb){super.Zm(xb);la.c(Ra.a.tIi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(u.a)(lb,"UnsupportedBrowserBusinessBarEntry",B.a,[]);var Aa=a(1056),da=a(1288);class aa extends B.a{constructor(xb,cb){super(xb,cb);this.WCa=da.a.z6b();this.zs=!0;this.tV=this.WCa.F_j;this.title=this.WCa.title;this.message=this.WCa.message}get actionButton(){return this.WCa.oze}get ysa(){return this.WCa.qze}Zm(xb){super.Zm(xb);
this.WCa.Pzf(null)}dW(xb){super.dW(xb);this.WCa.Szf(null)}KD(xb){super.KD(xb);this.WCa.AMe(null)}}Object(u.a)(aa,"WildFireMobileAppBusinessBarEntry",B.a,[]);var fa=a(247),Oa=a(22),ba=a(215),ka=a(159),Pa=a(42),Fa=a(7),oa=a(171),La=a(1063),Ea=a(72),ca=a(132),$a=a(223),Qa=a(1);class Va extends B.a{constructor(xb,cb,jb,qa){super(xb,cb);Qa.EwaSettings.getBooleanFeatureGate($a.a.eB,!1)?(this.officeScriptsCommandManager=jb.da.Aa(519),c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager)):(this.automateCommandManager=
jb.da.Aa(352),c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager));this.id=oa.a.create();this.$=jb;this.title=H.a.instance.ga(2276);this.message="";this.pXd=H.a.instance.ga(2272);this.Blg=H.a.instance.ga(2273);this.zlg=H.a.instance.ga(2274);this.QFe=H.a.instance.ga(2275);this.update(qa)}update(xb){this.scriptLink=xb.scriptLink;this.runStatus=xb.runStatus;this.buttonText=xb.buttonText||"";this.ozi(xb.clickId);this.ulj();"preparing"===this.runStatus?(this.aBa(0),this.message=String.format(H.a.instance.mb(208),
this.buttonText),this.zs=!0,this.Zra=this.pXd,this.Hrb=this.Rga=this.qab):"running"===this.runStatus?(this.aBa(0),this.message=String.format(H.a.instance.mb(207),this.buttonText),this.zs=!0,this.Zra=this.pXd,this.Hrb=this.Rga=this.qab):"succeeded"===this.runStatus?(this.aBa(0),this.message=String.format(H.a.instance.mb(210),this.buttonText),"true"===xb.hasLogs?(this.zs=!0,this.Zra=this.zlg,this.Rga=this.DJf,this.tV=!0,this.mYc=this.Blg,this.nYc=this.EJf):(this.zs=!0,this.Zra=this.Blg,this.Rga=this.EJf)):
"runFailed"===this.runStatus?(this.aBa(1),this.message=String.format(H.a.instance.mb(209),this.buttonText),this.q6a=Tb.Wia,"true"===xb.hasLogs?(this.zs=!0,this.Zra=this.zlg,this.Rga=this.DJf,"false"===xb.isOwner&&(this.tV=!0,this.mYc=this.QFe,this.nYc=this.UAf)):"false"===xb.isOwner&&(this.zs=!0,this.Zra=this.QFe,this.Rga=this.UAf)):"fetchFailed"===this.runStatus?(this.aBa(1),this.q6a=Tb.Wia,this.message=String.format(H.a.instance.mb(211),this.buttonText)):"canceled"===this.runStatus?(this.aBa(0),
this.q6a=Tb.oA,this.message=String.format(H.a.instance.mb(213),this.buttonText)):"alreadyRunning"===this.runStatus?(this.aBa(5),this.q6a=Tb.oA,this.message=String.format(H.a.instance.mb(212),this.buttonText),this.zs=!0,this.Zra=this.pXd,this.Hrb=this.Rga=this.qab):"initializing"===this.runStatus&&(this.aBa(0),this.q6a=Tb.Ci,this.message=H.a.instance.ga(2277))}get Ek(){return this.q6a}get actionButton(){return this.Zra}get ysa(){return this.mYc}Zm(xb){super.Zm(xb);this.Rga&&this.Rga()}dW(xb){super.dW(xb);
this.ysa&&this.nYc()}KD(xb){super.KD(xb);this.Hrb&&this.Hrb()}ulj(){this.message="";this.q6a=Tb.Ci;this.zs=!1;this.Zra="";this.Rga=void 0;this.tV=!1;this.mYc="";this.nYc=void 0;this.hideCloseButton=!1;this.Hrb=void 0}qab(){const xb=oa.a.create().toString();Qa.EwaSettings.getBooleanFeatureGate($a.a.eB,!1)?this.officeScriptsCommandManager.Ekd(xb):this.automateCommandManager.Ekd(xb);this.Vlc(-2186799,xb)}DJf(){const xb=oa.a.create().toString();Qa.EwaSettings.getBooleanFeatureGate($a.a.eB,!1)?this.officeScriptsCommandManager.Dkd(xb):
this.automateCommandManager.Dkd(xb);this.Vlc(1036446140,xb)}EJf(){const xb=oa.a.create();if(this.scriptLink){const cb=new La.b(this.scriptLink);Qa.EwaSettings.getBooleanFeatureGate($a.a.eB,!1)?this.officeScriptsCommandManager.syb(this.id.toString(),JSON.stringify(cb),xb):this.automateCommandManager.syb(this.id.toString(),JSON.stringify(cb),xb)}this.Vlc(-585097204,xb.toString())}UAf(){const xb=oa.a.create().toString();Qa.EwaSettings.getBooleanFeatureGate($a.a.eB,!1)?this.officeScriptsCommandManager.Ckd(xb):
this.automateCommandManager.Ckd(xb);this.Vlc(-639858579,xb)}ozi(xb){const cb=[];cb.push(Object(Fa.a)(new Ea.a,{name:"id",string:this.id.toString()}));cb.push(Object(Fa.a)(new Ea.a,{name:"hasScriptLink",bool:!!this.scriptLink}));cb.push(Object(Fa.a)(new Ea.a,{name:"runStatus",string:this.runStatus}));cb.push(Object(Fa.a)(new Ea.a,{name:"clickId",string:xb}));cb.push(Object(Fa.a)(new Ea.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));la.a(ca.a.EKi,void 0,void 0,cb)}Vlc(xb,cb){const jb=
[];jb.push(Object(Fa.a)(new Ea.a,{name:"id",string:this.id.toString()}));jb.push(Object(Fa.a)(new Ea.a,{name:"hasScriptLink",bool:!!this.scriptLink}));jb.push(Object(Fa.a)(new Ea.a,{name:"runStatus",string:this.runStatus}));jb.push(Object(Fa.a)(new Ea.a,{name:"clickId",string:cb}));la.d(xb,void 0,void 0,void 0,void 0,void 0,jb)}}Object(u.a)(Va,"OfficeScriptsRunStatusBusinessBarEntry",B.a,[]);var fb=a(47);class Ka extends E{constructor(xb,cb,jb,qa,za,Na){super(xb,cb,jb);fb.a.instance.create(()=>{this.showCallout(cb,
qa)},za,Na,!0,!0)}showCallout(xb,cb){if(this.businessBar&&this.businessBar.fla(xb.n0a)&&this.nte()){xb=new A.a(-847286761,0,this.businessBar.$.Hc,0,null);var jb={};jb.CalloutName=cb;Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?jb.Target=this.rK():jb.Target=Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.pP.domElement;this.businessBar.$.Ja.Lb(xb,jb)}}nte(){return!0}}
Object(u.a)(Ka,"CalloutBusinessBarEntry",E,[]);class hb extends Ka{constructor(xb,cb,jb,qa,za,Na){super(xb,cb,jb,qa,za,Na)}nte(){if(!Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const xb=this.businessBar.$.da.Aa(465);return xb&&xb.Owc?!1:!0}}Object(u.a)(hb,"OptimizeWorkbookCalloutBusinessBarEntry",Ka,[]);var fc=a(19);class dc extends B.a{constructor(xb,cb,jb){super(xb,cb);this.update(jb)}update(xb){this.title=
xb.title?xb.title:"";this.message=xb.message?xb.message:"";this.hideCloseButton=!!xb.hideCloseButton}}Object(u.a)(dc,"MsFormsDataSyncStatusBusinessBarEntry",B.a,[]);class wb extends B.a{constructor(xb,cb,jb,qa){super(xb,cb);this.tV=this.zs=!0;this.$5i=jb;this.JPg=qa}Zm(xb){super.Zm(xb);this.businessBar.$.Ja.Lb(new A.a(this.$5i,xb,this.businessBar.$.Hc,10,null))}dW(xb){super.Zm(xb);this.businessBar.$.Ja.Lb(new A.a(this.JPg,xb,this.businessBar.$.Hc,10,null))}}Object(u.a)(wb,"DualCommandActionsBusinessBarEntry",
B.a,[]);a.d(F,"BusinessBarControl",function(){return Tb});class Tb extends y.a{constructor(xb,cb){super(cb);this.lIh=r.DOMElementExtensions.Gr+",div";this.qQ=Array(70);this.Lm=!1;this.hW=jb=>{if(jb.Ca.keyCode===b.a.Yy){var qa=this.mc.querySelectorAll(this.lIh);const za=r.DOMElementExtensions.um(qa);qa=r.DOMElementExtensions.oB(qa);return r.DOMElementExtensions.hBa(jb.Ca,za,qa)}return!1};this.jb=xb;this.set_visible(!1);this.addCssClass(t.a.$sh);Qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)&&e.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&this.addCssClass(t.a.bth);f.KeyInputManager.instance.sa(d.a.Pb,this.mc,this.hW);w.a(xb).di(this)}get de(){return fa.a.i0c}get mc(){return this.domElement}get Hf(){return this.get_visible()}get $(){return this.jb}kg(xb,cb){cb||r.DOMElementExtensions.setFocus(this.domElement.firstChild);return!cb}mh(xb){return r.DOMElementExtensions.Af(this.mc,xb)}sj(){}dk(){}dispose(){this.Lm||(f.KeyInputManager.instance.Ba(d.a.Pb,this.mc,this.hW),h.a.rc(this.qQ),
this.qQ=Array(70),this.jb=null,super.dispose(),this.Lm=!0)}fla(xb){if(!this.get_visible())return!1;xb=this.qQ[xb];return!!xb&&xb.isVisible}qfd(xb){return this.fla(xb)?this.qQ[xb].rK():null}cF(xb){return!!this.qQ[xb]}vQb(xb,cb){if(xb=this.qQ[xb])xb.update(cb),xb.vWj()}DC(xb,cb,jb=null,qa=null){let za=!1;if(this.cF(xb))jb=this.qQ[xb].get_visible();else{this.set_visible(!0);const ua=Tb.Y8e()[xb];this.qQ[xb]=this.O3(xb,cb,jb,qa);jb=!1;za=!0;qa="";let Xa=0;cb&&(qa=cb.MessageIdName,Xa=cb.MessageId);const ha=
ua.S$c;var Na=Pa.PageLoadTrackingInfo.instance.gwa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${xb}, time from app interactive: ${Na}`);Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(Na=this.qQ.filter(ta=>null!=ta).length,1<Na&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${Na.toString()}`));Qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===ua.M2b||ka.a(this.$).nNd(ua.hash,
qa,Xa,n.a.eDc,!0,1,cb,ha)}jb||!z.a.gec().includes(xb)&&!za||(this.qQ[xb].set_visible(!0),this.$.EI())}removeEntry(xb){return this.Uej(xb)}uLd(){h.a.rc(this.qQ);this.qQ=Array(70);this.set_visible(!1)}Uej(xb){if(!this.cF(xb))return!1;h.a.Ia(this.qQ[xb]);this.qQ[xb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.EI();return!0}O3(xb,cb,jb=null,qa=null){const za=Tb.Y8e()[xb],Na=!!(this.$.qd&64);switch(xb){case 2:case 4:case 23:case 25:case 26:case 36:case 35:xb=new B.a(this,za);break;
case 12:case 29:case 30:case 31:case 32:case 57:xb=Na?new E(this,za,-8805455):new B.a(this,za);break;case 34:xb=Na?new wb(this,za,-8805455,-104572626):new B.a(this,za);break;case 22:xb=new I(this,za,-8805455);break;case 46:case 45:xb=Na?new T(this,za,cb,0,-8805455):new V(this,za,cb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:xb=new V(this,za,cb,0);break;case 19:xb=new B.a(this,za);break;case 47:xb=new V(this,za,cb,0);break;case 6:case 14:xb=new Z(this,za,cb.HelpTopicId);break;case 67:case 65:xb=
new P(this,za,cb.HelpTopicId);break;case 37:xb=new P(this,za,v.a.Uhh);break;case 38:xb=new B.a(this,za);break;case 68:xb=new I(this,za,924877417);break;case 16:xb=new B.a(this,za);xb.title=m.a.Hg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);xb.message=m.a.Hg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:xb=new E(this,za,-1762562205);xb.hideCloseButton=!0;break;case 20:xb=new aa(this,za);break;case 21:case 56:xb=new B.a(this,za);break;case 28:xb=new B.a(this,
za);break;case 24:xb=new lb(this,za);break;case 27:xb=new va(this,za);break;case 39:xb=new Aa.a(this,za);break;case 40:xb=new C.a(this,za);break;case 41:xb=new N.a(this,za);break;case 42:xb=new Y.a(this,za);break;case 48:xb=new B.a(this,za);break;case 49:xb=new B.a(this,za);break;case 50:xb=new B.a(this,za);break;case 51:xb=new B.a(this,za);break;case 52:xb=new B.a(this,za);break;case 53:xb=new Ca.a(this,za);break;case 54:xb=new ea.a(this,za);break;case 55:xb=new M(this,za);break;case 5:xb=new Q(this,
za);break;case 58:xb=new E(this,za,-1753056834);cb?(cb=cb.Directive,Oa.a.Tq(cb)||"&nbsp;"===cb||(xb.message=cb)):jb&&(xb.message=jb);break;case 59:xb=new X(this,za);break;case 60:xb=new B.a(this,za);break;case 63:xb=new P(this,za,v.a.PJi);break;case 61:xb=new ja(this,za,v.a.cUg,-8805455);break;case 66:xb=new ja(this,za,v.a.oaj,1461300262);break;case 62:xb=new hb(this,za,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");xb.message=jb;break;case 64:xb=new Va(this,za,this.$,
qa);break;case 69:xb=new dc(this,za,qa);break;default:xb=new V(this,za,cb,7)}xb.A5c();return xb}static Y8e(){let xb;xb=ba.a.uNa()?261:260;return Tb.dze||(Tb.dze=[new D(0,276,277,278,0,0,Tb.Wia,1,"BB_UnableToRefreshLock"),new D(1,276,277,278,0,0,Tb.Wia,1,"BB_UnableToRefreshLockExpected"),new D(2,268,269,0,0,0,Tb.oA,5,"BB_WorkbookAlmostTooLarge"),new D(3,270,271,272,0,0,Tb.Wia,1,"BB_WorkbookTooLarge"),new D(4,259,xb,0,0,0,Tb.oA,5,"BB_ExternalWorkbookLinksDisabled"),new D(5,263,262,264,0,0,Tb.Wia,1,
"BB_ExternalWorkbookLinksShowError"),new D(6,265,266,267,0,0,Tb.Ci,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new D(7,251,252,253,0,0,Tb.Ci,5,"BB_UnsupportedFeatures"),new D(8,0,0,0,0,0,Tb.Ci,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new D(9,0,0,0,0,0,Tb.Ci,0,"BB_CollabDataStringsLocaleMismatch"),new D(10,0,0,0,0,0,Tb.Ci,0,"BB_CollabDataLocaleMismatch"),new D(11,279,280,281,0,0,Tb.Wia,1,"BB_LastGenericStatusError"),new D(12,282,283,284,0,0,Tb.oA,5,"BB_ScratchPadWarning"),new D(13,285,286,
287,0,0,Tb.Wia,1,"BB_AuthenticationLost"),new D(14,288,289,290,0,0,Tb.oA,5,"BB_OdfCompatibilityIssues"),new D(15,0,575,0,0,0,Tb.oA,5,"BB_PivotChartInteractivityMissingWarning"),new D(16,0,0,0,0,0,Tb.Ci,2,"BB_WorkbookIsIrmProtected"),new D(17,0,0,0,0,0,Tb.Ci,0,"BB_BIFeatureNotAvailable"),new D(18,291,292,287,0,0,Tb.oA,5,"BB_AnonymousCreateMode"),new D(19,254,255,0,0,0,Tb.oA,5,"BB_UnsupportedInteractiveReportEditing"),new D(20,0,0,0,0,0,Tb.Ci,0,"BB_MobileAppCampaignBizBar"),new D(21,297,298,0,0,0,Tb.Ci,
0,"BB_TransientServerCommunicationFailures"),new D(22,1638,1649,1650,0,0,Tb.Ci,5,"BB_EditAttemptInReadOnly"),new D(23,1638,1649,0,0,0,Tb.Ci,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new D(24,0,U.HelperMethods.QVj(),1627,0,0,Tb.Ci,3,"BB_UnsupportedBrowser"),new D(25,300,301,0,0,0,Tb.Ci,2,"BB_ReadOnlyPermissions"),new D(26,302,303,0,0,0,Tb.Ci,2,"BB_DocumentIsIrmProtectedWarning"),new D(27,0,0,0,0,0,Tb.oA,5,"BB_PolicyWarningMessage"),new D(28,1281,299,0,0,0,Tb.Ci,0,"BB_WorkingOnIt"),new D(29,1638,
1636,1637,0,0,Tb.Ci,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new D(30,1651,1652,1653,0,0,Tb.Ci,5,"BB_WorkbookIsReadOnlyRecommended"),new D(31,1638,1654,1655,0,0,Tb.Ci,5,"BB_WorkbookHasPasswordToModify"),new D(32,1638,1656,1659,0,0,Tb.Ci,3,"BB_LegacySharedWorkbookEditWarning"),new D(33,1646,1657,253,0,0,Tb.Ci,5,"BB_LegacyConnectionsWarning"),new D(34,1638,1954,1955,1956,0,Tb.Ci,0,"BB_TooManyLoadBlockingFloatingObjects"),new D(35,1647,1648,0,0,0,Tb.Ci,2,"BB_GroupedSlicers"),new D(36,313,314,0,
0,0,Tb.oA,5,"BB_ThirdPartyAddinDisabled"),new D(37,1780,1781,0,0,1782,Tb.Ci,5,"BB_FinanceLinkedEntityDisclaimerBar"),new D(38,1809,1810,0,0,0,Tb.oA,5,"BB_WolframDeprecationAlertBar"),new D(39,0,0,0,0,0,Tb.Ci,0,"BB_WacGdprNotice"),new D(40,0,0,0,0,0,Tb.Ci,0,"BB_AutomaticSensitivityLabel"),new D(41,0,0,0,0,0,Tb.Ci,0,"BB_RecommendedSensitivityLabel"),new D(42,0,0,0,0,0,Tb.Ci,0,"BB_MandatorySensitivityLabel"),new D(43,315,316,317,0,0,Tb.Ci,0,"BB_LocalStorageDisabled"),new D(44,632,633,0,0,0,Tb.Ci,0,"BB_AutoRefreshDisabled"),
new D(45,1011,1009,1013,1310,0,Tb.Ci,4,"BB_CorruptedFileRepaired"),new D(46,1012,1010,1013,1310,0,Tb.Ci,5,"CorruptedOdsFileRepaired"),new D(47,273,274,275,0,0,Tb.oA,5,"BB_MinorVersionLimitReached"),new D(48,304,305,0,0,0,Tb.oA,5,"BB_SensitivityApplicationGenericError"),new D(49,306,308,0,0,0,Tb.oA,5,"BB_SensitivityApplicationTooLargeFileError"),new D(50,307,308,0,0,0,Tb.oA,5,"BB_SensitivityApplicationLabelNotSupportedError"),new D(51,309,310,0,0,0,Tb.oA,5,"BB_SensitivityApplicationLabelDisabledError"),
new D(52,311,312,0,0,0,Tb.oA,5,"BB_SensitivityApplicationMandatoryConflictError"),new D(53,0,0,0,0,0,Tb.oA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new D(54,0,0,0,0,0,Tb.oA,5,"BB_SensitivityApplicationSetLabelError"),new D(55,2113,2114,2115,2118,0,Tb.Ci,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new D(56,297,298,0,0,0,Tb.Ci,0,"BB_NetworkDown"),new D(57,318,319,320,0,0,Tb.Ci,2,"BB_DefaultToViewDueToCogs"),new D(58,1806,1807,1808,0,0,Tb.Ci,1,"BB_RefreshLinkedEntityErrorBar"),
new D(59,1783,1784,1785,1786,0,Tb.Ci,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new G(60,250,0,0,0,Tb.Ci,5,"BB_CanvasHealth"),new D(61,1014,1015,1310,0,1016,Tb.Ci,5,"BB_MismatchedFileFormatConverted"),new D(62,2232,0,2234,0,0,Tb.Ci,5,"BB_OptimizeWorkbook"),new D(63,321,322,0,0,323,Tb.Ci,0,"BB_NovModePostDepreciation"),new D(64,0,0,0,0,0,Tb.Ci,0,"BB_OfficeScriptsRunning"),new D(65,2208,2209,0,0,2211,Tb.Ci,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new D(66,324,325,0,0,326,Tb.Ci,5,"BB_ReadOnlyPivotTable"),
new D(67,2208,2210,0,0,2211,Tb.Ci,0,"BB_PowerQueryRefreshHostNotSupported"),new D(68,1053,x.a.$ic?1055:1054,1052,0,0,Tb.Ci,4,"BB_RefreshPageAfterEnablingTheExtension"),new D(69,0,0,0,0,0,Tb.Ci,0,"BB_MsFormsDataSyncStatus")])}}Tb.Wia=fc.a.Zvh;Tb.oA=fc.a.awh;Tb.Ci=fc.a.$vh;Tb.dze=null;Object(u.a)(Tb,"BusinessBarControl",y.a,[34])},1153:function(u,F,a){var c=a(9);u=a(0);var b=a(694),e=a(49),f=a(37),d=a(15),h=a(1072),n=a(148),m=a(24),x=a(76),r=a(58);class y{constructor(ua){this.options=null;this.options=
ua}}Object(u.a)(y,"MacroRecorderRangeCustomSortedPayload",null,[108]);var t=a(957),v=a(958),w=a(40),C=a(374),B=a(188),z=a(283),A=a(142),E=a(29),I=a(282),L=a(1),V=a(184),T=a(22),H=a(281),D=a(21),G=a(802),J=a(751),M=a(261),Q=a(209),U=a(13),Z=a(134);class P{constructor(ua){this.vw=Xa=>{switch(Xa){case 0:this.KOa("Cancel");break;case 1:this.KOa("Expand and sort");this.aWe(!0);break;case 2:this.KOa("Just sort"),this.aWe(!1)}};this.aWe=ua}show(){const ua=new Z.StandardDialog;ua.Rb=11;ua.pc(1,U.a.instance.ga(2120));
ua.pc(2,U.a.instance.ga(2121));ua.t9f(U.a.instance.ga(2119),U.a.instance.Ua(658),this.vw)}KOa(ua){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${ua}`)}}Object(u.a)(P,"ExpandSortSelectionDialog",null,[]);const S=(ua,Xa)=>{ua=ua.ColumnInfo;switch(Xa){case 1:return ua.CellColors&&ua.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case 2:return ua.TextColors&&ua.TextColors.length?!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return ua.Icons&&ua.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return d.ULS.sendTraceTag(537151628,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},ja=(ua,Xa,ha,ta)=>{ua=ua.HeaderColumnInfo;return ta||ua?2===Xa&&ha?ua.CellColors&&1!==ua.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):ua.TextColors&&1!==ua.TextColors.length?(d.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):ua.Icons&&1!==ua.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:ua?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${ha} == 0.`),!1):!0:!0};var X=a(187);class Y{static isValid(ua){return Y.nDh.includes(ua.Position)?
!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${ua.Position}]`),!1)}}Y.nDh=[0,.5,1];Object(u.a)(Y,"FillGradientStopExtension",null,[]);class va{constructor(ua,Xa,ha,ta){new Sys.UI.Point(ua,Xa);new Sys.UI.Point(ha,ta)}}Object(u.a)(va,"GradientLine",null,[]);class N{static isValid(ua){if(!(ua.Degree.toString()in N.lDh))return d.ULS.shipAssertTag(537159829,0,!1,`FillGradientExtension.IsValid: unexpected degree value [${ua.Degree}]`),!1;if(!ua.GradientStops)return d.ULS.shipAssertTag(537159828,
0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(ua.GradientStops.length<N.dGi||ua.GradientStops.length>N.JEi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${ua.GradientStops.length}]`),!1;for(const Xa of ua.GradientStops)if(!Y.isValid(Xa))return!1;return!0}}N.dGi=2;N.JEi=3;N.lDh={["0"]:new va(0,0,1,0),["180"]:new va(1,0,0,0),["90"]:new va(0,0,0,1),["270"]:new va(0,1,0,0),["45"]:new va(0,0,1,1),["225"]:new va(1,1,0,0),
["135"]:new va(1,0,0,1),["315"]:new va(0,1,1,0)};Object(u.a)(N,"FillGradientExtension",null,[]);const ea=ua=>ua.SortRange?4===ua.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${ua.SortRangeType}`),!1):2===ua.SortRangeType&&ua.SortTopToBottom&&(null==ua.HeaderRowSize||0>ua.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),
!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),Ca=ua=>{if(!ua.SortConditions)return!0;for(const Xa of ua.SortConditions){if(!Ra(ua,Xa.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Xa.RowColOffset}] is out of bounds. sort range: ${ua.SortRange}`),!1;if(1===Xa.SortConditionType&&Xa.FillGradient&&!N.isValid(Xa.FillGradient))return d.ULS.sendTraceTag(537151619,0,
10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},la=ua=>{if(!ua.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var Xa=new X.a;for(var ha of ua.SortColumnInfoItems){if(!Ra(ua,ha.ColumnOffset))return d.ULS.sendTraceTag(537151617,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${ha.ColumnOffset}] is out of bounds. sort range: ${ua.SortRange}`),
!1;if(!ha.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${ha.ColumnOffset}]`),!1;if(ha.CellColors&&!ha.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${ha.CellColors.length}]`),!1;if(ha.TextColors&&!ha.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${ha.TextColors.length}]`),
!1;if(ha.Icons&&!ha.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${ha.Icons.length}]`),!1;Xa.add(ha.ColumnOffset)}if(ua.SortConditions)for(const ta of ua.SortConditions)if(!Xa.contains(ta.RowColOffset))return d.ULS.shipAssertTag(537151584,0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${ta.RowColOffset}]`),!1;if(ua.HeaderColumnInfoItems){if(ua.HeaderColumnInfoItems.length!==
ua.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Xa=0;Xa<ua.HeaderColumnInfoItems.length;++Xa){ha=ua.HeaderColumnInfoItems[Xa];if(ha.ColumnOffset!==ua.SortColumnInfoItems[Xa].ColumnOffset)return d.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;
if(ha.CellColors&&1<ha.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(ha.TextColors&&1<ha.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(ha.Icons&&1<ha.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0},Ra=(ua,Xa)=>{const ha=ua.SortRange;ua=ua.SortTopToBottom?ha.LastColumn-ha.FirstColumn:ha.LastRow-ha.FirstRow;return 0<=Xa&&Xa<=ua};var lb=a(383),Aa=a(132),da=a(88),aa=a(133);class fa extends lb.a{constructor(ua,Xa){super(ua,Xa);this.CEb=this.Ked();this.Sr()}get qc(){return"SortMergedCellsErrorDialog"}QO(ua,Xa){if(1===ua){var ha=w.v(this.CEb,this.$);D.h(this.$).gg(ha,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}ha={["DialogButton"]:ua,["Location"]:"dialog"};aa.b(this.$).ud(Aa.a.iJj,
ha,null,!0);super.QO(ua,Xa)}Sr(){super.Sr();const ua=this.fJj();this.Rb=1;this.pc(1,U.a.instance.ga(2239));this.Zl(U.a.instance.ga(2240),da.a.If(ua),1,this.X7)}fJj(){return String.format(U.a.instance.mb(174),this.CEb.toString())}Ked(){const ua=this.error.Description.split("_");return new m.Range(Number.parseInvariant(ua[1])+1,Number.parseInvariant(ua[2])+1,Number.parseInvariant(ua[3])+1,Number.parseInvariant(ua[4])+1,!0,!1)}}Object(u.a)(fa,"SortMergedCellsErrorDialog",lb.a,[]);var Oa=a(70),ba=a(575),
ka=a(609);class Pa extends G.a{constructor(ua,Xa,ha,ta){super(ua);this.Nhc=this.yUd=!1;this.a7=[];this.Gii=(wa,db)=>{const Jb=this.gch(wa);this.OMa(214,(Pb,eb,Ma)=>z.p(this.$.pa.ya,Jb,this.L0a(Pb,this.NKh(db)),this.jU(eb),Ma,null),16,!0)};this.Fii=(wa,db,Jb)=>{wa=z.o(this.$.pa.ya,db,this.yLh(db,Jb),this.IRi,null,wa);this.a7.push(wa)};this.IRi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.s8b(Pa.Esb())};
this.y8c=(wa,db)=>{if(1===wa){wa=db.sortRangeType;const Jb={};Jb.SortOptions=db.sortOptions;Jb.ShouldRestoreSelection=this.yUd;Jb.SelectedRange=this.selectedRange;Jb.OriginalActiveCell=this.$qc;Jb.TopCellAddress=this.IUa;Jb.ShouldPromptNamedSheetViewTeachingDialog=0===wa||3===wa;Pa.x9i(this.$,Jb)}else this.yUd&&this.ipa(this.selectedRange,this.$qc)};this.cbi=(wa,db)=>{this.yUd=!0;this.ipa(wa,db)};this.getColorName=wa=>J.a.rLa(Q.a.FH(wa));d.ULS.shipAssertTag(529105669,0,!!Xa.ActiveCell);d.ULS.shipAssertTag(529105668,
0,!!Xa.SelectedRange);d.ULS.shipAssertTag(529105667,0,w.D(Xa.SelectedRange).contains(w.C(Xa.ActiveCell)));d.ULS.shipAssertTag(529105666,0,T.a.equals(Xa.SelectedRange.SheetName,Xa.ActiveCell.SheetName,!0));this.udb=new ka.a(ua,ba.a.vhh,()=>this.Nhc,1);this.selectedRange=Xa.SelectedRange;this.$qc=Xa.ActiveCell;this.A_g=Xa.ExpandSelection;this.namedSheetViewPublic=ha;this.IUa=ta;this.initializeAndShow(U.a.instance.ga(181),this.y8c,this.Jta(Xa))}dispose(){this.Nhc||(this.Nhc=!0,this.p3b(),this.a7=null,
this.udb.dispose(),this.udb=null);super.dispose()}get qc(){return"CustomSortDialog"}get ha(){return D.h(this.$).ha}NKh(ua){return Xa=>{I.b(Xa,-901005882)?(Oa.a(this.$).hd.xM(-901005882),this.PId()):I.b(Xa,-569193796)?(Oa.a(this.$).hd.xM(-569193796),this.hide(),new fa(this.$,Xa.Errors[0])):I.a(Xa)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide()):(Xa=Xa.Result,this.$.pk(Xa.SortRange),Xa&&ea(Xa)&&Ca(Xa)&&
la(Xa)?ua(Xa):this.s8b(Pa.Esb()))}}yLh(ua,Xa){return(ha,ta)=>{if(this.Nhc)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!ha||I.a(ha))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${E.a.sc(ha.Errors)}`),this.$.ea.Po(ha.Errors),this.hide();else{ha=ha.Result;var wa=ua.RangeType,db=ua.HeaderRowSize,Jb=ua.SortTopToBottom;
ha&&S(ha,ua.ConditionType)&&ja(ha,wa,db,Jb)?(ha.ColumnInfo.ColumnOffset=ta,void 0!==ha.HeaderColumnInfo&&null!==ha.HeaderColumnInfo&&(ha.HeaderColumnInfo.ColumnOffset=ta),Xa(ha,ua.ConditionType,ua.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.s8b(Pa.Esb()))}}}gch(ua){const Xa={};Xa.SelectedRange=this.selectedRange;Xa.ActiveCell=this.$qc;Xa.SortInfoMode=ua;Xa.ExpandSortSelection=
this.A_g;Xa.ExpandSortSelectionSupported=!0;return Xa}Jta(ua){const Xa={};Xa[M.a.vu]=this.qc;Xa.fromAutoFilter=ua.FromAutoFilter;Xa.gridRTL=D.h(this.$).rtl;Xa.activeCell=ua.ActiveCell;Xa.selectedRange=ua.SelectedRange;Xa.invokeGetSortInfo=this.Gii;Xa.invokeGetSortConditionColorsOrIcons=this.Fii;Xa.highlightSortRange=this.cbi;Xa.getColorName=this.getColorName;return Xa}ipa(ua,Xa){ua=w.D(ua);this.ha.ra.dd.equals(ua)||this.ha.updateSelection(ua,w.C(Xa),0,void 0,void 0,void 0,!0)}PId(){(new P(ua=>{const Xa=
{};Xa.ActiveCell=this.$qc;Xa.SelectedRange=this.selectedRange;Xa.ExpandSelection=ua;Xa.FromAutoFilter=!1;this.$.Xc(-207540907,x.a.Db,8,{["SortCommandData"]:Xa})})).show()}p3b(){if(void 0!==this.a7&&null!==this.a7)for(const ua of this.a7)this.$.pa.ya.igb(ua.qt)}static x9i(ua,Xa){ua.Xc(1659552324,x.a.Db,8,{["CustomSortCommandData"]:Xa})}static Esb(){return E.a.$c(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}Object(u.a)(Pa,"CustomSortDialog",G.a,[]);var Fa=a(1073);class oa{constructor(ua){this.selection=
null;this.selection=ua}getSelection(){return this.selection}}Object(u.a)(oa,"MacroRecorderRangeAutoFilterClearedPayload",null,[108]);class La{constructor(ua){this.filterRange=null;this.filterRange=ua}}Object(u.a)(La,"MacroRecorderRangeFilterReappliedPayload",null,[108]);var Ea=a(60);const ca=(ua,Xa,ha,ta,wa,db,Jb=null)=>{Jb=ua.Na(41,Jb);Jb.options=Xa;return Ea.g(ua,"Sort",Jb,ha,ta,wa,db,0)},$a=(ua,Xa,ha,ta,wa,db,Jb=null)=>{Jb=ua.Na(41,Jb);Jb.selectedRange=Xa;return Ea.g(ua,"ClearAutoFilter",Jb,ha,
ta,wa,db,0)},Qa=(ua,Xa,ha,ta,wa,db,Jb=null)=>{Jb=ua.Na(41,Jb);Jb.filterRange=Xa;return Ea.g(ua,"ReapplyAutoFilter",Jb,ha,ta,wa,db,0)};var Va=a(773),fb=a(774),Ka=a(112),hb=a(55),fc=a(1074),dc=a(199),wb=a(33),Tb=a(346),xb=a(66);class cb{constructor(ua,Xa){this.sortOptions=this.OTa=this.selectedRange=null;this.ohf=!1;this.activeCell=this.Be=this.vb=this.jc=null;this.onContentReady=()=>{this.bTf(!1);const ha=this.ha();ha.ra.Pg&&ha.ra.dd.equals(this.OTa)&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?
ha.updateSelection(this.selectedRange,w.C(this.activeCell),0,void 0,void 0,void 0,!0):ha.updateSelection(this.selectedRange,ha.ra.activeCell,0,void 0,void 0,void 0,!0))};this.qRi=(ha,ta)=>{ha&&!E.a.dg(ha.Errors)&&this.jc&&(this.jc.fp=ha.Result,this.AMb(),this.applyPivotSort(ta))};this.pRi=()=>{};this.IYi=(ha,ta)=>{var wa;((null===ta||void 0===ta?0:ta.mQj)||(null===(wa=this.$.oa)||void 0===wa?0:wa.hasAutoFilter))&&ta.selection&&wb.a.pjf()&&(ha=xb.d(this.$.xa.oa),this.nQj(new Tb.a(w.D(ta.selection),
ha)))};this.$=ua;this.ipf="";this.namedSheetViewPublic=Xa;this.gridView=D.h(this.$);this.$.Kb.Qg("LoadResource","LoadDialogControlsStopwatch")}p1(ua){if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var Xa=this.$.da.Aa(465);Xa&&Xa.p1(5,ua)}}nc(ua,Xa){return!this.Osd(ua,Xa)}executeCommand(ua,Xa,ha){let ta=null;ua=Xa.command;switch(ua){case -864298118:ta=this.ynh(Xa,ha);break;case -1010737776:ta=this.d9c(!0,Xa,ha);break;case 2123420468:ta=
this.d9c(!1,Xa,ha);break;case -1089513346:ha=this.T1e(ha);if(!this.YBb([w.D(ha.SortOptions.SelectedRange)]))return f.TaskExtensions.Uj();ta=this.fNe(Xa,ha);break;case -1032691499:case -764711886:case -2016161444:ta=this.z7i(Xa,ha);break;case -207540907:case -1677817820:ta=this.gridView.Bb.H5(this.ha().ra.activeCell)?this.p7i():this.m7i(Xa,ha);break;case 1659552324:ta=this.fNe(Xa,this.T1e(ha));break;case 368460465:ta=this.Pnh(Xa,ha);break;case 529856798:ta=this.tnh(Xa);break;case 644342024:ta=this.Knh(Xa)}return ta||
V.a(ua)}wc(ua,Xa){if(ua=1===ua)switch(Xa.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:ua=!1}return ua}Kc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}bTf(ua){ua?this.gridView.lv(this.onContentReady):this.gridView.Ky(this.onContentReady);this.ohf=ua}get ra(){return this.ha().ra}gEj(ua){return!!this.sortOptions&&
T.a.equals(this.ipf,ua.Aia,!0)}Osd(ua,Xa){const ha=D.h(this.$).ha.ra.selectedRanges;return(new A.a(this.$.xa)).xm(ua,Xa,ha,this.gridView)}d9c(ua,Xa,ha){const ta=new h.a;this.Aef(ta,ha,ua);return this.YBb([w.D(ta.SelectedRange)])?this.gridView.Bb.H5(w.D(ta.SelectedRange))?this.Hnh(ua):this.apd(ta,Xa):f.TaskExtensions.Uj()}ynh(ua,Xa){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let ha=null;const ta=this.ha();ta&&(this.gEj(ta)?this.YBb(ta.ra.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,ha=this.apd(this.sortOptions,ua)):ha=this.d9c(!0,ua,Xa));return ha}YBb(ua){return L.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")?this.$.isEditMode?this.$.$p(ua,!0,1):this.$.ZYc(ua,!0,1):!0}Hnh(ua){this.nZh(ua);return hb.Task.Ta(!0)}nXg(ua){if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Xa=this.gridView.Bb.Bj(this.ra.dd,!1);if(Xa)return new v.a(Xa.name,this.ra.activeCell.left-
Xa.usedRange.left,ua.IsAscending)}return new t.a(ua)}apd(ua,Xa){this.gridView.yf.pH(!1);const ha=()=>this.nXg(ua);return this.w$c((ta,wa,db)=>ca(this.$.pa.ya,ua,H.b(ta,this.zLh(Xa)),wa,db,ua),ta=>new B.a(141,0,ta,void 0,ha),Xa,this.$Cj(ua))}$Cj(ua){if(!this.namedSheetViewPublic)return!1;const Xa=this.ra.dd,ha=w.v(this.ra.dd,this.$),ta=this.gridView.Bb.y_(Xa,!0),wa=this.ra.Zba()&&this.gridView.Bb.Xkf(ha),db=this.gridView.Bb.uqi(ha);ua=(Xa.R5||Xa.E_)&&!Xa.isSingle&&(null==ua.ExpandSortSelection?!1:
ua.ExpandSortSelection)&&this.gridView.Bb.Xkf(ha);return ta||wa||db||ua}p7i(){return this.$.Xc(-1556797033,x.a.Db,8,null)}m7i(ua,Xa){ua=8===ua.af&&Xa&&void 0!==Xa[cb.cfb]&&null!==Xa[cb.cfb]?Xa[cb.cfb]:19===ua.af&&Xa&&void 0!==Xa[x.a.og]&&null!==Xa[x.a.og]?r.a.ki(Xa[x.a.og]):this.lbh();if(!this.YBb([w.D(ua.SelectedRange)]))return f.TaskExtensions.Uj();D.h(this.$).yf.pH(!1);let ha=null;(Xa=Xa.TopCellAddress)&&(ha=w.o(Xa,this.$));new Pa(this.$,ua,this.namedSheetViewPublic,ha);return hb.Task.Ta(!0)}T1e(ua){return ua[cb.uhh]}fNe(ua,
Xa){const ha=db=>{this.Paf(db)?this.C$e(db.Errors[0]):(Xa.ShouldRestoreSelection&&this.ipa(Xa.SelectedRange,Xa.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${ua.af}`),this.fSj(Xa),this.p1(db))},ta=()=>{Xa.ShouldRestoreSelection&&this.ipa(Xa.SelectedRange,Xa.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${ua.af}`)},
wa=()=>new y(Xa.SortOptions);return this.w$c((db,Jb,Pb)=>ca(this.$.pa.ya,Xa.SortOptions,H.b(db,ha),H.a(Jb,ta),Pb,this.sortOptions),db=>new B.a(187,0,db,void 0,wa),null,Xa.ShouldPromptNamedSheetViewTeachingDialog)}ipa(ua,Xa){ua=w.D(ua);D.h(this.$).ha.ra.dd.equals(ua)||D.h(this.$).ha.updateSelection(ua,w.C(Xa),0,void 0,void 0,void 0,!0)}lbh(){const ua={};ua.ActiveCell=w.o(this.ra.activeCell,this.$);ua.SelectedRange=w.v(this.ra.dd,this.$);ua.FromAutoFilter=!1;ua.ExpandSelection=null;return ua}Pnh(ua,
Xa){const ha=this.Xaa();if(!ha)return hb.Task.Ta(!1);const ta=this.$.pa.ya.Wb(),wa=()=>new Fa.a(ha);return C.a(this.$.userOperationManager,(db,Jb,Pb)=>z.B(this.$.pa.ya,ha,H.b(Va.a.v5a(Ka.a.Xpb,fb.a.toggleAutoFilter,db),this.IYi),Jb,Pb,{selection:ha,mQj:Xa.On},ta),db=>new B.a(516,0,db,64,wa),ua)}tnh(ua){const Xa=this.Xaa();if(!Xa)return hb.Task.Ta(!1);const ha=this.gridView.Bb.Bj(this.ra.dd,!0);ha&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${ha.type.toString()}`);
const ta=this.$.pa.ya.Wb(),wa=()=>new oa(Xa);return this.w$c((db,Jb,Pb)=>$a(this.$.pa.ya,Xa,Va.a.v5a(Ka.a.pHa,fb.a.clearAutoFilter,db),Jb,Pb,null,ta),db=>new B.a(517,0,db,64,wa),ua)}w$c(ua,Xa,ha,ta=!0){return this.namedSheetViewPublic&&ta?this.namedSheetViewPublic.xTa().continueWith(wa=>{wa.result&&C.a(this.$.userOperationManager,ua,Xa,ha)}):C.a(this.$.userOperationManager,ua,Xa,ha)}Knh(ua){const Xa=this.Xaa();if(!Xa)return hb.Task.Ta(!1);const ha=this.$.pa.ya.Wb(),ta=()=>new La(Xa);return C.a(this.$.userOperationManager,
(wa,db,Jb)=>Qa(this.$.pa.ya,Xa,Va.a.v5a(Ka.a.pHa,fb.a.n$i,wa),db,Jb,null,ha),wa=>new B.a(518,0,wa,64,ta),ua)}zLh(ua){return(Xa,ha)=>{var ta;I.b(Xa,-901005882)?(Oa.a(this.$).hd.xM(-901005882),this.PId(ha,ua.command)):this.Paf(Xa)?this.C$e(Xa.Errors[0]):!I.a(Xa)&&Xa.Result&&(this.sortOptions=ha,this.OTa=w.D(Xa.Result.ActualSortRange),this.ipf=this.ha().Aia,this.ohf||(this.selectedRange=this.ra.dd,this.selectedRange.equals(this.OTa)||(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&
(this.activeCell=w.o(this.ra.activeCell,this.$)),this.lHj())),(null===(ta=this.sortOptions)||void 0===ta?0:ta.ActiveCell)&&this.c8f(this.sortOptions)&&(ha=this.sortOptions.ActiveCell,ha=new m.Range(ha.FirstRow+1,ha.FirstColumn+1,ha.FirstRow+1,ha.FirstColumn+1,!0,!1),this.FS(ha),this.A_d(ha)),this.p1(Xa))}}Paf(ua){return I.b(ua,-569193796)}C$e(ua){Oa.a(this.$).hd.xM(-569193796);new fa(this.$,ua)}PId(ua,Xa){(new P(ha=>{const ta={};ta.ActiveCell=ua.ActiveCell;ta.SelectedRange=ua.SelectedRange;ta.ExpandSelection=
ha;this.$.Xc(Xa,x.a.Db,8,{[cb.cfb]:ta})})).show()}lHj(){const ua=this.ha();if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Xa=w.C(this.activeCell);this.OTa.Ie(Xa)||(Xa=this.OTa.topLeft);ua.updateSelection(this.OTa,Xa,0,void 0,void 0,void 0,!0)}else ua.updateSelection(this.OTa,ua.ra.activeCell,0,void 0,void 0,void 0,!0);this.bTf(!0)}Xaa(){const ua=this.ha();if(!ua)return d.ULS.shipAssertTag(537151573,0,!!ua,"SelectionManger is null"),null;
this.gridView.yf.pH(!1);return w.v(ua.ra.dd,this.$)}AMb(){this.jc&&this.jc.fp&&(this.Be=this.jc.fp,this.vb=this.jc.pcc())}nZh(ua){if(this.$.isEditMode&&(this.jc=this.gridView.Bb.xp(this.ra.activeCell))){this.activeCell=w.o(this.ra.activeCell,this.$);if(this.jc&&this.jc.fp){var Xa=this.jc.fp.CurrentCol;if(this.jc.fp.CurrentRow===this.activeCell.FirstRow&&Xa===this.activeCell.FirstColumn){this.AMb();this.applyPivotSort(ua);return}}this.$.pa.ya.Wb();Xa=new B.a(228,0,(ha,ta,wa)=>z.l(this.$.pa.ya,this.activeCell,
H.b(ha,this.qRi),H.a(ta,this.pRi),wa,ua),16);this.$.userOperationManager.Ic(Xa,null)}}applyPivotSort(ua){if(this.jc&&this.vb&&this.activeCell&&this.Be){var Xa=8===this.Be.CellArea,ha=1===this.Be.CellArea||2===this.Be.CellArea;(Xa||ha)&&8!==this.Be.CellType&&4!==this.Be.CellType&&(Xa?C.a(this.$.userOperationManager,(ta,wa,db)=>z.b(this.$.pa.ya,this.activeCell,ua?1:2,this.vb.Caption,ta,wa,db,null),ta=>new B.a(1015,0,ta,void 0,null),null):(Xa=1===this.Be.CellArea?1:2,this.$.ma(680)?n.a.naps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.jc.isOlap?"":this.vb.Caption,Xa,ua):n.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.jc.externalSourceIndex,this.vb.Index.toString(),ua)))}}fSj(ua){this.c8f(ua.SortOptions)&&(ua.TopCellAddress?ua=w.C(ua.TopCellAddress):(ua=ua.OriginalActiveCell,ua=new m.Range(ua.FirstRow+1,ua.FirstColumn+1,ua.FirstRow+1,ua.FirstColumn+1,!0,!1)),this.FS(ua))}FS(ua){wb.a.sla(this.$)&&
f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Xa=>{Xa.result.Nea(ua);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ka,3)}A_d(ua){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,476,475,0),Xa=>{Xa.result.A_d(ua,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.ka,3)}z7i(ua,Xa){if(!this.YBb(this.ra.selectedRanges))return f.TaskExtensions.Uj();const ha=new h.a;this.Aef(ha,Xa);ha.SortConditions=[this.Beh(ua)];ha.OperationType=2;return this.apd(ha,ua)}Beh(ua){const Xa=this.gridView.Sb(this.ra.activeCell);let ha=new fc.a;ha.IsAscending=!0;switch(ua.command){case -1032691499:Xa.yyb?(ua=dc.a.rp(Xa.backgroundColor),ha.SortColor=ua.BS(!0)):ha.SortColor=cb.NoColor;ha.SortConditionType=1;break;case -764711886:ha.SortColor=Xa.t3c===cb.NoColor?cb.NoColor:dc.a.Exe(Xa.t3c);
ha.SortConditionType=2;break;case -2016161444:Xa.Eyb?(ha.SortIcon=Xa.cell.Jkc,ha.SortIconSet=Xa.Kkc):(ha.SortIcon=cb.k4d,ha.SortIconSet=cb.k4d);ha.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return ha}nQj(ua){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Xa=>{void Xa.result.MCc(ua,"Filter")},this.$.ka,3)}Aef(ua,Xa,ha=!0){ua.OperationType=
0;ua.IsAscending=ha;ua.HasHeader=!0;ua.GuessHeader=!0;ua.SortTopToBottom=!0;ua.ExpandSortSelectionSupported=!0;Xa&&Xa[cb.cfb]?(Xa=Xa[cb.cfb],ua.ActiveCell=Xa.ActiveCell,ua.SelectedRange=Xa.SelectedRange,ua.ExpandSortSelection=Xa.ExpandSelection):(ua.ActiveCell=w.o(this.ra.activeCell,this.$),ua.SelectedRange=w.v(this.ra.dd,this.$),ua.ExpandSortSelection=null)}c8f(ua){return!ua.SortConditions||ua.SortConditions.some(Xa=>0===Xa.SortConditionType)}}cb.uhh="CustomSortCommandData";cb.cfb="SortCommandData";
cb.k4d=-1;cb.NoColor=0;Object(u.a)(cb,"SortCommandHandler",null,[208]);class jb extends b.a{constructor(ua){super(ua)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Ya),ua=>{this.Zc([new cb(this.$,ua.result)])},this.$.ka,3)}static la(ua){b.a.Nd(160,new jb(ua))}}Object(u.a)(jb,"SortCommandHandlerFactory",b.a,[]);G=a(222);class qa{constructor(ua){ua.da.Ga(446,this)}Jfh(ua,Xa){new fa(ua,Xa)}}Object(u.a)(qa,"SortUtil",null,[221]);class za extends G.a{constructor(ua){super();
this.$=ua;this.Fb()}create(){let ua=this.$.da.Aa(446);ua||(ua=new qa(this.$),this.$.da.Ga(446,ua));this.nb(ua)}static la(ua){ua.da.Ga(447,new za(ua))}}Object(u.a)(za,"SortUtilFactory",G.a,[]);a.d(F,"a",function(){return Na});const Na=()=>{c.a.Fa(ua=>{jb.la(ua);za.la(ua)})}},1157:function(u,F,a){u=a(0);var c=a(553),b=a(15),e=a(134),f=a(54);class d extends e.StandardDialog{constructor(){super();this.Rb=0;this.pc(1,CommonUIStrings.l_DialogClose)}displayError(ca,$a){this.LMe(ca,$a,f.a.jpj)}LMe(ca,$a,
Qa){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Qa);this.gA(Qa,ca,$a,null)}T8c(ca,$a){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.gA(f.a.lpj,ca,$a,null,!0)}}Object(u.a)(d,"ErrorDialog",e.StandardDialog,[420]);var h=a(84);e=a(1051);var n=a(146);class m{static get qg(){return n.a.iq(m.ol,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}m.ol="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(u.a)(m,"FileNameDialogHtml",null,[]);var x=a(4),r=a(14),y=a(45),t=a(85),v=a(87),w=a(30);class C extends e.a{constructor(ca,$a,Qa,Va,fb,Ka,hb,fc){super(ca,$a,Qa,Va,fb,Ka,fc);this.Eqa=this.zSc=this.fz=null;this.WYg=CommonUIStrings.l_SaveToAnotherFolder;this.qg=m.qg;this.Fe="FileNameDialog-SaveToSharePoint";this.xmb=hb;this.Yzg=fc}uQ(ca){const $a=w.a.Pq(x.AFrameworkApplication.sm.sn),Qa=x.AFrameworkApplication.breadcrumbFolderName,Va=x.AFrameworkApplication.breadcrumbBrandName,fb={["txtFileName"]:ca||
$a};let Ka=CommonUIStrings.L_SaveAs;2===x.AFrameworkApplication.ta.Pa.Hj&&(Ka=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Ka,Object(h.a)(this,this.gac,"fileNameDialogHandler"),fb);this.sMe(ca,$a);this.oJa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");x.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.fz=document.getElementById("anotherFolder"),ca=document.getElementById("folderLocation"),this.zSc=
v.a.Cue(ca,this.fz,"anotherFolderDescribedBy"),this.fz.className="WACButton WACDialogButtonNormal",ca=!1,Qa&&Qa.length?(this.Xoe(this.fz,this.zSc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Va,Qa)),ca=this.TGg(Va,Qa)):this.Xoe(this.fz,this.zSc,CommonUIStrings.l_CurrentOnlineFolder),this.UHg(this.fz),this.WGg(this.fz),ca?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.fz,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.fz,"SaveToAnotherLocationOne"),y.a.addHandler(this.fz,r.a.click,Object(h.a)(this,this.zEd,"onSaveToAnotherLocationClick")),y.a.addHandler(this.fz,r.a.Pb,Object(h.a)(this,this.oHf,"onSaveToAnotherLocationKeyDown")))}TGg(ca,$a){let Qa;Qa=!1;const Va=document.getElementById("currentLocation");Va.innerText="";const fb=this.K4e(Va,ca),Ka=this.K4e(Va,$a);let hb=255,fc=255;255<fb+Ka&&(hb=Math.max(238,408-fb),fc=
Math.max(170,408-Ka),Qa=!0);this.tJg(Va,ca,fc,$a,hb);return Qa}K4e(ca,$a){const Qa=document.createElement("div");Qa.innerText=$a;Qa.style.visibility="hidden";ca.appendChild(Qa);$a=Qa.clientWidth;ca.removeChild(Qa);return $a}tJg(ca,$a,Qa,Va,fb){$a&&(this.Voe(ca,$a,Qa),this.kJg(ca));Va&&this.Voe(ca,Va,fb)}Voe(ca,$a,Qa){const Va=document.createElement("div");Va.innerText=$a;Va.title=$a;Va.className="SaveToAnotherFolderBreadcrumb";Va.style.maxWidth=Qa.toString()+"px";ca.appendChild(Va)}kJg(ca){const $a=
document.createElement("span");$a.id="FolderSeparator";const Qa=document.createElementNS("http://www.w3.org/2000/svg","svg");Qa.setAttribute("class","SeparatorCaret");const Va=document.createElementNS("http://www.w3.org/2000/svg","polygon");Va.setAttribute("points","1 4 1 11 5 7.5");Qa.appendChild(Va);$a.appendChild(Qa);ca.appendChild($a)}Xoe(ca,$a,Qa){Qa=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Qa);$a&&($a.innerText=Qa);ca.tabIndex=0;ca.setAttribute(v.a.Ld,v.a.pt)}WGg(ca){const $a=
document.createElement("span");$a.id="anotherFolderText";$a.innerText=this.WYg;$a.className="AnotherFolderTextSpan";ca.appendChild($a)}UHg(ca){const $a=document.createElement("span");$a.className="cui-img-cont-float cui-img-16by16 ";this.Eqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Eqa.setAttribute("class","FolderIconSVG");const Qa=document.createElementNS("http://www.w3.org/2000/svg","path");Qa.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Eqa.appendChild(Qa);$a.appendChild(this.Eqa);ca.appendChild($a)}oHf(ca){!ca||ca.keyCode!==t.a.Mh&&ca.keyCode!==t.a.GX||this.zEd(ca)}zEd(){if(this.sJ){const ca=w.a.H4(x.AFrameworkApplication.fileName);let $a=this.sJ.value;this.hide();$a&&""!==$a&&""!==ca||1===this.ta.state?(""!==ca&&($a+=ca),this.hac($a)?this.dt.create().displayError(1,$a,!1):this.xmb.start($a,this.Yzg)):this.dt.create().displayError(2,$a,!1)}}E1g(ca){this.fz&&this.Eqa&&(ca?(this.fz.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.fz,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Eqa,"DisabledFolderIconSVG")):(this.fz.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.fz,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Eqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.fz,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Eqa,"DisabledFolderIconSVG"))))}Nkd(){super.Nkd();this.E1g(!!this.sJ&&""!==this.sJ.value)}dispose(){this.fz&&(y.a.removeHandler(this.fz,r.a.click,Object(h.a)(this,
this.zEd,"onSaveToAnotherLocationClick")),y.a.removeHandler(this.fz,r.a.Pb,Object(h.a)(this,this.oHf,"onSaveToAnotherLocationKeyDown")),this.fz=null);super.dispose()}}Object(u.a)(C,"FileNameDialog",e.a,[435]);var B=a(684),z=a(554),A=a(187),E=a(814),I=a(907),L=a(98),V=a(136);class T{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(u.a)(T,"SaveAsDialogInput",null,[]);class H{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(u.a)(H,"SaveLocation",null,[]);var D=a(376),G=a(189);class J{constructor(ca,$a,Qa,Va,fb,Ka,hb,fc,dc){this.IOc=null;this.EA="";this.xmb=ca;this.dt=$a;this.Nh=dc;this.Oga=Qa;this.ef=fb;this.Zv=Va;this.aGa=hb;this.GYa=fc;Ka&&(this.IOc=new c.a(()=>new E.a(Ka.value,null)))}gRh(){const ca=new B.a(z.a.ak());ca.ia("type","currentHost");return Object.assign(new H,{folderName:this.Zv.breadcrumbFolderName,friendlyPath:this.Zv.breadcrumbBrandName,properties:ca})}bsi(ca){return!!ca&&"ClassicMru"===
ca.type&&!!ca.service_info&&!!ca.service_info.service_id&&-1!==ca.service_info.service_id.indexOf("SHAREPOINT")}D1h(){if(!this.IOc||!this.aGa)return null;var ca=this.IOc.value.a_("SaveAsToSharePointDialog",!1);if(!ca||3!==ca.state||!ca.dwf)return null;ca=ca.dwf;const $a=new A.a;let Qa=0,Va=0;for(var fb=0;fb<ca.length;fb++){var Ka=ca[fb];if(!this.bsi(Ka))continue;Qa++;if(!Ka.sharepoint_info)continue;const hb=Ka.url,fc=Ka.sharepoint_info.site_url,dc=Ka.title;Ka=I.b(Ka,x.AFrameworkApplication.isRtl);
if(!(hb&&fc&&dc&&Ka))continue;Va++;const wb=new B.a(z.a.ak());wb.ia("type","SharePoint");wb.ia("siteUrl",fc);wb.ia("folderUrl",hb);Va++;$a.add(Object.assign(new H,{folderName:dc,friendlyPath:Ka,properties:wb}))}fb=new Map;fb.set("NumPlaces",ca.length.toString());fb.set("NumSharepointPlaces",Qa.toString());fb.set("placesWithMetadata",Va.toString());L.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",fb);0<Qa&&(Va?.5>1*Va/Qa&&L.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):L.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return $a}WRh(){const ca=new A.a;ca.add(this.gRh());const $a=this.D1h();$a&&ca.addRange($a);return Object.assign(new T,{enableMoreLocations:!x.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.EA,extension:w.a.H4(this.Zv.sn),saveLocations:ca.toArray(),scenario:"SaveToSharePoint"})}scc(){const ca=Object(h.a)(this,this.WRh,
"getDialogInput"),$a={};$a.inputPropsCallback=ca;return $a}uQ(ca){this.EA=ca;this.EA||(this.EA=String.format(CommonUIStrings.l_SaveACopy_Filename,w.a.Pq(this.Zv.sn)));ca={["id"]:"SaveAsDialog",["bodyControls"]:this.scc()};let $a=CommonUIStrings.L_SaveAs;2===this.ef.Pa.Hj&&($a=CommonUIStrings.L_SaveACopy);const Qa=new n.a(!1,!1,!0);Qa.Rb=1;Qa.Fe="SaveAsDialog";Qa.pc(1,CommonUIStrings.l_SaveButtonLabel);Qa.initializeAndShow($a,Object(h.a)(this,this.fpj,"saveAsDialogHandler"),ca)}nGj(ca,$a){ca&&""!==
ca&&""!==$a||1===this.ef.state?this.asi()?this.Dyi(ca,$a):(""!==$a&&(ca+=$a),this.xmb.start(ca,this.Nh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.dt.create().displayError(2,ca,!1))}Dyi(ca,$a){L.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Qa=this.GYa.YHe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.GYa.Cgd(Qa).then(Va=>{if(Va&&0<Va.length){const fb=
Va[0][D.a.y2i];Va=Va[0][D.a.fMf];if(""!==fb&&""!==Va)this.aGa.zoa(Va,ca+$a,fb,this.Nh),L.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.dt.create().displayError(0,ca,!1);const Ka=V.a.gs();Ka&&(Ka.set("SiteUrlAvailable",""===fb?"false":"true"),Ka.set("FolderUrlAvailable",""===Va?"false":"true"));L.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new G.a,{extendedProperties:Ka}))}}else this.dt.create().displayError(0,ca,
!1),L.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Va=>{"Canceled"===Va?((Va=V.a.gs())&&Va.set("IsCanceled","true"),L.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new G.a,{extendedProperties:Va}))):L.Health.instance.recordKpiFailure("SaveACopySFP",Va,!1,!1,null)})}asi(){return this.GYa?this.GYa.itd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}fpj(ca,$a){if($a&&1===ca){ca=$a.fileName;var Qa=w.a.H4(this.Zv.sn);
$a.moreLocationsSelected&&this.nGj(ca,Qa);if($a.locationCallback){var Va=$a.locationCallback();Va?Va.properties&&"currentHost"===Va.properties.na("type")?this.Oga.zoa(ca+Qa,!1,this.Nh):Va.properties&&"SharePoint"===Va.properties.na("type")?($a=Va.properties.na("siteUrl"),Va=Va.properties.na("folderUrl"),this.aGa.zoa(Va,ca+Qa,$a,this.Nh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(u.a)(J,"ReactSaveAsDialog",null,[435]);class M{constructor(ca,$a,Qa,Va,fb,Ka,hb,fc=null,dc=null,wb=null){this.La=$a;this.ob=ca;this.TX=Va;this.Oga=Ka;this.dt=fb;this.ef=Qa;this.Bje=hb;this.Eyg=fc;this.aGa=dc;this.GYa=wb}create(ca){return this.ef&&this.ef.Pa.Iv?new J(this.Bje,this.dt,this.Oga,x.AFrameworkApplication.sm,this.ef,this.Eyg,this.aGa,this.GYa,ca):new C(this.ob,this.La,this.ef,this.TX,this.dt,this.Oga,this.Bje,ca)}}Object(u.a)(M,"FileNameDialogFactory",
null,[418]);class Q{constructor(ca,$a,Qa,Va){this.Xo=this.vlb=null;this.ujb=ca;this.ef=Qa;this.tAg=Va;this.rEa=new c.a(()=>new E.a($a.value,Object(h.a)(this,this.txb,"getMoreInfoEventReceived")))}get XJf(){this.vlb||(this.rEa.value.a_("Save As",!0),this.Xo&&this.Xo.LR&&this.Xo.LR.length&&(this.vlb=this.zYh(this.Xo.LR)));return this.vlb}start(ca){if(!this.XJf)if(x.AFrameworkApplication.breadcrumbFolderUrl&&x.AFrameworkApplication.breadcrumbFolderUrl.length)this.vlb=x.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Xo),!1;const $a=this.tAg();$a.GGj();const Qa=$a.hZh();if(!Qa)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ujb.start((Va,fb)=>{$a.hide();ca(Va,fb)},()=>{this.APa($a)},Qa,this.vlb);return!0}APa(ca){ca.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}zYh(ca){ca=
ca.toLowerCase();ca.endsWith("/")||(ca+="/");const $a=ca.indexOf("/documents/");return-1!==$a?ca.substring(0,$a+1)+"_layouts/15/onedrive.aspx":""}txb(ca){this.Xo||3!==ca.state||(this.Xo=ca)}}Object(u.a)(Q,"OneDriveFilePickerHelper",null,[421]);class U extends n.a{constructor(){super()}GGj(){this.mJc="FilePickerDialog";this.qg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Fe="PickerDialog-MsoSp";this.showDialog("",null)}hZh(){return document.getElementById("FilePickerDiv")}SI(){}fAa(){}}
Object(u.a)(U,"PickerDialog",n.a,[416]);var Z=a(642),P=a(836),S=a(377),ja=a(27),X=a(106),Y=a(25);class va{constructor(ca,$a,Qa,Va,fb,Ka,hb){this.ob=ca;this.yKc=Qa;this.La=$a;this.xmb=Va;this.ujb=fb;this.pQc=Ka;this.Qsg=hb}Ig(){const ca=this.ujb.g5a();ca?ja.a.jla||this.ob.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Ne(Y.a.saveToSharePoint,X.a.frame,Object(h.a)(this,this.e0f,"saveToSharePointActionDispatcher"),64):(ca.q9a.continueWith($a=>{$a.Pf&&this.ujb.MDd($a)}),this.d3b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}d3b(){S.a.UKd(Object(h.a)(this,this.e0f,"saveToSharePointActionDispatcher"));S.a.v$c([new P.a(Y.a.saveToSharePoint,X.a.frame,0)],this.ujb.g5a())}get y8a(){return this.ob.qa("SaveToAnotherFolderBrsIsEnabled")}get BAe(){return this.ob.qa("UserCanWriteRelative")}e0f(ca,$a,Qa,Va,fb){return $a.contextId!==X.a.frame||ca!==Y.a.saveToSharePoint?2:this.y8a&&(this.pQc.XJf||this.BAe)?1===Qa?Z.SessionStatusManager.instance.W5a||x.AFrameworkApplication.x5?
8:this.Qsg()?32:8:2===Qa?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(fb&&fb.SaveEntryPoint&&"VersionHistory"===fb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.BAe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.yKc.create(fb).uQ(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.xmb.start(null,fb)),32):8:8}}Object(u.a)(va,"SaveToSharePointActor",
null,[]);class N{constructor(ca,$a,Qa,Va){this.Nh=this.Ffe=null;this.aGa=ca;this.dt=$a;this.pQc=Qa;this.ef=Va}start(ca,$a){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Ffe=ca;this.Nh=$a;this.pQc.start((Qa,Va)=>{this.U6i(Qa,Va)})||this.zVd()}U6i(ca,$a){if(ca)this.onSuccess($a);else this.J6($a)}zVd(){1!==this.ef.state&&this.dt().T8c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(ca){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(ca&&ca.data&&ca.data.value&&ca.data.value.length&&ca.data.value[0].sharePoint){const $a=ca.data.value[0].sharePoint.url;ca=ca.data.value[0].sharePoint.listUrl;let Qa=null;if($a&&(Qa=ca?this.X1h(ca):this.W1h($a))){this.aGa.zoa($a,this.Ffe,Qa,this.Nh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!$a,!Qa)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.zVd()}W1h(ca){ca.endsWith("/")||
(ca+="/");let $a=0;for(let Qa=0;Qa<ca.length;Qa++)if("/"===ca.charAt(Qa)&&5===++$a)return ca.substr(0,Qa);return null}X1h(ca){ca.endsWith("/")&&(ca=ca.substring(0,ca.length-1));const $a=ca.lastIndexOf("/");return-1!==$a?ca.substring(0,$a):null}J6(ca){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");ca&&ca.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",ca.error.errorCode,ca.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.zVd()}}Object(u.a)(N,"SaveToSharePointManager",null,[326]);var ea=a(80);class Ca{constructor(ca,$a,Qa,Va,fb,Ka,hb,fc){this.hGa=ca;this.EA=$a;this.MWa=Va;this.rRc=Ka;this.c9=Qa;this.XCg=fb;this.Pfa=hb;this.Nh=fc}execute(ca,$a){if(!x.AFrameworkApplication.Og&&x.AFrameworkApplication.zd){var Qa=this.hGa+this.Pfa;Qa=ea.a.Bl(Qa,"fu",w.a.mf(this.c9));Qa=ea.a.Bl(Qa,"su",w.a.mf(this.XCg));Qa=ea.a.Bl(Qa,"fn",w.a.mf(this.EA));Qa=ea.a.Bl(Qa,"n",w.a.mf((new Date).getTime().toString()));
this.Nh&&this.Nh.FileDownloadUrl&&(Qa=ea.a.Bl(Qa,"furl",w.a.mf(this.Nh.FileDownloadUrl)));Qa=Qa+"&"+this.rRc;this.MWa&&this.MWa.length?Qa=ea.a.Bl(Qa,"fnn",w.a.mf(this.MWa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");x.AFrameworkApplication.zd.Pm(Qa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,ca,$a,null,void 0,void 0,void 0,void 0,"9")}}}Object(u.a)(Ca,"SharePointSaveAsCaller",
null,[362]);class la{constructor(ca){this.iGa=ca.appSettings.SaveAsToHostWebServiceBase;this.EA=ca.appSettings.FileName;this.Pfa=ca.Xa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(ca,$a,Qa,Va){return new Ca(this.iGa,this.EA,ca,$a,Qa,x.AFrameworkApplication.Hi,this.Pfa,Va)}}Object(u.a)(la,"SharePointUploadCallerFactory",null,[324]);var Ra=a(41),lb=a(39),Aa=a(240),da=a(687),aa=a(164),fa=a(643),Oa=a(768);class ba{constructor(ca,$a,Qa,Va,fb){this.Nm=this.yDa=null;this.RGc=!1;this.vSc=
this.c9=null;this.LUc=$a;this.Wlb=Qa;this.dt=Va;this.ef=fb;this.La=ca}zoa(ca,$a,Qa,Va){this.RGc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.$Nb();this.c9=ca;Va&&Va.SaveEntryPoint&&(this.vSc=Va.SaveEntryPoint);this.yDa=this.LUc.create(ca,$a,Qa,Va);Va&&"true"===Va.SkipSaveToHost?this.BQ():this.uIh()}uIh(){const ca=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.BQ()};32!==this.La.Zd(Y.a.jSa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.BQ()},ca])&&ca()}BQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.yDa.execute(Object(h.a)(this,this.yWi,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.xWi,"onSaveToSharePointUploadFailed"))}yWi(ca){if(ca&&ca.data&&ca.data.ve){var $a;if(({Ft:$a}=Ra.d(ca.data.ve)).returnValue)if($a.StatusCode!==Aa.a.nP&&$a.StatusCode!==
Aa.a.Xsb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",ca.data.status,$a.StatusCode),$a.StatusCode!==Aa.a.SXf&&this.jNe(ca.data.status)||(this.Pda($a.StatusCode.toString()),this.sFj($a.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.CNd();try{$a.NewDocumentUrl?this.cRa($a.NewDocumentUrl):this.dRa()}catch(Qa){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
Qa.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Oa.a.hgb(ca.data.ve)}),this.J8b()||(this.Pda("Failed to deserialize response"),this.YNb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.J8b()||(this.Pda("Unknown"),this.YNb())}xWi(ca){ca&&ca.data?this.jNe(ca.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Pda(da.a[ca.data.status]),this.YNb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.J8b()||(this.Pda("Unknown"),this.YNb()))}J8b(){if(!this.RGc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.RGc=!0,this.BQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}jNe(ca){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",ca);return this.J8b()}dRa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");lb.a.lf(this.c9,lb.a.IX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}cRa(ca){let $a=
!1,Qa=!1;x.AFrameworkApplication.fa&&($a=x.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Qa=x.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",ca,$a);if($a&&Qa){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Va={};Va[D.a.YQa]="1";Va[D.a.documentUrl]=ca;Va[D.a.reason]=fa.a.saveAs;x.AFrameworkApplication.pV().execute(fb=>
{fb.Rj(aa.a.tua,Va)})}else lb.a.lf(ca,lb.a.IX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}$Nb(){this.ef&&1===this.ef.state||(this.Nm=this.Wlb(),this.Nm.message=CommonUIStrings.l_CommentProgressTooltip,this.Nm.Rb=5,this.Nm.Lt=!1,this.Nm.BBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}vJa(){this.Nm&&(this.Nm.close(),this.Nm=null)}YNb(){this.vj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}rGj(){this.vj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}AFj(){const ca=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.vj(CommonUIStrings.l_SaveAsFileTooLargeTitle,ca,f.a.gpj)}vj(ca,$a,Qa=f.a.kpj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",ca,$a);this.vJa();1!==this.ef.state&&this.dt().LMe(ca,$a,Qa)}sFj(ca){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",ca);switch(ca){case Aa.a.Cgg:this.rGj();break;case Aa.a.SXf:this.AFj();break;default:this.YNb()}}CNd(){"VersionHistory"===this.vSc&&
this.La.processAction(Y.a.Gvc,2)}Pda(ca){"VersionHistory"===this.vSc&&this.La.Zd(Y.a.ENd,2,{["FailureReason"]:ca})}}Object(u.a)(ba,"UploadToSharePointManager",null,[316]);var ka=a(248),Pa=a(785),Fa=a(520),oa=a(55);class La{constructor(){this.Kra=this.JPc=this.EPc=this.gb=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Xh(ca){this.gb=ca;this.EPc=Fa.a.jr(ca.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.JPc=Fa.a.jr(ca.Ub("Common.IEventEmitter<Common.IMruResult>"));
this.Kra=Fa.a.jr(ca.Ub("Common.App.SharedFilePicker.ISharedFilePicker"));oa.Task.WAA.call(null,this.EPc,this.JPc,this.Kra).continueWith(()=>{this.Ybj()})}Ybj(){this.gb.register(la,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Fc(()=>new la(x.AFrameworkApplication.fa)).xc();this.gb.register(ba,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Fc(()=>new ba(x.AFrameworkApplication.ub,
this.gb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Pa.a).create(),()=>new d,x.AFrameworkApplication.ta)).xc();this.gb.register(N,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Fc(()=>new N(this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),x.AFrameworkApplication.ta)).xc();this.gb.register(Q,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Fc(()=>
new Q(this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.EPc.result),x.AFrameworkApplication.ta,()=>new U)).xc();this.gb.register(M,"Common.App.SaveToSharePoint.FileNameDialogFactory").Fc(()=>new M(x.AFrameworkApplication.fa,x.AFrameworkApplication.ub,x.AFrameworkApplication.ta,x.AFrameworkApplication.ta.Pa,this.gb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.gb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.JPc.result),this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Kra?this.Kra.result:null)).xc();this.gb.register(va,"Common.App.SaveToSharePoint.SaveToSharePointActor").Fc(()=>new va(x.AFrameworkApplication.fa,x.AFrameworkApplication.ub,this.gb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>x.AFrameworkApplication.ta.Y_g)).xc();x.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.gb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ig()}static main(){ka.a.instance.Ei(new La)}}Object(u.a)(La,"PackageManager",null,[3,4]);a.d(F,"a",function(){return Ea});const Ea=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");La.main()}},1167:function(u,F,a){var c=a(9);u=a(0);var b=a(694),
e=a(49),f=a(37),d=a(1),h=a(184);class n{constructor(La,Ea){this.$=La;this.presentModeManager=Ea}nc(){return!1}wc(La,Ea){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(Ea.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Iz;default:return!1}}executeCommand(La,Ea){La=f.TaskExtensions.Uj();Ea=Ea.command;switch(Ea){case 642419866:this.presentModeManager.Yzc(!this.presentModeManager.Iz);this.presentModeManager.ah("TogglePresentMode");
break;case 588342182:this.presentModeManager.m8a=!this.presentModeManager.m8a;this.presentModeManager.k9f(this.presentModeManager.m8a,"TogglePresentModeOverlay");this.presentModeManager.ah("TogglePresentModeOverlay");break;default:La=h.a(Ea)}return La}Kc(){return!1}}Object(u.a)(n,"PresentModeCommandHandler",null,[208]);class m extends b.a{constructor(La){super(La)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,423,424,this.Ya),La=>{this.Zc([new n(this.$,La.result)])},this.ka,3)}static la(La){b.a.Nd(420,
new m(La))}}Object(u.a)(m,"PresentModeCommandHandlerFactory",b.a,[]);var x=a(222),r=a(15),y=a(128),t=a(4),v=a(111),w=a(83);class C{}C.Hwh="ewa-presentMode-overlay";C.Iwh="ewa-presentMode-panel-container";C.Jwh="ewa-presentMode-rowHdrParent-container";Object(u.a)(C,"CssClassNames",null,[]);var B=a(19),z=a(5),A=a(149),E=a(293),I=a(132),L=a(374),V=a(188);a(59);var T=a(113),H=a(438),D=a(12),G=a(11),J=a(100),M=a(350),Q=a(21),U=a(133),Z=a(424),P=a(108),S=a(14),ja=a(259),X=a(247),Y=a(172),va=a(46);class N{constructor(La){this.wwe=
this.BQa=this.EHd=this.FHd=this.nda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.jsc={};this.isc={};this.xQa=null;this.BMf=0;this.onKeyDown=Ea=>{Ea=Ea.Ca;if(9===Ea.keyCode){var ca=this.nda.querySelectorAll(D.DOMElementExtensions.Gr);const $a=D.DOMElementExtensions.um(ca);ca=D.DOMElementExtensions.oB(ca);D.DOMElementExtensions.hBa(Ea,$a,ca);return!0}return!1};this.am=()=>{this.$.da.$a(337,Ea=>{this.BQa.getPresentModeFloatieControlsMap().then(ca=>{const $a={};for(let Qa=0;Qa<ca.length;Qa++)$a[ca[Qa].controlId]=
ca[Qa].modelType;ca=Ea.n7.A5a($a);0<ca.length&&appChrome.api.dispatch(ca);this.Epj()})})};this.$=La}dispose(){this.$=this.EHd=this.FHd=this.nda=this.BQa=null}ffi(){window.requestAnimationFrame(()=>{this.nda=document.createElement("div");this.$.ru.insertBefore(this.nda,this.$.ru.lastChild);this.nda.id=this.$.Eb+z.a.Mac;this.nda.classList.add(C.Iwh);this.FHd=document.getElementById(this.$.Eb+z.a.N7c);this.EHd=[this.$.dF];this.isInitialized=!0});this.BQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.BQa.initializePresentModeFloatie()}c3h(){const La={};La.PollingCountPerCaller=v.a.toJSON(this.isc);La.PollingDurationPerCaller=v.a.toJSON(this.jsc);return La}yVd(La){this.isInitialized?La?(this.BQa.showPresentModeFloatie(this.nda,this.FHd,this.EHd),this.ah("ShowOrHideFloatiePanel"),this.Zcj()):(this.BQa.hidePresentModeFloatie(),this.jVj()):r.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}ah(La){this.BMf=G.HelperMethods.Tb();
this.xQa=La;this.wwe=Y.AsyncMethodContext.Er(this.am,100,va.a.G5i+La,this.wwe)}get mc(){return this.nda}get Hf(){this.BQa.updatePresentModeFloatieShyState(2);return!!this.nda}get de(){return X.a.QNf}kg(La,Ea){if(Ea)return!1;La=D.DOMElementExtensions.um(this.nda.querySelectorAll(D.DOMElementExtensions.Gr));if(!La)return r.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;La.focus();return!0}mh(La){return D.DOMElementExtensions.Af(this.mc,
La)}sj(){}dk(){}Zcj(){ja.a(this.$).di(this);this.$.da.$a(15,La=>{this.ewaAccessibilityManager=La;this.ewaAccessibilityManager.mode=5});P.KeyInputManager.instance.sa(S.a.Pb,this.mc,this.onKeyDown)}jVj(){ja.a(this.$).Zz(this);Q.h(this.$).U0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);P.KeyInputManager.instance.Ba(S.a.Pb,this.mc,this.onKeyDown)}Epj(){const La=G.HelperMethods.Tb()-this.BMf,Ea=this.jsc[this.xQa]?this.jsc[this.xQa]:0;this.jsc[this.xQa]=Ea>La?Ea:La;this.isc[this.xQa]=
this.isc[this.xQa]?this.isc[this.xQa]+1:1}}Object(u.a)(N,"PresentModeFloatieManager",null,[388,34,2]);var ea=a(7),Ca=a(61);class la{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(u.a)(la,"OverlayCavityInfo",null,[]);class Ra{constructor(){this.height=this.width=0}}Object(u.a)(Ra,"OverlayContainerInfo",null,[]);class lb{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(u.a)(lb,"PresentModeOverlayProps",
null,[]);class Aa{constructor(La){this.t0a=this.GHd=null;this.$=La;this.gridView=Q.h(this.$)}Qfi(){this.GHd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.t0a=Array(5);let La,Ea;for(let ca=1;4>=ca;ca++)La=document.createElement("div"),D.DOMElementExtensions.setVisible(La,!1),La.id=`${"PresentModeOverlay"}-${ca}`,D.DOMElementExtensions.toggleCssClass(La,C.Hwh,!0),Ea=this.gridView.Df(ca).domElement,Ea.insertBefore(La,Ea.firstChild),
this.t0a[ca]=La})}j9f(La){La&&this.LYj();for(let Ea=1;4>=Ea;Ea++)this.Ekf(Ea)&&D.DOMElementExtensions.setVisible(this.t0a[Ea],La);D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-overlay",La)}LYj(){const La=this.c_g();let Ea;for(let ca=1;4>=ca;ca++)Ea=ca,La[Ea]&&this.GHd.showOverlayWithCavity(this.t0a[Ea],La[Ea])}dispose(){this.GHd=this.t0a=this.gridView=this.$=null}c_g(){let La;const Ea=Q.h(this.$).rtl;let ca;const $a=Array(5);for(let Va=1;4>=Va;Va++)if(La=Va,this.Ekf(Va)){var Qa=
this.gridView.Df(Va);ca=this.gridView.ha.Sa.s_?this.UTh(Va,Qa,Ea):this.NUh(Va,Qa,Ea);Qa=this.Tdh(Qa);$a[La]=this.neh(this.t0a[La].id,Qa,ca)}return $a}Ekf(La){return this.gridView.ib.WQ(La)}Tdh(La){return Object(ea.a)(new Ra,{width:La.Am.width,height:La.Am.height})}neh(La,Ea,ca){return Object(ea.a)(new lb,{containerId:La,overlayContainerInfo:Ea,overlayCavityInfos:ca?[ca]:null})}UTh(La,Ea,ca){var $a=Q.h(this.$).ha.Sa.$b;if(!$a)return r.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let Qa,Va;if(({PCa:La,rotation:$a,translateX:Qa,translateY:Va}=$a.extension.XTh(La)).returnValue){const fb=La.x-Ea.Am.x;return Object(ea.a)(new la,{left:(ca?Ea.Am.width-(fb+La.width):fb)-3+1,top:La.y-Ea.Am.y-3+1,width:La.width+5,height:La.height+5,angle:$a,translateX:Qa,translateY:Va})}return null}NUh(La,Ea,ca){La=this.gridView.qb.Ewb(this.gridView.ha.ra.activeRange,La)||Ca.a.l4;if(!La.Ie(Ea.Am))return null;const $a=La.x-Ea.Am.x;return Object(ea.a)(new la,{left:ca?Ea.Am.width-($a+La.width)-2:
$a-3,top:La.y-Ea.Am.y-3,width:La.width+5,height:La.height+5})}}Object(u.a)(Aa,"PresentModeOverlayRenderer",null,[387,2]);var da=a(60);const aa=(La,Ea,ca,$a,Qa,Va,fb=null)=>{fb=La.Na(41,fb);fb.shouldEnablePresentMode=Ea;return da.g(La,"SetPresentMode",fb,ca,$a,Qa,Va,0)};var fa=a(284);class Oa extends fa.a{constructor(La,Ea){super(La);this.H5i=()=>{this.oda.yVd(!0)};this.oda=Ea;this.domElement.classList.add("ewr-presentMode-on");La={[Oa.vu]:this.qc};this.Rb=0;this.initializeAndShow("",this.H5i,La)}get qc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
y.a.Qu(z.a.q9f,"false",this.$.va.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(u.a)(Oa,"PresentModeWelcomeDialog",fa.a,[]);class ba{static get HJh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get IJh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(La){La.webkitRequestFullscreen?La.webkitRequestFullscreen():La.msRequestFullscreen?La.msRequestFullscreen():La.mozRequestFullScreen?La.mozRequestFullScreen():La.requestFullscreen?La.requestFullscreen():r.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():r.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get oni(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(u.a)(ba,"FullscreenUtils",null,[]);class ka{constructor(La){this.Voa=
this.LZe=this.rIb=this.p3a=this.Esc=this.oda=this.DQa=null;this.ctd=this.xQb=this.ROd=!1;this.ENb=!0;this.Thc=!1;this.CVd=!0;this.wQb=this.$1a=this.XFe=0;this.nxc={};this.mrc={};this.lrc={};this.PNf=0;this.m8a=this.tce=!1;this.Ifj=()=>{D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-transition",!1);$removeHandler(this.p3a,"transitionend",this.Voa)};this.gj=()=>{parseInt(this.$.ru.style.right,10)!==this.XFe&&window.requestAnimationFrame(()=>{this.KDc(0);this.$.cAa(E.a.WZ("PresentModeManager.OnContentAreaResized"))})};
this.S6=()=>{var Ea=Object(w.a)(J.a,this.$.oa);if(Ea&&this.Iz){this.gridView.uic=!1;Ea=Ea.headersVisible;var ca=Q.h(this.$).rtl;D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-headers-off",!Ea);D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-rtl",ca);(12!==this.$1a&&!Ea||32!==this.$1a&&Ea&&!ca||0!==this.$1a&&Ea&&ca)&&window.requestAnimationFrame(()=>{this.KDc(2)})}};this.ed=()=>{this.agf();this.ah("OnWorkbookOpened");r.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Np=()=>{this.ctd=!0;this.Uea("OnSelectionStarted")};this.Dg=()=>{this.ctd=!1;this.Uea("OnSelectionEnded");this.$_f()};this.uh=()=>{this.Uea("OnEditStarted")};this.jg=()=>{this.Uea("OnEditEnded")};this.Vw=()=>{if(!this.Thc){const Ea=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Uea("OnVisibleAreaChanged",!0,Ea)}};this.QFb=()=>{this.Thc=!0};this.Ln=()=>{this.Uea("OnCurrentSelectionModeChanged");this.$_f();this.ah("OnCurrentSelectionModeChanged")};this.$m=
()=>{this.Uea("OnBlockCacheItemEvicted")};this.tf=()=>{this.Uea("OnBlockCacheItemChanged")};this.$F=()=>{this.Thc||this.Uea("OnActiveItemPanesChanged")};this.Gh=()=>{this.Thc=!1;this.oda.ah("ActiveSheetChanged");this.S6()};this.QGb=(Ea,ca)=>{if(Ea=Object(w.a)(J.a,ca.item))Ea.jrb(16,!0),Ea.MZa(this.S6)};this.YPi=()=>{ba.oni||(this.Esc&&this.Esc.Gn&&this.Esc.hide(),Q.h(this.$).eb&&Q.h(this.$).To(!0),this.Yzc(!1),r.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.ZPi=()=>{r.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=La;this.gridView=Q.h(this.$);this.oqj=La.va.PresentModeRenderUpdateTimeout;this.initialize(La)}get Iz(){return this.tce}Yzc(La){this.Iz!==La&&(this.tce=La,this.m8a=this.Iz,this.agf(),this.ENb=this.W7f(),window.requestAnimationFrame(()=>{D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-transition",!0);$addHandler(this.p3a,"transitionend",this.Voa);
this.xGj(!La);this.p0i();D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on",La);this.wGj(La);A.b(this.$).h9f(this.Iz);A.c(this.$).h9f(this.Iz);this.$.GAa();this.DQa.j9f(this.ENb);if(this.Iz){this.E_a();y.a.get(z.a.q9f)?this.oda.yVd(this.Iz):this.Esc=new Oa(this.$,this.oda);var Ea=Z.b(this.$);Ea&&(this.ROd=Ea.f$c(!1));this.PNf=G.HelperMethods.Tb()}else this.oda.yVd(La),this.ROd&&(Ea=Z.b(this.$))&&(Ea.f$c(!0),this.ROd=!1),this.T7b(),this.mBi()}))}k9f(La,Ea){this.CVd=La;this.Uea(Ea)}ah(La){this.oda.ah(La)}dispose(){this.T7b();
this.DQa&&(this.DQa.dispose(),this.DQa=null);this.gridView=this.$=null}xGj(La){const Ea=this.$.da.Aa(25);void 0===Ea||null===Ea?r.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):La?Ea.Tzc():Ea.wfc()}p0i(){D.DOMElementExtensions.toggleCssClass(document.getElementById(t.AFrameworkApplication.A3a),B.a.zo,this.Iz);D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on",this.Iz);this.zGj(this.Iz);this.gridView.uic=!this.Iz;this.aZj();this.$.da.$a(32,
La=>{La.wZj(this.Iz)});T.b(this.$,La=>{La.zig(this.Iz)})}zGj(La){if(this.rIb)if(La){if(La=Object(w.a)(J.a,this.$.oa))D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-headers-off",!La.headersVisible),D.DOMElementExtensions.toggleCssClass(this.$.vr,"ewr-presentMode-on-rtl",Q.h(this.$).rtl);this.KDc(0)}else this.$.vr.classList.remove("ewr-presentMode-on-headers-off"),this.$.vr.classList.remove("ewr-presentMode-on-rtl"),this.KDc(1)}KDc(La){var Ea=Object(w.a)(J.a,this.$.oa);if(Ea){var ca=
parseInt(this.$.ru.style.right,10);if(1===La||2===La){if(isNaN(ca)||ca<this.$1a)return;ca-=this.$1a}if(0===La||2===La)La=Ea.headersVisible,Ea=Q.h(this.$).rtl,La=La?Ea?0:32:12,ca=isNaN(ca)?La:ca+La,this.$1a=La;this.$.ru.style.right=G.HelperMethods.uc(ca);this.XFe=ca}}aZj(){const La=document.getElementById(this.$.Eb+z.a.u7b).parentNode;D.DOMElementExtensions.toggleCssClass(La,C.Jwh,this.Iz)}initialize(La){this.DQa=new Aa(La);this.DQa.Qfi();this.oda=new N(La);this.oda.ffi();this.p3a=document.getElementById("MainApp");
this.LZe=this.YPi;$addHandler(this.p3a,ba.HJh,this.LZe);$addHandler(this.p3a,ba.IJh,this.ZPi);this.rIb||(this.rIb=document.createElement("div"),this.rIb.className="ewa-presentMode-right-frame",this.$.dF.appendChild(this.rIb));this.Voa=this.Ifj}E_a(){this.gridView.ha.V2(this.Np);this.gridView.ha.KY(this.Dg);this.gridView.fc.Yk(this.uh);this.gridView.fc.Rm(this.jg);this.gridView.FC(this.Ln);this.gridView.view.ot(this.Vw);this.gridView.YWc(this.QFb);this.gridView.Da.gH(this.$m);this.gridView.Da.nt(this.tf);
this.$.xa.Xf(this.Gh);this.$.xa.nsa(this.$F);this.$.xa.gha(this.QGb);this.$.QA(this.gj);this.$.ll(this.ed);const La=Object(w.a)(M.a,this.$.xa);for(const Ea of La.items)Ea.MZa(this.S6)}T7b(){this.gridView&&(this.gridView.ha.t7(this.Np),this.gridView.ha.RW(this.Dg),this.gridView.fc.Gk(this.uh),this.gridView.fc.em(this.jg),this.gridView.bE(this.Ln),this.gridView.view.er(this.Vw),this.gridView.bMd(this.QFb),this.gridView.Da.CI(this.$m),this.gridView.Da.cr(this.tf));if(this.$){this.$.xa.Eg(this.Gh);this.$.xa.wAa(this.$F);
this.$.xa.una(this.QGb);this.$.aE(this.gj);this.$.Kl(this.ed);const La=Object(w.a)(M.a,this.$.xa);for(const Ea of La.items)Ea.dvc(this.S6)}}W7f(){if(!this.Iz||!this.m8a)return!1;if(1===this.gridView.ha.Oe){const La=this.$.oa.activeRange.isSingle,Ea=1===this.$.oa.selectedRanges.length&&!La,ca=this.gridView.eb,$a=this.ctd;Ea||r.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${La}`);return this.CVd&&Ea&&!ca&&
!$a}return this.CVd}wGj(La){La?ba.requestFullscreen(this.p3a):ba.exitFullscreen()}Uea(La,Ea=!1,ca=!1){Ea||(this.ENb=this.W7f());r.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${La}, visibility: ${this.ENb}, immediateUpdate: ${ca}`);if(this.xQb&&ca)r.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.wQb}`),window.cancelAnimationFrame(this.wQb),this.wQb=0;else if(this.xQb){r.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${La}`);return}ca?this.f1d(G.HelperMethods.Tb(),La):(this.wQb=window.requestAnimationFrame($a=>{this.f1d($a,La)}),this.xQb=!0)}f1d(La,Ea){var ca=G.HelperMethods.Tb();if(ca-La>this.oqj)this.wQb=window.requestAnimationFrame(Qa=>{this.f1d(Qa,Ea)}),this.xQb=!1,r.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${ca-La}ms.`);else{this.DQa.j9f(this.ENb);this.xQb=!1;var $a=
G.HelperMethods.Tb();La=G.HelperMethods.Tb()-La;ca=$a-ca;this.qpj(La,Ea);r.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${ca}ms. rafTotalDuration = ${La}ms`)}}agf(){L.a(this.$.userOperationManager,(La,Ea,ca)=>aa(this.$.pa.ya,this.Iz,La,Ea,ca,null),La=>new V.a(252,0,La),null)}$_f(){let La=H.a(this.gridView.Oe);1!==this.gridView.Oe||this.$.oa.activeRange.isSingle||(La="Range");this.nxc[La]=this.nxc[La]?this.nxc[La]+1:1}qpj(La,Ea){const ca=this.mrc[Ea]?
this.mrc[Ea]:0;this.mrc[Ea]=ca>La?ca:La;this.lrc[Ea]=this.lrc[Ea]?this.lrc[Ea]+1:1}mBi(){const La={};var Ea=G.HelperMethods.Tb()-this.PNf;La.PresentModeDuration=Ea;La.SelectionCountPerObject=v.a.toJSON(this.nxc);La.OverlayCountPerCaller=v.a.toJSON(this.lrc);La.OverlayDurationPerCaller=v.a.toJSON(this.mrc);Ea=this.oda.c3h();for(let ca in Ea)La[ca]=Ea[ca];U.b(this.$).ud(I.a.F5i,La,void 0,!0)}}Object(u.a)(ka,"PresentModeManager",null,[347,2]);var Pa=a(185);class Fa extends x.a{constructor(La){super();
this.$=La;this.Fb()}create(){const La=e.GetServiceTaskFactory.Oa(this.$.da,283,284,1);f.TaskExtensions.za(La,()=>{f.TaskExtensions.za(Pa.c(La.result.kn.loadScript("presentMode")),()=>{let Ea=this.$.da.Aa(423);Ea||(Ea=new ka(this.$),this.$.da.Ga(423,Ea));this.nb(Ea)},this.$.ka,3)},this.$.ka,3)}static la(La){La.da.Ga(424,new Fa(La))}}Object(u.a)(Fa,"PresentModeManagerFactory",x.a,[]);a.d(F,"a",function(){return oa});const oa=()=>{c.a.Fa(La=>{Fa.la(La);m.la(La)})}},1171:function(u,F,a){var c=a(9);u=
a(0);var b=a(553),e=a(694),f=a(49),d=a(37),h=a(15),n=a(1240),m=a(4),x=a(164),r=a(755),y=a(98),t=a(263),v=a(643),w=a(27),C=a(157),B=a(179),z=a(289),A=a(5),E=a(148),I=a(102),L=a(76),V=a(74),T=a(374),H=a(188),D=a(59),G=a(60),J=a(328),M=a(588),Q=a(1337),U=a(421),Z=a(321),P=a(13);class S extends Q.a{constructor(Ma,ob){super(Ma,void 0,void 0,ob)}get cPa(){return P.a.instance.Ua(420)}get Glc(){return P.a.instance.Ua(421)}get Flc(){return"DownloadOdsLink"}get qDb(){return"#"}get l9a(){return P.a.instance.Ua(422)}get tvf(){return!0}erf(){h.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}grf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}zlc(){U.Redirect.showHelp(Z.a.xKi);return!0}}Object(u.a)(S,"DownloadACopyAsOdsDialog",Q.a,[]);class ja{constructor(Ma,ob){this.dialog=null;this.yBf=()=>{this.dialog&&this.dialog.hide()};this.NKi=Ma;this.rb=ob;this.rb.vob(this.yBf)}Cwe(Ma){this.dialog=Ma}Z8c(){this.NKi.fKf(-1059172980)}dispose(){this.rb.eKb(this.yBf)}}
Object(u.a)(ja,"DownloadACopyAsOdsDialogDownloadBehavior",null,[275,2]);const X=(Ma,ob,Ia,Da,nb,Ua,W=null)=>{W=Ma.Na(9,W);W.isReadOnlyRecommended=ob;return G.g(Ma,"SetReadOnlyRecommended",W,Ia,Da,nb,Ua,0)},Y=(Ma,ob,Ia,Da,nb,Ua,W=null)=>{W=Ma.Na(9,W);W.calc_type=ob;return G.g(Ma,"SetCalculationOptions",W,Ia,Da,nb,Ua,0)};class va{constructor(Ma){this.calculationMode=0;this.calculationMode=Ma}}Object(u.a)(va,"MacroRecorderWorkbookCalculationModeSetPayload",null,[108]);class N{constructor(Ma){this.calculateType=
0;this.calculateType=Ma}}Object(u.a)(N,"MacroRecorderWorkbookRecalculatedPayload",null,[108]);var ea=a(85),Ca=a(146),la=a(178),Ra=a(14),lb=a(108),Aa=a(1);Q=a(261);class da{static get j_i(){return da.i_i}}da.i_i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(u.a)(da,"OpenInAppDialogCopyHtml",null,[]);var aa=a(152);class fa extends Q.a{constructor(Ma){super(Ma);this.mI=null;this.YFb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.va.IsMeetingLiveSession)return this.ZFc(),!0;w.a.Ap?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Ox&&this.Ox.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Ox+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Fm+";end","_top")):9<=w.a.Ymd?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.qma,"_top"),window.setTimeout(()=>{this.openUrl(this.Fm,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.qma,
"_top"),window.setTimeout(()=>{this.openUrl(this.Fm,"_blank")},500));return!0};this.KPa=ob=>ob.Ca.keyCode===ea.a.Mh||ob.Ca.keyCode===ea.a.bfa?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),ob.Gb.click(),!0):!1;1===m.AFrameworkApplication.ta.Pa.Hj&&(this.Ox=this.$.workbookContext.ClientUrl,this.qma="ms-excel:ofe|u|"+this.Ox,this.Fm=m.AFrameworkApplication.fa.Xa("AppUrl"),w.a.Mba?this.Fm="itms-apps://"+m.AFrameworkApplication.fa.Xa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
w.a.Ap&&(Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.va.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Fm=m.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):w.a.gBb?this.Fm=m.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<w.a.tYc.ZOa&&(this.Fm=m.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get qc(){return"OpenInAppDialogCopy"}openUrl(Ma,
ob){let Ia=document.getElementById("link");Ia||(Ia=document.createElement("a"),Ia.id="link",Ia.style.visibility="hidden",Ia.href="",document.body.appendChild(Ia));Ia.target=ob;Ia.href=Ma;Ia.click()}ZFc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ma=>{let ob={};ob.OpenInAppUrl=this.qma;ob.StoreUrl=this.Fm;Ma.result.Rj("UI_OpenInMobileApp",ob)},this.$.ka)}k_i(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}hg(){this.qg=
Ca.a.iq(da.j_i,P.a.instance.ga(662),P.a.instance.ga(663),m.AFrameworkApplication.tB,aa.getImageClass(m.AFrameworkApplication.fa.Xa("AppIcon")),P.a.instance.ga(664));this.Fe="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.k_i.bind(this),null);this.OI(this.mI)}Pv(Ma){super.Pv(Ma);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.mI=document.getElementById("LinkToInstall");la.a.instance.sa(Ra.a.click,this.mI,this.YFb);lb.KeyInputManager.instance.sa(Ra.a.Fd,this.mI,
this.KPa)}dispose(){this.mI&&(la.a.instance.Ba(Ra.a.click,this.mI,this.YFb),lb.KeyInputManager.instance.Ba(Ra.a.Fd,this.mI,this.KPa),this.mI=null);super.dispose()}}Object(u.a)(fa,"OpenInAppDialogCopy",Q.a,[]);var Oa=a(134),ba=a(376);class ka{constructor(Ma){this.Lbi="itms-apps://";this.Mbi="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.hpg=ob=>{1==ob&&this.ZFc()};this.$=Ma;this.Ox=m.AFrameworkApplication.ta.Pa.Ox;this.qma="ms-excel:ofe|u|"+this.Ox;this.Fm=m.AFrameworkApplication.fa.Xa("AppUrl");
w.a.Mba||w.a.$g?this.Fm=this.Lbi+this.Mbi:w.a.Ap&&(m.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Fm=m.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):w.a.gBb?this.Fm=m.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<w.a.tYc.ZOa&&(this.Fm=m.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")))}ZFc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ma=>{let ob={};ob[ba.a.lKf]=this.qma;ob[ba.a.Fm]=this.Fm;Ma.result.Rj("UI_OpenInMobileApp",ob)},this.$.ka)}hg(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Ma=new Oa.StandardDialog;Ma.Rb=0;Ma.pc(1,P.a.instance.ga(668));Ma.Zl(P.a.instance.ga(666),P.a.instance.ga(667),0,this.hpg)}}Object(u.a)(ka,"OpenInAppDialogReact",null,[]);Q=a(284);class Pa extends Q.a{constructor(Ma){super(Ma);
this.sessionId=Ma.va.UserSessionId;this.yXg=Ma.va.BuildVersion}get qc(){return"WACSessionIdDialog"}oN(){return{[Pa.Itj]:P.a.instance.ga(669),[Pa.Jtj]:this.sessionId,[Pa.id]:"WACSessionIdDialog",[Pa.c0c]:P.a.instance.ga(670),[Pa.buildVersion]:this.yXg}}hg(){const Ma=this.oN();this.Rb=5;this.initializeAndShow(P.a.instance.ga(1023),this.x2j.bind(this),Ma)}x2j(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}Pa.id="id";Pa.Itj="sessionIdLabel";Pa.Jtj="sessionIdValue";Pa.c0c=
"buildLabel";Pa.buildVersion="buildVersion";Object(u.a)(Pa,"WACSessionIdDialog",Q.a,[]);var Fa=a(28),oa=a(29),La=a(359),Ea=a(11),ca=a(184),$a=a(281),Qa=a(21),Va=a(44),fb=a(250),Ka=a(380),hb=a(288),fc=a(51),dc=a(6),wb=a(143),Tb=a(969),xb=a(81),cb=a(36),jb=a(303),qa=a(253);class za{OQ(Ma,ob){Ma=oa.a.$c(12,1,671,0,0,0,"Blank");Ma.Description=String.format(P.a.instance.ga(672),ob);return Ma}Cbc(Ma){switch(Ma){case 1:case 2:return 0;default:return 2}}}Object(u.a)(za,"ReloadCloseConfirmation",null,[115]);
var Na=a(150),ua=a(589),Xa=a(70),ha=a(55),ta=a(174),wa=a(33);class db extends B.a{constructor(Ma,ob,Ia,Da){super();this.$=Ma;this.businessBar=Da;this.openInExcelOperation=ob;this.wK=Ia}get Zb(){return this.$.ea.Zb}get workbookContext(){return this.$.workbookContext}get L8b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return Xa.a(this.$)}get dc(){return this.$.dc}G$h(){var Ma,ob;return null!==(ob=null===(Ma=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===
Ma?void 0:Ma.LoadBlockType)&&void 0!==ob?ob:!1}nc(){return!1}executeCommand(Ma,ob,Ia,Da){const nb=this.L8b,Ua=this.$,W=ob.command,sa=this.openInExcelOperation,vb=this.$.Eb,gc=Ia.SourceControlId;Ua.gl.$pe(W);sa.Fyc(ob.startTime.getTime().toString());Ma=null;switch(W){case 1455037301:this.$.K5?sa.gGe():sa.J4c();break;case -2044628748:case 2004484710:this.$.K5?sa.gGe():sa.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===gc?(this.TDb("CellLongPress"),h.ULS.sendTraceTag(576495705,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.TDb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const Bc=Xa.a(this.$).hd.activityState;Va.a(Ua).Ls(new fb.a(dc.a.ey,5,()=>{Bc[qa.a.Hq]=dc.a.hj}));break;case 480922297:Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",
!1)&&(new Pa(this.$)).hg();break;case -2028960985:sa.aag();break;case -1059172980:new S(sa.Zye(W),new ja(sa,Ua.rb));break;case -1285148982:this.clientWorkflow.hd.activityState[cb.a.ZVc]=!0;this.NCc(!1);break;case -75280711:this.NCc(!1);break;case -455164169:this.NCc(!0);break;case -1388494670:this.$.da.$a(400,qb=>{qb.jEi();this.NCc(!1)});break;case 810888577:m.AFrameworkApplication.yk=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${m.AFrameworkApplication.yk}`);
break;case -1804063550:case -974518828:ob=0;A.a.hFd in Ia&&(ob=Ia[A.a.hFd]);sa.fKf(W,ob);break;case -1339961039:ob=!1;Ia&&A.a.fLb in Ia&&(ob=Ia[A.a.fLb]);this.reloadWorkbook(!1,ob);break;case -8805455:const Sa=this.workbookContext;if(Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.G$h()&&wa.a.fd(this.$)){const qb=f.GetServiceTaskFactory.Oa(this.$.da,522,523,0);d.TaskExtensions.za(qb,()=>{qb.result.hE()},this.$.ka,3)}else Ua.isEditMode||(db.GDe(Ua),
Ma=d.TaskExtensions.za(this.wK.value,qb=>{qb=qb.result;var Ha=qb.isEnabled();Ha&&M.a(qb,x.a.copyAndEdit,D.a.Bg.E1e(),this.$.ea.Yg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Ha&&m.AFrameworkApplication.$jg?(Ha={},Ha[n.a.eId]=m.AFrameworkApplication.userSessionId,Ha[m.AFrameworkApplication.zGi]=Fa.a.Qa.zb.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
qb.Rj(x.a.editMode,Ha)):nb.CopyAndEditUrl?this.T9g():(this.dc.supportsEditing||Sa.EditUrl)&&this.reloadWorkbookInEditMode()},this.ka,3));break;case -723527778:Ua.isEditMode&&(db.GDe(Ua),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const na=Ua.pa.ya.Wb(),ib=-1355155015===W?1:0,Ib=()=>new N(ib);Ma=T.a(this.$.userOperationManager,(qb,Ha,Ab)=>G.y(Ua.pa.ya,ib,null,qb,Ha,Ab,null,na),qb=>new H.a(128,0,qb,void 0,Ib),ob);Qa.h(Ua).yf.pH(!1);break;case -1158102843:Ma=Qa.h(Ua).yf.recalcSheet(ob);
Qa.h(Ua).yf.pH(!1);break;case -988468372:if(Aa.EwaSettings.ma(296))if(Da=parseInt(Ia[L.a.Jc],10),0<=Da&&3>Da)this.setCalculationMode(ob,Da);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${Ia[L.a.Jc]}`),ca.a(W);break;case 257398710:E.a.ntw(nb.ReportAbuseUrl,Ua);break;case 1800405051:this.mpj();break;case -48469327:this.saveACopy();break;case 214430355:ob=!1;Ia&&A.a.G9c in Ia&&(ob=Ia[A.a.G9c]);if(!this.ZCj(ob,Ia))break;m.AFrameworkApplication.x5?this.businessBar.ng(42,
null):this.businessBar.ng(ob?22:23,null);break;case 1389557314:Ma=d.TaskExtensions.za(this.wK.value,qb=>{M.a(qb.result,x.a.XEh,null,this.$.ea.Yg.get(6))||E.a.ntw(nb.FileVersionUrl,Ua)},this.ka,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:gc===vb+A.a.Znf?sa.Twi():sa.Swi();break;case 512141517:gc===vb+A.a.Ynf?sa.axi():sa.$wi();break;case -1224038235:const ec=r.a.On in Ia?!Ia[r.a.On]:I.j(Ua.ea.workbookContext.Options);Ia[r.a.Description]=ec?P.a.instance.ga(571):P.a.instance.ga(572);
Ma=T.a(this.$.userOperationManager,(qb,Ha,Ab)=>X(this.$.pa.ya,!ec,qb,Ha,Ab,null),qb=>new H.a(129,0,qb),ob);break;case 1118926154:if(this.$.isEditMode){const qb=new C.a;this.$.da.$a(53,Ha=>{Ha?(Ha.Em.Lwi(this.$.Eb+A.a.Dud),qb.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Ma=qb.task}break;case -1698025133:sa.openInBrowser();break;case 520859864:Ma=d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,393,394,Da.L4()),
qb=>{qb.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.ka,3);break;default:Ma=ca.a(W)}return Ma||ha.Task.Ta(!0)}TDb(Ma){if(Ea.HelperMethods.v_){const ob=new Map;ob.set("EntryPoint",Ma);y.Health.instance.recordKpiUsage(hb.a.h_i,0,Ka.a.mGi,ob)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){m.AFrameworkApplication.isMobileMode&&
(this.$.va.IsMeetingLiveSession&&Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new ka(this.$)).hg()):Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new fa(this.$)).hg()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),m.AFrameworkApplication.showOpenInAppDialog()))}ZCj(Ma,ob){return m.AFrameworkApplication.isMobileMode&&!V.a(this.$.va,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.TDb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):m.AFrameworkApplication.Tic&&(Ma&&La.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${La.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):t.a.any([25,26,30,31,57,32,34],Ia=>this.businessBar.fla(Ia))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):ob&&A.a.n7i in ob&&!Ma?!1:!0}wc(Ma,ob){Ma=!1;switch(ob.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Ma=
!0;break;case 480922297:case 520859864:Ma=Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Ma=ta.a.prd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Ma=Aa.EwaSettings.ma(107);break;case -1388494670:Ma=Aa.EwaSettings.ma(107);break;case 810888577:Ma=Aa.EwaSettings.ma(267);break;case -1224038235:Ma=this.$.ea.amIAlone;break;case -988468372:Ma=Aa.EwaSettings.ma(296);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Ma=
!0,h.ULS.shipAssertTag(537162642,0,this.$.cla,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Ma}Kc(){return!1}mpj(){if(this.Zb){var Ma=this.$;Va.a(Ma).Ls(new fb.a(dc.a.ey,5,()=>{Ma.BI(!1,!0);const ob=this.clientWorkflow.hd.activityState;ob[qa.a.Hq]=dc.a.Yda;ob[wb.a.KT]=2;ob[cb.a.$r]=Ma.isEditMode;ob[wb.a.Vga]=!1}))}}saveACopy(){if(this.Zb){var Ma=this.$;Va.a(Ma).Ls(new fb.a(dc.a.ey,5,()=>{Ma.BI(!1,!1);const ob=this.clientWorkflow.hd,Ia=ob.activityState;
Ia[qa.a.Hq]=dc.a.D_f;Ia[ua.a.u_b]=this.dc.hasUnsupportedFeaturesForEdit;Ia[wb.a.Vga]=!1;ob.rr(oa.a.t4(this.businessBar.Z9c,[-502303485]))}))}}NCc(Ma){Va.a(this.$).Ls(new fb.a(dc.a.Xna,2,()=>{this.$.BI(!0,!0);var ob=Xa.a(this.$).hd,Ia=this.$.isEditMode;Ia=oa.a.$c(1,1,0,0,0,Ia?-315732528:-2087635043,Ia?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Ia.ForceVersionUpgrade=Ma;ob.rr([Ia]);ob=Xa.a(this.$).hd.activityState;ob[qa.a.Hq]=dc.a.Xna;ob[cb.a.$r]=this.$.isEditMode;ob[wb.a.Vga]=!1}))}closeWorkbook(){if(this.Zb){var Ma=
this.$;D.a.Bg.jzc("2145659238")?d.TaskExtensions.za(this.wK.value,ob=>{ob.result.Rj(x.a.cXe,{})},this.ka,3):Va.a(Ma).Ls(new fb.a(dc.a.ey,5,()=>{Ma.BI(!0,!1);const ob=this.clientWorkflow.hd.activityState;ob[wb.a.DY]=!1;ob[wb.a.Vga]=!1;this.dc.inViewerFromWebPart?(J.a.WId(Ma,this.clientWorkflow.hd),Ma.gl.hz("InViewerFromWebPart"),ob[qa.a.Hq]=dc.a.b0):(ob[qa.a.Hq]=dc.a.Yj,Ma.qd&32?ob[wb.a.KT]=0:(ob[wb.a.KT]=1,ob[wb.a.j_b]=new Tb.a),ob[Na.a.voe]=!0)}))}}T9g(){const Ma=this.dc.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Ma}`);const ob=this.$;Ma?Va.a(ob).Ls(new fb.a(dc.a.ey,5,()=>{const Ia=oa.a.$c(3,0,0,1261,0,1069271157,"XLSMacroFailure");this.clientWorkflow.hd.rr([Ia]);this.clientWorkflow.hd.activityState[qa.a.Hq]=dc.a.agb})):m.AFrameworkApplication.hideHeader?Ea.HelperMethods.lf(this.L8b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):E.a.ntw(this.L8b.CopyAndEditUrl,ob)}reloadWorkbookInEditMode(){if(this.Zb)if(D.a.Bg.OV&&
D.a.Bg.JKd(),m.AFrameworkApplication.Tic&&!m.AFrameworkApplication.aca)Ea.HelperMethods.lf(this.$.xqb(!0),z.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Ma=this.$,ob=!1,Ia=this.dc.hasUnsupportedFeaturesForEdit,Da=this.workbookContext.FileWasRepaired;La.d(this.workbookContext.WorkbookFileName)?(ob=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Ia}`)):La.a(this.workbookContext.WorkbookFileName)&&
(ob=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var nb=Ma.ie.get(59);nb=!(Ma.ea.dc.supportsEditing&&nb);if(ob&&!Ia||nb&&(ob||Ia)){let Ua;Ua=nb?Ia?-2066104278:816071846:Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&V.a(this.$.va,25)&&!this.$.QBb?765011943:-213064907;ob=()=>{const W=oa.a.j0a([Ua]);this.clientWorkflow.hd.rr(W);this.clientWorkflow.hd.activityState[qa.a.Hq]=dc.a.agb}}else ob=()=>
{Ma.BI(!0,!1);var Ua=this.clientWorkflow.hd;const W=Ua.activityState;W[wb.a.KT]=1;W[jb.a.o_b]=v.a.lnc;W[cb.a.$r]=!0;W[ua.a.u_b]=this.dc.hasUnsupportedFeaturesForEdit;W[wb.a.Vga]=!!this.workbookContext.EditUrl;W[xb.a.J2]=this.workbookContext.EditUrl;if(!this.L8b.CopyAndEditUrl){const sa=[Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&V.a(this.$.va,25)&&!this.$.QBb?-943219229:1821390342];Ua.rr(oa.a.t4(this.businessBar.Z9c,sa))}Da&&!Ia?(La.b(this.workbookContext.WorkbookFileName)&&
Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Ua=oa.a.j0a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Ua=oa.a.j0a([108482388]),this.clientWorkflow.hd.rr(Ua),W[qa.a.Hq]=dc.a.R_f):this.$.ea.Raf?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),fc.b().cXd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session",
"PasswordToModifyDialogShown"),W[qa.a.Hq]=dc.a.MHb):W[qa.a.Hq]=this.$.ea.Fic?dc.a.uDb:dc.a.agb};Va.a(Ma).Ls(new fb.a(dc.a.ey,5,ob))}}reloadWorkbookInViewMode(){if(this.Zb){D.a.Bg.OV&&D.a.Bg.JKd();var Ma=this.$;w.a.$g&&Qa.h(Ma).Vb.textBox.blur();Va.a(Ma).Ls(new fb.a(dc.a.ey,5,()=>{Ma.BI(!Ma.ea.isNamedObjectViewMode,!1);const ob=this.clientWorkflow.hd.activityState;ob[qa.a.Hq]=dc.a.dia;ob[wb.a.KT]=1;ob[wb.a.DY]=!0;ob[cb.a.$r]=!1;ob[cb.a.Tnb]=!0;ob[jb.a.o_b]=v.a.lnc}))}}reloadWorkbook(Ma,ob){if(this.Zb){var Ia=
this.$;Ia.bV&65536&&Va.a(Ia).Ls(new fb.a(dc.a.ey,5,()=>{Ia.BI(Ma,!0);const Da=this.clientWorkflow.hd.activityState;Da[qa.a.Hq]=dc.a.pz;Da[cb.a.bWc]=this.workbookContext.NovMode;ob||(Da[wb.a.KT]=1,Da[wb.a.j_b]=new za)}))}}setCalculationMode(Ma,ob){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${ob} `);const Ia=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=ob;const Da=()=>new va(ob);return T.a(this.$.userOperationManager,(nb,Ua,W)=>Y(this.$.pa.ya,
ob,$a.b(nb,db.ZWi(this.$,Ia)),$a.a(Ua,db.YWi(this.$,Ia)),W,null),nb=>new H.a(197,0,nb,void 0,Da),Ma)}static GDe(Ma){Ma.rb&&0<Ma.rb.JR&&Ma.rb.Fbd(ob=>{ob.sv()})}static ZWi(Ma,ob){return Ia=>{oa.a.dg(Ia.Errors)&&(Ma.ea.workbookContext.CalcMode=ob,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${ob}.  Error id names: ${oa.a.sc(Ia.Errors)}`))}}static YWi(Ma,ob){return()=>{Ma.ea.workbookContext.CalcMode=ob;h.ULS.sendTraceTag(537162627,
0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${ob})`)}}}Object(u.a)(db,"FileOperationsCommandHandler",B.a,[208]);var Jb=a(153);class Pb extends e.a{constructor(Ma){super(Ma)}ld(){const Ma=this.$,ob=[],Ia=f.GetServiceTaskFactory.create(Ma.da,56,this.ka,this.Ya);ob.push(Ia);const Da=f.GetServiceTaskFactory.Oa(Ma.da,5,4,this.Ya);ob.push(Da);d.TaskExtensions.za(ha.Task.jJ(...ob),()=>{Jb.b(Ia)&&this.Zc([new db(Ma,Ia.result,new b.a(()=>f.GetServiceTaskFactory.create(Ma.da,
137,this.ka,this.Ya)),Da.result)])},this.ka,0)}static la(Ma){e.a.Nd(94,new Pb(Ma))}}Object(u.a)(Pb,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(F,"a",function(){return eb});const eb=()=>{c.a.Fa(Pb.la)}},1172:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(8),f=a(19),d=a(67),h=a(61),n=a(5),m=a(31);class x{}x.fxh="ewa-resizehdr-row-hidden";x.exh="ewa-resizehdr-col-hidden";Object(u.a)(x,"CssClassNames",null,[]);var r=a(239),y=a(14),t=a(156),v=a(632),w=a(27),C=a(224),B=a(4),z=a(263),A=a(15),E=
a(76),I=a(132),L=a(40),V=a(142),T=a(24),H=a(52),D=a(12),G=a(71),J=a(1),M=a(95),Q=a(11),U=a(13),Z=a(251),P=a(133),S=a(375),ja=a(44),X=a(34);class Y{constructor(jb,qa,za,Na,ua,Xa,ha){this.Dwa=jb;this.LEb=qa;this.vPa=za;this.Sld=Na;this.fdb=ua;this.Smf=Xa;this.W9h=ha}}Object(u.a)(Y,"HeaderEventCachedInfo",null,[]);class va{constructor(jb){this.y9c=jb}xGe(jb){jb=Q.HelperMethods.JGd(jb);return Math.max(0,Math.min(va.Suf,jb))}nGe(jb){return this.X2i(jb)}p5g(jb){return Math.round(this.y9c*jb+2*this.m2e()+
1)}X2i(jb){return Math.max(0,Math.min(va.xuf,(Math.max(0,Math.min(e.a.Pmc,jb))-2*this.m2e()-1)/this.y9c))}m2e(){return Math.floor(Math.max((this.y9c+3)/4,2))}edc(jb,qa){return qa?jb?va.Suf:e.a.Vyd:jb?va.xuf:e.a.Pmc}}va.Suf=409;va.xuf=255;Object(u.a)(va,"ResizeHeadersConverter",null,[]);var N=a(191);class ea extends M.a{constructor(jb,qa){super(qa.domElement);this.iY=this.HYf=!1;this.mi=this.U8a=this.HBa=null;this.SNd=!0;this.Jjc=!1;this.GLb=this.ql=this.offset=0;this.uN=this.dS=this.h1=null;this.Z$h=
"headerResizeTooltip";this.FG=this.hxd=null;this.SZc=this.jY=this.IAa=!1;this.EKf=this.Gab=e.a.axa;this.Dgf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.xRb=!1;this.dO=za=>{if(this.grid.Dj)return!1;za=X.a(this.grid.$).Vd(za);if(3===za.tb&&!this.Tmf(za.Ca)||!this.BNf(za,!1))return!1;A.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Na=this.bAc();this.Med(za.clientPoint,Na,!0);this.IAa||(r.a.instance.sa(y.a.Kj,this.domElement.ownerDocument.body,
this.Q$a),t.a.instance.sa(y.a.$f,this.domElement.ownerDocument.body,this.Q$a),this.IAa=!0);this.Rif()&&this.iY&&this.sdf(za);return!1};this.dGb=za=>{za=X.a(this.grid.$).Vd(za);this.Rif()&&this.SZc&&this.sdf(za);if(!za.Ca.type.includes("touch")&&za.Ca.button!==Sys.UI.MouseButton.leftButton||!this.JBb)return!1;G.g(za.Ca);this.DPe();za=this.grid.Dj?this.Gab:e.a.axa;var Na=!1;if(this.grid.Dj&&this.mi){var ua=za!==this.ql||!this.Dgf&&this.jY;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!ua&&this.xRb&&(this.fe.removeRowColFromModel(this.mi.xnb,this.mi.KTf),Na=!0,J.EwaSettings.wm()&&(this.fe.q8(this.grid.ha.ra.selectedRanges),this.fe.en("HeaderResizeBehavior::onDocumentMouseUp")))}else this.mi&&(za=this.jY?this.ngd():this.mi.I4()),ua=za!==this.ql;this.HBa&&ua&&za!==e.a.axa?(za=this.grid,Na=this.Hid(za),ua={},ua.SheetMultiRange=L.r(Na,za.$),ea.vSd(ua,this.isRow,this.ql),J.EwaSettings.fpd()&&this.grid.Dj&&(Na=ua.SheetMultiRange.Ranges[0],A.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.mi?
this.mi.xnb:-1}, isResizingHiddenHeader=${this.jY}, headerViewBlockHashCode=${this.fe.hashCode},
          rangeFirstRow=${Na.FirstRow}, rangeFirstColumn=${Na.FirstColumn}, rangeLastRow=${Na.LastRow}, rangeLastColumn=${Na.LastColumn},`)),this.orh(ua),za.dNj=!0):(!J.EwaSettings.wm()&&Na&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.fe.q8(this.grid.ha.ra.selectedRanges),this.fe.en("HeaderResizeBehavior::onDocumentMouseUp")),this.Dg(null,null),this.TJb());return this.xRb=this.jY=!1};this.Pca=za=>{if(this.grid.Dj)return!1;za=v.a.create(za.eventName,
za.Gb,za.Ca,za.tb);za=X.a(this.grid.$).Vd(za);if(!this.BNf(za,!0))return!1;za=this.grid;var Na=this.Hid(za);Na=L.r(Na,za.$);za.qb.Zg([this.isRow?13:14]);za.qb.ATa();this.TJb();za.$.Xc(this.isRow?146338636:1391094586,E.a.Db,30,{["autoFitRanges"]:Na});return!1};this.CDf=za=>{this.iY?(this.jY&&!this.xRb&&(this.QHg(),J.EwaSettings.wm()&&this.fe.en("HeaderResizeBehavior::onHeaderResizeChanged")),this.Jjc||this.Lef(),za=new Sys.UI.DomEvent(za),za=v.a.create(y.a.Eha,this.domElement,za,2),za=X.a(this.grid.$).Vd(za),
this.wDd(za.clientPoint)):A.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.mi?this.mi.xnb:-1}, isRow = ${this.isRow}`)};this.DDf=za=>{za=new Sys.UI.DomEvent(za);za=v.a.create(y.a.Eha,this.domElement,za,2);this.dGb(za)};this.fSi=za=>{this.jza(za,this.mi,!1)};this.Q$a=za=>{za=X.a(this.grid.$).Vd(za);G.g(za.Ca);return this.wDd(za.clientPoint)};this.xI=za=>{if(this.grid.Dj)return!1;za=X.a(this.grid.$).Vd(za);let Na;
if(!this.plf||-1!==this.grid.ha.selectionType)return ja.a(this.grid.$).oq()&&(Na=this.$gd(za))&&(Na.Dwa.style.cursor=""),!1;if(this.iY)return this.Lef(),!1;Na=this.$gd(za);if(!Na)return!1;Na.Dwa.style.cursor=!this.grid.eb&&this.pud(Na)?this.isRow?"row-resize":"col-resize":"";G.g(za.Ca);return!0};this.Np=()=>{this.TJb()};this.Dg=()=>{if((3===E.a.Db||w.a.Dp)&&this.grid.ha.ra.Pg){var za=this.grid.ha.ra.dd;if(!(!za.isRow&&!za.hf||!this.domElement||za.isRow&&this.isRow&&!this.fe.Mt.includes(za.top)||za.hf&&
!this.isRow&&!this.fe.Mt.includes(za.left))){var Na=this.grid.fg(za,this.fe.Zi.paneType);if(Na){if(this.grid.Dj){const ua=this.isRow?za.bottom:za.right;this.mi=this.fe.us(T.Range.Qc(za.bottom,za.right));if(!this.mi){A.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${ua}, is row ${this.isRow}`);return}}this.FG||this.ogh();za.isRow&&this.isRow?(D.DOMElementExtensions.setVisible(this.FG,!0),this.FG.style.top=
Na.bottomRight.y-this.FG.offsetHeight/2+"px"):za.isRow||this.isRow||(D.DOMElementExtensions.setVisible(this.FG,!0),Z.c(this.FG.style,this.grid.rtl,Na.bottomRight.x-this.FG.offsetWidth/2+"px"))}}}};this.bG=(za,Na)=>{J.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&A.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Na.uM}`);Na.uM&&this.$qb()};this.fe=qa;this.isRow=qa.isRow;
this.rtl=qa.Zi.rtl;this.grid=jb;this.Auf=this.isRow?e.a.Vyd:e.a.Pmc;this.U$h=U.a.instance.ga(436);this.cai=U.a.instance.ga(435);this.X$h=U.a.instance.ga(437);P.a(this.grid.$,za=>{this.hxd=za.oQ(I.a.rmj,!1)});this.zcj();this.grid.ha.TT(this.Dg);this.grid.ha.V2(this.Np);this.grid.lv(this.Dg);ja.a(this.grid.$).Zf.c$(this.bG)}get JBb(){return this.iY}get plf(){const jb=(new V.a(this.grid.$.xa)).Td(this.isRow?16:8),qa=this.grid.$.rb.uy,za=this.grid.ri,Na=ja.a(this.grid.$).oq();return jb&&!qa&&!za&&!Na}get tmj(){this.Xrh();
return ea.gdb}jza(jb,qa,za){var Na=new Sys.UI.DomEvent(jb);Na=v.a.create(y.a.Eha,this.domElement,Na,2);Na=X.a(this.grid.$).Vd(Na);this.ANf(qa,Na.clientPoint.x,Na.clientPoint.y,!1,za,jb);jb=this.bAc();this.Med(this.HBa,jb,!0);this.IAa||(jb=this.domElement.ownerDocument.body,jb.addEventListener(y.a.Eha,this.CDf),jb.addEventListener(y.a.AHa,this.DDf),this.IAa=!0)}dSi(jb,qa,za){this.ANf(qa,jb.clientX,jb.clientY,!0,this.Dgf?za:!1,jb);jb=this.grid;qa=this.Hid(jb);qa=L.r(qa,jb.$);jb.qb.Zg([this.isRow?13:
14]);jb.qb.ATa();this.TJb();jb.$.Xc(this.isRow?146338636:1391094586,E.a.Db,30,{["autoFitRanges"]:qa})}dispose(){this.G2c();this.grid.ha&&(this.grid.ha.$R(this.Dg),this.grid.ha.t7(this.Np));this.grid.Ky(this.Dg);ja.a(this.grid.$)&&ja.a(this.grid.$).Zf.Lda(this.bG);C.a.instance.Ba(y.a.Dk,this.domElement,this.Pca);r.a.instance.Ba(y.a.Sf,this.domElement.ownerDocument.body,this.dGb);t.a.instance.Ba(y.a.xe,this.domElement.ownerDocument.body,this.dGb);w.a.Dp||(r.a.instance.Ba(y.a.pointerDown,this.domElement,
this.dO),r.a.instance.Ba(y.a.Kj,this.domElement,this.xI));this.IAa&&(r.a.instance.Ba(y.a.Kj,this.domElement.ownerDocument.body,this.Q$a),t.a.instance.Ba(y.a.$f,this.domElement.ownerDocument.body,this.Q$a),this.IAa=!1);this.FG&&(r.a.instance.Ba(y.a.pointerDown,this.FG,this.dO),C.a.instance.Ba(y.a.Dk,this.FG,this.Pca),this.G2c(),this.FG=null);this.HYf&&(D.DOMElementExtensions.uf(ea.gdb),ea.gdb=null);this.fe=null;super.dispose()}zcj(){C.a.instance.sa(y.a.Dk,this.domElement,this.Pca);r.a.instance.sa(y.a.Sf,
this.domElement.ownerDocument.body,this.dGb);t.a.instance.sa(y.a.xe,this.domElement.ownerDocument.body,this.dGb);w.a.Dp||(r.a.instance.sa(y.a.pointerDown,this.domElement,this.dO),r.a.instance.sa(y.a.Kj,this.domElement,this.xI))}Xrh(){if(!ea.gdb){document.getElementById(ea.GYf);this.HYf=!0;var jb=ea.gdb=document.createElement("div");this.grid.$.frame.Yaa().appendChild(jb);jb.id=ea.GYf;jb.className=m.a.gxh;D.DOMElementExtensions.setVisible(jb,!1)}}DPe(){if(this.IAa){const jb=this.domElement.ownerDocument.body;
this.grid.Dj?(jb.removeEventListener(y.a.Eha,this.CDf),jb.removeEventListener(y.a.AHa,this.DDf)):(r.a.instance.Ba(y.a.Kj,jb,this.Q$a),t.a.instance.Ba(y.a.$f,jb,this.Q$a));this.IAa=!1}this.iY=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.IUf():(this.iZf(),this.VLd());S.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}iZf(){this.grid.qb.Zg([this.isRow?13:14]);this.grid.qb.ATa()}QHg(){this.fe.addRowColToModel(this.mi.xnb-1,this.mi.KTf);this.xRb=!0}wDd(jb){if(!this.iY)return!1;
const qa=this.isRow;if(!this.grid.Dj&&!this.h1){this.h1=document.createElement("div");this.h1.style.cssText="position: relative; width: inherit; height: inherit;"+(qa?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var za=this.mi.vK();za.nextSibling;)this.h1.appendChild(za.nextSibling);za.parentNode.appendChild(this.h1)}za=qa?jb.y-this.U8a.y:(this.rtl?-1:1)*(jb.x-this.U8a.x);const Na=qa?jb.y-this.HBa.y:(this.rtl?-1:1)*(jb.x-this.HBa.x),ua=this.grid.Dj?this.Gab:this.mi.I4();if(ua===e.a.axa)return!1;
za&&(0<this.ql||0<ua+Na)&&ua+Na<=this.Auf&&(this.ql=this.bAc(Na),this.Med(jb,this.ql,!1),this.grid.Dj?this.ql>=ea.nbf?(this.SNd=!0,this.mi.setCellExtent(this.ql)):this.SNd&&(this.SNd=!1,this.mi.setCellExtent(ea.nbf)):(D.DOMElementExtensions.gpa(this.mi.vK(),!qa,Math.max(this.GLb+Na,0)),this.h1.style[qa?"top":this.rtl?"right":"left"]=Math.max(Na,-this.GLb)+"px"),za=(this.grid.Dj?this.EKf:qa?this.mi.fe.IC:this.mi.fe.KC)+Math.max(Na,this.grid.Dj?-this.Gab+ea.vec:-this.GLb),D.DOMElementExtensions.gpa(this.mi.fe.domElement,
!qa,za),this.grid.Dj&&this.mi.fe.puj(za),this.U8a=new Sys.UI.Point(jb.x,jb.y),D.DOMElementExtensions.setVisible(this.FG,!1));return!0}I4(){return this.mi?this.jY?ea.jai:this.mi.I4():e.a.axa}Med(jb,qa,za){this.uN&&za&&(A.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.VLd());this.uN||za||A.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");
this.hxd&&this.hxd(()=>({["Location"]:"canvas"}));this.uN?this.D_e(qa):(this.uN=document.createElement("div"),this.uN.id=this.Z$h,this.D_e(qa),this.uN.className=m.a.Mvh,qa=document.getElementById(this.grid.$.Eb+n.a.mwf),qa.insertBefore(this.uN,qa.firstChild),jb=X.a(this.grid.$).eka(jb),this.uN.style.left=(this.rtl?Math.max(jb.x-this.uN.offsetWidth,0):jb.x-Math.max(jb.x+this.uN.offsetWidth-qa.offsetWidth,0)).toString()+"px",qa=document.getElementById(n.a.Csa),this.uN.style.top=(jb.y-(B.AFrameworkApplication.ta&&
B.AFrameworkApplication.ta.Pa.Ve?0:qa.offsetHeight)-this.uN.offsetHeight).toString()+"px")}VLd(){D.DOMElementExtensions.uf(this.uN);this.uN=null}D_e(jb){var qa=new va(this.grid.$.workbookContext.DxDigitNormal);qa=this.isRow?qa.xGe(jb).toFixed(2):qa.nGe(jb).toFixed(2);this.uN.innerText=`${this.isRow?this.U$h:this.cai} ${qa} (${jb.toString()} ${this.X$h})`}BNf(jb,qa){let za;if(-1!==this.grid.ha.selectionType||2===jb.tb&&jb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.pud(za=this.$gd(jb))||!this.plf)return!1;
G.g(jb.Ca);this.HBa=this.U8a=new Sys.UI.Point(jb.clientPoint.x,jb.clientPoint.y);this.yZg(za,qa);if(!this.mi)return!1;this.iY=!0;this.Zqi(this.mi,za)&&this.$di();this.GLb=this.ngd();return this.CNf(jb.Ca.rawEvent,qa)}ANf(jb,qa,za,Na,ua,Xa){this.iY=!0;this.jY=ua;this.mi=jb;this.Jjc=!1;this.HBa=this.U8a=new Sys.UI.Point(qa,za);jb=this.mi.getRange();this.dS=ua?this.Wse(jb):jb;this.Gab=this.I4();this.EKf=this.isRow?this.mi.fe.IC:this.mi.fe.KC;this.CNf(Xa,Na)}CNf(jb,qa){const za=J.EwaSettings.fpd()&&this.grid.Dj?
{["IsResizingHiddenHeader"]:this.jY,["IsAutoFitting"]:qa,["NumberOfSelectedRanges"]:this.grid.ha.ra.ZF,["Location"]:"canvas",["ResizeRange"]:this.dS,["ResizedCellAbsoluteIndex"]:this.mi.xnb,["HeaderViewBlockHashCode"]:this.fe.hashCode}:{["IsResizingHiddenHeader"]:this.jY,["IsAutoFitting"]:qa,["NumberOfSelectedRanges"]:this.grid.ha.ra.ZF,["Location"]:"canvas"};P.b(this.grid.$).ud(I.a.imj,za);this.grid.iEj&&(qa=qa?"header_resize_autofit":"header_resize_start",N.b(this.grid.$).kCa(jb,qa,void 0));this.offset=
this.mi.hba();this.ql=this.grid.Dj?this.Gab:this.mi.I4();if(this.ql===e.a.axa)return!1;S.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Zqi(jb,qa){var za=this.mi.vK();if(!za)return A.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;za=za.nextSibling;if(!za)return!1;jb=jb.getRange();za=this.fe.Hva(za).getRange();if(!jb||!za)return A.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;jb=this.isRow?jb.bottom:jb.right;
za=this.isRow?za.bottom:za.right;return jb+1!==za&&jb!==za&&this.pud(qa,!0)}$di(){var jb=this.mi.vK();const qa=this.fe.Hva(jb.nextSibling);ea.$qi(qa,this.isRow)?(this.mi=qa,this.dS=this.mi.getRange()):(this.RHg(jb),this.mi=qa,jb=this.mi.getRange(),this.dS=this.Wse(jb),this.jY=!0)}Wse(jb){return this.isRow?new T.Range(jb.top-1,jb.left,jb.top-1,jb.right,!1,!0):new T.Range(jb.top,jb.left-1,jb.bottom,jb.left-1,!1,!0)}RHg(jb){const qa=this.fe.Hva(jb.nextSibling),za=ea.qch(qa,this.isRow,this.rtl);za&&jb.parentNode.insertBefore(za,
qa.vK())}Hid(jb){const qa=this.dS,za=jb.ha.ra.selectedRanges;if(jb.ha.ra.cub(qa))if(this.isRow){if(z.a.all(za,Na=>Na.isRow))return za}else if(z.a.all(za,Na=>Na.hf))return za;return[qa]}getCellExtent(){return this.mi.getCellExtent()}ngd(){const jb=this.mi.vK().style;return Math.max(0,Math.min(this.Auf,0|parseInt(this.isRow?jb.height:jb.width,10)))}bAc(jb=0){const qa=this.grid;var za=this.fe.Zi.paneType;let Na;Na=this.isRow?3===za?[3,2]:[1,4]:4===za?[2,4]:[1,3];var ua=Math.max(this.grid.Dj?this.Gab:
this.mi.I4(),0);jb=this.jY&&!this.grid.Dj?Math.max(this.ngd(),0):Math.max(ua+jb,0);za=qa.cXh(za,this.isRow);za=this.isRow?new h.a(0,this.offset,za,jb):new h.a(this.offset,0,jb,za);ua=[this.isRow?13:14];qa.qb.Ti(new T.Range(1,1,e.a.fh,e.a.sh,!1,!0),ua,!1);qa.qb.Sn(ua,za,Na);return jb}G2c(){this.dS=this.HBa=this.U8a=null;if(this.h1){const jb=this.h1.parentNode;if(jb)for(jb.removeChild(this.h1);this.h1.firstChild;)jb.appendChild(this.h1.firstChild);this.h1=null}this.mi=null;this.iY=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.IUf()}IUf(){this.Jjc=!1;this.VLd();D.DOMElementExtensions.setVisible(ea.gdb,!1);D.DOMElementExtensions.setVisible(this.FG,!1);J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.iZf()}$gd(jb){if(D.DOMElementExtensions.Gz(jb.Gb,"a"))return null;const qa=this.Tmf(jb.Ca);if(qa&&this.grid.ha.ra.Pg){var za=this.grid.ha.ra.dd;za=this.fe.us(T.Range.Qc(za.bottom,za.right))}else za=this.fe.Hva(jb.Gb);if(!za)return null;const Na=za.vK(),ua=new Sys.UI.Bounds(Na.offsetLeft,
Na.offsetTop,Na.offsetWidth,Na.offsetHeight);var Xa=D.DOMElementExtensions.getBoundingClientRect(jb.Gb);Xa=new Sys.UI.Point(jb.clientPoint.x-Xa.x,jb.clientPoint.y-Xa.y);this.isRow&&!qa&&(Xa.y+=Q.HelperMethods.sD(jb.Gb,Na,this.rtl).y);return new Y(Na,Xa,ua,za.getRange(),Math.max(ea.iGi,Math.min(ea.cFi,(this.isRow?ua.height:ua.width)*ea.smj)),qa,!this.isRow&&0<Na.getElementsByTagName("input").length)}pud(jb,qa=!1){if(!jb||this.grid.eb)return!1;if(jb.Smf)return!0;var za=jb.vPa;const Na=jb.fdb;var ua=
this.fe.Zi.paneType,Xa=this.grid.Df(ua).ui,ha=!!Xa&&Xa.top===jb.Sld.top,ta=!!Xa&&Xa.left===jb.Sld.left;ua=!!Xa&&Xa.bottom===jb.Sld.bottom&&(3===ua||2===ua);this.isRow?(ta=jb.LEb.y,jb=ta<=Na&&!ha,za=ta>=za.height-Na-(ua?ea.yJh:0),qa=qa?jb:za||jb):(ua=jb.W9h,ha=this.rtl,Xa=jb.LEb.x,jb=Xa<=Na&&(!ta||ha)&&(!ua||!ha),za=Xa>=za.width-Na&&(!ha||!ta)&&(!ua||ha),qa=qa?ha?za:jb:jb||za);return qa}yZg(jb,qa){const za=this.isRow;if(jb.Smf)this.mi=this.fe.Hva(jb.Dwa);else if(za&&jb.LEb.y<=jb.fdb&&jb.vPa.height>
jb.fdb||!za&&jb.vPa.width>jb.fdb&&(!this.rtl&&jb.LEb.x<=jb.fdb||this.rtl&&jb.LEb.x>=jb.vPa.width-jb.fdb)){if(this.mi=jb.Dwa.previousSibling?this.fe.Hva(jb.Dwa.previousSibling):this.qWh(),qa&&jb.Dwa.classList.contains(za?m.a.xVe:m.a.wVe)&&(jb=this.fe.Hva(jb.Dwa)))jb=jb.getRange(),this.dS=za?new T.Range(jb.top-1,jb.left,jb.top-1,jb.right,!1,!0):new T.Range(jb.top,jb.left-1,jb.bottom,jb.left-1,!1,!0)}else this.mi=this.fe.Hva(jb.Dwa);!this.dS&&this.mi&&(this.dS=this.mi.getRange())}qWh(){var jb=this.isRow?
1:0;return(jb=this.fe.Zi.gC(this.fe.Zi.Da.Ng(this.grid.$.oa,d.a.UM(this.fe.position.X+jb-1,this.fe.position.Y-jb,this.fe.position.PaneType))))?jb.pWh():null}Lef(){this.Jjc=!0;const jb=this.tmj;D.DOMElementExtensions.setVisible(jb,!0);jb.style.cursor=this.isRow?m.a.GSe:m.a.iRe;this.bAc()}orh(jb){this.grid.$.Xc(this.isRow?745189930:-445963340,E.a.Db,30,{["resizeRowColumnParameters"]:jb})}ogh(){const jb=document.createElement("div");jb.className=m.a.fyh;const qa=document.createElement("div");qa.className=
f.a.zt;jb.appendChild(qa);const za=document.createElement("img");za.src=H.a.me(0);za.className=this.isRow?f.a.dxh:f.a.Zwh;qa.appendChild(za);this.fe.VA.domElement.parentNode.insertBefore(jb,this.fe.VA.domElement);this.grid.Dj?jb.addEventListener(y.a.z$,this.fSi):(r.a.instance.sa(y.a.pointerDown,jb,this.dO),C.a.instance.sa(y.a.Dk,jb,this.Pca));D.DOMElementExtensions.setVisible(jb,!1);this.FG=jb}TJb(){this.G2c();this.FG&&(this.fe.VA.domElement.parentNode.removeChild(this.FG),this.FG=null)}Tmf(jb){return D.DOMElementExtensions.Af(this.FG,
jb.target)}$qb(){this.iY&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Dj&&this.wDd(this.HBa),this.DPe(),this.grid.Dj||D.DOMElementExtensions.gpa(this.mi.vK(),!this.isRow,this.GLb),this.TJb(),this.xRb=this.jY=!1)}Rif(){return J.EwaSettings.ma(664)}sdf(jb){(jb=jb.Ca.rawEvent)&&jb.detail===ea.Zqj&&(jb.type===y.a.Lp?(this.iY=!1,this.SZc=!0):jb.type===y.a.tI&&(this.iY=!0,this.SZc=!1))}static mch(jb,qa){return new ea(jb,qa)}static vSd(jb,qa,za){if(qa){jb.ColumnWidth=
-1;jb.RowHeight=za;for(const Na of jb.SheetMultiRange.Ranges)Na.FirstColumn=0,Na.LastColumn=0}else{jb.RowHeight=-1;jb.ColumnWidth=za;for(const Na of jb.SheetMultiRange.Ranges)Na.FirstRow=0,Na.LastRow=0}}static $qi(jb,qa){if(!jb||!jb.vK())return A.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const za=jb.getRange();jb=jb.vK().style;if(!za||!jb)return A.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;jb=qa?jb.height:jb.width;return(qa?za.top:za.left)===
(qa?e.a.fh:e.a.sh)&&jb===ea.Omg}static qch(jb,qa,za){if(!jb)return A.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Na=jb.vK();if(!Na||!Na.style)return A.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;jb=document.createElement("div");const ua=Na.style;jb.style.top=qa?ua.top:ea.Omg;qa||(za?jb.style.right=ua.right:jb.style.left=ua.left);jb.classList.add(qa?x.fxh:x.exh);jb.classList.add(qa?m.a.hvb:m.a.gvb);za=document.createElement("div");
za.classList.add(qa?m.a.lVe:m.a.qbd);Na=qa?Number.parseInvariant(Na.innerText):T.Range.h1a(Na.innerText);za.innerText=qa?(Na-1).toString():T.Range.gQ(Na-1);jb.appendChild(za);return jb}}ea.iGi=0;ea.cFi=5;ea.vec=1;ea.nbf=1;ea.jai=0;ea.yJh=3;ea.smj=.1;ea.GYf="ewa-rszrbg";ea.Omg="0px";ea.Zqj=2;ea.gdb=null;Object(u.a)(ea,"HeaderResizeBehavior",M.a,[350]);class Ca extends b.a{constructor(){super();this.Fb()}create(){this.nb(ea.mch)}static la(jb){jb.da.Ga(136,new Ca)}}Object(u.a)(Ca,"HeaderResizeBehaviorFactory",
b.a,[]);var la=a(55),Ra=a(694),lb=a(49),Aa=a(37),da=a(171),aa=a(425),fa=a(374),Oa=a(188),ba=a(282),ka=a(281),Pa=a(64),Fa=a(21);class oa{constructor(jb,qa){this.isRow=!1;this.autoFitRange=null;this.isRow=jb;this.autoFitRange=qa}}Object(u.a)(oa,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[108]);class La{constructor(jb){this.resizeParameters=null;this.resizeParameters=jb}}Object(u.a)(La,"MacroRecorderSheetRowsColumnsResizedPayload",null,[108]);var Ea=a(83);b=a(284);var ca=a(22);class $a extends b.a{constructor(jb,
qa){super(jb);this.nxb=za=>{za=this.nhd(za);return this.Eed(za)};this.jmj=(za,Na)=>{var ua=this.q8a=Na[$a.Jli];1===za?(za=Na[$a.QHj],ua=this.A8e(za,ua),A.ULS.shipAssertTag(537153996,0,ua!==$a.Gba,`ResizeHeadersDialogHandler - invalid size input, size = ${za}`),za=ua!==this.Znd,A.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.q8a,ua,za),za&&this.S$g(ua)):A.ULS.sendTraceTag(537153994,0,50,
`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===qa.command;this.gridView=Fa.h(this.$);this.Rvc=new va(this.$.workbookContext.DxDigitNormal);this.Znd=this.YZg();jb=this.z9g(this.Znd);qa=this.B9g(this.Znd);this.Pl=U.a.instance.ga(this.isRow?477:478);jb=this.oN(jb,qa);this.initializeAndShow(this.Pl,this.jmj,jb);A.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get qc(){return"ResizeHeadersDialog"}get q8a(){return $a.Ice}set q8a(jb){$a.Ice=
jb}oN(jb,qa){return{[$a.yV]:this.qc,[$a.nri]:this.isRow,[$a.yei]:jb,[$a.xei]:qa,[$a.aoi]:this.q8a,[$a.mhd]:this.nxb}}YZg(){const jb=this.GMh();try{return this.iRh(jb)}finally{jb&&jb.dispose()}}S$g(jb){const qa={};qa.SheetMultiRange=L.r(this.gridView.ha.ra.selectedRanges,this.$);$a.vSd(qa,this.isRow,jb);this.$.Xc(this.isRow?745189930:-445963340,E.a.Db,8,{["resizeRowColumnParameters"]:qa})}A8e(jb,qa){return ca.a.D5(jb)?qa?this.y9g(jb):this.A9g(jb):$a.Gba}A9g(jb){return Math.floor(parseFloat(jb))}y9g(jb){jb=
parseFloat(jb);return 0>jb?$a.Gba:jb?this.isRow?Q.HelperMethods.e3i(jb):this.Rvc.p5g(jb):0}B9g(jb){return jb===$a.Gba?"":this.isRow?this.Rvc.xGe(jb).toString():this.Rvc.nGe(jb).toFixed(2)}z9g(jb){return jb===$a.Gba?"":jb.toString()}iRh(jb){if(!jb||!jb.$$mn()||!jb.Zn)return $a.Gba;var qa=Object(Ea.a)(389,jb.Zn);if(!qa)return $a.Gba;for(qa=this.isRow?qa.Nzb:qa.Xnd;jb.$$mn();){const za=Object(Ea.a)(389,jb.Zn);if(za&&(this.isRow?za.Nzb:za.Xnd)!==qa)return $a.Gba}return qa}GMh(){const jb=[];for(const za of this.gridView.ha.ra.selectedRanges){const Na=
za.clone();var qa=this.gridView.Df(this.gridView.ib.Mi(Na));qa=Na.Ie(qa.ui);if(!qa)return null;this.isRow?Na.right=Na.left=qa.left:Na.top=Na.bottom=qa.top;jb.push(Na)}return jb.length?this.gridView.caa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",jb):null}nhd(jb){if(!ca.a.D5(jb))return 1;jb=this.A8e(jb,this.q8a);if(0===jb)if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){const qa=this.gridView.ha.ra.selectedRanges;if(this.gridView.Xd){if(!this.gridView.Xd.nAe(qa,
this.isRow))return 3}else if(this.qlf())return 3}else if(this.qlf())return 3;return this.eui(jb)?0:2}qlf(){const jb=this.gridView.ha.ra.selectedRanges;return this.isRow&&L.P(jb)||!this.isRow&&L.O(jb)}Eed(jb){let qa="";switch(jb){case 0:qa="";break;case 1:qa=U.a.instance.ga(767);break;case 2:qa=String.format(U.a.instance.mb(99),0,this.edc(this.q8a));break;case 3:qa=U.a.instance.ga(768)}return qa}eui(jb){return 0<=jb&&jb<=this.edc(!1)}edc(jb){return this.Rvc.edc(jb,this.isRow)}static vSd(jb,qa,za){if(qa){jb.ColumnWidth=
$a.Gba;jb.RowHeight=za;for(const Na of jb.SheetMultiRange.Ranges)Na.FirstColumn=0,Na.LastColumn=0}else{jb.RowHeight=$a.Gba;jb.ColumnWidth=za;for(const Na of jb.SheetMultiRange.Ranges)Na.FirstRow=0,Na.LastRow=0}}}$a.yV="id";$a.nri="isRow";$a.yei="initialSizeInPx";$a.xei="initialSizeInDefaultUnits";$a.aoi="isInitialUnitsDefaultUnits";$a.mhd="getInputErrorIfInvalid";$a.QHj="size";$a.Jli="isDefaultUnits";$a.Gba=-1;$a.Ice=!0;Object(u.a)($a,"ResizeHeadersDialog",b.a,[]);var Qa=a(60);const Va=(jb,qa,za,
Na,ua,Xa,ha=null)=>{ha=jb.Na(41,ha);ha.resizeRowColumnParameters=qa;return Qa.g(jb,"ResizeRowsColumns",ha,za,Na,ua,Xa,0)};var fb=a(346),Ka=a(290),hb=a(66),fc=a(190),dc=a(29),wb=a(348);class Tb{constructor(jb,qa,za){this.UVi=(Na,ua)=>{if(!ba.a(Na)&&ua){const Xa=!!Na&&!!Na.RequestTelemetryData;Fa.h(this.$).Eh.Yla(ua,Na.StateId,Xa?Na.RequestTelemetryData.EcsOperationDuration:0,Xa?Na.RequestTelemetryData.EcsRequestDuration:0,Xa?Na.RequestTelemetryData.WfeRequestDuration:0)}};this.mNi=(Na,ua)=>{ua&&ua.X1b&&
ua.X1b.SheetName&&ua.X1b.Ranges.length&&ua.Yki&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(this.XXd=ua.X1b.Ranges[0],this.KV()?this.AEe(this.XXd):this.grid.HZa(this.iza))};this.iza=()=>{this.KV()&&(this.grid.Fcb(this.iza),this.AEe(this.XXd))};this.$=jb;this.sg=qa;this.gridInstantaneousAction=za;this.grid=Fa.h(this.$);this.XXd=null}nc(jb,qa){jb=!0;switch(qa){case -445963340:case 1391094586:jb=this.Td(8);break;case 745189930:case 146338636:jb=
this.Td(16)}return!jb}executeCommand(jb,qa,za){var Na=Fa.h(this.$);const ua=qa.command;var Xa=da.a.create().toString();let ha=Aa.TaskExtensions.Uj();switch(ua){case 1391094586:case 146338636:jb=1391094586===ua;(Xa=za.autoFitRanges)&&Xa.Ranges&&Xa.Ranges.length||(Xa=L.r(Na.ha.ra.selectedRanges,this.$));ha=this.snh(jb?1:0,Xa,qa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:jb=-445963340===ua||-706918724===ua||369708605===ua;J.EwaSettings.x7a()&&
-706918724===ua&&Na.Eh.d1(18,Xa);if(-445963340===ua||745189930===ua){var ta=aa.a(qa.command);Na.Eh.d1(16,Xa,ta);Na=za.resizeRowColumnParameters}else{za=Na.ha.ra.selectedRanges;let db=0;for(var wa of za)if(-706918724===ua||369708605===ua){const Jb=wa.right-wa.left+1;db+=0<Jb?Jb:-1*Jb}else if(1542466017===ua||1051390410===ua)db+=wa.bottom-wa.top+1;369708605===ua||1542466017===ua?A.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${db}`):(-706918724===
ua||1051390410===ua)&&A.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${db}`);if(!J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)||!Na.Xd){if(-706918724===ua&&6===qa.af&&L.O(za)){A.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===ua&&6===qa.af&&L.P(za)){A.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}}wa=369708605===ua||1542466017===ua?-2:0;Na={};Na.SheetMultiRange=L.r(za,this.$);if(jb)for(ta of Na.SheetMultiRange.Ranges)ta.FirstRow=0,ta.LastRow=0;else for(const Jb of Na.SheetMultiRange.Ranges)Jb.FirstColumn=0,Jb.LastColumn=0;Na.RowHeight=jb?-1:wa;Na.ColumnWidth=jb?wa:-1}ha=this.Nnh(Na,qa,Xa,jb);break;case 957527587:case 2040891415:new $a(this.$,qa)}return ha}AEe(jb){if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)){const qa=
hb.d(this.$.xa.oa),za=new fb.a(L.B(jb),qa);Aa.TaskExtensions.za(lb.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Na=>{void Na.result.MCc(za,"ColumnAutoFit")},this.$.ka,3)}}wc(jb,qa,za,Na){if(jb=!!za&&!!Na&&1===Na.mz)switch(qa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:jb=!1}return jb}Kc(){return!1}yAi(jb){A.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Ka.c)(jb)}. Reason: ${Object(Ka.c)(jb)?
void 0:jb.reason}.`)}Td(jb){return(new V.a(this.$.xa)).Td(jb)}KV(){return this.grid.Da.HN(4,this.$.oa)}snh(jb,qa,za){const Na=this.$.pa.ya.Wb(),ua=0===jb,Xa=()=>new oa(ua,qa);return fa.a(this.$.userOperationManager,(ha,ta,wa)=>{var db=this.$.pa.ya;ha=ka.b(ha,this.mNi);var Jb={Yki:!ua,X1b:qa};const Pb=db.Na(41,Na);Pb.isRow=ua;Pb.autoFitRanges=qa;return Qa.g(db,"AutoFit",Pb,ha,ta,wa,Jb,0)},ha=>new Oa.a(135,0,ha,void 0,Xa),za,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",
!1))}Nnh(jb,qa,za,Na){const ua=qa.command,Xa=Fa.h(this.$),ha=L.g(jb.SheetMultiRange.Ranges);if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){var ta=-706918724===ua||-445963340===ua&&0===jb.ColumnWidth;if((1051390410===ua||745189930===ua&&0===jb.RowHeight||ta)&&null!=Xa.Xd&&!Xa.Xd.nAe(ha,!Na))return this.Cmh(Na),Aa.TaskExtensions.Uj()}let wa;ta=J.EwaSettings.x7a()&&-706918724===ua;if(745189930===ua||-445963340===ua||ta)A.ULS.shipAssertTag(537154002,0,this.$.activeItemName===
jb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),ta?Object(fc.c)(()=>{Xa.Eh.kEi()},this.$.ka,0):(wa=this.sg.eGj(Xa,ha,Na?jb.ColumnWidth:jb.RowHeight,!Na),this.yAi(wa),Object(Ka.c)(wa)&&Xa.Eh.xS(za,Pa.BasicTelemetryCalculator.cR));const db=this.$.pa.ya.Wb({wca:!0,Cba:3});Na=(Pb,eb,Ma)=>{this.$.My();L.i(ha,",",this.$,!1);return Va(this.$.pa.ya,jb,ka.b(Pb,this.UVi),eb,Ma,za,db)};const Jb=()=>new La(jb);return wa&&Object(Ka.c)(wa)?fa.a(this.$.userOperationManager,
Na,Pb=>new Oa.a(136,0,Pb,64,Jb),qa):fa.a(this.$.userOperationManager,Na,Pb=>new Oa.a(136,0,Pb,void 0,Jb),qa)}Cmh(jb){jb=dc.a.$c(1,0,jb?769:771,jb?770:772,0,jb?-2037763134:503471870,jb?"HideAllColumnsError":"HideAllRowsError");new wb.a(this.$,jb)}}Object(u.a)(Tb,"ResizeCommandHandler",null,[208]);class xb extends Ra.a{constructor(jb){super(jb)}ld(){const jb=lb.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya);let qa;qa=J.EwaSettings.x7a?lb.GetServiceTaskFactory.Oa(this.$.da,528,529,this.Ya):
la.Task.Ta(null);Aa.TaskExtensions.za(jb,()=>{this.Zc([new Tb(this.$,jb.result,qa.result)])},this.ka,3)}static la(jb){Ra.a.Nd(113,new xb(jb))}}Object(u.a)(xb,"ResizeCommandHandlerFactory",Ra.a,[]);a.d(F,"a",function(){return cb});const cb=()=>{c.a.Fa(jb=>{Ca.la(jb);xb.la(jb)})}},1178:function(u,F,a){u=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.pc(1,CommonUIStrings.l_DialogClose)}displayError(T){this.gA(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,
null)}T8c(T){this.gA(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(b,"ErrorDialog",c.StandardDialog,[277]);var e=a(15),f=a(157);class d{e0e(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const T=new f.a;T.setResult("api.onedrive.com");return T.task}}Object(u.a)(d,"OneDriveConsumerEndpointHelper",null,[191]);var h=a(84),n=a(54),m=a(377),x=a(228);class r{constructor(T,H,D,G){this.iFa=this.K6=null;this.SSc=this.USc=!1;this.VXa=
null;this.ob=T;this.tSb=H;this.PEa=D;this.dt=G}get iue(){return this.tSb}get fa(){return this.ob}g5a(){this.VXa||(this.VXa=this.zab?x.a.create(this.zab,null,null,null,!1):null);return this.VXa}setup(T){this.iFa=T;this.USc||this.SSc?this.USc&&this.iFa&&this.iFa(!0):(T=this.g5a())?(this.SSc=!0,T.q9a.continueWith(H=>{this.MUi(H)}),m.a.Uia(T)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.iFa(!1))}MDd(T){e.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",T.exception?T.exception.toString():"No error detail.")}MUi(T){this.SSc=!1;if(T.Pf)this.MDd(T),this.iFa(!1);else try{this.USc=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.dod(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.iFa(!0)}catch(H){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",H.toString()),this.iFa(!1)}}startPicker(T){this.K6=T;this.PEa?e.ULS.sendTraceTag(23881878,
216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.lCd,"onApiReady")))}lCd(T){T?this.ulc():this.vj()}vj(){this.dt().displayError(n.a.WZi)}onSuccess(T){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.K6&&this.K6(!0,T)}dispose(){this.VXa&&this.VXa.dispose()}}Object(u.a)(r,"AOneDriveFilePickerApiManager",null,[173,2]);class y extends r{constructor(T,
H,D,G,J,M){super(H,D,G,M);this.Nh=null;this.v2=T;this.KCg=J}get zab(){return this.fa.Xa("OneDriveApiUrl")}start(T,H){this.Nh=T;this.startPicker(H)}dod(){WL.init(1===this.iue||2===this.iue?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(T){this.K6=T;!this.PEa&&this.v2.ZMa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(h.a)(this,this.lCd,"onApiReady"))):
(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.KCg())}ulc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Nh).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.J6,"onFailure"))}catch(T){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",T,T.stack),this.vj()}}J6(T){if(T&&T.error){if("user_canceled"===T.error.code){e.ULS.sendTraceTag(17909058,352,50,"User canceled.");
return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",T.error.code,T.error.message)}else e.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.K6&&this.K6(!1,T);this.vj()}}Object(u.a)(y,"OneDriveFilePickerApiManagerV5",r,[]);class t extends r{constructor(T,H,D,G,J){super(T,H,D,G);this.OUb=this.xge=null;this.Nug=J;this.options={};this.options.clientId=this.fa.Xa("OneDriveApiV7ClientId");this.options.cancel=Object(h.a)(this,
this.sCc,"toggleHostDivVisibility")}get zab(){return this.fa.Xa("OneDriveApiV72Url")}start(T,H){this.OUb=H;const D=this.Nug.e0e();D.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.xge=D.result;this.startPicker((G,J)=>{this.sCc();T(G,J)})},3);D.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,D.exception.message);this.sCc()},5)}dod(){this.options.success=T=>{const H={};H.data=T;this.onSuccess(H)};this.options.error=
T=>{const H={};H.error=T;this.J6(H)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.xge;this.options.advanced.iframeParentDiv=this.OUb}ulc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.sCc(),OneDrive.open(this.options)}catch(T){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",T.message),this.vj()}}J6(T){this.K6&&this.K6(!1,T);this.vj()}sCc(){this.OUb.style.visibility=
"hidden"===this.OUb.style.visibility?"":"hidden"}}Object(u.a)(t,"OneDriveFilePickerApiManagerV7",r,[]);class v extends r{constructor(T,H,D,G){super(T,H,D,G);this.Grg=T;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Xa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get zab(){return this.fa.Xa("OneDriveApiV72Url")}start(T,H,D,G){this.options.advanced.iframeParentDiv=D;this.options.advanced.endpointHint=G;this.options.cancel=H;this.Grg.qa("OneDriveApiV72RecentsViewEnabled")&&
(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(T)}startPicker(T){this.K6=T;this.PEa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.lCd,"onApiReady")))}dod(){this.options.success=
T=>{const H={};H.data=T;this.onSuccess(H)};this.options.error=T=>{const H={};H.error=T;this.J6(H)}}ulc(){try{e.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(T){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",T.message,T.stack),this.vj()}}MDd(T){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",T.exception?T.exception.toString():"No error detail.");m.a.Bfj(this.zab);
this.VXa=null}vj(){this.dt().T8c(n.a.ipj)}J6(T){this.K6&&this.K6(!1,T)}}Object(u.a)(v,"OneDriveFilePickerApiManagerV72",r,[]);class w{constructor(T){this.olsSessionId=this.value=this.key=null;this.olsSessionId=T}}Object(u.a)(w,"IExtraData",null,[]);var C=a(4);class B extends v{constructor(T,H,D,G){super(T,H,D,G);this.options.advanced.filter=T.Xa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=C.AFrameworkApplication.que;T.qa("OneDriveApiV72CommandModeEnabled")&&
(this.options.commandMode=T.Xa("OneDriveApiV72CommandMode")||"none");T.qa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new w(C.AFrameworkApplication.userSessionId))}get zab(){return this.fa.Xa("OneDriveApiV72Url")}ulc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",C.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(T){e.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",T.message,T.stack),this.vj()}}}Object(u.a)(B,"OneDriveFilePickerApiOpenManagerV72",v,[]);var z=a(240);class A{constructor(T){this.xk=null;this.Ah=T;this.VRc=3}e0e(){this.xk=new f.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.IQd();return this.xk.task}IQd(T=null){const H=
String.format("GetMoreInfoHandler.ashx?{0}",C.AFrameworkApplication.QIa);this.Ah.bha(H,1,null,T,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.zXh,"getMoreInfoSucceeded"),Object(h.a)(this,this.xXh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}xXh(T){if(T.data.httpStatus===z.a.nIb&&"X-NewKey"in T.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const H={};H["X-Key"]=T.data.responseHeaders["X-NewKey"];
this.IQd(H)}else 0<this.VRc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.VRc),this.VRc--,this.IQd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.xk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}zXh(T){"PersonalFileStorageUrl"in T.data.responseHeaders&&""!==T.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,
352,50,"Successfully received an ODB endpoint"),this.xk.setResult(T.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.xk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(u.a)(A,"OneDriveForBusinessEndpointHelper",null,[191]);var E=a(248),I=a(560);class L{constructor(){this.gb=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Xh(T){this.gb=
T;this.gb.register(y,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").xc().Fc(()=>new y(I.a.instance,C.AFrameworkApplication.fa,C.AFrameworkApplication.e3a,C.AFrameworkApplication.limitedEdit,C.AFrameworkApplication.x9f,()=>new b));C.AFrameworkApplication.fmf?this.gb.register(191,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").xc().Fc(()=>new d):this.gb.register(191,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").xc().Fc(()=>
new A(C.AFrameworkApplication.zd));this.gb.register(t,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").xc().Fc(()=>new t(C.AFrameworkApplication.fa,C.AFrameworkApplication.e3a,C.AFrameworkApplication.limitedEdit,()=>new b,this.gb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.gb.register(v,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").xc().Fc(()=>new v(C.AFrameworkApplication.fa,C.AFrameworkApplication.e3a,C.AFrameworkApplication.limitedEdit,
()=>new b));this.gb.register(B,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").xc().Fc(()=>new B(C.AFrameworkApplication.fa,C.AFrameworkApplication.e3a,C.AFrameworkApplication.limitedEdit,()=>new b))}static main(){E.a.instance.Ei(new L)}}Object(u.a)(L,"PackageManager",null,[3,4]);a.d(F,"a",function(){return V});const V=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");L.main()}},1185:function(u,F,a){u=a(0);var c=a(84),b=a(15),e=a(134),f=a(54),d=a(25);class h extends e.StandardDialog{constructor(U,
Z){super();this.WXa=!1;this.EA=null;this.La=U;this.njb=Z;this.BTa=!1}displayError(U,Z,P){this.EA=Z;this.WXa=P;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",U,P);U=this.d2c(U);0===U?(this.Rb=6,this.pc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.pc(1,CommonUIStrings.l_DialogClose));0===U&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.gA(f.a.hpj,this.dgd(U),this.XRh(U,Z),Object(c.a)(this,this.POd,"retryDialogHandler"),!0)}POd(U){1===
U?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.EA?this.La.Zd(d.a.BLb,2,[this.EA,this.WXa]):this.La.processAction(d.a.BLb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}d2c(U){return 0>U||6<U?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",U),0):U}XRh(U,Z){U=this.d2c(U);return this.njb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,Z),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][U]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Z),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][U]}dgd(U){U=this.d2c(U);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][U]}}Object(u.a)(h,"ErrorRetryDialog",e.StandardDialog,[439]);class n{constructor(U,Z){this.ob=U;this.La=Z;this.njb=this.ob.qa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.La,this.njb)}}Object(u.a)(n,"ErrorRetryDialogFactory",null,[423]);e=a(1051);var m=a(146);class x{static get qg(){return m.a.iq(x.ol,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}x.ol="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(u.a)(x,"FileNameDialogHtml",null,[]);var r=a(4),y=a(30);class t extends e.a{constructor(U,Z,P,S,ja,X){super(U,Z,P,S,ja,X);this.qg=x.qg;this.Fe="FileNameDialog-SaveAsToHost"}uQ(U,Z){const P=y.a.Pq(r.AFrameworkApplication.sm.sn);Z={["txtFileName"]:U||P,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Z};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.gac,"fileNameDialogHandler"),Z);this.sMe(U,P)}}Object(u.a)(t,"FileNameDialog",e.a,[438]);class v{constructor(U,
Z,P,S,ja,X){this.La=Z;this.ob=U;this.TX=S;this.Oga=X;this.dt=ja;this.ef=P}create(){return new t(this.ob,this.La,this.ef,this.TX,this.dt,this.Oga)}}Object(u.a)(v,"FileNameDialogFactory",null,[422]);var w=a(642),C=a(106);class B{constructor(U,Z,P){this.Oga=P;this.yKc=Z;this.ob=U}Ig(){2===r.AFrameworkApplication.ta.Pa.Hj?r.AFrameworkApplication.ub.Ne(d.a.BLb,C.a.frame,Object(c.a)(this,this.M_f,"saveAsToHostActionDispatcher"),4):r.AFrameworkApplication.ub.Nb(d.a.BLb,C.a.frame,Object(c.a)(this,this.M_f,
"saveAsToHostActionDispatcher"))}M_f(U,Z,P,S,ja){return Z.contextId!==C.a.frame||U!==d.a.BLb?2:this.ob.qa("SaveAsToHostBrsIsEnabled")?1===P?w.SessionStatusManager.instance.W5a||r.AFrameworkApplication.x5?8:32:2===P?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),U=this.yKc.create(),ja&&Object.getType(ja)===Array&&2===ja.length?U.uQ(ja[0],!!ja[1]):U.uQ(null,!1),32):8:8}}Object(u.a)(B,"SaveAsToHostActor",null,[]);var z=a(41),A=a(80),E=a(39),I=a(240),L=a(376),
V=a(164),T=a(643),H=a(768);class D{constructor(U,Z,P,S,ja,X,Y,va){this.Nm=null;this.WXa=this.iEa=!1;this.Nga=this.Nh=this.EA=null;this.ob=Z;this.hGa=this.ob.appSettings.SaveAsToHostWebServiceBase;this.ube=S;this.Wlb=ja;this.Ah=P;this.dt=X;this.Ch=va;this.ef=Y;this.La=U;this.Pfa=Z.Xa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}$Nb(){1!==this.ef.state&&(this.Nm=this.Wlb(),this.Nm.message=CommonUIStrings.l_CommentProgressTooltip,this.Nm.Rb=5,this.Nm.Lt=!1,this.Nm.BBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}uS(U=0){1!==this.ef.state&&this.dt.create().displayError(U,y.a.Pq(this.EA),this.WXa)}dRa(){const U=this.ob.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");E.a.lf(U,E.a.IX(3),void 0,"UploadToHostManager.RedirectToFolder")}cRa(U){let Z=!1,P=!1;this.ob&&(Z=this.ob.qa("SaveACopyIsEnabledForUiHost"),P=this.ob.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
U,Z,P);if(Z&&P){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const S={};S[L.a.YQa]="1";S[L.a.documentUrl]=U;S[L.a.reason]=T.a.saveAs;r.AFrameworkApplication.pV().execute(ja=>{ja.Rj(V.a.tua,S)})}else Z&&!P&&r.AFrameworkApplication.Qba?E.a.lf(U,E.a.IX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):E.a.lf(U,E.a.IX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}zoa(U,Z,P=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.ube&&!this.ube()&&this.Ah&&(this.Ch&&(this.Nga=this.Ch.Bc("DialogShown","SaveAsToHostUploadTime")),this.$Nb(),this.WXa=Z,this.EA=U,(this.Nh=P)&&"true"===this.Nh.SkipSaveToHost?this.F$b():this.BQ())}BQ(){32!==this.La.processAction(d.a.jSa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.F$b()):this.La.Zd(d.a.jSa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.F$b()},(U,
Z)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.uS(Z)}])}hZi(U){this.vJa();this.iEa=!1;if(U&&U.data&&U.data.ve)if(({Ft:Z}=z.d(U.data.ve)).returnValue)if(U=Z,U.StatusCode!==I.a.nP&&U.StatusCode!==I.a.Xsb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Z={};Z.FailureReason=U.StatusCode.toString();Z.ExtraInfo=U.ExtraInfo;this.Pda(Z);this.uS(parseInt(U.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.CNd();try{U.NewDocumentUrl&&""!==U.NewDocumentUrl?this.cRa(U.NewDocumentUrl):this.dRa()}catch(P){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",P.toString())}this.VHb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:H.a.hgb(U.data.ve)}),this.Pda({["FailureReason"]:"Failed to deserialize response"}),this.uS();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Pda({["FailureReason"]:"null response"}),this.uS()}gZi(U){5!==U.data.status&&12!==U.data.status||this.iEa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:U.data.status,["HttpStatus"]:U.data.httpStatus}),this.Pda({["FailureReason"]:U.data.httpStatus.toString()}),this.vJa(),this.uS(),this.VHb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.iEa=!0,this.Nh&&"true"===this.Nh.SkipSaveToHost?this.F$b():
this.BQ())}vJa(){this.Nm&&(this.Nm.close(),this.Nm=null)}VHb(){this.Nga&&(this.Nga.stop(),this.Nga=null)}CNd(){this.Nh&&"VersionHistory"===this.Nh.SaveEntryPoint&&this.La.processAction(d.a.Gvc,2)}Pda(U){this.Nh&&"VersionHistory"===this.Nh.SaveEntryPoint&&this.La.Zd(d.a.ENd,2,U)}F$b(){let U=this.hGa+this.Pfa;U=A.a.Bl(U,"qs",y.a.mf(r.AFrameworkApplication.Hi));U=A.a.Bl(U,"n",y.a.mf((new Date).getTime().toString()));U=A.a.Bl(U,"ov",y.a.mf(this.WXa.toString()));U=A.a.Bl(U,"fn",y.a.mf(this.EA));this.Nh&&
this.Nh.FileDownloadUrl&&(U=A.a.Bl(U,"furl",y.a.mf(this.Nh.FileDownloadUrl)));this.Ah.Pm(U,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.hZi,"onUploadFinished"),Object(c.a)(this,this.gZi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(u.a)(D,"UploadToHostManager",null,[315]);var G=a(248),J=a(785);class M{constructor(){this.gb=null}get name(){return"Common.App.SaveAsToHost"}init(){r.AFrameworkApplication.fa.Ev(Object(c.a)(this,this.JB,"onFullAppSettingsReady"))}JB(){r.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.gb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ig()}Xh(U){this.gb=U;this.gb.register(n,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Fc(()=>new n(r.AFrameworkApplication.fa,r.AFrameworkApplication.ub)).xc();this.gb.register(D,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Fc(()=>new D(r.AFrameworkApplication.ub,r.AFrameworkApplication.fa,r.AFrameworkApplication.zd,()=>r.AFrameworkApplication.Og,
()=>(new J.a).create(),U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),r.AFrameworkApplication.ta,r.AFrameworkApplication.ta.lE)).xc();this.gb.register(v,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Fc(()=>new v(r.AFrameworkApplication.fa,r.AFrameworkApplication.ub,r.AFrameworkApplication.ta,r.AFrameworkApplication.ta.Pa,U.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).xc();
this.gb.register(B,"Common.App.SaveAsToHost.SaveAsToHostActor").Fc(()=>new B(r.AFrameworkApplication.fa,U.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),U.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).xc()}dispose(){}static main(){G.a.instance.Ei(new M)}}Object(u.a)(M,"SaveAsToHostPackage",null,[3,4]);a.d(F,"a",function(){return Q});const Q=()=>{Type.registerNamespace("Common.App.SaveAsToHost");M.main()}},1186:function(u,F,a){u=a(0);var c=a(84),b=a(15),e=a(146);class f{static get qg(){return e.a.iq(f.ol,
CommonUIStrings.l_SaveACopyFileName)}}f.ol="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(u.a)(f,"FileNameDialogHtml",null,[]);var d=a(4),h=a(30);class n extends e.a{constructor(H,D,G,J){super();this.BUb=
this.c9=null;this.La=H;this.TX=D;this.qnb=G;this.pc(1,CommonUIStrings.l_SaveButtonLabel);this.qg=f.qg;this.Fe="FileNameDialog-SaveACopy";this.Nh=J}uQ(H,D,G){this.BUb=H;this.c9=G;H={["txtFileName"]:h.a.Pq(d.AFrameworkApplication.sm.sn),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,D)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.gac,"fileNameDialogHandler"),H);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}gac(H,D){1!==H?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(H=D.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),D=h.a.H4(d.AFrameworkApplication.fileName),H&&""!==H&&""!==D&&(H+=D),this.qnb.zoa(this.BUb,this.c9,H,this.Nh))}}Object(u.a)(n,"FileNameDialog",e.a,[445]);class m{constructor(H,D,G){this.La=H;this.TX=D;this.qnb=G}create(H){return new n(this.La,
this.TX,this.qnb,H)}}Object(u.a)(m,"FileNameDialogFactory",null,[429]);var x=a(134),r=a(25);class y extends x.StandardDialog{constructor(H){super();this.Rb=1;this.pc(1,CommonUIStrings.l_RetryButtonLabel);this.pc(0,CommonUIStrings.l_DialogClose);this.La=H}displayError(H){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",H);this.gA(H,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.POd,"retryDialogHandler"))}POd(H){1===H?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(r.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(u.a)(y,"RetryDialog",x.StandardDialog,[428]);x=a(1052);var t=a(836),v=a(377),w=a(106);class C extends x.a{constructor(H,D,G,J){super(H,D,G,J);this.Rzg=D}y8a(){return this.ob.qa("SaveACopyBrsIsEnabled")}K_e(){return r.a.saveACopy}d3b(){v.a.UKd(Object(c.a)(this,this.d0f,"saveToCloudActionDispatcher"));v.a.v$c([new t.a(r.a.saveACopy,w.a.frame,0)],
this.Rzg.g5a())}mSf(){d.AFrameworkApplication.nya("CreateCopy_cf;CreateCopy_tf");b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(u.a)(C,"SaveACopyActor",x.a,[]);x=a(1055);class B extends x.a{constructor(H,D,G,J,M,Q,U){super(D,G,J,M,Q,U);this.ovg=H}onSuccess(H){H&&H.data&&H.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.ovg.create(this.Nh).uQ(H.data.folders[0].id,H.data.folders[0].name,H.data.folders[0].urls.viewInBrowser)):
(b.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.vj())}J6(H){H&&H.error&&"user_canceled"===H.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.J6(H)}vj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.vj()}}Object(u.a)(B,"SaveACopyManager",x.a,[]);var z=a(1053);class A extends z.a{constructor(H,D,G,J,M,Q){super(D,G,J,M,Q);this.La=H}Usd(){return!!this.Nh&&!!this.Nh.SaveEntryPoint&&
"VersionHistory"===this.Nh.SaveEntryPoint.toString()}uS(){b.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Usd()&&this.La.Zd(r.a.ENd,2,{["FailureReason"]:"Unknown"});super.uS()}dRa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Usd()&&this.La.processAction(r.a.Gvc,2);super.dRa()}cRa(H){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",H);this.Usd()&&this.La.processAction(r.a.Gvc,2);super.cRa(H)}BQ(){this.Nh&&
"true"===this.Nh.SkipSaveToHost?super.BQ():32!==this.La.processAction(r.a.jSa,1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.BQ()):this.La.Zd(r.a.jSa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");z.a.prototype.BQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.uS()}])}}Object(u.a)(A,"SaveACopyUploadToCloudManager",
z.a,[]);var E=a(248),I=a(560),L=a(785);class V{constructor(){this.gb=null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.Ev(Object(c.a)(this,this.JB,"onFullAppSettingsReady"))}JB(){d.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.gb.resolve("Common.App.SaveACopy.SaveACopyActor").Ig()}dispose(){}Xh(H){this.gb=H;this.gb.register(A,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Fc(()=>new A(d.AFrameworkApplication.ub,H.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new L.a).create(),()=>new y(d.AFrameworkApplication.ub),d.AFrameworkApplication.ta,d.AFrameworkApplication.ta.lE)).xc();this.gb.register(m,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Fc(()=>new m(d.AFrameworkApplication.ub,d.AFrameworkApplication.ta.Pa,H.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).xc();this.gb.register(C,"Common.App.SaveACopy.SaveACopyActor").Fc(()=>new C(H.resolve("Common.App.SaveACopy.SaveACopyManager"),
H.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.ta.lE)).xc();this.gb.register(B,"Common.App.SaveACopy.SaveACopyManager").Fc(()=>new B(H.resolve("Common.App.SaveACopy.FileNameDialogFactory"),H.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),I.a.instance,H.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.e3a,()=>new y(d.AFrameworkApplication.ub))).xc()}static main(){E.a.instance.Ei(new V)}}
Object(u.a)(V,"PackageManager",null,[3,4]);a.d(F,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.SaveACopy");V.main()}},1187:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(30),d=a(83),h=a(242),n=a(36);class m extends h.a{constructor(G,J,M){super(G,J);this.gGd=this.executionContext=null;this.F1i=(Q,U)=>{this.NHb(Q,U)};this.kK=M}initialize(G){super.initialize(G)}execute(G){this.executionContext=G;G=Object(d.a)(7,this.executionContext.Ge);this.Osb(G);return 1}fJ(G){super.fJ(G)}Osb(){this.subscribe(this.executionContext,
this.F1i,G=>{this.gGd.add_disposing(G)})}NHb(G){this.unsubscribe(J=>{G.remove_disposing(J)});this.executionContext.activityState[n.a.K2]=0}}Object(u.a)(m,"PasswordProtectedFileActivity",h.a,[]);var x=a(284),r=a(261),y=a(13);class t extends x.a{constructor(G){super(G);this.hqa=0;this.W$i=(J,M)=>{this.Zbb(J,M)};this.t2d=(J,M)=>{this.lVa(J,M)}}get qc(){return"PasswordDialog"}get Ltb(){return this.hqa}get Pl(){return y.a.instance.ga(1976)}Zbb(G){this.hqa=G}N3(){const G={};G[x.a.description]=y.a.instance.ga(1977);
G[x.a.c7]=y.a.instance.ga(1973);G[x.a.BLf]=y.a.instance.ga(1995);G[x.a.zLf]=y.a.instance.ga(1996);G[x.a.ALf]=y.a.instance.ga(1974);G[x.a.Fnd]=y.a.instance.ga(1980);G[x.a.Qwe]=y.a.instance.ga(1661);G[x.a.D1j]=y.a.instance.Ua(25);G[x.a.llg]=this.t2d;return G}Jta(){const G={};G[r.a.vu]=this.qc;G[x.a.Z_a]=this.N3();return G}hg(){this.Rb=1;this.initializeAndShow(this.Pl,this.W$i,this.Jta())}}Object(u.a)(t,"PasswordProtectedFilePasswordInputDialog",x.a,[]);var v=a(60),w=a(29),C=a(282),B=a(51);class z extends t{constructor(G){super(G);
this.KOd=5;this.qce=!1;this.passwordToModify=null;this.CLf=()=>{this.$.isEditMode&&this.ejc&&(B.b().t$c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.Kl(this.CLf))};this.hg();this.$.ll(this.CLf)}get ejc(){return this.qce}get Pl(){return y.a.instance.ga(1978)}Zbb(G,J){super.Zbb(G,J);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${G}`)}lVa(G,J){this.passwordToModify=G;const M={};M.FileModifyPassword=
f.a.mf(G);v.M(this.$.pa.ya,M,this.mZi(J),this.lZi(J),null,null)}N3(){const G=super.N3();G[x.a.Fnd]=y.a.instance.ga(1981);G[x.a.description]=y.a.instance.Ua(24);return G}hg(){B.b().t$c("PasswordToModifyDialogShown");e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.hg()}mZi(G){return J=>{w.a.eh(J.Errors,[-2019873242])&&this.s8b(this.Esb());if(!J||C.a(J))if(0<this.KOd)this.QQf(G);else{e.ULS.sendTraceTag(537154754,
0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${w.a.sc(J.Errors)}`);this.$.ea.Po(J.Errors);this.hide();return}this.qce=J.Result;this.ejc&&(B.b().cXd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
G(this.ejc?0:1)}}lZi(G){return()=>{0<this.KOd?this.QQf(G):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),G(3))}}QQf(G){--this.KOd;this.lVa(this.passwordToModify,G)}Esb(){return w.a.$c(1,0,1660,1661,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(u.a)(z,"PasswordProtectedFileModifyPasswordInputDialog",t,[]);var A=a(6);class E extends m{constructor(G,J,M){super(G,J,M)}Osb(G){this.gGd=
new z(G);super.Osb(G)}NHb(G,J){const M=G.Ltb,Q=G.ejc,U=G.passwordToModify;super.NHb(G,J);this.executionContext.Eya([2001366804]);switch(M){case 1:Q?(J=Object(d.a)(7,this.executionContext.Ge),this.executionContext.activityState[n.a.Noe]=f.a.mf(U),this.executionContext.activityState[n.a.qZa]=!0,G.passwordToModify="",this.ih(J.isEditMode?A.a.Jj:this.cK)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Jp();break;case 0:this.executionContext.activityState[n.a.$r]=!1;this.ih(this.kK);this.Jp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${M}'`)}}}Object(u.a)(E,"PasswordProtectedFileModifyActivity",m,[]);class I extends b.a{constructor(G,J,M,Q){super();this.activityName=G;this.cK=J;this.kK=M;this.$=Q;this.Fb()}create(){this.nb(new E(this.activityName,this.cK,this.kK))}static la(G){G.da.Ga(434,new I(A.a.MHb,
A.a.agb,A.a.Grb,G))}}Object(u.a)(I,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var L=a(44);class V extends t{constructor(G,J){super(G);this.password=null;this.snf=J;this.hg()}lVa(G,J){this.password=G;J(0)}N3(){const G=super.N3();this.snf&&(G[x.a.psh]=1);return G}hg(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.snf}`);super.hg();L.a(this.$).Zse()}}Object(u.a)(V,"PasswordProtectedFileOpenPasswordInputDialog",
t,[]);class T extends m{constructor(G,J,M){super(G,J,M)}Osb(G){const J=w.a.eh(this.executionContext.errors,[1217361942]);this.gGd=new V(G,J);G.ehc||G.ZLe();super.Osb(G)}NHb(G,J){let M,Q;M=G.password;G.password="";Q=G.Ltb;super.NHb(G,J);this.executionContext.activityState[n.a.gWc]=f.a.mf(M);this.executionContext.activityState[n.a.qZa]=!0;this.executionContext.Eya([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${Q}`);
switch(Q){case 1:this.ih(this.cK);this.Jp();break;case 0:this.ih(this.kK),this.Jp()}}}Object(u.a)(T,"PasswordProtectedFileOpenActivity",m,[]);class H extends b.a{constructor(G,J,M,Q){super();this.activityName=G;this.cK=J;this.kK=M;this.$=Q;this.Fb()}create(){this.nb(new T(this.activityName,this.cK,this.kK))}static la(G){G.da.Ga(386,new H(A.a.Crc,A.a.Jj,A.a.Yj,G))}}Object(u.a)(H,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(F,"a",function(){return D});const D=()=>{c.a.Fa(H.la);c.a.Fa(I.la)}},
1194:function(u,F,a){u=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.pc(1,CommonUIStrings.l_DialogClose)}displayError(T){this.gA(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(u.a)(b,"ErrorDialog",c.StandardDialog,[428]);var e=a(1055),f=a(1052),d=a(15),h=a(84),n=a(4),m=a(252),x=a(39),r=a(25);class y extends c.StandardDialog{constructor(T,H,D){super();this.La=T;this.v2=H;this.TX=D;this.$v=!1;this.Rb=1;this.T0(1);
this.pc(1,CommonUIStrings.l_SignIn);this.pc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}uQ(){this.v2.CZa(Object(h.a)(this,this.tIf,"onSignIn"));this.Zl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.Qgi,"inputHandler"))}Qgi(T){0===T?(d.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.b7()}$1g(){let T="2";if(this.TX)switch(this.TX.Hj){case 3:T="0";break;case 2:T="3";break;case 1:T="1"}return T}hide(){this.v2.bKb(Object(h.a)(this,
this.tIf,"onSignIn"));super.hide()}b7(){var T=n.AFrameworkApplication.fa.qa("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";T=new m.QueryStringBuilder(T);T.qj("prompt","1");T.qj("cbcxt",this.$1g());n.AFrameworkApplication.tZa(T);x.a.lf(T.toString(),"LoginWindow",void 0,"SignInDialog")}tIf(){this.Gn&&this.hide();d.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(r.a.saveToCloudStorage,2)}}Object(u.a)(y,
"SignInDialog",c.StandardDialog,[441]);class t{constructor(T,H,D){this.La=T;this.v2=H;this.TX=D}create(){return new y(this.La,this.v2,this.TX)}}Object(u.a)(t,"SignInDialogFactory",null,[425]);var v=a(80),w=a(30);class C{constructor(T,H,D,G,J,M,Q){this.hGa=T;this.EA=H;this.MWa=D;this.BUb=G;this.rRc=J;this.Pfa=M;this.Nh=Q}execute(T,H){if(!n.AFrameworkApplication.Og&&n.AFrameworkApplication.zd){var D=this.hGa+this.Pfa;D=v.a.Bl(D,"fo",w.a.mf(this.BUb));D=v.a.Bl(D,"fn",w.a.mf(this.EA));D=v.a.Bl(D,"qs",
w.a.mf(this.rRc));D=v.a.Bl(D,"n",w.a.mf((new Date).getTime().toString()));this.Nh&&this.Nh.FileDownloadUrl&&(D=v.a.Bl(D,"furl",w.a.mf(this.Nh.FileDownloadUrl)));this.MWa&&(D=v.a.Bl(D,"fnn",w.a.mf(this.MWa)));n.AFrameworkApplication.zd.Pm(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,T,H,null)}}}Object(u.a)(C,"SkyDriveUploadCaller",null,[440]);class B{constructor(T){this.ob=T;this.iGa=T.appSettings.SkyDriveUploadWebServiceBase;this.EA=T.appSettings.FileName;this.Pfa=T.Xa("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}create(T,H,D){return new C(this.iGa,this.EA,H,T,n.AFrameworkApplication.Hi,this.Pfa,D)}}Object(u.a)(B,"SkydriveUploadCallerFactory",null,[424]);var z=a(1053),A=a(248),E=a(560),I=a(785);class L{constructor(){this.gb=null}get name(){return"Common.App.SaveToCloudStorage"}init(){n.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.gb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ig()}dispose(){}Xh(T){this.gb=T;this.gb.register(t,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Fc(()=>
new t(n.AFrameworkApplication.ub,E.a.instance,n.AFrameworkApplication.ta.Pa)).xc();this.gb.register(B,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Fc(()=>new B(n.AFrameworkApplication.fa)).xc();this.gb.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fc(()=>new f.a(T.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),T.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
n.AFrameworkApplication.fa,n.AFrameworkApplication.ta.lE)).xc();this.gb.register(z.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Fc(()=>new z.a(T.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new I.a).create(),()=>new b,n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.lE)).xc();this.gb.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Fc(()=>new e.a(T.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),E.a.instance,T.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
n.AFrameworkApplication.fa,n.AFrameworkApplication.e3a,()=>new b)).xc()}static main(){A.a.instance.Ei(new L)}}Object(u.a)(L,"PackageManager",null,[3,4]);a.d(F,"a",function(){return V});const V=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");L.main()}},1195:function(u,F,a){u=a(0);var c=a(84),b=a(15),e=a(4),f=a(54),d=a(421),h=a(82);class n{constructor(z,A,E,I){this.gPc=null;this.KTb=I;this.mY=z;this.nY=A;this.rE=E;this.Fke=this.$tf.SCj;z=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.$yg=z[0];this.Zyg=z[1]}get $tf(){return this.gPc||(this.gPc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Hwa(){return CommonUIStrings.l_OICErrorHelpLink}get tzc(){return this.Fke}get buf(){return this.$yg}get auf(){return this.Zyg}get Ztf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Fke?3:2}get Pub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get n5b(){return!!this.nY}get Qub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Pl(){return CommonUIStrings.l_DefaultDialogTitle}LJd(z){this.JFb(z)}Uvd(z){this.JFb(z)}JFb(z){let A=
10;this.nY&&1===z&&(this.nY(this.rE),A=1);this.mY&&this.mY(this.rE);this.mG(A)}wPa(){d.Redirect.showHelp("OICFailure");this.mG(2)}aCd(){this.$tf.zpf();this.mG(4)}mG(z){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.KTb,z);e.AFrameworkApplication.yvc(f.a.nKf,this.KTb,z)}dispose(){this.rE=this.mY=this.nY=null}}Object(u.a)(n,"AOICErrorDialog",null,[2]);var m=a(45),x=a(134);class r extends n{constructor(z,A,E,I){super(z,A,E,I);this.ara=this.nm=null;z=
document.createElement("span");z.id="errorMessageText";z.innerText=this.errorMessage;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.nm=document.createElement("a");this.nm.href="#";this.nm.innerText=this.Hwa;z.appendChild(this.nm);m.a.addHandler(this.nm,"click",Object(c.a)(this,this.wPa,"oicErrorHelpLinkHandler"));A=new x.StandardDialog;A.Fe=this.id;this.tzc?(E=document.createElement("span"),I=document.createElement("span"),E.innerText=this.buf,I.innerText=
this.auf,this.ara=document.createElement("a"),this.ara.href="#",this.ara.innerText=this.Ztf,z.appendChild(document.createElement("br")),z.appendChild(E),z.appendChild(this.ara),z.appendChild(I),m.a.addHandler(this.ara,"click",Object(c.a)(this,this.aCd,"oicErrorMacOfferLinkHandler"))):this.n5b&&(z.appendChild(document.createElement("br")),z.appendChild(document.createElement("br")),E=document.createElement("span"),E.innerText=this.Pub,z.appendChild(E));this.n5b?(A.Rb=1,A.pc(1,this.Qub)):A.Rb=0;A.Zl(this.Pl,
null,this.icon,Object(c.a)(this,this.Uvd,"legacyOICErrorDialogHandler"),z);A.mX("errorMessageText")}dispose(){this.nm&&(m.a.removeHandler(this.nm,"click",Object(c.a)(this,this.wPa,"oicErrorHelpLinkHandler")),this.nm=null);this.ara&&(m.a.removeHandler(this.ara,"click",Object(c.a)(this,this.aCd,"oicErrorMacOfferLinkHandler")),this.ara=null);super.dispose()}}Object(u.a)(r,"OICErrorDialog",n,[]);class y{constructor(z,A,E){this.mY=A;this.nY=z;this.rE=E}get id(){return"OICErrorDialogWithDownload"}get xQe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Hwa(){return CommonUIStrings.l_OICErrorHelpLink}get Pub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Qub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Pl(){return CommonUIStrings.l_DefaultDialogTitle}LJd(z){this.JFb(z)}Uvd(z){this.JFb(z)}JFb(z){let A=
10;1===z&&(this.nY(this.rE),A=1);this.mY&&this.mY(this.rE);this.mG(A)}wPa(){d.Redirect.showHelp("OICFailure");this.mG(2)}mG(z){e.AFrameworkApplication.yvc(f.a.oKf,3,z)}dispose(){this.rE=this.nY=this.mY=null}}Object(u.a)(y,"AOICErrorDialogWithDownload",null,[2]);class t extends y{constructor(z,A,E){super(z,A,E);this.nm=null;z=document.createElement("span");z.id="errorMessageText";z.innerText=this.xQe;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.nm=document.createElement("a");
this.nm.href="#";this.nm.innerText=this.Hwa;z.appendChild(this.nm);m.a.addHandler(this.nm,"click",Object(c.a)(this,this.wPa,"oicErrorHelpLinkHandler"));z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));A=document.createElement("span");A.innerText=this.Pub;z.appendChild(A);A=new x.StandardDialog;A.Fe=this.id;A.Rb=1;A.pc(1,this.Qub);A.Zl(this.Pl,null,this.icon,Object(c.a)(this,this.Uvd,"legacyOICErrorDialogHandler"),z);A.mX("errorMessageText")}dispose(){this.nm&&
(m.a.removeHandler(this.nm,"click",Object(c.a)(this,this.wPa,"oicErrorHelpLinkHandler")),this.nm=null);super.dispose()}}Object(u.a)(t,"OICErrorDialogWithDownload",y,[]);var v=a(146);class w extends n{constructor(z,A,E,I){super(z,A,E,I);A={["errorMessage"]:this.errorMessage};A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Hwa,["onExecute"]:L=>{this.wPa(L)}};this.tzc?(A.macOfficePreLinkText=this.buf,A.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Ztf,
["onExecute"]:L=>{this.aCd(L)}},A.macOfficePostText=this.auf):this.n5b&&(A.errorFileDownloadOffer=this.Pub);z=new v.a(!1,!1,!0);this.n5b?(z.Rb=1,z.pc(1,this.Qub)):z.Rb=0;z.Fe=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};z.initializeAndShow(this.Pl,Object(c.a)(this,this.LJd,"reactOICErrorDialogHandler"),A)}}Object(u.a)(w,"ReactOICErrorDialog",n,[]);class C extends y{constructor(z,A,E){super(z,A,E);A={["errorMessage"]:this.xQe,["errorFileDownloadOffer"]:this.Pub};A.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Hwa,["onExecute"]:I=>{this.wPa(I)}};z=new v.a(!1,!1,!0);z.Rb=1;z.pc(1,this.Qub);z.Fe=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};z.initializeAndShow(this.Pl,Object(c.a)(this,this.LJd,"reactOICErrorDialogHandler"),A)}}Object(u.a)(C,"ReactOICErrorDialogWithDownload",y,[]);a.d(F,"a",function(){return B});class B{constructor(){this.okb=!!e.AFrameworkApplication.ta&&e.AFrameworkApplication.ta.Pa.Iv}Gdh(z,A,E){this.okb?
new w(z,A,null,E):new r(z,A,null,E)}Hdh(z,A,E){this.okb?new C(z,A,E):new t(z,A,E)}Idh(z,A,E,I,L){const {ReactOICErrorDialogWithTrial:V}=a(1338),{OICErrorDialogWithTrial:T}=a(1339);this.okb?new V(z,A,E,null,I,L):new T(z,A,E,null,I,L)}static get instance(){return B.Ma||(B.Ma=new B)}}B.Ma=null;Object(u.a)(B,"OICErrorDialogFactory",null,[543])},1213:function(u,F,a){var c=a(9);u=a(0);var b=a(694),e=a(21),f=a(40),d=a(1),h=a(15),n=a(30),m;(function(I){I[I.url=0]="url";I[I.ref=1]="ref";I[I.mailto=2]="mailto"})(m||
(m={}));Object(u.b)("HyperlinkSelectionState",m);var x=a(772),r=a(8),y=a(585),t=a(60),v=a(88),w=a(13);class C extends x.a{constructor(I,L,V){super(I);this.Onb=0;this.IAb=!1;this.B2a=null;this.lMe=!1;this.rsb=!0;this.Pl=this.QVc=null;this.NAd=0;this.LAd=this.OAd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.Hbi=(T,H)=>{1===T||2===T?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===T?"OK":"Remove"} pressed`),this.OAd=H[C.Pxi],this.NAd=H[C.Crj],this.LAd=H[C.Omh],2===T&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.l1j=(T,H)=>0!==H&&T.length?1===H?this.x2e(f.y(T,this.ea.xa)||this.DHi(T),760):this.x2e(n.a.zqd(T),762):null;this.selectedRange=L;this.vM=V;this.ea=I.ea;this.sheetName=L.SheetName;this.IMa();this.uq();this.Rb=this.IAb?9:1;this.pc(1,w.a.instance.ga(4));this.IAb&&(h.ULS.sendTraceTag(509690183,0,50,"Edit HyperLink was called."),this.pc(2,w.a.instance.ga(763)));this.initializeAndShow(this.Pl,this.Hbi,{[C.vu]:this.qc,
[C.m1j]:this.l1j,[C.iVg]:{[C.Xlh]:this.lMe,[C.Pmh]:this.B2a,[C.hGg]:this.Onb,[C.iGg]:this.QVc,[C.$9g]:this.rsb}})}get qc(){return"HyperLinkDialog"}n4e(I,L){switch(L){case 2:return I.startsWith("mailto:")?I:"mailto:"+I;case 1:return`${r.a.hNf}${this.HWh(I)}`;default:return I}}get eC(){return 526}mH(){const I=this.$;this.location=this.n4e(this.OAd,this.NAd);try{this.location=v.a.If(this.location)}catch(T){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,
50,`Committing ${m[this.NAd]} link`);this.cellValue=this.LAd.length?this.LAd:this.OAd;I.My();const L=I.pa.ya.Wb(),V=f.s(this.selectedRange);return(T,H,D)=>t.b(I.pa.ya,V,this.cellValue,this.location,this.removeHyperLink,!1,123,T,H,D,this.vM.range,L)}ik(){const I=f.s(this.selectedRange);return()=>new y.a(I,this.cellValue,this.location)}HDh(){let I=this.vM.cell.o6a;this.vM.cell.zwa?I&&I.startsWith("mailto:")?(this.Onb=2,I=I.substr(7)):this.Onb=0:this.Onb=1;return I}IMa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
this.IAb=this.vM.mba:this.IAb=!!this.vM.oLa(64)||!!this.vM.oLa(128)}uq(){if(this.IAb){this.B2a=this.vM.text;const I=this.HDh();I&&(this.QVc=I);this.Pl=w.a.instance.ga(827);this.rsb=this.QVc===this.B2a}else this.vM.text?(this.B2a=this.vM.text,this.rsb=!1):(this.B2a="",this.rsb=!0),this.Onb=0,this.Pl=w.a.instance.ga(826);this.vM.rB&&(this.rsb=!1,this.lMe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.B2a=this.vM.formulaBarText))}DHi(I){return this.ea.Cb.Qk(I)}x2e(I,
L){return I?null:w.a.instance.ga(L)}HWh(I){let L,V;({sheetName:L,range:V}=f.Z(I,this.ea.xa)).returnValue&&V&&(I=f.x(V,L||this.sheetName,!1));return I}}C.m1j="validateLinkValues";C.iVg="bodyProps";C.Xlh="disableDisplayText";C.Pmh="displayTextValue";C.hGg="activeLinkOption";C.iGg="activeLinkValue";C.$9g="copyLinkValueToDisplay";C.Pxi="linkValue";C.Crj="selectedLink";C.Omh="displayText";Object(u.a)(C,"HyperlinkDialog",x.a,[]);var B=a(55);class z{constructor(I,L){this.$=I;this.gridView=L}nc(){return!1}wc(I,
L){return 1===I&&-1583422759===L.command}Kc(){return!1}executeCommand(){this.YFj();return B.Task.Ta(!0)}YFj(){const I=f.v(this.gridView.ha.ra.dd,this.$),L=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.$p([this.gridView.ha.ra.dd],!0))&&L&&new C(this.$,I,L)}}Object(u.a)(z,"ShowHyperlinkCommandHandler",null,[208]);class A extends b.a{constructor(I){super(I)}ld(){this.Zc([new z(this.$,e.h(this.$))])}static la(I){b.a.Nd(105,
new A(I))}}Object(u.a)(A,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return E});const E=()=>{c.a.Fa(A.la)}},1214:function(u,F,a){var c=a(9);u=a(0);var b=a(4),e=a(106),f=a(694),d=a(60),h=a(49),n=a(37),m=a(15),x=a(184),r=a(25),y=a(55);class t{constructor(A,E){this.$=A;this.Vh=E}nc(){return!1}executeCommand(A,E,I){A=2;switch(E.command){case -309686558:A=this.Vh.Zd(r.a.saveACopy,2,I);break;case 617689800:A=this.Vh.Zd(r.a.saveToCloudStorage,2,I);break;case -1244760097:A=this.Vh.Zd(r.a.saveToSharePoint,
2,I)}return 2===A&&E?x.a(E.command):y.Task.Ta(!0)}wc(A,E){A=!1;switch(E.command){case -1244760097:case -309686558:case 617689800:A=!0,m.ULS.shipAssertTag(537153984,0,this.$.cla,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return A}Kc(){return!1}}Object(u.a)(t,"SaveToHostCommandHandler",null,[208]);class v extends f.a{constructor(A){super(A);this.tIh=(E,I,L,V,T)=>1===L?32:E===r.a.jSa&&2===L?(E=this.$.pa.ya.Wb(),d.C(this.$.pa.ya,T[0],T[1],null,null,E),32):8}ld(){n.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.Ya),()=>{this.Zc([new t(this.$,b.AFrameworkApplication.ub)])},this.ka,3);b.AFrameworkApplication.ub.Nb(r.a.jSa,e.a.frame,this.tIh)}static la(A){f.a.Nd(267,new v(A))}}Object(u.a)(v,"SaveToHostCommandHandlerFactory",f.a,[]);var w=a(222);class C{constructor(A,E){this.$=A;this.Vh=E;this.$.da.Ga(393,this)}nc(A){switch(A){case -309686558:return 8===this.Vh.processAction(r.a.saveACopy,1,null);case 617689800:return 8===this.Vh.Zd(r.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.Vh.Zd(r.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(u.a)(C,"SaveToHostManager",null,[215,2]);class B extends w.a{constructor(A){super();this.$=A;this.Fb()}create(){this.nb(this.$.da.Aa(393)||new C(this.$,b.AFrameworkApplication.ub))}static la(A){A.da.Ga(394,new B(A))}}Object(u.a)(B,"SaveToHostManagerFactory",w.a,[]);a.d(F,"a",function(){return z});const z=()=>{c.a.Fa(v.la);c.a.Fa(B.la)}},1215:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(83),d=a(114),h=a(29),
n=a(36);class m extends d.a{constructor(H,D){super(H,D)}execute(H){const D=Object(f.a)(7,H.Ge);e.ULS.shipAssertTag(537153921,0,h.a.rpb(H.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");D.BI(!0,!0);H.activityState[n.a.n_b]=D.ea.sessionId;H.activityState[n.a.Snb]=!0;H.activityState[n.a.t_b]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(u.a)(m,"SessionReloadActivity",d.a,
[]);var x=a(6);class r extends b.a{constructor(){super();this.Fb()}create(){this.nb(new m(x.a.Mdb,x.a.pz))}static la(H){H.da.Ga(142,new r)}}Object(u.a)(r,"SessionReloadActivityFactory",b.a,[]);var y=a(58),t=a(265),v=a(109),w=a(47),C=a(46),B=a(35),z=a(1),A=a(42),E=a(246),I=a(115);class L extends d.a{constructor(H,D,G,J,M){super(H,D);L.oyd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];L.nyd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
L.Utf=[-1468309555,611268539,-1750576502,61029505];L.Ttf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.hAc=G;this.KHj=J;this.SQj=M}execute(H){var D=Object(f.a)(7,H.Ge);H.activityState[n.a.esa]=!0;var G=L.U1h(H);if(L.HBj(H,G))return L.mEi(H),G=50,0<H.errors.length&&(G=15),e.ULS.sendTraceTag(537153891,0,G,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.sc(H.errors)}`),H.activityState[n.a.esa]=!1,this.ih(x.a.idle),
3;switch(G){case 1:case 3:this.Kgi(H,G);break;case 2:this.Jgi(H);break;case 0:H.activityState[n.a.rZa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${G}. activityName:${this.activityName}. NextActivityName:${this.e0}. TimeFromLastStatefulResponse:${D.ea.m1}.`);var J=B.a.zg(H.activityState,I.a.egb);e.ULS.shipAssertTag(40502925,0,!J||J&&(1===G||3===G),`triggerSilentReloadAfterTokenRefresh: ${J}, silentReloadType: ${G}`);D=D.gl.reloadCount;return 0!==G&&
0<D?(J=t.a.hwa(D,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${G}] retryNum [${D}] delayInMs [${J}] activityName [${this.activityName}]`),w.a.instance.create(()=>{L.QM(H)},J,C.a.Ltj),1):3}Kgi(H,D){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const G=Object(f.a)(7,H.Ge);H.activityState[n.a.Snb]=!0;G.ehc||A.PageLoadTrackingInfo.instance.xj("ReopenOnLoad");!L.isEditMode(H)&&h.a.rpb(H.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),H.activityState[n.a.n_b]=G.ea.sessionId,H.activityState[n.a.t_b]=!0);H.Hyd();3===D?(G.ea.Of()||G.ea.KJi(),G.BI(!0,!0),this.ih(this.SQj),H.activityState[n.a.Doe]=G.workbookContext.CalcMode):(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===D&&G.BI(!0,!0),H.activityState[n.a.ZVc]=!1,this.ih(this.hAc))}Jgi(H){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");H.activityState[n.a.rZa]=null;H.Hyd();this.ih(this.KHj);H=Object(f.a)(7,H.Ge);H.ehc||(A.PageLoadTrackingInfo.instance.xj("RefreshOnLoad"),H.FKb())}static QM(H){H.QM()}static U1h(H){const D=Object(f.a)(7,H.Ge),G=D.ea,J=L.isEditMode(H);var M=h.a.eh(H.errors,J?L.nyd:L.oyd);const Q=h.a.eh(H.errors,J?L.Ttf:L.Utf),U=D.AN,Z=D.gl.reloadCount,P=D.va.MaxConsecutiveSilentReloadAllowed,S=D.gl.Oaf(),ja=h.a.sc(H.errors),X=h.a.sc(H.Xza),
Y=0<h.a.eN(Ca=>!Ca.triggerSilentReopenOnly,H.errors).length;let va=M;const N=B.a.zg(H.activityState,I.a.egb);N&&(va=!0);const ea={name:"SessionReloadSilentActivity.GetSilentReloadType"};ea.editMode=J;ea.isSilentReopenError=M;ea.isSilentRefreshError=Q;ea.reloadSequenceCount=D.gl.lRa;ea.reloadCount=Z;ea.maxReloads=P;ea.stopSilentReloads=S;ea.errorNames=ja;ea.processedErrorNames=X;ea.isClientDirty=U;ea.errorsForSilentReopenOnly=Y;ea.triggerSilentReloadAfterTokenRefresh=N;ea.IsReopenDisabled=D.HNa;M=
y.a.hc(ea);e.ULS.sendTraceTag(21837004,0,50,M);if(!S){if(va&&(J?L.yBj(H):L.ABj(H)))return E.a.V6f(H,D)?3:D.HNa?2:1;if(Q&&(J||!G.bcb))return 2}return 0}static HBj(H,D){for(const G of H.errors)if(-1337545025===G.MessageId||-238814601===G.MessageId)return!1;return h.a.eN(G=>!G.triggerSilentReopenOnly,H.errors).length?3!==D:!1}static mEi(H){const D=h.a.eN(G=>!G.triggerSilentReopenOnly,H.errors);for(const G of D)H.yca(G)}static isEditMode(H){const D=Object(f.a)(7,H.Ge);return D.ea.Zb?D.Qt&&!!(D.qd&64):
B.a.zg(H.activityState,n.a.$r)}static ABj(H){const D=Object(f.a)(7,H.Ge),G=h.a.t4(H.errors,L.oyd);if(v.b(G,J=>J.ForceVersionUpgrade))return!1;H=h.a.rpb(H.errors);return!D.ea.bcb||H?!0:!1}static yBj(H){H=h.a.t4(H.errors,L.nyd);return!v.b(H,D=>D.ForceVersionUpgrade)}}L.oyd=null;L.nyd=null;L.Utf=null;L.Ttf=null;Object(u.a)(L,"SessionReloadSilentActivity",d.a,[]);class V extends b.a{constructor(H,D){super();this.activityName=H;this.cK=D;this.Fb()}create(){this.nb(new L(this.activityName,this.cK,x.a.pz,
x.a.hj,x.a.OPb))}static la(H){H.da.Ga(143,new V(x.a.Xna,x.a.a2b));H.da.Ga(144,new V(x.a.Nxc,x.a.cQa));H.da.Ga(145,new V(x.a.Oxc,x.a.jFd));H.da.Ga(154,new V(x.a.Ndb,x.a.iP))}}Object(u.a)(V,"SessionReloadSilentActivityFactory",b.a,[]);a.d(F,"a",function(){return T});const T=()=>{c.a.Fa(H=>{r.la(H);V.la(H)})}},1226:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(83),d=a(242),h=a(321),n=a(29),m=a(13),x=a(383),r=a(88);class y extends x.a{constructor(z,A){super(z,A);this.hqa=0;this.Sr()}get qc(){return"SharedWorkbookDialog"}get Ltb(){return this.hqa}QO(z,
A){this.hqa=z;super.QO(z,A)}Sr(){super.Sr();this.Rb=9;const z=this.zWh();this.pc(1,m.a.instance.ga(1659));this.pc(2,m.a.instance.ga(991));this.Zl(m.a.instance.ga(702),r.a.If(z),this.icon,this.X7)}zWh(){return String.format(m.a.instance.ga(703))}}Object(u.a)(y,"LegacySharedWorkbookDialog",x.a,[]);var t=a(6),v=a(36);class w extends d.a{constructor(z,A,E){super(z,A);this.executionContext=null;this.xxi=I=>{const L=this.$s.hd,V=Object(f.a)(7,L.Ge);let T;T=I.Ltb;this.unsubscribe(H=>{I.remove_disposing(H)});
for(let H=0,D=L.errors.length;H<D;H++)-573864504===L.errors[H].MessageId&&L.yca(L.errors[H]);switch(T){case 1:V.ea.ZCc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.ih(V.isEditMode?t.a.OPb:this.$ih);this.Jp();break;case 2:this.ih(t.a.openInExcelClient);this.Jp();break;case 0:L.activityState[v.a.$r]=!1,this.ih(this.kK),this.Jp()}};this.$ih=A;this.kK=E}initialize(z){super.initialize(z)}execute(z){this.executionContext=
z;this.I5c();return 1}fJ(z){super.fJ(z)}I5c(){const z=Object(f.a)(7,this.executionContext.Ge),A=n.a.j0a([-573864504]);A[0].HelpDescription=m.a.instance.ga(705);A[0].HelpTopicId=h.a.yxi;const E=new y(z,A[0]);this.subscribe(this.executionContext,this.xxi,I=>{E.add_disposing(I)})}}Object(u.a)(w,"LegacySharedWorkbookActivity",d.a,[]);class C extends b.a{constructor(z,A,E,I){super();this.activityName=z;this.cK=A;this.kK=E;this.$=I;this.Fb()}create(){this.nb(new w(this.activityName,this.cK,this.kK))}static la(z){z.da.Ga(460,
new C(t.a.uDb,t.a.agb,z.oCb?t.a.Yj:t.a.Grb,z))}}Object(u.a)(C,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(F,"a",function(){return B});const B=()=>{c.a.Fa(C.la)}},1249:function(u,F,a){var c=a(9);u=a(0);var b=a(222);class e{constructor(){}dispose(){}}Object(u.a)(e,"GridInstantaneousAction",null,[346]);var f=a(697);class d extends b.a{constructor(n){super();this.$=n;this.Fb()}create(){this.nb(Object(f.a)(this.$.da,528,()=>new e))}static la(n){n.da.Ga(529,new d(n))}}Object(u.a)(d,"GridInstantaneousActionFactory",
b.a,[]);a.d(F,"a",function(){return h});const h=()=>{c.a.Fa(n=>{d.la(n)})}},1250:function(u,F,a){u=a(0);var c=a(1289),b=a(1290),e=a(4);class f{constructor(){this.P8d=this.gb=null}get name(){return"Common.App.DirectPrint"}Xh(n){this.gb=n;n.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").xc().Fc(()=>new c.a(e.AFrameworkApplication.ta.yX));n.register(344,"Common.App.DirectPrint.IDirectPrintManager").xc().Fc(()=>b.a.create(this.gb))}init(){this.P8d=this.gb.resolve("Common.App.DirectPrint.IDirectPrintManager");
this.P8d.start()}dispose(){}}Object(u.a)(f,"PackageManager",null,[3,4]);var d=a(248);a.d(F,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.Ei(new f)}},1263:function(u,F,a){u=a(0);var c=a(15),b=a(4),e=a(89),f=a(128),d=a(260),h=a(27),n=a(38),m=a(78),x;(function(S){S[S.unableToRefreshLock=0]="unableToRefreshLock";S[S.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";S[S.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";S[S.workbookTooLarge=
3]="workbookTooLarge";S[S.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";S[S.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";S[S.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";S[S.unsupportedFeatures=7]="unsupportedFeatures";S[S.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";S[S.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";S[S.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";
S[S.lastGenericStatusError=11]="lastGenericStatusError";S[S.scratchPadWarning=12]="scratchPadWarning";S[S.authenticationLost=13]="authenticationLost";S[S.odfCompatibilityIssues=14]="odfCompatibilityIssues";S[S.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";S[S.workbookIsIrmProtected=16]="workbookIsIrmProtected";S[S.biFeatureNotAvailable=17]="biFeatureNotAvailable";S[S.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";S[S.unsupportedInteractiveReportEditing=
19]="unsupportedInteractiveReportEditing";S[S.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";S[S.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";S[S.editAttemptInReadOnly=22]="editAttemptInReadOnly";S[S.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";S[S.unsupportedBrowser=24]="unsupportedBrowser";S[S.readOnlyPermissions=25]="readOnlyPermissions";S[S.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";S[S.policyWarningMessage=
27]="policyWarningMessage";S[S.workingOnIt=28]="workingOnIt";S[S.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";S[S.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";S[S.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";S[S.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";S[S.legacyConnectionsBB=33]="legacyConnectionsBB";S[S.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";S[S.groupedSlicersBB=
35]="groupedSlicersBB";S[S.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";S[S.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";S[S.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";S[S.wacGdprNotice=39]="wacGdprNotice";S[S.automaticSensitivityLabel=40]="automaticSensitivityLabel";S[S.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";S[S.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";S[S.localStorageDisabled=43]="localStorageDisabled";
S[S.autoRefreshDisabled=44]="autoRefreshDisabled";S[S.corruptedFileRepaired=45]="corruptedFileRepaired";S[S.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";S[S.minorVersionLimitReached=47]="minorVersionLimitReached";S[S.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";S[S.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";S[S.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";S[S.sensitivityApplicationLabelDisabledError=
51]="sensitivityApplicationLabelDisabledError";S[S.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";S[S.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";S[S.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";S[S.promptEnableExternalLinks=55]="promptEnableExternalLinks";S[S.networkDown=56]="networkDown";S[S.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";S[S.refreshLinkedEntityErrorBar=
58]="refreshLinkedEntityErrorBar";S[S.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";S[S.canvasHealth=60]="canvasHealth";S[S.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";S[S.optimizeWorkbook=62]="optimizeWorkbook";S[S.novModePostDepreciation=63]="novModePostDepreciation";S[S.officeScriptsRunning=64]="officeScriptsRunning";S[S.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";S[S.readOnlyPivotTable=
66]="readOnlyPivotTable";S[S.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";S[S.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";S[S.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";S[S.count=70]="count"})(x||(x={}));Object(u.b)("EwaBusinessBarEntryType",x);var r=a(5),y=a(1058);class t extends Sys.EventArgs{constructor(S,ja,X=null){super();this.n0a=S;this.U8c=ja;this.data=X}}Object(u.a)(t,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,
[]);var v=a(1060),w=a(1059),C=a(1062),B=a(1061),z=a(1056),A=a(477),E=a(49),I=a(37),L=a(645),V=a(29),T=a(1),H=a(22),D=a(21),G=a(57),J=a(70),M=a(837),Q=a(33),U=a(41);a.d(F,"a",function(){return P});const Z=[55,39,5,30,16,14,7,41,4];class P extends m.a{constructor(S,ja){super();this.Ra=new n.a;this.ZP=null;this.YJc=[];this.Foc=()=>{this.$.pa.ZMa?this.removeEntry(13):this.ng(13,null)};this.gh=(X,Y)=>{for(let va=0,N=P.gec().length;va<N;va++)X=P.gec()[va],this.removeEntry(X);Y.context&&0<Y.context.communicationErrorRetryCount&&
(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.Sjj()};this.zm=(X,Y)=>{var va;X=this.qFh(Y.errors);let N=[];for(let Ca=0,la=X.length;Ca<la;++Ca){const Ra=X[Ca];if(1===Ra.Type&&Ra.Appearance&32)N=this.e9h(Ra,N);else if(Y.vtj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var ea=(null===(va=Y.context)||void 0===va?0:va.stopwatch)?Y.context.stopwatch.Ac:-1;5E3>ea?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${ea}ms).`):b.AFrameworkApplication.ysi()||this.$Jg(Ra,Y.context.methodName)}ea=[...P.gec()];for(let lb=0,Aa=N.length;lb<Aa;++lb){const da=N[lb];this.ng(da,Ra);Array.remove(ea,da)}for(let lb=0,Aa=ea.length;lb<Aa;++lb)this.removeEntry(ea[lb])}};
this.Tc=(X,Y)=>{this.yc(X,Y)};this.yc=()=>{const X=this.$.ea;X.Zb||X.Of()||(this.uLd(),this.YJc.length=0)};this.ed=(X,Y)=>{this.$.ea.Of()&&!Y.RV||this.Ydf(Y.RV)};this.gHb=()=>{const X=this.$.userOperationManager.Tdc();X&&X.operation.flags&1&&this.Q8f()};this.uDf=()=>{this.Q8f()};this.Bf=()=>{this.$Be();this.Z8f()};this.cO=()=>{if(this.$.K5&&this.$.ea.Of()&&this.$.ea.Zb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),
this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const X=this.$.da.Aa(331);X&&X.jKa||this.removeEntry(55);this.removeEntry(5)}};this.$=S;this.f_a=ja;this.rSg();b.AFrameworkApplication.zd&&b.AFrameworkApplication.zd.DWc(this);this.oGa=Array(70);for(let X=0;70>X;X++)this.oGa[X]=null;this.Ph=L.EcmaDateClock.instance;this.qof=this.Ph.zb.getTime();ja&&(ja=S.pa,ja.iw(this.zm),ja.Kq(this.gh),ja.rob(this.Foc),ja.CZa(this.Foc),S.ea.Wj(this.Tc),S.ea.nu(this.Bf),S.ll(this.ed),
S.Xj(this.yc),S.ea.IY(this.cO),S.userOperationManager.ur(this.gHb),T.EwaSettings.ma(166)&&S.ea.Yg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.G$e(),this.Ydf(G.c(S)));S.da.Ga(5,this);Q.a.$jc()&&(this.$.gOb=this.Nji())}G$e(){V.a.Lq(this.$.ea.dG)&&this.zm(this,new A.a(this.$.ea.dG,null,!1,-1,-1,-1,-1,"",-1,"",-1))}DKg(S){this.Ra.addHandler("bBarAttachedOrDetached",S)}get Z9c(){return this.YJc}get domElement(){return this.ZP?this.ZP.domElement:null}dispose(){if(this.$){const S=this.$,
ja=S.pa;ja.gx(this.zm);ja.Mr(this.gh);ja.Euc(this.Foc);ja.bKb(this.Foc);S.ea.tk(this.Tc);S.ea.Nv(this.Bf);S.Kl(this.ed);S.Jl(this.yc);S.ea.B0(this.cO);S.userOperationManager.ko(this.gHb);D.h(S).Vb.Gk(this.uDf)}e.a.Ia(this.ZP);this.$=this.ZP=null;super.dispose()}Nji(){for(let S=0;S<Z.length;S++)if(this.oGa[Z[S]])return!0;return!1}nki(S){switch(S){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;case 59:return T.EwaSettings.ma(642);default:return!1}}ng(S,ja,X=null,Y=null,va=null){if(!this.$.isMobileMode||
this.nki(S))this.f_a&&!this.cF(S)&&(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,0,50,`Adding entry to BB: ${Enum.toString(x,S)}`),this.oGa[S]=this.Ph.$ea,this.ZP.DC(S,ja,Y,va),Q.a.$jc()&&this.wWj(S),this.Ra.raiseEvent("bBarAttachedOrDetached",new t(S,!0,X))),ja&&32===ja.Appearance&&J.a(this.$).hd.yca(ja)}NFj(S,ja,X,Y){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");z.a.initialize(S,ja,X,Y);this.ng(39,null)}NEj(S,
ja,X,Y){y.a.initialize(S,ja,X,Y);this.ng(40,null)}VGj(S,ja,X,Y){w.a.initialize(S,ja,X,Y);this.ng(41,null)}lGj(S,ja,X,Y){v.a.initialize(S,ja,X,Y);this.ng(42,null)}dHj(S,ja,X,Y){B.a.initialize(S,ja,X,Y);this.ng(53,null)}cHj(S,ja,X,Y){C.a.initialize(S,ja,X,Y);this.ng(54,null)}removeEntry(S){this.f_a&&(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(x,S)}`),this.oGa[S]=null,this.ZP.removeEntry(S)&&
this.Ra.raiseEvent("bBarAttachedOrDetached",new t(S,!1)))}fla(S){return this.f_a?this.ZP.fla(S):!1}cF(S){return this.f_a?this.ZP.cF(S):!1}fFb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Jnc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}rSg(){const {BusinessBarControl:S}=a(1150);if(this.f_a&&!this.ZP){D.h(this.$).Vb.Yk(this.uDf);
var ja=document.getElementById(this.$.Eb+r.a.fze);this.ZP=new S(this.$,ja)}}uLd(){this.f_a&&this.ZP.uLd()}wWj(S){0<=Z.indexOf(S)&&!this.$.gOb&&(this.$.gOb=!0,this.$.Ate&&this.H8i())}H8i(){try{const ja=f.a.get(r.a.RFd);if(H.a.rh(ja))c.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.pSd();else{var S=U.a(decodeURIComponent(ja));S.Options|=4096;try{const X=
U.c(S);f.a.Qu(r.a.RFd,X,d.AFrame.r1);c.ULS.sendTraceTag(509686989,0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised")}catch(X){c.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${X.message}`)}}}catch(ja){c.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${ja.message}`)}}Sjj(){if(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ja=
this.Ph.$ea;if(3E5<=ja-this.qof){this.qof=ja;for(let X=0;70>X;X++){var S=this.oGa[X];if(S&&(S=ja-S,3E5<=S)){const Y=Enum.toString(x,X);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Y}] was activated but not turned off for ${S} Millis`)}}}}}qFh(S){const ja=[];for(const X of S)switch(X.MessageId){case -113742550:const Y=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||V.a.eh(S,Y))&&ja.push(-113742550)}return V.a.RB(S,
ja)}e9h(S,ja){switch(S.MessageId){case 2113407564:const X=V.a.j0a([1821390342,-943219229,-502303485,1437034227]);for(let Y=0;Y<X.length;Y++)X[Y].HelpTopicId=S.HelpTopicId,X[Y].HelpDescription=S.HelpDescription,this.YJc.push(X[Y])}switch(S.MessageId){case -395951567:this.ng(6,S);break;case 1643490758:this.ng(4,S);break;case -907264831:this.ng(5,S);break;case 757111532:case 2113407564:this.ng(7,S);break;case 2010656511:this.ng(15,S);break;case 1321660996:this.$.C7c=!0;this.ng(8,S);break;case 526339737:this.$.C7c=
!0;this.ng(9,S);break;case -407088521:this.ng(10,S);break;case 1756116017:this.ng(14,S);break;case -1703455218:this.ng(17,S);break;case 1393475740:this.ng(25,S);break;case -949523941:this.ng(26,S);break;case 1779381952:this.ng(44,S);break;case 1421575100:this.ng(45,S);break;case 613676060:this.ng(46,S);break;case 1233668252:this.ng(61,S);break;case 1911608588:S=!!(this.$.qd&64);!this.$.ea.Of()&&S&&ja.push(29);break;case 1544494907:break;case -655555355:ja.push(this.Ntd()?1:0);break;case -1221382671:ja.push(2);
break;case 1662282929:ja.push(3);break;case 104919273:this.$.ea.Of()||ja.push(30);break;case -689453604:S=!!(this.$.qd&64);this.$.ea.Raf=!0;!this.$.ea.Of()&&S&&ja.push(31);break;case 157762400:this.$.ea.Fic=!0;!this.$.ea.Of()&&this.$.qd&64&&!this.$.isEditMode&&ja.push(32);break;case -1125398042:T.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Of()&&this.$.qd&64&&!this.$.isEditMode&&ja.push(34);break;case -73730134:!this.$.ea.Of()&&this.$.qd&
64&&ja.push(33);break;case -293349236:ja.push(65);break;case 1580811823:ja.push(67);break;case -37299333:break;case 136737622:ja.push(47);break;case -1780327030:this.ng(55,S);break;case -113742550:this.ng(57,S);break;case -260312420:this.$.ea.Of()||ja.push(66);break;default:this.ng(11,S)}return ja}tei(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!M.a.Crd(M.a.mfd(1))&&(h.a.Ap||h.a.$g)){const S=E.GetServiceTaskFactory.create(this.$.da,155,this.$.ka,1);I.TaskExtensions.za(S,()=>{this.ng(20,
null)},this.ka,3)}}Mdi(S){S||3!==this.$.workbookContext.WorkbookNovType||this.ng(63,null)}Ydf(S){(!S&&!this.$.printingEnabled||this.$.ie.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.ng(16,null));this.tei();this.$Be();this.Z8f();this.Mdi(S)}$Be(){this.$.workbookContext.Options&32768&&this.CFj()}CFj(){this.oGa[37]||this.ng(37,null)}EHj(){this.oGa[38]||this.ng(38,null)}Z8f(){T.EwaSettings.ma(642)&&
this.$.workbookContext.Options&524288&&this.ng(59,null)}v9f(S,ja){this.ng(58,S,null,ja)}JWc(S,ja=null){this.ZP.cF(S)?this.ZP.vQb(S,ja):this.ng(S,null,null,null,ja)}Q8f(){this.$.qd&8&&this.ng(12,null)}Ntd(){const S=this.$.da.Aa(38);return S?S.tokenExpired:!1}$Jg(S,ja){if(!this.cF(21)&&-1387426400!==S.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const X={};X.FailedMethod=ja;this.ng(21,S,X)}}static gec(){return P.lte||(P.lte=
[0,1,2,3])}qfd(S){return this.ZP.qfd(S)}}P.lte=null;Object(u.a)(P,"BusinessBarManager",m.a,[500,2,66])},1276:function(u,F,a){u=a(0);var c=a(222),b=a(1263);class e extends c.a{constructor(h){super();this.$=h;this.Fb()}create(){this.nb(this.$.da.Aa(5)||new b.a(this.$,!this.$.uba))}static la(h){h.da.Ga(4,new e(h))}}Object(u.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(F,"a",function(){return d});const d=()=>{f.a.Fa(e.la)}},1288:function(u,F,a){u=a(0);var c=a(15),b=a(84),e=a(850),f=a(837),
d=a(1207);class h{constructor(){this.ZGc=new d.a;this.XGc=new d.a;this.WGc=new d.a;this.kWg(this.ZGc);this.jWg(this.XGc);this.iWg(this.WGc);this.cMc=new d.a;this.bMc=new d.a;this.aMc=new d.a;this.HYg(this.cMc);this.GYg(this.bMc);this.FYg(this.aMc);this.pIc=new d.a;this.DWg(this.pIc);this.xGa(this.pIc);this.xGa(this.WGc);this.xGa(this.XGc);this.xGa(this.ZGc);this.xGa(this.bMc);this.xGa(this.cMc);this.xGa(this.aMc)}x2h(y,t){switch(y){case 1:return this.O5h(t);case 2:return this.qNh(t)}return f.a.Gzc?
this.pIc:null}kWg(y){y.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}jWg(y){y.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}iWg(y){y.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}HYg(y){y.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);
y.add("OverlayBig","Get the Word app");y.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");y.add("OverlaySmallSplit1","Discover Word");y.add("OverlaySmallSplit2","designed for the iPad.");y.add("SkipButton","Skip for now")}DWg(y){y.add("Headline","Get the Office Online extension for Chrome");y.add("UseAppButton","Get the extension");y.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}GYg(y){y.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);y.add("OverlayBig","Get the PowerPoint app");y.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");y.add("OverlaySmallSplit1","Discover PowerPoint");y.add("OverlaySmallSplit2",
"designed for the iPad.");y.add("SkipButton","Skip for now")}FYg(y){y.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}xGa(y){y.add("Corporation","Microsoft Corporation")}O5h(y){switch(y){case 3:return this.cMc;
case 2:return this.bMc;case 1:return this.aMc}return null}qNh(y){switch(y){case 3:return this.ZGc;case 2:return this.XGc;case 1:return this.WGc}return null}static get instance(){h.Ma||(h.Ma=new h);return h.Ma}}h.Ma=null;Object(u.a)(h,"WildFireStringFactory",null,[]);var n=a(4),m=a(39),x=a(27);a.d(F,"a",function(){return r});class r{constructor(y,t,v,w,C=null,B=null){this.rQc=null;this._id=y;this.aRc=t;this.gwg=C;this.ikb=w;this.umb=B;this.Jpa=null;this.$Ya=v;this.Smb=h.instance.x2h(t,y)}A5c(){this.Jpa=
new e.a(this.title,this.message,null);this.Jpa.addButton(this.oze,Object(b.a)(this,this.Pzf,"onButtonOneClick"),"");this.$Ya&&this.Jpa.iJg(this.qze,Object(b.a)(this,this.Szf,"onButtonTwoClick"));this.Jpa.N$=Object(b.a)(this,this.AMe,"dismissBar");this.Jpa.image=3;this.Jpa.id=16;this.Jpa.closeable=!0}get title(){return this.Smb.na("Headline")}get message(){return this.Smb.na("CallToAction")}get F_j(){return this.$Ya}get oze(){return this.$Ya?this.Smb.na("InstallButton"):this.Smb.na("UseAppButton")}get qze(){return this.$Ya?
this.Smb.na("OpenAppButton"):""}Pzf(){this.$Ya?this.qhi():this.v_j()}Szf(){this.$Ya&&this.a_i()}get KYg(){return this.Jpa}get openUrl(){this.rQc||(this.rQc=this.gwg());return this.rQc}qhi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.ikb&&this.umb&&this.umb();f.a.ySf(this._id,this.aRc)}a_i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.ikb&&this.umb&&this.umb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.sue(this._id),
this.openUrl,0,!1))}v_j(){f.a.Gzc?this.NYg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),f.a.NSd("BizBarClicked"),1!==this.aRc&&2!==this.aRc||f.a.j4g(this.openUrl,this.ikb,this._id,this.umb))}NYg(){this.ikb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");m.a.dV(n.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}mmh(){this.ikb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):
c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.NSd(f.a.wCe)}AMe(){f.a.Gzc?this.mmh():(f.a.NSd(f.a.mfd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static z6b(){const y=n.AFrameworkApplication.ta.Pa,t=new r(y.Hj,f.a.eec(),8<x.a.p6a,1===y.B6,()=>y.Ox,y.F_f());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return t}}Object(u.a)(r,"WildFireBusinessBar",null,[])},1289:function(u,F,a){u=a(0);var c=a(15),b=a(84),e=a(134),f=a(4),d=a(14),h=a(96),
n=a(45),m=a(181),x=a(1076),r=a(87),y=a(56),t=a(80),v=a(939);class w extends e.StandardDialog{constructor(B,z,A,E=null){super();this.IP=this.om=this.vqa=null;this.qn=[];this.OWb=z;this.BP=B;this.Bwg=A;this.$Xb=E;this.Rmb=new v.a("LoadResource","LoadPrintablePdf")}uQ(){this.Rb=5;this.width=40;const B=document.createElement("span");B.id=this.li("DirectPrintHeaderContent");const z=document.createElement("span");z.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(z,"DirectPrintHeader");
this.IP=document.createElement("iframe");this.IP.name="pdfObjectFrame";this.IP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.IP.onload=Object(b.a)(this,this.g6i,"printablePdfLoaded");if(this.$Xb&&0<this.$Xb.count){var A=t.a.did(this.OWb,this.$Xb);const E=t.a.RLd(this.OWb,this.$Xb);this.om=document.createElement("form");this.om.id="printPreviewPostForm";this.om.method="POST";this.om.target=this.IP.name;this.om.action=E;for(let I of A)A=document.createElement("input"),A.type="hidden",A.name=
I.key,A.value=I.value,this.om.appendChild(A)}else this.IP.setAttribute("src",this.OWb);Sys.UI.DomElement.addCssClass(this.IP,m.a.cge);this.Bwg?(Sys.UI.DomElement.addCssClass(this.IP,"DirectPrintPdfObjectHidden"),z.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,r.a.yh(this.IP,r.a.GC,r.a.Ak)):(Sys.UI.DomElement.addCssClass(this.IP,"DirectPrintPdfObject"),this.qn.push(this.IP));B.appendChild(z);B.appendChild(document.createElement("br"));B.appendChild(this.IP);this.om&&B.appendChild(this.om);
B.appendChild(document.createElement("br"));B.appendChild(this.U7g(this.om?"#":this.OWb));this.Rmb.start();this.DEb(CommonUIStrings.l_AppTitle,null,null,null,null,B);this.mX(this.li("DirectPrintHeaderContent"));this.om&&this.om.submit();this.Vbh();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}U7g(B){const z=document.createElement("span");var A=document.createElement("span");A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;z.appendChild(A);f.AFrameworkApplication.fa&&
(2===f.AFrameworkApplication.ta.Pa.Hj&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.ta.Pa.Hj&&f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(B=document.createElement("span"),2===f.AFrameworkApplication.ta.Pa.Hj?B.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.ta.Pa.Hj&&(B.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.vqa=B,z.appendChild(document.createElement("br")),z.appendChild(B)):(A=document.createElement("a"),A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,A.href=B,A.target="_blank",A.id="PrintPDFLink",A.className="AllowBrowserClick",this.vqa=A,z.appendChild(document.createElement("br")),z.appendChild(A),this.om&&n.a.addHandler(A,"click",Object(b.a)(this,this.Dqc,"onSubmit")),this.BP.sa(d.a.click,this.vqa,Object(b.a)(this,this.JNe,"downloadPDFLinkClicked"),null));this.qn.push(this.vqa);
return z}Dqc(B){this.om&&(this.om.target="_blank",this.om.submit());B.preventDefault()}Vbh(){if(0<this.qn.length){const B=new x.a(this.qn),z=h.FocusManager.instance().MQ();z&&(this.vqa.focus(),z.jf=B,z.S_=!0)}}JNe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}Hwd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}g6i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Rmb&&this.Rmb.stop()}dispose(){this.vqa&&
(this.BP.Ba(d.a.click,this.vqa,Object(b.a)(this,this.JNe,"downloadPDFLinkClicked")),this.vqa=null);y.a.A0(this.IP);this.IP=null;super.dispose()}}Object(u.a)(w,"DirectPrintDialog",e.StandardDialog,[385]);a.d(F,"a",function(){return C});class C{constructor(B){this.BP=B}cSh(B,z){return new w(this.BP,B,z,null)}}Object(u.a)(C,"DirectPrintDialogFactory",null,[368])},1290:function(u,F,a){u=a(0);var c=a(15),b=a(553),e=a(84),f=a(1342),d=a(1077);class h{constructor(t,v){this.$bg=t;this.kUa=v}}Object(u.a)(h,
"DirectPrintProbeResults",null,[]);var n=a(4),m=a(263),x=a(27),r=a(111);a.d(F,"a",function(){return y});class y{constructor(t,v,w,C,B,z,A,E,I,L){this.rZb=null;this.vug=t;this.mlb=v;this.TPc=w;this.Exg=C;this.jyg=B;this.kRc=new b.a(Object(e.a)(this,this.b_h,"getProbeResults"));this.wWa=z;this.Wde=I;this.lDg=A;this.kyg=E;this.ryg=L}get iD(){return this.vug}start(){}m8i(){const t=Array(this.iD.jUa.length);if(void 0!==this.mlb&&null!==this.mlb)for(let v=0;v<this.iD.jUa.length;v++)t[v]=this.iD.jUa[v]in
this.mlb&&this.Exg(this.mlb[this.iD.jUa[v]]);return t}n8i(){const t=Array(this.iD.kUa.length),v=!(void 0===this.TPc||null===this.TPc);for(let w=0;w<this.iD.kUa.length;w++){const C=this.iD.kUa[w];t[w]=v&&C in this.TPc?!0:this.jyg(C)}return t}M2h(){const t=this.m8i(),v=Array(t.length);for(let w=0;w<t.length;w++)v[w]=t[w]?this.KDh(this.mlb[this.iD.jUa[w]]):null;return v}KDh(t){if(void 0===t||null===t)return null;t=t.enabledPlugin;return void 0===t||null===t?null:t.name}b_h(){var t=this.M2h();const v=
this.n8i(),w={},C={};for(let B=0;B<this.iD.jUa.length;B++)w[this.iD.jUa[B]]=t[B];for(t=0;t<this.iD.kUa.length;t++)C[this.iD.kUa[t]]=v[t];return new h(w,C)}tEj(){return this.ryg||!this.iD.isEnabled||n.AFrameworkApplication.isUnifiedHostMode?!1:this.zMj()}f8f(){if(null!=this.rZb)return this.rZb;const t=y.Shf(this.iD);return this.rZb=this.iD.Thf&&t||this.Lki()}Lki(){return x.a.Bp&&this.iD.Nki&&x.a.yCe>=this.iD.U2g?!0:!1}zMj(){if(!this.kyg(this.iD))return!1;var t=r.a.Xjd(this.kRc.value.$bg);for(const v of t)if(void 0!==
v&&null!==v)return!0;t=r.a.Xjd(this.kRc.value.kUa);for(const v of t)if(v)return!0;return!1}j$h(){const t=r.a.Xjd(this.kRc.value.$bg);for(const v of t)if(m.a.contains(this.iD.xci,v))return!0;return!1}JGj(t){n.AFrameworkApplication.ta&&n.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.Wde(t,null):this.tEj()?this.Fmh(t,this.j$h()&&!0):this.Wde(t,null)}Fmh(t,v){const w=this.lDg.Bc("UserAction","OpenDirectPrintDialog");this.wWa.cSh(t,v).uQ();w.stop()}static pmf(t){try{return new ActiveXObject(t),
!0}catch(v){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",t)}return!1}static Vhf(t){return void 0===t||null===t?!1:!(void 0===t.enabledPlugin||null===t.enabledPlugin)}static create(t){const v=new d.a(n.AFrameworkApplication.fa.appSettings);let w=null;try{w=window.navigator.mimeTypes}catch(L){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let C=null;try{C=window.navigator.plugins}catch(L){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const B=
y.Vhf,z=y.pmf;t=t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const A=n.AFrameworkApplication.ta.lE,E=y.qmf,I=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Pa.Iv&&!n.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new y(v,w,C,B,z,t,A,E,(L,V)=>new f.a(L,!1,V,!0,I),n.AFrameworkApplication.Iba)}static qmf(t){return x.a.Bp||x.a.Gv&&t.ioi||t.Thf&&y.Shf(t)?!0:!1}static Shf(t){var v=x.a.tub;if(v){var w=v.split(".");if(2===w.length)return v=parseInt(w[0]),w=
parseInt(w[1]),v>t.Azd||v===t.Azd&&w>=t.Dvf}return!1}}Object(u.a)(y,"DirectPrintManager",null,[344])},1337:function(u,F,a){a.d(F,"a",function(){return m});u=a(0);var c=a(84);F=a(134);var b=a(1065),e=a(260),f=a(4),d=a(14),h=a(80),n=a(27);class m extends F.StandardDialog{constructor(x,r=!0,y=!1,t=null,v=null,w=!1){super();this.SWa=this.RWa=this.om=this.kY=null;var C=this.uZd?this.uZd:CommonUIStrings.l_DefaultDialogTitle;m.e6a=w;this.STb=t||new b.a(x,!0);this.STb.Cwe(this);const B=[],z=[];m.Wu&&(this.UXc&&
this.UXc.forEach(I=>{Array.add(B,I)}),this.Hse&&this.Hse.forEach(I=>{Array.add(z,I)}));r?y?(this.Rb=4,this.pc(1,this.buttonText),this.pc(2,CommonUIStrings.l_DialogClose)):(this.Rb=6,this.pc(0,CommonUIStrings.l_DialogClose)):this.Rb=5;w=document.createElement("span");this.T6c&&(w.className=this.T6c);t=document.createElement("a");t.innerText=this.Glc;t.href=x;t.target="_blank";t.id=this.Flc;t.className=e.AFrame.ote;var A=!n.a.Fz&&!!v&&0<v.count;if(A){const I=h.a.did(x,v);v=h.a.RLd(x,v);t.href="#";t.target=
"_self";this.om=document.createElement("form");this.om.id="printPreviewPostForm1";this.om.method="post";this.om.target="_blank";this.om.action=v;for(var E of I)v=document.createElement("input"),v.type="hidden",v.name=E.key,v.value=E.value,this.om.appendChild(v)}else this.om=null;this.om||m.e6a?m.e6a||Array.add(z,{["type"]:"AppLinkProps",["id"]:this.Flc,["text"]:this.Glc,["onExecute"]:()=>{this.XQf()}}):Array.add(z,{["type"]:"AppLinkProps",["id"]:this.Flc,["text"]:this.Glc,["handler"]:{["href"]:A?
"#":x,["target"]:A?"_self":"_blank"}});this.cPa&&Array.add(B,this.cPa);y?(x=document.createElement("span"),x.innerText=this.cPa.replace("{0}",""),w.appendChild(x)):this.tvf?(x=document.createElement("span"),x.id=this.li("message"),E=document.createElement("span"),v=document.createElement("span"),A=this.cPa.split("{0}"),E.innerText=A[0],v.innerText=A[1],x.appendChild(E),x.appendChild(t),x.appendChild(v),w.appendChild(x)):(x=document.createElement("span"),x.innerText=this.cPa,w.appendChild(x),w.appendChild(document.createElement("br")),
w.appendChild(document.createElement("br")),w.appendChild(t),m.e6a||Array.add(B,"{0}"));this.om&&w.appendChild(this.om);m.Wu&&(this.l9a&&(this.qDb?this.rpe(this.l9a,this.qDb):(Array.add(B,"{0}"),Array.add(z,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.l9a,["onExecute"]:()=>{this.zlc()}}))),this.fsa(B,z));this.DEb(C,null,this.edf,null,Object(c.a)(this,this.vw,"dialogHandler"),m.Wu?null:w);this.mX(this.li("message"));!m.Wu&&this.qDb&&this.l9a&&(C=document.createElement("div"),C.className=
"WACDialogLearnMoreLinkContainer",this.kY=document.createElement("a"),this.kY.innerText=this.l9a,this.kY.href=this.qDb,this.kY.target="_blank",this.kY.id=this.li("LearnMoreLinkId"),this.kY.className=e.AFrame.ote,C.appendChild(this.kY),r?this.wb.insertBefore(C,this.wb.lastChild):this.wb.appendChild(C),this.mX(String.format("{0} {1}",this.li("message"),this.li("LearnMoreLinkId"))));this.Wib=t;y?this.OI(this.kC):this.OI(this.Wib);this.erf();f.AFrameworkApplication.ta.yX.sa(d.a.click,this.Wib,Object(c.a)(this,
this.HNe,"downloadLinkClicked"),null);this.kY&&f.AFrameworkApplication.ta.yX.sa(d.a.click,this.kY,Object(c.a)(this,this.zlc,"learnMoreLinkClicked"),null);this.QTb=!1}get edf(){return null}get uZd(){return null}get cPa(){return null}get qDb(){return null}get l9a(){return null}get tvf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get T6c(){return null}get UXc(){return null}get Hse(){return null}xZc(){this.om&&(this.RWa||(this.RWa=Object(c.a)(this,this.WKi,"onActionButtonClicked"),this.Zy.sa(d.a.click,
this.kC,this.RWa)),this.SWa||(this.SWa=Object(c.a)(this,this.XKi,"onActionButtonKeyUp"),this.Yd.sa(d.a.Fd,this.kC,this.SWa)));super.xZc()}WKi(x){this.RVe(x);return!0}XKi(x){return this.iof(x,Object(c.a)(this,this.RVe,"executeDismissActionButtonFromArgs"))}RVe(x){this.om&&this.om.submit();this.Zua(x.Gb)}Hwd(){}HNe(){this.grf();this.om?this.om.submit():this.STb.Z8c();return!0}zlc(){return!1}dispose(){this.STb.dispose();this.Wib&&(f.AFrameworkApplication.ta.yX.Ba(d.a.click,this.Wib,Object(c.a)(this,
this.HNe,"downloadLinkClicked")),this.Wib=null);this.kY&&(f.AFrameworkApplication.ta.yX.Ba(d.a.click,this.kY,Object(c.a)(this,this.zlc,"learnMoreLinkClicked")),this.kY=null);this.Zy&&this.RWa&&(this.Zy.Ba(d.a.click,this.kC,this.RWa),this.RWa=null);this.Yd&&this.SWa&&(this.Yd.Ba(d.a.Fd,this.kC,this.SWa),this.SWa=null);super.dispose()}XQf(){this.om&&(document.body.appendChild(this.om),this.om.submit(),document.body.removeChild(this.om))}vw(x){1===x&&(this.Hwd(),this.om?m.Wu&&this.XQf():this.STb.Z8c());
this.dispose()}static get Wu(){return f.AFrameworkApplication.ta.Pa.Iv&&f.AFrameworkApplication.ta.Pa.$kf}static get e6a(){return m.rae}static set e6a(x){m.rae=x}}m.rae=!1;Object(u.a)(m,"ADialogWithLinkToResource",F.StandardDialog,[])},1338:function(u,F,a){a.r(F);a.d(F,"ReactOICErrorDialogWithTrial",function(){return f});u=a(0);var c=a(84);F=a(1067);var b=a(421),e=a(146);class f extends F.a{constructor(d,h,n,m,x,r){super(d,h,n,m,x,r);h={["errorMessage"]:this.wQe,["offerString"]:this.jyf};d=new e.a(!1,
!1,!0);this.R8f?(d.Rb=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Hwa,["onExecute"]:()=>{b.Redirect.showHelp(this.Abf)}}):(d.Rb=4,d.pc(2,this.Zcf));d.pc(1,this.LZb);d.Fe=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.Pl,Object(c.a)(this,this.L$i,"reactOICErrorDialogWithTrialHandler"),h)}}Object(u.a)(f,"ReactOICErrorDialogWithTrial",F.a,[])},1339:function(u,F,a){a.r(F);a.d(F,"OICErrorDialogWithTrial",function(){return e});u=
a(0);var c=a(84);F=a(1067);var b=a(134);class e extends F.a{constructor(f,d,h,n,m,x){super(f,d,h,n,m,x);f=document.createElement("span");f.innerText=this.wQe;f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.jyf;f.appendChild(d);d=new b.StandardDialog;this.R8f?(d.Rb=1,d.Ape(this.Hwa,this.Abf)):(d.Rb=4,d.pc(2,this.Zcf));d.pc(1,this.LZb);d.Fe=this.id;d.Zl(this.Pl,null,this.icon,Object(c.a)(this,this.txi,"legacyOICErrorDialogWithTrialHandler"),
f)}}Object(u.a)(e,"OICErrorDialogWithTrial",F.a,[])},1340:function(u,F,a){a.r(F);a.d(F,"CheckRoamingRightsRequest",function(){return c});u=a(0);a=a(1068);class c extends a.a{constructor(){super()}Jxb(){return 2}Vaa(){return 1}}Object(u.a)(c,"CheckRoamingRightsRequest",a.a,[])},1341:function(u,F,a){a.r(F);a.d(F,"GetRoamingLauncherRequest",function(){return c});u=a(0);a=a(1068);class c extends a.a{constructor(){super()}Jxb(){return 0}Vaa(){return 2}}Object(u.a)(c,"GetRoamingLauncherRequest",a.a,[])},
1342:function(u,F,a){a.d(F,"a",function(){return m});u=a(0);var c=a(15),b=a(1337),e=a(1065),f=a(4),d=a(87),h=a(80),n=a(27);class m extends b.a{constructor(x,r,y=null,t=!0,v=!1){super(x,!0,!(m.BCa&&t),new e.a(x,r),y,v);m.BCa=m.BCa&&t;if(m.BCa){r=document.createElement("iframe");t=null;v=this.Alh;r.name="pdfObjectFrame";r.id="pdfObjectIFrame";if(y&&0<y.count){const w=h.a.did(x,y);x=h.a.RLd(x,y);t=document.createElement("form");t.id="printPreviewPostForm";t.method="POST";t.target=r.name;t.action=x;for(let C of w)x=
document.createElement("input"),x.type="hidden",x.name=C.key,x.value=C.value,t.appendChild(x)}else r.src=x;v.appendChild(r);t&&(v.appendChild(t),t.submit());Sys.UI.DomElement.addCssClass(r,"DirectPrintPdfObjectHidden");d.a.yh(r,d.a.GC,d.a.Ak)}}get edf(){return"Print_32x32x32"}get uZd(){return m.BCa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get cPa(){return m.BCa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get UXc(){const x=[];Array.add(x,CommonUIStrings.l_PrintDialogCanCloseDocument);
if(b.a.e6a){let r=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.ta.Pa.bKe&&(r=f.AFrameworkApplication.ta.Pa.bKe);Array.add(x,r)}return m.BCa?x:null}get Glc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Flc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get T6c(){return f.AFrameworkApplication.SLe?"UIFontDialogTextLarge":null}erf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}grf(){f.AFrameworkApplication.Tn.Fzb(9540);
c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Hwd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get BCa(){return!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Pa.Iv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(n.a.Fz||n.a.Gv||n.a.Jf||n.a.KNa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set BCa(x){}}Object(u.a)(m,
"PrintDialogWithLinkToPdf",b.a,[])},1359:function(u,F,a){u=a(0);var c=a(84),b=a(41);class e{constructor(){this.classId=0}static kJa(m){try{return b.a(m)}catch(x){}return null}}Object(u.a)(e,"ARoamingAppsResponse",null,[]);class f{constructor(){this.state=this.callback=null;this.Rqd=!1}}Object(u.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(107);a.d(F,"a",function(){return n});class n{constructor(m){this.nIc=!1;this.pYa=n.ugc;this.cSc=this.eQc=0;this.platform=null;this.MBg=m;this.Rme=
this.dSc=!1}get roamingAppsAreEnabled(){return this.MBg}get R_j(){return this.roamingAppsAreEnabled&&this.dSc?this.Rme:!1}H2g(){d.AFrameworkApplication.Zic&&this.roamingAppsAreEnabled&&!this.dSc&&!this.nIc&&(this.cSc=1,this.nIc=!0,this.Rlj(),this.OVe())}Rlj(){this.pYa=n.ugc;this.eQc=0}getRoamingAppsLauncher(m,x,r){this.R_j?(m=new f,m.callback=x,m.state=r,m.Rqd=!0,this.TVe(m)):x(!1,"",r)}OVe(){const m=new (a(1340).CheckRoamingRightsRequest);m.RoamingApp=this.cSc;m.BaseDocQuerySignature=d.AFrameworkApplication.Hi;
m.execute(Object(c.a)(this,this.J2g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.I2g,"checkUserRoamingRightsFailed"),null)}J2g(m){d.AFrameworkApplication.Og||((m=e.kJa(m.data.ve))?this.PSd(m.HasRights):this.PSd(!1))}I2g(){if(!d.AFrameworkApplication.Og)if(this.eQc>=n.UEi)this.PSd(!1);else{var m=new h.a(2,1,this.pYa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.Fi.Fg(m);this.eQc++;this.pYa*=n.mnj;this.pYa>n.Puf&&(this.pYa=n.Puf)}}PSd(m){this.Rme=
m;this.dSc=!0;this.nIc=!1}retryCheckUserRoamingRights(){this.OVe()}TVe(m){const x=new (a(1341).GetRoamingLauncherRequest);x.RoamingApp=this.cSc;x.BaseDocQuerySignature=d.AFrameworkApplication.Hi;x.execute(Object(c.a)(this,this.D0h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.C0h,"getRoamingAppsLauncherFailed"),m)}D0h(m){if(!d.AFrameworkApplication.Og){var x=e.kJa(m.data.ve);m=m.data.state;x?(this.platform=x.Platform,m.callback(!0,x.Launcher,m.state)):m.callback(!1,"",m.state)}}C0h(m){if(!d.AFrameworkApplication.Og){var x=
m.data.state;5===m.data.status&&x.Rqd?(x.Rqd=!1,this.TVe(x)):x.callback(!1,"",x.state)}}static get instance(){return n.wC||(n.wC=new n(d.AFrameworkApplication.NRg))}}n.ugc=1E3;n.mnj=5;n.Puf=12E5;n.UEi=5;n.wC=null;Object(u.a)(n,"RoamingAppsManager",null,[])},1433:function(u,F,a){a.r(F);var c=a(1050),b=a(0),e=a(248);class f{get name(){return"Common.App.DialogWithLinkToResource"}Xh(){}init(){}dispose(){}static main(){e.a.instance.Ei(new f)}}Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,
[3,4]);var d=a(553),h=a(15),n=a(84),m=a(814),x=a(30),r=a(131);class y{static Tqh(jc){return y.$ye("New",jc)}static Uqh(jc){return y.$ye("Open",jc)}static Kye(jc,Tc){return y.Gha("LoadingMenuSection",y.Nyi,jc,y.yqb("lblLoading",Tc))}static zqb(jc,Tc,ub=null,Vb=null){return y.Gha("MessageMenuSection",y.cwf,Tc,y.yqb("lblMessage",jc,ub,Vb))}static wXg(jc){return y.Kye(jc,CommonUIStrings.l_VoicedLoadingText)}static xXg(jc,Tc){return y.zqb(CommonUIStrings.l_NewCreationLocationMessage,jc.ti,Tc.LR,Tc.Doa)}static vXg(jc,
Tc){return y.zqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Tc.Doa,"\n\n"),jc.ti)}static Mye(jc){return y.zqb(CommonUIStrings.l_NewGenericErrorMessage,jc.ti)}static tXg(jc,Tc,ub){return y.Gha("menuNewBlank",y.R$h,ub?jc.ti:null,y.tqb(jc.kbf,jc.lbf,jc.mbf,null,jc.Fka,jc.tzb,Tc,"blank"))}static sYg(){return y.yqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Xye(){return y.yqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static tYg(jc,Tc){return y.Gha("menuNewTemplates",
jc,null,Tc)}static rXg(jc,Tc){return y.Gha("menuNewMoreTemplates",y.gZe,null,y.tqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,jc,Tc))}static vWg(jc,Tc,ub){let Vb="";ub&&Tc&&(Vb=y.Gha("BrowseMoreMenuSection",y.gZe,null,y.tqb("btnBrowseMore",Tc,Tc,null,null,null,jc||"1959943459",ub)));return Vb}static yqb(jc,Tc,ub=null,Vb=null){let tc=Vb;Tc&&0<Tc.length&&(tc=y.Zwf.Trc(Tc).trimEnd(),tc=0<=tc.indexOf("{0}")?String.format(tc,Vb):String.format("{0} {1}",
tc,Vb));ub=ub&&Vb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',x.a.Xe(ub),x.a.Xe(Vb),x.a.Xe(tc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',x.a.Xe(jc||""),y.Zwf.Trc(x.a.Xe(Tc||"")),ub)}static tqb(jc,Tc,ub,Vb,tc,Sc,jd,pb){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
x.a.Xe(jc||""),x.a.Xe(Tc||""),x.a.Xe(ub||""),Vb||"32by32",x.a.Xe(tc||""),x.a.Xe(Sc||""),jd,x.a.Xe(pb||""))}static $ye(jc,Tc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',jc,Tc)}static Gha(jc,Tc,ub,Vb){ub=ub?String.format('Title="{0}"',x.a.Xe(ub)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
x.a.Xe(jc||""),x.a.Xe(Tc||""),ub,Vb)}}y.cwf="MenuMru";y.Nyi="MenuLoading";y.R$h="MenuHeader";y.gZe="MenuFooter";y.Zwf=r.a.Sx("\n","&#10;");Object(b.a)(y,"NewAndOpenXmlUtilities",null,[]);var t=a(4),v=a(98),w=a(145),C=a(137);class B{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(B,"HostInformation",null,[]);var z=a(107),A=a(39),E=a(376),I=a(164),L=a(643),V=a(576),T=a(106),H=a(25);class D{constructor(jc,Tc,ub,Vb,tc,Sc){this.eUc=this.Xo=this.KSb=null;this.xYb=
this.pTc=!1;this.Uee=0;this.dTc=this.yNc=!1;this.o2=jc;this.tjb=Tc;this.rEa=new d.a(()=>new m.a(ub.value,Object(n.a)(this,this.txb,"getMoreInfoEventReceived")));this.pzg=Vb;this.hra=tc;this.CCg=Sc;this.Imb=this.Ezc;2===this.dL.Fca&&(this.dTc=!0)}get PP(){switch(this.dL.Fca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Ig(){const jc=this.dL.n$a;jc.Nb(H.a.newDocument,T.a.frame,Object(n.a)(this,this.newDocument,"newDocument"));jc.Ne(H.a.nsc,
T.a.frame,Object(n.a)(this,this.nsc,"populateNewMenu"),96)}newDocument(jc,Tc,ub,Vb,tc){if(1===ub)return 32;if(2===ub&&tc){if(t.AFrameworkApplication.fa.qa("BackstagePremiumTemplateExperienceEnabled")&&tc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),t.AFrameworkApplication.ub.processAction(H.a.V4i,2);if(tc.MenuItemId&&tc.SourceControlId)return"NewDocumentHome"===tc.SourceControlId&&w.a("NewDocumentFromHomeTab"),this.N1a(tc.MenuItemId,tc.SourceControlId)}return 8}N1a(jc,
Tc){var ub=this.Mnc.l6c;if(null===ub)return 8;var Vb=t.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(t.AFrameworkApplication.aca&&Vb){h.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const tc={};tc[E.a.idg]=jc;tc[E.a.PP]=this.PP;tc[E.a.lcid]=t.AFrameworkApplication.lcid.toString();tc[E.a.reason]=L.a.createNew;t.AFrameworkApplication.pV().execute(Sc=>{Sc.Rj(I.a.N1a,tc)})}else Vb=(new Date).getTime(),
Tc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ub,x.a.mf(this.fma),x.a.mf(jc),x.a.mf(this.PP),x.a.mf(t.AFrameworkApplication.lcid.toString()),x.a.mf(Vb.toString()),x.a.mf(Tc),x.a.mf(t.AFrameworkApplication.canary),t.AFrameworkApplication.Hi),(ub=t.AFrameworkApplication.fa.Xa("ScenarioId"))&&""!==ub&&(Tc+="&wdscenarioid="+x.a.mf(ub)),Tc+="&"+t.AFrameworkApplication.Idc(),t.AFrameworkApplication.Axa&&(Tc+="&"+t.AFrameworkApplication.$cc()),
(ub=this.Xo?this.Xo.LR:null)&&(Tc+="&DestinationUrl="+x.a.mf(ub)),A.a.lf(Tc,"_blank",void 0,"CreateNewDocument");2===this.dL.Fca&&h.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:V.a[this.dL.Fca],["Template"]:jc});return 32}bCi(jc){let Tc=Number.MAX_VALUE,ub=Number.MIN_VALUE;const Vb=window.performance;if(Vb&&"undefined"!==typeof Vb.getEntriesByName){for(let Sc=0;Sc<jc.length;Sc++){var tc=Vb.getEntriesByName(jc[Sc]);tc&&0<tc.length&&(tc=tc[0],Tc=Math.min(parseInt(String(tc.fetchStart)),
Tc),ub=Math.max(parseInt(String(tc.responseEnd)),ub))}ub>Tc&&h.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ub-Tc,["MinFetchStart"]:Tc,["MaxResponseEnd"]:ub})}}nsc(jc,Tc,ub,Vb,tc){if(1===ub)return this.dTc&&(t.AFrameworkApplication.PN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.dTc=!1),32;2!==ub||this.yNc||(this.Uee=(new Date).getTime(),h.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",
{["ShouldShowTemplates"]:this.Ezc,["CachedNewMenuXmlExists"]:!!this.KSb,["ShouldCallGetMoreInfo"]:this.dL.supportsGetMoreInfoForPersonalStorage}));return this.M3i(tc)}M3i(jc){jc&&(this.KSb?jc.PopulationXML=this.KSb:(this.dL.supportsGetMoreInfoForPersonalStorage&&!this.Xo&&this.DIi.a_("Opened New menu",!0),jc.PopulationXML=this.mMh(this.getTemplateListJson())));return 32}elf(){return!this.dL.supportsGetMoreInfoForPersonalStorage||!!this.Xo&&3===this.Xo.state&&!!this.Xo.Doa&&!!this.Xo.LR}Kqi(){return t.AFrameworkApplication.ta&&
t.AFrameworkApplication.ta.Pa.A_?!0:this.elf()}getTemplateListJson(){if(!this.Ezc||!this.Kqi())return null;if(this.Imb&&!this.xYb){var jc="9";const Tc=t.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Tc&&(jc=Tc.NumberOfTemplatesInBackstage);let ub=this.PP;"TemplateCollectionId"in Tc&&(ub=Tc.TemplateCollectionId);jc=String.format(this.dL.d0+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",x.a.mf(t.AFrameworkApplication.lcid.toString()),x.a.mf(ub),jc);Boolean.parse(Tc.AppendOriginQueryParam||
"false")&&(jc+="&org=backstage");Boolean.parse(Tc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in Tc&&(jc+="&templateTier="+Tc.TemplateTier);jc+="&"+t.AFrameworkApplication.Idc();t.AFrameworkApplication.Axa&&(jc+="&"+t.AFrameworkApplication.$cc());this.dL.gFb.Pm(jc,1,null,null,!1,2,Vb=>{this.dL.IOa("CreateNewActor.GetTemplateListJson",Vb.data);this.fOj(Vb.data.ve)},Vb=>{this.dL.IOa("CreateNewActor.GetTemplateListJson",Vb.data);this.eOj()},null,void 0,void 0,void 0,void 0,"5");
this.Imb=!1}return this.eUc}fOj(jc){this.eUc=jc;this.Imb=!1;this.oJb();if(t.AFrameworkApplication.ta&&t.AFrameworkApplication.ta.Pa.A_&&C.c()){jc=t.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Tc=t.AFrameworkApplication.aca;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.eUc,!0,jc&&Tc))}}eOj(){this.xYb=this.Imb=!0;this.oJb();t.AFrameworkApplication.ta&&t.AFrameworkApplication.ta.Pa.A_&&C.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));v.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}t3h(jc){var Tc=0;for(var ub=0;ub<jc.length;ub++)if("ST"===jc[ub].ImageType){Tc=ub;break}const Vb=jc.length?jc[Tc]:null;jc=Vb?Vb.Url||"":"";var tc;let Sc=ub=Tc=!1;if(Vb&&(tc=Vb.AspectRatio))tc=parseFloat(tc),1>tc?Tc=!0:1.5<tc?ub=!0:1===tc&&(Sc=!0);else switch(h.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:jc}),this.dL.Fca){case 3:Tc=!0;break;case 2:ub=
!0;break;case 5:Sc=!0}return{returnValue:jc,rci:Tc?"95by123":ub?"123by69":Sc?"100by100":"123by95"}}mMh(jc){jc=({hzc:Tc}=this.uXg(jc,this.Mnc,this.Mnc.CHa||"1056925771")).returnValue;if(Tc){this.KSb=jc;var Tc=(new Date).getTime()-this.Uee;h.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:Tc})}return jc}txb(jc,Tc){h.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Xo||3!==jc.state?2===jc.state&&(h.ULS.sendTraceTag(590964759,
202,50,"GetMoreInfoResult was bad, need to retry"),this.pTc=!0,this.oJb()):(this.Xo=jc,Tc||this.oJb(),t.AFrameworkApplication.ta&&t.AFrameworkApplication.ta.Pa.A_&&C.c()&&C.d("setFileMenuHostInformation")&&(jc=Object.assign(new B,{hostUrl:this.Xo.LR,hostName:this.Xo.Doa,folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,folderName:t.AFrameworkApplication.breadcrumbFolderName}),h.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(jc))))}uXg(jc,
Tc,ub){let Vb;Vb=!1;const tc=this.elf();let Sc="";this.dL.supportsGetMoreInfoForPersonalStorage&&(this.pTc?(Sc=y.Mye(Tc),this.pTc=!1,h.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Xo?tc?Sc=y.xXg(Tc,this.Xo):this.Xo.Ahi?(Vb=!0,this.Imb=!1,Sc=y.vXg(Tc,this.Xo),h.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Vb=!0,Sc=y.Mye(Tc),h.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Xo.LR,["StorageServiceDisplayNameIsSet"]:!!this.Xo.Doa})):(Sc=y.wXg(Tc.ti),h.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));tc&&(Sc+=y.tXg(Tc,ub,!Sc)+({hzc:Vb}=this.rYg(jc,ub)).returnValue);return{returnValue:y.Tqh(Sc),hzc:Vb}}rYg(jc,Tc){let ub;ub=!1;if(!this.Ezc)return ub=!0,h.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",hzc:ub};let Vb="",tc="",Sc="MenuTemplate";if(this.xYb)Vb=
y.Xye(),this.xYb=!1,h.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(jc){try{const jd=Sys.Serialization.JavaScriptSerializer.deserialize(jc,!0);Vb=this.qYg(jd,Tc);h.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.$wf&&"OneDrive"===this.fma&&(tc=y.rXg(this.EIi,t.AFrameworkApplication.$wf))}catch(jd){h.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:jc}),
Vb=y.Xye()}ub=!0}else Sc="MenuLoading",Vb=y.sYg(),h.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:y.tYg(Sc,Vb)+tc,hzc:ub}}qYg(jc,Tc){let ub="";const Vb=[];for(let Sc=0;Sc<jc.length;Sc++){var tc=jc[Sc];let jd="";if(tc){const pb=tc.Title,Rb=tc.AssetId;tc=tc.Thumbnails;Rb&&pb&&tc&&({rci:tc,returnValue:jd}=this.t3h(tc),ub+=y.tqb("jbtnNewTemplate"+Sc,pb,null,tc,null,jd,Tc,Rb))}Vb[Sc]=jd}jc=new z.a(4,1,5E3,()=>{this.bCi(Vb)},106);this.dL.Knc.Fg(jc);
return ub}oJb(){this.yNc=!0;this.dL.Swf.px(this.Mnc.Tvb);this.yNc=!1}get dL(){return this.o2.value}get Mnc(){return this.tjb.value}get DIi(){return this.rEa.value}get EIi(){return this.pzg.value}get fma(){return this.hra.value}get Ezc(){return this.CCg.value}}Object(b.a)(D,"CreateNewActor",null,[]);var G=a(1336);class J extends G.a{constructor(){super()}oqe(){this.PT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.PT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.PT(2,CommonUIStrings.l_Open);
this.PT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.PT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.PT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return J.Ma||(J.Ma=new J)}static x_i(jc){return J.instance.ga(jc)}}J.Ma=null;Object(b.a)(J,"MruActorIntlHelper",G.a,[]);var M;(function(jc){jc[jc.success=0]="success";jc[jc.failure=1]="failure";jc[jc.spinner=2]="spinner";jc[jc.none=3]="none"})(M||(M={}));Object(b.b)("DisplayState",M);var Q=a(41);class U{constructor(jc,Tc,ub,Vb,tc,
Sc,jd,pb){this.WHc=null;this.cVc=!0;this.JSb="";this.iEg=0;this.BXa=null;this.sOc=3;this.ob=pb;this.o2=jc;this.pj=Tc;this.pvg=ub;this.tsg=Vb;this.ssg=tc;this.rEa=new d.a(()=>new m.a(Sc.value,null));this.awg=new d.a(()=>new m.a(jd.value,Object(n.a)(this,this.nHi,"mruEventResultReceived")));this.ob.qa("WacInTabOpenMRUIsEnabledForUiHost");this.ob.qa("UiHostSupportsDocRebootFeatures")}nHi(jc,Tc){this.BXa=jc;Tc||this.PSf()}zdj(){this.OD.n$a.Ne(H.a.msc,T.a.frame,Object(n.a)(this,this.msc,"populateMruMenu"),
96)}msc(jc,Tc,ub,Vb,tc){return 1!==ub&&tc?this.J3i(tc):32}J3i(jc){this.xrh();this.wrh();jc.PopulationXML=y.Uqh(this.JSb+this.WHc);return 32}xrh(){var jc=3;let Tc=!1;if(this.JSb&&this.iEg===this.BXa.RPj)h.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),jc=this.sOc;else{h.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ub=this.OD.Bw();this.BXa=this.mHi.a_("File Open opened",
!0);this.JSb&&2!==this.sOc&&3!==this.BXa.state?Tc=!0:(jc=this.n1h(this.BXa),t.AFrameworkApplication.ta&&t.AFrameworkApplication.ta.Pa.A_&&C.c()&&jc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(jc,!0)),this.JSb=({vIi:jc}=this.nMh(this.BXa)).returnValue);ub=this.OD.Bw()-ub;h.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ub})}2!==jc&&(ub={["DisplayState"]:M[jc]},1!==jc&&(ub.IsStale=Tc),h.ULS.sendTraceTag(5849630,
202,50,"MRU section display state {0}",ub));this.sOc=jc}n1h(jc){let Tc;try{Tc=Q.c(jc.Zzd)}catch(ub){Tc=null,h.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ub)}return Tc}wrh(){this.cVc?(h.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.WHc=({G2j:this.cVc}=this.vDi()).returnValue):h.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");h.ULS.sendTraceTag(5849633,202,
50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.cVc,["NotDisplayingLink"]:!this.WHc})}nMh(jc){let Tc;1===jc.state||0===jc.state?(h.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),jc=2,Tc=y.Kye(this.kka(2),this.kka(5))):3===jc.state&&jc.Zzd?(Tc=this.sXg(jc.Zzd),jc=0):(h.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Tc=y.zqb(this.kka(1),this.kka(2)),jc=1);return{returnValue:Tc,vIi:jc}}sXg(jc){let Tc;const ub=
this.zEb.CHa||"2155708348";if(jc.length){Tc=y.yqb("lblRecentDocuments",this.kka(3));let Vb=0;for(let tc=0;tc<jc.length;tc++){const Sc=jc[tc];"FileName"in Sc&&"DocumentUrl"in Sc&&"Path"in Sc&&(Tc+=y.tqb("MruButton"+tc,Sc.FileName.toString(),Sc.Path.toString(),null,this.zEb.Fka,this.zEb.tzb,ub,Sc.DocumentUrl.toString()),Sc.IsPinned&&Vb++)}Tc=y.Gha("RecentDocumentsMenuSection",y.cwf,this.kka(2),Tc);h.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:jc.length,
["NumPinnedDocuments"]:Vb})}else Tc=y.zqb(this.kka(0),this.kka(2)),h.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Tc}vDi(){let jc;jc=!0;let Tc=this.OVg;var ub=this.NVg;if(Tc&&ub||!this.OD.supportsGetMoreInfoForPersonalStorage)jc=!1;else{const Vb=this.gdc.a_("File Open",!1);3===Vb.state&&(Tc=Vb.LR,ub=Vb.Doa,jc=!1)}ub=ub?String.format(this.kka(4),ub):null;return{returnValue:y.vWg(this.zEb.CHa,ub,Tc),G2j:jc}}PSf(){this.OD.Swf.px(this.zEb.Tvb)}get OD(){return this.o2.value}get kka(){return this.pj.value}get zEb(){return this.pvg.value}get OVg(){return this.tsg.value}get NVg(){return this.ssg.value}get gdc(){return this.rEa.value}get mHi(){return this.awg.value}}
Object(b.a)(U,"MruRenderer",null,[]);var Z=a(240),P=a(768);class S{constructor(jc,Tc,ub,Vb,tc,Sc,jd){this.Xo=null;this.Mje=!1;this.xqa=this.x6d=0;this.wzg=jc;this.SXa=Tc;this.oWb=ub;this.tjb=Vb;this.hra=tc;this.o2=Sc;this.rEa=new d.a(()=>new m.a(jd.value,Object(n.a)(this,this.txb,"getMoreInfoEventReceived")))}N1a(){!this.Xo&&this.JAd.supportsGetMoreInfoForPersonalStorage?this.gdc.a_("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}txb(jc){if(!this.Xo&&3===jc.state)this.Xo=jc;else if(2===
jc.state){this.Mje?h.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.gdc.a_("NewDocumentFromStream",!0),this.Mje=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.x6d=(new Date).getTime();var jc=this.LEh.l6c;if(null===jc)this.SXa(null);else{var Tc=this.oWb.menuItemId,ub=this.oWb.vG,Vb=this.oWb.PLj,tc=this.oWb.QEh;this.xqa="streamBase64"===Vb?tc.length/1024:0;h.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.PP,
this.xqa);var Sc=(new Date).getTime();jc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",jc,x.a.mf(this.fma),x.a.mf(Tc),x.a.mf(this.PP),x.a.mf(t.AFrameworkApplication.lcid.toString()),x.a.mf(Sc.toString()),x.a.mf(ub),x.a.mf(t.AFrameworkApplication.canary),t.AFrameworkApplication.Hi,x.a.mf(Vb));jc+="&"+t.AFrameworkApplication.Idc();t.AFrameworkApplication.Axa&&(jc+="&"+t.AFrameworkApplication.$cc());(Tc=this.Xo?this.Xo.LR:null)&&
(jc+="&DestinationUrl="+x.a.mf(Tc));this.JAd.gFb.Pm(jc,2,tc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(n.a)(this,this.yIi,"newDocumentFromStreamSuccessHandler"),Object(n.a)(this,this.xIi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}yIi(jc){if(jc&&jc.data&&jc.data.ve)if(({Ft:Tc}=Q.d(jc.data.ve)).returnValue)if(jc=Tc,jc.StatusCode!==Z.a.nP&&jc.StatusCode!==Z.a.Xsb)h.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.PP,this.xqa,jc.StatusCode),this.SXa(null);else if(jc.NewDocumentUrl&&""!==jc.NewDocumentUrl){var Tc=(new Date).getTime()-this.x6d;h.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.PP,this.xqa,Tc);this.wzg(jc.NewDocumentUrl)}else h.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.PP,this.xqa),this.SXa(null);else h.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.PP,this.xqa,{["ResponseData"]:P.a.hgb(jc.data.ve)}),this.SXa(null);else h.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.PP,this.xqa),this.SXa(null)}xIi(jc){jc&&jc.data&&h.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.PP,this.xqa,jc.data.status);this.SXa(null)}get PP(){switch(this.JAd.Fca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get LEh(){return this.tjb.value}get fma(){return this.hra.value}get JAd(){return this.o2.value}get gdc(){return this.rEa.value}}Object(b.a)(S,"NewDocumentFromStreamOperation",null,[]);class ja{constructor(jc,Tc,ub,Vb){this.tjb=jc;this.hra=Tc;this.o2=ub;this.$vg=Vb}create(jc,Tc,ub){return new S(jc,Tc,ub,this.tjb,this.hra,this.o2,this.$vg)}}Object(b.a)(ja,"NewDocumentFromStreamOperationFactory",null,[511]);var X=a(82),Y=a(520),va=a(55);
class N{get name(){return"Common.App.NewAndOpen.UX"}Xh(jc){jc.register(ja,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").xc().Fc(()=>new ja(new d.a(()=>t.AFrameworkApplication.ta.Pa.Agd()),new d.a(()=>t.AFrameworkApplication.fma),new d.a(()=>jc.Lh("Common.INewAndOpenCommonHelpers")),new d.a(()=>jc.Lh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){t.AFrameworkApplication.fa.Ev(()=>{this.Kzb()})}Kzb(){const jc=
Y.a.jr(X.a.instance.Ub("Common.INewAndOpenCommonHelpers")),Tc=Y.a.jr(X.a.instance.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));t.AFrameworkApplication.fma&&va.Task.WAA.call(null,jc,Tc).continueWith(()=>{const ub=new D(new d.a(()=>jc.result),new d.a(()=>t.AFrameworkApplication.ta.Pa.Agd()),new d.a(()=>Tc.result),new d.a(()=>t.AFrameworkApplication.ta.Pa.Bgd().CHa||"1959943459"),new d.a(()=>t.AFrameworkApplication.fma),new d.a(()=>t.AFrameworkApplication.opi));ub.Ig();ub.oJb()});if(t.AFrameworkApplication.sRf){const ub=
Y.a.jr(X.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>"));va.Task.WAA.call(null,jc,Tc,ub).continueWith(()=>{const Vb=new U(new d.a(()=>jc.result),new d.a(()=>J.x_i),new d.a(()=>t.AFrameworkApplication.ta.Pa.Bgd()),new d.a(()=>t.AFrameworkApplication.w_i),new d.a(()=>t.AFrameworkApplication.v_i),new d.a(()=>Tc.result),new d.a(()=>ub.result),t.AFrameworkApplication.fa);Vb.zdj();Vb.PSf()})}}dispose(){}}Object(b.a)(N,"UXPackageManager",null,[3,4,2]);var ea=a(1178),Ca=a(1185),la=a(1157),Ra=a(1194),
lb=a(1186),Aa;(function(jc){jc[jc.myFiles=0]="myFiles";jc[jc.recent=1]="recent";jc[jc.currentFolder=2]="currentFolder";jc[jc.yourPhone=3]="yourPhone"})(Aa||(Aa={}));Object(b.b)("SharedFilePickerLandingLocation",Aa);class da{constructor(jc){this.vMa=this.Hbb=null;this._initialized=!1;this.Imd=jc}$2a(jc){this._initialized||(jc.so(I.a.VRf),jc.dm(I.a.VRf,Object(n.a)(this,this.IVi,"onReceivedPickerResponse")),this._initialized=!0)}Cgd(jc){return this.vMa=new Promise((Tc,ub)=>{const Vb={};Vb[E.a.x2i]=jc;
this.Hbb=(tc,Sc)=>{""===Sc?(h.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Tc(tc)):("Canceled"===Sc?h.ULS.sendTraceTag(572548164,306,50,Sc):h.ULS.sendTraceTag(556901065,306,10,Sc),ub(Sc))};this.Imd.execute(tc=>{this.$2a(tc);tc.Rj(I.a.B_i,Vb)})})}IVi(jc){this.Hbb(jc.Values[E.a.Erj],void 0===jc.Values[E.a.DGd]||null===jc.Values[E.a.DGd]?"":jc.Values[E.a.DGd])}itd(){return t.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}YHe(jc,Tc,ub,Vb,tc,Sc,jd){const pb={};pb[E.a.qrj]=
jc;pb[E.a.titleText]=Tc;pb[E.a.CPg]=ub;pb[E.a.DPg]=Vb;pb[E.a.EPg]=!1;pb[E.a.Emh]=!0;pb[E.a.WEh]=tc;pb[E.a.B2i]=Sc;pb[E.a.A2i]=Aa[jd];C.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(pb[E.a.C2i]="Dark");return pb}}Object(b.a)(da,"SharedFilePickerManager",null,[270]);class aa{constructor(){this.gb=null}get name(){return"Common.App.SharedFilePicker"}Xh(jc){this.gb=jc;jc.register(da,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").xc().Fc(()=>
new da(jc.Ub("Postmessage.IHostPostmessenger")))}init(){t.AFrameworkApplication.fa.Ev(()=>{this.Kzb()})}Kzb(){this.gb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Ei(new aa)}}Object(b.a)(aa,"SharedFilePickerPackage",null,[3,4]);var fa=a(1288),Oa=a(837),ba=a(27);class ka{get name(){return"Common.App.WildFire"}Woe(jc){let Tc=!1;jc&&(jc.A5c(),jc.KYg&&(Tc=!1));return Tc}Aah(){var jc=t.AFrameworkApplication.ta.Pa;jc=new fa.a(jc.Hj,Oa.a.eec(),!1,1===jc.B6);
this.Woe(jc)&&h.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}z6b(jc,Tc,ub,Vb,tc,Sc){jc=new fa.a(jc,ub,Vb,Tc,tc,Sc);this.Woe(jc)&&h.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Igh(){const jc=t.AFrameworkApplication.ta.Pa;var Tc=t.AFrameworkApplication.fa;const ub=jc.Hj,Vb=1===jc.B6;if(Tc.qa(Oa.a.c5h(ub))){var tc=Oa.a.eec(),Sc=8<ba.a.p6a;if(2!==ub||2!==tc||!Vb){Tc=Tc.qa(Oa.a.d5h(ub));var jd=jc.F_f(),pb=()=>jc.Ox;Tc&&!Oa.a.Crd(Oa.a.mfd(ub))&&this.z6b(ub,Vb,tc,Sc,pb,jd)}}}init(){var jc=
t.AFrameworkApplication.fa;const Tc=jc.qa("WildFireChromeExtensionEnabled");jc=jc.qa("WildFireChromeExtensionBar")&&Tc;Oa.a.Gzc&&jc&&!Oa.a.Crd(Oa.a.wCe)?this.Aah():(document.body&&Oa.a.RDj&&this.Igh(),t.AFrameworkApplication.ub.Nb(H.a.Kvd,T.a.frame,Object(n.a)(this,this.Kvd,"launchWildFireBusinessBar")))}Kvd(jc,Tc,ub,Vb,tc){if(1===ub)return 32;if(!tc)return 8;this.z6b(tc.app,tc.mode,tc.platform,tc.useTwoButton,null,null);return 32}dispose(){}Xh(){}static main(){e.a.instance.Ei(new ka)}}Object(b.a)(ka,
"PackageManager",null,[3,4]);var Pa=a(1276);a(1064);var Fa=a(9),oa=a(694),La=a(49),Ea=a(37),ca=a(184),$a=a(1);class Qa{constructor(jc){this.Vh=jc}nc(){return!1}executeCommand(jc,Tc,ub){return 2!==this.Vh.Zd(H.a.newDocument,2,ub)?va.Task.Ta(!0):ca.a(Tc.command)}wc(jc,Tc){return 1056925771===Tc.command}Kc(jc,Tc,ub){jc=!0;switch(Tc){case "PopulateNewMenu":this.Vh&&($a.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&t.AFrameworkApplication.Ip("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(t.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",t.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Vh.Zd(H.a.nsc,2,ub));break;default:jc=!1}return jc}}Object(b.a)(Qa,"CreateNewCommandHandler",null,[208]);class Va extends oa.a{constructor(jc){super(jc)}ld(){const jc=La.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),Tc=La.GetServiceTaskFactory.create(this.$.da,
165,this.ka,this.Ya);Ea.TaskExtensions.za(Ea.TaskExtensions.Ed([jc,Tc],this.ka),()=>{this.Zc([new Qa(t.AFrameworkApplication.ub)])},this.ka,3)}static la(jc){oa.a.Nd(87,new Va(jc))}}Object(b.a)(Va,"CreateNewCommandHandlerFactory",oa.a,[]);var fb=a(1171),Ka=a(1066),hb=a(1213),fc=a(513),dc=a(102),wb=a(188),Tb=a(11),xb=a(22),cb=a(281),jb=a(993);class qa{}qa.create="Create";qa.activate="Activate";qa.close="Close";qa.remove="Delete";qa.duplicate="Duplicate";Object(b.a)(qa,"Actions",null,[]);var za=a(29),
Na=a(44);class ua extends va.Task{constructor(jc){super();this.H3d=null;this.J3d=0;this.zSb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.TXa=this.TXa()}catch(Tc){this.dispose(),this.mBa(Tc),this._state=3}};this.eu=jc;this.TXa=this.MFc;this.moveNext()}MFc(){this.H3d=za.a.$c(3,2,0,1662,0,-1244327602,"MsFormDeleteConfirmation");this.zSb=Na.a(this.eu.$).vj(this.H3d).G();this.zSb.isCompleted||(this._state=2,this.zSb.M$a(this.moveNext));return this.dng}dng(){this.J3d=
this.zSb.a_();0===this.J3d&&(this.eu.$.workbookContext.Options=Tb.HelperMethods.LO(!1,this.eu.$.workbookContext.Options,2048),this.eu.deleteMsFormMetaDataSheet());this._state=3;this.ISa(!0)}dispose(){}}Object(b.a)(ua,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",va.Task,[2]);class Xa{}Xa.action="Action";Xa.kHh="FlexPane";Xa.cbc="formId";Xa.id="id";Xa.title="Title";Xa.LRb="XlWorkbookId";Xa.fJh="Fragment";Xa.host="Host";Xa.QQj="TopView";Xa.accountType="auth_pvr";
Object(b.a)(Xa,"Parameters",null,[]);var ha=a(60);const ta=(jc,Tc,ub,Vb,tc,Sc,jd=null)=>{jd=jc.Na(9,jd);jd.sheetName=Tc;jd.confirmationChoice=!0;return ha.g(jc,"DeleteSheet",jd,ub,Vb,tc,Sc,0)};class wa{constructor(jc){this.Bo="Excel";this.$=jc;this.eV=jb.a.current}get hasMsForm(){return dc.c(this.$.lg)}get ync(){return this.$.workbookContext.MsFormId}get HRb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return xb.a.contains(this.$.ov.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":
"OrgId"}nc(jc,Tc){switch(Tc){case -105284469:return!dc.i(this.$.lg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(jc,Tc){jc=Ea.TaskExtensions.Uj();Tc=Tc.command;switch(Tc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:jc=this.deleteMsForm();break;default:jc=ca.a(Tc)}return jc}wc(jc,
Tc){if(!this.$.ea.Yg.get(61))return!1;jc=!1;switch(Tc.command){case -105284469:jc=dc.i(this.$.lg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:jc=this.hasMsForm}return jc}Kc(){return!1}insertMsForm(){const jc=x.a.Pq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Tc={},ub={};Tc[Xa.action]=qa.create;Tc[Xa.accountType]=this.accountType;ub[Xa.action]=qa.create;ub[Xa.LRb]=encodeURIComponent(this.HRb);ub[Xa.host]=this.Bo;ub[Xa.title]=encodeURIComponent(jc);
this.qEb(Tc,ub);this.$.workbookContext.Options=Tb.HelperMethods.LO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const jc={},Tc={};jc[Xa.accountType]=this.accountType;Tc[Xa.cbc]=this.ync;Tc[Xa.LRb]=encodeURIComponent(this.HRb);Tc[Xa.host]=this.Bo;this.qEb(jc,Tc)}previewMsForm(){const jc={},Tc={};jc[Xa.accountType]=this.accountType;Tc[Xa.cbc]=this.ync;Tc[Xa.LRb]=encodeURIComponent(this.HRb);Tc[Xa.host]=this.Bo;Tc[Xa.QQj]="Preview";this.qEb(jc,Tc)}sendMsForm(){const jc={},Tc={};jc[Xa.accountType]=
this.accountType;Tc[Xa.cbc]=this.ync;Tc[Xa.kHh]="SendForm";Tc[Xa.LRb]=encodeURIComponent(this.HRb);Tc[Xa.host]=this.Bo;this.qEb(jc,Tc)}deleteMsForm(){return new ua(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.oD(new wb.a(158,0,(jc,Tc,ub)=>ta(this.$.pa.Tw,this.eV.$vb,cb.b(jc,()=>{this.Tjh()}),Tc,ub,null)))}Tjh(){const jc={},Tc={};jc[Xa.action]=qa.remove;jc[Xa.accountType]=this.accountType;Tc[Xa.action]=qa.remove;Tc[Xa.host]=this.Bo;Tc[Xa.cbc]=encodeURIComponent(this.ync);Tc[Xa.LRb]=
encodeURIComponent(this.HRb);this.qEb(jc,Tc)}qEb(jc,Tc){const ub=this.$.va.MsFormBaseUrl+"/Pages/DesignPage.aspx";let Vb="";var tc="";if(Tc){for(let pb in Tc){var Sc=pb,jd=Tc[pb];tc+=tc.length?"&":"";tc+=Sc+"="+jd}jc||(jc={});jc[Xa.fJh]=encodeURIComponent(tc)}if(jc)for(let pb in jc)Tc=pb,tc=jc[pb],Vb+=Vb.length?"&":"?",Vb+=Tc+"="+tc;window.open(ub+Vb,"_blank")}}Object(b.a)(wa,"MsFormCommandHandler",null,[208]);class db extends oa.a{constructor(jc){super(jc)}ld(){const jc=La.GetServiceTaskFactory.create(this.$.da,
203,this.ka,this.Ya);Ea.TaskExtensions.za(Ea.TaskExtensions.Ed([jc],this.ka),()=>{this.Zc([new wa(this.$)])},this.ka,3)}static la(jc){jc.ea.Yg.get(61)&&oa.a.Nd(215,new db(jc))}}Object(b.a)(db,"MsFormCommandHandlerFactory",oa.a,[]);var Jb=a(222);class Pb extends Jb.a{constructor(jc){super();this.$=jc;this.Fb()}create(){Ea.TaskExtensions.za(La.GetServiceTaskFactory.create(this.$.da,164,this.ka,this.Ya),()=>{this.nb(new N)},this.ka,3)}}Object(b.a)(Pb,"NewAndOpenUXFactory",Jb.a,[]);class eb{constructor(jc,
Tc){this.Vh=Tc;this.$=jc}executeCommand(jc,Tc,ub){jc=2;switch(Tc.command){case H.a.openUrlInNewTab:jc=this.Vh.Zd(H.a.openUrlInNewTab,2,ub);break;case H.a.bQa:jc=this.Vh.Zd(H.a.bQa,2,ub)}return 2!==jc?va.Task.Ta(!0):ca.a(Tc.command)}wc(jc,Tc){return Tc.command===H.a.openUrlInNewTab||Tc.command===H.a.bQa}Kc(jc,Tc,ub){return"PopulateMruMenu"===Tc?(this.Vh.Zd(H.a.msc,2,ub),!0):!1}nc(){return!1}}Object(b.a)(eb,"OpenFromMruCommandHandler",null,[208]);class Ma extends oa.a{constructor(jc){super(jc)}ld(){const jc=
La.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),Tc=La.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Ya);Ea.TaskExtensions.za(Ea.TaskExtensions.Ed([jc,Tc],this.ka),()=>{this.Zc([new eb(this.$,t.AFrameworkApplication.ub)])},this.ka,3)}static la(jc){oa.a.Nd(88,new Ma(jc))}}Object(b.a)(Ma,"OpenFromMruCommandHandlerFactory",oa.a,[]);var ob=a(1147),Ia=a(1187),Da=a(1226),nb=a(1069),Ua=a(1167),W=a(1070),sa=a(1071),vb=a(1172),gc=a(1214),Bc=a(1215),Sa=a(83),na=a(374),ib=a(100),Ib=a(21),
ec=a(375);class qb{constructor(jc,Tc){this.sheetName=null;this.value=!1;this.sheetName=jc;this.value=Tc}getSheetName(){return this.sheetName}nwa(){return this.value}}Object(b.a)(qb,"MacroRecorderSheetOptionToggledPayload",null,[108]);const Ha=(jc,Tc,ub,Vb,tc,Sc,jd,pb=null)=>{pb=jc.Na(9,pb);pb.sheetName=Tc;pb.show=ub;return ha.g(jc,"ShowGridlines",pb,Vb,tc,Sc,jd,0)},Ab=(jc,Tc,ub,Vb,tc,Sc,jd,pb=null)=>{pb=jc.Na(9,pb);pb.sheetName=Tc;pb.show=ub;return ha.g(jc,"ShowHeadings",pb,Vb,tc,Sc,jd,0)},Yb=(jc,
Tc,ub,Vb,tc,Sc,jd,pb=null)=>{pb=jc.Na(9,pb);pb.sheetName=Tc;pb.directionRtl=ub;return ha.g(jc,"ChangeSheetDirection",pb,Vb,tc,Sc,jd,0)};class Bb{constructor(jc){this.$=jc}nc(){return!1}executeCommand(jc,Tc){const ub={};this.$.pk(ub);jc=Tc.command;const Vb=Object(Sa.a)(ib.a,this.$.xa.getItemByName(ub.SheetName));if(!Vb)return ca.a(jc);let tc,Sc,jd,pb,Rb;switch(jc){case 705559150:case -1411193626:tc=16;Sc=!Vb.hideGridLines;jd=Ha;Rb=183;pb=Vb.hideGridLines;break;case -2052321504:case 515737500:tc=4;
Sc=!Vb.headersVisible;jd=Ab;Rb=184;pb=!Vb.headersVisible;break;case -1478455630:tc=2;Sc=!Vb.displayRtl;jd=Yb;Rb=185;pb=!Vb.displayRtl;Ib.h(this.$).Da.qWj(Sc);break;default:return ca.a(jc)}Vb.jrb(tc,Sc);const oc=()=>new qb(ub.SheetName,pb),Jc=this.$.pa.ya;return na.a(this.$.userOperationManager,(ud,Fb,pa)=>jd(Jc,ub.SheetName,pb,cb.b(ud,tb=>{Bb.WGb(tb,Vb,tc,Sc)}),cb.a(Fb,()=>{Bb.iGb(Vb,tc,Sc)}),pa,null),ud=>new wb.a(Rb,0,ud,void 0,oc),Tc)}wc(jc,Tc){jc=!1;switch(Tc.command){case -1411193626:case 515737500:case -1478455630:jc=
!0;break;case 705559150:case -2052321504:jc=ec.a(this.$)}return jc}Kc(){return!1}static WGb(jc,Tc,ub,Vb){za.a.Lq(jc.Errors)&&Tc.jrb(ub,!Vb)}static iGb(jc,Tc,ub){jc.jrb(Tc,!ub)}}Object(b.a)(Bb,"SheetOptionsToggleCommandHandler",null,[208]);class Qb extends oa.a{constructor(jc){super(jc)}ld(){this.Zc([new Bb(this.$)])}static la(jc){oa.a.Nd(100,new Qb(jc))}}Object(b.a)(Qb,"SheetOptionsToggleCommandHandlerFactory",oa.a,[]);var sc=a(171),kb=a(179),Eb=a(148),Gc=a(66),zc=a(59),yb=a(208),gb=a(588),Kb=a(92),
sd=a(250),Sb=a(211),yc=a(12);class Fc extends Sb.a{constructor(jc,Tc,ub,Vb=null){super(jc,ub,2,Vb);this.YLc=null;this.onResize=()=>{const tc=this.rVh();this.xMa.setAttribute("width",tc.x.toString());this.xMa.setAttribute("height",tc.y.toString());this.dXj(tc);this.BDd()};this.$Ke=Tc;this.$.QA(this.onResize);this.tfc()}get xMa(){return this.YLc}initialize(){const jc=this.$.Eb+"iframeDialog_frame",Tc=this.$.Eb+"iframeDialog";this.Ib.style.margin=Tb.HelperMethods.uc(0);this.Ib.style.marginBottom=Tb.HelperMethods.uc(-2);
if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var ub=document.createElement("iframe");ub.id=jc;ub.frameBorder="0";ub.scrolling="auto";ub.src=this.Rgd(Tc);this.Ib.appendChild(ub)}else ub=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',jc,this.Rgd(Tc)),this.Ib.innerHTML=ub;this.YLc=document.getElementById(jc);this.domElement.id=Tc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.aE(this.onResize);
super.dispose()}setFocus(){yc.DOMElementExtensions.setFocus(this.xMa)}onHide(){this.xMa.contentWindow.close();yc.DOMElementExtensions.uf(this.xMa);this.YLc=null;super.onHide()}dXj(jc){const Tc=this.domElement.style;Tc.width=Tb.HelperMethods.uc(jc.x);Tc.marginLeft=Tb.HelperMethods.uc(-jc.x/2)}rVh(){const jc=yc.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*jc.width),this.$Ke.x),Math.min(Math.floor(.9*jc.height),this.$Ke.y))}}Object(b.a)(Fc,"IFrameDialog",
Sb.a,[]);var Zc=a(5),Rd=a(74),Ed=a(13);class ne extends Fc{constructor(jc){super(jc,new Sys.UI.Point(960,680),Ed.a.instance.ga(1260));this.name=Zc.a.dPe}get qc(){return"EmbeddingDialog"}Rgd(jc){const Tc=new Sys.StringBuilder(this.$.va.EmbedConfiguratorUrl);yb.a.zk(Tc,Zc.a.Hth,jc);Rd.a(this.$.va,32)&&yb.a.zk(Tc,Zc.a.kRe,"1");Rd.a(this.$.va,33)&&yb.a.zk(Tc,Zc.a.mRe,"1");Rd.a(this.$.va,34)&&yb.a.zk(Tc,Zc.a.lRe,"1");Rd.a(this.$.va,35)&&yb.a.zk(Tc,Zc.a.jRe,"1");return Tc.toString()}onShow(){h.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)(ne,"EmbeddingDialog",Fc,[]);var ze=a(1240),Be=a(89),td=a(80),Se=a(823);class $b{}$b.r6f="FrameDialog_ShareFromEdit";$b.view="FrameDialog_View";$b.CDe="FrameDialog_CloseAndRefresh";$b.FAj="FrameDialog_ShareFromView";$b.edit="FrameDialog_Edit";$b.Obj="FrameDialog_RefreshGrid";$b.K4g="FrameDialog_CloseMe";$b.MDe="FrameDialog_CloseMeError";$b.ready="FrameDialog_Ready";$b.d3i="FrameDialog_PleaseClose";$b.BK="GotoRange";
Object(b.a)($b,"PostMessageConstants",null,[]);var Xc=a(283),ed=a(116),Rc=a(282);class Fd{constructor(){this.BK=null;this.hHd=1461300262}}Object(b.a)(Fd,"SessionUpdateContext",null,[]);class Nd extends Fc{constructor(jc,Tc,ub){super(jc,new Sys.UI.Point(Nd.rjh,Nd.Rih),Ed.a.instance.ga(Tc?1265:1264));this.U1a=null;this.oNc=!1;this.Lqc=Vb=>{const tc=this.$,Sc=new Fd;Sc.BK=Vb.Values[$b.BK];let jd=!1;switch(Vb.MessageId){case $b.r6f:this.sv();jd=!0;Sc.hHd=1334518759;break;case $b.view:this.Ooa=Ed.a.instance.ga(1265);
this.Cjg(!0);break;case $b.CDe:this.sv(),jd=!0}Vb=new wb.a(140,0,(pb,Rb,oc)=>Xc.n(tc.pa.ya,cb.b(pb,this.XWi),Rb,oc,Sc));Vb.flags=jd?16:80;tc.userOperationManager.Ic(Vb,this.Wd)};this.ROi=()=>{const Vb=this.$;Vb.va.SurveyRedirectUrl?(this.sv(),Vb.Xc(1305810481,0,8,null)):(this.Ooa=Ed.a.instance.ga(1264),this.Cjg(!1))};this.kXi=()=>{const Vb=this.$;this.sv();Vb.Xc(1334518759,0,8,null)};this.Soc=Vb=>{const tc=this.$;this.sv();Vb.MessageId===$b.MDe&&tc.ea.Odd()};this.EVi=()=>{this.oNc=!0;this.raiseEvent(Nd.Vvd)};
this.XWi=(Vb,tc)=>{if(!Rc.a(Vb)){Vb=this.$;if(tc.BK){const Sc=Vb.ea.xa;if(Sc.contains(tc.BK.SheetName))this.Dpc(tc);else{let jd=null;jd=()=>{Sc.una(jd);this.Dpc(tc)};Sc.gha(jd)}}1461300262!==tc.hHd&&Vb.Xc(tc.hHd,0,8,null)}};this.uce=Tc;this.Wd=ub}iMg(jc){this.addHandler(Nd.Vvd,jc)}shj(jc){this.removeHandler(Nd.Vvd,jc)}get qc(){return"FormDialog"}get Gjf(){return this.oNc}get Z7a(){return this.uce}dispose(){Be.a.Ia(this.U1a);this.U1a=null;super.dispose()}initialize(){super.initialize();const jc=td.a.dba(this.$.va.FormLightBoxUrl),
Tc=this.U1a=new ze.a(this.xMa.contentWindow,jc);Tc.isEnabled()&&Tc.vGa(jc)&&(this.lna($b.r6f,this.Lqc),this.lna($b.view,this.Lqc),this.lna($b.CDe,this.Lqc),this.lna($b.FAj,this.kXi),this.lna($b.edit,this.ROi),this.lna($b.Obj,this.Lqc),this.lna($b.ready,this.EVi),this.lna($b.K4g,this.Soc),this.lna($b.MDe,this.Soc))}close(jc){jc===this.PM&&this.Gjf&&this.U1a.send(new Se.a($b.d3i))||super.close(jc)}Rgd(){return this.WHe(this.Z7a)}WHe(jc){const Tc=this.$.va,ub=new Sys.StringBuilder(Tc.FormLightBoxUrl);
yb.a.zk(ub,Zc.a.OIh,this.$.ea.sessionId);yb.a.zk(ub,Zc.a.MIh,jc?Zc.a.NIh:Zc.a.LIh);ed.a.gpb(ub,Tc);return ub.toString()}Cjg(jc){this.oNc=!1;this.xMa.src=this.WHe(jc);this.uce=jc}lna(jc,Tc){this.U1a.so(jc);this.U1a.dm(jc,Tc)}Dpc(jc){const Tc=this.$.ea.xa.getItemByName(jc.BK.SheetName);Tc&&0===Tc.VB&&Ib.h(this.$).gg(jc.BK,null,null,null,20,"FormDialog.OnItemInserted")}}Nd.rjh=900;Nd.Rih=1200;Nd.Vvd="lightBoxReady";Object(b.a)(Nd,"FormDialog",Fc,[184]);var zd;(function(jc){jc[jc.comment=10]="comment";
jc[jc.range=12]="range";jc[jc.table=13]="table";jc[jc.chart=14]="chart";jc[jc.sheet=15]="sheet"})(zd||(zd={}));Object(b.b)("NavigationType",zd);var Sd=a(976),se=a(86),He=a(19),Gd=a(558),fe=a(943),$d=a(285),qe=a(754),pe=a(52);class Ne extends qe.a{constructor(jc,Tc,ub,Vb,tc,Sc=0,jd){super(jc,Ed.a.instance.ga(Tc),!1);this.htmlSanitizationHelper=null;this.message=ub;this.OKi=Vb;this.Y2d=tc;this.operationFlags=Sc;this.htmlSanitizationHelper=jd}get qc(){return"WebMethodConfirmationDialog"}get eC(){return 1005}get oIa(){return this.operationFlags}initialize(){let jc=
"<div class='"+se.a.Um+"'>\r\n\t<div class='"+se.a.uad+"'>\r\n\t\t<div class='"+He.a.Y2c+"'>\r\n\t\t\t<img src='{0}' class='"+He.a.FUe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+se.a.xad+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";jc=String.format(jc,pe.a.me(13),Ed.a.instance.ga(25),Ed.a.instance.ga(this.message));this.htmlSanitizationHelper&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
this.htmlSanitizationHelper.Ri(this.Ib,jc):this.Ib.innerHTML=jc;this.addButton(0,this.OKi);this.addButton(1);super.initialize()}mH(){return this.Y2d}}Object(b.a)(Ne,"WebMethodConfirmationDialog",qe.a,[]);class Le extends Sd.a{constructor(jc,Tc){super(jc,Ed.a.instance.ga(1267));this.htmlSanitizationHelper=this.TUa=this.rSa=this.textBox=null;this.uJf=()=>{const ub=this.$;this.sv();const Vb=new Ne(ub,1270,1271,1272,(tc,Sc,jd)=>{var pb=ub.pa.ya.Wb(),Rb=ub.pa.ya;pb=Rb.Na(1,pb);return ha.g(Rb,"UnshareForm",
pb,tc,Sc,jd,null,0)},16,this.htmlSanitizationHelper);Vb.initialize();Vb.xg()};this.htmlSanitizationHelper=Tc}get qc(){return"ShareFormDialog"}dispose(){this.TUa&&this.TUa.Jda(this.uJf);Be.a.rc([this.textBox,this.rSa,this.TUa]);this.TUa=this.rSa=this.textBox=null;super.dispose()}initialize(){let jc="<div class='"+se.a.Um+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+se.a.UJa+"'>\r\n\t<input type='text' id='{1}' class='"+se.a.zz+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
jc=String.format(jc,Ed.a.instance.ga(1268),"sfd_input","sfd_unshare",He.a.zo,Ed.a.instance.ga(1269));this.htmlSanitizationHelper&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.Ri(this.Ib,jc):this.Ib.innerHTML=jc;this.textBox=new $d.a(this.getElementById("sfd_input"));this.rSa=new fe.a(this.textBox.domElement);this.TUa=Gd.a.create(this.getElementById("sfd_unshare"));
this.TUa.S2(this.uJf);this.textBox.text=Ed.a.instance.ga(736);this.textBox.enabled=!1;this.textBox.readOnly=!ba.a.$g;this.addButton(1,10);super.initialize()}k0a(){return(jc,Tc,ub)=>{var Vb=this.$.pa.ya.Wb(),tc=this.$.pa.ya;jc=this.G4a(jc);Tc=this.WKa(Tc);Vb=tc.Na(1,Vb);return ha.g(tc,"ShareForm",Vb,jc,Tc,ub,null,0)}}i0(jc,Tc,ub){this.textBox.text=jc.Result;this.textBox.enabled=!0;yc.DOMElementExtensions.setVisible(this.TUa.domElement,!0);super.i0(jc,Tc,ub)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(jc){}super.setFocus()}}Object(b.a)(Le,"ShareFormDialog",Sd.a,[]);var gf=a(246),Ye=a(6),$e=a(81),Ya=a(253),ra=a(70),ya=a(622),mb=a(140),Hb=a(427),Zb=a(255),mc=a(17),Pc=a(252);class fd extends kb.a{constructor(jc,Tc,ub){super();this.kAe=this.lAe=!1;this.D3a=0;this.dja=!1;this.iMi=()=>{this.lAe=!0;this.u8f()};this.$=jc;this.Va=Tc;this.wK=ub;ra.a(this.$).QKd(new mb.a(Ye.a.yhg,Ye.a.idle,fd.x1g),new gf.a(Ye.a.KDe,Ye.a.b0,null,Ye.a.iP,Ye.a.idle))}get AFc(){return dc.b(this.$.lg)}get DPd(){return this.$.isEditMode&&
(this.$.ea.hph||this.$.AN)}nc(jc,Tc){switch(Tc){case 353606613:case -1099009678:case 192430811:return!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.a7f();case 783415632:return!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.a7f();case 869186573:return this.b7f();case -1570751769:case 1986648902:return 131072!==(this.$.bV&131072);case 330035228:return!(this.b4a(!0)&&this.AFc);case -509039657:return!(this.b4a()&&this.AFc);
case 1334518759:return!(this.b4a()&&this.AFc&&this.wAe())}return!1}a7f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.b7f()}b7f(){const jc=this.$.workbookContext.FullDocumentInfo,Tc=Zb.a()&&this.$.ea.Yg.get(5);return!jc.FileSharingUrl&&!Tc}executeCommand(jc,Tc,ub){jc=this.$.workbookContext.FullDocumentInfo;var Vb=H.a.workflow,tc=Ea.TaskExtensions.Uj();const Sc=Tc.command;if(Sc===Vb||-266099===Sc)return this.G9h(Tc,Vb,jc);switch(Sc){case 1986648902:this.F5f();break;case -1570751769:this.n7h(Tc);
break;case 869186573:Tc=H.a.EAj;tc=t.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");Vb=null;($a.EwaSettings.ma(543)||tc)&&ub&&"CopyLink"===ub.SourceControlId?(Vb={},Vb[E.a.fNb]="copy",Tc=H.a.q6f):tc&&ub&&"ManageAccess"===ub.SourceControlId?(Vb={},Vb[E.a.fNb]="manageAccess",Tc=H.a.GAj):ub&&"LinkToComment"===ub.SourceControlId&&(Vb={},Vb[E.a.fNb]="copy",Vb[E.a.iTd]=ub.navId,Tc=H.a.q6f);tc=this.C9f(jc,Vb);w.c(Tc);break;case -1099009678:tc=this.Qyc(12,jc);break;case 192430811:tc=this.Qyc(13,jc);break;
case 353606613:tc=this.Qyc(14,jc);break;case 783415632:ub&&"LinkToThisSheet"===ub.SourceControlId&&h.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");tc=this.Qyc(15,jc);break;case -59906385:case 1197060601:this.T8h(Tc,jc);break;case 1305810481:this.o$e(!1,Tc);break;case 330035228:this.o$e(!0,Tc);break;case -509039657:$a.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
Ea.TaskExtensions.za(La.GetServiceTaskFactory.Oa(this.$.da,498,499,0),jd=>{this.deleteForm(jd.result)},this.$.ka,3):this.deleteForm(null);break;case 1334518759:Tc.HAb=!0;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?Ea.TaskExtensions.za(La.GetServiceTaskFactory.Oa(this.$.da,498,499,0),jd=>{this.shareForm(jd.result)},this.$.ka,3):this.shareForm(null);break;case 710925581:zc.a.Bg.jzc("710925581")&&
(tc=Ea.TaskExtensions.za(this.wK.value,jd=>{jd.result.Rj(I.a.conversation,{})},this.ka,3));break;case 327119921:this.a7h();break;default:tc=ca.a(Sc)}return tc}wc(jc,Tc){jc=!1;Tc=Tc.command;if(Tc===H.a.workflow)return!0;switch(Tc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:jc=!0;break;case 353606613:case -1099009678:case 192430811:jc=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:jc=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return jc}Kc(jc,Tc,ub){if("PopulateFormMenu"===Tc){Tc=this.AFc?this.wAe()?fd.cDh:fd.dDh:fd.CIi;jc=this.Va.Ec();for(let Vb=0;Vb<Tc.length;Vb++)jc.buttons.push(this.Va.pb(Tc[Vb]));Tc=this.Va.fq("Forms.Flyout");Tc.tc.push(jc);ub.MenuItems=Tc.MC();return!0}return!1}G9h(jc,Tc,ub){return this.DPd&&jc.command===Tc?(this.BPd(jc,-266099),
Ea.TaskExtensions.iba()):Ea.TaskExtensions.za(this.wK.value,Vb=>{gb.a(Vb.result,I.a.workflow,null,ub.WorkflowPostMessage)||Tb.HelperMethods.lf(ub.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ka,3)}wAe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Yg.get(26)}a7h(){var jc=sc.a.create().toString();h.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${jc}`);var Tc=this.$.frame,ub=Tc.j$a,Vb=this.$;const tc=new Pc.QueryStringBuilder(t.AFrameworkApplication.fa.Xa("TeamsMeetingShareEndpoint"));
tc.qj("deeplinkId",jc);tc.qj("lm","deeplink");jc=tc.qj;var Sc={};const jd=new Pc.QueryStringBuilder(t.AFrameworkApplication.fa.Xa("TeamsAppSharingUrl"));jd.qj("auth","2");jd.qj("flight","officeunihost");jd.qj("source","TEAMS-ELECTRON.meetingStage.deeplink");var pb={};pb.fileType=x.a.H4(Vb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);pb.objectUrl=Vb.workbookContext.FullDocumentInfo.WorkbookPath;pb.baseUrl=Vb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Vb=Vb.workbookContext.WorkbookFileVersionId;
let Rb=decodeURIComponent(Vb);for(;Vb!=Rb;)Vb=Rb,Rb=decodeURIComponent(Vb);0>Vb.indexOf("{")||0>Vb.indexOf("}")?(h.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Vb}`),Vb=""):Vb=Vb.substring(Vb.indexOf("{")+1,Vb.indexOf("}")).toLowerCase()}pb.fileId=Vb;pb=Q.c(Q.c(pb));jd.qj("subEntityId",pb.substring(1,pb.length-1));Sc.appSharingUrl=jd.toString();Sc.appId=t.AFrameworkApplication.fa.Xa("TeamsAppId");Sc=JSON.stringify(Sc);jc.call(tc,"appContext",Sc);
ub.call(Tc,tc.toString(),!0)}n7h(jc){this.DPd?this.BPd(jc,1986648902):this.F5f()}o$e(jc,Tc){!jc&&this.$.va.SurveyRedirectUrl?this.o7i():(jc=new Nd(this.$,jc,Tc),jc.initialize(),jc.xg())}T8h(jc,Tc){this.DPd&&1197060601===jc.command?this.BPd(jc,-59906385):Ea.TaskExtensions.za(this.wK.value,ub=>{ub=ub.result;ub&&gb.a(ub,I.a.replyWithChanges,null,this.$.ea.Yg.get(8))||(ub=new Sys.StringBuilder(Tc.ReplyWithChangesUrl),yb.a.zk(ub,Hb.e,Hb.d),Eb.a.ntw(ub.toString(),this.$))},this.ka,3)}BPd(jc,Tc){const ub=
ra.a(this.$).hd.activityState,Vb=new Kb.a(Tc,jc.method,jc.mode,jc.af,jc.tabName);Na.a(this.$).Ls(new sd.a(Ye.a.ey,5,()=>{ub[Ya.a.Hq]=Ye.a.G_f;ub[ya.a.VVc]=Vb;this.$.gl.hz("SocialSharingSaveBeforeCommand");this.$.gl.$pe(Vb.command)}))}F5f(){const jc=this.$.va.DocumentHostInfo;jc.HostEmbeddedViewUrl||this.lAe?this.u8f():this.$.ie.get(53)&&Ea.TaskExtensions.za(this.wK.value,Tc=>{this.PTj(Tc.result)||Eb.a.ntw(jc.FileEmbedCommandUrl,this.$)},this.ka,3)}PTj(jc){return jc.isEnabled()&&(this.kAe||(this.kAe=
jc.dm(I.a.jAe,this.iMi)))?jc.Rj(I.a.zEh,null):!1}u8f(){if(ba.a.Dp)Eb.a.ntw(this.$.va.EmbedConfiguratorUrl,this.$);else{const jc=new ne(this.$);jc.initialize();jc.xg()}}deleteForm(jc){const Tc=this.$;jc=new Ne(Tc,1273,1274,1266,(ub,Vb,tc)=>{var Sc=Tc.pa.ya.Wb(),jd=Tc.pa.ya;Sc=jd.Na(9,Sc);Sc.surveyId=null;return ha.g(jd,"DeleteSurvey",Sc,ub,Vb,tc,null,0)},0,jc);jc.initialize();jc.xg()}shareForm(jc){const Tc=this.$.workbookContext.FullDocumentInfo;this.$.ea.Yg.get(26)?(jc=new Le(this.$,jc),jc.initialize(),
jc.xg()):Ea.TaskExtensions.za(this.wK.value,ub=>{gb.a(ub.result,I.a.shareForm,{[E.a.PMj]:this.$.workbookContext.SurveyTitle},this.$.ea.Yg.get(10))||Eb.a.ntw(Tc.ShareFormCommandUrl,this.$)},this.ka,3)}o7i(){const jc=this.$;jc.va.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const Tc=new Sys.StringBuilder(jc.va.SurveyRedirectUrl);yb.a.zk(Tc,"startupDialog","FormEdit");const ub=ra.a(this.$),Vb=ub.hd.activityState;Vb[$e.a.J2]=Tc.toString();Vb[$e.a.wM]=$e.a.tAd;this.$.gl.hz("SocialSharingEnvironmentChange");
Na.a(jc).Ls(new sd.a(Ye.a.ey,5,()=>{const tc=za.a.$c(3,2,1318,1319,1320,554412057,"FossEnvironmentUnsupported");ub.hd.rr([tc]);Vb[Ya.a.Hq]=Ye.a.yhg}))}b4a(jc=!1){return(this.$.ea.isEditMode||jc)&&this.$.ea.Yg.get(25)&&Zb.a()}E1h(jc){var Tc=Ib.h(this.$).ha;const ub=this.$.xa.oa?Gc.d(this.$.xa.oa):null;if(!ub)return h.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${zd[jc]}.`),null;var Vb=null;14===jc?Vb=this.d1h(Tc):12===
jc?(Vb=Tc.Aia,Vb=xb.a.contains(Vb,"!",!0)?Vb.split("!")[1]:Vb):13===jc&&(Tc=Tc.ra.selectedRanges,Tc[0]&&(Tc=Ib.h(this.$).Bb.Bj(Tc[0])))&&(Vb=Tc.mj);if(!Vb&&15!==jc)return h.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${zd[jc]}`),null;Tc={};Tc[E.a.fNb]="copy";Tc[E.a.iTd]=this.PSh(jc,Vb,ub);Tc[E.a.HAj]="deepLinkShare";h.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${zd[jc]} and sectionNameOrId: ${Vb} and SheetId: ${ub}`);
return Tc}d1h(jc){if(jc.Sa.s_&&(jc=jc.Sa.$b.floatingObject)&&0===jc.type){const Tc=jc.id.split(".");if(1<Tc.length)return Tc[1];h.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${jc.id}`)}return null}PSh(jc,Tc,ub){let Vb=jc+"_";Vb=btoa(15===jc?Vb+ub:Vb+(Tc+"_"+ub));Vb=Vb.replace(RegExp("\\+","g"),"-");Vb=Vb.replace(RegExp("\\/","g"),"_");return Vb=Vb.replace(RegExp("\\=+$","g"),"")}C9f(jc,Tc,ub=!1){return Ea.TaskExtensions.za(this.wK.value,
Vb=>{gb.a(Vb.result,I.a.sharing,Tc,this.$.ea.Yg.get(5))?(h.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${Tc?Tc[E.a.fNb]:""}`),ub&&$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&!this.dja&&(this.D3a=window.setInterval(()=>{this.QRj()},6E4),this.dja=!0)):Tb.HelperMethods.lf(jc.FileSharingUrl,"_blank",
void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ka,3)}Qyc(jc,Tc){if(15===jc&&!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==jc&&!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const ub=this.E1h(jc);if(ub)return h.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${ub[E.a.iTd]}`),this.C9f(Tc,ub,!0);h.ULS.sendTraceTag(537151643,
0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${zd[jc]}`);return null}QRj(){this.dja&&window.clearInterval(this.D3a);$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Xc(638984051,0,0,null),h.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}fd.CIi=[103];fd.cDh=[107,104,105,106];fd.dDh=[104,105];fd.x1g=[new mc.a(Ye.a.KDe,554412057,
0,0,1321),new mc.a(Ye.a.idle,554412057,0,1)];Object(b.a)(fd,"SocialSharingCommandHandler",kb.a,[208]);class id extends oa.a{constructor(jc){super(jc)}ld(){const jc=new d.a(()=>La.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Ya));Ea.TaskExtensions.za(La.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya),Tc=>{this.Zc([new fd(this.$,Tc.result,jc)])},this.ka,3)}static la(jc){oa.a.Nd(114,new id(jc))}}Object(b.a)(id,"SocialSharingCommandHandlerFactory",oa.a,[]);var Dd=a(1153);class Zd{constructor(jc){this.Vh=
jc}executeCommand(jc,Tc,ub){return 2!==this.Vh.Zd(H.a.tryOfficeThroughTellMe,2,ub)?va.Task.Ta(!0):ca.a(Tc.command)}wc(jc,Tc){return 215809929===Tc.command}Kc(){return!1}nc(){return!1}}Object(b.a)(Zd,"TryOfficeThroughTellMeCommandHandler",null,[208]);class bc extends oa.a{constructor(jc){super(jc)}ld(){this.Zc([new Zd(t.AFrameworkApplication.ub)])}static la(jc){oa.a.Nd(207,new bc(jc))}}Object(b.a)(bc,"TryOfficeThroughTellMeCommandHandlerFactory",oa.a,[]);var Qc=a(157),pd=a(76),ce=a(153),ke=a(261),
Oe=a(146),Fe=a(186);class Xe{static kN(){return Oe.a.iq(Xe.ol,Fe.a.Ua(443))}}Xe.ol="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(b.a)(Xe,"NamedSheetViewTeachingDialogHtml",null,[]);var pf=a(51);class Ae extends ke.a{constructor(jc){super(jc);
this.stopwatch=this.pp=null;this.LHi=Tc=>{if(1===Tc)this.$.Ja.Lb(new Kb.a(-2050946363,pd.a.Db,2,8,null)).continueWith(ub=>{this.pp.setResult(!ce.a(ub)&&ub.result)}),Tc="Yes";else{const ub=2===Tc;this.pp.setResult(ub);Tc=2===Tc?"No":"Close";ub&&this.O5i()}this.RAi(Tc);this.hide()}}get qc(){return"ShowNamedSheetViewTeachingDialog"}hg(){this.Rb=4;this.stopwatch=this.$.Kb.Bc("UserAction",this.qc);const jc=Ed.a.instance.ga(1904);this.qg=Xe.kN();this.pp=new Qc.a;this.initializeAndShow(jc,this.LHi,{});return this.pp.task}Pv(jc){super.Pv(jc);
this.pc(1,Ed.a.instance.ga(1906));this.pc(2,Ed.a.instance.Ua(456))}O5i(){this.$.ea.Gnc=!1}RAi(jc){const Tc={};Tc.a=this.$.va.UserSessionId;Tc.b="NamedSheetViewTeachingDialogClose";Tc.c=jc;Tc.e=!0;this.stopwatch&&(this.stopwatch.stop(),Tc.d=this.stopwatch.Ac);pf.b().Qe(53,Tc,!0)}}Object(b.a)(Ae,"NamedSheetViewTeachingDialog",ke.a,[]);var Ie=a(155);class Hf{constructor(jc){this.$=jc;jc.da.Ga(309,this)}xTa(){if(this.ADj()){if($a.EwaSettings.ma(567)){this.$.xa.oa.Gd.BUd=!0;const jc=new Qc.a;this.$.Ja.Lb(new Kb.a(-2050946363,
pd.a.Db,2,0,null)).continueWith(Tc=>{jc.setResult(!ce.a(Tc)&&Tc.result)});return jc.task}return(new Ae(this.$)).hg()}return va.Task.Ta(!0)}ADj(){const jc=this.$.xa.oa;return this.$.ea.w$a&&this.$.ea.Gnc&&!jc.Gd.Hv&&this.$.ea.$M&&!Ie.g(this.$)}}Object(b.a)(Hf,"NamedSheetViewPublic",null,[551]);class xe extends Jb.a{constructor(jc){super();this.$=jc;this.Fb()}create(){this.nb(this.$.da.Aa(309)||new Hf(this.$))}static la(jc){jc.da.Ga(310,new xe(jc))}}Object(b.a)(xe,"NamedSheetViewPublicFactory",Jb.a,
[]);var Ze=a(7),nf=a(187),hf=a(1335),bb=a(861),Lb=a(463);class nc{constructor(jc,Tc,ub,Vb,tc,Sc,jd){this.title=jc;this.body=Tc;this.Z5i=ub;this.primaryButtonAction=Vb;this.secondaryButtonAction=Sc;this.f1f=tc;this.targetObject=jd}}Object(b.a)(nc,"NamedSheetViewTeachingCalloutContent",null,[]);class Lc{constructor(jc){this.Wle=0;this.Xcg=jc}get Vcg(){return this.Wle}get x7i(){return this.Vcg<this.Xcg.count?this.Xcg.na(this.Wle++):null}}Object(b.a)(Lc,"NamedSheetViewTeachingCalloutList",null,[]);var od=
a(1075);class wd{constructor(jc){this.stopwatch=this.g1b=this.PBc=this.MYd=null;this.Wcg=0;this.$=jc}lei(jc){this.Wcg=jc;const Tc=Object(Ze.a)(new nf.a,{});wd.Kmi(jc)?(Tc.add(new nc(Ed.a.instance.Ua(445),Ed.a.instance.Ua(446),Ed.a.instance.ga(1934),()=>{this.nI(2,"Continue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.nI(1,"ExitGuide")},od.a())),1===jc&&Tc.add(new nc(Ed.a.instance.ga(1936),Ed.a.instance.Ua(448),Ed.a.instance.ga(1934),()=>{this.nI(2,"FirstEnterTempViewContinueSecond");
this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.nI(1,"FirstEnterTempViewExitGuideSecond")},od.a())),Tc.add(new nc(Ed.a.instance.Ua(449),Ed.a.instance.Ua(450),Ed.a.instance.ga(1934),()=>{this.nI(2,"FirstEnterExitCalloutContinue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.nI(1,"FirstEnterExitCalloutGuide")},wd.P4e())),Tc.add(new nc(Ed.a.instance.ga(1937),Ed.a.instance.Ua(447),Ed.a.instance.ga(1938),()=>{this.d9f();this.eK();this.nI(1,"LearnMore")},Ed.a.instance.ga(1939),()=>{this.eK();
this.nI(1,"Done")},wd.O4e()))):2===jc?Tc.add(new nc(Ed.a.instance.ga(1936),Ed.a.instance.Ua(448),Ed.a.instance.ga(1933),()=>{this.eK();this.nI(1,"EnterTempViewAfterPersistedView")},null,null,od.a())):3===jc&&(Tc.add(new nc(Ed.a.instance.Ua(445),Ed.a.instance.ga(1945),Ed.a.instance.ga(1934),()=>{this.nI(2,"AutoOptInExitCalloutContinue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.nI(1,"AutoOptInExitGuide")},wd.P4e())),Tc.add(new nc(Ed.a.instance.ga(1936),Ed.a.instance.Ua(448),Ed.a.instance.ga(1934),
()=>{this.nI(2,"Continue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.nI(1,"ExitGuide")},od.a())),Tc.add(new nc(Ed.a.instance.ga(1937),Ed.a.instance.Ua(447),Ed.a.instance.ga(1938),()=>{this.d9f();this.eK();this.nI(1,"LearnMore")},Ed.a.instance.ga(1939),()=>{this.eK();this.nI(1,"Done")},wd.O4e())));this.MYd=new Lc(Tc)}d9f(){const jc=new Kb.a(-859308420,pd.a.Db,this.$.Hc,9,null);this.$.Ja.Lb(jc,{[pd.a.og]:"HelpID=SheetViews",["InputMethod"]:pd.a.Db,[pd.a.Jc]:Zc.a.wV,["ShouldCanvasTakeFocus"]:!0})}show(jc){this.lei(jc);
this.Leb()}hxj(jc){this.g1b=jc}Leb(){var jc=this.MYd.x7i;if(jc){var Tc=Object(Ze.a)(new hf.a,{label:jc.Z5i,onExecute:jc.primaryButtonAction}),ub=null;jc.f1f&&(ub=Object(Ze.a)(new hf.a,{label:jc.f1f,onExecute:jc.secondaryButtonAction}));jc=Object(Ze.a)(new bb.a,{target:jc.targetObject,content:jc.body,title:jc.title,showCloseIcon:!0,primaryButtonProps:Tc,secondaryButtonProps:ub,useTeachingStyles:!0});jc=this.g1b.callout(jc);Tc=Object(Ze.a)(new Lb.a,{onShow:()=>{this.nI(0)}});this.PBc=this.g1b.addNotification(jc,
Tc)}}dismiss(){this.eK();this.nI(1,"DismissedByOthers")}eK(jc=!1){this.PBc&&(this.g1b.removeNotification(this.PBc),this.PBc=null);jc&&this.Leb()}nI(jc,Tc=null){const ub={};ub.a=this.$.va.UserSessionId;ub.b=this.Wcg;ub.c=this.MYd.Vcg;ub.d=jc;ub.e=Tc;0===jc?this.stopwatch=this.$.Kb.Bc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),ub.f=this.stopwatch.Ac,this.stopwatch=null),2===jc&&(this.stopwatch=this.$.Kb.Bc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));
pf.b().Qe(52,ub,!0)}static O4e(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static P4e(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static Kmi(jc){return 0===jc||1===jc}}Object(b.a)(wd,"NamedSheetViewTeachingCallout",null,[497]);class Pd extends Jb.a{constructor(jc){super();this.$=jc;this.Fb()}create(){let jc=this.$.da.Aa(322);jc||(jc=new wd(this.$),this.$.da.Ga(322,jc));this.nb(jc)}static la(jc){jc.da.Ga(323,new Pd(jc))}}Object(b.a)(Pd,
"NamedSheetViewTeachingCalloutFactory",Jb.a,[]);var je=a(1250),be=a(1142),Qe=a(1249);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");
Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Ei(new N);Object(ea.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(Ca.a)();Object(la.a)();Object(Ra.a)();Object(lb.a)();Type.registerNamespace("Common.App.SharedFilePicker");aa.main();Type.registerNamespace("Common.App.WildFire");ka.main();Object(Pa.a)();Fa.a.Fa(Va.la);Object(fb.a)();Object(Ka.a)();Object(hb.a)();
fc.a.Ni(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Fa.a.Fa(jc=>{db.la(jc)})})();(()=>{Fa.a.Fa(jc=>{jc.da.Ga(165,new Pb(jc))})})();Fa.a.Fa(Ma.la);Object(ob.a)();Object(Ia.a)();Object(Da.a)();Object(nb.a)();Object(Ua.a)();Object(W.a)();Object(sa.a)();Object(vb.a)();Object(gc.a)();Object(Bc.a)();Object(Qe.a)();Fa.a.Fa(Qb.la);Fa.a.Fa(id.la);
Object(Dd.a)();Fa.a.Fa(bc.la);(()=>{Fa.a.Fa(jc=>{xe.la(jc);Pd.la(jc)})})();Object(je.a)();Object(be.a)()},707:function(u,F,a){a.d(F,"a",function(){return V});u=a(0);var c=a(7),b=a(15),e=a(89),f=a(224),d=a(14),h=a(108),n=a(173),m=a(4),x=a(85);F=a(238);var r=a(1057),y=a(19),t=a(5),v=a(326),w=a(52),C=a(12),B=a(71),z=a(13),A=a(21),E=a(88),I=a(900),L=a(1);class V extends F.a{constructor(T,H){super(document.createElement("div"));this.Upf=this.Dte=this.One=this.v4b=this.nca=this.C8=this.pP=this.oz=null;
this.Bwa=this.tV=this.zs=this.hideCloseButton=!1;this.dNi=D=>{this.KD(D)};this.jNi=D=>{13===D.keyCode&&this.KD(D)};this.eCd=D=>{this.Zm(D.tb);return!0};this.jCd=D=>{this.dW(D.tb);return!0};this.Hpc=D=>{this.Ema(D.tb?D.tb:0);return!0};this.eNi=D=>{this.KD(D.Ca);return!0};this.mpg=(D=null)=>{this.Zm(D.inputMethod?D.inputMethod:0);return!0};this.npg=(D=null)=>{this.dW(D.inputMethod?D.inputMethod:0);return!0};this.L1=T;this.pD=H;this.VZc=H.n0a.toString();this.title=H.title;this.message=H.message;this.set_visibilityMode(1)}get MYg(){return this.pD.n0a}get businessBar(){return this.L1}get actionButton(){return this.pD?
this.pD.actionButton:""}get ysa(){return this.pD?this.pD.ysa:""}get linkText(){return this.pD?this.pD.link:""}get Ek(){return this.pD?this.pD.Ek:""}get alt(){return this.pD?this.pD.alt:""}aBa(T){this.pD.M2b=T}dispose(){e.a.rc([this.v4b,this.pP,this.C8]);this.zs&&this.pP&&(f.a.instance.Ba(d.a.click,this.pP.domElement,this.eCd),h.KeyInputManager.instance.Tv(this.domElement,this.One));this.tV&&this.C8&&(f.a.instance.Ba(d.a.click,this.C8.domElement,this.jCd),h.KeyInputManager.instance.Tv(this.domElement,
this.Dte));this.Bwa&&this.nca&&(f.a.instance.Ba(d.a.click,this.nca,this.Hpc),h.KeyInputManager.instance.Tv(this.domElement,this.Upf));this.nca=this.oz=this.L1=this.C8=this.pP=null;super.dispose()}update(){}vWj(){this.IIe(!0)}A5c(){this.IIe(!1)}Heh(){this.message=E.a.If(this.message);this.title=E.a.If(this.title);n.UISurfaces.Ehd().then(T=>{T.initializeMessageBarInStore();let H=Object(c.a)(new I.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.pD.M2b,dismissButtonAriaLabel:z.a.instance.ga(10)});
this.hideCloseButton||(H.onDismiss=this.eNi);this.Bwa&&(H.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Hpc});this.zs&&(H.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.mpg});this.tV&&(H.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.ysa,["onExecute"]:this.npg});T.createNewMessageBar(this.domElement,H);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});
m.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}Rdh(T){T||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var H=this.businessBar.$.Eb;T=H+"ewaBusinessBarEntryBody"+this.VZc;const D=H+"ewaBusinessBarEntryTitle"+
this.VZc;var G=H+"ewaBusinessBarEntryIcon"+this.VZc;this.domElement.className=r.a.ath;if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:7409767_BizBarUpdateReduceInnerHtml")){C.DOMElementExtensions.QJ(this.domElement);H=document.createElement("div");H.className=r.a.XQe;H.id=T;var J=document.createElement("div");J.className=r.a.WQe;var M=document.createElement("a");M.className=r.a.cRe;M.title=this.alt;const Q=document.createElement("span");Q.classList.add(y.a.Crb);Q.classList.add(r.a.ZQe);Q.id=G;this.Ek.length&&
(G=document.createElement("img"),G.classList.add(this.Ek),G.src=w.a.me(0),Q.appendChild(G));M.appendChild(Q);J.appendChild(M);G=document.createElement("span");G.classList.add(r.a.bRe);G.id=D;G.innerText=E.a.If(this.title);J.appendChild(G);G=document.createElement("span");G.classList.add(r.a.aRe);G.id="message";G.innerText=E.a.If(this.message);J.appendChild(G);G=document.createElement("a");G.id="link";G.href="#";G.className=r.a.$Qe;G.innerText=E.a.If(this.linkText);J.appendChild(G);G=document.createElement("span");
G.classList.add(r.a.Y9b);M=document.createElement("button");M.type="button";M.id="action";M.className=r.a.X9b;M.innerText=E.a.If(this.actionButton);G.appendChild(M);J.appendChild(G);G=document.createElement("span");G.classList.add(r.a.Y9b);M=document.createElement("button");M.type="button";M.id="altAction";M.className=r.a.X9b;M.innerText=E.a.If(this.ysa);G.appendChild(M);J.appendChild(G);H.appendChild(J);J=document.createElement("a");J.className=r.a.YQe;J.tabIndex=0;J.setAttribute("role","button");
G=document.createElement("span");G.id="close";G.classList.add(y.a.zt);M=document.createElement("img");M.classList.add(y.a.avb);M.src=w.a.me(13);M.alt=z.a.instance.ga(793);M.title=z.a.instance.ga(793);M.setAttribute("role","button");G.appendChild(M);J.appendChild(G);H.appendChild(J);this.domElement.appendChild(H)}else H="<div class='"+r.a.XQe+"' id='{0}'><div class='"+r.a.WQe+"'><a class='"+r.a.cRe+"' title='{1}'><span class='"+y.a.Crb+" "+r.a.ZQe+"' id='{2}'>",this.Ek.length&&(H+="<img class='{3}' src='{4}'/>"),
H+="</span></a><span class='"+r.a.bRe+"' id='{5}'>{6}</span><span class='"+r.a.aRe+"' id='message'>{7}</span><a id='link' href='#' class='"+r.a.$Qe+"'>{8}</a><span class='"+r.a.Y9b+"'><button type='button' id='action' class='"+r.a.X9b+"'>{9}</button></span><span class='"+r.a.Y9b+"'><button type='button' id='altAction' class='"+r.a.X9b+"'>{10}</button></span></div><a class='"+r.a.YQe+"' tabindex='0' role='button'><span id='close' class='"+y.a.zt+"'><img class='"+y.a.avb+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",
this.domElement.innerHTML=String.format(H,T,this.alt,G,this.Ek,w.a.me(0),D,this.title,this.message,this.linkText,this.actionButton,this.ysa,w.a.me(13),z.a.instance.ga(793));C.DOMElementExtensions.Pu(this.domElement,t.a.Hsa,D,T);this.nca=$get("link",this.domElement);C.DOMElementExtensions.setVisible(this.nca,this.Bwa);this.Bwa&&(f.a.instance.sa(d.a.click,this.nca,this.Hpc),this.Upf=h.KeyInputManager.instance.Ns(this.nca,this.Hpc,x.a.Mh,x.a.GX));this.pP=new v.a(C.DOMElementExtensions.getElementById(this.domElement,
"action"));this.pP.isVisible=this.zs;this.C8=new v.a(C.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.C8.isVisible=this.tV;this.zs&&(f.a.instance.sa(d.a.click,this.pP.domElement,this.eCd),this.One=h.KeyInputManager.instance.Ns(this.pP.domElement,this.eCd,x.a.Mh,x.a.GX),this.tV&&(f.a.instance.sa(d.a.click,this.C8.domElement,this.jCd),this.Dte=h.KeyInputManager.instance.Ns(this.pP.domElement,this.jCd,x.a.Mh,x.a.GX)));this.oz=$get("close",this.domElement);this.v4b=this.Ce.$d(this.oz);
this.v4b.la("click",this.dNi);this.v4b.la("keydown",this.jNi);C.DOMElementExtensions.setVisible(this.oz,!this.hideCloseButton)}IIe(T){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&m.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.Heh():this.Rdh(T)}Zm(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.pD.S$c}`);A.h(this.businessBar.$).To(!0)}dW(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnAltActionClick()`);
A.h(this.businessBar.$).To(!0)}Ema(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnLinkClick()`);A.h(this.businessBar.$).To(!0)}KD(T){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.pD.S$c}`);this.set_visible(!1);this.businessBar.removeEntry(this.MYg);B.g(T)}rK(){return L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&m.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?
this.domElement.getElementsByTagName("button")[0]:this.pP.domElement}}Object(u.a)(V,"BusinessBarEntry",F.a,[])},784:function(u,F,a){a.r(F);u=a(0);var c=a(7),b=a(15),e=a(4);a(27);var f=a(386),d=a(38),h=a(49),n=a(12),m=a(127),x=a(1),r=a(13),y=a(21);class t extends Sys.EventArgs{constructor(G){super();this.d6i=G}}Object(u.a)(t,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var v=a(259),w=a(247);class C{constructor(G){this.vg=G}di(){v.a(this.vg.$).qB(this.de)||v.a(this.vg.$).di(this)}p8(){v.a(this.vg.$).qB(this.de)&&
v.a(this.vg.$).Zz(this)}get de(){return w.a.pOf}get mc(){const {PrintPreviewPane:G}=a(784);return document.getElementById(G.b6i)}get Hf(){return!0}mh(G){return n.DOMElementExtensions.Af(this.mc,G)}sj(){this.vg.$.frame.Me.vk(this.vg.$.frame.Me.pF)}dk(){}kg(G,J){return J?!1:(this.vg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(u.a)(C,"PrintPreviewHeaderKeyboardAccessibleSection",null,[34]);class B{constructor(G){this.vg=G}di(){v.a(this.vg.$).qB(this.de)||v.a(this.vg.$).di(this)}p8(){v.a(this.vg.$).qB(this.de)&&
v.a(this.vg.$).Zz(this)}get de(){return w.a.qOf}get mc(){const {PrintPreviewPane:G}=a(784);return this.vg.useMSPdfViewer?document.getElementById(a(784).PrintPreviewPane.iGd):document.getElementById(G.MLf)}get Hf(){return!0}mh(G){return n.DOMElementExtensions.Af(this.mc,G)}sj(){this.vg.$.frame.Me.vk(this.vg.$.frame.Me.pF)}dk(){}kg(G,J){return J?!1:(this.vg.useMSPdfViewer?(G=document.getElementById(a(784).PrintPreviewPane.iGd))&&n.DOMElementExtensions.setFocus(G,!0):n.DOMElementExtensions.setFocus(this.vg.kL),
!0)}}Object(u.a)(B,"PrintPreviewKeyboardAccessibleSection",null,[34]);class z{constructor(G){this.vg=G}di(){v.a(this.vg.$).qB(this.de)||v.a(this.vg.$).di(this)}p8(){v.a(this.vg.$).qB(this.de)&&v.a(this.vg.$).Zz(this)}get de(){return w.a.sOf}get mc(){const {PrintPreviewPane:G}=a(784);return document.getElementById(G.mId)}get Hf(){return!0}mh(G){return n.DOMElementExtensions.Af(this.mc,G)}sj(){this.vg.$.frame.Me.vk(this.vg.$.frame.Me.pF)}dk(){}kg(G,J){return J?!1:(this.vg.enterPrintSettingsTaskPaneFocusTrapZone(),
!0)}}Object(u.a)(z,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[34]);class A{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(u.a)(A,"MSPdfViewerFileUrl",null,[]);class E{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=
!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(u.a)(E,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(u.a)(I,"ViewerPaneProps",null,[]);var L=a(1078),V=a(381),T=a(5);class H{}H.printDialogTitle="PrintDialogTitle";H.$9b="ewa-dlg-elements-container-rtl";H.Zw="PrintPreviewerContainer";Object(u.a)(H,"CssClassNames",null,[]);a.d(F,"PrintPreviewPane",function(){return D});
class D extends d.a{constructor(G,J,M,Q){super();this.HDb=this.Nlc=this.kL=this.DIb=this.Zw=this.qW=this.YD=this.gG=null;this.GDb=!1;this.sxa=!0;this.nId=this.jId=this.kId=this.ewaAccessibilityManager=this.Hrc=null;this.lqd=!1;this.YDf=()=>{b.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.GDb}`);this.GDb&&(this.Qai(),this.kL.style.visibility="visible",this.Nlc?this.Nlc.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),
this.raiseEvent(D.tFb,new t(1)),this.QRd(),this.GDb=!1)};this.$=G;this.XD=J;this.teh();this.useMSPdfViewer=M;this.isUniversalPrintEnabled=Q;this.aI=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);this.isExportPdfMode=!1}xMg(G){this.addHandler(D.tFb,G)}Ghj(G){this.removeHandler(D.tFb,G)}MGj(G){this.isExportPdfMode=G;this.oeh()}NGj(){var G=this.$.Kb.Bc("UserAction","createSettingsPaneStopwatch");const J=document.getElementById(D.mId);this.veh();const M=this.weh();this.YD.createPrintSettingsTaskPane(J,
M);G.stop();this.GDb=!1;if(this.isUniversalPrintEnabled&&this.Zw){G="A4";switch(M.selectedPrintSettingsValues.selectedPaperSize){case 8:G="A3";break;case 9:G="A4";break;case 11:G="A5";break;case 12:G="JIS B4";break;case 13:G="JIS B5";break;case 5:G="North America Legal";break;case 1:G="North America Letter";break;case 6:G="North America Invoice";break;case 7:G="North America Executive";break;case 3:G="North America Ledger"}this.gG.setDocumentSettings({mediaSize:G,orientation:2===M.selectedPrintSettingsValues.selectedOrientation?
"landscape":"portrait",colorMode:1===M.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.bLd()}setPageRangeSettings(G,J,M,Q,U){this.YD&&(this.YD.setPageRangeSettings(G,J,M,Q,U),this.P4f(String.format(r.a.instance.mb(205),Q,U,G)))}Fai(){this.Zw&&(this.Zw.style.display="none")}gnh(){this.dispose();this.v0d();this.nUj();this.gG&&this.gG.closePrintPreviewPane();this.qW=this.YD=this.gG=this.Zw=null}uyi(G){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();
this.useMSPdfViewer?((this.HDb=this.$.Kb.Bc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.qW.renderPdf(G)):this.kL&&((this.Nlc=this.$.Kb.Bc("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.GDb=!0,this.kL.src&&this.kL.src===G?this.YDf(null):this.kL.src=G);if(this.aI&&this.Zw){const J=V.b(this.$.workbookContext);
this.gG.setFileUrl(G,J)}}onPdfLoad(){this.HDb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.HDb.Ac} ms, isFirstTimeLoad: ${this.sxa}`),this.HDb.stop()):b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(D.tFb,new t(1));this.hideWaitCursor();this.QRd()}printPdf(){n.DOMElementExtensions.setFocus(this.kL);this.kL.contentWindow.print()}CHj(){this.showSpinner();this.showWaitCursor();this.P4f("")}Qai(){this.hideSpinner();
this.hideWaitCursor()}gA(G,J,M=null){this.Zw&&this.qW&&(this.lqd=!1,this.qW.showErrorDetails(J,G,M),this.XD.i7a=!0,this.kL&&(this.kL.src=""),this.disablePrintButton(),this.hideWaitCursor(),D.Qpi(J)&&(this.lqd=!0,this.WUi()))}hidePreviewError(){this.XD.i7a=!1;this.qW.hidePreviewError();this.enablePrintButton()}Ymh(){(this.DIb=document.getElementById(D.rOf))&&this.DIb.parentNode&&this.DIb.parentNode.removeChild(this.DIb)}hideErrorMessageForPrintOptions(){this.YD&&this.YD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(G){this.YD&&
this.YD.showErrorMessageForPrintOptions(G)}showSpinner(){this.XD.i7a||this.lqd?this.hidePreviewError():this.kL&&(this.kL.style.visibility="hidden");this.qW&&this.qW.showSpinner()}hideSpinner(){this.qW&&this.qW.hideSpinner()}enablePrintButton(){this.YD&&this.YD.enablePrintButton();this.aI&&this.Zw&&this.gG.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.YD&&this.YD.disablePrintButton();this.aI&&this.Zw&&this.gG.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.YD&&this.YD.showWaitCursor();
this.aI&&this.Zw&&this.gG.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.YD&&this.YD.hideWaitCursor();this.aI&&this.Zw&&this.gG.updatePrintButtonEnableDisableState(!0)}reh(){if(this.Zw)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Zw=document.createElement("div"),this.Zw.id=D.rOf,this.Zw.classList.add(D.e6i),this.$.vr.insertBefore(this.Zw,this.$.vr.firstChild),e.AFrameworkApplication.ta&&e.AFrameworkApplication.ta.Pa.Ve){const G=
document.getElementById(T.a.Csa);G&&(this.Zw.style.top=`${G.clientHeight}px`,this.Zw.style.height=`calc(100vh - ${G.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.gG.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.gG.enterPrintSettingsTaskPaneFocusTrapZone()}Q3i(){this.$.da.$a(15,G=>{this.ewaAccessibilityManager=G;this.ewaAccessibilityManager.mode=3})}teh(){this.nId=new z(this);this.kId=new B(this);this.jId=new C(this)}bLd(){this.nId.di();this.kId.di();
this.jId.di();this.Q3i()}v0d(){this.nId.p8();this.kId.p8();this.jId.p8();y.h(this.$).U0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}vO(){this.Hrc=m.a.instance.$d(this.kL);this.Hrc.la("load",this.YDf)}nUj(){this.Hrc&&this.kL&&this.Hrc.detach("load")}QRd(){this.aI?this.U3f(D.c6i,D.GIi):this.U3f(D.mId,D.lOf)}U3f(G,J){this.sxa&&(G=document.getElementById(G))&&(J=n.DOMElementExtensions.getElementById(G,J))&&(this.sxa=!1,J.focus())}WUi(){this.XD.i7a=!1;this.enablePrintButton();
this.QRd()}oeh(){const G=h.GetServiceTaskFactory.Oa(this.$.da,283,284,0).result.kn;G.loadScript("excel-print-preview-sprite").then(()=>{G.loadScript("printPreviewer").then(()=>{G.loadScript("excelPrintPreviewer").then(()=>{this.ueh()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{b.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}ueh(){const G=
this.$.Kb.Bc("UserAction","createEmptyPreviewerStopwatch");this.reh();this.seh();this.aI?this.gG.createEmptyPrintPreviewPaneAsync(this.Zw,this.OIe()).then(()=>{G.stop();this.EFe();this.gG.updatePrintButtonEnableDisableState(!1)}):(this.gG.createEmptyPrintPreviewPane(this.Zw,this.OIe()),G.stop(),this.EFe())}EFe(){const G=this.$.Kb.Bc("UserAction","createPdfPreviewPaneStopwatch"),J=document.getElementById(D.iGd);this.useMSPdfViewer&&(J.tabIndex=0);this.aeh();this.$dh(J);G.stop();this.raiseEvent(D.tFb,
new t(0))}seh(){this.gG||(this.gG=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.gG||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}veh(){this.YD||(this.YD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.YD||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}aeh(){this.qW||
(this.qW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.qW||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}$dh(G){this.qW.createPrintPreviewPane(G,this.Fgh());this.useMSPdfViewer||(this.kL=n.DOMElementExtensions.getElementById(this.Zw,D.MLf),this.kL.title=r.a.instance.ga(1208),this.vO())}weh(){let G,J="en-US";G=this.$.va.IsMetricMeasurementUnit;this.$.va.DataCultureTag?
J=this.$.va.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new E,{whatToPrintOptions:this.XD.Lv.whatToPrintOptions,orientationOptions:this.XD.Lv.orientationOptions,paperSizeOptions:this.XD.Lv.paperSizeOptions,scalingOptions:this.XD.Lv.scalingOptions,marginDetailedOptions:this.XD.bXh(),selectedPrintSettingsValues:this.XD.ZZh(),printSettingsTaskPaneCallbacks:this.XD.XZh(),
logger:new f.a,shouldDisableCurrentSelection:this.XD.$6f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:G,dataCultureTag:J,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}OIe(){return this.aI?this.XD.VZh():Object(c.a)(new L.a,{backActionButtonText:r.a.instance.ga(1206),printPreviewPaneCallbacks:this.XD.$5e(),logger:new f.a,disableTellMeControl:!0,isExportPdfMode:!1})}Fgh(){return this.useMSPdfViewer?Object(c.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.ndh(),onPdfLoad:()=>
{this.onPdfLoad()}}):Object(c.a)(new I,{useMSPdfViewer:!1})}ndh(){return Object(c.a)(new A,{pdfViewerWorkerUrl:this.$.va.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.va.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.va.PrintPreviewerMSPdfKitWasmUrl})}P4f(G){this.Zw&&this.gG.setAdditionalHeaderText(G)}static Qpi(G){return 3===G||2===G}}D.rOf="PrintPreviewerContainer";D.mId="printSettingsTaskPaneId";D.iGd="previewId";D.MLf="printpreviewiframe";D.b6i="printPreviewHeaderId";D.lOf="printButton";
D.c6i="printPreviewPaneId";D.GIi="printButtonId";D.e6i=H.Zw;D.tFb="pppnosu";Object(u.a)(D,"PrintPreviewPane",d.a,[654])},837:function(u,F,a){a.d(F,"a",function(){return d});u=a(0);var c=a(15),b=a(4),e=a(39),f=a(27);class d{static i0e(h,n){switch(h){case 3:return d.g5h(n);case 2:return d.UYh(n);case 1:return d.cTh(n)}return""}static g5h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static UYh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static cTh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,n,m){if(f.a.$g||f.a.Ap)window.setTimeout(()=>{d.ySf(m,d.eec())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.sue(m),h,0,!1)}static j4g(h,n,m,x){n&&
x&&x();d.openInClient(h,n,m)}static eec(){return f.a.$g?1:f.a.Ap?2:f.a.K8a?3:f.a.isMac?4:0}static c5h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static d5h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get gBb(){return"zh-CN"===window.navigator.language}static ySf(h,n){1===n?(c.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),h=d.i0e(h,n),8<f.a.p6a?e.a.lf(h,void 0,void 0,"RedirectToAppStore"):e.a.dV(h)):document.hidden||(d.gBb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.dV(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.i0e(h,
n),null,null)))}static sue(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Gzc(){return(f.a.K8a||f.a.isMac)&&f.a.Bp}static get RDj(){return f.a.$g||f.a.Ap}static mfd(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Crd(h){return(h=d.ZVh(h))&&""!==h?Boolean.parse(h):!1}static NSd(h){d.Fwj(h)}static ZVh(h){try{return localStorage.getItem(h)}catch(n){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+n.message),null}}static Fwj(h){try{localStorage.setItem(h,"true")}catch(n){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+n.message)}}}d.wCe="ChromeExtensionBarDismiss";Object(u.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/0b6b349d1238a2e3b18a6fe6f19a303c/EwaDSEsNext.kmhv.js.map