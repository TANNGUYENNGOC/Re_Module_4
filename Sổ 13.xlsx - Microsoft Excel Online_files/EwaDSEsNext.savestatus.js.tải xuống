'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1200:function(u,F,a){u=a(0);var c=a(84),b=a(15),e=a(137),f=a(39);class d{constructor(z){this.sga=this.mga=this.wga=this.vga=null;this.bae=this.ude=this.tx=this.mM=!1;this.LRc=this.Kde=null;this.Cde=0;this.ob=this.Ide=null;this.Z1=z;this.tA=3;this.fkb=!0}initialize(z,A,E){this.vga=this.Nid(z,A);this.wga=CommonUIStrings.l_SavingStatus;this.mga=CommonUIStrings.l_ReadOnlyStatus;this.sga=CommonUIStrings.l_ReviewModeStatus;
this.Z1&&this.Z1.execute(I=>{I.pXc(Object(c.a)(this,this.MQb,"updateToSavingStatus"))});this.tx=!0;this.ob=E;return!0}Vea(z,A){this.mM=z;this.tA=A;this.IS(this.fkb)}IS(z){!this.fkb&&z&&(this.Ide=new Date);this.fkb=z;z=null;3===this.tA&&(z=this.fkb?this.vga:this.wga);this.zmh(z)}Nid(z,A){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}MQb(){this.IS(!1)}pXh(){switch(this.tA){case 1:return this.mga;
case 2:return this.sga;default:return null}}Oli(z){return this.ude===this.mM&&this.Cde===this.tA&&this.Kde===z}O8c(z){appChrome.getHeaderApi().then(A=>{A.updateDocumentTitleStatus(this.mM,z,this.pXh(),this.Ide,this.fkb);this.bae=!0;return null});this.LRc=null}zmh(z){this.tx&&e.c()&&!this.Oli(z)&&(!this.bae&&this.ob.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.O8c(z):f.a.VXf()?(this.LRc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.LRc=window.requestIdleCallback(()=>{this.O8c(z)})):window.requestAnimationFrame(()=>{this.O8c(z)}),this.ude=this.mM,this.Kde=z,this.Cde=this.tA)}}Object(u.a)(d,"ReactSaveStatusUIHandler",null,[502]);var h=a(164);class n{constructor(z,A){this.Cs=null;this.vga=CommonUIStrings.l_SavedStatus;this.wga=CommonUIStrings.l_SavingStatus;this.mga=CommonUIStrings.l_ReadOnlyStatus;this.sga=CommonUIStrings.l_ReviewModeStatus;this.QUb=A;this.Z1=z;this.tA=3;this.Cra=!0}Qs(){this.Z1&&this.Z1.execute(z=>{z.pXc(Object(c.a)(this,
this.MQb,"updateToSavingStatus"))});this.QUb.execute(z=>{this.Cs=z})}Vea(z,A){this.tA=A;3===A?this.IS(this.Cra):2===A?this.a0d(this.sga):this.a0d(this.mga)}MQb(){this.IS(!1)}IS(z){this.Cra=z;this.a0d(this.Cra?this.vga:this.wga)}a0d(z){this.Cs&&this.Cs.Rj(h.a.cUj,this.Z7g(z))}Z7g(z){const A={};A.StatusText=z;return A}}Object(u.a)(n,"SaveStatusPostMessageHandler",null,[502]);var m=a(94),x=a(123),r=a(56);class y{constructor(z,A,E,I){this.sga=this.mga=this.wga=this.vga=null;this.VEa=0;this.DE=this.xSc=
this.iDa=this.cHc=this.TFa=null;this.Md=z;this.i9=A;this.Z1=E;this.oj=I;this.Pbe=!0;this.mM=!1;this.tA=3;this.Cra=!0}initialize(z,A){if(!this.Md)return!1;this.vga=this.Nid(z,A);this.wga=CommonUIStrings.l_SavingStatus;this.mga=CommonUIStrings.l_ReadOnlyStatus;this.sga=CommonUIStrings.l_ReviewModeStatus;this.Qs();return!0}Nid(z,A){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}Qs(){this.i9&&
this.i9.execute(z=>{z.UMg(Object(c.a)(this,this.lJe,"createStatusAndModeElements"));z.LMg(Object(c.a)(this,this.UFj,"showHideSaveStatusElement"));z.PQj&&this.lJe(null,null)});this.Z1&&this.Z1.execute(z=>{z.pXc(Object(c.a)(this,this.MQb,"updateToSavingStatus"))})}Uv(){this.DE&&this.Md&&this.Md.HG(this.DE)}UFj(z,A){this.Vea("true"===A,this.tA)}Vea(z,A){this.mM=z;this.tA=A;this.cHc&&(this.cHc.style.display=this.mM||3===this.tA||!this.TFa?"none":"");this.iDa&&(this.iDa.style.display=this.mM||3===this.tA?
"none":"",this.iDa.innerText=1===this.tA?this.mga:this.sga,this.iDa.title=1===this.tA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.xSc&&(this.xSc.style.display=this.mM||1===this.tA||!this.TFa&&!this.iDa?"none":"");this.DE&&(this.DE.style.display=this.mM||1===this.tA?"none":"",this.IS(this.Cra),this.DE.title=CommonUIStrings.l_SaveStatusTooltip)}lJe(z,A){z=document.getElementById(m.CuiHelper.qbf);A&&A.$2j||!z||""===this.vga||""===this.wga||""===this.mga||""===
this.sga||(this.TFa=document.getElementById(m.CuiHelper.A2b),this.cHc=m.CuiHelper.Hta(z,"BreadcrumbAppModeDash","-",null,!1),this.iDa=m.CuiHelper.Hta(z,"BreadcrumbAppModeStatus",1===this.tA?this.mga:this.sga,null,!1),this.pig(this.iDa),this.xSc=m.CuiHelper.Hta(z,"BreadcrumbSaveStatusDash","-",null,!1),this.DE=m.CuiHelper.Hta(z,"BreadcrumbSaveStatus",this.vga,null,!1),this.pig(this.DE),this.Vea(this.mM,this.tA))}MQb(){this.IS(!1)}IS(z){this.Cra=z;this.lZj(this.Cra?this.vga:this.wga)}lZj(z){!this.DE||
3!==this.tA&&2!==this.tA||(this.Pbe&&!this.Cra?(this.VEa=this.DE.offsetWidth<this.VEa?this.VEa:this.DE.offsetWidth,this.fWj(this.wga),this.Pbe=!1):this.DE.innerText=z)}pig(z){z.style.direction=this.oj?"rtl":"ltr";z.style.width="auto";z.style.textAlign=this.oj?"right":"left";z.style.display=this.mM?"none":"";z.setAttribute("Unselectable","on")}fWj(z){this.DE&&(this.DE.style.width="",this.DE.innerText=z,this.VEa=this.DE.offsetWidth<this.VEa?this.VEa:this.DE.offsetWidth,z=x.a.mB(this.DE),this.DE.style.width=
this.VEa-r.a.RD(z.paddingLeft)-r.a.RD(z.paddingRight)+1+"px")}}Object(u.a)(y,"SaveStatusUIHandler",null,[502]);var t=a(4),v=a(93);class w{constructor(){this.ySc=this.yRc=this.wmb=this.gb=null}get name(){return"Common.App.SaveStatus"}Xh(z){this.gb=z;t.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&t.AFrameworkApplication.hideHeaderEmbedded?this.gb.register(n,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new n(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),
this.gb.Ub("Postmessage.IHostPostmessenger"))):t.AFrameworkApplication.ta.Pa.umf||(t.AFrameworkApplication.ta.Pa.Gs?this.gb.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new d(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"))):this.gb.register(y,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new y(v.EventHandlerManager.instance,this.gb.Ub("Common.App.Header.HeaderEventSource"),
this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),t.AFrameworkApplication.isRtl)))}init(){t.AFrameworkApplication.fa.Ev(Object(c.a)(this,this.JB,"onFullAppSettingsReady"))}JB(){const z=t.AFrameworkApplication.fa,A=!!t.AFrameworkApplication.ta.Pa&&4===t.AFrameworkApplication.ta.Pa.Hj;if(z.qa("WordEditorAutoSaveImprovementIsEnabled")||z.qa("PptEditorSaveStatusInHeaderEnabled")||A&&z.qa("SimplifiedReactRibbonUxIsEnabled")||z.qa("ExcelSaveStatusInHeaderEnabled")||z.qa("VisioSaveStatusInHeaderEnabled"))t.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
t.AFrameworkApplication.hideHeaderEmbedded?(this.ySc=this.gb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.ySc.Qs():t.AFrameworkApplication.ta.Pa.umf||(t.AFrameworkApplication.ta.Pa.Gs?(this.yRc=this.gb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.yRc.initialize(z.qa("IsSkyDrive"),z.Xa("HostNameToIncludeInSavedStatus"),t.AFrameworkApplication.fa):(this.wmb=this.gb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.wmb.initialize(z.qa("IsSkyDrive"),
z.Xa("HostNameToIncludeInSavedStatus")))}dispose(){this.wmb&&this.wmb.Uv()}}Object(u.a)(w,"PackageManager",null,[3,4]);var C=a(248);a.d(F,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.SaveStatus");C.a.instance.Ei(new w)}},1256:function(u,F,a){var c=a(9);u=a(0);var b=a(82),e=a(222),f=a(226),d=a(29),h=a(21);class n{constructor(y,t){this.Aje=this.NMc=!1;this.wza=(v,w)=>{(null===w||void 0===w?0:w.yH)&&d.a.ORg([w.yH])&&(this.ELb=!0)};this.No=()=>{this.ELb=!1};this.Tc=(v,w)=>
{f.b(w)&&this.Vea(!0);this.ELb=!1};this.ed=()=>{this.AN=this.$.AN;this.Vea()};this.nHf=()=>{this.IS()};this.qGf=()=>{this.AN=this.$.AN};this.zCd=()=>{h.h(this.$).Da.ex(this.zCd);this.AN=this.$.AN};this.c0f=t;this.$=y;this.$.userOperationManager.ur(this.qGf);this.$.ll(this.ed);this.$.ea.sNg(this.nHf);this.$.ea.Wj(this.Tc);this.$.m0b(this.wza);this.$.ea.zM(this.No);this.Vea()}get gwi(){return this.$.ea?this.$.ea.epf:!1}get AN(){return this.NMc}set AN(y){y?this.NMc=!0:h.h(this.$)&&h.h(this.$).Da&&(h.h(this.$).Da.l5()?
this.NMc=!1:h.h(this.$).Da.hw(this.zCd));this.IS()}get ELb(){return this.Aje}set ELb(y){this.Aje=y;this.IS()}dispose(){this.$&&(this.$.Kl(this.ed),this.$.Yuc(this.wza),this.$.userOperationManager&&this.$.userOperationManager.ko(this.qGf),this.$.ea&&(this.$.ea.rij(this.nHf),this.$.ea.tk(this.Tc),this.$.ea.YR(this.No)),h.h(this.$)&&h.h(this.$).Da&&h.h(this.$).Da.ex(this.zCd))}Vea(y=!1){y=!this.$.isEditMode||y;this.c0f.Vea(y,this.$.isEditMode?3:1);this.IS()}IS(){this.$.isEditMode&&this.c0f.IS(!this.AN&&
!this.gwi&&!this.ELb)}}Object(u.a)(n,"SaveStatusManager",null,[2]);var m=a(697);class x extends e.a{constructor(y){super();this.Lc=y;this.Fb()}create(){const y=b.a.instance;y.Ub("Common.App.SaveStatus.ISaveStatusUIHandler").execute(t=>{const v=new n(this.Lc,t);y.register(n,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").xc().Fc(()=>v);t=Object(m.a)(this.Lc.da,300,()=>y.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.nb(t)})}static la(y){y.da.Ga(299,
new x(y))}}Object(u.a)(x,"SaveStatusFactory",e.a,[]);a.d(F,"a",function(){return r});const r=()=>{c.a.Fa(x.la)}},1401:function(u,F,a){a.r(F);u=a(1200);a=a(1256);Type.registerNamespace("_Ewa");Object(u.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/332d727fc5f8cc170db6d574c78edda4/EwaDSEsNext.savestatus.js.map