'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1143:function(u,F,a){u=a(0);var c=a(84),b=a(553),e=a(15),f=a(134);class d{constructor(Va,fb,Ka){this.sVd=this.tVd=this.uVd=!1;this.JVd=!Va&&!fb;this.KVd=!Va&&!Ka;this.JVd||this.KVd||(this.uVd=!Va,this.tVd=!fb,this.sVd=!Ka)}}Object(u.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(Va,fb,Ka,hb,fc){super();this.TYd=[];this.h2=new d(Va,fb,Ka);this.Ura=hb;this.Lqa=fc;this.Fe=
"RenameDisabledDialog";this.Rb=0;this.pc(1,CommonUIStrings.l_DialogClose);this.dzj();this.hjj()}dzj(){this.h2.JVd?this.WNb(this.Ura?this.Lqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.h2.KVd?this.WNb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.eIg();this.fsa(this.TYd)}WNb(Va){Array.add(this.TYd,Va)}eIg(){const Va=[];this.h2.uVd||Array.add(Va,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.h2.tVd||Array.add(Va,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.h2.sVd||Array.add(Va,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Va.length&&Array.add(this.TYd,Va)}}Object(u.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class n extends h{constructor(Va,fb,Ka,hb,fc){super(Va,fb,Ka,hb,fc)}hjj(){this.DEb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(u.a)(n,"ReactRenameDisabledDialog",h,[]);var m=a(146);class x{static get qg(){return m.a.iq(x.ol,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}x.ol="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(u.a)(x,"RenameDisabledDialogHtml",null,[]);class r extends m.a{constructor(Va,fb,Ka,hb,fc){super();this.h2=new d(Va,fb,Ka);this.Ura=hb;this.Lqa=fc;this.Fe="RenameDisabledDialog";this.Rb=0;this.pc(1,CommonUIStrings.l_DialogClose);this.qg=x.qg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.mX("RenameRow")}X$a(){if(this.h2.JVd){let Va;Va=this.Ura?this.Lqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;r.WNb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Va)}else this.h2.KVd?r.WNb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Pai()}Pai(){this.h2.uVd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.h2.tVd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.h2.sVd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static WNb(Va,fb,Ka){Va.style.display="none";fb.innerText=Ka}}Object(u.a)(r,"RenameDisabledDialog",m.a,[]);var y=a(4),t=a(30),v=a(106),w=a(25);class C{constructor(Va,fb){this.WEa=0;this.La=Va;this.W8=fb}initialize(Va){if(!this.La||!this.W8)return!1;this.WEa=Va;this.Ig();return!0}Ig(){this.La.Nb(w.a.iia,v.a.frame,Object(c.a)(this,this.iia,"commitNewDocumentTitle"))}iia(Va,fb,Ka,hb,fc){if(1===Ka)return this.La.processAction(w.a.renameFile,
1);Va=t.a.Pq(this.W8.sn);fc=(0,fc.getNewDocumentTitle)();fc.length>this.WEa&&(fc=fc.substr(0,this.WEa));if(32!==this.La.Zd(w.a.renameFile,2,fc))return this.FX(Va),8;this.FX(fc);return 32}FX(Va){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Va))}static ohd(){return new C(y.AFrameworkApplication.ub,y.AFrameworkApplication.sm)}}Object(u.a)(C,"ReactRenameUIHandler",null,[523]);var B=a(94),z=a(522),A=a(555),E=a(14),I=a(108),L=a(239),V=a(87),T=a(39),H=a(27),D=a(82);class G{constructor(Va,
fb,Ka,hb,fc,dc,wb,Tb,xb,cb,jb,qa){this._initialized=!1;this._element=null;this.WEa=0;this.JSc=this.hMc=!1;this.La=Va;this.wHc=fb;this.Yd=Ka;this.HA=hb;this.W8=fc;this.Dje=dc;this.VXb=wb;this.sIc=Tb;this.i9=xb;this.lce=cb;this.mXa=jb;this.dNc=qa}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Va,fb,Ka){if(!(this.La&&this.W8&&this.Dje&&this.VXb&&this.sIc&&fb)||0>=Va)return!1;this._element=fb;this._element.title=Ka;this._element.setAttribute(V.a.Ld,V.a.pt);this._element.setAttribute("Unselectable",
"on");this.WEa=Va;this.Qs();return this._initialized=!0}Qs(){this.wHc&&(this.wHc.sa(E.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.wHc.sa(E.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.sa(E.a.Pb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.HA.sa(E.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.HA.sa(E.a.Sf,this._element,Object(c.a)(this,this.Rf,"onPointerUp"))}onBlur(){this.isActive&&!this.hMc&&
(this.lce||this.sIc(this._element),this.aFe(),this.R7c(!1));return this.hMc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Va){return this.isActive?this.kTi(Va):this.lTi(Va)}kTi(Va){let fb=!1;switch(Va.Ca.keyCode){case Sys.UI.Key.enter:this.aFe();this.R7c(this.mXa||this.dNc);fb=!0;break;case Sys.UI.Key.tab:this.lce&&this.sIc(this._element);break;case Sys.UI.Key.esc:this.BOd(),this.R7c(this.mXa||this.dNc),fb=!0}return fb}lTi(Va){let fb=
!1;switch(Va.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.vfg(this.dNc),this.isActive&&this.VXb(this._element),fb=!0}return fb}onPointerDown(){this.isActive||(this.vfg(!1),this.isActive&&(this._element.focus(),this.VXb(this._element),this.JSc=!0));return!1}Rf(){return this.JSc?(this.VXb(this._element),this.JSc=!1,!0):!1}c8a(){return 32===this.La.processAction(w.a.renameFile,1)}aFe(){const Va=t.a.Pq(this.W8.sn);let fb=this._element.innerText.trim();fb.length>this.WEa&&(fb=fb.substr(0,
this.WEa));fb!==Va&&""!==fb?32!==this.La.Zd(w.a.renameFile,2,fb)?this.BOd():this.FX(fb):this.BOd()}BOd(){this.FX(t.a.Pq(this.W8.sn))}FX(Va){this._initialized&&(this._element.innerText=Va,this.Dje())}vfg(Va){this.c8a()?this.isActive||(Va&&(this.hMc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(V.a.Ld,V.a.kZc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,B.CuiHelper.rOe),
this.i9&&this.i9.execute(fb=>{fb.qQf(!0)}),Va&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(w.a.Qeb,2)}R7c(Va){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(V.a.Ld,V.a.pt);Sys.UI.DomElement.removeCssClass(this._element,B.CuiHelper.rOe);this.i9&&this.i9.execute(fb=>{fb.qQf(!1)});Va&&(this._element.blur(),this._element.focus())}static bA(){z.a.bA(y.AFrameworkApplication.isRtl)}static ohd(){return new G(y.AFrameworkApplication.ub,
A.a.instance,I.KeyInputManager.instance,L.a.instance,y.AFrameworkApplication.sm,G.bA,T.a.orj,T.a.S3g,D.a.instance.Ub("Common.App.Header.HeaderEventSource"),H.a.pla,H.a.$g,H.a.Jf)}}Object(u.a)(G,"RenameUIHandler",null,[523]);class J{static get instance(){return y.AFrameworkApplication.ta.Pa.Gs?J.Ma||(J.Ma=C.ohd()):J.Ma||(J.Ma=G.ohd())}}J.Ma=null;Object(u.a)(J,"RenameUIHandlerFactory",null,[]);var M=a(98),Q=a(136);class U{constructor(){this.AIi=this.wIi=this.hhh=null}}Object(u.a)(U,"RenameMruEntryProperties",
null,[]);var Z=a(376),P=a(164),S=a(643),ja;(function(Va){Va[Va.unknown=-1]="unknown";Va[Va.success=0]="success";Va[Va.renameInvalidFileName=1]="renameInvalidFileName";Va[Va.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Va[Va.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Va[Va.permissionDenied=4]="permissionDenied";Va[Va.serverCommunicationFailure=5]="serverCommunicationFailure";Va[Va.fileNameTooLong=6]="fileNameTooLong"})(ja||(ja={}));Object(u.b)("CommonOperationResult",
ja);class X{constructor(Va,fb,Ka,hb,fc,dc,wb,Tb,xb,cb,jb,qa){this.xce=Va;this.La=fb;this.CIc=Ka;this.Zv=hb;this.PEa=fc;this.KEg=dc;this.Ura=wb;this.Eme=Tb;this.oBg=xb;this.Lqa=cb;this.ob=jb;this.nBg=qa}Ig(){y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pa.Gs||this.Vh.Nb(w.a.Szb,v.a.frame,Object(c.a)(this,this.Szb,"initializeRenameUIHandler"));this.Vh.Nb(w.a.Qeb,v.a.frame,Object(c.a)(this,this.Qeb,"showRenameDisabledDialog"));this.Vh.Nb(w.a.renameFile,v.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.Vh.Ne(w.a.fileNameUpdate,v.a.frame,Object(c.a)(this,this.Nbj,"refreshFilename"),64);this.Vh.Ne(w.a.wnc,v.a.frame,Object(c.a)(this,this.wnc,"moveToFolderCompleteByHost"),64);this.Vh.Nb(w.a.iPa,v.a.frame,Object(c.a)(this,this.iPa,"moveToFolder"));(y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||y.AFrameworkApplication.ta&&(y.AFrameworkApplication.fa.qa("PostMessageEmbedded")||y.AFrameworkApplication.fa.qa("IsJsApi"))&&
y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&y.AFrameworkApplication.pV().execute(Va=>{Va.so(P.a.awf);Va.dm(P.a.awf,X.Daj);Va.so(P.a.xcd);Va.dm(P.a.xcd,X.Baj)})}c8a(){return 0===this.nBg.t6e()?32:8}L_j(){return this.qz?this.Ura?this.qz.rNe:this.qz.xwb:!0}Szb(){return J.instance.initialize(y.AFrameworkApplication.iac,y.AFrameworkApplication.D2a,y.AFrameworkApplication.TMd||CommonUIStrings.l_RenameFileTooltip)?32:8}Qeb(){const Va=this.L_j(),
fb=this.KEg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.PEa,fb,Va,this.Ura);y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pa.Iv&&y.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new n(this.PEa,!fb,!Va,this.Ura,this.Lqa()):new r(this.PEa,!fb,!Va,this.Ura,this.Lqa());return 32}renameFile(Va,fb,Ka,hb,fc){if(1===
Ka)return this.c8a();if(!y.AFrameworkApplication.J$b)return 8;if(8===this.c8a())return this.Vh.processAction(w.a.Qeb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");y.AFrameworkApplication.J$b(fc,Object(c.a)(this,this.LGb,"onRenameFileSuccess"),Object(c.a)(this,this.OVi,"onRenameFileFailure"));return 32}LGb(Va,fb){Va?0!==Va.OperationResult?this.h$e(Va.OperationResult):(this.Asj(fb,Va.NewName),this.gWj(Va,Object(c.a)(y.AFrameworkApplication.ta.Pa,y.AFrameworkApplication.ta.Pa.Yig,"updateOpenInClientDocumentUrl")),
y.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&y.AFrameworkApplication.ta.updateCommandUI(),this.oBg.Bhg()):this.h$e(5)}Asj(Va,fb){const Ka={};Ka[Z.a.PEh]=fb;Va.Rj(P.a.xcd,Ka)}gWj(Va,fb){this.uWj(Va);y.AFrameworkApplication.h8b=Va.DirectInvokeDavUrl;fb=fb(Va.EditDocInClientUrl);const Ka=new U;Ka.AIi=this.Zv.sn;Ka.hhh=fb;Ka.wIi=Va.EditDocInClientUrl;this.Vh.Zd(w.a.renameMostRecentlyUsedFileEntry,2,Ka)}h$e(Va){switch(Va){case 1:Va=new f.StandardDialog,Va.Rb=0,Va.sX(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null),this.ZYf()}}uWj(Va){this.Zv.sn=X.CQg(this.Zv.sn,Va.NewName);Va.BreadcrumbFolderName&&(this.Zv.breadcrumbFolderName=Va.BreadcrumbFolderName);Va.BreadcrumbFolderUrl&&(this.Zv.breadcrumbFolderUrl=Va.BreadcrumbFolderUrl);this.Eme(Va.NewName)}OVi(Va){const fb=new f.StandardDialog;fb.Rb=0;switch(Va){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");fb.zBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,
null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");fb.zBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Va}),fb.zBa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}y.AFrameworkApplication.pV().execute(Ka=>{Ka.Rj(P.a.OEh,{["FailureMessage"]:ja[Va]})});this.ZYf()}Nbj(Va,fb,Ka){if(1===
Ka)return this.c8a();if(!y.AFrameworkApplication.dKa)return 8;y.AFrameworkApplication.dKa(Object(c.a)(this,this.lqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.kqc,"onRefreshFilenameFailure"),!1);return 32}iPa(Va,fb,Ka,hb,fc){if(1===Ka)return y.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Ka){const dc={};Va=y.AFrameworkApplication.aca;fb=y.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");Va=(!Va||Va&&fb)&&y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);dc[Z.a.yMj]=Va;fc&&fc.MoveButtonClickedTime&&(dc[Z.a.XGi]=fc.MoveButtonClickedTime.getTime());y.AFrameworkApplication.pV().execute(wb=>{wb.Rj(P.a.iPa,dc)});if(fc&&fc.MoveButtonClickedTime){if(Va=Q.a.gs())fc=(new Date).getTime()-fc.MoveButtonClickedTime.getTime(),Va.set("MovePostDuration",fc.toString());M.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Va)}return 32}return 8}wnc(Va,fb,Ka,hb,fc){if(1===Ka)return y.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.c8a():8;
if(2===Ka){if(!y.AFrameworkApplication.L1f)return M.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!fc)return M.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(fc[Z.a.tli])if(fc[Z.a.Vjg])if(Va=fc[Z.a.Vjg].toLowerCase(),fb=y.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Ka=y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),fb&&y.AFrameworkApplication.aca&&
Ka){const dc={};dc[Z.a.YQa]="1";dc[Z.a.documentUrl]=Va;dc[Z.a.reason]=S.a.saveAs;M.Health.instance.recordKpiSuccess("MoveToFolder",null);y.AFrameworkApplication.pV().execute(wb=>{wb.Rj(P.a.tua,dc)})}else if(!y.AFrameworkApplication.aca&&Ka)M.Health.instance.recordKpiSuccess("MoveToFolder",null),T.a.lf(Va,T.a.IX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return M.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else M.Health.instance.recordKpiFailure("MoveToFolder",
"Null newDocUrl",!1,!1,null);else y.AFrameworkApplication.dKa(Object(c.a)(this,this.lqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.kqc,"onRefreshFilenameFailure"),!1),y.AFrameworkApplication.L1f(),M.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}qEj(Va,fb){return Va&&fb?Va!==this.Zv.breadcrumbFolderName||fb!==this.Zv.breadcrumbFolderUrl:!1}lqc(Va,fb){Va&&(Va.NewName!==t.a.Pq(this.Zv.sn)||this.qEj(Va.BreadcrumbFolderName,Va.BreadcrumbFolderUrl))&&this.LGb(Va,fb)}kqc(){}ZYf(){this.Eme(t.a.Pq(this.Zv.sn))}get Vh(){return this.La.value}get qz(){return this.CIc.value}static get instance(){return X.Ma||
(X.Ma=X.ywb())}static ywb(){return new X(y.AFrameworkApplication.d8a,new b.a(()=>y.AFrameworkApplication.ub),new b.a(()=>y.AFrameworkApplication.qz),y.AFrameworkApplication.sm,y.AFrameworkApplication.limitedEdit,()=>y.AFrameworkApplication.userCanRename,y.AFrameworkApplication.ivc,Object(c.a)(J.instance,J.instance.FX,"updateTitle"),D.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>y.AFrameworkApplication.isReadOnlyRecommended,y.AFrameworkApplication.fa,D.a.instance.resolve("Common.IRenameProps"))}static CQg(Va,
fb){Va=t.a.H4(Va);return fb+Va}static Daj(Va){const fb=Va.Values[Z.a.epi];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",fb);fb?y.AFrameworkApplication.ub.Zd(w.a.wnc,2,Va.Values):M.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static Baj(Va){y.AFrameworkApplication.ub.Zd(w.a.renameFile,2,Va.Values.NewName)}}X.Ma=null;Object(u.a)(X,"RenameActor",null,[]);a(568);class Y{}Object(u.a)(Y,"ActivityEventName",null,[]);class va{}
va.compatMode="CompatMode";va.noSelection="NoSelection";Object(u.a)(va,"ActivityEventReason",null,[]);var N=a(642);class ea{constructor(Va,fb){this.La=Va;this.wWa=fb}Ig(){this.La.Nb(w.a.w9f,v.a.frame,Object(c.a)(this,this.YGj,"showRenameDialogAction"))}YGj(Va,fb,Ka){Va=32;if(1===Ka)return N.SessionStatusManager.instance.W5a||y.AFrameworkApplication.x5?8:32;2===Ka&&(32!==this.La.processAction(w.a.renameFile,1)?(this.La.processAction(w.a.Qeb,2),Va=8):32===this.La.processAction(w.a.VNb,1)?this.La.processAction(w.a.VNb,
2):this.wWa.value.create().Kzc());return Va}}Object(u.a)(ea,"RenameDialogActor",null,[522]);class Ca{constructor(Va,fb,Ka){this.dialog=null;this.La=Va;this.Zv=fb;this.wqa=Ka}V_h(){const Va={};Va.nameInputProps={["type"]:"AppInputProps",["id"]:Ca.C2a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:t.a.Pq(this.Zv.sn),["maxLength"]:this.wqa};return Va}Kzc(){const Va={["id"]:"RenameDialog",["bodyControls"]:this.V_h()};this.dialog=new m.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.Fe="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.RMd,"renameDialogHandler"),Va)}RMd(Va,fb){fb&&1===Va&&fb[Ca.C2a]&&(Va=t.a.Pq(this.Zv.sn),fb=(fb[Ca.C2a]||"").trim(),fb!==Va&&""!==fb&&this.La.Zd(w.a.renameFile,2,fb))}}Ca.C2a="txtDocumentName";Object(u.a)(Ca,"ReactRenameDialog",null,[534]);class la{static get qg(){return m.a.iq(la.ol,CommonUIStrings.l_RenameDialogLabel)}}la.ol="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(la,"RenameDialogHtml",null,[]);class Ra extends m.a{constructor(Va,fb,Ka){super();this.La=Va;this.Zv=fb;this.wqa=Ka;this.Fe="RenameDialog";this.qg=la.qg}Kzc(){var Va={["txtDocumentName"]:t.a.Pq(this.Zv.sn)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.RMd,"renameDialogHandler"),Va);Va=document.getElementById(Ra.C2a);0<this.wqa&&(Va.maxLength=this.wqa);Va.focus()}RMd(Va,fb){1===Va&&(Va=t.a.Pq(this.Zv.sn),fb=(fb[Ra.C2a]||"").trim(),fb!==Va&&""!==fb&&this.La.Zd(w.a.renameFile,
2,fb))}}Ra.C2a="txtDocumentName";Object(u.a)(Ra,"RenameDialog",m.a,[534]);class lb{constructor(Va){this.W8=null;this.wqa=0;this.La=Va;this._initialized=!1}initialize(Va,fb){this.W8=Va;this.wqa=fb;this._initialized=!0}create(){return this._initialized?y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Pa.Iv&&y.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new Ca(this.La,this.W8,this.wqa):new Ra(this.La,this.W8,this.wqa):null}}Object(u.a)(lb,"RenameDialogFactory",null,[521]);var Aa=
a(260),da=a(145),aa=a(137),fa=a(107),Oa=a(103);class ba{constructor(Va,fb){this.La=Va;this.Yb=fb}Ig(){this.La.Nb(w.a.VNb,v.a.frame,Object(c.a)(this,this.ZGj,"showRenameFlyoutAction"))}T_g(){return aa.d("setDocumentTitleFlyoutOpened")&&y.AFrameworkApplication.ta.Pa.Gs}ZGj(Va,fb,Ka){if(1===Ka)return this.T_g()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}qJg(){ba.fsi&&y.AFrameworkApplication.P7a&&Oa.a.instance.Fg(new fa.a(5,1,5E3,()=>{32===this.La.processAction(w.a.VNb,
1)&&this.Yb&&this.Yb.hi.name===Aa.AFrame.naa&&(da.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(w.a.VNb,2))}))}static get fsi(){ba.CVb&&null!=ba.CVb||(y.AFrameworkApplication.nya("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ba.CVb=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ba.CVb}}ba.CVb=null;Object(u.a)(ba,"RenameFlyoutActor",null,
[520]);class ka{constructor(Va,fb,Ka,hb,fc){this.CIc=fc;this.yce=Ka;this.xce=hb;this.OEg=Va;this.Lqa=fb}get qz(){return this.CIc.value}t6e(){if(!this.xce())return 5;if(this.Lqa())return 1;if(this.qz){if(this.yce&&!this.qz.rNe)return 3;if(!this.yce&&!this.qz.xwb)return 4}return this.OEg()?0:2}}Object(u.a)(ka,"RenameProps",null,[519]);a(187);var Pa=a(99);class Fa{constructor(Va,fb,Ka,hb,fc,dc){this.ln=!1;this.BOc=new Pa.a;this.BWa=fb;this.fM=Ka;this.btg=hb;this.ob=fc;this.nle=dc}enable(){this.ln||(this.Bhg(),
this.hXd(),this.ln=!0)}generateKey(Va,fb,Ka){return String.format("{0}/{1}/{2}",Ka,Va,fb)}dWh(){const Va=t.a.Pq(this.BWa().sn);return this.generateKey(this.BWa().breadcrumbFolderName,this.BWa().breadcrumbFolderUrl,Va)}eWh(Va,fb,Ka){return Va&&fb?this.generateKey(Va,fb,Ka):Ka}Ilh(Va,fb,Ka){return Va&&Va!==this.BWa().breadcrumbFolderName||fb&&fb!==this.BWa().breadcrumbFolderUrl?!0:Ka!==t.a.Pq(this.BWa().sn)}Bhg(){const Va=this.dWh();this.BOc.ia(Va,new Date)}yGd(Va){this.VCj(Va)&&this.Mne(Va)}VCj(Va){const fb=
this.btg();return fb?this.nle&&this.nle.eBb||!fb.mif||!y.AFrameworkApplication.dKa?(this.cbg(Va),this.ln=!1):!0:!1}EIf(Va,fb,Ka,hb){const fc=this.Ilh(Va,fb,Ka);Va=this.eWh(Va,fb,Ka);fb=this.BOc.Dc(Va).returnValue;fc&&!fb&&(this.i$e(hb),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Zwd));fc||this.BOc.ia(Va,this.fM())}}Object(u.a)(Fa,"ARenamedFileChecker",null,[492]);class oa extends Fa{constructor(Va,fb,Ka,hb,fc,dc,wb,Tb){super(Va,fb,Ka,hb,fc,dc);this.xie=fc;this.mBg=wb;this.Nwg=
Tb}get Zwd(){return"RenamedFileCheckerUsingSettingsRefresh"}hXd(){this.xie.tXc(Object(c.a)(this,this.V$e,"handleSettingsRefresh"))}V$e(Va,fb){fb&&fb.iFb&&fb.QKi&&(fb.k8a("BreadcrumbDocName")||fb.k8a("BreadcrumbFolderName")||fb.k8a("BreadcrumbFolderUrl")||fb.k8a("DirectInvokeDAVUrl")||fb.k8a("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Zwd),this.yGd(fb))}cbg(){this.xie.Phj(Object(c.a)(this,this.V$e,"handleSettingsRefresh"))}Mne(Va){if(Va&&Va.iFb){const fb=
Va.iFb;this.EIf(fb.Xa("BreadcrumbFolderName"),fb.Xa("BreadcrumbFolderUrl"),fb.Xa("BreadcrumbDocName"),Va)}}i$e(Va){const fb={OperationResult:0,classId:1};Va=Va.iFb;fb.BreadcrumbFolderName=Va.Xa("BreadcrumbFolderName");fb.BreadcrumbFolderUrl=Va.Xa("BreadcrumbFolderUrl");fb.DirectInvokeDavUrl=Va.Xa("DirectInvokeDAVUrl");fb.EditDocInClientUrl=Va.Xa("EditDocInClientUrl");Va=Va.Xa("BreadcrumbDocName");fb.NewName=y.AFrameworkApplication.sua?Va:t.a.Pq(Va);this.Nwg.execute(Ka=>{this.Oii(fb,Ka)})}Oii(Va,fb){this.mBg().LGb(Va,
fb)}}Object(u.a)(oa,"RenamedFileCheckerUsingSettingsRefresh",Fa,[]);class La extends Fa{constructor(Va,fb,Ka,hb,fc,dc,wb,Tb,xb,cb){super(Va,Ka,hb,fc,dc,xb);this.imb=this.xZb=null;this.uAg=fb;this.La=wb;this.he=Tb;cb&&cb.execute(jb=>{this.cej(jb)})}get Zwd(){return"RenamedFileCheckerUsingTask"}cej(Va){this.xZb=Va;this.xZb.Wre(Object(c.a)(this,this.uyb,"handleVisibilityChange"))}uyb(Va,fb){!this.ln||0!==fb.newState&&1!==fb.newState||this.imb||(this.hXd(),this.yGd(this.imb))}hXd(){this.imb=new fa.a(3,
2,this.uAg(),Object(c.a)(this,this.yGd,"performRenameFileCheckTick"),89);this.he.Fg(this.imb)}cbg(Va){this.he.np(Va)}Mne(Va){this.xZb&&2===this.xZb.d5j?this.cfj(Va):y.AFrameworkApplication.dKa(Object(c.a)(this,this.lqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.kqc,"onRefreshFilenameFailure"),!0)}cfj(Va){this.he.np(Va);this.imb=null}lqc(Va){Va&&this.EIf(Va.BreadcrumbFolderName,Va.BreadcrumbFolderUrl,Va.NewName,null)}i$e(){this.La.processAction(w.a.fileNameUpdate,2)}kqc(){}}Object(u.a)(La,"RenamedFileCheckerUsingTask",
Fa,[]);var Ea=a(96);class ca{constructor(){this.ob=this.gb=null}get name(){return"Common.App.RenameFile"}Xh(Va){this.gb=Va;this.ob=y.AFrameworkApplication.fa;this.gb.register(ea,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Fc(()=>new ea(y.AFrameworkApplication.ub,this.gb.uOd("Common.App.Rename.IRenameDialogFactory"))).xc();this.gb.register(lb,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Fc(()=>new lb(y.AFrameworkApplication.ub)).xc();
this.gb.register(492,"Common.App.Rename.IRenamedFileChecker").Fc(()=>this.Seh()).xc();this.gb.register(ba,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Fc(()=>new ba(y.AFrameworkApplication.ub,Ea.FocusManager.instance())).xc()}Seh(){if(this.ob.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Va=this.gb.Lh("Common.IRefreshableAppSettings");if(Va&&Va.Csd)return new oa(()=>Va.rd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>y.AFrameworkApplication.sm,()=>
new Date,()=>y.AFrameworkApplication.qz,Va,this.gb.Lh("Common.ISessionStatus"),()=>X.instance,this.gb.Ub("Postmessage.IHostPostmessenger"))}return new La(()=>this.ob.rd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.ob.rd("RenamedFileCheckerPingIntervalInMs",12E4),()=>y.AFrameworkApplication.sm,()=>new Date,()=>y.AFrameworkApplication.qz,y.AFrameworkApplication.fa,y.AFrameworkApplication.ub,y.AFrameworkApplication.Fi,this.gb.Lh("Common.ISessionStatus"),this.gb.Ub("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.ob.Ev(Object(c.a)(this,
this.JB,"onFullAppSettingsReady"))}JB(){const Va=y.AFrameworkApplication.ta.Pa.Gs;y.AFrameworkApplication.d8a()&&J.instance.initialize(y.AFrameworkApplication.iac,Va?null:y.AFrameworkApplication.D2a,Va?null:y.AFrameworkApplication.TMd||CommonUIStrings.l_RenameFileTooltip)&&(this.gb.register(ka,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Fc(()=>new ka(()=>y.AFrameworkApplication.userCanRename,()=>y.AFrameworkApplication.isReadOnlyRecommended,y.AFrameworkApplication.ivc,y.AFrameworkApplication.d8a,
new b.a(()=>y.AFrameworkApplication.qz))).xc(),X.instance.Ig(),this.ob.qa("RenameDialogIsEnabled")&&(this.gb.resolve("Common.App.Rename.RenameDialogFactory").initialize(y.AFrameworkApplication.sm,y.AFrameworkApplication.iac),this.gb.resolve("Common.App.Rename.IRenameDialogActor").Ig()),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").Ig(),y.AFrameworkApplication.ivc&&this.gb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").qJg())}dispose(){}}
Object(u.a)(ca,"PackageManager",null,[3,4]);var $a=a(248);a.d(F,"a",function(){return Qa});const Qa=()=>{Type.registerNamespace("Common.App.Rename");$a.a.instance.Ei(new ca,7)}},1450:function(u,F,a){a.r(F);u=a(1143);var c=a(9);F=a(0);var b=a(694),e=a(49),f=a(37),d=a(4),h=a(59),n=a(184),m=a(25),x=a(55);class r{constructor(X){this.renameFileManager=X}executeCommand(X,Y,va){switch(Y.command){case m.a.iia:return h.a.Bg.Gs?2!==d.AFrameworkApplication.ub.Zd(m.a.iia,2,va)?x.Task.Ta(!0):n.a(Y.command):n.a(Y.command);
case 1897077126:return this.renameFileManager.renameFile(va,Y),x.Task.Ta(!0);default:return n.a(Y.command)}}wc(X,Y,va,N){switch(Y.command){case m.a.iia:return h.a.Bg.Gs;case 1897077126:return!!N&&2===N.mz}return!1}Kc(){return!1}nc(){return!1}dispose(){this.renameFileManager=null}}Object(F.a)(r,"RenameFileCommandHandler",null,[208,2]);class y extends b.a{constructor(X){super(X)}ld(){const X=e.GetServiceTaskFactory.create(this.$.da,119,this.ka,this.Ya);f.TaskExtensions.za(X,()=>{this.Zc([new r(X.result)])},
this.ka,3)}static la(X){b.a.Nd(118,new y(X))}}Object(F.a)(y,"RenameFileCommandHandlerFactory",b.a,[]);var t=a(89),v=a(222),w=a(227),C=a(15),B=a(30),z=a(78),A=a(381),E=a(76),I=a(374),L=a(188),V=a(92),T=a(282),H=a(1),D=a(22),G=a(281);class J{constructor(X){this.$=X}get mif(){return this.$.workbookContext.FileCoauthorable}get eBb(){return!1}get xwb(){return this.$.ea.amIAlone}get rNe(){if(this.xwb)return!0;for(const X of this.$.ea.Xm)if(!X.SupportsRename)return!1;return!0}}Object(F.a)(J,"EwaCoauthManager",
null,[621]);var M=a(60),Q=a(70);class U extends z.a{constructor(X,Y){super();this.Cda=this.SMd=this.pWf=this.Y7c=null;this.uka=()=>{var va=this.$.ea.Ho;if(va&&va.WorkbookFileName){var N=B.a.Pq(va.WorkbookFileName),ea=!!D.a.compare(this.$.workbookContext.WorkbookFileName,va.WorkbookFileName,!1),Ca=H.EwaSettings.ma(529)&&!!va.BreadcrumbFolderUrl&&!!D.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,va.BreadcrumbFolderUrl,!1);if(ea||Ca)this.Cda={},this.Cda.NewFileName=N,this.Cda.EditDocInClientUrl=
va.EditDocInClientUrl,this.Cda.DirectInvokeDAVUrl=va.DirectInvokeDAVUrl,this.Cda.DownloadACopyUrl=va.DownloadACopyUrl,H.EwaSettings.ma(529)&&va.BreadcrumbFolderUrl&&(this.Cda.BreadcrumbFolderName=va.BreadcrumbFolderName,this.Cda.BreadcrumbFolderUrl=va.BreadcrumbFolderUrl),va=d.AFrameworkApplication.ub.Zd(m.a.fileNameUpdate,2,N),this.Cda=null,C.ULS.shipAssertTag(537154064,0,32===va,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.ePi=(va,N,ea)=>{this.pWf=N;this.SMd=
ea;this.$.Ja.Lb(new V.a(1897077126,E.a.Db,2,3,null),{["newFileName"]:va})};this.dPi=va=>{this.Cda&&va(this.u6e(this.Cda),this.Cs)};this.LGb=va=>{T.a(va)||!va.Result?(va=U.LLh(va),Q.a(this.$).hd.xM([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.SMd(va)):this.pWf(this.u6e(va.Result),this.Cs)};this.NVi=()=>{this.SMd(5)};this.$=X;this.Cs=Y;this.$.ea.nu(this.uka)}initialize(){d.AFrameworkApplication.J$b=this.ePi;d.AFrameworkApplication.dKa=this.dPi;this.Y7c=d.AFrameworkApplication.qz;
d.AFrameworkApplication.qz=new J(this.$)}dispose(){d.AFrameworkApplication.J$b=null;d.AFrameworkApplication.dKa=null;this.$.ea.Nv(this.uka);d.AFrameworkApplication.qz=this.Y7c;this.$=this.Y7c=null;super.dispose()}renameFile(X,Y){const va=X.newFileName;if(va){const N=this.$.pa.ya.Wb();I.a(this.$.userOperationManager,(ea,Ca,la)=>{var Ra=this.$.pa.ya;ea=G.b(ea,this.LGb);Ca=G.a(Ca,this.NVi);const lb=Ra.Na(9,N);lb.newFileName=va;return M.g(Ra,"RenameFile",lb,ea,Ca,la,null,0)},ea=>new L.a(134,0,ea),Y)}}dli(){return 32===
d.AFrameworkApplication.ub.processAction(m.a.iia,1)}u6e(X){var Y=this.$.workbookContext;d.AFrameworkApplication.yZ=X.DownloadACopyUrl;const va=H.EwaSettings.ma(529)&&!!X.BreadcrumbFolderUrl;va&&(d.AFrameworkApplication.sm.breadcrumbFolderName=X.BreadcrumbFolderName,d.AFrameworkApplication.sm.breadcrumbFolderUrl=X.BreadcrumbFolderUrl,Y.FullDocumentInfo.BreadcrumbFolderUrl=X.BreadcrumbFolderUrl,Y.FullDocumentInfo.BreadcrumbFolderName=X.BreadcrumbFolderName);Y.FullDocumentInfo.BreadcrumbDocName=X.NewFileName;
A.d(Y,X.NewFileName);Y={};Y.NewName=X.NewFileName;Y.DirectInvokeDavUrl=X.DirectInvokeDAVUrl;Y.EditDocInClientUrl=X.EditDocInClientUrl;va&&(Y.BreadcrumbFolderName=X.BreadcrumbFolderName,Y.BreadcrumbFolderUrl=X.BreadcrumbFolderUrl);Y.OperationResult=0;return Y}static LLh(X){switch(X.Errors[0].MessageId){case -414480287:X=2;break;case 650565124:X=1;break;case 1636785843:X=6;break;case -782844485:X=4;break;default:X=5}return X}}Object(F.a)(U,"RenameFileManager",z.a,[591,2]);var Z=a(51);class P extends v.a{constructor(X){super();
this.mZ=this.renameFileManager=null;this.$=X;this.Fb()}create(){if(!this.mZ){const X=w.a.S1a(Z.b(),this.ka,"Task","IRenameFileManager");this.mZ=X.task;const Y=e.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Ya),va=e.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([va,Y],this.ka),()=>{const N=new U(this.$,Y.result);this.$.da.Ga(120,N);X.setResult(N)},this.ka,3)}this.mZ.continueWith(X=>{this.nb(X.result)})}dispose(){t.a.Ia(this.renameFileManager);
this.$=this.renameFileManager=null;super.dispose()}static la(X){X.da.Ga(119,new P(X))}}Object(F.a)(P,"RenameFileManagerServiceFactory",v.a,[]);class S{constructor(X){this.Vh=X}nc(){return!1}executeCommand(X,Y,va){return 2!==this.Vh.Zd(m.a.w9f,2,va)?x.Task.Ta(!0):n.a(Y.command)}wc(X,Y){return 1204860550===Y.command}Kc(){return!1}}Object(F.a)(S,"RenameFileDialogCommandHandler",null,[208]);class ja extends b.a{constructor(X){super(X)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.Ya),()=>{this.Zc([new S(d.AFrameworkApplication.ub)])},this.ka,3)}static la(X){b.a.Nd(131,new ja(X))}}Object(F.a)(ja,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(u.a)();(()=>{c.a.Fa(X=>{P.la(X);y.la(X)})})();c.a.Fa(ja.la)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/c14fdf03ba4c9a9385fcf1a8f632ed13/EwaDSEsNext.rn.js.map