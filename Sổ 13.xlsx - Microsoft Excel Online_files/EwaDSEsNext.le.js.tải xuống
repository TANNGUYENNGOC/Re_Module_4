'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1236:function(u,F,a){u=a(0);var c=a(7),b=a(15),e=a(27),f=a(89),d=a(14),h=a(83),n=a(419),m=a(78),x=a(8),r=a(65),y=a(462);class t{constructor(X,Y){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=Y;this.parentElement=X}mah(){const X=this.nah();y.a(this.$,243,242,0,Y=>{this.cardViewManager=Y;Y.z8f(this.parentElement,2,X)})}Kbf(){this.cardViewManager&&
this.cardViewManager.oMa(-1,-1,this.parentElement)}nah(){const X={layoutId:"AutoDetectTooltip"};X.description=this.longDescription;X.convertToDomainName=this.convertToDomainName;X.longDescription=this.longDescription;X.urlValue=this.urlValue;X.imageAltText=this.imageAltText;X.helpText=this.helpText;X.helpId=this.helpId;return X}}Object(u.a)(t,"AutoDetectCardManager",null,[]);var v=a(31),w=a(210),C=a(30),B=a(224),z=a(19),A=a(52),E=a(1);class I extends m.a{constructor(X,Y,va){super();this.gd=N=>{if(N.Gb.id===
this.uua.firstChild.id){N=this.Zwe;const ea={};ea.Id=N.Vpb;this.convertToLinkedEntityManager.U4c(ea,!0,N);this.uua.removeChild(this.uua.firstChild);return!0}return!1};this.Zwe=X;this.convertToLinkedEntityManager=Y;this.uua=document.createElement("div");this.uua.className="clip16x16";this.Nka=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',C.a.Hg("autodetectid"+this.Zwe.left),z.a.abd,A.a.me(11));E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
E.EwaSettings.isChangeGateEnabled("OfficeVSO:7188168_ReduceInnerHTMLUsageForAutoDetectColumnHeaderButton")?va.Ri(this.uua,this.Nka):this.uua.innerHTML=this.Nka;X=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.sa(d.a.click,X,this.gd)}get domElement(){return this.uua}dispose(){if(this.uua){const X=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.Ba(d.a.click,X,this.gd)}super.dispose()}static get PYg(){return"clip16x16"}}Object(u.a)(I,
"AutoDetectColumnHeaderButton",m.a,[]);var L=a(1089),V=a(11),T=a(21),H=a(177);class D extends m.a{constructor(X,Y,va){super();this.htmlSanitizationHelper=null;this.$=X;this.gridView=T.h(X);this.convertToLinkedEntityManager=Y;this.htmlSanitizationHelper=va;this.E3c=new H.a}dispose(){super.dispose()}Dmh(X){for(let Y of this.gridView.gia)for(let va of Y){const N=va,ea=N.Mt,Ca=L.a(N.a5);this.hHg(X,Ca,ea);N.YRd(Ca)}}hHg(X,Y,va){if(Y.length){var N=va.length;va[N-1]<X.left||(va=V.HelperMethods.jw(new w.a(va),
0,N,X.left,V.HelperMethods.HB),0>va||!(Y=Y[va]))||(this.gridView.rtl?Y.classList.add(v.a.Zzh):Y.classList.add(v.a.Yzh),this.E3c.lb(X.left)||this.E3c.add(X.left,new I(X,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),X=this.E3c.na(X.left).domElement,!Y.getElementsByClassName(I.PYg).length&&this.tJj(Y)&&Y.appendChild(X))}}tJj(X){const Y=parseInt(X.style.width,10);var va=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";va=D.Wbh(va);X=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.S0h(X.firstChild.innerHTML),
va,!0,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<Y-(Y/2+X/2)?!0:!1}static Wbh(X){return`${"normal"} ${"normal"} ${X} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(u.a)(D,"AutoDetectColumnHeaderManager",m.a,[]);var G=a(428),J=a(24),M=a(66),Q=a(142),U=a(12),Z=a(13),P=a(145),S=a(72);a.d(F,"a",function(){return ja});class ja extends m.a{constructor(X,Y,va,N,ea){super();this.isMac=e.a.isMac;this.nZa=-1;this.K6b=
null;this.Pta=-1;this.NN=this.Fkc=this.PVd=this.O_=this.$we=!1;this.$T=null;this.Dg=()=>{this.bxa&&this.gridView&&this.qX()};this.yc=()=>{this.ny()};this.gd=()=>{this.BIa();T.h(this.$).kg(!0,!1)};this.kza=(la,Ra)=>{Ra?(this.Jhg(this.K6b),this.Reb()):(la=[29],this.gridView.qb.Zg(la),this.gridView.qb.Ti(null,la),this.$T&&this.$T.Kbf())};this.gj=()=>{this.N7a()&&this.Fh.hide();1===this.gridView.ha.Oe&&this.qX()};this.DR=()=>{const la=this.gridView.ha.Oe;this.gridView.ha.ra.activeCell&&1===la&&this.qX()};
this.onKeyUp=la=>this.nDb?this.O_?!1:17===la.Ca.keyCode&&this.PVd?(this.NN?(this.Reb(),this.Sda()):this.NMb(),!0):!1:this.O_=!1;this.onKeyDown=la=>{if(!this.nDb)return this.O_=!1;this.PVd=!1;this.O_=la.ctrlKey;switch(la.Ca.keyCode){case 27:return this.NN?(this.kza(null,!1),this.Sda()):this.$T&&(this.$T.Kbf(),this.NMb()),!0;case 13:if(this.NN)return this.NN=!1,this.BIa(),!0;break;case 17:return this.PVd=!0}return!1};const {AutoDetectActionButton:Ca}=a(1346);this.$=X;this.Wpb=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",
!1);Y||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=N;N.gIb();this.Fh=new Ca(X,Y,this.gd,va,"");this.sTg=new D(this.$,N,ea);this.gridView=T.h(this.$);this.gridView.ha.TT(this.Dg);this.gridView.Vb.EZa(this.Dg);this.gridView.lv(this.DR);X.Xj(this.yc);X.QA(this.gj);this.gridBlockManager=Object(h.a)(612,this.gridView.Da);this.Go=X.frame.Zt;this.qX()}get mc(){return this.Fh.domElement(1)}get nDb(){const X=this.Fh.domElement(ja.Xea);
return X?U.DOMElementExtensions.isVisible(X):!1}get bxa(){return this.$.isEditMode&&E.EwaSettings.ma(134)&&E.EwaSettings.ma(137)&&(new Q.a(this.$.xa)).ji?!1:-1!==this.Pta}dispose(){this.gridView&&this.gridView.ha.$R(this.Dg);if(this.$){const X=this.$;X.Jl(this.yc);X.aE(this.gj);T.h(X).Ky(this.DR)}f.a.Ia(this.Fh);this.Go=this.$=this.gridView=this.Fh=null;super.dispose()}ny(){this.kza(null,!1);this.nZa=-1;this.Fh.hide();this.CUj();this.NN=!1}Sda(){this.Fh.getButton(ja.Xea).$cb();this.NN=!1}NMb(){this.Fh.getButton(ja.Xea).bIb();
this.Jhg(this.K6b);this.NN=!0;this.$.da.$a(211,X=>{X.UQa(Z.a.instance.ga(1742))})}onAutoDetectUIShown(){if(this.bxa&&-1!==this.nZa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}tTg(X){var Y=new J.Range(1===X.top?1:X.top-1,X.left,X.bottom,X.right,!0,!1);Y=this.gridView.getRangeInformation(Y);for(const va of Y)if(Object(n.a)(G.AutoDetectRange,va)&&this.thc(X,!1,va))return!0;return!1}BIa(){if(this.bxa&&-1!==this.nZa){this.Fh.getButton(ja.Xea).bIb();var X={};X.Id=this.Pta;X.StringId=null;this.convertToLinkedEntityManager.U4c(X,
!0,this.K6b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");X=[Object(c.a)(new S.a,{name:"Domain",int64:this.Pta})];P.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,X);this.Pta=-1}}IOh(){let X=Z.a.instance.ga(1738);if(-1!==this.Pta){X+=" ";try{X+=this.convertToLinkedEntityManager.ICb(this.Pta.toString())}catch(Y){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Pta}`)}}X+=
" ";return X=this.Wpb?X+Z.a.instance.ga(1741):X+Z.a.instance.ga(this.isMac?1740:1739)}Reb(){this.Wpb&&(this.$T||(this.$T=new t(this.mc,this.$),this.$T.convertToDomainName=Z.a.instance.ga(1743),this.$T.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.$T.imageAltText=Z.a.instance.ga(1745),this.$T.helpId="HID_DataTypes_Wolfram",this.$T.helpText=Z.a.instance.ga(1744)),this.$T.longDescription=this.convertToLinkedEntityManager.SZd(this.nZa.toString()),
this.$T.mah())}thc(X,Y,va){if((new J.Range(va.top,va.left,va.bottom===x.a.fh?va.bottom:va.bottom+1,va.right,!0,!1)).Cd(X)){if(Y){if(va&&va.Vpb!==this.nZa){this.nZa=va.Vpb;X=va.Vpb.toString();Y=this.Wpb?"":this.convertToLinkedEntityManager.SZd(X);const N=this.convertToLinkedEntityManager.Pbi(X);this.Fh.Mgb(this.convertToLinkedEntityManager.ICb(X),Y,N,ja.Xea)}this.Pta=va.Vpb;this.K6b=va}return!0}return!1}qX(){if(this.convertToLinkedEntityManager){var X=this.gridView.ha.Oe;if(this.gridBlockManager&&
this.gridBlockManager.qld){var Y=this.gridView.ha.ra.activeCell,va=!this.gridBlockManager.rs(Y),N=this.gridView.getRangeInformation(this.gridView.ui);for(const ea of N)if(Object(n.a)(G.AutoDetectRange,ea))switch(N=ea,N.Z2g){case 3:if(this.thc(Y,!0,N)){if(1!==X||va){this.ny();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.aLd();this.Fh.xBa(Y,this.kza);this.$we||(this.$we=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(E.EwaSettings.ma(465)||
E.EwaSettings.ma(466))&&this.sTg.Dmh(N);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.ny()}}Jhg(X){const Y=[29];this.gridView.qb.Ti(X,Y);this.gridView.qb.Sn(Y)}N7a(){return this.$.ea.isNamedObjectViewMode&&M.f(this.$.oa)}aLd(){this.Wpb&&!this.Fkc&&this.Go&&(this.Go.Ps(d.a.Pb,this.$.domElement,this.onKeyDown,!0),this.Go.Ps(d.a.Fd,this.$.domElement,this.onKeyUp,!0),this.Fkc=!0)}CUj(){this.Wpb&&this.Fkc&&
this.Go&&(this.Go.Ws(d.a.Pb,this.$.domElement,this.onKeyDown,!0),this.Go.Ws(d.a.Fd,this.$.domElement,this.onKeyUp,!0),this.Fkc=!1)}static get Xea(){return 1}static QQh(X){return Z.a.instance.ga(1799)+r.a.space+X}}Object(u.a)(ja,"AutoDetectManager",m.a,[])},1346:function(u,F,a){a.r(F);a.d(F,"AutoDetectActionButton",function(){return d});u=a(0);F=a(78);var c=a(1236),b=a(52),e=a(13),f=a(21);class d extends F.a{constructor(h,n,m,x,r){super();this.$=h;this.wo=x.q6b(h,n,m,"",b.a.me(11),r,"AutoDetectPointerDown",
e.a.instance.ga(1799)+"...")}get Az(){return this.wo.Az}dispose(){this.wo.dispose();this.$=null;super.dispose()}domElement(h){return this.wo.domElement(h)}getButton(h){return this.wo.getButton(h,!1)}Mgb(h,n,m,x){this.wo.aVa(c.a.QQh(h),n,x);this.wo.Fig(m,n,x)}xBa(h,n){const m=f.h(this.$),x=m.ib.Mi(h);h=m.fg(h,x);const r=m.Df(x).Am;if(h&&0<=h.x&&0<=h.y&&r.width>h.width+160){let y=h.bottomRight.x+this.Az,t=h.topLeft.y+this.Az,v=!1;y+160>r.bottomRight.x&&(y=h.topLeft.x-this.Az,v=!0);if(t<r.topLeft.y+
this.Az){if(m.ib.gCa){this.hide();return}t=r.topLeft.y+this.Az}this.wo.s9b(n,x);this.Sp(y,t,m.rtl,x,v)}else this.hide()}Sp(h,n,m,x,r){this.wo.Sp(h,n,m,x,!1,r)}hide(){this.wo.hide()}}Object(u.a)(d,"AutoDetectActionButton",F.a,[])},1453:function(u,F,a){a.r(F);u=a(0);var c=a(694),b=a(15),e=a(5),f=a(76),d=a(37),h=a(1),n=a(184),m=a(21),x=a(145);class r{constructor(Q,U){this.$=U;this.convertToLinkedEntityManager=Q}nc(Q,U){switch(U){case -1203788282:case 48568533:case -1662108744:return Q=m.h(this.$),U=
this.convertToLinkedEntityManager.tFi||7E3,(null===Q||void 0===Q?0:Q.ha)&&Q.ha.ra.dd.RC>U?!0:!1;default:return!1}}executeCommand(Q,U,Z){Q=d.TaskExtensions.Uj();U=U.command;switch(U){case -1203788282:this.convertToLinkedEntityManager.F9g(Z[f.a.Jc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();
break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(Z[f.a.Jc].toString());break;case 1266950951:this.convertToLinkedEntityManager.Awi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:h.EwaSettings.ma(642)&&this.convertToLinkedEntityManager.rPe();break;case 1702917262:h.EwaSettings.ma(642)&&this.convertToLinkedEntityManager.showHelpArticle(e.a.VVj);break;case -90814711:h.EwaSettings.ma(642)&&
this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===U||Z[f.a.Epf]&&"ConvertToLinkedEntityGallery"===Z[f.a.Epf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),x.a("ExpandDataTypeGallery");break;default:Q=n.a(U)}return Q}wc(Q,U){switch(U.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.ma(129);
case -1081442996:case 1702917262:case -90814711:return h.EwaSettings.ma(642);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Kc(Q,U,Z){return"PopulateConvertToLinkedEntityMenu"===U&&h.EwaSettings.ma(129)?this.convertToLinkedEntityManager.Kc(Q,U,Z):!1}}Object(u.a)(r,"ConvertToLinkedEntityCommandHandler",null,[208]);var y=a(462);class t extends c.a{constructor(Q){super(Q)}ld(){y.a(this.$,271,272,this.Ya,Q=>{this.Zc([new r(Q,this.$)])})}static la(Q){c.a.Nd(273,
new t(Q))}}Object(u.a)(t,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var v=a(55);F=a(222);var w=a(760),C=a(49),B=a(420),z=a(697);class A extends F.a{constructor(Q){super();this.$=Q;this.Fb()}create(){const Q=C.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Ya),U=C.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya),Z=C.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Ya),P=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7126083_ReduceInnerHTMLUsageForEnrichmentTaskPaneWrapper")?
C.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):v.Task.Ta(null),S=C.GetServiceTaskFactory.Oa(this.$.da,257,258,this.Ya),ja=B.a(this.$);d.TaskExtensions.za(d.TaskExtensions.Ed([Q,S,ja,U,Z,P],this.ka),()=>{this.nb(Object(z.a)(this.$.da,271,()=>new w.ConvertToLinkedEntityManager(this.$,Q.result,Z.result,S.result,ja.result,U.result,P.result)))},this.$.ka,3)}static la(Q){Q.da.Ga(272,new A(Q))}}Object(u.a)(A,"ConvertToLinkedEntityManagerFactory",F.a,[]);var E=a(238),I=a(259),L=a(33),V=a(247),T=a(12),
H=a(703);const D=a(19).a.Gzh;class G extends E.a{constructor(Q,U,Z){super(Q);this.vq=0;this.Up=!1;this.yc=()=>{this.yg(!1)};this.$=U;this.taskPaneManager=Z;I.a(U).di(this);this.$.Xj(this.yc);L.a.fd(this.$)&&(this.isVisible=!1)}NP(Q){this.get_events().addHandler("EnrichmentTaskPaneRemoved",Q)}ZR(Q){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",Q)}QE(Q){this.addHandler("EnrichmentTaskPaneVilibilityChanged",Q)}lG(Q){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",Q)}DMg(Q){this.addHandler("EnrichmentTaskPaneOnFocus",
Q)}Jhj(Q){this.removeHandler("EnrichmentTaskPaneOnFocus",Q)}get isVisible(){return super.isVisible}set isVisible(Q){super.isVisible=Q;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Hf(){return this.isVisible}get de(){return V.a.qrh}get jh(){return 10}get Ek(){return D}get wN(){return this.titleText}get titleText(){return"Enrichment"}get Kp(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.ZO.offsetHeight}get aC(){return this.taskPaneManager.xva(this.mc,
this.titleText,this.Kp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Kp)}nq(){return this.Up}Fs(){return this.Up}IR(){}dispose(){this.$&&this.$.Jl(this.yc);this.taskPaneManager=this.$=null;super.dispose()}kg(Q,U){U||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!U}mh(Q){return T.DOMElementExtensions.Af(this.mc,Q)}sj(){}dk(){}yg(Q){this.Up=Q;const U=this.taskPaneManager;this.isVisible=Q;L.a.fd(this.$)?Q?this.taskPaneManager.Y6("EnrichmentTaskPane",
this.aC):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(Q&&0<U.$B.length&&(!U.oh||10!==U.oh.taskPane.jh||U.isCollapsed)&&U.oG(this,!0),U.lA());Q||(m.h(this.$).kg(!0,!1),this.$.df())}VQ(){return!1}static la(Q,U){var Z=Q.Eb;let P=document.getElementById(Z+e.a.OPe);P||(P=H.a("div",Q.Eb+e.a.OPe,"cui-taskpane"),L.a.fd(Q)||(Z=document.getElementById(Z+e.a.AR),void 0!==Z&&null!==Z?Z.appendChild(P):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${Q.AD}`)));
Z=Q.da;return Z.Aa(257)||Z.Ga(257,new G(P,Q,U))}}Object(u.a)(G,"EnrichmentTaskPane",E.a,[570,2,472,34]);class J extends F.a{constructor(Q){super();this.hh=this.xi=null;this.$=Q;this.Fb()}get QD(){this.xi||(this.xi=d.TaskExtensions.za(B.a(this.$),Q=>{this.hh=G.la(this.$,Q.result)},this.ka,3));return this.xi}create(){const Q=C.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Ya),U=C.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya);d.TaskExtensions.za(d.TaskExtensions.ts(d.TaskExtensions.Ed([Q,
U],this.ka),()=>this.QD,this.ka),()=>{this.nb(this.hh)},this.ka,3)}dispose(){this.hh=this.xi=this.$=null;super.dispose()}static la(Q){Q.da.Ga(258,new J(Q))}}Object(u.a)(J,"EnrichmentTaskPaneFactory",F.a,[]);var M=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{M.a.Fa(Q=>{J.la(Q);A.la(Q);t.la(Q)})})()},760:function(u,F,a){a.r(F);var c=a(0),b=a(15),e=a(89),f=a(263),d=a(4),h=a(30),n=a(818),m=a(135),x=a(82),r=a(38),y=a(19),t=a(5),v=a(161),w=a(1236),C=a(1239),
B=a(171),z=a(557),A=a(349),E=a(60);const I=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"GetRichDataClassificationLabels",Qb,Ha,Ab,Yb,Bb,4)},L=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb,Eb=null)=>{Eb=qb.Na(1,Eb);Eb.selectedRanges=Ha;Eb.domainId=Ab;Eb.autodetect=Yb;return E.g(qb,"ConvertToLinkedEntity",Eb,Bb,Qb,sc,kb,4)},V=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"OnAutoDetectUIShown",Qb,Ha,Ab,Yb,Bb,4)},T=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"GetLinkedEntityMetadata",Qb,
Ha,Ab,Yb,Bb,4)},H=(qb,Ha,Ab,Yb,Bb,Qb,sc=null)=>{sc=qb.Na(1,sc);sc.selectedRanges=Ha;return E.g(qb,"ConvertLinkedEntityToText",sc,Ab,Yb,Bb,Qb,4)},D=(qb,Ha,Ab,Yb,Bb,Qb,sc=null)=>{sc=qb.Na(1,sc);sc.selectedRanges=Ha;return E.g(qb,"RefreshLinkedEntitiesInRange",sc,Ab,Yb,Bb,Qb,4)},G=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb,Eb,Gc,zc=null)=>{zc=qb.Na(1,zc);zc.selectedRanges=Ha;zc.isChangeObject=Ab;zc.isFloodgateEnabled=Yb;zc.isStarterData=Bb;zc.starterDataDomainId=Qb;return E.g(qb,"GetDataSelectorPaneData",zc,sc,kb,Eb,
Gc,4)},J=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=qb.Na(9,kb);kb.activeCell=Ha;kb.selectionIndex=Ab;return E.g(qb,"SelectLinkedEntityForDisambiguation",kb,Yb,Bb,Qb,sc,4)},M=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb,Eb,Gc,zc,yb=null)=>{yb=qb.Na(1,yb);yb.searchCell=Ha;yb.searchQuery=Ab;yb.isFloodgateEnabled=Yb;yb.isStarterData=Bb;yb.starterDataDomainId=Qb;yb.starterDataDomainIdString=sc;return E.g(qb,"LinkedEntitySearch",yb,kb,Eb,Gc,zc,4)},Q=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb,Eb=null)=>{Eb=qb.Na(1,Eb);Eb.cell=Ha;Eb.starterDataDomainId=
Ab;Eb.starterDataDomainIdString=Yb;return E.g(qb,"InsertStarterDataTable",Eb,Bb,Qb,sc,kb,4)},U=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=qb.Na(1,kb);kb.activeCell=Ha;kb.isBackward=Ab;return E.g(qb,"MoveToNextAmbiguousLinkedEntity",kb,Yb,Bb,Qb,sc,4)},Z=(qb,Ha,Ab,Yb,Bb,Qb,sc=null)=>{sc=qb.Na(9,sc);sc.activeCell=Ha;return E.g(qb,"CancelSearchLinkedEntity",sc,Ab,Yb,Bb,Qb,4)},P=(qb,Ha,Ab,Yb,Bb,Qb,sc,kb=null)=>{kb=qb.Na(1,kb);kb.selectedRanges=Ha;kb.letyDomainId=Ab;return E.g(qb,"GetDataTypeSelectorData",kb,
Yb,Bb,Qb,sc,4)},S=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"GetErrorMessageForLinkedDataTypeRefresh",Qb,Ha,Ab,Yb,Bb,4)},ja=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"GetHasUntrustedImageUrls",Qb,Ha,Ab,Yb,Bb,4)},X=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"LinkedEntitiesEnableUntrustedImages",Qb,Ha,Ab,Yb,Bb,0)},Y=(qb,Ha,Ab,Yb,Bb,Qb=null)=>{Qb=qb.Na(1,Qb);return E.g(qb,"LinkedEntityTryAutoRefresh",Qb,Ha,Ab,Yb,Bb,0)};var va=a(84),N=a(703),ea=a(790);class Ca{}
Ca.Jbi="EnrichmentContentFrame";Ca.width=320;Object(c.a)(Ca,"EnrichmentConstants",null,[]);class la{constructor(qb){this.messageType=0;this.messageType=qb}}Object(c.a)(la,"EnrichmentResponseMessage",null,[]);class Ra extends la{constructor(qb,Ha){super(qb);this.messageContent=null;this.messageContent=Ha}}Object(c.a)(Ra,"EnrichmentResponseMessageWithContent",la,[]);class lb extends Ra{constructor(qb,Ha,Ab){super(qb,Ha);this.telemetryJson=null;this.telemetryJson=Ab}}Object(c.a)(lb,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ra,[]);var Aa=a(260),da=a(14),aa=a(96),fa=a(45),Oa=a(85),ba=a(108),ka=a(41),Pa=a(80),Fa=a(27),oa=a(106),La=a(695),Ea=a(25);class ca{constructor(qb,Ha,Ab,Yb,Bb){this.lr=this.wk=this.Wae=this.Uae=this.aw=this.dv=null;this.tx=!1;this.Gi=qb;this.Yd=Ha;this.xP=Ab;this.Yb=Yb;this.La=Bb;this.pqa=ba.KeyInputManager.Gl(Oa.a.lpa,0)}get qNb(){return!0}get Gub(){return d.AFrameworkApplication.fa.Xa("EnrichmentPaneUrl")}dispose(){this.qNb&&this.lr&&(this.Gi.Ba(da.a.click,this.lr,Object(va.a)(this,this.rk,"onClosePaneClick")),
this.Yd.Ba(da.a.Fd,this.lr,Object(va.a)(this,this.kEf,"onKeyHide")));this.lr=null;this.aw&&(this.iVj(),this.aw.parentNode.removeChild(this.aw),this.aw=null);this.Yb.Bi("EnrichmentPaneId").Ik(this.pqa)}show(qb,Ha,Ab){this.dv=qb;this.tx||(this.wk=this.L1a(),this.Gna.appendChild(this.wk),this.Vcj(),this.La.Nb(Ea.a.HDe,oa.a.frame,Object(va.a)(this,this.r7h,"handleEscapeKeyAction")),this.bTa(),this.tx=!0);this.aw.src=this.Gub&&this.Gub.length?this.Gub+"?culture="+Ha.market+"&appName="+Ha.applicationName+
"&themeId="+Ha.themeId+"&featuresBitMask="+Ha.featuresBitMask:ca.Qxf;this.Uae=Ha;this.Wae=Ab;this.Leb()}SDc(qb,Ha){qb=new lb(2,qb,Ha);this.psc(qb)}bTa(){const qb=this.Yb.Bi("EnrichmentPaneId");qb.parent=Aa.AFrame.XOa;this.Gi.hob("EnrichmentPaneId",this.wk);qb.bindAction(this.pqa,Ea.a.HDe)}R3f(){if(this.aw){aa.FocusManager.Xoa(this.aw.contentWindow);const qb=new lb(4,null,null);this.psc(qb)}}rk(){this.x4b();return!0}kEf(qb){qb=qb.Ca.keyCode;return qb===Sys.UI.Key.enter||qb===Sys.UI.Key.space?(this.x4b(),
!0):!1}x4b(){this.hide();if(this.dv)this.dv.onPaneClosed()}L1a(){const qb=N.a("div","EnrichmentPaneId","EnrichmentPane");this.qNb&&qb.appendChild(this.W5c());this.wfi(qb);return qb}W5c(){const qb=N.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Ha=N.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Ha.innerText=CommonUIStrings.l_EnrichmentPaneTitle;Ha.title=CommonUIStrings.l_EnrichmentPaneTitle;const Ab=ea.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.Gi.sa(da.a.click,Ab,Object(va.a)(this,this.rk,"onClosePaneClick"));this.Yd.sa(da.a.Fd,Ab,Object(va.a)(this,this.kEf,"onKeyHide"));qb.appendChild(Ha);qb.appendChild(Ab);this.lr=Ab;return qb}wfi(qb){this.aw=N.b("iframe","","EnrichmentFrame");qb.appendChild(this.aw);this.aw.id=Ca.Jbi;this.aw.setAttribute("role","presentation")}Vcj(){fa.a.addHandler(this.aw,"load",Object(va.a)(this,this.ODf,"onIFrameLoad"));fa.a.addHandler(this.aw,"error",Object(va.a)(this,this.wpc,
"onIFrameError"));$addHandler(window,"message",Object(va.a)(this,this.PDf,"onIFrameMessage"))}iVj(){fa.a.removeHandler(this.aw,"load",Object(va.a)(this,this.ODf,"onIFrameLoad"));fa.a.removeHandler(this.aw,"error",Object(va.a)(this,this.wpc,"onIFrameError"));$removeHandler(window,"message",Object(va.a)(this,this.PDf,"onIFrameMessage"))}sih(){this.aw.src=ca.Qxf}hide(){this.zfc();this.sih()}r7h(qb,Ha,Ab){if(1!==Ab&&(this.hide(),this.dv))this.dv.onPaneClosed();return 32}ODf(){}wpc(){}PDf(qb){qb=qb.rawEvent;
if(!this.aw||-1!==this.aw.src.indexOf(qb.origin)){try{var Ha=ka.a(qb.data)}catch(Ab){return}if(!La.c(Ha.messageType)){qb=window.g_badCastCallback;window.g_badCastCallback=null;switch(Ha.messageType){case 2:this.psc(new lb(1,ka.c(this.Uae),this.Wae));break;case 1:this.psc(new Ra(0,this.hNh()));break;case 3:this.dv&&this.dv.selectEntity(Ha.messageContent);break;case 5:this.dv&&this.dv.QEb(Ha.messageContent);break;case 8:this.dv&&(Ha=ka.a(Ha.messageContent),0<Ha.DomainId?this.dv.dQd(Ha.Query,Ha.TelemetryJson,
Ha.DomainId,Ha.DomainIdString):this.dv.searchEntity(Ha.Query,Ha.TelemetryJson));break;case 6:this.dv&&this.dv.cancelSearch();break;case 11:Ha=ka.a(Ha.messageContent);Ha=ca.m6b("keydown","f6",Oa.a.YRb,!0,!1,Ha,!0,!1);this.aw&&this.aw.dispatchEvent(Ha);break;case 12:if(ka.a(Ha.messageContent).keyCode===Oa.a.JG&&(Ha=ca.m6b("keydown","esc",Oa.a.JG,!0,!1,!1,!1,!1),this.aw&&(this.aw.dispatchEvent(Ha),this.hide(),this.dv)))this.dv.onPaneClosed();break;case 13:this.dv&&this.dv.selectDataType(Ha.messageContent);
break;case 14:this.dv&&this.dv.showHelpArticle(Ha.messageContent);break;case 15:this.dv&&this.dv.showSurveyDialog(Ha.messageContent);break;case 16:this.dv&&(Ha=ka.a(Ha.messageContent),this.dv.insertTable(Ha.DomainId,Ha.DomainIdString))}window.g_badCastCallback=qb}}}hNh(){return ka.c([2,1,3,5,8,6])}psc(qb){qb=ka.c(qb);this.aw.contentWindow.postMessage(qb,Pa.a.dba(this.Gub))}static m6b(qb,Ha,Ab,Yb,Bb,Qb,sc,kb){Fa.a.Iw?(Qb=String.format("{0} {1} {2}",Qb?"Shift":"",sc?"Control":"",kb?"Alt":""),Qb.trim(),
Ab=document.createEvent("KeyboardEvent"),Ab.initKeyboardEvent(qb,Yb,Bb,window.self,Ha,0,Qb,!1,"en-US")):(Ha={},Ha.keyCode=Ab,Ha.ctrlKey=sc,Ha.shiftKey=Qb,Ha.altKey=kb,Ha.bubbles=Yb,Ha.cancelable=Bb,Ab=new KeyboardEvent(qb,Ha));return Ab}}ca.Qxf="about:blank";Object(c.a)(ca,"EnrichmentPane",null,[639,2]);class $a extends ca{constructor(qb){super(d.AFrameworkApplication.ta.Uy,d.AFrameworkApplication.ta.Zt,d.AFrameworkApplication.ta.Dea,d.AFrameworkApplication.ta.Me,d.AFrameworkApplication.ub);this.taskPane=
qb;this.taskPane.DMg(this.R3f)}get Gna(){return this.taskPane.mc}Leb(){this.taskPane.isVisible||this.taskPane.yg(!0)}zfc(){this.taskPane.yg(!1)}dispose(){this.taskPane&&(this.taskPane.Jhj(this.R3f),this.taskPane=null);super.dispose()}}Object(c.a)($a,"EnrichmentTaskPaneWrapper",ca,[]);class Qa{constructor(qb){this.cz=null;this.Hfa=qb}Dwi(qb,Ha){this.cz=qb;this.Hfa&&this.Hfa.show(this,Ha,null)}SDc(qb,Ha){this.Hfa&&this.Hfa.SDc(qb,Ha)}ezb(){this.Hfa&&this.Hfa.hide()}dispose(){this.Hfa&&(this.Hfa.dispose(),
this.Hfa=null)}selectEntity(qb){return this.cz?this.cz.selectEntity(qb):!1}searchEntity(qb,Ha){this.cz&&this.cz.searchEntity(qb,Ha)}dQd(qb,Ha,Ab,Yb){this.cz&&this.cz.dQd(qb,Ha,Ab,Yb)}QEb(qb){return this.cz?this.cz.QEb(qb):!1}onPaneClosed(){if(this.cz)this.cz.onPaneClosed()}cancelSearch(){this.cz&&this.cz.cancelSearch()}selectDataType(qb){this.cz&&this.cz.selectDataType(qb)}showHelpArticle(qb){this.cz&&this.cz.showHelpArticle(qb)}showSurveyDialog(qb){this.cz&&this.cz.showSurveyDialog(qb)}insertTable(qb,
Ha){this.cz&&this.cz.insertTable(qb,Ha)}}Object(c.a)(Qa,"EnrichmentManager",null,[637,2]);class Va extends Qa{constructor(qb){super(qb)}dispose(){super.dispose()}}Object(c.a)(Va,"ExcelEnrichmentManager",Qa,[]);var fb=a(13);class Ka{constructor(qb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=qb;this.commentQuestion=
fb.a.instance.mb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=fb.a.instance.mb(195);this.ratingValuesAscending=[fb.a.instance.mb(196),fb.a.instance.mb(197),fb.a.instance.mb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=fb.a.instance.mb(194)}}Object(c.a)(Ka,"FloodgateSurvey",null,[]);var hb=a(24),fc=a(76),dc=a(422),wb=a(40),Tb=a(374),xb=a(188),cb=a(33),jb=a(92),qa=a(29),za=a(1),Na=a(281),ua=a(21);class Xa{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(Xa,"EnrichmentMessageContentAppProperties",null,[]);class ha{constructor(qb,Ha,Ab,Yb,Bb){this.nua=this.wMe=!1;this.Fdb=this.txa=!0;this.kHb=this.zNb=!1;this.Xeb=null;this.rrc=0;this.DR=()=>{(this.Fdb||this.nua)&&2!==this.rrc&&(this.kHb||this.Gvd(!1))};this.Tc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.ONi=Qb=>{qa.a.dg(Qb.Errors)?(Qb=qa.a.sc(Qb.Errors),Qb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Qb}`)):Qb.Result&&(this.$.ea.tk(this.Tc),this.$.ea.Wj(this.Tc),Qb=Qb.Result,this.Xeb=Qb.SkydanceFeatureBitmask,this.Wzd(Qb),this.zNb=!0)};this.Dg=()=>{(this.Fdb||this.nua)&&this.Gvd(!1)};this.qpc=(Qb,sc)=>{qa.a.dg(Qb.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${qa.a.sc(Qb.Errors)}`):Qb.Result&&(Qb=Qb.Result,Qb.DisambiguationJson?(this.zNb=!1,this.Q4f(sc),this.Xeb=Qb.SkydanceFeatureBitmask,sc=Qb.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.kHb=!1,this.Bpf(sc)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.wQi=(Qb,sc)=>{qa.a.dg(Qb.Errors)?(sc=qa.a.sc(Qb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${sc}`)):Qb.Result&&(Qb=Qb.Result,Qb.DisambiguationJson?(this.Q4f(sc),this.Xeb=Qb.SkydanceFeatureBitmask,sc=Qb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.kHb=!0,this.Bpf(sc)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.cUi=Qb=>{qa.a.dg(Qb.Errors)?(Qb=qa.a.sc(Qb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Qb}`),this.Fdb=!0):Qb.Result&&(Qb=Qb.Result,this.Xeb=Qb.SkydanceFeatureBitmask,this.Wzd(Qb),this.zNb=!0)};this.PWi=Qb=>{if(qa.a.dg(Qb.Errors)){const sc=qa.a.sc(Qb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${sc}`)}Qb.Result?
(this.Wzd(Qb.Result),this.zNb=!0):this.nta()};this.GHf=Qb=>{qa.a.dg(Qb.Errors)?(Qb=qa.a.sc(Qb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Qb}`)):Qb.Result?this.B9b.SDc(Qb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.nta())};this.LSi=Qb=>{qa.a.dg(Qb.Errors)?(Qb=qa.a.sc(Qb.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${Qb}`)):this.nta()};this.$=qb;this.gridView=ua.h(this.$);this.gridView.ha.TT(this.Dg);this.gridView.lv(this.DR);this.pQe=Yb;this.convertToLinkedEntityManager=Bb;cb.a.fd(this.$)||Ab.zN(Ha);qb=new $a(Ha);this.B9b=new Va(qb);x.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{Qb.isFeatureEnabled("mso_sendASmile",!0).then(sc=>{this.txa=sc;return null})})}dispose(){this.$&&(this.gridView.ha.$R(this.Dg),
this.gridView.Ky(this.DR))}selectEntity(qb){const Ha=wb.o(this.gridView.ha.ra.activeCell,this.$),Ab=()=>new dc.a;Tb.a(this.$.userOperationManager,(Yb,Bb,Qb)=>J(this.$.pa.ya,Ha,qb,Na.b(Yb,this.PWi),Bb,Qb,null),Yb=>new xb.a(109,0,Yb,void 0,Ab),null);return!0}searchEntity(qb,Ha,Ab=!1,Yb=0,Bb=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Ha}`);const Qb=wb.o(this.gridView.ha.ra.activeCell,this.$);Tb.a(this.$.userOperationManager,
(sc,kb,Eb)=>M(this.$.pa.ya,Qb,qb,this.txa,Ab,Yb,Bb,Na.b(sc,this.GHf),kb,Eb,null),sc=>new xb.a(110,0,sc,16),null)}QEb(qb){const Ha=wb.o(this.gridView.ha.ra.activeCell,this.$);this.Fdb=!1;Tb.a(this.$.userOperationManager,(Ab,Yb,Bb)=>U(this.$.pa.ya,Ha,qb,Na.b(Ab,this.cUi),Yb,Bb,null),Ab=>new xb.a(111,0,Ab,16),null);return!0}onPaneClosed(){this.nua=!1;this.wMe=!0;this.rrc=0;this.kHb=!1}cancelSearch(){const qb=this.uQd();qb&&Tb.a(this.$.userOperationManager,(Ha,Ab,Yb)=>Z(this.$.pa.ya,qb,Na.b(Ha,this.GHf),
Ab,Yb,null),Ha=>new xb.a(112,0,Ha,16),null)}selectDataType(qb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.nta();if(qb&&qb.length)if(qb=JSON.parse(qb))if(null==qb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Ha={};Ha.Id=qb.domainId;Ha.StringId=qb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(Ha)}else b.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(qb){const Ha=new jb.a(-859308420,fc.a.Db,this.$.Hc,9,null);this.$.Ja.Lb(Ha,{[fc.a.og]:"HelpID="+qb,["InputMethod"]:fc.a.Db,["ShouldCanvasTakeFocus"]:!0,[fc.a.Jc]:t.a.wV})}showSurveyDialog(qb){C.a.ZNb(new Ka(qb))}insertTable(qb,Ha){const Ab=this.uQd();Ab&&Tb.a(this.$.userOperationManager,(Yb,Bb,Qb)=>
Q(this.$.pa.ya,Ab,qb,Ha,Na.b(Yb,this.LSi),Bb,Qb,null),Yb=>new xb.a(259,0,Yb,1),null)}Gvd(qb){this.launchOrCloseDisambiguationPane(qb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const qb=this.Frj();qb&&Tb.a(this.$.userOperationManager,(Ha,Ab,Yb)=>G(this.$.pa.ya,qb,!0,this.txa,!1,null,Na.b(Ha,this.wQi),Ab,Yb,1),Ha=>new xb.a(114,0,Ha,16),null)}launchLinkedEntityDataTypeSelectorPane(qb,
Ha){Tb.a(this.$.userOperationManager,(Ab,Yb,Bb)=>P(this.$.pa.ya,qb,Ha,Na.b(Ab,this.qpc),Yb,Bb,2),Ab=>new xb.a(233,0,Ab,16),null)}xwi(qb,Ha){qb&&Tb.a(this.$.userOperationManager,(Ab,Yb,Bb)=>G(this.$.pa.ya,qb,!1,!1,!0,Ha,Na.b(Ab,this.qpc),Yb,Bb,2),Ab=>new xb.a(257,0,Ab,16),null)}Q4f(qb){qb&&(this.rrc=qb)}Bpf(qb){if(za.EwaSettings.ma(642)){var Ha=new jb.a(-90814711,fc.a.Db,0,10,null);this.$.Ja.Lb(Ha,null)}this.nua?this.B9b.SDc(qb,null):(Ha=3,null!=this.Xeb?Ha=this.Xeb:b.ULS.shipAssertTag(537166937,0,
!1,"SkydanceFeatureBitmask was not set"),(qb=this.SSh(qb,Ha))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.pQe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.B9b.Dwi(this.pQe,qb),this.nua=!0)}nta(){this.nua&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.B9b.ezb(),this.nua=!1,this.rrc=0,this.kHb=!1)}Wzd(qb){var Ha=qb.Row+1;qb=qb.Column+1;
0>Ha||0>qb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.nta(),this.$.ea.tk(this.Tc)):(Ha=new hb.Range(Ha,qb,Ha,qb,!0,!1),this.gridView.ha.updateSelection(Ha,Ha,60),this.Fdb=!0)}SSh(qb,Ha){const Ab=new Xa;Ab.applicationVersion=d.AFrameworkApplication.buildVersion;Ab.applicationName="ExcelWac";Ab.anid="00000000-0000-0000-0000-000000000000";Ab.sessionId=d.AFrameworkApplication.userSessionId;Ab.appCorrelationId=
B.a.create().toString();var Yb=z.a.uK(d.AFrameworkApplication.lcid);Yb=Yb?Yb.name:null;Ab.uiLanguage=Yb;Ab.market=this.occ(Yb);Ab.themeId=0;Ab.disambiguationJson=qb;Ha<=A.a.QS?Ab.featuresBitMask=Ha:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ab}occ(qb){qb=qb.split("-");return qb[qb.length-1]}launchOrCloseDisambiguationPane(qb){const Ha=this.gridView.ha.ra.activeCell;if(this.uQd()&&Ha)if(this.gridView.Bb.gAb(Ha)){if((!this.wMe||
qb||this.zNb)&&!this.gridView.eb){qb&&(this.Fdb=!0);var Ab=wb.q(Ha,this.$);Tb.a(this.$.userOperationManager,(Yb,Bb,Qb)=>G(this.$.pa.ya,Ab,!1,this.txa,!1,null,Na.b(Yb,this.qpc),Bb,Qb,1),Yb=>new xb.a(114,0,Yb,16),null)}}else this.nta();else this.nta()}Kbj(){if(this.nua){var qb=this.gridView.ha.ra.activeCell;if(qb){var Ha=wb.q(qb,this.$);Tb.a(this.$.userOperationManager,(Ab,Yb,Bb)=>G(this.$.pa.ya,Ha,!1,this.txa,!1,null,Na.b(Ab,this.qpc),Yb,Bb,1),Ab=>new xb.a(114,0,Ab,16),null)}else this.nta()}}uQd(){const qb=
this.gridView.ha.ra;return qb.Zba()?wb.o(qb.activeCell,this.$):null}Frj(){const qb=this.gridView.ha.ra;return qb.Zba()?wb.q(qb.activeCell,this.$):null}}Object(c.a)(ha,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var ta=a(7),wa=a(378),db=a(1393),Jb=a(52),Pb=a(710);class eb{constructor(qb,Ha,Ab){this.Ypf=2;this.Xpf="Size64by48";this.$=qb;this.Va=Ha;this.convertToLinkedEntityManager=Ab}iLh(qb,Ha){var {ConvertToLinkedEntityManager:Ab}=a(760);this.KXj();Ha=this.Va.fq(Ha).MC();let Yb=0,Bb=0,Qb=!1;
for(var sc of qb.Categories){const kb=this.NLh(sc,Yb);kb&&(Bb===Ab.o9a&&(Qb=!0),Ha.MenuSectionList.push(kb),++Yb);++Bb}Qb&&Yb<=Ab.Zpf&&Ha.MenuSectionList.splice(Ab.o9a,1);Ab=this.Va.Ec().I2b();sc=Jb.a.me(11);for(const kb of qb.LongButtons)this.convertToLinkedEntityManager.NDj(kb)&&this.fJg(Ab,kb,sc);0<Ab.ControlList.length&&Ha.MenuSectionList.push(Ab);return Ha}fJg(qb,Ha,Ab){if(Ha){var Yb="Data.ConvertToLinkedEntityMenuItem_"+Ha.Name,Bb=this.convertToLinkedEntityManager.KU(Ha.DomainId);Bb&&(Ha=Object(ta.a)(new wa.a,
{Id:Yb,ExternalId:Yb,Command:"-1662108744",LabelText:Ha.Name,Alt:Ha.SuperTip,Visible:!0,MenuItemId:a(760).ConvertToLinkedEntityManager.G2a(Ha.DomainId),Image16by16:Ab,Image16by16Class:this.pci(Bb.FontLocator)}),qb.ControlList.push(Ha))}}ILh(qb,Ha){return Object(ta.a)(new db.a,{Id:a(760).ConvertToLinkedEntityManager.jOe+qb.toString(),ExternalId:a(760).ConvertToLinkedEntityManager.jOe+qb.toString(),MenuItemId:a(760).ConvertToLinkedEntityManager.B9c+qb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.cdf(Ha.FontLocator),LabelText:Ha.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.bgd(Ha)})}uTg(qb){switch(qb){case "Animal":return Pb.a.SPg;case "Apple":return Pb.a.WQg;case "Atom":return Pb.a.oSg;case "Beaker":return Pb.a.kUg;case "Bridge":return Pb.a.LVg;case "Cat":return Pb.a.K0g;case "City":return Pb.a.W2g;case "Constellation":return Pb.a.S7g;case "Dog":return Pb.a.eoh;case "Finance":return Pb.a.dUg;case "GradCap":return Pb.a.f6h;case "HumanAnatomy":return Pb.a.Gbi;
case "LocationPointer":return Pb.a.Xyi;case "Map":return Pb.a.u_i;case "MedicineNeedle":return Pb.a.yFi;case "Mountain":return Pb.a.RGi;case "Movie":return Pb.a.jHi;case "Music":return Pb.a.vHi;case "OuterSpace":return Pb.a.Y_i;case "Planet":return Pb.a.$2i;case "Satellite":return Pb.a.dpj;case "WolframGeneric":return Pb.a.aoj;default:return Pb.a.E9g}}pci(qb){if("PowerBIRibbon"!==qb)return y.a.abd;switch(qb){case "AnimalRibbon":return y.a.Xyh;case "AppleRibbon":return y.a.Yyh;case "AtomRibbon":return y.a.Zyh;
case "BeakerRibbon":return y.a.$yh;case "BridgeRibbon":return y.a.azh;case "CenterMapRibbon":return y.a.bzh;case "CityRibbon":return y.a.czh;case "CurrencyRibbon":return y.a.dzh;case "ExerciseRibbon":return y.a.ezh;case "FinanceRibbon":return y.a.CUe;case "FirstAidRibbon":return y.a.fzh;case "GlobeLightningRibbon":return y.a.gzh;case "GradCapRibbon":return y.a.hzh;case "HumanAnatomyRibbon":return y.a.izh;case "LeafRibbon":return y.a.jzh;case "LocationPointerRibbon":return y.a.lzh;case "MapRibbon":return y.a.AUe;
case "MountainRibbon":return y.a.mzh;case "MovieRibbon":return y.a.nzh;case "MusicRibbon":return y.a.ozh;case "NotablePeopleRibbon":return y.a.pzh;case "OuterSpaceRibbon":return y.a.qzh;case "PartlySunnyWeatherRibbon":return y.a.rzh;case "PowerBIRibbon":return y.a.BUe;case "SatelliteRibbon":return y.a.szh;case "WolframGenericRibbon":return y.a.kzh;case "YogaRibbon":return y.a.uzh;default:return y.a.zUe}}cdf(qb){switch(qb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}NLh(qb,Ha){Ha=this.Va.bB("ConvertToLinkedEntitySection_"+Ha,this.Ypf,this.Xpf);var Ab=!1;for(var Yb of qb.DomainIds){const Bb=this.convertToLinkedEntityManager.KU(Yb);if(!Bb||
Bb.DomainBlocked||!Bb.ShowInRibbon)continue;Ab=Bb.Name;const Qb=a(760).ConvertToLinkedEntityManager.G2a(Yb);Ha.lu("Data.ConvertToLinkedEntityMenuItem_"+Qb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Qb,this.cdf(Bb.FontLocator),void 0,void 0,this.bgd(Bb),Ab);Ab=!0}if(!Ab)return null;Yb=Ha.wqb(!0);Ha=this.Va.Ec();Ha.title=qb.Name;qb=Ha.I2b();qb.ControlList.push(Yb);return qb}KXj(){this.Ypf=5;this.Xpf="Size112by64"}bgd(qb){return qb.RibbonTooltipHeader?qb.RibbonTooltipHeader+"\n\n"+qb.RibbonTooltip:
qb.RibbonTooltip}}Object(c.a)(eb,"ConvertToLinkedEntityMenuRenderer",null,[611]);var Ma=a(58),ob=a(283),Ia=a(116),Da=a(145),nb=a(72);class Ua{constructor(qb,Ha){this.Jld=this.Kld=!1;this.CVi=Ab=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Kld=!0;if(qa.a.dg(Ab.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${qa.a.sc(Ab.Errors)}`);else{var Yb=0,Bb=[],Qb=!1;try{if(!Ab.Result)return;const sc=Ab.Result;if(!sc){b.ULS.sendTraceTag(537166678,
0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Bb=this.n1i(sc);if(!Bb||!Bb.length)return;Yb=Bb.length;this.NFi(Bb);this.NAa.mYf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.NAa.ecb.length}`);if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const kb of this.NAa.ecb)if(1===(kb.Id&1048320)>>8){Qb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Qb}`)}}finally{b.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Yb} data types.`),Ab=[],Ab.push(Object(ta.a)(new nb.a,{name:"MruCount",int64:Yb})),Ab.push(Object(ta.a)(new nb.a,{name:"MruWolframAvailable",bool:Qb})),Da.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Ab)}this.Jld&&(this.Kmg(this.NAa.ecb),this.Jld=!1)}};this.TZi=Ab=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");qa.a.dg(Ab.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${qa.a.sc(Ab.Errors)}`):
Ab.Result&&(Ab.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.kHf=(Ab,Yb,Bb)=>{Ab=Ia.a.Pe(Ab.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Bb}. Errors: ${qa.a.sc(Ab)}.`)};this.$=qb;this.NAa=Ha}I_h(){this.Kld||za.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.Zb||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
ob.w(this.$.pa.ya,0,this.CVi,this.kHf,null,null))}Kmg(qb){qb&&qb.length?this.Kld?(qb=this.mtj(qb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),ob.C(this.$.pa.ya,0,qb,this.TZi,this.kHf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Jld=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}mtj(qb){if(!qb||
!qb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Ha=[];for(const Ab of qb)qb={},qb.Id=Ab.Id,Ab.StringId&&(qb.StringId=Ab.StringId),Ha.push(qb);Ha="<DataTypes>"+Ma.a.hc(Ha)+"</DataTypes>";return 1906<Ha.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Ha}n1i(qb){if(!qb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!qb.startsWith("<DataTypes>")||!qb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;qb=qb.substring(11,qb.length-12);if(!qb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Ha=[];try{Ha=Ma.a.ki(qb)}catch(Ab){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Ab.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Ha.length} data types.`);return Ha}NFi(qb){const Ha=this.NAa.ecb,Ab=this.NAa.Iaj;if(Ha.length!==Ab){for(let Yb=0;Yb<qb.length&&Ha.length<Ab;++Yb){const Bb=qb[Yb];this.NAa.KU(Bb)&&!Ha.includes(Bb)&&Ha.push(Bb)}this.NAa.ecb=Ha}}}Object(c.a)(Ua,"LinkedDataTypeRoamingHandler",null,[]);var W=a(59),sa=a(49),vb=a(190),gc=a(37),Bc=a(47),Sa=a(28),na=a(282),ib=a(22),Ib=a(99);a.d(F,"ConvertToLinkedEntityManager",function(){return ec});
class ec extends r.a{constructor(qb,Ha,Ab,Yb,Bb,Qb,sc){super();this.nmf=this.utd=this.qud=this.msd=this.lsd=this.Y7a=this.npd=null;this.sFb=this.lld=0;this.Jla=null;this.zpd=!1;this.led=this.co=this.aPd=null;this.Hs=0;this.TY=null;this.bMa=8;this.V0c=this.Wpf=this.rif=this.Hab=!1;this.Jza=this.H_e=this.CXe=null;this.RZc=0;this.GTg=5;this.Z1b=3E4;this.Yeg=!1;this.e3=null;this.Dua=Array(5);this.zhg=this.F0d=!1;this.zZf=this.fwd=0;this.htmlSanitizationHelper=this.Oee=null;this.Q9f=!0;this.Tc=(kb,Eb)=>
{Eb.Zb&&!Eb.TBb&&this.showUntrustedImageBusinessBarIfNecessary()};this.xRi=kb=>{if(kb.Result){var Eb=kb.Result;if(Eb&&Eb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Eb.length} labels`);var Gc=sa.GetServiceTaskFactory.Oa(this.$.da,274,275,0);gc.TaskExtensions.za(Gc,()=>{Gc.result.HZc(Eb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.Bf=()=>{this.fBb&&(this.TSj(),this.$7h(this.$.ea.Ho.LinkedEntityAsyncRefreshStateId));this.f8a?this.b9h(this.$.ea.Ho.RichDataClassificationLabelStateId):this.n7a&&this.S_d(!0)};this.UOi=()=>{this.F0d=!0;this.co&&this.co.Kbj()};this.PQi=kb=>{if(kb&&!na.a(kb))try{kb.Result.HasUntrustedImageUrl&&(this.businessBar.ng(59,null),this.zhg=!0)}catch(Eb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Eb}.`)}};
this.ypf=()=>{if(!this.Wpf&&this.xAb()&&!this.nqd())if(Da.a("DataTabActive"),W.a.Bg.iR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var kb=this.$5b();if(kb){var Eb={};Eb.InputMethod=fc.a.Db;Eb.CalloutName=8;Eb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ja.Lb(kb,Eb);this.Wpf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.PNi=kb=>{qa.a.dg(kb.Errors)||(this.f8a||this.S_d(!1),this.raiseEvent("LinkedEntityConverted"))};this.SXi=()=>{this.$.da.$a(211,kb=>{kb.readText(fb.a.instance.ga(1804))})};this.ed=(kb,Eb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Eb.RV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.hCe():this.Elj(),za.EwaSettings.ma(642)&&this.F0d&&this.rPe())};this.ZQi=kb=>{this.h4b();if(kb.Result){var Eb=kb.Result;kb=Eb.DomainDataArray;if(this.Jla=Eb.Ribbon){var Gc={};Gc.Name=fb.a.instance.ga(1794);Gc.DomainIds=this.SK;this.Jla.Categories.splice(ec.o9a,0,Gc)}0<Eb.MaximumCellsToConvert&&(this.Oee=Eb.MaximumCellsToConvert);this.Hs=2;Eb=!1;if(kb){b.ULS.sendTraceTag(39949271,0,50,
`OnGetLinkedEntityServiceDomainsSuccess: Received ${kb.length} domains`);this.xOa||(this.xOa=[]);Gc=fb.a.instance.ga(1791);const zc=fb.a.instance.ga(1793);for(const yb of kb)yb.DomainId?(this.xOa.push(yb),yb.DomainBlocked?(kb=!!yb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${kb?yb.DomainId.Id.toString():yb.Name} is telemetry only, do not show in menu (Has String ID: ${kb})`)):(this.JU.ia(ec.G2a(yb.DomainId),yb),yb.Name===Gc||268435456===yb.DomainId.Id?this.CXe=yb.DomainId.Id.toString():
yb.Name===zc||536870912===yb.DomainId.Id?this.H_e=yb.DomainId.Id.toString():268435712===yb.DomainId.Id&&yb.ShowInRibbon&&(this.V0c=!0),Eb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Eb||(this.xOa=null);this.nig();this.aPd.I_h();this.Yeg||(this.PSj(),this.Yeg=!0)}else this.xOa=null,this.Hs=3,-1<this.bMa&&window.setTimeout(()=>{this.gIb()},100*(8-this.bMa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.KKd();this.jIe();this.V0c&&this.Jjf&&vb.c(this.ypf,this.$.ka,500);this.n7a&&!this.f8a&&this.S_d(!0)};this.YQi=kb=>{kb=Ia.a.Pe(kb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${qa.a.sc(kb)}].`);this.xOa=null;this.Hs=3;this.Hab=!0;this.KKd()};this.onContentReady=()=>{this.kgg()&&this.gridView.Ky(this.onContentReady);this.Q9f&&this.$.workbookContext.Options&1048576&&(this.businessBar.EHj(),this.Q9f=!1)};this.gj=()=>{this.h4b()};this.CTi=kb=>{if(na.a(kb)){const Eb=
sa.GetServiceTaskFactory.Oa(this.$.da,5,4,0);gc.TaskExtensions.za(Eb,()=>{let zc=null;if(null===kb||void 0===kb?0:kb.Errors)zc=kb.Errors[0];Eb.result.v9f(zc,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${qa.a.sc(kb.Errors)}].`);const Gc=qa.a.RB(kb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Po(Gc)}};
this.M0c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.Z1b} millisecond interval`);this.Wff("Periodic auto-refresh check",this.gMi,this.fMi)};this.gMi=kb=>{na.a(kb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${qa.a.sc(kb.Errors)}].`),++this.RZc):this.RZc=0;e.a.Ia(this.Jza);this.RZc>=this.GTg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Jza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Jza=Bc.a.instance.create(this.M0c,this.Z1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.fMi=kb=>{kb=Ia.a.Pe(kb.data);f.a.rh(kb)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${qa.a.sc(kb)}].`);e.a.Ia(this.Jza);this.Jza=Bc.a.instance.create(this.M0c,this.Z1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.BUi=kb=>{kb=!!kb.Result&&kb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${kb.toString()}`);kb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Sa.a.Qa.we.m-
this.lld} ms, retry count = ${this.sFb}`),this.gIb()):this.LAc()};this.AUi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.LAc()};this.AQi=kb=>{kb.Result?(kb=kb.Result)?(this.ULd(),this.businessBar.v9f(null,kb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=qb;this.businessBar=Qb;this.svgIconProvider=
Ab;this.htmlSanitizationHelper=sc;this.xOa=[];this.SK=[];this.gridView=ua.h(this.$);this.Uec=-1;this.Foi=za.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.n7a=this.$.ma(434)&&this.$.ma(286);this.f8a=this.$.ma(662);this.fBb=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.Jjf=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.JU=new Ib.a;
this.W9a=new eb(qb,Ha,this);Yb&&(this.co=new ha(qb,Yb,Bb,this,this));this.$.ll(this.ed);v.a(this.$)&&v.a(this.$).Quj(this);this.hCe();(this.fBb||this.n7a||this.f8a)&&this.$.ea.nu(this.Bf);za.EwaSettings.ma(129)&&za.EwaSettings.ma(137)&&(this.kgg()||this.gridView.lv(this.onContentReady));this.$.QA(this.gj);za.EwaSettings.ma(642)&&(this.$.ea.Wj(this.Tc),this.showUntrustedImageBusinessBarIfNecessary());this.aPd=new Ua(this.$,this)}dispose(){(this.fBb||this.n7a||this.f8a)&&this.$.ea.Nv(this.Bf);za.EwaSettings.ma(642)&&
this.$.ea.tk(this.Tc);!this.e3&&za.EwaSettings.ma(129)&&za.EwaSettings.ma(137)&&this.gridView.Ky(this.onContentReady);this.co&&this.co.dispose();this.$.aE(this.gj);this.$.Kl(this.ed);this.n7a&&(this.npd=null);e.a.Ia(this.Jza)}jMg(qb){this.addHandler("LinkedEntityConverted",qb)}thj(qb){this.removeHandler("LinkedEntityConverted",qb)}get Iaj(){return 5}get ecb(){return this.SK}set ecb(qb){this.SK=qb}selectEntity(qb){return this.co?this.co.selectEntity(qb):!1}searchEntity(qb,Ha){this.co&&this.co.searchEntity(qb,
Ha)}dQd(qb,Ha,Ab,Yb){this.co&&this.co.searchEntity(qb,Ha,!0,Ab,Yb)}QEb(qb){return this.co?this.co.QEb(qb):!1}onPaneClosed(){if(this.co)this.co.onPaneClosed()}cancelSearch(){this.co&&this.co.cancelSearch()}selectDataType(qb){this.co&&this.co.selectDataType(qb)}showHelpArticle(qb){this.co&&this.co.showHelpArticle(qb)}showSurveyDialog(qb){this.co&&this.co.showSurveyDialog(qb)}insertTable(qb,Ha){this.co&&this.co.insertTable(qb,Ha)}b9h(qb){this.$.isEditMode&&this.zZf!==qb&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&
(this.zZf=qb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),I(this.$.pa.ya,this.xRi,null,null,null))}rPe(){this.$.userOperationManager.Ic(new xb.a(589,0,(qb,Ha,Ab)=>X(this.$.pa.ya,Na.b(qb,this.UOi),Ha,Ab,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.F0d||this.zhg||!this.$.ea.Zb||this.ssj()}ssj(){this.$.userOperationManager.Ic(new xb.a(588,0,(qb,Ha,Ab)=>ja(this.$.pa.ya,Na.b(qb,this.PQi),Ha,Ab,null),80),
null)}S_d(qb){if(this.n7a&&null==this.npd&&!this.f8a&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.Y7a&&this.Y7a&&(!qb||this.$.workbookContext.Options&262144)){var Ha=sa.GetServiceTaskFactory.Oa(this.$.da,274,275,0);gc.TaskExtensions.za(Ha,()=>{this.npd=Ha.result.YSf(2)},this.$.ka,3)}}get sEb(){return this.Dua.length}get tFi(){return this.Oee}F9g(qb){(qb=this.ioh(qb))?this.convertToLinkedEntity(qb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(qb){b.ULS.sendTraceTag(34415004,
0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${qb.Id}].`);if(this.gridView){var Ha=this.gridView.ha.ra.dd,Ab=Ha.Ie(this.gridView.HH);this.zpd&&this.TJg(qb);if(Ab){Ab=this.gridView.Bb.Gxa(Ab);if(!this.vaf(qb)&&this.Lkf(qb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(W.a.Bg.iR){Ha=this.ufd();if(!Ha){b.ULS.sendTraceTag(537166917,
0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ab=this.$5b();if(!Ab){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var Yb={["InputMethod"]:fc.a.Db,CalloutName:3};Yb.Target=Ha;Yb.RibbonButtonLabel=za.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.nZf(qb):this.ICb(qb.Id.toString());Yb.ExampleEntities=this.AVe(qb);this.$.Ja.Lb(Ab,Yb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Lkf(qb.Id)&&
!qb.StringId)this.launchLinkedEntityDataTypeSelectorPane(ec.G2a(qb));else{if(Ab){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.HMj(qb)){Ha=wb.r(this.gridView.ha.ra.selectedRanges,this.$);this.co.xwi(Ha,qb);return}if(W.a.Bg.iR){Ha=this.ufd();if(!Ha){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}Ab=this.$5b();if(!Ab){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}Yb={["InputMethod"]:fc.a.Db,CalloutName:2};Yb.Target=Ha;Yb.RibbonButtonLabel=this.nZf(qb);Yb.ExampleEntities=this.AVe(qb);Yb.BlankCellResourceId=this.LUg(qb);Yb.HasBlankCellWalkthrough=this.Q9h(qb);Yb.ServiceDomain=qb.Id;this.$.Ja.Lb(Ab,Yb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.U4c(qb,
!1,Ha)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.e3&&this.e3.BIa()}onAutoDetectUIShown(){Tb.a(this.$.userOperationManager,(qb,Ha,Ab)=>V(this.$.pa.ya,qb,Ha,Ab,null),qb=>new xb.a(230,0,qb,80),null)}U4c(qb,Ha,Ab){const Yb=wb.q(Ab,this.$),Bb=()=>new dc.a;Tb.a(this.$.userOperationManager,(Qb,sc,kb)=>L(this.$.pa.ya,Yb,qb,Ha,Na.b(Qb,this.PNi,this.SXi,this.co.ONi),sc,kb,null),Qb=>new xb.a(115,0,Qb,void 0,Bb),null)}TJg(qb){if(this.zpd){var Ha=
{};Ha.Id=qb.Id;qb.StringId&&(Ha.StringId=qb.StringId);if(!(0<this.SK.length&&this.SK[0].Id===Ha.Id&&this.SK[0].StringId===Ha.StringId)){qb=!1;this.SK.splice(0,0,Ha);for(let Ab=1;Ab<this.SK.length;++Ab)if(this.SK[Ab].Id===Ha.Id&&this.SK[Ab].StringId===Ha.StringId){this.SK.splice(Ab,1);qb=!0;break}for(;5<this.SK.length;)this.SK.splice(this.SK.length-1,1);this.Jla.Categories[ec.o9a].DomainIds=this.SK;this.mYf();qb||this.aPd.Kmg(this.SK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,
"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var qb=wb.q(this.gridView.ha.ra.dd,this.$);Tb.a(this.$.userOperationManager,(Ha,Ab,Yb)=>H(this.$.pa.ya,qb,Ha,Ab,Yb,null),Ha=>new xb.a(116,0,Ha),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(ua.h(this.$)){this.$.isEditMode||
b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.ULd();var qb=wb.r(this.gridView.ha.ra.selectedRanges,this.$);Tb.a(this.$.userOperationManager,(Ha,Ab,Yb)=>D(this.$.pa.ya,qb,Ha,Ab,Yb,null),Ha=>new xb.a(248,0,Ha),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}NDj(qb){qb=this.KU(qb.DomainId);if(!qb||qb.DomainBlocked||za.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!qb.HasCuratedData)return!1;if(this.Foi){for(let Ha of this.JU)if(Ha.value.DomainId.Id===qb.DomainId.Id&&Ha.value.ShowInRibbon)return!0;return!1}return qb.ShowInRibbon}BCj(qb){return 2!==this.Hs||!this.Dua[qb]}launchDisambiguationPaneForSearch(){this.co&&this.co.launchDisambiguationPaneForSearch()}Kc(qb,Ha,Ab){if("PopulateConvertToLinkedEntityMenu"!==Ha)return!1;this.led=Ab.MenuId;if(0===this.Hs||3===this.Hs)return this.A3i(),!0;if(!this.Jla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.JU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.TY=this.TY||this.W9a.iLh(this.Jla,Ab.MenuId);Ab.MenuItems=this.TY;return this.zpd=!0}A3i(){-1===this.Uec&&(this.gIb(),this.Uec=window.setInterval(()=>{this.gIb()},2E3))}gIb(){this.$.ea.Zb&&2!==this.Hs&&(this.bMa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Hs=1,T(this.$.pa.ya,this.ZQi,this.YQi,null,null))}nqd(){return this.$.isEditMode&&
2!==this.Hs&&(0<=this.bMa||!this.Hab)}q1d(qb){d.AFrameworkApplication.Og?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):v.a(this.$)?(this.mYj(),qb&&this.$.df()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}Elj(){this.sFb=0;this.bMa=8;this.Hab=!1;this.Hs=this.Uec=0;this.xOa=this.Jla=null;this.h4b();for(let qb=0;qb<this.sEb;++qb)this.Dua[qb]=null;this.xAb()&&this.q1d(!0)}h4b(){this.TY=null}xAb(){const qb=
t.a.YIb,Ha=v.a(this.$);return!!Ha&&Ha.Em.dA===qb}nig(){if(this.Jla){let Ab=0;var qb=-1,Ha=-1;let Yb=0,Bb=0,Qb=0,sc=0;const kb=[null,null,null,null,null];for(const Eb of this.Jla.Categories){let Gc=!1;for(const zc of Eb.DomainIds){let yb=this.KU(zc);yb&&!yb.DomainBlocked&&yb.ShowInRibbon&&(Ab<this.sEb?(this.Dua[Ab]=zc,Bb===ec.o9a&&(-1===qb&&(qb=Ab),Ha=Ab,sc=Ha-qb+1),++Ab):Ab===this.sEb&&Yb<sc&&Bb!==ec.o9a&&(kb[Yb]=zc,++Yb),Gc=!0)}Gc&&++Qb;++Bb}if(-1<qb&&Qb<=ec.Zpf){for(;Ha>=qb;--Ha)this.Dua.splice(Ha,
1);for(qb=0;qb<sc;++qb)this.Dua.splice(Ab+qb,0,kb[qb])}for(;Ab<this.sEb;)this.Dua[Ab]=null,++Ab}}kgg(){const qb=ua.h(this.$).Da,Ha=this.gridView.ha.Oe;if(qb&&qb.qld&&1===Ha&&this.gridView.ha.ra.activeCell){const Ab=sa.GetServiceTaskFactory.Oa(this.$.da,12,477,1);za.EwaSettings.isChangeGateEnabled("OfficeVSO:7252908_ConvertToLinkedEntityManagerInvalidOperationFix")?gc.TaskExtensions.za(Ab,()=>{this.e3=new w.a(this.$,this.svgIconProvider,Ab.result,this,this.htmlSanitizationHelper)},this.$.ka,3):this.e3=
new w.a(this.$,this.svgIconProvider,Ab.result,this,this.htmlSanitizationHelper);return!0}return!1}Awi(){this.co&&this.co.Gvd(!0)}launchLinkedEntityDataTypeSelectorPane(qb){if(this.co)if(qb=this.h9c(qb))if(qb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Ha=wb.r(this.gridView.ha.ra.selectedRanges,this.$);this.co.launchLinkedEntityDataTypeSelectorPane(Ha,qb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}W7g(qb){const Ha=
this.oci(qb),Ab=h.a.Hg(this.ICb(qb));qb=h.a.Hg(this.SZd(qb));return ec.LKh(Ha,Jb.a.me(11),Ab,qb)}SZd(qb){try{return this.wNe(parseInt(qb,10)).Description}catch(Ha){}return fb.a.instance.ga(1788)}ICb(qb){try{return this.wNe(parseInt(qb,10)).Name}catch(Ha){}return fb.a.instance.ga(1774)}nZf(qb){try{return this.KU(qb).Name}catch(Ha){}return this.ICb(qb.Id.toString())}LUg(qb){try{return this.KU(qb).BlankCellResourceId}catch(Ha){}return null}Q9h(qb){try{return this.KU(qb).HasBlankCellWalkthrough}catch(Ha){}return!1}vaf(qb){try{const Ha=
ec.G2a(qb);if(this.JU.lb(Ha))return this.JU.na(Ha).HasCuratedData}catch(Ha){}return!1}HMj(qb){try{return this.KU(qb).SupportsStarterData}catch(Ha){}return!1}Lkf(qb){return 268435968===qb}ufd(){return 2===v.a(this.$).BO?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}$5b(){return new jb.a(-847286761,fc.a.Db,this.$.Hc,0,t.a.u0)}jIe(){if(this.xAb()&&!this.nqd()&&!this.rif&&za.EwaSettings.ma(434)&&this.vaf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
W.a.Bg.iR){const Ab=this.ufd();if(Ab){var qb=this.$5b();if(qb){var Ha={["InputMethod"]:fc.a.Db,CalloutName:6};Ha.Target=Ab;Ha.ShouldCanvasTakeFocus=!0;this.$.Ja.Lb(qb,Ha);this.rif=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Pbi(qb){qb=
this.h9c(qb);return qb?this.W9a.uTg(qb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}thc(qb){return this.e3?this.e3.tTg(qb):!1}MNh(){return this.e3?this.e3.IOh():""}Sji(){return this.e3?this.e3.nDb:!1}BSh(qb,Ha){const Ab=this.Qdf(qb);if(0>Ab)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${qb}`);else if(qb=(qb=this.xNe(qb))?this.KU(qb):
null)Ha[n.a.GalleryButtonProps]=this.W9a.ILh(Ab,qb),Ha[n.a.Alt]=this.W9a.bgd(qb)}mYf(){this.nig();this.xAb()&&this.q1d(!0);this.h4b()}oci(qb){return qb===this.CXe?y.a.CUe:qb===this.H_e?y.a.AUe:y.a.zUe}AVe(qb){try{return this.KU(qb).ExampleEntities}catch(Ha){}return fb.a.instance.ga(1796)}KKd(){(0>this.bMa||this.Hab)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Hs||0>this.bMa||this.Hab)&&window.clearInterval(this.Uec);this.nqd()?
this.led&&this.$.frame.px(this.led):this.q1d(this.xAb())}Hb(qb){return this.$.Eb+qb}mYj(){var qb=!0;const Ha=Array(this.sEb),Ab=v.a(this.$)?v.a(this.$).Em:null;if(Ab){for(let Yb=0;Yb<Ha.length;++Yb)this.BCj(Yb)?Ha[Yb]=!0:qb=Ha[Yb]=!1;Ab.xSd(["ConvertToLinkedEntityGallery"],qb);if(!qb)for(qb=0;qb<Ha.length;++qb)Ha[qb]&&Ab.xSd([this.ASh(qb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}KU(qb){const Ha=ec.G2a(qb);if(this.JU.lb(Ha))return this.JU.na(Ha);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${qb.Id} (Has String ID: ${!!qb.StringId})`);return null}ASh(qb){return"ConvertToLinkedEntityPreview"+qb.toString()}h1d(){m.a.get_instance().$j(10,()=>{this.jIe();this.V0c&&this.Jjf&&vb.c(this.ypf,this.$.ka,500)})}Iec(qb,Ha){switch(qb){case "QueryLinkedEntityGalleryButtons":if(!Ha[n.a.InnerHTML]){qb=Ha[fc.a.Jc].toString();const Ab=ib.a.equals(qb,fb.a.instance.ga(1791),!0)||ib.a.equals(qb,fb.a.instance.ga(1792),!0),Yb=ib.a.equals(qb,fb.a.instance.ga(1793),
!0);Ab||Yb||this.BSh(qb,Ha)}break;case "QueryLinkedEntityMenuGalleryButtons":Ha[n.a.InnerHTML]||(Ha[n.a.InnerHTML]=this.W7g(Ha[fc.a.Jc]))}return Ha}ioh(qb){var Ha=this.xNe(qb);if(Ha)return Ha;if(Ha=this.h9c(qb))return Ha.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${qb}`);return null}wNe(qb){const Ha={};Ha.Id=qb;return this.KU(Ha)}h9c(qb){return this.JU.lb(qb)?this.JU.na(qb):null}Qdf(qb){if(!qb.startsWith(ec.B9c))return-1;const Ha=parseInt(qb.substr(ec.B9c.length),
10);return isNaN(Ha)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${qb}`),-1):Ha}xNe(qb){qb=this.Qdf(qb);return 0>qb?null:this.Dua[qb]}Wff(qb,Ha,Ab){this.fBb&&this.JU&&this.JU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${qb})`),qb=this.$.pa.ya.Wb(),this.$.ea.Zb&&Y(this.$.pa.ya,Na.b(this.CTi,Ha),Ab,null,null,qb))}PSj(){this.Wff("Auto-refresh on load",null,null)}TSj(){this.fBb&&this.JU&&this.JU.count&&
(this.Jza?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Ho.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Jza=Bc.a.instance.create(this.M0c,this.Z1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}LAc(){if(this.$.ea.Zb&&null!=this.Y7a&&null!=this.lsd&&null!=this.msd&&null!=this.qud&&null!=this.utd)if(++this.sFb,12>=this.sFb){1===this.sFb&&(this.lld=Sa.a.Qa.we.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const qb=this.$.pa.ya.Wb();
ob.u(this.$.pa.ya,this.Dxi,this.Exi(),this.BUi,this.AUi,null,qb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Sa.a.Qa.we.m-this.lld} ms`),this.Hab=!0,this.KKd()}hCe(){if(this.$.isEditMode)if(null!=this.Y7a)this.LAc();else{var qb=Sa.a.Qa.we.m,Ha=[];x.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ab=>{Ab.isFeatureEnabled("ExcelPowerBiPro",!1).then(Yb=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Sa.a.Qa.we.m-qb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${Yb}]`);return this.Y7a=Yb}).then(()=>{Ha.push(Ab.isFeatureEnabled("ExcelWolframAlpha",!1).then(Yb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Sa.a.Qa.we.m-qb} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${Yb}]`);return this.qud=Yb}))}).then(()=>{Ha.push(Ab.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(Yb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Sa.a.Qa.we.m-qb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${Yb}]`);
let Bb;const Qb=[(Bb=new nb.a,Bb.name="IsRestrictedByLicense",Bb.bool=Yb,Bb)];Da.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Qb);this.nmf=Yb&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Yb}))}).then(()=>{Ha.push(Ab.isFeatureEnabled("StockHistory",!1).then(Yb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Sa.a.Qa.we.m-qb} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${Yb}]`);return this.utd=Yb}))}).then(()=>{Ha.push(Ab.isFeatureEnabled("ExcelPowerBiFree",!1).then(Yb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Sa.a.Qa.we.m-qb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${Yb}]`);return this.lsd=Yb}))}).then(()=>
{Ha.push(Ab.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(Yb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Sa.a.Qa.we.m-qb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${Yb}]`);return this.msd=Yb}))}).then(()=>{Promise.all(Ha).then(()=>{this.LAc()})})})}}get Dxi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}Exi(){return[this.Y7a,
this.qud,this.utd,this.lsd,this.msd,this.nmf]}ULd(){this.businessBar&&this.businessBar.fla(58)&&this.businessBar.removeEntry(58)}$7h(qb){this.fwd!==qb&&this.businessBar&&((this.fwd=qb)?S(this.$.pa.ya,this.AQi,null,null,null):this.ULd())}static LKh(qb,Ha,Ab,Yb){qb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',qb,Ha,Yb);Ab=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Ab);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',qb,Ab)}static G2a(qb){return qb.StringId?qb.Id.toString()+"."+qb.StringId:qb.Id.toString()}}ec.jOe="ConvertToLinkedEntityPreview";ec.B9c="PreviewGalleryButtonIndex.";ec.o9a=0;ec.Zpf=2;Object(c.a)(ec,"ConvertToLinkedEntityManager",r.a,[571,572,2,573])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/3937c9d5e6e64cb8fcbd8a136809d0aa/EwaDSEsNext.le.js.map