/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1146:function(u,F,a){u=a(0);var c=a(15),b=a(694),e=a(76),f=a(37);class d{constructor(na,ib){this.automateCommandManager=na;this.$=ib}nc(){return!1}executeCommand(na,ib,Ib){na=f.TaskExtensions.Uj();ib=ib.command;switch(ib){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Xc(2045014907,-1,0,null),this.automateCommandManager.wlc(ib,
1904816141===ib?Ib[e.a.Jc].toString():null)}return na}wc(na,ib){na=!1;switch(ib.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:na=this.$.MV}return na}Kc(na,ib,Ib){return"PopulateAutomateGalleryMenu"===ib&&this.$.MV?(this.automateCommandManager.Kc(ib,Ib),!0):!1}}Object(u.a)(d,"AutomateCommandHandler",null,[208]);var h=a(462);class n extends b.a{constructor(na){super(na)}ld(){h.a(this.$,374,375,
this.Ya,()=>{const na=this.$.da.Aa(352);na?this.Zc([new d(na,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static la(na){na.da.Ga(308,new n(na))}}Object(u.a)(n,"AutomateCommandHandlerFactory",b.a,[]);b=a(222);var m=a(7),x=a(4);class r{constructor(){this.token=null;this.timeStamp=0}}Object(u.a)(r,"AuthContext",null,[]);var y=a(723),t=a(132),v=a(110),w=a(28),C=a(766),B=a(145),z=a(72);class A{constructor(na,ib,Ib){var ec,
qb;this.$=na;this.oAuthManager=ib;this.nv=Ib;this.c3=new r;this.Upb=null!==(qb=null===(ec=this.oAuthManager)||void 0===ec?void 0:ec.YMa())&&void 0!==qb?qb:!1}getAuthContext(){return this.c3}bba(){const na=w.a.Qa.zb,ib=[];if(this.oAuthManager)ib.push(Object(m.a)(new z.a,{name:"IsAuthSupported",bool:this.Upb}));else return this.$ua(ib,na,"need_OAuthManager","No OAuthManager");if(!this.nv.Io||!this.nv.Io.value)return this.$ua(ib,na,"need_license","No License");if(x.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.$ua(ib,
na,"need_user","Anonymous User");if(33E5>Date.now()-this.c3.timeStamp)return ib.push(Object(m.a)(new z.a,{name:"UsedCachedToken",bool:!0})),B.a(t.a.C$a,!0,0,ib),Promise.resolve(Object(m.a)(new C.a,{IsSuccess:!0,Token:this.c3.token}));ib.push(Object(m.a)(new z.a,{name:"UsedCachedToken",bool:!1}));let Ib=1;const ec=(qb,Ha)=>(new Promise(Ab=>{window.setTimeout(()=>{Ab(qb)},Ha)})).then(Ab=>{ib.push(Object(m.a)(new z.a,{name:"Error"+Ib,string:Ab.ErrorMessage}));ib.push(Object(m.a)(new z.a,{name:"ErrorCode"+
Ib,string:Ab.ErrorCode}));Ib++;return this.aQb()});return this.aQb().catch(qb=>ec(qb,200)).catch(qb=>ec(qb,400)).then(qb=>{qb.IsSuccess?(this.c3.token=qb.Token,this.c3.timeStamp=Date.now()):(ib.push(Object(m.a)(new z.a,{name:"Error"+Ib,string:qb.ErrorMessage})),ib.push(Object(m.a)(new z.a,{name:"ErrorCode"+Ib,string:qb.ErrorCode})));ib.push(Object(m.a)(new z.a,{name:"Attempts",int64:Ib}));ib.push(Object(m.a)(new z.a,{name:"Error",string:qb.ErrorMessage}));ib.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:qb.ErrorCode}));B.a(t.a.C$a,qb.IsSuccess,v.getElapsedMilliseconds(na,w.a.Qa.zb),ib);return Promise.resolve(qb)}).catch(qb=>{ib.push(Object(m.a)(new z.a,{name:"Error"+Ib,string:qb.ErrorMessage}));ib.push(Object(m.a)(new z.a,{name:"ErrorCode"+Ib,string:qb.ErrorCode}));ib.push(Object(m.a)(new z.a,{name:"Attempts",int64:Ib}));return this.$ua(ib,na,qb.ErrorCode,qb.ErrorMessage)})}$ua(na,ib,Ib,ec){na.push(Object(m.a)(new z.a,{name:"Error",string:ec}));na.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:Ib}));B.a(t.a.C$a,!1,v.getElapsedMilliseconds(ib,w.a.Qa.zb),na);return Promise.resolve(Object(m.a)(new C.a,{IsSuccess:!1,ErrorMessage:ec,ErrorCode:Ib}))}aQb(){var na=y.a.Ijd();let ib=0;na=this.oAuthManager.UL("Maker",na).then(Ib=>{if(Ib)return!Ib.IsSuccess&&this.AUd(Ib)?Promise.reject(Ib):Promise.resolve(Ib);Ib=Object(m.a)(new C.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Ib)}).catch(Ib=>{let ec=new C.a;Object.getType(Ib)===Object.getType(ec)?
ec=Ib:(ec.ErrorMessage=Ib.toString(),ec.ErrorCode="exception");return Promise.reject(ec)});return Promise.race([na,new Promise((Ib,ec)=>{ib=window.setTimeout(()=>{ec(Object(m.a)(new C.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(Ib=>{window.clearTimeout(ib);return Ib})}AUd(na){return"interaction_required"===na.ErrorCode||"InitFailed"===na.ErrorCode||"invalid_resource"===na.ErrorCode||"login_required"===na.ErrorCode&&na.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(u.a)(A,"AutomateCommandAuth",null,[408]);var E=a(818);class I{constructor(){this.Mu=null}}Object(u.a)(I,"AutomateCommandGalleryBase",null,[]);var L=a(378),V=a(30),T=a(559),H=a(1393),D=a(19),G=a(52),J=a(13);a(315);var M=a(577);class Q{constructor(na,ib){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=na;this.currentUserMlapiToken=ib}}Object(u.a)(Q,"UserInfo",null,[]);var U=a(188),Z=a(60),P=a(33),S=a(1),ja=a(281);const X=na=>"TestHost"===na.va.DocumentHostInfo.HostTier,
Y=(na,ib)=>{ib.WacTaskPaneInfra=P.a.fd(na);ib.TaskpanelessRFB=!0;ib.OfficeScriptsAutomateTask=y.a.Ayf;ib.DeferAdminCheck=y.a.dua;ib.SharedScriptsButton=va();ib.OAuthManagerAPI=S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)},va=()=>S.EwaSettings.getBooleanFeatureGate(y.a.VAj,!1),N=(na,ib)=>{X(na)&&(S.EwaSettings.getBooleanFeatureGate(y.a.Wla,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(na.va.UserSessionId);
makerstorage.setUserAccessInfo(new Q(ib,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")},ea=na=>{if(X(na))return S.EwaSettings.getBooleanFeatureGate(y.a.Wla,!1)?"makerservicelocal":"localstorage";na=y.a.sLa();return y.a.Wxb(na)},Ca=(na,ib,Ib,ec,qb)=>{const Ha=na.userOperationManager,Ab=na.pa;let Yb=null,Bb=null,Qb=null;const sc=()=>{if(Ha.xta()||0<Ab.ya.YU||0<Ab.Nk.YU)return!1;Yb&&Ha.ko(Yb);Bb&&Ab.Mr(Bb);Qb&&Ab.gx(Qb);Ha.oD(new U.a(507,0,(kb,Eb,Gc)=>Z.g(Ab.ya,"ExecuteRichApiRequest",
ec,ja.b(kb,ib),ja.a(Eb,Ib),Gc,null,0),80));return!0};sc()||(Yb=()=>{sc()},Bb=()=>{sc()},Qb=()=>{sc()},Ha.ur(Yb),Ab.Kq(Bb),Ab.iw(Qb));return qb.task},la=na=>{na=na.pa.ya.Na(1);na.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return na},Ra=na=>P.a.fd(na)?na.isChromeRtl?D.a.zSe:D.a.ySe:D.a.WJa,lb=na=>P.a.fd(na)?D.a.Iad:D.a.Had;class Aa{constructor(na,
ib){this.automateCommandManager=na;this.$=ib}Oed(na){const ib=this.automateCommandManager.Va.fq().MC();if(!va()){var Ib=Aa.dD(na,J.a.instance.ga(2133));this.CGa(Ib,y.a.SEd,this.automateCommandManager.Od,y.a.KBd,J.a.instance.ga(2129),this.automateCommandManager.Va);ib.MenuSectionList.push(Ib)}Ib=Aa.dD(na,J.a.instance.ga(2134));this.CGa(Ib,y.a.iAd,y.a.Sw?this.automateCommandManager.Th.xvb(this.automateCommandManager.Od):this.automateCommandManager.wg.xvb(this.automateCommandManager.Od),y.a.xFb,J.a.instance.ga(2130),
this.automateCommandManager.Va);ib.MenuSectionList.push(Ib);Ib=Aa.dD(na,J.a.instance.ga(2135));this.CGa(Ib,y.a.xPd,this.automateCommandManager.Tk,y.a.xFb,"",this.automateCommandManager.Va);ib.MenuSectionList.push(Ib);Ib=Object(m.a)(new L.a,{Id:y.a.Vob,ExternalId:y.a.Vob,Command:"1606046412",LabelText:J.a.instance.ga(2126),Alt:J.a.instance.ga(2127),Image16by16:G.a.me(16),Image16by16Class:D.a.Mad,Visible:!0});na=Aa.dD(na,null);na.ControlsId="myScriptsSection.Controls";if(va()){const ec=Object(m.a)(new L.a,
{Id:y.a.jTd,ExternalId:y.a.jTd,Command:"1043696663",LabelText:J.a.instance.ga(2136),Alt:J.a.instance.ga(2136),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});na.ControlList.push(ec)}na.ControlList.push(Ib);ib.MenuSectionList.push(na);return ib}CGa(na,ib,Ib,ec,qb,Ha){if(Ib&&0<Ib.length){ib=Ha.bB(ib,1,"Size150by20").wqb();qb={};Ha={};Ha.root=Aa.lZ(320,30);Ha.flexContainer=Aa.O5c(!1);Ha.label=Aa.g6c(!1);qb.galleryButtonInExpanded=Ha;ib.GalleryStyle=qb;for(qb=0;qb<Ib.length&&qb<ec;qb++)Ha=Ib.Fw(qb),
ib.GalleryItems.push(Aa.KIa(Ha.id,Ha));na.ControlList.push(ib)}else Ib=Object(m.a)(new M.a,{Id:ib,ExternalId:ib,LabelText:qb}),na.ControlsId=Ib.Id+".Controls",na.ControlList.push(Ib)}static MKh(na){if(na){const ib=String.format(y.a.Yef,na.isShared?y.a.hfg:y.a.H0f,G.a.me(16));na=String.format(y.a.Zef,V.a.Hg(na.name));return String.format(y.a.Xef,ib,na)}return""}static dD(na,ib){return Object(m.a)(new T.a,{Id:na,Title:ib,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,
ControlList:[]})}static KIa(na,ib){const Ib=y.a.w_d,ec=y.a.RPd,qb=y.a.x_d,Ha=y.a.SPd;return ib?Aa.Isb(ib.shareId||ib.id,"1904816141",ib.name,ib.isShared&&!va()?Ib:ec,na,na,ib.isShared&&!va()?qb:Ha):Aa.Isb("","1904816141","","",na,na)}static Isb(na,ib,Ib,ec,qb=null,Ha=null,Ab=null){const Yb={},Bb={};Yb.root=Aa.lZ(20,20);Bb.root=Aa.lZ(20,20);return Object(m.a)(new H.a,{Id:na,ExternalId:qb||na,MenuItemId:Ha||na,Command:ib,Icon:ec,Image:G.a.me(16),ImageClass:Ab,LabelText:Ib,FullIconStyle:Yb,PreviewIconStyle:Bb,
Alt:Ib})}static O5c(na){const ib={display:"flex"};na?ib.flexDirection="column":(ib.height="100%",ib.flexWrap="nowrap",ib.justifyContent="left",ib.alignItems="left",ib.lineHeight="normal");return ib}static g6c(na){const ib={margin:"0px 3px"};na&&(ib["max-width"]="68px");return ib}static lZ(na,ib){const Ib={};Ib.width=na;Ib["min-width"]=na;Ib.height=ib;return Ib}}Object(u.a)(Aa,"AutomateCommandRenderer",null,[]);class da{constructor(na,ib){this.scripts=na;this.mOb=ib}get length(){return this.scripts.length}qN(na){for(let ib=
0;ib<this.scripts.length;ib++)if(this.scripts[ib].id===na||this.scripts[ib].shareId===na)return ib;return-1}sort(){this.mOb(this.scripts)}Oh(na){return-1===this.qN(na.id)?(this.scripts.push(na),!0):!1}BGa(na){return-1===this.qN(na.id)?(this.scripts=[na].concat(this.scripts),!0):!1}Vzd(na){na=this.qN(na.id);if(-1!==na){for(var ib=this.scripts[na].nU();0<na;)this.scripts[na]=this.scripts[na-1],na--;this.scripts[0]=ib}}EX(na){const ib=this.qN(na.id);if(-1!==ib){const Ib=this.scripts[ib].shareId;this.scripts[ib]=
na;this.scripts[ib].shareId=Ib}}mBb(na){const ib=this.qN(na.id);return-1!==ib?na.name===this.scripts[ib].name:!1}FU(na){na=this.qN(na);return-1!==na?(this.scripts.splice(na,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}Vm(na){na=this.qN(na);return-1!==na?this.scripts[na]:null}Fw(na){return 0<=na&&this.length>na?this.scripts[na]:null}xvb(na){const ib=new da([],this.mOb);for(let Ib=0;Ib<this.scripts.length;Ib++){const ec=this.scripts[Ib];na.Vm(ec.id)||ib.Oh(ec)}return ib}AX(){const na=
[];for(const ib of this.scripts)na.push(ib.Ofb());return na}}Object(u.a)(da,"ScriptCollection",null,[]);var aa=a(193);class fa{constructor(na){this.uz=aa.b(na)||{};this.shareId=this.shareId||null}get id(){return this.uz.id}get shareId(){return this.uz.shareId}set shareId(na){this.uz.shareId=na||null}get name(){return this.uz.name}get vtb(){return this.uz.dateLastPublished}get body(){return this.uz.body}get description(){return this.uz.description}get tAb(){return this.uz.isCreator}get isShared(){return!!this.shareId&&
0<this.shareId.length}nU(){return new fa(this.uz)}Ofb(){return this.uz}}Object(u.a)(fa,"ScriptCore",null,[]);var Oa=a(41);class ba extends I{constructor(na,ib){super();this.$=na;this.Se=ib}CLa(na){switch(na){case "1":case "2":case "3":case "4":case "5":case "6":return this.Mu.Fw(parseInt(na,10)-1);default:return this.Se.Th.Vm(na)||this.Se.wg.Vm(na)||this.Se.Od.Vm(na)||this.Se.Tk.Vm(na)}}lLa(na,ib){let Ib=null;if(this.Se.vV)switch(na){case "1":case "2":case "3":case "4":case "5":case "6":Ib=this.Mu.Fw(parseInt(na,
10)-1);break;default:Ib=this.Mu.Vm(na)}P.a.isReactRibbonEnabled()?ib[E.a.GalleryButtonProps]=Aa.KIa(na,Ib):ib[E.a.InnerHTML]=Aa.MKh(Ib);ib[E.a.Alt]=Ib?Ib.name:""}Pp(na){this.Mu=this.ZQa();this.$.df();const ib=[];ib.push(Object(m.a)(new z.a,{name:"Operation",string:na}));ib.push(Object(m.a)(new z.a,{name:"HasReadRecentCachedScripts",bool:this.Se.wka}));ib.push(Object(m.a)(new z.a,{name:"ReadScriptsDone",bool:this.Se.fMa}));ib.push(Object(m.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Se.o7}));
ib.push(Object(m.a)(new z.a,{name:"SamplesScriptCount",int64:this.Se.Tk.length}));ib.push(Object(m.a)(new z.a,{name:"ReadRecentScriptsDone",bool:this.Se.LW}));ib.push(Object(m.a)(new z.a,{name:"RecentScriptCount",int64:this.Se.Th.length}));ib.push(Object(m.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ms}));ib.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Se.Od.length}));B.a(t.a.soc,!0,0,ib)}aMa(na){let ib=!1,Ib="";const ec=new fa(na.scriptMetadata),qb={Operation:"HandleRefreshRibbonGallery"};
qb.RefreshOperation=na.operationName;switch(na.operationName){case y.a.sJb:({message:Ib,returnValue:ib}=this.$La(ec));break;case y.a.qJb:({message:Ib,returnValue:ib}=this.YLa(ec));break;case y.a.pJb:({message:Ib,returnValue:ib}=this.XLa(ec));break;case y.a.rJb:({message:Ib,returnValue:ib}=this.ZLa(ec));break;case y.a.HKd:({message:Ib,returnValue:ib}=this.ald(ec))}(qb.GalleryUpdated=ib)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${Ib}`),this.Pp("RefreshGallery")):
c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${Ib}`);qb.Message=Ib;c.ULS.sendTraceTag(537170320,0,50,Oa.c(qb))}ZQa(){const na=new da([],()=>{}),ib=this.Se.Od?this.Se.Od.length:0,Ib=this.Se.Th?this.Se.Th.length:0,ec=this.Se.Tk?this.Se.Tk.length:0;let qb=0,Ha=y.a.uIb;for(let Ab=0;Ab<Ha;Ab++)if(Ab<ib)na.Oh(this.Se.Od.Fw(Ab));else if(Ab-ib+qb<Ib){const Yb=this.Se.Th.Fw(Ab-ib+qb);this.Se.Od.Vm(Yb.id)?(qb++,Ab--):na.Oh(Yb)}else Ab-
ib-Ib+qb<ec&&na.Oh(this.Se.Tk.Fw(Ab-ib+qb-Ib));return na}$La(na){let ib;if(this.Se.Th.BGa(na))ib="";else{ib="";const Ib=na.nU();this.Se.Od.EX(Ib);this.Se.Od.sort();this.Se.Th.EX(na)}return{returnValue:!0,message:ib}}YLa(na){this.Se.Od.FU(na.id);return this.Se.Th.FU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}XLa(na){const ib=na.nU();ib.shareId=null;this.Se.Th.BGa(ib);return this.Se.Od.Oh(na)?(this.Se.Od.sort(),
{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}ZLa(na){return this.Se.Od.FU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}ald(na){const ib=na.nU();let Ib=!1;this.Se.Od.mBb(ib)&&(this.Se.Od.EX(ib),this.Se.Od.sort(),Ib=!0);this.Se.Th.BGa(na)?Ib=!0:this.Se.Th.mBb(na)&&(this.Se.Th.EX(na),this.Se.Th.Vzd(na),Ib=!0);return{returnValue:Ib,message:""}}}Object(u.a)(ba,
"AutomateCommandGallery",I,[]);var ka=a(82);class Pa{constructor(){this.Io=null}}Object(u.a)(Pa,"AutomateCommandLicensingBase",null,[]);class Fa{constructor(na,ib,Ib=null,ec="",qb=""){this.value=na;this.isSuccess=ib;this.timeStamp=Ib;this.errorCode=ec;this.errorMessage=qb}}Object(u.a)(Fa,"BoolResultWrapper",null,[]);class oa extends Pa{constructor(){super()}ita(){const na=w.a.Qa.zb,ib=[];return new Promise(Ib=>{ka.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ec=>
{ec.isFeatureEnabled("ExcelOfficeScripting",!1).then(qb=>{ib.push(Object(m.a)(new z.a,{name:"IsLicensed",bool:qb}));B.a(t.a.ooc,!0,v.getElapsedMilliseconds(na,w.a.Qa.zb),ib);this.Io=new Fa(qb,!0);Ib(qb)}).catch(qb=>{ib.push(Object(m.a)(new z.a,{name:"IsLicensed",bool:!1}));ib.push(Object(m.a)(new z.a,{name:"Error",string:qb.toString()}));ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"}));B.a(t.a.ooc,!1,v.getElapsedMilliseconds(na,w.a.Qa.zb),ib);this.Io=new Fa(!1,!1,void 0,"exception",
qb.toString());Ib(!1)})})})}}Object(u.a)(oa,"AutomateCommandLicensing",Pa,[]);var La=a(1306),Ea=a(1304),ca=a(1303),$a=a(1305),Qa=a(1394),Va=a(27),fb=a(171),Ka=a(571),hb=a(316),fc=a(5);class dc{constructor(na,ib,Ib,ec){this.k6a=na;this.O$b=ib;this.mW=Ib;this.gZ=ec}}Object(u.a)(dc,"LaunchSDXParams",null,[]);class wb{constructor(na,ib,Ib,ec,qb,Ha){this.actionName=na;this.shapeId=ib;this.scriptLink=Ib;this.clickId=ec;this.kR=qb;this.buttonText=Ha}}Object(u.a)(wb,"RunfromButtonParameters",null,[]);var Tb=
a(161),xb=a(58),cb=a(752),jb=a(51),qa=a(42),za=a(137);class Na{constructor(na,ib,Ib,ec,qb,Ha,Ab,Yb,Bb){this.RA=null;this.cache=new hb.a;this.u_=!1;this.CM={};this.$=na;this.pmb=Ib;this.indexedDB=ec;this.$pb=qb;this.nv=Ha;this.xha=Ab;this.Se=Yb;this.HC=Bb;this.MTg=new Aa(this,na);this.vMc=w.a.Qa.zb;this.BOb="";ec.te()&&(this.u_=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));na=!0;if(Va.a.Q_c){this.cache.te()&&!y.a.dua&&(ib=this.Se.F0e(y.a.UKa(this.$)),ib.isSuccess&&(na=v.getElapsedSeconds(ib.timeStamp,
w.a.Qa.zb),this.nv.Io=new Fa(!0,!0),this.RA=new Fa(ib.value,!0),na=this.RA.value?604800<na:86400<na,this.Iyb=this.rTa(!0)));this.dfd();if("undefined"!==typeof makerstorage&&this.C8a)if(this.BOb=ea(this.$),X(this.$))N(this.$,"localstorageToken"),this.nv.Io=new Fa(!0,!0),this.RA=new Fa(!0,!0),this.Iyb=this.rTa(!0);else if((ib=y.a.sLa())&&makerstorage.setStorageEnvironmentOverride(ib),na||y.a.dua)try{this.$.ceb("automateTab",!0),this.Iyb=y.a.dua?this.nv.ita().then(()=>this.xha.bba()).then(()=>this.rTa(!1)).catch(()=>
this.rTa(!1)):this.nv.ita().then(()=>this.xha.bba()).then(Qb=>this.O9h(Qb)).then(()=>this.rTa(!1)).catch(()=>this.rTa(!1))}catch(Qb){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Qb.message}`),this.Iyb=Promise.resolve(!1),this.$.ceb("automateTab",!1)}this.Iyb?this.Iyb.then(Qb=>{this.lNd(Qb);this.Se.zjd()}):this.lNd(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),
this.lNd(!1)}get wg(){return this.Se.wg}get Od(){return va()?new da([],()=>{}):this.Se.Od}get Tk(){return this.Se.Tk}get Th(){return this.Se.Th}get Va(){return this.pmb}get vV(){return this.Se.vV}get initTime(){return this.vMc}get kR(){const na=!!this.nv.Io&&this.nv.Io.isSuccess&&this.nv.Io.value;var ib=!!this.RA&&!this.RA.isSuccess;const Ib=!!this.RA&&this.nv.Io.isSuccess&&this.RA.value;ib=y.a.dua||Ib||ib&&!Va.a.Xba(11);return this.C8a&&na&&ib}get C8a(){const na="TestHost"===this.$.va.DocumentHostInfo.HostTier;
var ib=x.AFrameworkApplication.fa.Xa("UserPrincipalName");ib=!x.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!ib&&!ib.includes("ext#")&&!ib.includes("guest#");return!Va.a.y5&&(na||this.xha.Upb&&ib)}rTa(na){const ib=x.AFrameworkApplication.fa.qa("IsO365CommercialHost");let Ib="",ec="",qb=!1;var Ha,Ab=(Ha=this.nv.Io&&this.nv.Io.isSuccess)&&this.nv.Io.value;Ha=y.a.dua?Ha:!(Ab&&(!this.RA||!this.RA.isSuccess));this.nv.Io&&!this.nv.Io.isSuccess?(ec=this.nv.Io.errorCode,Ib=this.nv.Io.errorMessage):this.RA&&
!this.RA.isSuccess&&(ec=this.RA.errorCode,Ib=this.RA.errorMessage);Ab=[];Ab.push(Object(m.a)(new z.a,{name:"IsScriptingEnabled",bool:this.kR}));Ab.push(Object(m.a)(new z.a,{name:"IsValidHost",bool:ib}));Ab.push(Object(m.a)(new z.a,{name:"IsUserLicensed",bool:this.nv.Io?this.nv.Io.value:!1}));y.a.dua||Ab.push(Object(m.a)(new z.a,{name:"IsAdminSwitchOn",bool:this.RA?this.RA.value:!1}));Ab.push(Object(m.a)(new z.a,{name:"ShowTab",bool:this.kR}));y.a.dua||Ab.push(Object(m.a)(new z.a,{name:"ServiceChecked",
bool:!na}));this.kR?P.a.Hxa(this.$)&&(na=Tb.a(this.$),(null===na||void 0===na?0:na.Em)?(Ab.push(Object(m.a)(new z.a,{name:"RibbonType",string:"React"})),na.Em.$Gj(fc.a.vda),na.Em.xSd(["AutomateAutomateTask"],!y.a.Ayf&&!y.a.pAd),S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(qb=!0)):(ec="ribbon_manager_error",Ib="The RibbonManager or RibbonUser is null")):this.Hai();
Ab.push(Object(m.a)(new z.a,{name:"Error",string:Ib}));Ab.push(Object(m.a)(new z.a,{name:"ErrorCode",string:ec}));B.a(t.a.GKi,Ha,v.getElapsedMilliseconds(this.initTime,w.a.Qa.zb),Ab);this.$.ceb("automateTab",!1);return Promise.resolve(qb)}Kc(na,ib){if(!ib)return!1;ib.MenuItems=this.MTg.Oed(ib.MenuId);return!0}RGd(){this.u_&&(y.a.Sw?this.Se.bJb(this.HC).continueWith(na=>{na.result&&this.HC.Pp(y.a.tO)}):this.Se.YJd(this.HC));X(this.$)?this.Rxb(Object(m.a)(new C.a,{IsSuccess:!0,Token:"FakeToken"})):
this.xha.bba().then(na=>{this.Rxb(na)})}lLa(na,ib,Ib){if(y.a.Sw)this.HC.lLa(na,ib,Ib);else{Ib=null;if(this.Se.vV)switch(na){case "1":case "2":case "3":case "4":case "5":case "6":Ib=this.HC.Mu.Fw(parseInt(na,10)-1);break;default:Ib=this.HC.Mu.Vm(na)}ib[E.a.GalleryButtonProps]=Aa.KIa(na,Ib);ib[E.a.Alt]=Ib?Ib.name:""}}aMa(na){if(y.a.Sw)this.HC.aMa(na);else{let ib=!1,Ib="";const ec=new fa(na.scriptMetadata),qb={Operation:"HandleRefreshRibbonGallery"};qb.RefreshOperation=na.operationName;switch(na.operationName){case y.a.sJb:({message:Ib,
returnValue:ib}=this.$La(ec));break;case y.a.qJb:({message:Ib,returnValue:ib}=this.YLa(ec));break;case y.a.pJb:({message:Ib,returnValue:ib}=this.XLa(ec));break;case y.a.rJb:({message:Ib,returnValue:ib}=this.ZLa(ec))}(qb.GalleryUpdated=ib)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${Ib}`),this.Pp("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${Ib}`);
qb.Message=Ib;c.ULS.sendTraceTag(537170311,0,50,Oa.c(qb))}}dld(na,ib,Ib,ec){if(S.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.$p(null,!1,1023))na=new wb(y.a.vLb,na,ib,Ib,this.kR,ec),this.$pb.wwa(na)}syb(na,ib,Ib){na=new wb(y.a.I2d,na,ib,Ib,this.kR);this.$pb.wwa(na)}Dkd(na){this.$pb.VLa(y.a.NVd,na)}Ckd(na){this.$pb.VLa(y.a.x4c,na)}Ekd(na){this.$pb.VLa(y.a.wXd,na)}wlc(na,ib){var Ib=jb.b().uj(na);const ec=[];ec.push(Object(m.a)(new z.a,{name:"SessionId",string:this.$.va.UserSessionId}));
y.a.pAd||(ec.push(Object(m.a)(new z.a,{name:"MenuItemId",string:ib})),ec.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Od.length})),ec.push(Object(m.a)(new z.a,{name:"PublishedScriptCount",int64:this.wg.length})),ec.push(Object(m.a)(new z.a,{name:"RecentScriptCount",int64:this.Th.length})),ec.push(Object(m.a)(new z.a,{name:"Command",string:Ib})));ib=this.Pid(na,ib);if(Ib=this.j7f(na)?this.vWh():this.uhd(na,Ib,ib))this.j7f(na)?(La.a.instance.f6(Ib.O$b,"Taskpane",Ib.gZ,Ib.k6a,Ib.mW),
B.a(t.a.iNf,void 0,void 0,ec)):(ec.push(Object(m.a)(new z.a,{name:y.a.VC,string:Ib.mW.Dh[y.a.VC]})),La.a.instance.f6(Ib.O$b,"Taskpane",Ib.gZ,Ib.k6a,Ib.mW),1904816141===na&&(ec.push(Object(m.a)(new z.a,{name:"ScriptId",string:ib.id})),ec.push(Object(m.a)(new z.a,{name:"ShareId",string:ib.shareId})),ec.push(Object(m.a)(new z.a,{name:"IsPreviewGallery",bool:!!this.HC.Mu.Vm(ib.id)})),ec.push(Object(m.a)(new z.a,{name:"IsOwner",bool:ib.tAb||!!this.wg.Vm(ib.id)})),this.$.df()),B.a(t.a.xyf,void 0,void 0,
ec))}vWh(){const na=new Ea.a(y.a.Nwa,y.a.ova,y.a.locale),ib=new ca.a(y.a.IFd,OSF.StoreType.Sdx,OSF.StoreType.Sdx,y.a.JFd),Ib=new $a.a;Ib.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.Gxb(this.$);return new dc(na,ib,Ib,null)}uhd(na,ib,Ib){let ec=null;const qb=y.a.vq,Ha=new Ea.a(y.a.Nwa,y.a.ova,y.a.locale),Ab=new ca.a(y.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,y.a.oSa),Yb=new $a.a;Yb.Dh.AdminPolicyForFeedback=Oa.c(this.CM);Yb.Dh.DocumentHostInfo=xb.a.hc(this.$.va.DocumentHostInfo);
Yb.Dh.CodeEditorUrl=y.a.G4(this.$);Yb.Dh.MakerTestService=S.EwaSettings.getBooleanFeatureGate(y.a.Wla,!1);Yb.Dh[y.a.kLb]=y.a.hV(this.$);Yb.Dh.StorageModePreference=this.BOb||"";Yb.Dh.Source="Ribbon";Yb.Dh[y.a.ePb]=xb.a.hc(qb);Yb.Dh[y.a.kqb]=this.$.noc?"true":"false";Yb.Dh[y.a.VC]=fb.a.create().toString();var Bb=Ra(this.$);const Qb=lb(this.$);Yb.optionalProperties.HeaderCssClass=Bb;Yb.optionalProperties.TitleCssClass=Qb;Yb.Dh[y.a.Syb]=Bb;Yb.Dh[y.a.BPb]=Qb;Bb={};Bb.ribbonCommand=ib;Bb[y.a.zOb]=this.xha.getAuthContext();
Bb[y.a.FW]=this.Se.aJb?this.wg.AX():null;Bb[y.a.q3d]=this.Se.TQa?this.Od.AX():null;y.a.Sw&&(Bb[y.a.tO]=this.Se.SQa?this.Th.AX():null);Yb.Dh[y.a.bAb]=xb.a.hc(Bb);ib={};Y(this.$,ib);Yb.Dh[y.a.Lvb]=xb.a.hc(ib);switch(na){case -45542983:Yb.Dh.Script="";Yb.Dh.Destination="Editor";Yb.Dh.IsOwner=!0;Yb.optionalProperties[Qa.a.jj]=J.a.instance.ga(2122);Yb.optionalProperties[Qa.a.taskPaneWidth]=qb;Yb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.G4(this.$);ec=y.a.qta;break;case -1342227603:Yb.optionalProperties[Qa.a.jj]=
J.a.instance.ga(2124);Yb.optionalProperties[Qa.a.taskPaneWidth]=qb;Yb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.Gxb(this.$);break;case 971811139:case 1606046412:Yb.Dh.Script="";Yb.Dh.Destination="BackStage";Yb.Dh.IsOwner=!0;Yb.optionalProperties[Qa.a.jj]=J.a.instance.ga(2122);Yb.optionalProperties[Qa.a.taskPaneWidth]=qb;Yb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.G4(this.$);ec=y.a.qta;break;case 1043696663:Yb.Dh.Script="";Yb.Dh.Destination="BackStage_Workbook";
Yb.optionalProperties[Qa.a.jj]=J.a.instance.ga(2122);Yb.optionalProperties[Qa.a.taskPaneWidth]=qb;Yb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.G4(this.$);ec=y.a.qta;break;case 1845457202:Yb.optionalProperties[Qa.a.jj]=J.a.instance.ga(2123);Yb.optionalProperties[Qa.a.taskPaneWidth]=qb;Yb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.Adc(this.$);ec=y.a.UPd;break;case -2126202430:case 1623358083:case 1904816141:if(Ib)Yb.Dh.Script=xb.a.hc(Ib.Ofb()),Yb.Dh.Destination=
"Details",Yb.Dh.IsOwner=Ib.tAb||!!this.wg.Vm(Ib.id),Yb.optionalProperties[Qa.a.jj]=J.a.instance.ga(2122),Yb.optionalProperties[Qa.a.taskPaneWidth]=qb,Yb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.G4(this.$),ec=y.a.qta;else return null;break;default:return null}return new dc(Ha,Ab,Yb,ec)}Pid(na,ib){switch(na){case -2126202430:na=this.Se.d8.Vm(y.a.jPb);break;case 1623358083:na=this.Se.d8.Vm(y.a.kPb);break;default:na=ib?this.CLa(ib):null}return na}dfd(){ka.a.instance.Ub("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(na=>
{this.CM.FeedbackEnabled=!0;this.CM.ScreenshotEnabled=!0;this.CM.EmailEnabled=!0;na.xF("Enabled").then(ib=>{this.CM.FeedbackEnabled=ib},()=>{});na.xF("IncludeScreenshot").then(ib=>{this.CM.ScreenshotEnabled=ib},()=>{});na.xF("IncludeEmail").then(ib=>{this.CM.EmailEnabled=ib},()=>{})})}O9h(na){const ib=w.a.Qa.zb,Ib=[];if(!na||!na.IsSuccess){const ec=na?na.ErrorCode:"need_token";na=na?na.ErrorMessage:"No Access Token";Ib.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1}));Ib.push(Object(m.a)(new z.a,
{name:"Error",string:na}));Ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:ec}));B.a(t.a.XBd,!1,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.RA=new Fa(!1,!1,void 0,ec,na);return Promise.resolve(!1)}Ib.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!0}));N(this.$,na.Token);return makerstorage.getUserPermissions(this.$.va.UserSessionId).then(ec=>{this.RA=new Fa(ec.OfficeScriptingEnabled,!0);this.Se.zze(y.a.UKa(this.$),ec.OfficeScriptingEnabled);Ib.push(Object(m.a)(new z.a,{name:"IsEnabled",
bool:this.RA.value}));B.a(t.a.XBd,!0,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);return Promise.resolve(this.RA.value)}).catch(ec=>{Object.getType(ec)===makerstorage.StorageServiceError?(Ib.push(Object(m.a)(new z.a,{name:"Error",string:ec.message})),Ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${ec.errorCode.toString()}_${ec.status.toString()}`}))):(Ib.push(Object(m.a)(new z.a,{name:"Error",string:ec.toString()})),Ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));
B.a(t.a.XBd,!1,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.RA=new Fa(!1,!1,void 0,"exception",ec.toString());return Promise.resolve(!1)})}Rxb(na){this.Se.Mid(this.HC);y.a.Sw?this.Se.Did(na,this.HC,this.cache):this.qid(na);va()||this.Se.XJd(ib=>{this.Se.ajd(ib,na,this.HC)},this.HC)}qid(na){const ib=w.a.Qa.zb,Ib=[];if(na&&na.IsSuccess){N(this.$,na.Token);var ec=Ka.a.create().toString();Ib.push(Object(m.a)(new z.a,{name:"CorrelationId",string:ec}));makerstorage.getScripts(ec).then(qb=>{Ib.push(Object(m.a)(new z.a,
{name:"HasReadCachedScripts",bool:this.Se.Z4}));this.wg.clear();for(const Ha of qb)this.wg.Oh(new fa(Ha));this.wg.sort();this.Se.aJb=!0;this.Se.KW=!0;this.u_&&(qb=xb.a.hc(this.wg.AX()),this.indexedDB.Jna(new cb.a(y.a.FW,qb)));Ib.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.wg.length}));B.a(t.a.Kca,!0,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.Pp(y.a.FW)}).catch(qb=>{Object.getType(qb)===makerstorage.StorageServiceError?(Ib.push(Object(m.a)(new z.a,{name:"Error",string:qb.message})),
Ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${qb.errorCode.toString()}_${qb.status.toString()}`})),17===qb.errorCode&&this.cache.QJb(y.a.UKa(this.$))):(Ib.push(Object(m.a)(new z.a,{name:"Error",string:qb.toString()})),Ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(t.a.Kca,!1,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.Se.KW=!0;this.Pp(y.a.FW)})}else ec=na?na.ErrorCode:"need_token",na=na?na.ErrorMessage:"No Access Token",Ib.push(Object(m.a)(new z.a,
{name:"ServiceChecked",bool:!1})),Ib.push(Object(m.a)(new z.a,{name:"Error",string:na})),Ib.push(Object(m.a)(new z.a,{name:"ErrorCode",string:ec})),B.a(t.a.Kca,!1,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib),this.Se.KW=!0,this.Pp(y.a.FW)}CLa(na){if(y.a.Sw)return this.HC.CLa(na);switch(na){case "1":case "2":case "3":case "4":case "5":case "6":return this.HC.Mu.Fw(parseInt(na,10)-1);default:return this.wg.Vm(na)||this.Od.Vm(na)||this.Tk.Vm(na)}}$La(na){let ib;if(this.wg.Oh(na))this.wg.sort(),ib="";else{ib=
"";const Ib=na.nU();this.Od.EX(Ib);this.Od.sort();this.wg.EX(na);this.wg.sort()}return{returnValue:!0,message:ib}}YLa(na){this.Od.FU(na.id);return this.wg.FU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}XLa(na){const ib=na.nU();ib.shareId=null;this.wg.Oh(ib)&&this.wg.sort();return this.Od.Oh(na)?(this.Od.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}ZLa(na){return this.Od.FU(na.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Pp(na){if(y.a.Sw)this.HC.Pp(na);else{this.ZQa();this.$.df();const ib=[];ib.push(Object(m.a)(new z.a,{name:"Operation",string:na}));ib.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.Se.Z4}));ib.push(Object(m.a)(new z.a,{name:"ReadScriptsDone",bool:this.Se.fMa}));ib.push(Object(m.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Se.o7}));ib.push(Object(m.a)(new z.a,
{name:"SamplesScriptCount",int64:this.Tk.length}));ib.push(Object(m.a)(new z.a,{name:"ReadPublishedScriptsDone",bool:this.Se.KW}));ib.push(Object(m.a)(new z.a,{name:"PublishedScriptCount",int64:this.wg.length}));ib.push(Object(m.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ms}));ib.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Od.length}));B.a(t.a.soc,!0,0,ib)}}ZQa(){this.HC.Mu=new da([],()=>{});const na=this.Od?this.Od.length:0,ib=this.wg?this.wg.length:0,Ib=this.Tk?
this.Tk.length:0;let ec=0;const qb=y.a.uIb;for(let Ha=0;Ha<qb;Ha++)if(Ha<na)this.HC.Mu.Oh(this.Od.Fw(Ha));else if(Ha-na+ec<ib){const Ab=this.wg.Fw(Ha-na+ec);this.Od.Vm(Ab.id)?(ec++,Ha--):this.HC.Mu.Oh(Ab)}else Ha-na-ib+ec<Ib&&this.HC.Mu.Oh(this.Tk.Fw(Ha-na+ec-ib))}lNd(na){S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(na?(qa.PageLoadTrackingInfo.instance.C0(fc.a.AO,
["automateTab"]),qa.PageLoadTrackingInfo.instance.aS(fc.a.AO,["automateTab"]),qa.PageLoadTrackingInfo.instance.WW(fc.a.AO,["automateTab"])):qa.PageLoadTrackingInfo.instance.Oda(fc.a.AO,["automateTab"]))}Hai(){S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&za.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(fc.a.vda))}j7f(na){return y.a.pAd&&-1342227603===na}}Object(u.a)(Na,"AutomateCommandManager",null,[357]);var ua=a(1361),Xa=a(1308),ha=
a(249),ta=a(859),wa=a(49),db=a(104),Jb=a(21),Pb;(function(na){na.preparing="preparing";na.running="running";na.succeeded="succeeded";na.fetchFailed="fetchFailed";na.runFailed="runFailed";na.canceled="canceled";na.alreadyRunning="alreadyRunning";na.initializing="initializing"})(Pb||(Pb={}));Object(u.b)("OfficeScriptsRunStatus",Pb);class eb{constructor(na,ib,Ib,ec,qb,Ha){this.scriptLink="";this.runStatus=Pb.preparing;this.clickId="";this.hasLogs=this.isOwner=this.buttonText=void 0;this.scriptLink=na;
this.runStatus=ib;this.clickId=Ib;this.buttonText=ec;this.isOwner=qb;this.hasLogs=Ha}}Object(u.a)(eb,"OfficeScriptsBusinessBarParams",null,[]);class Ma{constructor(na){this.shareId="";this.shareId=na}}Object(u.a)(Ma,"OfficeScriptsShareLinkObject",null,[]);class ob{constructor(na,ib,Ib,ec){this.SV=!1;this.Mca=()=>{this.yNb()?(this.mIb(),Jb.h(this.$).Da.aKb(this.Mca)):this.SV&&Jb.h(this.$).Da.aKb(this.Mca)};this.RCd=(qb,Ha)=>{Object.getType(Ha)===String&&Ha.toString().endsWith(y.a.fba(this.$))&&(this.SV=
!1)};this.$=na;this.xha=ib;this.nv=Ib;this.businessBarManager=ec;this.dTd()}wwa(na){if(na.kR){const ib=[];ib.push(Object(m.a)(new z.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.SV}));ib.push(Object(m.a)(new z.a,{name:"actionName",string:na.actionName}));ib.push(Object(m.a)(new z.a,{name:y.a.VC,string:na.clickId.toString()}));this.SV?this.dMb(na):this.Qkd(na);B.a(t.a.yyf,void 0,void 0,ib)}}VLa(na,ib){const Ib={};Ib[y.a.VC]=ib;this.zSa(na,Ib)}dTd(){this.yNb()?this.mIb():Jb.h(this.$).Da.VWc(this.Mca)}yNb(){if(this.SV||
X(this.$))return!1;const na=db.a(this.$);return Jb.h(this.$).Da.Uob&&na.rgf()}mIb(){this.nv.Io?this.nv.Io.value&&this.xha.bba():this.nv.ita().then(na=>{na&&this.xha.bba()});B.a(t.a.tyf)}LQd(){const na=fb.a.create().toString();var ib={};Y(this.$,ib);const Ib={};Ib[y.a.zOb]=this.xha.getAuthContext();const ec={};ec[y.a.Lvb]=xb.a.hc(ib);ec[y.a.bAb]=xb.a.hc(Ib);ec[y.a.f9c]=xb.a.hc(this.$.va.DocumentHostInfo);ec[y.a.AXd]=ea(this.$);ec[y.a.ePb]=xb.a.hc(y.a.vq);ec[y.a.kqb]=this.$.noc?"true":"false";ec[y.a.kLb]=
y.a.hV(this.$);ec[y.a.Syb]=Ra(this.$);ec[y.a.BPb]=lb(this.$);ec[y.a.VC]=na;ib=[];ib.push(Object(m.a)(new z.a,{name:y.a.VC,string:na}));B.a(t.a.wyf,void 0,void 0,ib);this.zSa(y.a.bod,ec)}Qkd(na){this.XUd(na);X(this.$)&&N(this.$,"localstorage");f.TaskExtensions.za(wa.GetServiceTaskFactory.Oa(this.$.da,374,375,1),ib=>{this.qwd(ib.result).continueWith(()=>{this.KQd(na)});this.SV=!0},this.$.ka,3)}qwd(na){const ib={};ib.SolutionId=y.a.solutionId;ib.Version=y.a.oSa;ib.StoreType=OSF.StoreType.Sdx;ib.StoreId=
OSF.StoreType.Sdx;S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(ib.AssetId=null,ib.AssetStoreId=null):(ib.AssetId=y.a.solutionId,ib.AssetStoreId=OSF.StoreType.Sdx);ib.TargetType=1;ib.SharedRuntimeId=y.a.fba(this.$);ib.SourceLocationOverrideResourceId=y.a.fba(this.$);ib.IsToBePersisted=!1;const Ib=new ua.a;Ib.jj=J.a.instance.ga(2146);Ib.taskPaneWidth=y.a.vq;const ec=new ta.a;ec.yUa=lb(this.$);ec.e_=Ra(this.$);return na.HLb(ib,Ib,void 0,void 0,ec)}KQd(na){this.LQd();
ha.a(this.$)&&ha.a(this.$).dXc(this.RCd);this.dMb(na)}dMb(na){const ib={};ib[y.a.rPd]=na.shapeId;ib[y.a.qPd]=na.scriptLink;ib[y.a.VC]=na.clickId.toString();ib[y.a.pPd]=na.buttonText;this.zSa(na.actionName,ib)}zSa(na,ib){const Ib=new ca.a(y.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,y.a.oSa),ec=new Ea.a(y.a.Nwa,y.a.ova,this.$.va.UICultureTag),qb=new $a.a;qb.optionalProperties[Qa.a.jj]=J.a.instance.ga(2146);qb.optionalProperties[Qa.a.sourceLocationOverrideResourceId]=y.a.fba(this.$);qb.optionalProperties[Qa.a.KZb]=
ib;qb.optionalProperties[Qa.a.taskPaneWidth]=y.a.vq;La.a.instance.f6(Ib,Xa.a.action,na,ec,qb)}XUd(na){na.actionName===y.a.vLb&&(na=new eb(na.scriptLink,"initializing",na.clickId.toString(),na.buttonText),this.businessBarManager.JWc(64,na))}}Object(u.a)(ob,"AutomateCommandRunFromButton",null,[356]);var Ia=a(157),Da=a(22);class nb{constructor(){this.Th=null;this.Z4=this.o7=this.Ms=this.KW=this.TQa=this.aJb=this.SQa=this.LW=this.wka=!1;this.d8=this.Tk=this.Od=this.wg=null}get vV(){const na=y.a.Sw?this.wka:
this.Z4;return this.o7||na||this.fMa}get fMa(){return(y.a.Sw?this.LW:this.KW)&&this.Ms&&this.o7}static CWd(na){na.sort((ib,Ib)=>Ib.vtb-ib.vtb)}static xoa(na){na.sort((ib,Ib)=>Da.a.compare(ib.name,Ib.name,!0))}static mjd(na){let ib,Ib;Ib=ib=null;if(na){const ec=na.indexOf(":");if(-1!==ec)return ib=na.substr(0,ec),Ib=na.substr(ec+1),{returnValue:!0,AOb:ib,shareId:Ib}}return{returnValue:!1,AOb:ib,shareId:Ib}}static Wid(na,ib){const Ib={};Ib[y.a.KRb]=encodeURIComponent(na.workbookContext.WorkbookFileName);
Ib[y.a.MLb]=ib.AX();return Oa.c(Ib)}static cJb(na,ib){return f.TaskExtensions.WJ(ib.Uja(y.a.rpa),Ib=>{Ib=Ib.result;if(""!==Ib){var ec=Oa.b(Ib);Ib=ec[y.a.MLb];if(ec[y.a.KRb]===encodeURIComponent(na.workbookContext.WorkbookFileName)){ec=new da([],qb=>{nb.xoa(qb)});for(const qb of Ib)ec.Oh(new fa(qb));ec.sort();return ec}}},na.ka,3)}}Object(u.a)(nb,"AutomateCommandStorageBase",null,[]);var Ua=a(116),W=a(99);class sa extends nb{constructor(na,ib){super();this.$=na;this.vua=new DOMParser;this.cache=new hb.a;
this.indexedDB=ib;ib.te()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.Z4=!1;this.wg=new da([],Ib=>{nb.CWd(Ib)});this.Od=new da([],Ib=>{nb.xoa(Ib)});this.Tk=new da([],Ib=>{nb.xoa(Ib)});this.Th=new da([],()=>{});this.d8=new da([],Ib=>{nb.xoa(Ib)})}zze(na,ib){if(this.cache.te()){const Ib={};Ib.TimeStamp=w.a.Qa.zb;Ib.IsEnabled=ib;this.cache.qyc(na,xb.a.hc(Ib))}}F0e(na){let ib=!1,Ib=!1,ec=null;this.cache.te()&&(na=Oa.b(this.cache.$4a(na)))&&(Ib=na.IsEnabled,ec=new Date(na.TimeStamp),
ib=!0);return new Fa(Ib,ib,ec)}bJb(na){const ib=w.a.Qa.zb,Ib=[];return f.TaskExtensions.WJ(this.indexedDB.Uja(y.a.tO),ec=>{const qb=!this.LW||!this.Th.length;ec=ec.result;Ib.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.Th.length}));if(""!==ec&&(ec=Oa.b(ec),Ib.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:ec.length})),qb)){for(const Ha of ec)this.Th.Oh(new fa(Ha));this.wka=!0;this.SQa=0<ec.length;B.a(t.a.qoc,qb,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.eRa(na);return!0}B.a(t.a.qoc,
qb,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);return!1},this.$.ka,3)}YJd(na){S.EwaSettings.getBooleanFeatureGate(y.a.UZc,!1)&&!va()&&this.aKd(na);y.a.Sw?this.bJb(na):this.WJd(na)}Did(na,ib,Ib){const ec=w.a.Qa.zb,qb=[];if(na&&na.IsSuccess){N(this.$,na.Token);var Ha=Ka.a.create().toString();qb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:Ha}));makerstorage.getRecentScripts(Ha).then(Ab=>{qb.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.wka}));this.Th.clear();for(const Yb of Ab)this.Th.Oh(new fa(Yb));
this.LW=this.SQa=!0;this.indexedDB.te()&&(Ab=xb.a.hc(this.Th.AX()),this.indexedDB.Jna(new cb.a(y.a.tO,Ab)));qb.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.Th.length}));B.a(t.a.Kca,!0,v.getElapsedMilliseconds(ec,w.a.Qa.zb),qb);ib.Pp(y.a.tO)}).catch(Ab=>{Object.getType(Ab)===makerstorage.StorageServiceError?(qb.push(Object(m.a)(new z.a,{name:"Error",string:Ab.message})),qb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${Ab.errorCode.toString()}_${Ab.status.toString()}`})),
17===Ab.errorCode&&Ib.QJb(y.a.UKa(this.$))):(qb.push(Object(m.a)(new z.a,{name:"Error",string:Ab.toString()})),qb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(t.a.uyf,!1,v.getElapsedMilliseconds(ec,w.a.Qa.zb),qb);this.LW=!0;ib.Pp(y.a.tO)})}else Ha=na?na.ErrorCode:"need_token",na=na?na.ErrorMessage:"No Access Token",qb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1})),qb.push(Object(m.a)(new z.a,{name:"Error",string:na})),qb.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:Ha})),B.a(t.a.Kca,!1,v.getElapsedMilliseconds(ec,w.a.Qa.zb),qb),this.LW=!0,ib.Pp(y.a.tO)}XJd(na,ib){const Ib=new Ia.a,ec=la(this.$);Ca(this.$,qb=>{if((qb=qb.Result)&&200===qb.ResponseStatusCode)qb=qb.ResponseBody.join(""),qb=JSON.parse(qb),na(this.cGd(qb.value)),Ib.setResult(!0);else{qb=qb?"RichApi_"+qb.ResponseStatusCode:"RichApiError";const Ha=[];Ha.push(Object(m.a)(new z.a,{name:"Error",string:"Failed to read shared script ids from document"}));Ha.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:qb}));this.Ms=!0;this.lU(ib,w.a.Qa.zb,0,Ha);Ib.setResult(!1)}},qb=>{qb=Ua.a.Pe(qb.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const Ha=[];Ha.push(Object(m.a)(new z.a,{name:"Error",string:"Failure using rich api: "+qb}));Ha.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"RichApiFailure"}));this.Ms=!0;this.lU(ib,w.a.Qa.zb,0,Ha);Ib.setResult(!1)},ec,Ib)}ajd(na,ib,Ib){const ec=w.a.Qa.zb;let qb=0,Ha=0;this.Ms=qb===na.count;const Ab=
[];Ab.push(Object(m.a)(new z.a,{name:"ScriptIds",int64:na.count}));if(na.count)if(ib&&ib.IsSuccess){N(this.$,ib.Token);for(var Yb of na){const Bb=Ka.a.create().toString();makerstorage.getSharedScript(Yb.value,Bb).then(Qb=>{const sc=[];sc.push(Object(m.a)(new z.a,{name:"BodySize",int64:Qb.body.length}));sc.push(Object(m.a)(new z.a,{name:"CorrelationId",string:Bb}));B.a(t.a.roc,!0,v.getElapsedMilliseconds(ec,w.a.Qa.zb),sc);qb++;Qb=new fa(Qb);Qb.shareId=na.na(Qb.id);this.Od.Oh(Qb);this.Ms=qb===na.count;
this.TQa=!0;this.lU(Ib,ec,Ha,Ab)}).catch(Qb=>{const sc=[];Object.getType(Qb)===makerstorage.StorageServiceError?(Ab.push(Object(m.a)(new z.a,{name:"Error",string:Qb.message})),Ab.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${Qb.errorCode.toString()}_${Qb.status.toString()}`}))):(sc.push(Object(m.a)(new z.a,{name:"Error",string:Qb.toString()})),sc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));sc.push(Object(m.a)(new z.a,{name:"CorrelationId",string:Bb}));B.a(t.a.roc,
!1,v.getElapsedMilliseconds(ec,w.a.Qa.zb),sc);qb++;Ha++;this.Ms=qb===na.count;this.lU(Ib,ec,Ha,Ab)}).finally(()=>{if(S.EwaSettings.getBooleanFeatureGate(y.a.UZc,!1)&&this.indexedDB.te()&&this.Ms){const Qb=nb.Wid(this.$,this.Od);this.indexedDB.Jna(new cb.a(y.a.rpa,Qb))}})}}else Yb=ib?ib.ErrorCode:"need_token",ib=ib?ib.ErrorMessage:"No Access Token",Ab.push(Object(m.a)(new z.a,{name:"Error",string:ib})),Ab.push(Object(m.a)(new z.a,{name:"ErrorCode",string:Yb})),this.Ms=!0,this.lU(Ib,ec,Ha,Ab);else this.Ms=
this.TQa=!0,this.lU(Ib,ec,Ha,Ab),S.EwaSettings.getBooleanFeatureGate(y.a.UZc,!1)&&f.TaskExtensions.WJ(nb.cJb(this.$,this.indexedDB),Bb=>{Bb.result&&(this.indexedDB.N7b(y.a.rpa),this.Od.clear(),Ib.Pp("CachedScripts"))},this.$.ka,3)}Mid(na){const ib={id:"samples-6"};ib.name=J.a.instance.ga(2140);this.Tk.Oh(new fa(ib));ib.id="samples-8";ib.name=J.a.instance.ga(2141);this.Tk.Oh(new fa(ib));ib.id="samples-2";ib.name=J.a.instance.ga(2137);this.Tk.Oh(new fa(ib));ib.id="samples-4";ib.name=J.a.instance.ga(2138);
this.Tk.Oh(new fa(ib));ib.id="samples-5";ib.name=J.a.instance.ga(2139);this.Tk.Oh(new fa(ib));ib.id="samples-9";ib.name=J.a.instance.ga(2142);this.Tk.Oh(new fa(ib));this.o7=!0;na.Pp("SampleScripts")}zjd(){const na={};na.id=y.a.jPb;na.name=J.a.instance.ga(2143);this.d8.Oh(new fa(na));na.id=y.a.kPb;na.name=J.a.instance.ga(2144);this.d8.Oh(new fa(na))}cGd(na){const ib=new W.a;if(na=this.vua.parseFromString(na,"text/xml").querySelector('[id="script-ids-node-id"]')){na=na.getElementsByTagName("scriptId");
for(let Ib=0;Ib<na.length;Ib++){const ec=na[Ib].getAttribute("id");if(ec){let qb,Ha;({AOb:qb,shareId:Ha}=nb.mjd(ec)).returnValue&&ib.ia(qb,Ha)}}}return ib}aKd(na){const ib=w.a.Qa.zb,Ib=[];f.TaskExtensions.WJ(nb.cJb(this.$,this.indexedDB),ec=>{ec=ec.result;Ib.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.Od.length}));if(ec){Ib.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:ec.length}));const qb=!this.Ms||0===this.Od.length;if(qb){for(const Ha of ec.getScripts())this.Od.Oh(Ha);
this.Od.sort();B.a(t.a.B$a,qb,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.eRa(na);return!0}B.a(t.a.B$a,qb,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib)}else B.a(t.a.B$a,!1,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);return!1},this.$.ka,3)}WJd(na){const ib=w.a.Qa.zb,Ib=[];f.TaskExtensions.WJ(this.indexedDB.Uja(y.a.FW),ec=>{const qb=!this.KW||!this.wg.length;ec=ec.result;Ib.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.wg.length}));if(""!==ec&&(ec=Oa.b(ec),Ib.push(Object(m.a)(new z.a,
{name:"CachedScriptCount",int64:ec.length})),qb)){for(const Ha of ec)this.wg.Oh(new fa(Ha));this.wg.sort();B.a(t.a.poc,qb,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);this.eRa(na);return!0}B.a(t.a.poc,qb,v.getElapsedMilliseconds(ib,w.a.Qa.zb),Ib);return!1},this.$.ka,3)}lU(na,ib,Ib,ec){this.Ms&&(ec.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.Od.length})),ec.push(Object(m.a)(new z.a,{name:"ScriptErrorCount",int64:Ib})),B.a(t.a.vyf,!Ib,v.getElapsedMilliseconds(ib,w.a.Qa.zb),ec),this.Od.sort(),
na.Pp(y.a.rpa))}eRa(na){this.Z4=!0;na.Pp("CachedScripts")}}Object(u.a)(sa,"AutomateCommandStorage",nb,[]);var vb=a(697);class gc extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){const na=wa.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya),ib=G.a.loadScript(133,4,this.Ya,void 0,void 0,351),Ib=wa.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Ya),ec=wa.GetServiceTaskFactory.create(this.$.da,396,this.$.ka,this.Ya),qb=wa.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([na,
ib,Ib,ec,qb],this.ka,3),()=>{const Ha=na.result,Ab=ec.result;var Yb=qb.result;const Bb=new oa,Qb=new A(this.$,Ha,Bb),sc=new sa(this.$,Ab),kb=new ba(this.$,sc),Eb=new ob(this.$,Qb,Bb,Yb);Yb=Object(vb.a)(this.$.da,352,()=>new Na(this.$,Ha,Ib.result,Ab,Eb,Bb,Qb,sc,kb));this.nb(Yb)},this.ka,3)}static la(na){na&&na.da.Ga(351,new gc(na))}}Object(u.a)(gc,"AutomateCommandManagerFactory",b.a,[]);var Bc=a(9);a.d(F,"a",function(){return Sa});const Sa=()=>{Bc.a.Fa(na=>{n.la(na);gc.la(na)})}},1188:function(u,
F,a){u=a(0);var c=a(15),b=a(84),e;(function(T){T[T.generalException=0]="generalException";T[T.invalidArgument=1]="invalidArgument";T[T.notAllowed=2]="notAllowed";T[T.apiNotAvailable=3]="apiNotAvailable";T[T.unresolvedPendingRequest=4]="unresolvedPendingRequest";T[T.timeout=5]="timeout";T[T.adalTimeout=6]="adalTimeout";T[T.userNotSignedIn=7]="userNotSignedIn";T[T.userAborted=8]="userAborted";T[T.silentSignInFailed=9]="silentSignInFailed";T[T.invalidResourceUrl=10]="invalidResourceUrl";T[T.invalidGrant=
11]="invalidGrant";T[T.connectionLost=12]="connectionLost";T[T.clientError=13]="clientError";T[T.serverError=14]="serverError"})(e||(e={}));Object(u.b)("ErrorCodes",e);a(1302);class f{constructor(T,H){this.requestCallback=this.requestParameters=null;this.requestParameters=T;this.requestCallback=H}}Object(u.a)(f,"OutstandingRequest",null,[]);class d{}d.WIi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.RIi="AADSTS65001";d.fJi="AADSTS70011";d.userAborted="13002";d.g4i="Popup Window is null";d.f4i=
"Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.BQj="tokenRevoked";Object(u.a)(d,"WopiHostErrorType",null,[]);var h=a(4),n=a(731),m=a(571),x=a(41),r=a(1301);class y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(y,"WopiIdentityInfo",null,[609]);class t{constructor(T,H,D){this.expiration=this.authority=this.accessToken=null;this.accessToken=T;this.authority=H;this.expiration=D}}Object(u.a)(t,
"WopiIdentityToken",null,[608]);var v=a(27),w=a(147),C=a(376),B=a(164),z=a(72),A=a(347);class E{constructor(T){this._initialized=!1;this.Kab={};this.ZAc={};this.UO=h.AFrameworkApplication.ta.lE;this.Imd=T}$2a(T){this._initialized||(T.so(B.a.XMf),T.dm(B.a.XMf,Object(b.a)(this,this.GVi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(T,H,D=null){this.KOa(T,H);return new Promise((G,J)=>{if(this.ipd(H))if(H in this.Kab)J("unresolvedPendingRequest");else{var M=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,
344,10,x.c({["error"]:"Request timeout.",["callerId"]:H}));J("timeout")},12E4);this.Ued(T,H,D,(Q,U)=>{window.clearTimeout(M);Q?G(Q):(c.ULS.sendTraceTag(37856033,369,15,x.c({["error"]:e[U]})),J(U))})}else c.ULS.sendTraceTag(37856034,344,10,x.c({["error"]:"Caller is not allowed."})),J("notAllowed")})}getPrimaryIdentityInfo(T){return new Promise((H,D)=>{this.ipd(T)?this.PZh((G,J)=>{G?H(G):(c.ULS.sendTraceTag(37856064,369,10,x.c({["error"]:J.toString()})),D(J))}):(c.ULS.sendTraceTag(37856065,344,10,x.c({["error"]:"Caller is not allowed."})),
D("notAllowed"))})}getAuthContext(T){return new Promise((H,D)=>{const G=this.getAuthContextSync(T);G?H(G):D("notAllowed")})}getAuthContextSync(T){if(this.ipd(T)){const H=new r.a;H.upn=h.AFrameworkApplication.fa.Xa("UserPrincipalName");H.userId=h.AFrameworkApplication.fa.Xa("LoggableUserId");H.authority=h.AFrameworkApplication.fa.Xa("HostAuthAuthority");H.tenantId=h.AFrameworkApplication.fa.Xa("TenantId");H.isAnonymous=h.AFrameworkApplication.fa.qa("IsAnonymousUser");H.supportsAuthToken=this.xbi(T);
T=h.AFrameworkApplication.fa.Xa("HostAuthType");H.authorityType="aad"===T.toLowerCase()?2:"msa"===T.toLowerCase()?1:0;return H}c.ULS.sendTraceTag(40751647,344,10,x.c({["error"]:"Caller is not allowed."}));return null}xbi(T){const H=n.a.lzb;return v.a.Pxa?H&&n.a.Ycg?Array.contains(n.a.Ycg,T.toLowerCase()):!1:H}Ued(T,H,D,G){var J=[];Array.add(J,Object.assign(new z.a,{name:"CallerId",string:H}));Array.add(J,Object.assign(new z.a,{name:C.a.MWd,string:T.correlationId}));w.a.sendTelemetryEvent(Object.assign(new A.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:J}));J=m.a.create().toString();const M="getAccessToken_"+J,Q=this.UO.Bc("ComponentAttach",M);this.ZAc[M]=Q;const U={};U[C.a.NWd]=J;U[C.a.VJj]=T.resource;U[C.a.WJj]=T.scope;U[C.a.X$f]=h.AFrameworkApplication.fa.Xa("HostAuthType");U[C.a.ZJj]=h.AFrameworkApplication.fa.Xa("UserPrincipalName");U[C.a.XJj]=T.silentLogin;U[C.a.SJj]=T.options;U[C.a.MWd]=T.correlationId;U[C.a.TJj]=H;D&&(U[C.a.addinName]=D.AddinName,U[C.a.RJj]=
D.AddinTrustId);this.Imd.execute(Z=>{this.$2a(Z);Z.Rj(B.a.getAuthToken,U)});this.Kab[J]=new f(T,G)}PZh(T){const H=h.AFrameworkApplication.fa.Xa("UserName"),D=h.AFrameworkApplication.fa.Xa("UserPrincipalName"),G=h.AFrameworkApplication.fa.Xa("LoggableUserIdSpace"),J=new y;J.email=D;J.displayName=H;switch(G){case "OrgIdPuid":J.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":J.authority="MicrosoftAccount";break;default:J.authority=G}T(J,null)}GVi(T){let H=null;try{let G=T.Values[C.a.NWd];
const J=T.Values[C.a.QJj],M=T.Values[C.a.X$f],Q=T.Values[C.a.YJj];let U=null,Z=null;const P=this.Kab[G];if("undefined"!==typeof P&&P){var D=[];Array.add(D,Object.assign(new z.a,{name:C.a.MWd,string:P.requestParameters.correlationId}));w.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:D}));H=P.requestCallback;delete this.Kab[G];"undefined"!==typeof J&&J&&J.length?Z=new t(J,M,Q):U=e[this.aEi(T)];D="getAccessToken_"+G;D in
this.ZAc&&(this.ZAc[D].stop(),delete this.ZAc[D]);H(Z,U)}else c.ULS.sendTraceTag(37856066,344,10,x.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:G}))}catch(G){T=T.Values[C.a.NWd],T in this.Kab&&delete this.Kab[T],this.Wlc(),c.ULS.sendTraceTag(37856067,344,10,x.c({["error"]:G.message,["stack"]:G.stack})),H&&H(null,"generalException")}}ipd(T){var H=h.AFrameworkApplication.K5h();T=T.toLowerCase();for(const D of H)if(T===D.toLowerCase())return!0;H=n.a.BYc;for(let D in H)if(T===
H[D].toLowerCase())return!0;return!1}aEi(T){T=T.Values[C.a.UJj];this.Wlc();c.ULS.sendTraceTag(39068821,344,15,x.c({["error"]:T}));return T?-1<T.indexOf(d.WIi)?9:-1<T.indexOf(d.g4i)||-1<T.indexOf(d.f4i)?12:-1<T.indexOf(d.invalidResourceUrl)?10:-1<T.indexOf(d.userAborted)?8:-1<T.indexOf(d.fJi)||-1<T.indexOf(d.RIi)||T===d.BQj?11:-1<T.indexOf(d.adalTimeout)?6:0:13}KOa(T,H){T=this.Cbj(T.resource);c.ULS.sendTraceTag(39921882,344,50,x.c({["callerId"]:H,["resource"]:T}))}Wlc(){c.ULS.sendTraceTag(39068822,
344,50,x.c({["userAgent"]:window.navigator.userAgent}))}Cbj(T){return(T?T:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(u.a)(E,"WopiIdentityManager",null,[581]);var I=a(248);class L{constructor(){this.gb=null}get name(){return"Common.App.WopiIdentity"}Xh(T){this.gb=T;T.register(E,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").xc().Fc(()=>new E(T.Ub("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&
h.AFrameworkApplication.fa.Ev(Object(b.a)(this,this.JB,"onFullAppSettingsReady"))}JB(){try{this.gb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(T){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+T)}}dispose(){}static main(){I.a.instance.Ei(new L)}}Object(u.a)(L,"WopiIdentityPackage",null,[3,4]);a.d(F,"a",function(){return V});const V=()=>{Type.registerNamespace("Common.App.WopiIdentity");L.main()}},1193:function(u,F,a){a.r(F);u=a(0);var c=
a(7),b=a(15),e=a(4),f=a(157),d=a(187),h=a(83),n=a(188),m=a(60),x=a(49),r=a(37),y=a(227),t=a(116),v=a(529);class w{constructor(Aa){Aa=Aa.split("|");this.yx=Aa[1];this.yTc=Aa[2];this.HXd=Aa[3]}get solutionId(){return this.yx}get solutionVersion(){return this.yTc}get needToRestoreManifest(){return this.HXd===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(w,"AddinStoreInfo",null,[]);class C{}Object(u.a)(C,"CustomFunctionRegistrationInfos",null,[]);var B=a(197),z=a(68);const A=(Aa,da,aa)=>E(Aa,da,
B.a.none,z.a.current,aa),E=(Aa,da,aa,fa,Oa)=>{aa=Aa.continueWith(()=>{da(Aa)},3,aa,fa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,Oa)},4);return aa},I=(Aa,da,aa)=>L(Aa,da,B.a.none,z.a.current,aa),L=(Aa,da,aa,fa,Oa)=>{aa=Aa.jp(()=>da(Aa),3,aa,fa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,Oa)},4);return r.TaskExtensions.tDc(aa)},V=(Aa,da,aa)=>T(Aa,da,B.a.none,z.a.current,aa),T=(Aa,da,aa,fa,Oa)=>{aa=Aa.jp(()=>da(Aa),3,aa,fa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163461,
0,10,Oa)},4);return aa},H=(Aa,da,aa)=>D(Aa,da,B.a.none,z.a.current,aa),D=(Aa,da,aa,fa,Oa)=>{aa=Aa.jp(()=>da(Aa),3,aa,fa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,Oa)},4);return r.TaskExtensions.tDc(aa)},G=(Aa,da,aa)=>J(Aa,da,B.a.none,z.a.current,aa),J=(Aa,da,aa,fa,Oa)=>{aa=Aa.continueWith(()=>{da(Aa)},3,aa,fa);aa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,Oa)},4);return aa},M=(Aa,da)=>{V(a(1193).CustomFunctionsInstaller.o4e("CustomFunctionsRuntimeLogging"),aa=>{if(aa.result&&
window.console)switch(aa=Q(Aa.severity)+" "+Aa.message+da,Aa.severity){case 2:window.console.log&&window.console.log(aa);break;case 0:window.console.info&&window.console.info(aa);break;case 1:window.console.error&&window.console.error(aa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},Q=Aa=>{switch(Aa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var U=a(962);class Z{}Object(u.a)(Z,"InstallationInfo",
null,[]);class P{}Object(u.a)(P,"UninstallationInfo",null,[]);var S=a(28),ja=a(92),X=a(35),Y=a(29),va=a(1),N=a(22),ea=a(281),Ca=a(752),la=a(55);class Ra{constructor(Aa,da){this.VSc=Aa;this._message=da}get severity(){return this.VSc}get message(){return this._message}}Object(u.a)(Ra,"CustomFunctionLog",null,[]);a.d(F,"CustomFunctionsInstaller",function(){return lb});class lb{constructor(Aa,da,aa){this.u_=!1;this.LF={};this.$=Aa;this.wj=da;this.Fod().Ina();this.indexedDB=aa;this.indexedDB.te()&&(this.u_=
!0,this.indexedDB.initialize(lb.Hzb,lb.Izb))}get BV(){return this.wj.BV}nff(Aa,da,aa,fa){if(fa.invariantNamespace)for(let Oa=0;Oa<fa.invariantNamespace.length;++Oa){const ba=fa.invariantNamespace.charAt(Oa);if("."!==ba&&"_"!==ba&&"a">ba&&"z"<ba&&"A">ba&&"Z"<ba&&"0">ba&&"9"<ba)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${ba}', Position=${Oa}.`),Error.create("InvariantNamespace validation failed");}return I(this.CZg(aa,
fa.manifest),()=>I(this.TJd(Aa),Oa=>{let ba=Oa.result;return(null===ba||void 0===ba?0:ba.isDynamicMetadata)?this.XKd(Aa,da,ba,!1,!1,!1):I(this.O3j(Aa,da,fa),ka=>{let Pa;ba=(Pa=new Z,Pa.addinId=aa,Pa.locale=fa.locale,Pa.addinInvariantNamespace=fa.invariantNamespace,Pa.addinNamespace=fa.namespace,Pa.addinTitle=fa.title,Pa.isXllCompatible=fa.isXllCompatible,Pa.metadataContent=JSON.stringify(JSON.parse(ka.result)),Pa);return this.XKd(Aa,da,ba,!1,lb.SDh(fa.osfControl.getStoreType()),U.a(this.$,fa))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}qff(Aa,da,aa,fa){if(!lb.bud(aa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return I(this.TJd(Aa),Oa=>{Oa=Oa.result;if(!Oa&&(Oa=X.a.Dc(this.BV,Aa),!Oa))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,
da,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");Oa.metadataContent=JSON.stringify(JSON.parse(aa));Oa.isDynamicMetadata=!0;return this.XKd(Aa,da,Oa,!0,!0,fa)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Lgg(Aa,da){this.wj.Via();const aa=Object(c.a)(new P,{solutionId:Aa}),fa=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,
da,null)}.`;return I(this.HLd(Aa),()=>I(this.NLd(Aa),()=>this.s0d(this.wj,Aa,da,aa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),fa)}O3j(Aa,da,aa){const fa=new f.a;OSF.OUtil.xhrGet(aa.metadataUrl,Oa=>{Oa?fa.setResult(Oa):fa.setException(Error.create("Invalid manifest"))},Oa=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,
da,null)}. ErrorCode: ${Oa}.`);va.EwaSettings.isChangeGateEnabled("OfficeVSO:7223300_HandleFaultedTaskXhrGetMetadataAsync")?fa.Pr():fa.setException(Error.create("Failed to download manifest"))});return fa.task}Fod(){return I(this.ztc(),Aa=>{const da=Aa.result;if(!da.length)return la.Task.Ta(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Aa=new d.a;const aa=[];for(let fa=0;fa<da.length;fa++){const Oa=Object(h.a)(String,
da[fa]);Aa.add(V(this.TJd(Oa),ba=>{if(ba=ba.result){const ka=X.a.Dc(this.LF,ba.addinId);ka&&ka===ba.metadataContent||(this.LF[ba.addinId]=ba.metadataContent,this.BV[Oa]=ba,aa.push(ba))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return H(la.Task.WhenAllEnumerable(Aa),()=>{if(aa.length){let fa;const Oa=(fa=new C,fa.registrationInfos=aa,fa);return this.f2b(this.wj,da,Oa)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return la.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}rff(){var Aa=new f.a;new d.a;const da=[],aa=[];Object.keys(this.BV).forEach(fa=>{fa=Object(h.a)(String,fa);const Oa=X.a.Dc(this.BV,fa);da.push(Oa);aa.push(fa)});if(!aa.length)return Aa.setResult(!0),Aa.task;Aa=Object(c.a)(new C,{registrationInfos:da});return this.f2b(this.wj,aa,Aa)}ztc(){return V(this.xhd(v.a.TZa),Aa=>{Aa=
Aa.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Aa||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Aa||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Lmg(Aa){return this.hSd(v.a.TZa,Sys.Serialization.JavaScriptSerializer.serialize(Aa))}TJd(Aa){return I(this.xhd(v.a.d5a(Aa)),da=>{da=da.result||"";return 0<da.length?la.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(da,!0)):
la.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}G3j(Aa,da){return I(this.SPe(Aa),()=>I(this.hSd(v.a.d5a(Aa),Sys.Serialization.JavaScriptSerializer.serialize(da)),()=>lb.iSd(v.a.xld,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}HLd(Aa){return I(this.aUf(Aa),
()=>I(this.tUf(v.a.d5a(Aa)),()=>I(this.ztc(),da=>da.result.length?la.Task.Ta(!0):lb.iSd(v.a.xld,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}uRf(Aa){return this.xhd(v.a.c5a(Aa))}Img(Aa,da){return I(this.SPe(Aa),
()=>this.hSd(v.a.c5a(Aa),da),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}NLd(Aa){return I(this.aUf(Aa),()=>this.tUf(v.a.c5a(Aa)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}SPe(Aa){return I(this.ztc(),da=>{da=da.result;const aa=Aa.toLowerCase();if(da.includes(aa))return la.Task.Ta(!0);da.push(aa);return this.Lmg(da)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}aUf(Aa){return I(this.ztc(),
da=>{da=da.result;const aa=Aa.toLowerCase();return da.includes(aa)?(da.splice(Array.indexOf(da,aa),1),this.Lmg(da)):la.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}CZg(Aa,da){if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Aa=new OSF.AddinIdInfo(Aa),Aa.needToRestoreManifest()?this.Img(Aa.getSolutionId(),da):la.Task.Ta(!0);Aa=new w(Aa);return Aa.needToRestoreManifest?this.Img(Aa.solutionId,
da):la.Task.Ta(!0)}Xmj(Aa){if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const aa=new OSF.AddinIdInfo(Aa);return aa.needToRestoreManifest()?V(this.uRf(aa.getSolutionId()),fa=>{(fa=fa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(aa.getSolutionId(),aa.getSolutionVersion(),fa,this.$.va.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):la.Task.Ta(!0)}const da=new w(Aa);return da.needToRestoreManifest?
V(this.uRf(da.solutionId),aa=>{(aa=aa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(da.solutionId,da.solutionVersion,aa,this.$.va.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):la.Task.Ta(!0)}tUf(Aa){return this.u_?this.indexedDB.N7b(Aa):lb.lfj(Aa)}hSd(Aa,da){return this.u_?this.indexedDB.Jna(new Ca.a(Aa,da)):lb.iSd(Aa,da)}xhd(Aa){return this.u_?this.indexedDB.Uja(Aa):lb.o4e(Aa)}XKd(Aa,da,aa,fa,Oa,ba){const ka=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,
da,null)}.`;return r.TaskExtensions.tDc(V(this.YKd(this.wj,Aa,da,aa,!1,fa,ba),()=>Oa?this.G3j(Aa,aa):la.Task.Ta(!0),ka))}YKd(Aa,da,aa,fa,Oa,ba,ka){if(!ba&&(ba=X.a.Dc(this.LF,fa.addinId))&&ba===fa.metadataContent)return la.Task.Ta(!0);this.LF[fa.addinId]=fa.metadataContent;this.BV[da]=fa;ka||Aa.NJb(da);Aa.Via();return I(this.Hcj(da,aa,fa),()=>this.CId(fa.addinId,Oa),"Failed to register functions for customfunction addin")}Hcj(Aa,da,aa){const fa=new f.a,Oa=this.BHa(aa);return this.s4(ba=>{va.EwaSettings.ma(253)&&
M(lb.ptb,Aa);(ba=ba.Result)&&204===ba.ResponseStatusCode?fa.setResult(!0):(delete this.LF[aa.addinId],delete this.BV[Aa],A(this.HLd(Aa),()=>{A(this.NLd(Aa),()=>{this.y8f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Aa}. Received status code ${ba?ba.ResponseStatusCode.toString():"Unknown"}.`),fa.setResult(!1))},ba=>{ba=t.a.Pe(ba.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,
da,null)}. Errors: ${Y.a.sc(ba)}.`);va.EwaSettings.ma(253)&&M(lb.otb,Aa);delete this.LF[aa.addinId];delete this.BV[Aa];fa.setResult(!1)},Oa,fa,!0)}f2b(Aa,da,aa){const fa=new f.a,Oa=S.a.Qa.we.m;da.forEach(ka=>{ka=Object(h.a)(String,ka);Aa.ZBe(ka)});Aa.Via();const ba=this.W_c(aa);return this.s4(ka=>{va.EwaSettings.ma(253)&&M(lb.ptb,Sys.Serialization.JavaScriptSerializer.serialize(da));ka=ka.Result;let Pa=!0;var Fa=Sys.Serialization.JavaScriptSerializer.deserialize(ka.ResponseBody.toString());Fa=Array.isArray(Fa.value)?
Fa.value:null;const oa=new d.a;for(let La=0;La<Fa.length;La++)if(!Fa[La]){Pa=!1;const Ea=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${ka.ResponseStatusCode}.`;oa.add(I(this.HLd(da[La]),()=>{delete this.LF[aa.registrationInfos[La].addinId];delete this.BV[da[La]];return this.NLd(da[La])},Ea))}G(la.Task.WhenAllEnumerable(oa),()=>{A(this.CId("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${S.a.Qa.we.m-
Oa} Millisecond.`);Pa?fa.setResult(Pa):G(this.y8f(),()=>{fa.setResult(Pa)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},ka=>{ka=t.a.Pe(ka.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${Y.a.sc(ka)}.`);
va.EwaSettings.ma(253)&&M(lb.otb,Sys.Serialization.JavaScriptSerializer.serialize(da));for(ka=0;ka<aa.registrationInfos.length;ka++)delete this.LF[aa.registrationInfos[ka].addinId],delete this.BV[da[ka]];fa.setResult(!1)},ba,fa,!0)}s0d(Aa,da,aa,fa){return I(this.eVj(Aa,da,aa,fa),()=>this.CId(fa.solutionId,!1),"Failed to unregister functions for customfunction addin")}eVj(Aa,da,aa,fa){const Oa=new f.a;Aa.NJb(da);(Aa=X.a.Dc(this.BV,da))&&delete this.LF[Aa.addinId];delete this.BV[da];fa=this.h0c(fa);
return this.s4(()=>{va.EwaSettings.ma(253)&&M(lb.p7c,da);Oa.setResult(!0)},ba=>{ba=t.a.Pe(ba.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,aa,null)}. Errors: ${Y.a.sc(ba)}.`);va.EwaSettings.ma(253)&&M(lb.o7c,da);Oa.setResult(!1)},fa,Oa,!1)}s4(Aa,da,aa,fa,Oa){const ba=this.$.userOperationManager,ka=this.$.pa;let Pa=null,Fa=null,oa=null;const La=
()=>{if(ba.xta()||0<ka.ya.YU||0<ka.Nk.YU)return!1;Pa&&ba.ko(Pa);Fa&&ka.Mr(Fa);oa&&ka.gx(oa);const Ea=aa.request;let ca=0;va.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Ea.RequestFlags&1&&256!==(Ea.RequestFlags&256)||(ca=16):ca=Ea.RequestFlags&1?0:16;ba.oD(new n.a(507,0,($a,Qa,Va)=>{va.EwaSettings.ma(253)&&M(Oa?lb.n7c:lb.q7c,Ea.RequestBody);return m.g(ka.ya,"ExecuteRichApiRequest",aa,ea.b($a,Aa),ea.a(Qa,da),Va,null,0)},ca|64));return!0};La()||(Pa=()=>{La()},
Fa=()=>{La()},oa=()=>{La()},ba.ur(Pa),ka.Kq(Fa),ka.iw(oa));return fa.task}BHa(Aa){const da={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};da.RequestBody=JSON.stringify(Aa);da.RequestFlags=1;va.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(da.RequestFlags|=256);Aa=this.$.pa.ya.Na(1);Aa.request=da;return Aa}W_c(Aa){const da={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};da.RequestBody=JSON.stringify(Aa);
da.RequestFlags=1;va.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(da.RequestFlags|=256);Aa=this.$.pa.ya.Na(1);Aa.request=da;return Aa}h0c(Aa){const da={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};da.RequestBody=JSON.stringify(Aa);da.RequestFlags=1;va.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(da.RequestFlags|=256);Aa=this.$.pa.ya.Na(1);Aa.request=da;return Aa}CId(Aa,da){const aa=
x.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);return L(aa,()=>{aa.result.TNd();return Aa&&da?this.Xmj(Aa):la.Task.Ta(!0)},this.$.ka,y.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}y8f(){const Aa=new ja.a(1949669462,0,this.$.Hc,0,null);return this.$.Ja.Lb(Aa)}static o4e(Aa){try{return la.Task.Ta(localStorage.getItem(Aa))}catch(da){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${da.message||
"Unknown"}`),la.Task.Ta(null)}}static iSd(Aa,da){try{return localStorage.setItem(Aa,da),la.Task.Ta(!0)}catch(aa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${aa.message||"Unknown"}`),la.Task.Ta(!1)}}static lfj(Aa){try{return localStorage.removeItem(Aa),la.Task.Ta(!0)}catch(da){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${da.message||
"Unknown"}`),la.Task.Ta(!1)}}static SDh(Aa){return N.a.equals(Aa,"registry",!0)||N.a.equals(Aa,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static bud(Aa){if(!Aa)return!1;try{JSON.parse(Aa)}catch(da){return!1}return!0}}lb.Hzb="CustomFunctionCache";lb.Izb="CustomFunction";lb.n7c=new Ra(2,"CustomFunctions [Registration] [Begin] SolutionId=");lb.ptb=new Ra(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");lb.otb=new Ra(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
lb.q7c=new Ra(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");lb.p7c=new Ra(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");lb.o7c=new Ra(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(lb,"CustomFunctionsInstaller",null,[714])},1196:function(u,F,a){a.r(F);u=a(0);var c=a(7),b=a(15),e=a(935),f=a(157),d=a(83),h=a(188),n=a(60),m=a(49),x=a(37),r=a(116),y=a(529),t=a(962);class v{constructor(Q){Q=Q.split("|");this.yx=Q[1];this.yTc=Q[2];this.HXd=
Q[3]}get solutionId(){return this.yx}get solutionVersion(){return this.yTc}get needToRestoreManifest(){return this.HXd===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(v,"AddinStoreInfo",null,[]);class w{}Object(u.a)(w,"CustomFunctionRegistrationInfos",null,[]);const C=(Q,U)=>{if(a(1196).CustomFunctionsLegacyInstaller.qxb("CustomFunctionsRuntimeLogging")&&window.console)switch(U=B(Q.severity)+" "+Q.message+U,Q.severity){case 2:window.console.log&&window.console.log(U);break;case 0:window.console.info&&
window.console.info(U);break;case 1:window.console.error&&window.console.error(U)}},B=Q=>{switch(Q){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class z{}Object(u.a)(z,"InstallationInfo",null,[]);class A{}Object(u.a)(A,"UninstallationInfo",null,[]);var E=a(153),I=a(35),L=a(29),V=a(1),T=a(13),H=a(281),D=a(865),G=a(55);class J{constructor(Q,U){this.VSc=Q;this._message=U}get severity(){return this.VSc}get message(){return this._message}}Object(u.a)(J,"CustomFunctionLog",
null,[]);a.d(F,"CustomFunctionsLegacyInstaller",function(){return M});class M{constructor(Q){this.LF={};this.$=Q;this.Fod().Ina()}nff(Q,U,Z,P){const S=new f.a;if(P.invariantNamespace)for(U=0;U<P.invariantNamespace.length;++U){const X=P.invariantNamespace.charAt(U);if("."!==X&&"_"!==X&&"a">X&&"z"<X&&"A">X&&"Z"<X&&"0">X&&"9"<X)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${X}', Position=${U}.`),S.setResult(!1),
S.task}M.cacheManifest(Z,P.manifest);let ja=M.UJd(Q);(null===ja||void 0===ja?0:ja.isDynamicMetadata)?this.WKd(Q,ja,S,!1,!1):OSF.OUtil.xhrGet(P.metadataUrl,X=>{ja=Object(c.a)(new z,{addinId:Z,locale:P.locale,addinInvariantNamespace:P.invariantNamespace,addinNamespace:P.namespace,addinTitle:P.title,isXllCompatible:P.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(X))});this.WKd(Q,ja,S,!1,t.a(this.$,P))},X=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${Q}. ErrorCode: ${X}.`);
S.setResult(!1)});return S.task}qff(Q,U,Z,P){U=new f.a;if(!M.bud(Z))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),U.setResult(!1),U.task;const S=M.UJd(Q);if(!S)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),U.setResult(!1),U.task;S.metadataContent=JSON.stringify(JSON.parse(Z));S.isDynamicMetadata=
!0;this.WKd(Q,S,U,!0,P);return U.task}Lgg(Q){const U=new f.a,Z=m.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);x.TaskExtensions.za(Z,()=>{const P=Z.result;P.Via();const S=Object(c.a)(new A,{solutionId:Q});M.ILd(Q);M.OLd(Q);x.TaskExtensions.za(this.s0d(P,Q,S),ja=>{E.b(ja)?U.setResult(ja.result):(ja.Pf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Q}.`):ja.qh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${Q}.`),
U.setResult(!1))},this.$.ka,0)},this.$.ka,3);return U.task}Fod(){const Q=new f.a,U=M.$Jd();0<U.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Z=[];U.forEach(S=>{S=Object(d.a)(String,S);if(S=M.UJd(S)){const ja=I.a.Dc(this.LF,S.addinId);ja&&ja===S.metadataContent||(this.LF[S.addinId]=S.metadataContent,Z.push(S))}});if(!Z.length)return Q.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
Q.task;const P=m.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);x.TaskExtensions.za(P,()=>{const S=P.result,ja=Object(c.a)(new w,{registrationInfos:Z});x.TaskExtensions.za(this.f2b(S,U,ja),X=>{E.b(X)?Q.setResult(X.result):(X.Pf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):X.qh&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
Q.setResult(!1))},this.$.ka,0)},this.$.ka,3);return Q.task}Wmj(Q){Q=new v(Q);if(Q.needToRestoreManifest){const U=M.laj(Q.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(Q.solutionId,Q.solutionVersion,U,this.$.va.UICultureTag)}}WKd(Q,U,Z,P,S){const ja=m.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);x.TaskExtensions.za(ja,()=>{x.TaskExtensions.za(this.YKd(ja.result,Q,U,!1,P,S),X=>{E.b(X)?((X=X.result)&&M.H3j(Q,U),Z.setResult(X)):(X.Pf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${Q}.`):
X.qh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${Q}.`),Z.setResult(!1))},this.$.ka,0)},this.$.ka,3)}YKd(Q,U,Z,P,S,ja){if(!S&&(S=I.a.Dc(this.LF,Z.addinId))&&S===Z.metadataContent)return G.Task.Ta(!0);this.LF[Z.addinId]=Z.metadataContent;const X=new f.a;ja||Q.NJb(U);Q.Via();Q=this.BHa(Z);return this.s4(Y=>{V.EwaSettings.ma(253)&&C(M.ptb,U);const va=Y.Result;204===va.ResponseStatusCode?x.TaskExtensions.za(this.BId(X,
Z.addinId,P),N=>{N.Pf?U?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${U}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Z.addinId}.`):N.qh&&(U?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${U}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Z.addinId}.`));X.setResult(!1)},this.$.ka,4):(Y=()=>{delete this.LF[Z.addinId];M.ILd(U);M.OLd(U);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${U}. Received status code ${va.ResponseStatusCode}.`);X.setResult(!1)},Y=Object(c.a)(new D.a,{HMa:OSF.InfoType.Error,title:Z.addinTitle,
description:String.format(T.a.instance.mb(153),T.a.instance.ga(1883)),buttonText:T.a.instance.ga(4),Iha:Y,Ffc:!1,Jia:Y,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.TUd(Y))},Y=>{Y=r.a.Pe(Y.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${U}. Errors: ${L.a.sc(Y)}.`);V.EwaSettings.ma(253)&&C(M.otb,U);delete this.LF[Z.addinId];X.setResult(!1)},Q,X,!0)}f2b(Q,U,Z){const P=
new f.a;U.forEach(ja=>{ja=Object(d.a)(String,ja);Q.ZBe(ja)});Q.Via();const S=this.W_c(Z);return this.s4(ja=>{V.EwaSettings.ma(253)&&C(M.ptb,Sys.Serialization.JavaScriptSerializer.serialize(U));ja=ja.Result;let X=!0;var Y=Sys.Serialization.JavaScriptSerializer.deserialize(ja.ResponseBody.toString());Y=Array.isArray(Y.value)?Y.value:null;for(let va=0;va<Y.length;va++)Y[va]||(X=!1,delete this.LF[Z.registrationInfos[va].addinId],M.ILd(U[va]),M.OLd(U[va]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${U[va]}. Received status code ${ja.ResponseStatusCode}.`));
x.TaskExtensions.za(this.BId(P,"",!1),va=>{va.Pf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):va.qh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");P.setResult(!1)},this.$.ka,4);P.setResult(X)},ja=>{ja=r.a.Pe(ja.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(U)}. Errors: ${L.a.sc(ja)}.`);
V.EwaSettings.ma(253)&&C(M.otb,Sys.Serialization.JavaScriptSerializer.serialize(U));for(const X of Z.registrationInfos)delete this.LF[X.addinId];P.setResult(!1)},S,P,!0)}s0d(Q,U,Z){const P=new f.a;Q.NJb(U);Q=this.h0c(Z);return this.s4(()=>{V.EwaSettings.ma(253)&&C(M.p7c,U);x.TaskExtensions.za(this.BId(P,Z.solutionId,!1),S=>{S.Pf?U&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${U}.`):S.qh&&U&&
b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${U}.`);P.setResult(!1)},this.$.ka,4)},S=>{S=r.a.Pe(S.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${U}. Errors: ${L.a.sc(S)}.`);V.EwaSettings.ma(253)&&C(M.o7c,U);P.setResult(!1)},Q,P,!1)}s4(Q,U,Z,P,S){const ja=this.$.userOperationManager,
X=this.$.pa;let Y=null,va=null,N=null;const ea=()=>{if(ja.xta()||0<X.ya.YU||0<X.Nk.YU)return!1;Y&&ja.ko(Y);va&&X.Mr(va);N&&X.gx(N);const Ca=Z.request;ja.oD(new h.a(507,0,(la,Ra,lb)=>{V.EwaSettings.ma(253)&&C(S?M.n7c:M.q7c,Ca.RequestBody);return n.g(X.ya,"ExecuteRichApiRequest",Z,H.b(la,Q),H.a(Ra,U),lb,null,0)},(Ca.RequestFlags&1?0:16)|64));return!0};ea()||(Y=()=>{ea()},va=()=>{ea()},N=()=>{ea()},ja.ur(Y),X.Kq(va),X.iw(N));return P.task}BHa(Q){const U={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};U.RequestBody=JSON.stringify(Q);U.RequestFlags=1;Q=this.$.pa.ya.Na(1);Q.request=U;return Q}W_c(Q){const U={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(Q);U.RequestFlags=1;Q=this.$.pa.ya.Na(1);Q.request=U;return Q}h0c(Q){const U={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(Q);U.RequestFlags=1;Q=this.$.pa.ya.Na(1);Q.request=U;return Q}BId(Q,U,Z){const P=
m.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);x.TaskExtensions.za(P,()=>{P.result.TNd();U&&Z&&this.Wmj(U);Q.setResult(!0)},this.$.ka,3);return P}rff(){return G.Task.Ta(!0)}static $Jd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(M.qxb(y.a.TZa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(M.qxb(y.a.TZa)||"[]"):null)||[]}static Mmg(Q){M.jSd(y.a.TZa,Sys.Serialization.JavaScriptSerializer.serialize(Q))}static UJd(Q){Q=M.qxb(y.a.d5a(Q))||"";return 0<
Q.length?Sys.Serialization.JavaScriptSerializer.deserialize(Q,!0):null}static H3j(Q,U){M.RPe(Q);M.jSd(y.a.d5a(Q),Sys.Serialization.JavaScriptSerializer.serialize(U))}static ILd(Q){M.$Tf(Q);M.uUf(y.a.d5a(Q))}static laj(Q){return M.qxb(y.a.c5a(Q))}static I3j(Q,U){M.RPe(Q);M.jSd(y.a.c5a(Q),U)}static OLd(Q){M.$Tf(Q);M.uUf(y.a.c5a(Q))}static RPe(Q){const U=M.$Jd();Q=Q.toLowerCase();U.includes(Q)||(U.push(Q),M.Mmg(U))}static $Tf(Q){const U=M.$Jd();Q=Q.toLowerCase();U.includes(Q)&&(U.splice(Array.indexOf(U,
Q),1),M.Mmg(U))}static cacheManifest(Q,U){Q=new v(Q);Q.needToRestoreManifest&&M.I3j(Q.solutionId,U)}static qxb(Q){try{return localStorage.getItem(Q)}catch(U){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${U.message||"Unknown"}`),null}}static jSd(Q,U){try{localStorage.setItem(Q,U)}catch(Z){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Z.message||
"Unknown"}`)}}static uUf(Q){try{localStorage.removeItem(Q)}catch(U){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${U.message||"Unknown"}`)}}static bud(Q){if(!Q)return!1;try{JSON.parse(Q)}catch(U){return!1}return!0}}M.n7c=new J(2,"CustomFunctions [Registration] [Begin] SolutionId=");M.ptb=new J(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");M.otb=new J(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
M.q7c=new J(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");M.p7c=new J(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");M.o7c=new J(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(M,"CustomFunctionsLegacyInstaller",null,[714])},1235:function(u,F,a){u=a(0);var c=a(197),b=a(15);class e{}Object(u.a)(e,"AddinCommandsHost",null,[]);var f=a(1318),d=a(1395),h=a(863),n=a(60);const m=(I,L,V,T,H,D)=>{const G=I.Na(9);G.sharedInfo=L;return n.g(I,"InsertAgaveTaskpane",
G,V,T,H,D,0)},x=(I,L,V,T,H,D,G=null)=>{G=I.Na(9,G);G.sharedInfo=L;return n.g(I,"ShowAgaveTaskpane",G,V,T,H,D,0)};var r=a(374),y=a(188),t=a(37),v=a(1),w=a(281),C=a(146);class B extends C.a{constructor(I){super();this.Fe=this.RDa="AddInCommandsDialog";this.Rb=5;this.dialogWidth=695;this.dialogHeight=438;this.g8g="100%";this.d8g="408px";this.e8g="15px";this.f8g="0";this.Ozg=I}get containerDiv(){return this.Vk}Xz(){super.Xz();this.Vk.style.width=this.g8g;this.Vk.style.height=this.d8g;this.Vk.style.marginTop=
this.e8g;this.Vk.style.padding=this.f8g}SI(){super.SI();this.wb.style.width=String.format("{0}px",this.dialogWidth);this.wb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.Ozg()}}Object(u.a)(B,"AddInCommandsDialog",C.a,[]);var z=a(55),A=a(68);C=a(99);a.d(F,"a",function(){return E});class E extends e{constructor(I,L,V,T=null,H=null){super();this.$=I;this.je=L;this.ownerAddinInfo=V;this.Wd=H;this.mdb=T||z.Task.Ta(!0)}a8g(){const I=this.mdb;this.mdb=z.Task.Ta(!0);
return I}disposeHost(I){this.je.qRa(I)}setOwnerAddinEToken(I){this.ownerAddinInfo.eToken=I}showTaskpane(I,L,V){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let T=null,H=!1,D=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,!0)).fKe(I.solutionId.substr(this.ownerAddinInfo.solutionId.length));T=L.getSharedRuntimeForTaskpane("Workbook",D);H=!!T&&1===T.LifeTime;this.je.bCe(H?this.ownerAddinInfo.solutionId:I.solutionId,H?T:null,null)||(this.Xrf(H,!0),this.mdb=
this.Dod(I,T,(G,J)=>{G?(H&&(G.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,G.SharedRuntime=T),G.WebExtensionOsfControlType=3,this.je.LIa(G),V(G.InstanceId,J),this.Xrf(H,!1),v.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),V(null,J))}))}getSettings(I,L){let V=this.je.Jaa(I.solutionId);
V?L(this.je.KZ(V).OsfPropertyBag):this.mdb=this.Dod(I,null,T=>{T?L(T.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(I,L,V){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const T=this.$.pa.ya,H=G=>{const J=G.Result,M=J?J.AgaveData:null;M?(this.je.$Ie(M,()=>{const Q=new B(()=>{this.disposeHost(M.InstanceId)});Q.initializeAndShow("",null,null);return Q.containerDiv}),V(M.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
V(null,G.Errors?G.Errors[0].ErrorCause:5001))},D=E.Vsb(I,this.ownerAddinInfo);this.mdb=r.a(this.$.userOperationManager,(G,J,M)=>m(T,D,w.b(G,H),J,M,null),G=>new y.a(500,0,G,64),this.Wd)}createUILessSandbox(I,L,V){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const T=L.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),H=!!T&&1===T.LifeTime;(L=this.je.vGh(H?this.ownerAddinInfo.solutionId:I.solutionId,H?T:null))?V(L,0):this.mdb=this.Dod(I,T,(D,G)=>{D?(H?(D.PrimaryMarketplace.SolutionId=
this.ownerAddinInfo.solutionId,D.SharedRuntime=T,D.TaskpaneVisible=!1,D.WebExtensionOsfControlType=3,this.je.LIa(D)):(D.WebExtensionOsfControlType=4,this.je.$Ie(D,()=>{E.ngb.ia(D.InstanceId,new d.a);return E.ngb.na(D.InstanceId).Hia})),V(D.InstanceId,G)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),V(null,G))})}Dod(I,L,V){let T=null;const H=this.$.pa.ya,D=U=>{const Z=U.Result;(T=Z?Z.AgaveData:null)||V(null,U.Errors?U.Errors[0].ErrorCause:5001)},G=E.Vsb(I,this.ownerAddinInfo);
L&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),G.SharedRuntimeId=L.Resid);let J=500;var M=(U,Z,P)=>m(H,G,w.b(U,D),Z,P,null);let Q=0;void 0===G.IsToBePersisted||null===G.IsToBePersisted||G.IsToBePersisted||(J=538,M=(U,Z,P)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,
null,null,this.ownerAddinInfo.storeId));return x(H,G,w.b(U,D),Z,P,null)},Q=16);Q|=64;M=r.a(this.$.userOperationManager,M,U=>new y.a(J,0,U,Q),this.Wd);return t.TaskExtensions.ts(M,()=>T?this.swd(H,T.InstanceId,(U,Z)=>{if(U){L||(T.PrimaryMarketplace.MarketplaceType=I.storeType);v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(I.assetId?I.assetId.toLowerCase().startsWith("wa")?T.AssetMarketplace={SolutionId:I.assetId,SolutionVersion:I.version,MarketplaceType:OSF.StoreType.OMEX,
MarketplaceRef:I.assetStoreId}:(T.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,50,"WACExcelAddinCommandsHost: AssetId is not a valid value")):T.AssetMarketplace=null);T.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;T.OwnerAddinStoreType=this.ownerAddinInfo.storeType;T.OsfPropertyBag=[];for(Z=0;Z<U.Settings.length;Z++){const P=[];P[0]=U.Settings[Z].Name;P[1]=U.Settings[Z].Value;T.OsfPropertyBag[Z]=P}V(T,0)}else V(null,Z.Errors?Z.Errors[0].ErrorCause:5001)}):z.Task.Ta(!1),c.a.none,3,
A.a.current)}swd(I,L,V){const T=H=>{V(H.Result,H)};return r.a(this.$.userOperationManager,(H,D,G)=>{H=w.b(H,T);const J=I.Na(1);J.controlId=L;return n.g(I,"DdaLoadSettings",J,H,D,G,null,0)},H=>new y.a(501,0,H,80),this.Wd)}Xrf(I,L){var V;I&&(null===(V=window.performance)||void 0===V?0:V.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${L}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(I){E.ngb.lb(I)&&
E.ngb.na(I).initializeAndShowWithTitle()}static hideUILessDialog(I){E.ngb.lb(I)&&E.ngb.na(I).hide()}static Vsb(I,L){const V={};V.SolutionId=I.solutionId;V.Version=I.version;V.StoreType=L.storeType;V.StoreId=I.storeId;V.AssetId=I.solutionId;V.AssetStoreId="omex";V.TargetType=1;V.Width=350;V.OwnerAddinSolutionId=L.solutionId;V.OwnerAddinStoreType=L.storeType;V.SharedRuntimeId=null;V.Preload=!1;return V}}E.ngb=new C.a;Object(u.a)(E,"WACExcelAddinCommandsHost",e,[])},1241:function(u,F,a){var c=a(9);u=
a(0);var b=a(694),e=a(15),f=a(103),d=a(4),h=a(1309),n=a(1),m=a(184),x=a(55);class r{constructor(C,B,z){this.stb=null;this.$=C;B?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.stb=new h.a(C,B,z)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}nc(){return!1}executeCommand(C,B,z){C=!1;switch(B.command){case 73979048:this.stb&&
this.stb.n5i(B,f.a.instance,d.AFrameworkApplication.fa,z),C=!0}return C?x.Task.Ta(!0):m.a(B.command)}wc(C,B){return 73979048===B.command&&n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Kc(){return!1}dispose(){this.stb&&this.stb.dispose()}}Object(u.a)(r,"DataFromPictureCommandHandler",null,[208,2]);var y=a(37),t=a(49);class v extends b.a{constructor(C){super(C)}ld(){const C=t.GetServiceTaskFactory.Oa(this.$.da,328,327,1),B=t.GetServiceTaskFactory.Oa(this.$.da,
484,485,1);y.TaskExtensions.za(y.TaskExtensions.Ed([C,B],this.$.ka),()=>{this.Zc([new r(this.$,C.result,B.result)])},this.$.ka,3)}static la(C){b.a.Nd(452,new v(C))}}Object(u.a)(v,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return w});const w=()=>{c.a.Fa(C=>{v.la(C)})}},1301:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static LNh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(u.a)(c,"WopiAuthContext",null,[610])},1302:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{}c.YJf="OneDriveWOPI";Object(u.a)(c,"HostApplicationType",null,[])},1309:function(u,F,a){(function(c){a.d(F,"a",function(){return E});var b=a(0),e=a(15),f=a(171),d=a(83),
h=a(1315),n=a(38),m=a(249),x=a(40),r=a(374),y=a(188),t=a(60),v=a(92),w=a(13),C=a(21),B=a(41),z=a(1316),A=a(1);class E extends n.a{constructor(I,L,V){super();this.uci=h.a.getTypeName();this.vzb=this.pU=this.Wd=null;this.imageHeight=this.imageWidth=0;this.EMa=this.errorMessage=this.tableData=null;this.Rmd=0;this.yVc=!1;this.lKe=T=>{if(T){var H={};if(({Ft:H}=B.d(this.Dih(T.data))).returnValue&&(T=Object(d.a)(Object,H),"."===T.DataFromPictureWildcard))if(T.SessionId!==this.EMa)e.ULS.sendTraceTag(523805139,
0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),T.CmdType){case "ACK":this.yVc=!0;this.Ucg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.vsj();0<this.errorMessage.length?
this.K1f():0<this.tableData.length&&this.c2f();break;case "insert_html":const G=this.$.pa.ya;H={};var D=C.h(this.$).ha.ra.dd.clone();H.PasteId=f.a.create().toString();H.DestinationRanges=x.s(x.v(D,this.$));D=T.Parameters.split("|",3);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${D[0]}|${D[1]}|${D[2]}.`);D=T.Parameters.indexOf("|");D=T.Parameters.indexOf("|",
D+1);D=T.Parameters.indexOf("|",D+1);H.SourceHtml=T.Parameters.substring(D+1);H.CopyOperationId=null;const J=G.Na(1,G.Wb());J.pasteHtmlParameters=H;r.a(this.$.userOperationManager,(M,Q,U)=>t.g(G,"pasteHtmlContent",J,M,Q,U,null,64),M=>new y.a(204,0,M,1),null);this.Rmd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Rmd.toString()}`)}}};this.tci=(T,H)=>{if(T=H.FM)if(!H.parentPath||1>=H.parentPath.length||
H.parentPath[1]!==this.EMa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");H=T.errorCode;switch(H){case null:case -1:this.errorMessage=w.a.instance.ga(2267);break;case 1:this.errorMessage=w.a.instance.ga(2268);break;case 2:this.errorMessage=w.a.instance.ga(2269)}0<this.errorMessage.length&&
e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${H?H.toString():"null"}.`);this.Tte.stop();this.tableData=T.html;this.yVc&&(0<this.errorMessage.length?this.K1f():0<this.tableData.length&&this.c2f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=I;this.augmentationLoopManager=L;this.uploaderCreator=V;this.initialize()}dispose(){window.removeEventListener("message",
this.lKe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}UXi(I,L){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let V=new Image;V.onload=()=>{var T=document.createElement("canvas");T.width=V.width;T.height=V.height;const H=T.getContext("2d");try{H.drawImage(V,0,0,V.width,V.height)}catch(J){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${J.message}`);
return}let D;try{D=T.toDataURL("image/jpeg")}catch(J){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${J.message}`);return}T=D.split(",");if(2>T.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{T=T[1];try{var G=window.self.atob(T)}catch(J){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${J.message}`);
return}28E5<G.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.BFj()):(this.Moj(this.Wd,this.pU,T,V.width,V.height),URL.revokeObjectURL(V.src),V=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};V.src=I}n5i(I,L,V,T){this.Wd=I;this.pU=T;this.uploaderCreator.dfi(this.$,L,V,T,this)}Moj(I,L,V,T,H){this.EMa=f.a.create().toString();this.Rmd=0;this.vzb=V;this.imageWidth=T;this.imageHeight=
H;this.errorMessage=this.tableData="";this.yVc=!1;this.Ucg=this.$.Kb.Qg("LoadResource","DataFromPictureTaskpaneLaunch");this.Ucg.start();this.C_i(I,L);this.Tte=this.$.Kb.Qg("LoadResource","DataFromPictureAnnotation");this.Tte.start();this.q_j()}q_j(){if(this.vzb.length){var I=window.self.atob(this.vzb);var L=new Uint8Array(I.length);for(let V=0;V<I.length;V++)L[V]=I.charCodeAt(V);this.augmentationLoopManager.p_j(L,this.EMa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}C_i(I,
L){L.SessionID=this.EMa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;I=new v.a(-859308420,I.method,I.mode,I.af,I.tabName);this.$.Ja.Lb(I,L)}g$c(I){try{const L=c.from(I,"utf16le").toString("base64");return z.a.BIa(this.EMa,L)}catch(L){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Dih(I){try{const L=z.a.BIa(this.EMa,I);return c.from(L,"base64").toString("utf16le")}catch(L){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}vsj(){if(this.vzb.length){var I=m.a(this.$).Jaa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.imageData=this.g$c(this.vzb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,V=>{V&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}c2f(){if(this.tableData.length){var I=
m.a(this.$).Jaa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.tableHtml=this.g$c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,V=>{V&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}K1f(){if(this.errorMessage.length){var I=
m.a(this.$).Jaa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.errorMessage=this.g$c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,V=>{V&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.lKe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.Lbc().iyc("DataFromPicture").Wxc(()=>{}).activateAnnotation({annotationType:this.uci,w_:!1,mPa:this.tci}).build())}}Object(b.a)(E,"DataFromPictureManager",n.a,[365])}).call(this,a(1310).vng)},1310:function(u,F,a){(function(c){function b(){try{var H=new Uint8Array(1);H.__proto__={__proto__:Uint8Array.prototype,r5j:function(){return 42}};return"function"===typeof H.subarray&&0===H.subarray(1,1).byteLength}catch(D){return!1}}
function e(H,D){if((f.oP?2147483647:1073741823)<D)throw new RangeError("Invalid typed array length");f.oP?(H=new Uint8Array(D),H.__proto__=f.prototype):(null===H&&(H=new f(D)),H.length=D);return H}function f(H,D,G){if(!(f.oP||this instanceof f))return new f(H,D,G);if("number"===typeof H){if("string"===typeof D)throw Error("If encoding is specified then the first argument must be a string");return n(this,H)}return d(this,H,D,G)}function d(H,D,G,J){if("number"===typeof D)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&D instanceof ArrayBuffer){D.byteLength;if(0>G||D.byteLength<G)throw new RangeError("'offset' is out of bounds");if(D.byteLength<G+(J||0))throw new RangeError("'length' is out of bounds");D=void 0===G&&void 0===J?new Uint8Array(D):void 0===J?new Uint8Array(D,G):new Uint8Array(D,G,J);f.oP?(H=D,H.__proto__=f.prototype):H=m(H,D);D=H}else if("string"===typeof D){J=H;H=G;if("string"!==typeof H||""===H)H="utf8";if(!f.Whf(H))throw new TypeError('"encoding" must be a valid string encoding');
G=y(D,H)|0;J=e(J,G);D=J.write(D,H);D!==G&&(J=J.slice(0,D));D=J}else D=x(H,D);return D}function h(H){if("number"!==typeof H)throw new TypeError('"size" argument must be a number');if(0>H)throw new RangeError('"size" argument must not be negative');}function n(H,D){h(D);H=e(H,0>D?0:r(D)|0);if(!f.oP)for(var G=0;G<D;++G)H[G]=0;return H}function m(H,D){var G=0>D.length?0:r(D.length)|0;H=e(H,G);for(var J=0;J<G;J+=1)H[J]=D[J]&255;return H}function x(H,D){if(f.isBuffer(D)){var G=r(D.length)|0;H=e(H,G);if(0===
H.length)return H;D.copy(H,0,0,G);return H}if(D){if("undefined"!==typeof ArrayBuffer&&D.buffer instanceof ArrayBuffer||"length"in D)return(G="number"!==typeof D.length)||(G=D.length,G=G!==G),G?e(H,0):m(H,D);if("Buffer"===D.type&&L(D.data))return m(H,D.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function r(H){if(H>=(f.oP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.oP?2147483647:
1073741823).toString(16)+" bytes");return H|0}function y(H,D){if(f.isBuffer(H))return H.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(H)||H instanceof ArrayBuffer))return H.byteLength;"string"!==typeof H&&(H=""+H);var G=H.length;if(0===G)return 0;for(var J=!1;;)switch(D){case "ascii":case "latin1":case "binary":return G;case "utf8":case "utf-8":case void 0:return B(H).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
G;case "hex":return G>>>1;case "base64":return A(H).length;default:if(J)return B(H).length;D=(""+D).toLowerCase();J=!0}}function t(H,D,G){var J=!1;if(void 0===D||0>D)D=0;if(D>this.length)return"";if(void 0===G||G>this.length)G=this.length;if(0>=G)return"";G>>>=0;D>>>=0;if(G<=D)return"";for(H||(H="utf8");;)switch(H){case "hex":H=D;D=G;G=this.length;if(!H||0>H)H=0;if(!D||0>D||D>G)D=G;J="";for(G=H;G<D;++G)H=J,J=this[G],J=16>J?"0"+J.toString(16):J.toString(16),J=H+J;return J;case "utf8":case "utf-8":return C(this,
D,G);case "ascii":H="";for(G=Math.min(this.length,G);D<G;++D)H+=String.fromCharCode(this[D]&127);return H;case "latin1":case "binary":H="";for(G=Math.min(this.length,G);D<G;++D)H+=String.fromCharCode(this[D]);return H;case "base64":return 0===D&&G===this.length?I.IZe(this):I.IZe(this.slice(D,G));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":D=this.slice(D,G);G="";for(H=0;H<D.length;H+=2)G+=String.fromCharCode(D[H]+256*D[H+1]);return G;default:if(J)throw new TypeError("Unknown encoding: "+
H);H=(H+"").toLowerCase();J=!0}}function v(H,D,G,J,M){if(0===H.length)return-1;"string"===typeof G?(J=G,G=0):2147483647<G?G=2147483647:-2147483648>G&&(G=-2147483648);G=+G;isNaN(G)&&(G=M?0:H.length-1);0>G&&(G=H.length+G);if(G>=H.length){if(M)return-1;G=H.length-1}else if(0>G)if(M)G=0;else return-1;"string"===typeof D&&(D=f.from(D,J));if(f.isBuffer(D))return 0===D.length?-1:w(H,D,G,J,M);if("number"===typeof D)return D&=255,f.oP&&"function"===typeof Uint8Array.prototype.indexOf?M?Uint8Array.prototype.indexOf.call(H,
D,G):Uint8Array.prototype.lastIndexOf.call(H,D,G):w(H,[D],G,J,M);throw new TypeError("val must be string, number or Buffer");}function w(H,D,G,J,M){function Q(S,ja){return 1===U?S[ja]:S.uaj(ja*U)}var U=1,Z=H.length,P=D.length;if(void 0!==J&&(J=String(J).toLowerCase(),"ucs2"===J||"ucs-2"===J||"utf16le"===J||"utf-16le"===J)){if(2>H.length||2>D.length)return-1;U=2;Z/=2;P/=2;G/=2}if(M)for(J=-1;G<Z;G++)if(Q(H,G)===Q(D,-1===J?0:G-J)){if(-1===J&&(J=G),G-J+1===P)return J*U}else-1!==J&&(G-=G-J),J=-1;else for(G+
P>Z&&(G=Z-P);0<=G;G--){Z=!0;for(J=0;J<P;J++)if(Q(H,G+J)!==Q(D,J)){Z=!1;break}if(Z)return G}return-1}function C(H,D,G){G=Math.min(H.length,G);for(var J=[];D<G;){var M=H[D],Q=null,U=239<M?4:223<M?3:191<M?2:1;if(D+U<=G)switch(U){case 1:128>M&&(Q=M);break;case 2:var Z=H[D+1];128===(Z&192)&&(M=(M&31)<<6|Z&63,127<M&&(Q=M));break;case 3:Z=H[D+1];var P=H[D+2];128===(Z&192)&&128===(P&192)&&(M=(M&15)<<12|(Z&63)<<6|P&63,2047<M&&(55296>M||57343<M)&&(Q=M));break;case 4:Z=H[D+1];P=H[D+2];var S=H[D+3];128===(Z&
192)&&128===(P&192)&&128===(S&192)&&(M=(M&15)<<18|(Z&63)<<12|(P&63)<<6|S&63,65535<M&&1114112>M&&(Q=M))}null===Q?(Q=65533,U=1):65535<Q&&(Q-=65536,J.push(Q>>>10&1023|55296),Q=56320|Q&1023);J.push(Q);D+=U}H=J.length;if(H<=V)J=String.fromCharCode.apply(String,J);else{G="";for(D=0;D<H;)G+=String.fromCharCode.apply(String,J.slice(D,D+=V));J=G}return J}function B(H,D){D=D||Infinity;for(var G,J=H.length,M=null,Q=[],U=0;U<J;++U){G=H.charCodeAt(U);if(55295<G&&57344>G){if(!M){if(56319<G){-1<(D-=3)&&Q.push(239,
191,189);continue}else if(U+1===J){-1<(D-=3)&&Q.push(239,191,189);continue}M=G;continue}if(56320>G){-1<(D-=3)&&Q.push(239,191,189);M=G;continue}G=(M-55296<<10|G-56320)+65536}else M&&-1<(D-=3)&&Q.push(239,191,189);M=null;if(128>G){if(0>--D)break;Q.push(G)}else if(2048>G){if(0>(D-=2))break;Q.push(G>>6|192,G&63|128)}else if(65536>G){if(0>(D-=3))break;Q.push(G>>12|224,G>>6&63|128,G&63|128)}else if(1114112>G){if(0>(D-=4))break;Q.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw Error("Invalid code point");
}return Q}function z(H){for(var D=[],G=0;G<H.length;++G)D.push(H.charCodeAt(G)&255);return D}function A(H){var D=I,G=D.ZPj;H=(H.trim?H.trim():H.replace(/^\s+|\s+$/g,"")).replace(T,"");if(2>H.length)H="";else for(;0!==H.length%4;)H+="=";return G.call(D,H)}function E(H,D,G,J){for(var M=0;M<J&&!(M+G>=D.length||M>=H.length);++M)D[M+G]=H[M];return M}var I=a(1312);a(1313);var L=a(1314);F.vng=f;F.P4j=function(H){+H!=H&&(H=0);return f.mte(+H)};F.w4j=50;f.oP=void 0!==c.oP?c.oP:b();F.z5j=f.oP?2147483647:1073741823;
f.from=function(H,D,G){return d(null,H,D,G)};f.oP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.mte=function(H){h(H);return e(null,H)};f.xPg=function(H){return n(null,H)};f.isBuffer=function(H){return!(null==H||!H.yxg)};f.compare=function(H,D){if(!f.isBuffer(H)||!f.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(H===D)return 0;
for(var G=H.length,J=D.length,M=0,Q=Math.min(G,J);M<Q;++M)if(H[M]!==D[M]){G=H[M];J=D[M];break}return G<J?-1:J<G?1:0};f.Whf=function(H){switch(String(H).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(H,D){if(!L(H))throw new TypeError('"list" argument must be an Array of Buffers');if(0===H.length)return f.mte(0);var G;if(void 0===D)for(G=D=
0;G<H.length;++G)D+=H[G].length;D=f.xPg(D);var J=0;for(G=0;G<H.length;++G){var M=H[G];if(!f.isBuffer(M))throw new TypeError('"list" argument must be an Array of Buffers');M.copy(D,J);J+=M.length}return D};f.byteLength=y;f.prototype.yxg=!0;f.prototype.toString=function(){var H=this.length|0;return 0===H?"":0===arguments.length?C(this,0,H):t.apply(this,arguments)};f.prototype.equals=function(H){if(!f.isBuffer(H))throw new TypeError("Argument must be a Buffer");return this===H?!0:0===f.compare(this,
H)};f.prototype.compare=function(H,D,G,J,M){if(!f.isBuffer(H))throw new TypeError("Argument must be a Buffer");void 0===D&&(D=0);void 0===G&&(G=H?H.length:0);void 0===J&&(J=0);void 0===M&&(M=this.length);if(0>D||G>H.length||0>J||M>this.length)throw new RangeError("out of range index");if(J>=M&&D>=G)return 0;if(J>=M)return-1;if(D>=G)return 1;D>>>=0;G>>>=0;J>>>=0;M>>>=0;if(this===H)return 0;var Q=M-J,U=G-D,Z=Math.min(Q,U);J=this.slice(J,M);H=H.slice(D,G);for(D=0;D<Z;++D)if(J[D]!==H[D]){Q=J[D];U=H[D];
break}return Q<U?-1:U<Q?1:0};f.prototype.includes=function(H,D,G){return-1!==this.indexOf(H,D,G)};f.prototype.indexOf=function(H,D,G){return v(this,H,D,G,!0)};f.prototype.lastIndexOf=function(H,D,G){return v(this,H,D,G,!1)};f.prototype.write=function(H,D,G,J){if(void 0===D)J="utf8",G=this.length,D=0;else if(void 0===G&&"string"===typeof D)J=D,G=this.length,D=0;else if(isFinite(D))D|=0,isFinite(G)?(G|=0,void 0===J&&(J="utf8")):(J=G,G=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var M=this.length-D;if(void 0===G||G>M)G=M;if(0<H.length&&(0>G||0>D)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(M=!1;;)switch(J){case "hex":D=Number(D)||0;J=this.length-D;G?(G=Number(G),G>J&&(G=J)):G=J;J=H.length;if(0!==J%2)throw new TypeError("Invalid hex string");G>J/2&&(G=J/2);for(J=0;J<G;++J){M=parseInt(H.substr(2*J,2),16);if(isNaN(M))break;this[D+J]=M}return J;case "utf8":case "utf-8":return E(B(H,this.length-D),this,D,G);case "ascii":return E(z(H),
this,D,G);case "latin1":case "binary":return E(z(H),this,D,G);case "base64":return E(A(H),this,D,G);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=H;M=this.length-D;for(var Q=[],U=0;U<J.length&&!(0>(M-=2));++U){var Z=J.charCodeAt(U);H=Z>>8;Z%=256;Q.push(Z);Q.push(H)}return E(Q,this,D,G);default:if(M)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase();M=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.U4j||this,0)}};var V=4096;f.prototype.slice=
function(H,D){var G=this.length;H=~~H;D=void 0===D?G:~~D;0>H?(H+=G,0>H&&(H=0)):H>G&&(H=G);0>D?(D+=G,0>D&&(D=0)):D>G&&(D=G);D<H&&(D=H);if(f.oP)D=this.subarray(H,D),D.__proto__=f.prototype;else{G=D-H;D=new f(G,void 0);for(var J=0;J<G;++J)D[J]=this[J+H]}return D};f.prototype.uaj=function(H){if(0!==H%1||0>H)throw new RangeError("offset is not uint");if(H+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[H]<<8|this[H+1]};f.prototype.copy=function(H,D,G,J){G||(G=0);
J||0===J||(J=this.length);D>=H.length&&(D=H.length);D||(D=0);0<J&&J<G&&(J=G);if(J===G||0===H.length||0===this.length)return 0;if(0>D)throw new RangeError("targetStart out of bounds");if(0>G||G>=this.length)throw new RangeError("sourceStart out of bounds");if(0>J)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length);H.length-D<J-G&&(J=H.length-D+G);var M=J-G;if(this===H&&G<D&&D<J)for(J=M-1;0<=J;--J)H[J+D]=this[J+G];else if(1E3>M||!f.oP)for(J=0;J<M;++J)H[J+D]=this[J+G];else Uint8Array.prototype.set.call(H,
this.subarray(G,G+M),D);return M};f.prototype.fill=function(H,D,G,J){if("string"===typeof H){"string"===typeof D?(J=D,D=0,G=this.length):"string"===typeof G&&(J=G,G=this.length);if(1===H.length){var M=H.charCodeAt(0);256>M&&(H=M)}if(void 0!==J&&"string"!==typeof J)throw new TypeError("encoding must be a string");if("string"===typeof J&&!f.Whf(J))throw new TypeError("Unknown encoding: "+J);}else"number"===typeof H&&(H&=255);if(0>D||this.length<D||this.length<G)throw new RangeError("Out of range index");
if(G<=D)return this;D>>>=0;G=void 0===G?this.length:G>>>0;H||(H=0);if("number"===typeof H)for(J=D;J<G;++J)this[J]=H;else for(H=f.isBuffer(H)?H:B((new f(H,J)).toString()),M=H.length,J=0;J<G-D;++J)this[J+D]=H[J%M];return this};var T=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1311))},1311:function(u){var F=function(){return this}();try{F=F||(new Function("return this"))()}catch(a){"object"===typeof window&&(F=window)}u.exports=F},1312:function(u,F){function a(f){var d=f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");
f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}F.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};F.ZPj=function(f){var d=a(f);var h=d[0];d=d[1];var n=new e(3*(h+d)/4-d),m=0,x=0<d?h-4:h,r;for(r=0;r<x;r+=4)h=b[f.charCodeAt(r)]<<18|b[f.charCodeAt(r+1)]<<12|b[f.charCodeAt(r+2)]<<6|b[f.charCodeAt(r+3)],n[m++]=h>>16&255,n[m++]=h>>8&255,n[m++]=h&255;2===d&&(h=b[f.charCodeAt(r)]<<2|b[f.charCodeAt(r+1)]>>4,n[m++]=h&255);1===d&&(h=b[f.charCodeAt(r)]<<10|b[f.charCodeAt(r+1)]<<4|b[f.charCodeAt(r+
2)]>>2,n[m++]=h>>8&255,n[m++]=h&255);return n};F.IZe=function(f){for(var d=f.length,h=d%3,n=[],m=0,x=d-h;m<x;m+=16383){for(var r=n,y=r.push,t,v=f,w=m+16383>x?x:m+16383,C=[],B=m;B<w;B+=3)t=(v[B]<<16&16711680)+(v[B+1]<<8&65280)+(v[B+2]&255),C.push(c[t>>18&63]+c[t>>12&63]+c[t>>6&63]+c[t&63]);t=C.join("");y.call(r,t)}1===h?(f=f[d-1],n.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],n.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return n.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?
Uint8Array:Array;for(u=0;64>u;++u)c[u]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(u)]=u;b[45]=62;b[95]=63},1313:function(u,F){F.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<d)-1,n=h>>1,m=-7;f=b?f-1:0;var x=b?-1:1,r=a[c+f];f+=x;b=r&(1<<-m)-1;r>>=-m;for(m+=d;0<m;b=256*b+a[c+f],f+=x,m-=8);d=b&(1<<-m)-1;b>>=-m;for(m+=e;0<m;d=256*d+a[c+f],f+=x,m-=8);if(0===b)b=1-n;else{if(b===h)return d?NaN:Infinity*
(r?-1:1);d+=Math.pow(2,e);b-=n}return(r?-1:1)*d*Math.pow(2,b-e)};F.write=function(a,c,b,e,f,d){var h,n=8*d-f-1,m=(1<<n)-1,x=m>>1,r=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var y=e?1:-1,t=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=m):(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+x?c+r/h:c+r*Math.pow(2,1-x),2<=c*h&&(e++,h/=2),e+x>=m?(c=0,e=m):1<=e+x?(c=(c*h-1)*Math.pow(2,f),e+=x):(c=c*Math.pow(2,x-1)*Math.pow(2,f),e=0));for(;8<=
f;a[b+d]=c&255,d+=y,c/=256,f-=8);e=e<<f|c;for(n+=f;0<n;a[b+d]=e&255,d+=y,e/=256,n-=8);a[b+d-y]|=128*t}},1314:function(u){var F={}.toString;u.exports=Array.isArray||function(a){return"[object Array]"==F.call(a)}},1315:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);F=a(724);var c=a(699);class b extends F.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Pd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}
Object(u.a)(b,"DetectedHtmlTableAnnotation",F.a,[])},1316:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{static BIa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=Array(256),d=Array(256);let h,n=0,m=0;let x,r="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var y=b.charCodeAt(h%b.length);if(256<=y)return"";n=(n+f[h]+y)%256;y=f[h];f[h]=f[n];f[n]=y}for(h=0;256>h;h++)d[h]=f[256-h-1];n=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;n=(n+f[h])%256;y=f[h];f[h]=f[n];f[n]=y;y=e.charCodeAt(b);
if(256<=y)return"";x=y^f[(f[h]+f[n])%256];m=(m+d[h])%256;y=d[h];d[h]=d[m];d[m]=y;r+=String.fromCharCode(x^f[(d[h]+d[m])%256])}return r}}Object(u.a)(c,"RC4A",null,[])},1318:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.llb=e;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&d.jXh();this.yx=f;this.wCg=h}get bFb(){return this.llb}get solutionId(){return this.yx}get qUd(){return this.wCg}aLa(e){e=this.bFb+this.solutionId+e;return this.qUd?
(e in b.G0b||(b.G0b[e]="AddinControl"+b.lOg++),b.G0b[e]):e}fKe(e){if(this.qUd){const d=b.G0b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.bFb.length+this.solutionId.length)}}return e}S7e(e){e=this.bFb+this.solutionId+e;return this.qUd?(e in b.RXc||(b.RXc[e]="AddinTab"+b.wOg++),b.RXc[e]):e}}b.G0b={};b.RXc={};b.wOg=0;b.lOg=0;Object(u.a)(b,"DefaultRibbonNamingProvider",null,[765])},1365:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(83),e;(function(t){t[t.none=0]="none";t[t.testEvent=1]="testEvent";
t[t.test1Event=2]="test1Event";t[t.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";t[t.worksheetActivatedEvent=11]="worksheetActivatedEvent";t[t.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";t[t.worksheetAddedEvent=13]="worksheetAddedEvent";t[t.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";t[t.worksheetDeletedEvent=15]="worksheetDeletedEvent";t[t.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";t[t.worksheetFilteredEvent=17]="worksheetFilteredEvent";
t[t.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";t[t.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";t[t.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";t[t.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";t[t.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";t[t.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";t[t.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";t[t.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";t[t.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";t[t.worksheetMovedEvent=27]="worksheetMovedEvent";t[t.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";t[t.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";t[t.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";t[t.chartAddedEvent=50]="chartAddedEvent";t[t.chartActivatedEvent=51]="chartActivatedEvent";t[t.chartDeactivatedEvent=
52]="chartDeactivatedEvent";t[t.chartDeletedEvent=53]="chartDeletedEvent";t[t.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";t[t.tableDataChangedEvent=101]="tableDataChangedEvent";t[t.tableAddedEvent=102]="tableAddedEvent";t[t.tableDeletedEvent=103]="tableDeletedEvent";t[t.tableFilteredEvent=104]="tableFilteredEvent";t[t.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";t[t.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";t[t.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";t[t.commentAddedEvent=250]="commentAddedEvent";t[t.commentDeletedEvent=251]="commentDeletedEvent";t[t.commentChangedEvent=252]="commentChangedEvent";t[t.invocationMessage=1E3]="invocationMessage";t[t.cancellationMessage=1001]="cancellationMessage";t[t.metadataMessage=1002]="metadataMessage";t[t.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";t[t.visualChangeEvent=2001]="visualChangeEvent";t[t.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
t[t.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";t[t.shapeActivatedEvent=2101]="shapeActivatedEvent";t[t.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";t[t.shapeAddedEvent=2103]="shapeAddedEvent";t[t.shapeDeletedEvent=2104]="shapeDeletedEvent";t[t.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";t[t.wacOperationEvent=2201]="wacOperationEvent";t[t.recordingStateChangedEvent=2202]="recordingStateChangedEvent";t[t.workbookActivatedEvent=2203]="workbookActivatedEvent";
t[t.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";t[t.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";t[t.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";t[t.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";t[t.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";t[t.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
t[t.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";t[t.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";t[t.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";t[t.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";t[t.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";t[t.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";t[t.pivotTableAddedEvent=2900]=
"pivotTableAddedEvent";t[t.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";t[t.namedItemAddedEvent=3E3]="namedItemAddedEvent";t[t.namedItemDeletedEvent=3001]="namedItemDeletedEvent";t[t.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";t[t.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";t[t.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";t[t.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||
(e={}));Object(u.b)("MessageType",e);var f=a(767),d=a(249),h=a(736),n=a(58),m=a(37),x=a(153),r=a(1);a.d(F,"DdaEventDispatch",function(){return y});class y{constructor(t){this.dB=null;this.Ieg={};this.Keg={};this.Xcd={};this.nBd={};this.bld=(v,w)=>{v=this.$.Kb.Bc("Task","DdaEventDispatch.HandleServerEvent");w=w.i2f;for(let A=0;A<w.length;A++)switch(w[A].EventType){case 2:var C=w[A],B={};B.Name=C.Name;B.BindingType=C.BindingType;B.ColCount=C.ColCount;B.RowCount=C.RowCount;this.uwa(C.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,
B,null);break;case 4:this.uwa(w[A].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(C=w[A],C.InstanceId){B=Array(C.Entries.length);for(var z=0;z<C.Entries.length;z++)B[z]=y.Ddc(C.Entries[z],C.IsRemoteOverride);0<C.Entries.length&&1===C.Entries[0].Category?this.B6i(C.InstanceId,B):C.InstanceId&&this.uwa(C.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}else{this.Xcd={};this.nBd={};for(B=0;B<C.Entries.length;B++)this.KMe(C.Entries[B],C.IsRemoteOverride);
C=JSON.stringify(this.Xcd);B=JSON.stringify(this.nBd);z=JSON.stringify(this.Ieg);const E=JSON.stringify(this.Keg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${C}, Number of Not Fired event: ${B}, Total Number of Fired event: ${z}, Total Number of Not Fired event: ${E}`)}}v.stop()};this.cMb=(v,w)=>{this.uwa(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)};this.$=t;this.Dxc=this.bld}k0b(t){t&&(this.Via(),this.dB.push(t))}Tuc(t){this.dB&&(Array.remove(this.dB,t),this.dB.length||
(this.$.wantServerEvents=!1,this.$.xij(this.Dxc),this.dB=null))}B6i(t,v){const w=Object(b.a)(h.DdaFacade,d.a(this.$));m.TaskExtensions.za(w.FYh(t),C=>{if(x.b(C)){var B=C.result;C=w.yn(B);if(B)if(C.bjc)this.uwa(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v);else if(C.i7b)for(B=0;B<v.length;B++)C.i7b.push(v[B]);else C.i7b=v}else C.Pf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):C.qh&&c.ULS.sendTraceTag(537170590,
0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}X6i(t,v){const w=Object(b.a)(h.DdaFacade,d.a(this.$)),C=w.PMh(t);C?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(C,v,this.cMb):w.A$g(t,v)}KMe(t,v){let w=!1;const C=parseInt(t.Type,10);var B=t.Target;const z=Object(b.a)(h.DdaFacade,d.a(this.$));if((B=z.ij.KYh(C,B))&&0<Object.keys(B).length){w=!0;for(let E in B)if(B=E,z.ij.v1b(B)){const I=Array(1);I[0]=y.Ddc(t,
v);if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var A=I[0][3];if(void 0!==A&&null!==A&&(A=Object(b.a)(Object,n.a.ki(A)))&&void 0!==A.triggerControlId&&null!==A.triggerControlId&&void 0!==A.triggerSource&&null!==A.triggerSource){let L=!1;v?(A.triggerSource="Unknown",L=!0):z.vnh(A.triggerControlId,B)&&(A.triggerSource="ThisLocalAddin",L=!0);L&&(I[0][3]=n.a.hc(A))}}this.uwa(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,I)}}w?(this.kgc(e[C],this.Xcd),this.kgc(e[C],
this.Ieg)):(this.kgc(e[C],this.nBd),this.kgc(e[C],this.Keg))}Via(){this.dB||(this.dB=[],this.$.jse(this.Dxc),this.$.wantServerEvents=!0)}kgc(t,v){t in v||(v[t]=0);v[t]+=1}gN(t,v,w){const C={};C.Target=v;C.Category=65536;C.Type=t;C.Message=w;C.Id=-1;this.KMe(C,!1)}LGh(t,v){const w={Target:"",Category:2,Type:1E3};w.Message=v;w.Id=0;v=Array(1);v[0]=y.Ddc(w,!1);this.X6i(t,v)}Dac(t,v,w,C){const B={};B.Target=w;B.Category=65536;B.Type=v;B.Message=C;B.Id=-1;v=Array(1);v[0]=y.Ddc(B,!1);this.uwa(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,v)}KGh(t,v){this.uwa(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)}uwa(t,v,w,C){if(this.dB){var B=Object(b.a)(h.DdaFacade,d.a(this.$));if(!B||v!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&v!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||B.ij.v1b(t)){t=new f.a(v,t,w,C);for(let z=0,A=this.dB.length;z<A;z++)(v=this.dB[z])&&v(t)}}}static Ddc(t,v){const w=Array(6);w[0]=t.Category;w[1]=t.Type;w[2]=t.Target;w[3]=t.Message;w[4]=t.Id;w[5]=v;return w}}Object(u.a)(y,"DdaEventDispatch",
null,[])},1395:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);F=a(146);var c=a(87);class b extends F.a{constructor(){super(void 0,void 0,void 0,!0);this.RDa="AddinCommandsUILessDialog";this.wUc="WACDialogTitleText";this.tfa="0";this.bY=380;this.kqa=190;this.Fe=this.RDa;this.Rb=5;this.Dtg=String.format("{0}px",this.bY);this.sfa=String.format("{0}px",this.kqa);this.paf=this.Lt=!1;this.Xz()}Xz(){super.Xz();this.Vk.style.width=this.Dtg;this.Vk.style.height=this.sfa;this.Vk.style.padding=this.tfa}Pv(e){this.SI();
document.getElementById(this.li(this.wUc)).innerText=e}SI(){super.SI();this.wb.style.width=String.format("{0}px",this.bY);this.wb.style.height=String.format("{0}px",this.kqa);this.wb.removeAttribute(c.a.Ld);this.wb.removeAttribute(c.a.SP)}hide(){this.gzb()}get Hia(){return this.Vk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(u.a)(b,"AddinCommandsUILessDialog",F.a,[757])},1425:function(u,F,a){a.r(F);var c=a(513),b=a(955),e=a(1188),f=a(9),
d=a(0),h=a(222),n=a(187),m=a(587);class x{constructor(){this.Ghb=null}get iUg(){this.Ghb||(this.Ghb=new n.a,this.Ghb.add(12),this.Ghb.add(11));return this.Ghb}Wji(O){return this.iUg.contains(O.operation)}sUj(O){const Ta=[],Gb=O.payload;for(const hc of Gb.batchedOperations)Ta.push(new m.a(O.operation,hc));return Ta}}Object(d.a)(x,"MacroRecorderBatchedEventList",null,[]);var r=a(15),y=a(58),t=a(121),v=a(640);class w{equals(O,Ta){return O===Ta}getHashCode(O){return O}Rja(O){return O}}Object(d.a)(w,"UserOperationNameComparer",
null,[22,23]);class C{static I5h(){C.Oc||(C.Oc=new v.a(new w),C.Oc.add(507),C.Oc.add(10),C.Oc.add(576),C.Oc.add(563),C.Oc.add(564),C.Oc.add(565),C.Oc.add(566),C.Oc.add(567),C.Oc.add(568),C.Oc.add(569),C.Oc.add(570),C.Oc.add(571),C.Oc.add(572),C.Oc.add(573),C.Oc.add(574),C.Oc.add(575),C.Oc.add(501),C.Oc.add(520),C.Oc.add(1),C.Oc.add(1002),C.Oc.add(129),C.Oc.add(198),C.Oc.add(500),C.Oc.add(519),C.Oc.add(538),C.Oc.add(1E3),C.Oc.add(1003),C.Oc.add(144),C.Oc.add(502),C.Oc.add(505),C.Oc.add(179),C.Oc.add(205),
C.Oc.add(134),C.Oc.add(230),C.Oc.add(103),C.Oc.add(110),C.Oc.add(112),C.Oc.add(113),C.Oc.add(124),C.Oc.add(133),C.Oc.add(154),C.Oc.add(162),C.Oc.add(168),C.Oc.add(172),C.Oc.add(201),C.Oc.add(222),C.Oc.add(227),C.Oc.add(513),C.Oc.add(534),C.Oc.add(539),C.Oc.add(545),C.Oc.add(600),C.Oc.add(547),C.Oc.add(555),C.Oc.add(558),C.Oc.add(562),C.Oc.add(585),C.Oc.add(1001),C.Oc.add(1005),C.Oc.add(1008),C.Oc.add(1010),C.Oc.add(1011),C.Oc.add(1012),C.Oc.add(1018),C.Oc.add(252),C.Oc.add(253),C.Oc.add(258),C.Oc.add(101),
C.Oc.add(102),C.Oc.add(108),C.Oc.add(257),C.Oc.add(119),C.Oc.add(120),C.Oc.add(123),C.Oc.add(126),C.Oc.add(127),C.Oc.add(130),C.Oc.add(140),C.Oc.add(159),C.Oc.add(160),C.Oc.add(165),C.Oc.add(166),C.Oc.add(167),C.Oc.add(169),C.Oc.add(189),C.Oc.add(223),C.Oc.add(214),C.Oc.add(228),C.Oc.add(233),C.Oc.add(247),C.Oc.add(504),C.Oc.add(511),C.Oc.add(512),C.Oc.add(525),C.Oc.add(533),C.Oc.add(537),C.Oc.add(542),C.Oc.add(544),C.Oc.add(548),C.Oc.add(550),C.Oc.add(551),C.Oc.add(552),C.Oc.add(554),C.Oc.add(577),
C.Oc.add(584),C.Oc.add(586),C.Oc.add(587),C.Oc.add(588),C.Oc.add(592),C.Oc.add(1009),C.Oc.add(1016),C.Oc.add(1017));return C.Oc}}C.Oc=null;Object(d.a)(C,"MacroRecorderUnrecognizedEventList",null,[]);class B{constructor(O,Ta,Gb){this.Bvb=null;this.nDi=(hc,wc)=>{this.v7f()&&this.Ucd(wc)};this.duf=Ta;this.cuf=Gb;this.$=O;this.$.MV&&this.$.HMg(this.nDi);O.da.Ga(297,this)}init(O){this.$.MV&&(O?this.Bvb=O:r.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Ucd(O){if(this.v7f())try{if(this.cuf.Wji(O)){var Ta=
this.cuf.sUj(O);for(const Gb of Ta)this.eYe(Gb)}else this.eYe(O)}catch(Gb){Ta=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${t.a(O.operation)}, Exception: ${Gb.stack}`;r.ULS.sendTraceTag(537155423,0,10,Ta);try{this.IGh(O)}catch(hc){}}}eYe(O){var Ta=this.duf.u4e(O,!0);Ta?(this.Bvb(Ta.eventId,y.a.hc(O.payload)),r.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ta.eventId}`)):(Ta=this.duf.u4e(O,!1))?r.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ta.eventId}, but failed to match filters`):
C.I5h().contains(O.operation)||(this.Bvb(0,y.a.hc(O.operation)),O=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${t.a(O.operation)}`,r.ULS.sendTraceTag(537155420,0,50,O))}IGh(O){this.Bvb(222,y.a.hc(O.operation))}v7f(){return this.$.Uba&&this.Bvb&&this.$.Pba?!0:!1}}Object(d.a)(B,"MacroRecorderEventHandler",null,[722]);var z=a(1);class A{constructor(){this.tKc=this.uKc=this.sQc=this.TUc=null}get operations(){this.sQc||(this.sQc=new n.a,this.Xb());return this.sQc}get REc(){this.TUc||
(this.TUc=new n.a,this.ig());return this.TUc}get KWe(){this.tKc||(this.tKc=new n.a);return this.tKc}get featureGates(){this.uKc||(this.uKc=new n.a,this.Wwa());return this.uKc}ig(){}Wwa(){}kd(O){this.REc.add(O)}Ob(O){this.operations.contains(O)||this.operations.add(O)}fob(){this.featureGates.add(661)}spe(O){this.KWe.add(O)}}Object(d.a)(A,"MacroRecorderEventBase",null,[]);class E extends A{constructor(){super()}get eventId(){return 130}Xb(){this.Ob(100)}}Object(d.a)(E,"AccessibilityCheckRunEvent",A,
[]);class I extends A{constructor(){super()}get eventId(){return 160}Xb(){this.Ob(241)}ig(){this.kd(O=>O.addToPrintArea)}}Object(d.a)(I,"AddedToPrintAreaEvent",A,[]);class L extends A{constructor(){super()}get eventId(){return 65}Xb(){this.Ob(516)}}Object(d.a)(L,"AutoFilterToggledEvent",A,[]);class V extends A{constructor(){super()}get eventId(){return 118}Xb(){this.Ob(502)}ig(){this.kd(O=>!(O.s5a().FirstColumn===O.s5a().LastColumn&&O.s5a().FirstRow===O.s5a().LastRow))}}Object(d.a)(V,"AutoSumEvent",
A,[]);class T extends A{constructor(O,Ta){super();this.Ifa=O;this.V0j=Ta}get eventId(){return this.Ifa}Xb(){this.Ob(529);this.Ob(594)}ig(){this.kd(O=>this.V0j.includes(O.Uhd()))}}Object(d.a)(T,"ChartPropertyAppliedEventBase",A,[]);class H extends T{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(H,"ChartAxisChangedEvent",T,[]);class D extends T{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(D,"ChartAxisTitleChangedEvent",
T,[]);class G extends T{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(G,"ChartDataLabelsChangedEvent",T,[]);class J extends T{constructor(){super(76,[-100])}}Object(d.a)(J,"ChartDataSelectedEvent",T,[]);class M extends T{constructor(){super(83,[500,501,502])}}Object(d.a)(M,"ChartDataTableChangedEvent",T,[]);var Q=a(554),U=a(419),Z=a(83);class P extends A{constructor(){super()}}Object(d.a)(P,"RichApiRequestExecutedEventBase",A,[]);class S{constructor(O,Ta,Gb){this.response=
this.request=this.eventId=this.source=null;O&&(this.source=O.source,this.eventId=O.eventId,this.request=Ta,this.response=Gb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(S,"MacroRecorderRichApiRequestExecutedPayload",null,[108]);class ja extends P{constructor(){super()}get eventId(){return 117}sy(O){ja.r7||(ja.r7=new v.a(Q.a.ak()),ja.r7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ja.r7.add("fa000000014"));return!!O&&
ja.r7.contains(O.toLowerCase())}Xb(){this.Ob(507);this.Ob(10);this.Ob(576)}ig(){this.kd(O=>Object(U.a)(S,O)&&(O=Object(Z.a)(S,O),O.isValid&&this.sy(O.source))?(r.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${O.eventId}`),!0):!1)}}ja.r7=null;Object(d.a)(ja,"ChartFormatRichApiRequestExecutedEvent",P,[]);class X extends T{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(d.a)(X,"ChartGridlinesChangedEvent",T,[]);class Y extends A{constructor(){super()}get eventId(){return 66}Xb(){this.Ob(528)}}
Object(d.a)(Y,"ChartInsertedEvent",A,[]);class va extends T{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(va,"ChartLegendChangedEvent",T,[]);class N extends T{constructor(){super(75,[-101])}}Object(d.a)(N,"ChartRowColumnSwitchedEvent",T,[]);class ea extends T{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(ea,"ChartTitleChangedEvent",T,[]);class Ca extends T{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,
-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(Ca,"ChartTypeChangedEvent",T,[]);class la extends A{constructor(){super()}get eventId(){return 131}Xb(){this.Ob(521)}}Object(d.a)(la,"ConnectorFloatingObjectResizedEvent",A,[]);class Ra extends A{constructor(){super()}get eventId(){return 129}Xb(){this.Ob(109)}}Object(d.a)(Ra,"EntitySelectedEvent",A,[]);class lb extends A{constructor(){super()}get eventId(){return 49}Xb(){this.Ob(149);this.Ob(147)}}Object(d.a)(lb,"FindCellEvent",
A,[]);class Aa extends A{constructor(){super()}get eventId(){return 96}Xb(){this.Ob(122)}}Object(d.a)(Aa,"FloatingObjectAltTextAppliedEvent",A,[]);class da extends A{constructor(){super()}get eventId(){return 93}Xb(){this.Ob(522)}}Object(d.a)(da,"FloatingObjectDeletedEvent",A,[]);class aa extends A{constructor(){super()}get eventId(){return 94}Xb(){this.Ob(524)}}Object(d.a)(aa,"FloatingObjectMovedAndResizedEvent",A,[]);class fa extends A{constructor(){super()}get eventId(){return 95}Xb(){this.Ob(523)}}
Object(d.a)(fa,"FloatingObjectRotatedEvent",A,[]);class Oa extends A{constructor(){super()}get eventId(){return 100}Xb(){this.Ob(543)}}Object(d.a)(Oa,"GroupDetailsShownOrHiddenEvent",A,[]);class ba extends A{constructor(){super()}get eventId(){return 154}Xb(){this.Ob(125)}}Object(d.a)(ba,"HyperlinksRemovedFromRangeEvent",A,[]);class ka extends P{constructor(){super()}get eventId(){return 125}sy(O){ka.r7||(ka.r7=new v.a(Q.a.ak()),ka.r7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ka.r7.add("fa000000005"));
return!!O&&ka.r7.contains(O.toLowerCase())}Xb(){this.Ob(507);this.Ob(10);this.Ob(576)}ig(){this.kd(O=>Object(U.a)(S,O)?(O=Object(Z.a)(S,O),O.isValid&&this.sy(O.source)):!1)}}ka.r7=null;Object(d.a)(ka,"IdeasRichApiRequestExecutedEvent",P,[]);class Pa extends A{constructor(){super()}get eventId(){return 136}Xb(){this.Ob(115)}}Object(d.a)(Pa,"LinkedEntityConvertedEvent",A,[]);class Fa extends A{constructor(){super()}get eventId(){return 148}Xb(){this.Ob(114)}}Object(d.a)(Fa,"LinkedEntityDisambiguationPaneToggledEvent",
A,[]);class oa extends A{constructor(){super()}get eventId(){return 127}Xb(){this.Ob(119)}}Object(d.a)(oa,"MovedToEdgeEvent",A,[]);class La extends A{constructor(){super()}get eventId(){return 135}Xb(){this.Ob(191)}Wwa(){this.fob()}}Object(d.a)(La,"NamedSheetViewCreatedEvent",A,[]);class Ea extends A{constructor(){super()}get eventId(){return 166}Xb(){this.Ob(200)}Wwa(){this.fob()}}Object(d.a)(Ea,"NamedSheetViewDeletedEvent",A,[]);class ca extends A{constructor(){super()}get eventId(){return 133}Xb(){this.Ob(192)}Wwa(){this.fob()}}
Object(d.a)(ca,"NamedSheetViewExitedEvent",A,[]);class $a extends A{constructor(){super()}get eventId(){return 162}Xb(){this.Ob(199)}Wwa(){this.fob()}}Object(d.a)($a,"NamedSheetViewRenamedEvent",A,[]);class Qa extends A{constructor(){super()}get eventId(){return 167}Xb(){this.Ob(195)}Wwa(){this.fob()}}Object(d.a)(Qa,"NamedSheetViewSwitchedEvent",A,[]);class Va extends A{constructor(){super()}get eventId(){return 99}Xb(){this.Ob(174)}}Object(d.a)(Va,"OutlineLevelSetEvent",A,[]);class fb extends A{constructor(){super()}get eventId(){return 156}Xb(){this.Ob(244)}}
Object(d.a)(fb,"PageBreakInsertedEvent",A,[]);class Ka extends A{constructor(){super()}get eventId(){return 157}Xb(){this.Ob(245)}}Object(d.a)(Ka,"PageBreakRemovedEvent",A,[]);class hb extends A{constructor(){super()}get eventId(){return 158}Xb(){this.Ob(246)}}Object(d.a)(hb,"PageBreaksAllResetEvent",A,[]);class fc extends A{constructor(){super()}get eventId(){return 112}Xb(){this.Ob(503)}ig(){this.kd(O=>!!O.pasteParameters.ClientEstimationFloatingObjectId&&2===O.pasteParameters.CopyPasteTargetType&&
!O.isFromCurrentSession)}}Object(d.a)(fc,"PasteArtOtherWorkbookEvent",A,[]);class dc extends A{constructor(){super()}get eventId(){return 52}Xb(){this.Ob(503)}ig(){this.kd(O=>!!O.pasteParameters.ClientEstimationFloatingObjectId&&2===O.pasteParameters.CopyPasteTargetType&&O.isFromCurrentSession)}}Object(d.a)(dc,"PasteArtSameWorkbookEvent",A,[]);class wb extends A{constructor(){super()}get eventId(){return 110}Xb(){this.Ob(204)}}Object(d.a)(wb,"PasteHtmlEvent",A,[]);class Tb extends A{constructor(){super()}get eventId(){return 35}Xb(){this.Ob(506)}}
Object(d.a)(Tb,"PasteRangeEvent",A,[]);class xb extends A{constructor(){super()}get eventId(){return 111}Xb(){this.Ob(503)}ig(){this.kd(O=>1===O.pasteParameters.CopyPasteTargetType)}}Object(d.a)(xb,"PasteShadowWorkbookRangeEvent",A,[]);class cb extends A{constructor(){super()}get eventId(){return 42}Xb(){this.Ob(180)}}Object(d.a)(cb,"PasteStringEvent",A,[]);class jb extends A{constructor(){super()}get eventId(){return 134}Xb(){this.Ob(220)}}Object(d.a)(jb,"PendingMergeEvent",A,[]);class qa extends A{constructor(){super()}get eventId(){return 122}Xb(){this.Ob(510)}}
Object(d.a)(qa,"PictureInsertedEvent",A,[]);class za extends A{constructor(){super()}get eventId(){return 153}Xb(){this.Ob(161)}}Object(d.a)(za,"PivotDrillToggledEvent",A,[]);class Na extends A{constructor(O,Ta){super();this.Ifa=O;this.opType=Ta}get eventId(){return this.Ifa}Xb(){this.Ob(225)}ig(){this.kd(O=>O.opType===this.opType)}}Object(d.a)(Na,"PivotTableSettingsChangedEventBase",A,[]);class ua extends Na{constructor(){super(171,4)}}Object(d.a)(ua,"PivotTableAllItemLabelsRepeatedEvent",Na,[]);
class Xa extends Na{constructor(){super(184,17)}}Object(d.a)(Xa,"PivotTableAltTextDescriptionChangedEvent",Na,[]);class ha extends Na{constructor(){super(183,16)}}Object(d.a)(ha,"PivotTableAltTextTitleChangedEvent",Na,[]);class ta extends Na{constructor(){super(173,6)}}Object(d.a)(ta,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Na,[]);class wa extends Na{constructor(){super(172,5)}}Object(d.a)(wa,"PivotTableBlankLineAfterEachItemToggledEvent",Na,[]);class db extends Na{constructor(){super(170,
3)}}Object(d.a)(db,"PivotTableColumnGrandTotalShownEvent",Na,[]);class Jb extends A{constructor(){super()}get eventId(){return 98}Xb(){this.Ob(132)}}Object(d.a)(Jb,"PivotTableCreatedEvent",A,[]);class Pb extends Na{constructor(){super(177,10)}}Object(d.a)(Pb,"PivotTableDisplayErrorStringToggledEvent",Na,[]);class eb extends Na{constructor(){super(178,11)}}Object(d.a)(eb,"PivotTableDisplayNullStringToggledEvent",Na,[]);class Ma extends Na{constructor(){super(179,12)}}Object(d.a)(Ma,"PivotTableErrorStringChangedEvent",
Na,[]);class ob extends Na{constructor(){super(174,7)}}Object(d.a)(ob,"PivotTableExpandCollapseButtonsShownEvent",Na,[]);class Ia extends Na{constructor(){super(187,20)}}Object(d.a)(Ia,"PivotTableIndentChangedEvent",Na,[]);class Da extends Na{constructor(){super(176,9)}}Object(d.a)(Da,"PivotTableItemsWithNoDataOnColumnsShownEvent",Na,[]);class nb extends Na{constructor(){super(175,8)}}Object(d.a)(nb,"PivotTableItemsWithNoDataOnRowsShownEvent",Na,[]);class Ua extends Na{constructor(){super(186,19)}}
Object(d.a)(Ua,"PivotTableLayoutTypeSetEvent",Na,[]);class W extends Na{constructor(){super(180,13)}}Object(d.a)(W,"PivotTableNullStringChangedEvent",Na,[]);class sa extends A{constructor(){super()}get eventId(){return 149}Xb(){this.Ob(219)}}Object(d.a)(sa,"PivotTablePivotLocationChangedEvent",A,[]);class vb extends A{constructor(){super()}get eventId(){return 102}Xb(){this.Ob(145)}}Object(d.a)(vb,"PivotTablePivotedEvent",A,[]);class gc extends Na{constructor(){super(182,15)}}Object(d.a)(gc,"PivotTableRefreshDataOnLoadToggledEvent",
Na,[]);class Bc extends A{constructor(){super()}get eventId(){return 104}Xb(){this.Ob(50)}ig(){this.kd(O=>!!O.pivotTableId&&!!O.pivotTableName)}}Object(d.a)(Bc,"PivotTableRefreshedEvent",A,[]);class Sa extends Na{constructor(){super(168,1)}}Object(d.a)(Sa,"PivotTableRenamedEvent",Na,[]);class na extends Na{constructor(){super(169,2)}}Object(d.a)(na,"PivotTableRowGrandTotalShownEvent",Na,[]);class ib extends Na{constructor(){super(181,14)}}Object(d.a)(ib,"PivotTableSaveSourceDataWithFileToggledEvent",
Na,[]);var Ib=a(607);class ec extends A{constructor(){super()}get eventId(){return 155}Xb(){this.Ob(131)}ig(){this.kd(O=>{O=Object(Z.a)(Ib.a,O);return!!O&&!!O.eLa()&&!!O.hierarchyName})}}Object(d.a)(ec,"PivotTableSortedEvent",A,[]);class qb extends Na{constructor(){super(185,18)}}Object(d.a)(qb,"PivotTableSubTotalsVisibilitySettingSetEvent",Na,[]);class Ha extends A{constructor(){super()}get eventId(){return 206}Xb(){this.Ob(560)}}Object(d.a)(Ha,"PivotValueFieldSettingAppliedEvent",A,[]);class Ab extends A{constructor(){super()}get eventId(){return 161}Xb(){this.Ob(243)}}
Object(d.a)(Ab,"PrintAreaClearedEvent",A,[]);class Yb extends A{constructor(){super()}get eventId(){return 159}Xb(){this.Ob(241)}ig(){this.kd(O=>!O.addToPrintArea)}}Object(d.a)(Yb,"PrintAreaSetEvent",A,[]);class Bb extends A{constructor(){super()}get eventId(){return 57}Xb(){this.Ob(517)}}Object(d.a)(Bb,"RangeAutoFilterClearedEvent",A,[]);class Qb extends A{constructor(O,Ta){super();this.Ifa=O;this.g2d=Ta}get eventId(){return this.Ifa}Xb(){this.Ob(11)}ig(){this.kd(O=>16===O.RZ().ValidMembers);this.kd(O=>
O.RZ().Font.ValidMembers===this.g2d)}}Object(d.a)(Qb,"RangeFontFormattedEventBase",A,[]);class sc extends Qb{constructor(){super(3,4)}}Object(d.a)(sc,"RangeBoldedEvent",Qb,[]);class kb extends A{constructor(){super()}get eventId(){return 2}Xb(){this.Ob(11)}ig(){this.kd(O=>128===O.RZ().ValidMembers)}}Object(d.a)(kb,"RangeBorderedEvent",A,[]);class Eb{}Eb.Dab="Table";Eb.Xqc="Sheet";Object(d.a)(Eb,"MacroRecorderEventConstants",null,[]);class Gc extends A{constructor(){super()}get eventId(){return 113}Xb(){this.Ob(208)}ig(){this.kd(O=>
O.getParameters().FilterType===Eb.Xqc)}}Object(d.a)(Gc,"RangeCheckedItemsFilteredEvent",A,[]);class zc extends A{constructor(){super()}get eventId(){return 109}Xb(){this.Ob(105)}}Object(d.a)(zc,"RangeConditionalFormattingCreatedEvent",A,[]);class yb extends A{constructor(){super()}get eventId(){return 124}Xb(){this.Ob(221)}}Object(d.a)(yb,"RangeConditionalFormattingRuleDeletedEvent",A,[]);class gb extends A{constructor(){super()}get eventId(){return 29}Xb(){this.Ob(508)}ig(){this.kd(O=>3===O.vs()||
1===O.vs()||4===O.vs())}}Object(d.a)(gb,"RangeContentClearedEvent",A,[]);class Kb extends A{constructor(){super()}get eventId(){return 40}Xb(){this.Ob(104)}}Object(d.a)(Kb,"RangeCopiedCutCellsInsertedEvent",A,[]);class sd extends A{constructor(){super()}get eventId(){return 114}Xb(){this.Ob(209)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Xqc)}}Object(d.a)(sd,"RangeCustomFilteredEvent",A,[]);class Sb extends A{constructor(){super()}get eventId(){return 106}Xb(){this.Ob(121)}}Object(d.a)(Sb,
"RangeDataValidationChangedEvent",A,[]);class yc extends Qb{constructor(){super(4,64)}}Object(d.a)(yc,"RangeDoubleUnderlinedEvent",Qb,[]);class Fc extends A{constructor(){super()}get eventId(){return 69}Xb(){this.Ob(190)}}Object(d.a)(Fc,"RangeDuplicatesRemovedEvent",A,[]);class Zc extends A{constructor(){super()}get eventId(){return 1}Xb(){this.Ob(527);this.Ob(12)}}Object(d.a)(Zc,"RangeEditedEvent",A,[]);class Rd extends A{constructor(){super()}get eventId(){return 164}Xb(){this.Ob(255)}ig(){this.kd(O=>
4===O.actionType)}}Object(d.a)(Rd,"RangeExternalLinksBrokeAllLinksEvent",A,[]);class Ed extends A{constructor(){super()}get eventId(){return 119}Xb(){this.Ob(255)}ig(){this.kd(O=>3===O.actionType)}}Object(d.a)(Ed,"RangeExternalLinksBrokeLinkEvent",A,[]);class ne extends A{constructor(){super()}get eventId(){return 205}Xb(){this.Ob(256)}Wwa(){this.spe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(d.a)(ne,"RangeExternalLinksChangeSourceEvent",A,[]);class ze extends A{constructor(){super()}get eventId(){return 163}Xb(){this.Ob(553)}ig(){this.kd(O=>
1===O.actionType)}}Object(d.a)(ze,"RangeExternalLinksRefreshedAllEvent",A,[]);class Be extends A{constructor(){super()}get eventId(){return 77}Xb(){this.Ob(553)}ig(){this.kd(O=>0===O.actionType)}}Object(d.a)(Be,"RangeExternalLinksRefreshedEvent",A,[]);class td extends A{constructor(){super()}get eventId(){return 165}Xb(){this.Ob(224)}}Object(d.a)(td,"RangeExternalLinksSetAutoRefreshEvent",A,[]);class Se extends A{constructor(){super()}get eventId(){return 5}Xb(){this.Ob(11)}ig(){this.kd(O=>64===O.RZ().ValidMembers)}}
Object(d.a)(Se,"RangeFillColoredEvent",A,[]);class $b extends A{constructor(){super()}get eventId(){return 59}Xb(){this.Ob(155)}}Object(d.a)($b,"RangeFilledEvent",A,[]);class Xc extends A{constructor(){super()}get eventId(){return 115}Xb(){this.Ob(176)}ig(){this.kd(O=>O.iV().AutoFilterType===Eb.Xqc&&!!O.iV().CriteriaType)}}Object(d.a)(Xc,"RangeFilterAppliedEvent",A,[]);class ed extends A{constructor(){super()}get eventId(){return 58}Xb(){this.Ob(176)}ig(){this.kd(O=>O.iV().AutoFilterType===Eb.Xqc&&
!O.iV().CriteriaType)}}Object(d.a)(ed,"RangeFilterClearedEvent",A,[]);class Rc extends A{constructor(){super()}get eventId(){return 41}Xb(){this.Ob(518)}}Object(d.a)(Rc,"RangeFilterReappliedEvent",A,[]);class Fd extends A{constructor(){super()}get eventId(){return 86}Xb(){this.Ob(150)}}Object(d.a)(Fd,"RangeFlashFilledEvent",A,[]);class Nd extends Qb{constructor(){super(6,32)}}Object(d.a)(Nd,"RangeFontColoredEvent",Qb,[]);class zd extends Qb{constructor(){super(7,8)}}Object(d.a)(zd,"RangeFontItalicizedEvent",
Qb,[]);class Sd extends Qb{constructor(){super(8,1)}}Object(d.a)(Sd,"RangeFontNamedEvent",Qb,[]);class se extends Qb{constructor(){super(9,2)}}Object(d.a)(se,"RangeFontSizedEvent",Qb,[]);class He extends A{constructor(){super()}get eventId(){return 74}Xb(){this.Ob(215)}}Object(d.a)(He,"RangeFormattedAsTableEvent",A,[]);class Gd extends A{constructor(){super()}get eventId(){return 97}Xb(){this.Ob(188)}}Object(d.a)(Gd,"RangeGroupedOrUngroupedEvent",A,[]);class fe extends A{constructor(){super()}get eventId(){return 60}Xb(){this.Ob(11)}ig(){this.kd(O=>
2===O.RZ().ValidMembers)}}Object(d.a)(fe,"RangeHorizontallyAlignedEvent",A,[]);class $d extends A{constructor(){super()}get eventId(){return 43}Xb(){this.Ob(526)}}Object(d.a)($d,"RangeHyperlinkAppliedEvent",A,[]);class qe extends A{constructor(){super()}get eventId(){return 63}Xb(){this.Ob(11)}ig(){this.kd(O=>256===O.RZ().ValidMembers)}}Object(d.a)(qe,"RangeIndentChangedEvent",A,[]);class pe extends A{constructor(){super()}get eventId(){return 53}Xb(){this.Ob(156)}ig(){this.kd(O=>2===O.vs()||5===
O.vs()||6===O.vs()||7===O.vs())}}Object(d.a)(pe,"RangeMergedEvent",A,[]);class Ne extends A{constructor(){super()}get eventId(){return 107}Xb(){this.Ob(216)}}Object(d.a)(Ne,"RangeNamedCellStyleAppliedEvent",A,[]);class Le extends A{constructor(){super()}get eventId(){return 12}Xb(){this.Ob(11)}ig(){this.kd(O=>32===O.RZ().ValidMembers)}}Object(d.a)(Le,"RangeNumberFormattedEvent",A,[]);var gf=a(957);class Ye extends A{constructor(){super()}get eventId(){return 108}Xb(){this.Ob(141)}ig(){this.kd(O=>
Object(U.a)(gf.a,O))}}Object(d.a)(Ye,"RangeSortedEvent",A,[]);class $e extends Qb{constructor(){super(10,128)}}Object(d.a)($e,"RangeStrikedThroughEvent",Qb,[]);class Ya extends Qb{constructor(){super(11,16)}}Object(d.a)(Ya,"RangeUnderlinedEvent",Qb,[]);class ra extends A{constructor(){super()}get eventId(){return 61}Xb(){this.Ob(11)}ig(){this.kd(O=>1===O.RZ().ValidMembers)}}Object(d.a)(ra,"RangeVerticallyAlignedEvent",A,[]);class ya extends A{constructor(){super()}get eventId(){return 62}Xb(){this.Ob(11)}ig(){this.kd(O=>
8===O.RZ().ValidMembers)}}Object(d.a)(ya,"RangeWrapTextToggledEvent",A,[]);class mb extends A{constructor(){super()}get eventId(){return 103}Xb(){this.Ob(51)}}Object(d.a)(mb,"RefreshedAllEvent",A,[]);class Hb extends A{constructor(){super()}get eventId(){return 47}Xb(){this.Ob(148)}}Object(d.a)(Hb,"ReplaceAllEvent",A,[]);class Zb extends A{constructor(){super()}get eventId(){return 91}Xb(){this.Ob(532)}ig(){this.kd(O=>95!==O.getShapeType()&&96!==O.getShapeType()&&97!==O.getShapeType()&&98!==O.getShapeType()&&
100!==O.getShapeType()&&102!==O.getShapeType()&&103!==O.getShapeType())}}Object(d.a)(Zb,"ShapeInsertedEvent",A,[]);class mc extends A{constructor(){super()}get eventId(){return 92}Xb(){this.Ob(531)}}Object(d.a)(mc,"ShapeStyleSetEvent",A,[]);var Pc=a(817);class fd extends A{constructor(O,Ta){super();this.Ifa=O;this.g2d=Ta}get eventId(){return this.Ifa}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(U.a)(Pc.a,O)&&4===O.getShapeTextFormat().ValidMembers);this.kd(O=>Object(U.a)(Pc.a,O)&&O.getShapeTextFormat().Font.ValidMembers===
this.g2d)}}Object(d.a)(fd,"ShapeTextFontFormattedEventBase",A,[]);class id extends fd{constructor(){super(193,4)}}Object(d.a)(id,"ShapeTextBoldedEvent",fd,[]);var Dd=a(959);class Zd extends A{constructor(){super()}get eventId(){return 191}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(U.a)(Dd.a,O))}}Object(d.a)(Zd,"ShapeTextChangedEvent",A,[]);class bc extends fd{constructor(){super(196,32)}}Object(d.a)(bc,"ShapeTextFontColorChangedEvent",fd,[]);class Qc extends fd{constructor(){super(197,1)}}Object(d.a)(Qc,
"ShapeTextFontNameChangedEvent",fd,[]);class pd extends fd{constructor(){super(198,2)}}Object(d.a)(pd,"ShapeTextFontSizeChangedEvent",fd,[]);class ce extends A{constructor(){super()}get eventId(){return 199}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(U.a)(Pc.a,O)&&2===O.getShapeTextFormat().ValidMembers)}}Object(d.a)(ce,"ShapeTextHorizontallyAlignedEvent",A,[]);class ke extends fd{constructor(){super(194,8)}}Object(d.a)(ke,"ShapeTextItalicizedEvent",fd,[]);class Oe extends fd{constructor(){super(195,
16)}}Object(d.a)(Oe,"ShapeTextUnderlinedEvent",fd,[]);class Fe extends A{constructor(){super()}get eventId(){return 200}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(U.a)(Pc.a,O)&&1===O.getShapeTextFormat().ValidMembers)}}Object(d.a)(Fe,"ShapeTextVerticallyAlignedEvent",A,[]);class Xe extends A{constructor(){super()}get eventId(){return 13}Xb(){this.Ob(138)}}Object(d.a)(Xe,"SheetAddedEvent",A,[]);var pf=a(8);class Ae extends A{constructor(){super()}get eventId(){return 142}Xb(){this.Ob(237)}ig(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>{O=O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>O.DeltaColumn&&!O.DeltaRow&&(!!O.InsertDeleteRange.FirstRow||O.InsertDeleteRange.LastRow!==pf.a.Mz)||!O.DeltaColumn&&0>O.DeltaRow&&(!!O.InsertDeleteRange.FirstColumn||O.InsertDeleteRange.LastColumn!==pf.a.Pw)})}}Object(d.a)(Ae,"SheetCellsDeletedEvent",A,[]);class Ie extends A{constructor(){super()}get eventId(){return 143}Xb(){this.Ob(237)}ig(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>{O=O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<O.DeltaColumn&&!O.DeltaRow&&(!!O.InsertDeleteRange.FirstRow||O.InsertDeleteRange.LastRow!==pf.a.Mz)||!O.DeltaColumn&&0<O.DeltaRow&&(!!O.InsertDeleteRange.FirstColumn||O.InsertDeleteRange.LastColumn!==pf.a.Pw)})}}Object(d.a)(Ie,"SheetCellsInsertedEvent",A,[]);class Hf extends A{constructor(){super()}get eventId(){return 139}Xb(){this.Ob(237)}ig(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===pf.a.Mz)}}Object(d.a)(Hf,"SheetColumnDeletedEvent",
A,[]);class xe extends A{constructor(){super()}get eventId(){return 138}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
pf.a.Mz)}}Object(d.a)(xe,"SheetColumnInsertedEvent",A,[]);class Ze extends A{constructor(){super()}get eventId(){return 14}Xb(){this.Ob(137)}}Object(d.a)(Ze,"SheetDeletedEvent",A,[]);class nf extends A{constructor(){super()}get eventId(){return 137}Xb(){this.Ob(185)}}Object(d.a)(nf,"SheetDirectionChangedEvent",A,[]);class hf extends A{constructor(){super()}get eventId(){return 54}Xb(){this.Ob(139)}}Object(d.a)(hf,"SheetDuplicatedEvent",A,[]);class bb extends A{constructor(){super()}get eventId(){return 15}Xb(){this.Ob(207)}}
Object(d.a)(bb,"SheetNameEditedEvent",A,[]);class Lb extends A{constructor(){super()}get eventId(){return 90}Xb(){this.Ob(151)}}Object(d.a)(Lb,"SheetPaneFrozenEvent",A,[]);class nc extends A{constructor(){super()}get eventId(){return 120}Xb(){this.Ob(226)}}Object(d.a)(nc,"SheetPrintSettingsSavedEvent",A,[]);var Lc=a(857);class od extends A{constructor(){super()}get eventId(){return 215}Xb(){this.Ob(507)}Wwa(){this.spe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}ig(){this.kd(O=>Object.getType(O)===
Lc.a)}}Object(d.a)(od,"SheetProtectionPausedResumedEvent",A,[]);class wd extends A{constructor(){super()}get eventId(){return 64}Xb(){this.Ob(557)}}Object(d.a)(wd,"SheetReorderedEvent",A,[]);class Pd extends A{constructor(){super()}get eventId(){return 141}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===pf.a.Pw)}}Object(d.a)(Pd,"SheetRowDeletedEvent",A,[]);class je extends A{constructor(){super()}get eventId(){return 140}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===pf.a.Pw)}}Object(d.a)(je,"SheetRowInsertedEvent",A,[]);class be extends A{constructor(){super()}get eventId(){return 39}Xb(){this.Ob(135)}}Object(d.a)(be,"SheetRowsColumnsAutoFitEvent",A,[]);class Qe extends A{constructor(){super()}get eventId(){return 36}Xb(){this.Ob(136)}}
Object(d.a)(Qe,"SheetRowsColumnsResizedEvent",A,[]);class jc extends A{constructor(){super()}get eventId(){return 68}Xb(){this.Ob(183)}}Object(d.a)(jc,"SheetShowGridlinesToggledEvent",A,[]);class Tc extends A{constructor(){super()}get eventId(){return 67}Xb(){this.Ob(184)}}Object(d.a)(Tc,"SheetShowHeadingsToggledEvent",A,[]);class ub extends A{constructor(){super()}get eventId(){return 89}Xb(){this.Ob(213)}}Object(d.a)(ub,"SheetSpellCheckedEvent",A,[]);class Vb extends A{constructor(){super()}get eventId(){return 70}Xb(){this.Ob(515)}}
Object(d.a)(Vb,"SheetTabColoredEvent",A,[]);class tc extends A{constructor(){super()}get eventId(){return 71}Xb(){this.Ob(157)}}Object(d.a)(tc,"SheetVisibilityChangedEvent",A,[]);class Sc extends A{constructor(){super()}get eventId(){return 126}Xb(){this.Ob(239)}}Object(d.a)(Sc,"SheetsVisibilityChangedEvent",A,[]);class jd extends A{constructor(){super()}get eventId(){return 188}Xb(){this.Ob(203)}}Object(d.a)(jd,"SlicerInsertedEvent",A,[]);class pb extends A{constructor(){super()}get eventId(){return 189}Xb(){this.Ob(173)}ig(){this.kd(O=>
!O.clearFilter)}}Object(d.a)(pb,"SlicerSelectionAppliedEvent",A,[]);class Rb extends A{constructor(){super()}get eventId(){return 190}Xb(){this.Ob(173)}ig(){this.kd(O=>O.clearFilter)}}Object(d.a)(Rb,"SlicerSelectionClearedEvent",A,[]);class oc extends A{constructor(){super()}get eventId(){return 27}Xb(){this.Ob(208)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Dab)}}Object(d.a)(oc,"TableCheckedItemsFilteredEvent",A,[]);class Jc extends A{constructor(){super()}get eventId(){return 144}Xb(){this.Ob(237)}ig(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Jc,"TableColumnDeletedEvent",A,[]);class ud extends A{constructor(){super()}get eventId(){return 145}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);
this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(ud,"TableColumnInsertedEvent",A,[]);var Fb=a(958);class pa extends A{constructor(){super()}get eventId(){return 121}Xb(){this.Ob(141)}ig(){this.kd(O=>Object(U.a)(Fb.a,O))}}Object(d.a)(pa,"TableColumnSortedEvent",A,[]);class tb extends A{constructor(){super()}get eventId(){return 105}Xb(){this.Ob(193)}}Object(d.a)(tb,
"TableConvertedToRangeEvent",A,[]);class Nb extends A{constructor(){super()}get eventId(){return 16}Xb(){this.Ob(206)}}Object(d.a)(Nb,"TableCreatedEvent",A,[]);class vc extends A{constructor(){super()}get eventId(){return 30}Xb(){this.Ob(209)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Dab)}}Object(d.a)(vc,"TableCustomFilteredEvent",A,[]);class Ic extends A{constructor(){super()}get eventId(){return 25}Xb(){this.Ob(187)}ig(){this.kd(O=>1===O.options.OperationType)}}Object(d.a)(Ic,"TableCustomSortedEvent",
A,[]);class kd extends A{constructor(){super()}get eventId(){return 28}Xb(){this.Ob(176)}ig(){this.kd(O=>O.iV().AutoFilterType===Eb.Dab);this.kd(O=>0===O.iV().CriteriaType)}}Object(d.a)(kd,"TableFilterClearedEvent",A,[]);class xd extends A{constructor(){super()}get eventId(){return 32}Xb(){this.Ob(176)}ig(){this.kd(O=>O.iV().AutoFilterType===Eb.Dab);this.kd(O=>{const Ta=new n.a;Ta.add(1);Ta.add(2);Ta.add(8);Ta.add(9);Ta.add(10);Ta.add(11);Ta.add(12);Ta.add(13);Ta.add(14);Ta.add(15);Ta.add(16);Ta.add(17);
Ta.add(18);Ta.add(19);Ta.add(20);Ta.add(21);Ta.add(22);Ta.add(23);Ta.add(24);Ta.add(25);Ta.add(26);Ta.add(27);Ta.add(28);Ta.add(29);Ta.add(30);Ta.add(31);Ta.add(32);Ta.add(33);Ta.add(34);Ta.add(35);Ta.add(36);Ta.add(37);Ta.add(38);Ta.add(39);return Ta.contains(O.iV().CriteriaType)})}}Object(d.a)(xd,"TableItemFilteredEvent",A,[]);class ae extends A{constructor(){super()}get eventId(){return 101}Xb(){this.Ob(217)}}Object(d.a)(ae,"TableRenamedEvent",A,[]);class oe extends A{constructor(){super()}get eventId(){return 73}Xb(){this.Ob(211)}}
Object(d.a)(oe,"TableResizedEvent",A,[]);class ve extends A{constructor(){super()}get eventId(){return 44}Xb(){this.Ob(514)}}Object(d.a)(ve,"TableRowColumnRearrangedEvent",A,[]);class Ge extends A{constructor(){super()}get eventId(){return 146}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(d.a)(Ge,"TableRowDeletedEvent",A,[]);class ye extends A{constructor(){super()}get eventId(){return 147}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(ye,"TableRowInsertedEvent",A,[]);class qf extends A{constructor(){super()}get eventId(){return 26}Xb(){this.Ob(177)}ig(){this.kd(O=>
O.iV().AutoFilterType===Eb.Dab)}}Object(d.a)(qf,"TableSortedEvent",A,[]);class Ja extends A{constructor(){super()}get eventId(){return 87}Xb(){this.Ob(212)}}Object(d.a)(Ja,"TableStyleAppliedEvent",A,[]);class Db extends A{constructor(){super()}get eventId(){return 88}Xb(){this.Ob(196)}}Object(d.a)(Db,"TableStyleOptionToggledEvent",A,[]);class rc extends A{constructor(){super()}get eventId(){return 31}Xb(){this.Ob(210)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Dab)}}Object(d.a)(rc,"TableTop10FilteredEvent",
A,[]);class Yc extends A{constructor(){super()}get eventId(){return 207}Xb(){this.Ob(238)}}Object(d.a)(Yc,"TextToColumnsEvent",A,[]);class qd extends A{constructor(){super()}get eventId(){return 128}Xb(){this.Ob(559)}}Object(d.a)(qd,"ValuesSortedEvent",A,[]);class Od extends A{constructor(){super()}get eventId(){return 55}Xb(){this.Ob(197)}}Object(d.a)(Od,"WorkbookCalculationModeSetEvent",A,[]);class ie extends A{constructor(){super()}get eventId(){return 34}Xb(){this.Ob(181)}ig(){this.kd(O=>!!O.parentCommentId)}}
Object(d.a)(ie,"WorkbookCommentRepliedEvent",A,[]);class le extends A{constructor(){super()}get eventId(){return 33}Xb(){this.Ob(181)}ig(){this.kd(O=>!O.parentCommentId)}}Object(d.a)(le,"WorkbookCommentedEvent",A,[]);class bf extends A{constructor(){super()}get eventId(){return 56}Xb(){this.Ob(128)}}Object(d.a)(bf,"WorkbookRecalculatedEvent",A,[]);class Ce extends A{constructor(){super()}get eventId(){return 46}Xb(){this.Ob(171)}}Object(d.a)(Ce,"WorkbookRedoEvent",A,[]);class uf extends A{constructor(){super()}get eventId(){return 45}Xb(){this.Ob(170)}}
Object(d.a)(uf,"WorkbookUndoEvent",A,[]);class rf extends A{constructor(){super()}get eventId(){return 116}Xb(){this.Ob(507);this.Ob(576);this.Ob(10)}ig(){this.kd(O=>{if(Object(U.a)(S,O)&&(O=Object(Z.a)(S,O),void 0!==O.source&&null!==O.source&&void 0!==O.eventId&&null!==O.eventId))return r.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${O.source}; eventId: ${O.eventId}.`),!0;r.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(d.a)(rf,"DefaultRichApiRequestExecutedEvent",A,[]);class De extends A{constructor(){super()}get eventId(){return 216}Xb(){this.Ob(1022)}}Object(d.a)(De,"TablelAltTextEditedEvent",A,[]);class If extends A{constructor(){super()}get eventId(){return 217}Xb(){this.Ob(263)}}Object(d.a)(If,"FloatingObjectZOrderChangedEvent",A,[]);var Tf=a(960);class kg extends A{constructor(){super()}get eventId(){return 192}Xb(){this.Ob(507)}ig(){this.kd(O=>Object(U.a)(Tf.a,O)?!0:!1)}}Object(d.a)(kg,
"VisualPropertySetEvent",A,[]);class ng extends T{constructor(){super(219,[510])}}Object(d.a)(ng,"ChartSeriesDeletedEvent",T,[]);class fg extends A{get eventId(){return 220}Xb(){this.Ob(1027)}}Object(d.a)(fg,"ChartDataChangedEvent",A,[]);class ab extends T{constructor(){super(221,[512])}}Object(d.a)(ab,"ChartSeriesDataChangedEvent",T,[]);class zb{constructor(O){this.yb=null;this.$=O}get macroRecorderEvents(){this.yb||(this.yb=new n.a,this.yb.add(new Zc),this.yb.add(new kb),this.yb.add(new sc),this.yb.add(new yc),
this.yb.add(new Se),this.yb.add(new Nd),this.yb.add(new zd),this.yb.add(new Sd),this.yb.add(new se),this.yb.add(new $e),this.yb.add(new Ya),this.yb.add(new Le),this.yb.add(new Xe),this.yb.add(new Ze),this.yb.add(new bb),this.yb.add(new Nb),this.yb.add(new Jc),this.yb.add(new ud),this.yb.add(new Ge),this.yb.add(new ye),this.yb.add(new xe),this.yb.add(new Hf),this.yb.add(new je),this.yb.add(new Pd),this.yb.add(new Ic),this.yb.add(new qf),this.yb.add(new oc),this.yb.add(new kd),this.yb.add(new gb),this.yb.add(new vc),
this.yb.add(new rc),this.yb.add(new xd),this.yb.add(new le),this.yb.add(new ie),this.yb.add(new Tb),this.yb.add(new Qe),this.yb.add(new Ae),this.yb.add(new Ie),this.yb.add(new be),this.yb.add(new Kb),this.yb.add(new Rc),this.yb.add(new $d),this.yb.add(new cb),this.yb.add(new ve),this.yb.add(new Ce),this.yb.add(new uf),this.yb.add(new Hb),this.yb.add(new lb),this.yb.add(new dc),this.yb.add(new pe),this.yb.add(new hf),this.yb.add(new Od),this.yb.add(new bf),this.yb.add(new Bb),this.yb.add(new ed),this.yb.add(new $b),
this.yb.add(new fe),this.yb.add(new ra),this.yb.add(new ya),this.yb.add(new qe),this.yb.add(new wd),this.yb.add(new L),this.yb.add(new Y),this.yb.add(new Tc),this.yb.add(new jc),this.yb.add(new Fc),this.yb.add(new tc),this.yb.add(new Vb),this.yb.add(new oe),this.yb.add(new He),this.yb.add(new N),this.yb.add(new J),this.yb.add(new Be),this.yb.add(new Ca),this.yb.add(new ea),this.yb.add(new D),this.yb.add(new va),this.yb.add(new G),this.yb.add(new M),this.yb.add(new H),this.yb.add(new X),this.yb.add(new Fd),
this.yb.add(new Ja),this.yb.add(new Db),this.yb.add(new ub),this.yb.add(new Lb),this.yb.add(new Zb),this.yb.add(new mc),this.yb.add(new da),this.yb.add(new aa),this.yb.add(new fa),this.yb.add(new Aa),this.yb.add(new Gd),this.yb.add(new Jb),this.yb.add(new Va),this.yb.add(new Oa),this.yb.add(new ae),this.yb.add(new vb),this.yb.add(new mb),this.yb.add(new Bc),this.yb.add(new tb),this.yb.add(new Sb),this.yb.add(new Ne),this.yb.add(new Ye),this.yb.add(new zc),this.yb.add(new wb),this.yb.add(new xb),this.yb.add(new fc),
this.yb.add(new Gc),this.yb.add(new sd),this.yb.add(new Xc),this.yb.add(new V),this.yb.add(new qa),this.yb.add(new Ed),this.yb.add(new nc),this.yb.add(new pa),this.yb.add(new yb),this.yb.add(new Sc),this.yb.add(new oa),this.yb.add(new qd),this.yb.add(new Ra),this.yb.add(new E),this.yb.add(new la),this.yb.add(new ca),this.yb.add(new jb),this.yb.add(new La),this.yb.add(new Pa),this.yb.add(new nf),this.yb.add(new Fa),this.yb.add(new sa),this.yb.add(new za),this.yb.add(new ba),this.yb.add(new ec),this.yb.add(new fb),
this.yb.add(new Ka),this.yb.add(new hb),this.yb.add(new Yb),this.yb.add(new I),this.yb.add(new Ab),this.yb.add(new $a),this.yb.add(new ze),this.yb.add(new Rd),this.yb.add(new td),this.yb.add(new Ea),this.yb.add(new Qa),this.yb.add(new Sa),this.yb.add(new na),this.yb.add(new db),this.yb.add(new ua),this.yb.add(new wa),this.yb.add(new ta),this.yb.add(new ob),this.yb.add(new nb),this.yb.add(new Da),this.yb.add(new Pb),this.yb.add(new eb),this.yb.add(new Ma),this.yb.add(new W),this.yb.add(new ib),this.yb.add(new gc),
this.yb.add(new ha),this.yb.add(new Xa),this.yb.add(new qb),this.yb.add(new Ua),this.yb.add(new Ia),this.yb.add(new jd),this.yb.add(new pb),this.yb.add(new Rb),this.yb.add(new Zd),this.yb.add(new id),this.yb.add(new ke),this.yb.add(new Oe),this.yb.add(new bc),this.yb.add(new Qc),this.yb.add(new pd),this.yb.add(new ce),this.yb.add(new Fe),this.yb.add(new ne),this.yb.add(new Ha),this.yb.add(new Yc),this.yb.add(new od),this.yb.add(new De),this.yb.add(new If),this.yb.add(new kg),this.yb.add(new ng),this.yb.add(new ab),
this.yb.add(new fg),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Pej());return this.yb}u4e(O,Ta){let Gb=this.v4e(O,this.macroRecorderEvents,Ta);Gb||(Gb=this.v4e(O,zb.C5h(),Ta),!Gb&&this.Qjf(O,zb.WKe,Ta)&&(Gb=zb.WKe));return Gb}v4e(O,Ta,Gb){const hc=new n.a;for(let wc of Ta)this.Qjf(O,wc,Gb)&&hc.add(wc);return 1===hc.count?hc.na(0):1<hc.count?zb.aOh(hc):null}Qjf(O,Ta,Gb){const hc=zb.I_i(O,Ta);return Gb?hc&&zb.x1j(O,Ta):hc}Pej(){const O=new n.a;for(let Ta of this.yb){let Gb=
!1;for(let hc of Ta.featureGates)if(!z.EwaSettings.ma(hc)){O.add(Ta);Gb=!0;break}if(!Gb)for(let hc of Ta.KWe)if(!z.EwaSettings.getBooleanFeatureGate(hc,!1)){O.add(Ta);break}}for(let Ta of O)this.yb.remove(Ta)}static C5h(){zb.oEb||(zb.oEb=new n.a,zb.oEb.add(new ja),zb.oEb.add(new ka));return zb.oEb}static I_i(O,Ta){return Ta.operations.contains(O.operation)}static x1j(O,Ta){Ta=Ta.REc;if(!Ta.count)return!0;let Gb=!0;for(let hc of Ta)if(!hc(O.payload)){Gb=!1;break}return Gb}static aOh(O){let Ta=O.na(0);
for(let Gb of O)Gb.REc.count>Ta.REc.count&&(Ta=Gb);return Ta}}zb.oEb=null;zb.WKe=new rf;Object(d.a)(zb,"MacroRecorderEventList",null,[]);class Xb extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){this.nb(this.$.da.Aa(297)||new B(this.$,new zb(this.$),new x))}static la(O){O.da.Ga(298,new Xb(O))}}Object(d.a)(Xb,"MacroRecorderEventHandlerFactory",h.a,[]);var xc=a(1146),Uc=a(1241),dd=a(7);a(559);class Cd{constructor(){this.Hsg=new n.a}get V2b(){return this.Hsg}tYh(O){r.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",O);const Ta=new n.a;for(let Gb of this.V2b)for(let hc of Gb.FFb)hc.id===O&&Ta.add(hc);return Ta}epe(O){this.V2b.add(O)}Kej(O){for(let Ta of this.V2b)if(Ta.gte===O.gte){this.V2b.remove(Ta);break}}static Vlh(O,Ta,Gb=null){O=Cd.GQh(O);0<O.length&&(Cd.hyc(O,!1),Gb&&Gb(Ta,O))}static GQh(O){const Ta=[];if(O&&O.FFb&&0<O.FFb.count)for(let Gb of O.FFb)if(Gb.controls&&0<Gb.controls.count)for(let hc of Gb.controls)if(hc.menuItems&&0<hc.menuItems.count)for(let wc of hc.menuItems)Array.add(Ta,
wc.id);return Ta}static hyc(O,Ta){if(O.length){var Gb=[];for(const hc of O)Gb.push(appChrome.actions.updateControlEnabledDisabledState(hc,Ta));appChrome.api.dispatch(Gb)}}}Object(d.a)(Cd,"ContextMenuExtensibilityCache",null,[777,778]);var de=a(1464),Yd=a(84),vd=a(4),Re=a(865),Te=a(815);class l{yZa(O,Ta=null){if(O=Te.a.m4a(O)){appChrome.addInApi.dispatchActionsToInstallAddIn(O,Ta);for(const Gb of O.tabs)if(Gb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(O,()=>{});break}}}XLd(O){(O=
Te.a.m4a(O))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(O)}static cmh(O,Ta,Gb=null){O=l.t0h(O);0<O.length&&(l.hyc(O,!1),Gb&&Gb(Ta,O))}static t0h(O){const Ta=[];if(O&&(O=O.jW,O.mt&&0<O.mt.count))for(let Gb of O.mt)if(Gb.groups&&0<Gb.groups.length)for(const hc of Gb.groups)if(hc.controls&&0<hc.controls.length)for(const wc of hc.controls)Array.add(Ta,wc.id);return Ta}static hyc(O){if(O.length){var Ta=[];for(const Gb of O)Ta.push(appChrome.actions.updateControlEnabledDisabledState(Gb,!0));appChrome.api.dispatch(Ta)}}}
Object(d.a)(l,"OneLineRibbonExtensibilityManager",null,[821]);var Ob=a(935);class qc{constructor(){this.P5d=this.nGc=null}get AVc(){return this.nGc||(this.nGc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set AVc(O){this.nGc=O}get JTg(){return this.P5d||(this.P5d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(O,Ta){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(O,Ta)}getTaskPaneControlIdFromAssetIdRuntimeId(O,
Ta){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(O,Ta)}Akd(O,Ta,Gb,hc,wc,$c=null,hd=null){r.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",O);if((O=Ta.kja(wc.ownerAddinInfo.storeType,wc.ownerAddinInfo.solutionId))&&O.MB&&!O.MB.getIsUpgrading())if(Ta=null,0<O.MB.getNotificationParams().length&&(Ta=this.Nye(O.MB.getNotificationParams()[0]))&&2147758681===Ta.errorCode&&(O.isUpgraded=!0),2!==O.MB.getStatus()&&(1!==O.MB.getStatus()||Ta&&2147758681===Ta.errorCode))Ta&&
this.j8f(O,Ta,hd);else try{Gb.setOwnerAddinEToken(O.MB.getEToken()),wc.action(Gb,hc.bda),$c&&$c()}catch(md){r.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",vd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?md.stack:md.message)),Ob.a.RUd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}j8f(O,Ta,Gb=null){const hc=O.MB;if(1===hc.getNotificationParams().length||Ta.Ffc){const wc=
Ta.Iha,$c=Ta.Jia;Ta.Iha=()=>{hc.removeFirstNotification();if(0<hc.getNotificationParams().length){const hd=this.Nye(hc.getNotificationParams()[0]);this.j8f(O,hd)}2147758681===Ta.errorCode&&(l.cmh(O.Ro,hc,Object(Yd.a)(this,this.nef,"initUpgradeStateDetectTask")),Cd.Vlh(O.msb,hc,Object(Yd.a)(this,this.nef,"initUpgradeStateDetectTask")));wc&&wc()};Ta.Jia=()=>{$c&&$c();Gb&&Gb()};Ob.a.TUd(Ta)}}nef(O,Ta){let Gb=null;Gb=()=>{O.getIsUpgrading()?window.setTimeout(Gb,1E3):O.getUpgradingFailed()?l.hyc(Ta,!0):
vd.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Gb,1E3)}Nye(O){const Ta=new Re.a;Ta.HMa=O.infoType;Ta.id=O.id;Ta.title=O.title;Ta.description=O.description;Ta.buttonText=O.buttonTxt;Ta.Iha=O.buttonCallback;Ta.Ffc=O.highPriority;Ta.Jia=O.dismissCallback;Ta.errorCode=O.errorCode;Ta.mdf=O.iframeNotificationUrl;return Ta}}Object(d.a)(qc,"AddinCommandsActionHandler",null,[793]);var Ec=a(82),ld=a(157),yd=a(694),Jd=a(5),Ud=a(738),ee=a(695);class Je{constructor(O,Ta){this.Va=O;this.y8g=Ta}nLh(O){if(void 0!==
O&&null!==O&&O===Jd.a.dGe)O="ContextMenuCell";else return null;const Ta=this.Va.Ec();this.FKh(Ta,O);return Ta}FKh(O,Ta){Ta=this.y8g.tYh(Ta);for(let Gb of Ta){Ta=Gb.controls;for(let hc of Ta)this.sKh(O,hc)}}sKh(O,Ta){var Gb=Ta.tU[Ud.a.id];const hc=Ta.tU[Ud.a.BVa],wc=Ta.tU[Ud.a.FVa];let $c="Image16by16",hd=Ta.tU[Ud.a.CVa];ee.c(wc)&&($c="None");0<Ta.menuItems.count?(Gb=this.Va.tw(Gb,Gb,hc,798637440),Gb.FMb($c,wc,null),this.lLh(Gb.menu,Ta),O.buttons.push(Gb)):O.buttons.push(this.Va.EIa(Gb,hc,hd,wc,$c,
null,!1))}lLh(O,Ta){const Gb=this.Va.Ec();for(let hc of Ta.menuItems){Ta=hc.$la[Ud.a.id];const wc=hc.$la[Ud.a.BVa],$c=hc.$la[Ud.a.FVa];let hd="Image16by16";const md=hc.$la[Ud.a.CVa];ee.c($c)&&(hd="None");Ta=this.Va.EIa(Ta,wc,md,$c,hd,null,!1);Gb.buttons.push(Ta)}O.tc.push(Gb)}}Object(d.a)(Je,"AddInCommandsContextMenuExtensibilityHandler",null,[740]);var Ga=a(860);class Cb{constructor(){this.ti=null;this.visible=!1}}Object(d.a)(Cb,"AddinStatusCommandValues",null,[]);class cc{static O7i(O){const Ta=
new Cb;Ta.ti=O.SZa;Ta.visible=Ta.ti?!0:!1;return Ta}static Xzc(O,Ta,Gb,hc,wc){const $c=document.getElementById(Gb);$c?cc.hGj(O,Ta,$c,hc,wc):r.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Gb))}static hGj(O,Ta,Gb,hc,wc){Gb?O.SZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Ob.a.TEj(Ta,Gb,hc,wc):O.SZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Ob.a.mGj(Ta,Gb):r.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(d.a)(cc,"AddinCommandsStatusHandler",null,[]);var uc=a(38),Kc=a(226),gd=a(13);class Td extends uc.a{constructor(O,Ta){super();this.agaveCommandManager=this.statusBarManager=null;this.aDe=()=>{this.nG&&this.nG.FCe()};this.H9e=()=>{this.raiseEvent("LAC")};this.Tc=(Gb,hc)=>{!Gb.Zb&&Kc.b(hc)&&this.statusBarManager&&(this.statusBarManager.jG(this),this.statusBarManager=null)};this.nG=Ta;this.$=O;this.mLj=O.Eb+"OfficeAddinLabel-Medium14";this.$.da.$a(29,Gb=>{this.statusBarManager=Gb;Gb.HJ(this)});
this.$.ea.Wj(this.Tc);this.nG.rKg(this.H9e);this.$.da.$a(206,Gb=>{this.agaveCommandManager=Gb;Gb.SLg(this.aDe)})}Jq(O){this.addHandler("LAC",O)}dr(O){this.removeHandler("LAC",O)}ps(O,Ta){if("QueryAddinLabel"!==O)return!1;Ta[Ga.a.LabelText]!==this.nG.SZa&&(O=cc.O7i(this.nG),Ta[Ga.a.LabelText]=O.ti,Ta[Ga.a.Visible]=O.visible,window.setTimeout(()=>{this.Xzc()},0));return!0}Fn(){return!0}Xzc(){this.$&&cc.Xzc(this.nG,this.$.domElement,this.mLj,gd.a.instance.ga(333),gd.a.instance.ga(334))}dispose(){this.$.ea.tk(this.Tc);
this.nG.Ufj(this.H9e);this.agaveCommandManager&&(this.agaveCommandManager.fhj(this.aDe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.jG(this),this.statusBarManager=null);this.nG=this.$=null;super.dispose()}}Object(d.a)(Td,"AddinCommandsStatusBarManager",uc.a,[281,185]);var he=a(1317),Md=a(720),we=a(147),xa=a(120),Ba=a(571),pc=a(135);class nd{constructor(){this.RZa=null}setErrorMessageForAddin(O,Ta){this.RZa||(this.RZa={});this.RZa[O]=Ta}XSh(O){return this.RZa&&O in
this.RZa?this.RZa[O]:null}}Object(d.a)(nd,"AddinCommandsErrorManager",null,[]);var Ld=a(335),te=a(97);class af{constructor(){this.pq=this.rO=0;this.NXc=null;this.Xsc=this.BCc=0;this.Wpa=this.$Kc=this.FGc=this.q5b=this.Eja=this.e$=null}get MXc(){this.FGc||(this.FGc=new n.a);return this.FGc}get ked(){this.$Kc||(this.$Kc=new n.a);return this.$Kc}get vIa(){this.Wpa||(this.Wpa=new n.a);return this.Wpa}}Object(d.a)(af,"AddinCommandsListLoaderContext",null,[]);var Bf=a(819);class Pf{}Object(d.a)(Pf,"AppsForOfficeEntitlementQueryInfo",
null,[]);var Ef=a(41);const cg=O=>{const Ta={};Ta.solutionId=O.solutionId;Ta.version=O.version;Ta.storeType=O.storeType;Ta.storeId=O.storeId;Ta.assetId=O.assetId;Ta.assetStoreId=O.assetStoreId;Ta.targetType=O.targetType;Ta.requireConsent=O.requireConsent||!1;Ta.isAddinCommands=!0;Ta.addinCommandsActionType=0;return Ta};class Uf{constructor(O,Ta){this.entitlement=O;this.metadata=Ta}ceg(){const O=cg(this.entitlement);O.targetType=this.targetType;return O}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(d.a)(Uf,"AddinEntitlementEx",null,[]);var ag=a(256),lg=a(30);class Dg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(Dg,"AddinAbstract",null,[]);class vg extends Sys.EventArgs{constructor(){super();this.Ro=this.qk=
null}}Object(d.a)(vg,"InsertionParamEventArgs",Sys.EventArgs,[]);class dg{constructor(O,Ta,Gb,hc=null){this.lLb=vd.AFrameworkApplication.fa.Xa("RoamingServiceHandlerWebServiceBase");this.appName=O;this.Mjb=Ta;this.Ijb=Gb;this.Rlb=hc}G$b(O){this.QCh(O,Object(Yd.a)(this,this.fka,"getRequestSuccessCallback"),Object(Yd.a)(this,this.K4,"getRequestFailureCallback"))}QCh(O,Ta,Gb){const hc=new Sys.StringBuilder(this.lLb);hc.append("RoamingServiceHandler.ashx?action=");hc.append("getAddinTeachingCalloutSettings");
hc.append("&");hc.append(this.vid(O));hc.append("&");hc.append(vd.AFrameworkApplication.Hi);vd.AFrameworkApplication.zd.Pm(hc.toString(),1,null,null,!0,2,Ta,Gb,null)}y3a(O){this.VCh(O)}VCh(O){var Ta=new Sys.StringBuilder(this.lLb);Ta.append("RoamingServiceHandler.ashx?action=");Ta.append("saveAddinTeachingCalloutSettings");Ta.append("&");Ta.append(vd.AFrameworkApplication.Hi);Ta=Ta.toString();O=Ef.c(O);vd.AFrameworkApplication.zd.Pm(Ta,2,O,null,!0,4,null,Object(Yd.a)(this,this.yW,"postRequestFailureCallback"),
null)}fka(O){let Ta=!1,Gb=null;try{if(0<O.data.ve.length){const hc=Object(Z.a)(Object,Ef.a(O.data.ve)),wc=hc?hc[this.appName]:null;wc&&(Gb=Object(Z.a)(Object,Ef.a(wc.toString())))}Ta=!0}catch(hc){this.K4(null)}Ta&&this.Mjb&&this.Mjb(Gb)}K4(O){this.Ijb&&this.Ijb(O?O.data:null)}yW(O){this.Rlb&&this.Rlb(O?O.data:null)}vid(O){const Ta=new Sys.StringBuilder("requestedsettings=");for(let Gb=0;Gb<O.count;Gb++)Ta.append(O.na(Gb)),Gb<O.count-1&&Ta.append(";");return Ta.toString()}}Object(d.a)(dg,"AddinTeachingUIRoamingRequestHandler",
null,[]);class ch extends Sys.EventArgs{constructor(O){super();this.solutionId=O.solutionId;this.assetId=O.assetId;this.storeType=O.storeType;this.storeId=O.storeId;this.assetStoreId=O.assetStoreId;this.targetType=O.targetType;this.width=O.width;this.height=O.height;this.displayName=O.displayName;this.version=O.version}}Object(d.a)(ch,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Jf=a(347);class rg{constructor(O){this.UZa=this.qk=null;this.XRa=!1;this.Wpa=this.kSb=this.gna=this.Yh=
this.RX=this.DO=null;this.Ra=O}get appName(){return vd.AFrameworkApplication.fa.Xa("WebAppShortName")}get Pob(){this.RX||(this.RX=new dg(this.appName,Object(Yd.a)(this,this.fka,"getRequestSuccessCallback"),Object(Yd.a)(this,this.K4,"getRequestFailureCallback"),Object(Yd.a)(this,this.yW,"postRequestFailureCallback")));return this.RX}get rsa(){this.kSb||(this.kSb=new n.a);return this.kSb}set rsa(O){this.kSb=O}get vIa(){this.Wpa||(this.Wpa=new n.a);return this.Wpa}set vIa(O){this.Wpa=O}uWc(O,Ta){window.addEventListener?
(this.qk=O,this.UZa=Ta,window.addEventListener("LaunchAddinTaskpane",Object(Yd.a)(this,this.NDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Yd.a)(this,this.VCd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Yd.a)(this,this.KCd,"onCloseButtonClickedEventHandler"),!0),vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",
Object(Yd.a)(this,this.SFb,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}rSj(O,Ta,Gb,hc){this.Yh=O;this.rsa=Ta;this.vIa=Gb;this.gna=hc;r.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ta?Ta.count.toString():"null",Gb?Gb.count.toString():"null");0<this.rsa.count||0<this.vIa.count?(O=new n.a,O.add(this.appName),this.Pob.G$b(O)):this.gna(new n.a,
null)}NDd(){const O=new ag.ScriptSharpLegacyMap;this.UZa&&this.UZa.tabs&&!this.UZa.tabs[0].isOfficeTab&&O.ia("SDX.FeatureFlags","NonOfficeTab");this.Lla(rg.oV(this.qk),"ClickOnLaunch",O);vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Xla();this.UZa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.UZa,()=>{const Ta=new vg;Ta.qk=this.qk;this.Ra.raiseEvent(Md.a.Dvd,Ta)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}KCd(){this.Lla(rg.oV(this.qk),
"ClickOnClose");vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Xla()}VCd(){this.Lla(rg.oV(this.qk),"ClickOnDismiss");vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Xla()}SFb(O){if(O&&(O=O.detail)&&O.id&&this.Cpd(O.id)){const Ta=(O.action||"").toLowerCase();if(O.success&&"opened"===Ta)this.Lla(rg.oV(this.qk),"CampaignLaunched"),r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),
this.Xla(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Yd.a)(this,this.SFb,"onCampaignLaunchedHandler"),!0);else{let Gb;try{Gb=JSON.stringify(O),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Gb)}catch(hc){Gb="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Gb+" Error: "+(hc?hc.toString():""))}}}}Cpd(O){O=lg.a.vl(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}B7(O){if(this.appName){const Ta={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=O;Ta[this.appName]=Ef.c(Gb);this.Pob.y3a(Ta);r.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(539530528,
220,10,"Fail to save roaming service since AppName is null")}Xla(){if(!this.XRa){const O=window.g_roamingAddinList;O&&(this.B7(O),this.XRa=!0)}}fka(O){O?this.HUd(O)?(r.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.DO="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.Zrb()):(r.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.gna(this.rsa,null)):(r.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.DO=null,this.Zrb())}K4(O){r.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",O?O.httpStatus:-1);this.gna(this.rsa,null)}yW(O){r.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}Zrb(){const O=this.v8c();0===O.targetType?(O.solutionId?this.$Id(O):this.Lla(null,"NoSolutionId"),this.mjg(O),this.gna(this.rsa,null)):this.gna(this.rsa,O);r.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",O.addinId)}$Id(O){const Ta=new Pf;
Ta.callbackFunc=Gb=>{if(Gb.errorCode){if(this.Lla(O.solutionId,"FailToGetAppDetails"),vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var hc=window.g_roamingAddinList;hc&&this.B7(hc)}}else if(Gb.value)for(hc of Gb.value)if(Gb=hc[1],Gb===O.solutionId){const wc={};wc.solutionId=Gb;wc.assetId=hc[5];wc.storeType=hc[12];wc.storeId=hc[11];wc.assetStoreId=hc[6];wc.targetType=hc[3];wc.width=hc[7];wc.height=hc[8];wc.displayName=hc[0];wc.version=hc[4];
r.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",O.solutionId);hc=new ch(wc);this.Ra.raiseEvent(Md.a.YUd,hc);break}};Ta.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ta.fromInsertDialog=!1;Ta.refresh=!1;this.Yh.queryEntitlementDetails(Ta)}HUd(O){if("LastTeachingUIShowTime"in O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<vd.AFrameworkApplication.fa.mN("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
O),!1}else r.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}v8c(){let O=new Ld.a(new Dg,0),Ta=new Ld.a(new Dg,0),Gb=0,hc=0,wc=0;var $c=new n.a;for(var hd of this.rsa)$c.add(hd);for(let md of this.vIa)$c.add(md);for(let md of $c)if(!("excatalog"!==md.storeType||ee.c(md.installTimeInMS)||!md.installTimeInMS||md.installTimeInMS<=vd.AFrameworkApplication.fa.mN("DateTimeInMSForNewAddin",16409952E5))){$c=rg.vwb(md);if(this.DO&&(hd=this.DO.split(","),0<hd.length&&Array.contains(hd,
$c))){wc++;r.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}$c.startsWith("private_")?(O=rg.f4e(md,O),hc++):(Ta=rg.f4e(md,Ta),Gb++)}r.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",hc,Gb,wc);return 0<Ta.value?Ta.key:0<O.value?O.key:Object.assign(new Dg,{addinId:null,targetType:-1,solutionId:null})}Lla(O,Ta,Gb=null){O={["AppTeachingUICalloutAction"]:Ta,["SDX.Id"]:O,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};if(Gb)for(let hc of Gb.keys)O[hc]=Gb.na(hc);we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}))}mjg(O){O&&(O=this.DO?this.DO+","+O.addinId:O.addinId,vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=O:this.B7(O))}static oV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,
O.assetId,null,null,O.storeId)}static f4e(O,Ta){return Ta.value<O.installTimeInMS?new Ld.a(Object.assign(new Dg,{addinId:rg.vwb(O),targetType:O.targetType,solutionId:O.solutionId}),O.installTimeInMS):Ta}static vwb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(d.a)(rg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var hg=a(80);const Jg=()=>{const O=hg.a.$Z(window.location.href.toLowerCase(),"wdomexsrctype");
return!!O&&"4"===O},yg=()=>hg.a.$Z(window.location.href.toLowerCase(),"wdtpl"),zg=()=>{const O=hg.a.$Z(window.location.href.toLowerCase(),"wdomexsrctype");return!!O&&"1"===O},vh=O=>{let Ta=null;switch(O){case 0:Ta="omex";break;case 1:Ta="spcatalog";break;case 2:Ta="spapp";break;case 3:Ta="filesystem";break;case 4:Ta="exchange";break;case 6:Ta="registry";break;case 7:Ta="inmemory";break;case 8:Ta="uploadfiledevcatalog";break;case 9:Ta="hardcodedpreinstall";break;case 10:Ta="excatalog";break;case 16:Ta=
"wopicatalog"}return Ta},Yg=O=>{let Ta=-1;switch(O.toLowerCase()){case "omex":Ta=0;break;case "spcatalog":Ta=1;break;case "spapp":Ta=2;break;case "filesystem":Ta=3;break;case "exchange":Ta=4;break;case "registry":Ta=6;break;case "inmemory":Ta=7;break;case "uploadfiledevcatalog":Ta=8;break;case "hardcodedpreinstall":Ta=9;break;case "excatalog":Ta=10;break;case "wopicatalog":Ta=16}return Ta};var wh=a(683);class gh{constructor(O){this.Yr=null;this.FA=O}get_current(){if(!this.Yr)throw Error.argumentOutOfRange();
return this.Yr.data}moveNext(){if(!this.Yr)return this.Yr=this.FA,!!this.FA;if(!this.Yr.next)return!1;this.Yr=this.Yr.next;return!0}vnc(){if(!this.Yr)return this.Yr=this.FA,!!this.FA;if(!this.Yr.previous)return!1;this.Yr=this.Yr.previous;return!0}reset(){this.Yr=this.FA}}Object(d.a)(gh,"ListEnumerator",null,[0]);class Og{constructor(O,Ta,Gb){this.next=Gb;this.previous=Ta;this.data=O}}Object(d.a)(Og,"ListNode",null,[]);class Zg{constructor(){this.KA=this.zq=null;this._count=0}add(O){this.zq?this.KA=
this.KA.next=new Og(O,this.KA,null):this.zq=this.KA=new Og(O,null,null);this._count=this.count+1}insert(O,Ta){if(O>this.count||0>O)throw Error.argumentOutOfRange("pos");if(O===this.count)this.add(Ta);else{for(var Gb=this.zq;0!==O--;)Gb=Gb.next;O=new Og(Ta,Gb.previous,Gb);O.previous?O.previous.next=O:this.zq=O;O.next?O.next.previous=O:this.KA=O;this._count=this.count+1}}remove(O){let Ta=this.zq;for(;Ta&&Ta.data!==O;)Ta=Ta.next;if(!Ta)return!1;Ta.previous?Ta.previous.next=Ta.next:this.zq=Ta.next;Ta.next?
Ta.next.previous=Ta.previous:this.KA=Ta.previous;this._count=this.count-1;return!0}clear(){let O=this.zq,Ta;for(this.KA=this.zq=null;O;)Ta=O.next,O.previous=null,O.next=null,O=Ta;this._count=0}indexOf(O){let Ta=this.zq,Gb=0;for(;Ta&&Ta.data!==O;)Ta=Ta.next,Gb++;return Ta?Gb:-1}na(O){return this.at(O).data}get count(){return this._count}getEnumerator(){return new gh(this.zq)}[Symbol.iterator](){return Object(wh.a)(this.getEnumerator())}Acc(O){O=this.at(O);return new gh(O)}toArray(){const O=Array(this.count);
let Ta=0;for(let Gb of this)O[Ta]=Gb,Ta++;return O}at(O){let Ta=this.zq,Gb=0;for(;Gb!==O;){if(!Ta)throw Error.argumentOutOfRange("pos");Ta=Ta.next;Gb++}return Ta}}Object(d.a)(Zg,"List",null,[1]);class Kg extends Sys.EventArgs{constructor(O){super();this.properties=O}}Object(d.a)(Kg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class hh{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(hh,"MiniAddinInfo",null,[]);class mf{constructor(O,Ta,Gb){this.Ra=
new te.a;this.context=new af;this.cUc=this.AWd=this.PGa=this.DO=this.RX=null;this.contextActivationMgr=O;this.mOg=Ta;this.QGa=Gb;this.appName=vd.AFrameworkApplication.fa.Xa("WebAppShortName")}get fPb(){this.cUc||(this.cUc=new rg(this.Ra));return this.cUc}pKg(O){this.Ra.addHandler(Md.a.Lob,O)}HNg(O){this.Ra.addHandler(Md.a.YUd,O)}NTj(O){null!==O&&(this.context.rO=O[Md.a.W2],this.context.pq=O[Md.a.BM],this.context.BCc=this.context.Xsc=0,O=Md.a.RGa in O?O[Md.a.RGa]:0,-1!==this.context.rO&&0!==this.context.pq&&
(this.context.e$=new Zg,this.context.Eja=new Zg,this.context.q5b=new Zg,this.context.NXc=this.mOg.createAddinDataProvider(vh(this.context.rO),this.contextActivationMgr),this.context.NXc?this.context.NXc.getEntitlementsAsync(this.contextActivationMgr.bda,!0,O,Ta=>{this.DTi(Ta)}):r.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.rO)))}DTi(O){if(O&&0<O.length){this.context.BCc=O.length;const Gb=vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?
yg():null;for(let hc=0;hc<O.length;hc++){const wc=O[hc];if(vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&zg()&&wc&&wc.storeType&&"omex"===wc.storeType.toLowerCase()&&wc.assetId&&Gb&&wc.assetId.toLowerCase()===Gb.toLowerCase()){var Ta={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:mf.oV(wc)};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:xa.a.Zj(Ta)}))}!wc||1!==wc.targetType&&-1!==wc.targetType?
this.zoc():(Ta={},vd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ta.solutionId=wc.solutionId,Ta.version=wc.version):(Ta.marketplaceId=wc.solutionId,Ta.marketplaceVersion=wc.version),Ta.storeType=wc.storeType,Ta.storeId=wc.storeId,Ta.targetData=wc,mf.gPb?this.contextActivationMgr.isAddinCommandsExAsync(Ta,Object(Yd.a)(this,this.ZSi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ta,
($c,hd,md)=>{$c?(hd&&this.context.e$.add(md.targetData),10===this.context.rO&&($c=md.targetData,hd=$c.targetType,ee.c(md.targetTypeForExp)||(hd=md.targetTypeForExp,$c.targetType=hd),this.context.Eja.add($c),0===hd&&this.context.q5b.add($c))):(md=md.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(md.solutionId,md.storeType,md.assetId,null,null,md.storeId),md.storeType));this.zoc()}))}}else this.zoc()}zoc(){var O;
(O=this.context).Xsc=O.Xsc+1;this.context.Xsc>=this.context.BCc&&(this.QGa.A2f(this.context.rO,!1),0<this.context.BCc&&10===this.context.rO&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(O=!1,vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&Jg()&&(O=this.Szi()),this.ezi(),vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!O?mf.gPb?this.fPb.rSj(this.contextActivationMgr,
this.context.MXc,this.context.vIa,(Ta,Gb)=>{const hc=new n.a;for(let wc of Ta)Ta=wc.ceg(),Gb&&Gb.solutionId===wc.solutionId&&(Ta.showCallout=!0,this.fPb.mjg(Gb)),hc.add(Ta);this.gna(hc)}):this.VMh(this.context.e$):this.D_b(this.context.e$)):this.D_b(this.context.e$))}D_b(O){if(mf.gPb)this.gna(this.V6g(this.context.MXc));else{var Ta=new n.a;if(O)for(let Gb of this.context.e$)Ta.add(cg(Gb));this.context.e$&&1>this.context.e$.count&&Bf.a.kgb(Md.a.Mob,"false",this.context.rO);O={["ack2"]:Ta};O[Md.a.W2]=
this.context.rO;O[Md.a.BM]=this.context.pq;this.Ra.raiseEvent(Md.a.Lob,new Kg(O),this)}}V6g(O){const Ta=new n.a;if(O)for(let Gb of O)Ta.add(Gb.ceg());return Ta}gna(O){O&&O.count||Bf.a.kgb(Md.a.Mob,"false",this.context.rO);O={["ack2"]:O};O[Md.a.W2]=this.context.rO;O[Md.a.BM]=this.context.pq;this.Ra.raiseEvent(Md.a.Lob,new Kg(O),this)}B7(O){if(this.appName){const Ta={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=O;Ta[this.appName]=Ef.c(Gb);this.RX&&(this.RX.y3a(Ta),r.ULS.sendTraceTag(539530527,
306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else r.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}VMh(O){(this.PGa=O)?(O=new n.a,O.add(this.appName),this.RX=new dg(this.appName,Object(Yd.a)(this,this.fka,"getRequestSuccessCallback"),Object(Yd.a)(this,this.K4,"getRequestFailureCallback"),Object(Yd.a)(this,this.yW,"postRequestFailureCallback")),this.RX.G$b(O)):(O={["ack2"]:new n.a},O[Md.a.W2]=
this.context.rO,O[Md.a.BM]=this.context.pq,this.Ra.raiseEvent(Md.a.Lob,new Kg(O),this))}fka(O){O?this.HUd(O)?(r.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.DO="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.Zrb()):(r.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.D_b(this.PGa)):(r.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.DO=null,this.Zrb())}K4(O){r.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",
O?O.httpStatus:-1);this.D_b(this.PGa)}yW(O){r.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}Zrb(){const O=this.v8c();if(0===O.targetType){O.solutionId?(this.AWd=O.solutionId,this.$Id()):this.Lla("NoSolutionId");if(O.addinId){const Ta=this.DO?this.DO+","+O.addinId:O.addinId;vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Ta:this.B7(Ta)}this.Dpe(null)}else this.Dpe(O.addinId);
r.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",O.addinId)}$Id(){const O=new Pf;O.callbackFunc=Ta=>{if(Ta.errorCode){if(this.Lla("FailToGetAppDetails"),vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var Gb=window.g_roamingAddinList;Gb&&this.B7(Gb)}}else if(Ta.value)for(Gb of Ta.value)if(Ta=Gb[1],Ta===this.AWd){const hc={};hc.solutionId=Ta;hc.assetId=Gb[5];hc.storeType=Gb[12];hc.storeId=Gb[11];hc.assetStoreId=Gb[6];hc.targetType=
Gb[3];hc.width=Gb[7];hc.height=Gb[8];hc.displayName=Gb[0];hc.version=Gb[4];Gb=new ch(hc);this.Ra.raiseEvent(Md.a.YUd,Gb);break}};O.storeType=OSF.StoreTypeEnum.PrivateCatalog;O.fromInsertDialog=!1;O.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(O)}HUd(O){if("LastTeachingUIShowTime"in O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<vd.AFrameworkApplication.fa.mN("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
O),!1}else r.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}v8c(){let O=new Ld.a(new hh,0),Ta=new Ld.a(new hh,0),Gb=0,hc=0,wc=0;var $c=new Zg;if(0<this.context.e$.count)for(var hd of this.context.e$)$c.add(hd);if(0<this.context.q5b.count)for(let md of this.context.q5b)$c.add(md);for(let md of $c)if(!("excatalog"!==md.storeType||ee.c(md.installTimeInMS)||!md.installTimeInMS||md.installTimeInMS<=vd.AFrameworkApplication.fa.mN("DateTimeInMSForNewAddin",16409952E5))){$c=mf.vwb(md);
if(this.DO&&(hd=this.DO.split(","),0<hd.length&&Array.contains(hd,$c))){wc++;r.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}$c.startsWith("private_")?(O.value<md.installTimeInMS&&(O=new Ld.a(Object.assign(new hh,{addinId:$c,targetType:md.targetType,solutionId:md.solutionId}),md.installTimeInMS)),hc++):(Ta.value<md.installTimeInMS&&(Ta=new Ld.a(Object.assign(new hh,{addinId:$c,targetType:md.targetType,solutionId:md.solutionId}),md.installTimeInMS)),Gb++)}r.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",hc,Gb,wc);return 0<Ta.value?Ta.key:0<O.value?O.key:Object.assign(new hh,{addinId:null,targetType:-1,solutionId:null})}Dpe(O){const Ta=new n.a;for(let hc of this.PGa){const wc=cg(hc);if(O){var Gb=mf.vwb(hc);O===Gb&&(wc.showCallout=!0,Gb=this.DO?this.DO+","+O:O,vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Gb:this.B7(Gb))}Ta.add(wc)}this.PGa&&
1>this.PGa.count&&Bf.a.kgb(Md.a.Mob,"false",this.context.rO);O={["ack2"]:Ta};O[Md.a.W2]=this.context.rO;O[Md.a.BM]=this.context.pq;this.Ra.raiseEvent(Md.a.Lob,new Kg(O),this)}Szi(){if(mf.gPb)return this.Tzi(this.context.ked);var O=!1;if(this.context.Eja&&1>this.context.Eja.count)return O;const Ta=yg();if(!Ta)return O;for(let Gb of this.context.Eja)if(Gb.storeId&&Gb.storeId.toLowerCase()===Ta.toLowerCase()||Gb.assetId&&Gb.assetId.toLowerCase()===Ta.toLowerCase())O={["SDX_Id"]:mf.oV(Gb),["SDX_TargetType"]:ee.c(Gb.targetType)?
"":Gb.targetType.toString()},we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:xa.a.Zj(O)})),O=!0;return O}ezi(){if(mf.gPb)this.fzi(this.context.ked);else if(!(this.context.Eja&&1>this.context.Eja.count))if(this.QGa.Mjf()){var O=this.QGa.Y5e();O?(O=this.J1e(this.context.Eja,O),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.J1e(this.context.Eja,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));
this.QGa.a5f(O)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}J1e(O,Ta){const Gb={};let hc=!1;for(let wc of O)if(O=mf.oV(wc))!Ta||O in Ta||(this.mya(wc,O),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?hc||(hc=!0,Gb[O]=null):Gb[O]=null;return Gb}mya(O,Ta){var Gb=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Gb={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ee.c(O.targetType)?
"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Gb};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:xa.a.Zj(Gb)}));1===O.targetType&&(O={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:xa.a.Zj(O)})))}Tzi(O){let Ta=!1;if(O&&1>O.count)return Ta;const Gb=yg();if(!Gb)return Ta;for(let hc of O)if(hc.storeId&&
hc.storeId.toLowerCase()===Gb.toLowerCase()||hc.assetId&&hc.assetId.toLowerCase()===Gb.toLowerCase())O={["SDX_Id"]:mf.a6e(hc),["SDX_TargetType"]:ee.c(hc.targetType)?"":hc.targetType.toString()},we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:xa.a.Zj(O)})),Ta=!0;return Ta}fzi(O){if(!(O&&1>O.count))if(this.QGa.Mjf()){var Ta=this.QGa.Y5e();Ta?(O=this.K1e(O,Ta),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):
(O=this.K1e(O,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.QGa.a5f(O)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}K1e(O,Ta){const Gb={};let hc=!1;for(let wc of O)if(O=mf.a6e(wc))!Ta||O in Ta||(this.YBi(wc,O),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?hc||(hc=!0,Gb[O]=null):Gb[O]=null;return Gb}YBi(O,Ta){var Gb=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Gb={["SDX.Id"]:Ta,
["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ee.c(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Gb};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:xa.a.Zj(Gb)}));1===O.targetType&&(O={["SDX.Id"]:Ta,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:xa.a.Zj(O)})))}ZSi(O,Ta,Gb,hc){O?
(-1===hc.targetType&&(hc.targetType=Gb.targetTypeForExp),O=new Uf(Gb.targetData,hc),Ta&&this.context.MXc.add(O),10===this.context.rO&&(this.context.ked.add(O),0===O.targetType&&this.context.vIa.add(O))):(Ta=Gb.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.storeType,Ta.assetId,null,null,Ta.storeId),Ta.storeType));this.zoc()}Lla(O){O={["AppTeachingUICalloutAction"]:O,["SDX.Id"]:this.AWd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}))}static get gPb(){return vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static oV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static a6e(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,
O.storeType,O.assetId,null,null,O.storeId)}static vwb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(d.a)(mf,"AddInCommandsListLoader",null,[]);class ma{constructor(O){this.Zzg=O}get bda(){return this.Zzg}insertOsfControl(O){return this.bda.insertOsfControl(O)}getManifestInvaildErrorString(){return this.bda.getManifestInvaildErrorString()}isAddinCommandsAsync(O,Ta){this.bda.isAddinCommandsAsync(O,Ta)}isAddinCommandsExAsync(O,
Ta){this.bda.isAddinCommandsExAsync(O,Ta)}ownerAddinControlRecreated(O,Ta){this.bda.ownerAddinControlRecreated(O,Ta)}queryEntitlementDetails(O){this.bda.queryEntitlementDetails(O)}}Object(d.a)(ma,"ContextActivationMgrWrapper",null,[759]);class sb{createAddinDataProvider(O,Ta){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(O,Ta.bda)}static get instance(){sb.Ma||(sb.Ma=new sb);return sb.Ma}}sb.Ma=null;Object(d.a)(sb,"OSFAddinDataProviderFactory",null,[766]);class ic{constructor(){this.Ver=
1}}Object(d.a)(ic,"CacheItem",null,[]);class Cc{constructor(O){this.REa=O}Fl(O){const Ta=this.REa.getItem(O);if(Ta){let Gb=new ic;try{Gb=Sys.Serialization.JavaScriptSerializer.deserialize(Ta,!0)}catch(hc){return this.REa.removeItem(O),null}return Gb.Data?Gb.Data:Gb.data}return null}oRa(O){this.REa.removeItem(O)}}Object(d.a)(Cc,"AppsDataCacheManager",null,[820]);var rd=a(820);class Hd{constructor(){new Cc(rd.a.instance)}A2f(O,Ta){O=Md.a.P2e()+O;rd.a.instance.setItem(O,Ta.toString())}Y5e(){var O=Md.a.b6e();
r.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",O);O=rd.a.instance.getItem(O);return Ef.a(O)}a5f(O){const Ta=Md.a.b6e();r.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ta);rd.a.instance.setItem(Ta,Ef.c(O))}Mjf(){return!!rd.a.instance.localStorage}static get instance(){Hd.Ma||(Hd.Ma=new Hd);return Hd.Ma}}Hd.Ma=null;Object(d.a)(Hd,"AddInCommandsCacheManager",null,[767]);class ge{constructor(O,Ta,Gb,hc,wc,$c){this.pq=O;this.qk=Ta;this.cX=Gb;this.displayName=wc;this.xof=$c}}Object(d.a)(ge,
"PostLaunchAddinCommandsParameters",null,[]);class Ee{constructor(O,Ta,Gb){this.XRa=!1;this.RX=null;this.fb=O;this.dkb=Ta;this.vhb=Gb}uWc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Yd.a)(this,this.NDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Yd.a)(this,this.VCd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Yd.a)(this,this.KCd,"onCloseButtonClickedEventHandler"),!0),vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Yd.a)(this,this.SFb,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}NDd(){const O={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Ee.oV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.vhb&&this.vhb.tabs&&!this.vhb.tabs[0].isOfficeTab&&(O["SDX.FeatureFlags"]="NonOfficeTab");we.a.sendTelemetryEvent(Object.assign(new Jf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}));vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Xla();this.vhb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.vhb,()=>{const Ta=new vg;Ta.qk=this.dkb;this.fb.raiseEvent(Md.a.Dvd,Ta)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}KCd(){const O={["AppTeachingUICalloutAction"]:"ClickOnClose",
["SDX.Id"]:Ee.oV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}));vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Xla()}VCd(){const O={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Ee.oV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}));vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Xla()}SFb(O){if(O&&(O=O.detail)&&O.id&&this.Cpd(O.id)){const Gb=(O.action||"").toLowerCase();if(O.success&&"opened"===Gb){var Ta={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:Ee.oV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(Ta)}));r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.Xla();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Yd.a)(this,this.SFb,"onCampaignLaunchedHandler"),!0)}else try{Ta=JSON.stringify(O),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+
Ta)}catch(hc){Ta="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ta+" Error: "+(hc?hc.toString():""))}}}Cpd(O){O=lg.a.vl(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}B7(O){const Ta=
vd.AFrameworkApplication.fa.Xa("WebAppShortName");if(Ta){const Gb={},hc={};hc.LastTeachingUIShowTime=(new Date).toUTCString();hc.AddinHasShown=O;Gb[Ta]=Ef.c(hc);this.RX=new dg(Ta,null,null,Object(Yd.a)(this,this.yW,"postRequestFailureCallback")),this.RX.y3a(Gb),r.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")}Xla(){if(!this.XRa){const O=
window.g_roamingAddinList;O&&(this.B7(O),this.XRa=!0)}}yW(O){r.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}static oV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}}Object(d.a)(Ee,"PrivateCatalogTeachingCalloutHandler",null,[]);class Wd{constructor(O){this.ide=null;this.$ae=O}get Yxa(){return this.ide}yZa(O,Ta=null){this.$ae.yZa(O,Ta);this.ide=O}XLd(O){this.$ae.XLd(O)}}
Object(d.a)(Wd,"RibbonExtensibilityManagerWithChangeDetection",null,[821]);var k=a(864),K=a(99);class ia{static E3e(O){const Ta=new n.a;if(ia.iFe)for(var Gb of ia.iFe)Ta.add(Gb);Gb=null;switch(O){case "Workbook":Gb=ia.q3j;break;case "Document":Gb=ia.Rnh;break;case "Presentation":Gb=ia.I5i}if(Gb)for(const hc of Gb)Ta.add(hc);return Ta}}ia.iFe=["PrimaryCommandSurface","ContextMenu"];ia.q3j=null;ia.Rnh=null;ia.I5i=null;Object(d.a)(ia,"ExtensionPointType",null,[]);class Za{constructor(O){this.hge=null;
if(ee.c(O))throw r.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.org=O}get FFb(){return this.hge||(this.hge=new n.a)}get gte(){return this.org}}Object(d.a)(Za,"ContextMenuExtensibility",null,[794]);class Mb{constructor(O,Ta=null,Gb=0){if(ee.c(O))throw r.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");
this.Szg=O;this.fDg=Ta;this.Rvg=Gb}get jW(){return this.Szg}get startedNode(){return this.fDg}get jMh(){return this.Rvg}}Object(d.a)(Mb,"RibbonExtensibility",null,[844]);class Wb{constructor(O){this.Pug=O.entitlement}get entitlement(){return this.Pug}createActionContext(O,Ta){O={};O.ownerAddinInfo=this.entitlement;O.action=Ta;return O}}Object(d.a)(Wb,"AddInCommandsContextProvider",null,[]);class ac{constructor(O,Ta,Gb){this.i5d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=
this.commandSurface=null;this.ribbonBuilder=O;this.eventBuilder=Ta;this.contextMenuBuilder=Gb}get addinInfo(){return this.i5d}Zah(O){return new Wb(O)}createActionBuilder(O,Ta){return OfficeExt.DefaultControlActionBinder.createActionBuilder(O,Ta.entitlement,Ta.manifest)}startApplyAddin(O){this.i5d=O;const Ta=this.Zah(O);this.actionBuilder=this.createActionBuilder(Ta,O)}endApplyAddin(){}Ned(O,Ta,Gb=0){return this.ribbonBuilder.mt&&0<this.ribbonBuilder.mt.count?new Mb(this.ALh(O,Ta),this.addinInfo.startedNode,
Gb):null}h_e(){var O=null;if(this.contextMenuBuilder.bnc&&0<this.contextMenuBuilder.bnc.count){O||(O=this.addinInfo.entitlement.solutionId);O=new Za(O);for(let Ta of this.contextMenuBuilder.bnc)O.FFb.add(Ta);return O}return null}ALh(O,Ta){return this.ribbonBuilder.mt&&0<this.ribbonBuilder.mt.count?new Te.a(this.ribbonBuilder.mt,O,Ta):null}}Object(d.a)(ac,"AddinCommandsBuilder",null,[]);class Nc{constructor(O,Ta,Gb,hc,wc,$c,hd){this.aUa=new K.a;this.pq=O;this.Yh=Ta;this.ap=Gb;this.ribbonManager=hc;
this.contextMenuManager=wc;this.nG=$c;this.jha=hd;this.UO=vd.AFrameworkApplication.ta.lE}lDb(O,Ta,Gb,hc,wc,$c,hd){const md=(Bd,Qd,Pe,Ue)=>{wc(Bd,Qd,Pe,Ue);Bd=k.a[this.pq]+Qd.assetId;({value:Qd}=this.aUa.Dc(Bd)).returnValue&&(Qd.stop(),this.aUa.remove(Bd))};if(0!==this.pq&&O){r.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",O.count);4===this.pq&&(r.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",hc)),this.i3g(O,hc),$c());for(let Bd of O)if(O=Bd,r.ULS.sendTraceTag(17638144,
220,50,String.format("{0}: Install addin {1}",this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.jlg(O))if(hd&&O.requireConsent)hd(O,Qd=>{try{if(this.UO){const Ue=k.a[this.pq]+Qd.solutionId,of=this.UO.Bc("ComponentAttach",Ue);this.aUa.ia(Ue,of)}const Pe=this.nG.kja(Qd.storeType,Qd.solutionId);6!==this.pq&&(Pe&&(this.f4b(Pe),Pe.MB.purge(!1)),this.Yh.insertOsfControl(this.pIb(Qd,Ta,Gb,md)),Pe&&this.Yh.ownerAddinControlRecreated(Qd.solutionId,
Qd.storeType))}catch(Pe){r.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.solutionId,Qd.ownerAddinStoreType||Qd.storeType,Qd.assetId,null,null,Qd.storeId),Qd.version,Qd.storeType,Qd.storeId,Pe.message)),md(!1,Qd,null,null)}});else try{if(this.UO){const Pe=k.a[this.pq]+O.solutionId,Ue=this.UO.Bc("ComponentAttach",Pe);this.aUa.ia(Pe,
Ue)}const Qd=this.nG.kja(O.storeType,O.solutionId);6!==this.pq&&(Qd&&(this.f4b(Qd),Qd.MB.purge(!1)),this.Yh.insertOsfControl(this.pIb(O,Ta,Gb,md)),Qd&&this.Yh.ownerAddinControlRecreated(O.solutionId,O.storeType))}catch(Qd){r.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,
null,null,O.storeId),O.version,O.storeType,O.storeId,Qd.message)),md(!1,O,null,null)}else md(!1,O,null,null)}}Bwi(O,Ta,Gb,hc,wc,$c){const hd=(md,Bd,Qd,Pe)=>{$c(md,Bd,Qd,Pe);md=k.a[this.pq]+Bd.solutionId;({value:Bd}=this.aUa.Dc(md)).returnValue&&(Bd.stop(),this.aUa.remove(md))};if(6===this.pq&&O)if(r.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,
null,O.storeId))),this.jlg(O))try{if(this.UO){const Bd=k.a[this.pq]+O.solutionId,Qd=this.UO.Bc("ComponentAttach",Bd);this.aUa.ia(Bd,Qd)}const md=this.nG.kja(O.storeType,O.solutionId);md||hd(!1,O,null,null);vd.AFrameworkApplication.ta&&vd.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.F_e(O,Ta,hc,wc,Gb,Bd=>{hd(Bd,O,Gb,md.displayName)}):(this.F_e(O,Ta,hc,wc,Gb),hd(!0,O,Gb,md.displayName))}catch(md){r.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,md.message)),hd(!1,O,null,null)}else hd(!1,O,null,null)}cLi(O,Ta,Gb,hc,wc,$c){if($c)if($c._isAddinCommandsManifest(this.ap.vN))try{vd.AFrameworkApplication.ta&&vd.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.E_e(O,Ta,Gb,wc,$c,hd=>{hc(hd,O,$c,$c.getDefaultDisplayName())}):(this.E_e(O,Ta,Gb,wc,$c),hc(!0,O,$c,$c.getDefaultDisplayName()))}catch(hd){r.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,hd.message)),hc(!1,O,$c,$c.getDefaultDisplayName())}else r.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),hc(!1,O,null,null);else r.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.ap.vN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),
hc(!1,O,null,null)}pIb(O,Ta,Gb,hc){const wc={},$c=document.createElement("div");$c.setAttribute("visible","false");wc.div=$c;wc.id=O.solutionId;wc.solutionId=O.solutionId;wc.version=O.version;wc.storeType=O.storeType;wc.storeId=O.storeId;wc.assetId=O.assetId;wc.assetStoreId=O.assetStoreId;wc.isvirtualOsfControl=!0;wc.virtualOsfControlActivationCallback=(hd,md)=>{const Bd=this.nG.kja(O.storeType,O.solutionId);Bd&&(Bd.isUpgraded&&(O.isUpgraded=!0),this.f4b(Bd));this.cLi(O,Ta,Gb,hc,hd,md)};wc.reason=
3===this.pq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return wc}E_e(O,Ta,Gb,hc,wc,$c=null){const hd={};hd.solutionId=hc.getSolutionId();hd.version=hc.getVersion();hd.storeType=hc.getStoreType();hd.storeId=hc.getStoreId();hd.assetId=hc.getAssetId();hd.assetStoreId=hc.getAssetStoreId();hd.targetType=hc.getOsfControlType();let md=null,Bd=null;if(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))md=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ap.vN,this.ap.formFactor)).parseExtensions(hd,wc,this.jha),Bd=ia.E3e(this.ap.vN);else try{md=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ap.vN,this.ap.formFactor)).parseExtensions(hd,wc,this.jha),Bd=ia.E3e(this.ap.vN)}catch(Pe){throw r.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Pe.message),Pe;}if(Bd&&0<Bd.count){if(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Qd=Ta(O);Ta=Gb(O);Gb=!!vd.AFrameworkApplication.fa&&vd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Qd=new ac(Qd,null,Ta);for(let Pe of Bd)Qd.commandSurface=Pe,md.apply(Qd,this.jha,Gb)}else try{let Pe=Ta(O),Ue=Gb(O),of=!!vd.AFrameworkApplication.fa&&vd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Qd=new ac(Pe,null,Ue);for(let tg of Bd)Qd.commandSurface=tg,md.apply(Qd,this.jha,of)}catch(Pe){throw r.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Pe.message),Pe;}if(OSF.OUtil.checkFlight(14))try{let Pe=Qd.Ned(O.solutionId,wc.getDefaultDisplayName()),Ue=Qd.h_e();Pe&&this.ribbonManager.yZa(Pe,$c);Ue&&this.contextMenuManager.epe(Ue);this.nG.Lpe(hc,Pe,Ue,wc.getDefaultDisplayName());r.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",wc.getDefaultDisplayName())}catch(Pe){throw OfficeExt.DevConsole.log(Pe),r.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Pe.message),Pe;}else try{let Pe=Qd.Ned(O.solutionId,
wc.getDefaultDisplayName()),Ue=Qd.h_e();Pe&&this.ribbonManager.yZa(Pe);Ue&&this.contextMenuManager.epe(Ue);this.nG.Lpe(hc,Pe,Ue,wc.getDefaultDisplayName());r.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",wc.getDefaultDisplayName())}catch(Pe){throw r.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Pe.message),Pe;}}}F_e(O,Ta,Gb,hc,wc,$c=null){const hd={};hd.solutionId=O.solutionId;hd.version=O.version;hd.storeType=O.storeType;hd.storeId=O.storeId;hd.assetId=
O.assetId;hd.assetStoreId=O.assetStoreId;hd.targetType=O.targetType;const md=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.ap.vN,this.ap.formFactor);try{const Bd=Ta.getManifest(),Qd=md.parse(hd,Bd,wc,this.jha,Ta.getSharedRuntimeId(),Ta),Pe=Gb(O),Ue=hc(O),of=new ac(Pe,null,Ue);of.commandSurface="PrimaryCommandSurface";Qd.apply(of,this.jha,!0);if(of.ribbonBuilder.mt&&0<of.ribbonBuilder.mt.count){const tg=of.Ned(O.solutionId,Ta.getManifest().getDefaultDisplayName(),1);vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.yZa(tg,$c):tg&&this.ribbonManager.yZa(tg,$c);this.nG.sIg(Ta,tg,wc,Ta.getManifest().getDefaultDisplayName());r.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ta.getManifest().getDefaultDisplayName())}}catch(Bd){r.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ta.getManifest().getDefaultDisplayName(),Bd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Bd)}}f4b(O){O.Ro&&this.ribbonManager.XLd(O.Ro);
O.msb&&this.contextMenuManager.Kej(O.msb);this.nG.sej(O.MB.getStoreType(),O.MB.getSolutionId())}i3g(O,Ta){Ta=vh(Ta);for(let Gb of this.nG.L6a){if(Gb.MB.getStoreType()!==Ta)continue;let hc=!0;for(let wc of O){const $c=wc;if($c&&Gb.Alf($c.storeType,$c.solutionId)){hc=!1;break}}hc&&(this.f4b(Gb),Gb.MB.purge(!1))}}jlg(O){return!!O&&!!O.solutionId&&!!O.version&&!!O.storeType&&!!O.storeId}}Object(d.a)(Nc,"AddInCommandsIntegration",null,[]);class ad{constructor(O,Ta,Gb,hc,wc,$c,hd,md=null){this.fb=new te.a;
this.HGc=O;this.Itg=Ta;this.Im=Gb;this.sme=hc;this.nYa=wc;this.crg=$c;this.lSb=hd;this.Kzg=md;this.Cxg=vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.JMc=vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}qKg(O){this.fb.addHandler(Md.a.Bse,O)}hMg(O){this.fb.addHandler(Md.a.Dvd,O)}GNg(O){this.fb.addHandler(Md.a.p8f,O)}xKg(O){this.fb.addHandler(Md.a.QZc,O)}Uwi(O,Ta,Gb){const hc=Gb[Md.a.Kob],
wc=void 0===Gb[Md.a.BM]?0:Gb[Md.a.BM];if(hc&&0!==wc)if(0>=hc.count&&4!==wc)this.cNf(new ge(wc,null,null,Ta,null,!0));else{var $c=hc.count,hd=new Wd(new l),md=void 0===Gb[Md.a.W2]?-1:Gb[Md.a.W2],Bd=new Nc(wc,this.Im,this.HGc,hd,this.Itg,this.nYa,this.lSb),Qd=gg=>this.sme.BXg(gg.solutionId,this.lSb,this.HGc,O),Pe=gg=>this.sme.MWg(gg.solutionId),Ue=(gg,Yf,$f)=>{$c--;$f=new ge(wc,Yf,hd,Ta,$f,0>=$c);if(gg&&Yf)this.cNf($f);else{if(3===wc||Yf&&Yf.isUpgraded)gg="",Yf&&(gg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yf.solutionId,
Yf.ownerAddinStoreType||Yf.storeType,Yf.assetId,null,null,Yf.storeId)),Yf={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:gg},we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:xa.a.Zj(Yf)}));this.bNf($f)}$c||vd.AFrameworkApplication.ta.updateCommandUI()},of=(gg,Yf,$f,mg)=>{Ue(gg,Yf,mg)},tg=()=>{this.ABd();0>=hc.count&&4===wc&&this.nYa.HRd()};6===wc?(md=Gb[Md.a.EJa],Gb=Gb[Md.a.FJa],Bd.Bwi(hc.na(0),
md,Gb,Qd,Pe,(gg,Yf,$f,mg)=>{Ue(gg,Yf,mg)})):Bd.lDb(hc,Qd,Pe,md,of,tg,this.Kzg)}else we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:xa.a.Zj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),r.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.HGc.vN)),this.bNf(new ge(wc,null,null,Ta,null,!0))}bNf(O){this.ABd(O);this.g9f(!1,
O)}cNf(O){const Ta=O.qk;let Gb=null;null!==Ta&&(Gb=Ta.storeType,Gb=Gb.toLowerCase());if(O&&"omex"===Gb&&(3===O.pq||Ta.isUpgraded)){var hc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.ownerAddinStoreType||Ta.storeType,Ta.assetId,null,null,Ta.storeId)};we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:xa.a.Zj(hc)}))}this.ABd(O);hc=this.JMc&&zg()&&"omex"===
Gb&&!!O.cX&&!!Ta.solutionId&&2===O.pq&&Ta.solutionId.toLowerCase()===yg().toLowerCase();var wc="omex"===Gb&&!!O.cX&&(3===O.pq&&"hardcodedpreinstall"!==Gb||Ta.isUpgraded);const $c=vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",!1)&&"excatalog"===Gb&&3===O.pq;if(wc||hc||$c)hc=new vg,hc.qk=Ta,hc.Ro=O.cX.Yxa,this.fb.raiseEvent(Md.a.QZc,hc);this.Cxg&&(hc=Jg(),wc=yg(),hc&&Ta&&"excatalog"===Ta.storeType&&O.cX&&5===O.pq&&wc&&(Ta.storeId&&Ta.storeId.toLowerCase()===
wc.toLowerCase()||Ta.assetId&&Ta.assetId.toLowerCase()===wc.toLowerCase())&&(hc=new vg,hc.qk=Ta,hc.Ro=O.cX.Yxa,this.fb.raiseEvent(Md.a.QZc,hc),r.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Ta&&(Hd.instance.A2f(Yg(Gb),!0),"uploadfiledevcatalog"===Gb&&(hc=this.crg.createAddinDataProvider(Gb,this.Im))&&hc.localCacheAddinCommands(this.Im.bda,Ta.solutionId,Ta.version,Ta.storeId),Bf.a.kgb(Md.a.Mob,"true",Yg(Gb)));this.g9f(!0,O)}g9f(O,Ta){O?vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Ta.cX&&5===Ta.pq&&Ta.cX.Yxa&&void 0!==Ta.qk.showCallout&&null!==Ta.qk.showCallout&&Ta.qk.showCallout?(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new rg(this.fb)).uWc(Ta.qk,Te.a.m4a(Ta.cX.Yxa)):(new Ee(this.fb,Ta.qk,Te.a.m4a(Ta.cX.Yxa))).uWc(),O=new vg,O.Ro=Ta.cX.Yxa,O.qk=Ta.qk,this.fb.raiseEvent(Md.a.p8f,O)):3!==Ta.pq?Ta.xof&&this.nYa.HRd():Ta.cX&&Ta.cX.Yxa&&"hardcodedpreinstall"!==Ta.qk.storeType&&Ob.a.VEj(Ta.displayName,
Ta.cX.Yxa,Ta.qk.isAutoLaunched):3===Ta.pq?Ta.qk&&"uploadfiledevcatalog"===Ta.qk.storeType.toLowerCase()?(Ta=this.lSb.XSh(Ta.qk.solutionId),Ob.a.RUd(Ta?Ta:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.nYa.H3f():Ta.xof&&this.nYa.HRd()}ABd(O=null){var Ta=O?O.qk:null;const Gb=new vg;if(Gb.qk=Ta){var hc=this.nYa.kja(Ta.storeType,Ta.solutionId,6===O.pq?1:0);if(hc&&hc.Ro){Gb.Ro=hc.Ro;var wc=this.JMc?yg():null;wc=this.JMc&&zg()&&!!Ta.solutionId&&!!wc&&Ta.solutionId.toLowerCase()===
wc.toLowerCase()&&2===O.pq;if(3===O.pq&&"hardcodedpreinstall"!==Ta.storeType||wc)O="",hc.Ro.jW&&hc.Ro.jW.mt&&(hc=hc.Ro.jW.mt.na(0))&&(O=hc.id),Ta={["SDX_CommandPlacement"]:O,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,Ta.ownerAddinStoreType||Ta.storeType,Ta.assetId,null,null,Ta.storeId)},we.a.sendTelemetryEvent(Object.assign(new Jf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:xa.a.Zj(Ta)}))}}this.fb.raiseEvent(Md.a.Bse,
Gb)}}Object(d.a)(ad,"LaunchAddinCommandsHandler",null,[791]);class bd{}bd.BVa="Alt";bd.CVa="Command";bd.id="Id";bd.FVa="Image16by16";bd.VRb="LabelText";bd.IVa="Title";bd.GROUP="Group";bd.d4d="Groups";bd.nhb="Controls";bd.button="Button";bd.Qaa="FlyoutAnchor";bd.LARGE="Large";bd.SMALL="Small";Object(d.a)(bd,"AddinDataNodeConstants",null,[]);a(378);a(567);a(562);a(137);class Kd{constructor(O,Ta){this.YEa=this.L7d=null;if(ee.c(O)||ee.c(Ta))throw r.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.Ptg=Ta;this._id=O;this.tU[bd.id]=this._id}get id(){return this._id||""}get tU(){return this.L7d||(this.L7d={})}get controlType(){return this.Ptg||""}get menuItems(){return this.YEa||(this.YEa=new n.a)}}Object(d.a)(Kd,"ControlDefinition",null,[790]);class Xd{constructor(O){this.Qee=null;if(ee.c(O))throw r.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=O;this.$la[bd.id]=this._id}get $la(){return this.Qee||(this.Qee={})}get id(){return this._id||""}}Object(d.a)(Xd,"MenuItemDefinition",null,[836]);class ue{constructor(O){this.Ypa=null;if(ee.c(O))throw r.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=O}get id(){return this._id}get controls(){return this.Ypa||(this.Ypa=new n.a)}}Object(d.a)(ue,"OfficeMenuDefinition",
null,[792]);var me=a(25);class Ke{constructor(O,Ta,Gb){this.pJ=this.sWa=null;this.SPc=O;this.iWa=Ta;this.KVa=Gb;this.izg=new n.a}get Hnc(){return this.SPc}get Nrb(){return this.iWa}get zVc(){return this.KVa}addButton(O){r.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",O.actionType);this.pJ=new Kd(this.Ssa(O.id),bd.button);this.pJ.tU[bd.VRb]=O.label;this.pJ.tU[bd.BVa]=O.label;this.pJ.tU[bd.FVa]=O.icon["16"];this.iqb(this.pJ.tU[bd.id],O.action);this.wGa(this.pJ.tU);this.sWa.controls.add(this.pJ);
this.pJ=null}startBuildMenu(O){if(ee.c(this.sWa))this.sWa=new ue(O.id);else{const Ta=this.Ssa(O.id);this.pJ=new Kd(Ta,bd.Qaa);this.h0a(this.pJ.tU,O);this.pJ.tU[bd.FVa]=O.icon["16"];this.pJ.tU[bd.CVa]=me.a.alwaysEnabled}}addMenuItem(O){r.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",O.actionType);const Ta=new Xd(this.Ssa(O.id));this.h0a(Ta.$la,O);O.icon&&(Ta.$la[bd.FVa]=O.icon["16"]);this.iqb(Ta.$la[bd.id],O.action);this.wGa(Ta.$la);this.pJ.menuItems.add(Ta)}endBuildMenu(){ee.c(this.pJ)?
(this.bnc.add(this.sWa),this.sWa=null):(this.sWa.controls.add(this.pJ),this.pJ=null)}get bnc(){return this.izg}iqb(O,Ta){this.zVc.bindAction(O,Ta)}wGa(O){this.Nrb.wGa(O)}Ssa(O){return this.Hnc.aLa(O)}h0a(O,Ta){O[bd.VRb]=Ta.label;O[bd.BVa]=Ta.label}}Object(d.a)(Ke,"ContextMenuExtensibilityCreator",null,[826,797]);class We{constructor(O){this.llb=O}get bFb(){return this.llb}aLa(O){return this.bFb+O}}Object(d.a)(We,"DefaultContextMenuNamingProvider",null,[827]);var Ve=a(1318);class cf{bindAction(O,Ta){OfficeExt.DefaultControlActionBinder.bindAction(O,
Ta)}}Object(d.a)(cf,"DefaultUIControlActionBinder",null,[798]);class tf{constructor(O){this.DDa=O}get command(){return this.DDa}wGa(O){O[bd.CVa]=this.command}}Object(d.a)(tf,"DefaultUIControlCommandBinder",null,[795]);var xf=a(32);class zf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(zf,"AddInControl",null,[]);class df{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(d.a)(df,"AddInGroup",null,[]);class Wf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(Wf,"AddInMenuItem",null,[]);class wf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(wf,"AddInTab",null,[]);class Vg{constructor(O,Ta,Gb,hc,wc,$c){this.iSb=new n.a;this.Cib=this.vfa=this.tWa=null;this.SPc=O;this.KVa=
Ta;this.iWa=Gb;this.yx=hc;this.lSb=wc;this.L9d=$c}get Hnc(){return this.SPc}get mt(){return this.iSb}get zVc(){return this.KVa}get Nrb(){return this.iWa}startBuildTab(O){const Ta=O.isOfficeTab?O.id:this.Hnc.S7e(O.id),Gb=O.isOfficeTab?null:O.label;this.tWa=Object.assign(new wf,{id:Ta,title:Gb,isOfficeTab:O.isOfficeTab,visible:O.visible,groups:[],tabType:O.tabType,insertBefore:O.insertBefore,insertAfter:O.insertAfter,autoFocus:O.autoFocus})}startBuildGroup(O){const Ta=this.Ssa(O.id);this.vfa=Object.assign(new df,
{id:Ta,mlrId:O.mlrId,title:O.label,controls:[],groupType:0})}addNativeGroup(O){this.vfa=Object.assign(new df,{id:O.id,mlrId:O.mlrId,title:O.label,controls:[],groupType:1});this.tWa.groups.push(this.vfa)}addButton(O){const Ta=this.Ssa(O.id);Ta&&(this.iqb(Ta,O.action),r.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new zf,{id:Ta,title:O.label,iconLocation:this.fhd(O),enabled:O.enabled,controlType:0,attributes:this.h0a()}),this.L9d.Qoe(new xf.a(Ta,
this.Nrb.command.toString())),this.vfa.controls.push(O))}addNativeControl(O){O.id&&(r.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new zf,{id:O.id,title:"",iconLocation:"",enabled:O.enabled,controlType:2,attributes:this.h0a()}),this.vfa.controls.push(O))}startBuildMenu(O){const Ta=this.Ssa(O.id);Ta&&(this.Cib=Object.assign(new zf,{id:Ta,title:O.label,iconLocation:this.fhd(O),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(O){const Ta=
this.Ssa(O.id);Ta&&(this.iqb(Ta,O.action),r.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",O.actionType),O=Object.assign(new Wf,{id:Ta,title:O.label,iconLocation:this.fhd(O),enabled:O.enabled,attributes:this.h0a()}),this.L9d.Qoe(new xf.a(Ta,this.Nrb.command.toString())),this.Cib.menuItems.push(O))}endBuildMenu(){ee.c(this.Cib.id)||this.vfa.controls.push(this.Cib);this.Cib=null}endBuildGroup(){ee.c(this.vfa.id)||this.tWa.groups.push(this.vfa);this.vfa=null}endBuildTab(){ee.c(this.tWa.id)||
this.iSb.add(this.tWa);this.tWa=null}h0a(){const O={};this.wGa(O);return O}fhd(O){return O.icon["80"]?O.icon["80"]:O.icon["32"]}wGa(O){this.Nrb.wGa(O)}Ssa(O){return this.Hnc.aLa(O)}iqb(O,Ta){this.zVc.bindAction(O,Ta)}}Object(d.a)(Vg,"OneLineRibbonExtensibilityCreator",null,[796,797]);class ug{constructor(O,Ta){this.llb=O;this.KVa=new cf;this.iWa=new tf(Ta)}MWg(O){O=new We(O);return new Ke(O,this.iWa,this.KVa)}BXg(O,Ta,Gb,hc){Gb=new Ve.a(this.llb,O,Gb,!0);return new Vg(Gb,this.KVa,this.iWa,O,Ta,hc)}}
Object(d.a)(ug,"UIExtensibilityFactory",null,[760]);var xh=a(92),Yh=a(863),Eh=a(22),Vf=a(37),Pg=a(76),wg=a(49);class Qg{constructor(O){this.OGa=this.TGa=this.qk=this.Ro=null;this.lUf=0;this.rTi=()=>{if(this.qk&&this.OGa){const Ta=new xh.a(me.a.P2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ta,{["SourceControlId"]:this.OGa},null);r.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.WEj=(Ta,Gb)=>{Ta=null;if(Gb)if(Ta=Gb,this.qk=Ta.qk,(this.Ro=Ta.Ro)&&this.Ro.jW&&
this.Ro.jW.mt&&(this.TGa=this.Ro.jW.mt.na(0)),this.TGa&&this.TGa.id)if(this.TGa.isOfficeTab)if(Gb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ta=this.qk.solutionId,Ta in Gb?this.OGa=Gb[Ta]:(Gb=Qg.GetPrivacyCompliantId(this.qk),r.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Gb}`),this.OGa=this.UMh(this.Ro)),this.OGa)if(Eh.a.contains(this.TGa.id,Jd.a.JW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Te.a.m4a(this.Ro),
()=>{this.I9f(this.wid(this.OGa))});else{if(Gb=this.$.Ja)Gb.rse(this.QIf),r.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else r.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Gb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:xa.a.Zj(Gb)})),this.p6();else this.K9f(this.wid(this.TGa.id),0);else r.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Gb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(Gb)})),this.p6();
else this.p6()};this.QIf=()=>{if(Eh.a.contains(this.TGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ta=this.$.Ja;Ta&&Ta.iWf(this.QIf);this.I9f(this.wid(this.OGa))}};this.tTi=()=>{var Ta={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Qg.DVa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(Ta)}));this.p6();let Gb=
{};Gb[Pg.a.og]=this.$C;Ta={};Ta.solutionId=this.$C.solutionId;Ta.assetId=this.$C.assetId;Ta.assetStoreId=this.$C.assetStoreId;Ta.height=0!=this.$C.height?this.$C.height:600;Ta.storeId=this.$C.storeId;Ta.storeType=this.$C.storeType;Ta.targetType=this.$C.targetType;Ta.width=0!=this.$C.width?this.$C.width:600;Ta.displayName=this.$C.displayName;Ta.version=this.$C.version;Ta.isAddinCommands=!1;Gb[Md.a.ssa]=Ta;let hc=new xh.a(-741808261,0,0,2,null);Vf.TaskExtensions.za(wg.GetServiceTaskFactory.Oa(this.$.da,
374,375,1),wc=>{wc=wc.result;null!=wc&&wc.insertAgave(Gb,hc)},this.$.ka,3)};this.aNi=()=>{let Ta={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Qg.DVa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(Ta)}));this.p6()};this.uOi=()=>{let Ta={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Qg.DVa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(Ta)}));this.p6()};this.yW=Ta=>{r.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ta?Ta.httpStatus:-1}`)};this.$=O.$;this.addinUICommandHandler=O;this.appName=vd.AFrameworkApplication.fa.Xa("WebAppShortName")||"Excel";this.qOg=vd.AFrameworkApplication.fa.rd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static DVa(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}Ldj(O){this.$C=O;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.tTi,!0),window.addEventListener("DismissCallout",this.uOi,!0),window.addEventListener("CloseCallout",this.aNi,!0))}wid(O){return"[id="+O+"]"}K9f(O,
Ta){Ta>this.qOg?(window.clearTimeout(this.lUf),this.J9f("[data-unique-id='pivotOverflowButton']"),r.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+O)?this.J9f(O):this.lUf=window.setTimeout(()=>{this.K9f(O,Ta+1)},1E3)}I9f(O){var Ta=document.querySelector("button[data-unique-id='RightPaddle']");if(Ta)O={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}));else if(Ta=document.querySelector("button"+O),!Ta||"none"===window.getComputedStyle(Ta).display)if(Ta=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ta){Ta={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(Ta)}));r.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.p6();return}this.ifg(Ta,"ShowTeachingUIForAddinButton")}J9f(O){O=document.querySelector("button"+O);if(!O&&(O=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!O)){O={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}));r.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.p6();return}this.ifg(O,"ShowTeachingUIForAddinTab")}ifg(O,Ta){O.setAttribute("lpp-id","latestAddin");const Gb=Ec.a.instance.Ub("Common.ISystemInitiatedFeedback");Gb&&O?(Gb.execute(hc=>{hc.logActivity(Ta,null)}),O={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)})),r.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(r.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),O={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Qg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)})),this.p6())}UMh(O){if(!O)return null;O=O.jW;if((null===O||void 0===O?0:O.mt)&&0<O.mt.count)for(let Ta of O.mt)if(Ta.groups&&0<Ta.groups.length)for(const Gb of Ta.groups)if(Gb.controls&&0<Gb.controls.length)for(const hc of Gb.controls){if(hc.attributes&&
0===hc.controlType&&hc.enabled)return hc.id;if(hc.menuItems)for(const wc of hc.menuItems)if(wc.attributes&&wc.enabled)return hc.id}return null}qHj(){var O=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(O&&"none"!==window.getComputedStyle(O).display)r.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{O=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==O){O={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Qg.DVa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)}));r.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.p6();return}r.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ta=Ec.a.instance.Ub("Common.ISystemInitiatedFeedback");null==
Ta||null==O?(O={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Qg.DVa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)})),r.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.p6()):(Ta.execute(Gb=>{Gb.logActivity("ShowTeachingUIForContentAddin",null)}),O={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Qg.DVa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj(O)})),r.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}B7(O){const Ta={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=O;Ta[this.appName]=Ef.c(Gb);this.Pob=new dg(this.appName,null,null,
this.yW),this.Pob.y3a(Ta),r.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}p6(){if(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.XRa){const O=window.g_roamingAddinList;O&&(this.B7(O),this.XRa=!0)}}}Object(d.a)(Qg,"AddinTeachingCalloutHandler",null,[]);var Ih=a(1235),Qi=a(423),Zh=a(11),$h=a(184),ai=a(43),Ag=a(21),jh=a(55);class bi{constructor(O,
Ta,Gb,hc,wc,$c,hd=null){this.disposed=!1;this.ILi=(md,Bd)=>{if(Bd)if(Bd)if(md=Bd.qk){if(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CheckIsDeepLinkTemplateFile",!1)&&(zg()||Jg())){const Pe=this.$.ea.workbookContext.WebExtensions;if(Pe){let Ue=!1;for(var Qd of Pe)if(Qd.PrimaryMarketplace.SolutionId.toLowerCase()===md.solutionId.toLowerCase()){Ue=!0;break}if(!Ue){r.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{r.ULS.sendTraceTag(512258443,
220,15,"Has no add-in persisted in the file.");return}}Bd=Bd.Ro;Qd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(md.solutionId in Qd)Bd=Qd[md.solutionId];else if(Bd=this.KQh(Bd),void 0===Bd||null===Bd){r.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Qd=new xh.a(me.a.P2,0,0,2,null);this.executeCommand(0,Qd,{["SourceControlId"]:Bd},null);md.isAutoLaunched=!0}else r.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else r.ULS.sendTraceTag(528098436,
220,15,"agaveParams is null");else r.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.jff=(md,Bd)=>{"Insert"==Bd.tabName&&(md=this.$.Ja,null!=md&&(md.iWf(this.jff),r.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.fPb.qHj())};this.sTi=(md,Bd)=>{md=null;Bd&&(md=Bd);(null===md||void 0===md?0:md.Ro)&&this.ayj(md.Ro);this.$.df();z.EwaSettings.ma(86)&&md&&md.qk&&this.ITg(md.qk)};this.$=O;r.ULS.shipAssertTag(537170659,0,!(void 0===Ta||null===Ta),
`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${ai.a.L3()}`);this.je=Ta;this.cGe=Gb;this.F0b=hc;this.kha=wc;this.Nob=$c;this.ap=new Yh.a;this.jha=new nd;this.Ybd=hd;he.a.kzb=he.a.HVe;this.Z7c=new n.a;this.z2a=new n.a}dispose(){void 0!==this.Nob&&null!==this.Nob&&(this.Nob.dispose(),this.Nob=null);this.je=this.$=null;this.disposed=!0}jCj(O,Ta){switch(O){case me.a.P2:O=this.UBj(Ta);break;default:O=!1}return O}nc(){return!1}executeCommand(O,Ta,Gb){O=Vf.TaskExtensions.Uj();
Ta=Ta.command;switch(Ta){case 843847158:break;case -2025863019:Ob.a.RUd(Gb[Md.a.OXc].toString(),()=>{Ag.h(this.$).focus()});break;case -1777565636:Ih.a.showUILessDialog(Gb[Md.a.Oob].toString());this.je.jFj(Gb[Md.a.Oob].toString());break;case 1592314317:Ih.a.hideUILessDialog(Gb[Md.a.Oob].toString());this.je.tai(Gb[Md.a.Oob].toString());break;case me.a.P2:O=this.Akd(Gb);break;case me.a.kDb:this.lDb(Gb);break;case me.a.Cna:this.Cna(Gb);break;case me.a.SUd:this.Nob.Xzc();break;case me.a.refreshAddinCommands:this.Ebj();
break;case 1949669462:this.kha.H3f(!0);break;case -1014260128:O=this.executeDynamicAddInCommandsAPI(Gb);break;default:O=$h.a(Ta)}return O}wc(O,Ta){O=!1;switch(Ta.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case me.a.Cna:case me.a.SUd:case me.a.refreshAddinCommands:case 1949669462:case me.a.kDb:case -1014260128:O=!0;break;case me.a.P2:O=!vd.AFrameworkApplication.protectedFile}return O}Kc(){return!1}KQh(O){if(!O)return r.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),
null;if((O=O.jW)&&O.mt&&0<O.mt.count)for(let Ta of O.mt){if(Ta.groups&&1===Ta.groups.length){O=Ta.groups[0];if(O.controls&&1===O.controls.length){const Gb=O.controls[0];if(Gb.attributes&&!Gb.controlType&&Gb.enabled)return Gb.id}O.controls&&r.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ta.groups&&r.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}Ebj(){if(this.kha.vwd()){this.kha.FCe();var O=this.jfd();if(O&&0<O.count)for(let Ta of O)O={[Md.a.W2]:Ta,[Md.a.BM]:4,
[Md.a.RGa]:(new Date).getTime()},this.Cna(O)}}Cna(O){r.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${O[Md.a.BM]}, DataProvider ${O[Md.a.W2]}.`);this.kha.nuj();window.setTimeout(()=>{if(void 0===this.je||null===this.je)r.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${ai.a.L3()}`);else{const Ta=new mf(new ma(this.je.Yh),sb.instance,Hd.instance);Ta.pKg((Gb,
hc)=>{this.lDb(hc.properties)});vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Ta.HNg((Gb,hc)=>{null==hc?we.a.sendTelemetryEvent(Object(dd.a)(new Jf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:xa.a.Zj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})})):(this.fPb=new Qg(this),this.fPb.Ldj(hc),Gb=this.$.Ja,null!=Gb&&(Gb.rse(this.jff),r.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ta.NTj(O)}},0)}lDb(O){if(!this.disposed){r.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${O[Md.a.BM]}.`);try{if(z.EwaSettings.ma(183)){const Gb=O[Md.a.Kob];if(Gb&&0<Gb.count){const hc=Gb.count;for(let wc=hc-1;0<=wc;wc--){const $c=Gb.na(wc);OSF.OsfControl.isFirstPartyStoreString($c.storeType)||
Gb.remove(Gb.na(wc))}if(Gb.count<hc){const wc=wg.GetServiceTaskFactory.Oa(this.$.da,5,4,0);Vf.TaskExtensions.za(wc,()=>{wc.result.ng(36,null)},this.$.ka,3)}if(!Gb.count)return}}if(void 0===this.je||null===this.je)r.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${ai.a.L3()}`);else{var Ta=null;Ta=vd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new ad(this.ap,this.cGe,new ma(this.je.Yh),new ug(this.$.Eb,me.a.P2),this.kha,
sb.instance,this.jha,(Gb,hc)=>{const wc={};wc.InstanceId=Ba.a.create().toString();wc.PrimaryMarketplace={};wc.PrimaryMarketplace.SolutionId=Gb.solutionId;wc.PrimaryMarketplace.SolutionVersion=Gb.version;wc.PrimaryMarketplace.MarketplaceType=Gb.storeType;wc.PrimaryMarketplace.MarketplaceRef=Gb.storeId;wc.WebExtensionType=1;this.je.wHj(wc,()=>{hc(Gb)})}):new ad(this.ap,this.cGe,new ma(this.je.Yh),new ug(this.$.Eb,me.a.P2),this.kha,sb.instance,this.jha);Ta.xKg(this.ILi);Ta.qKg(this.sTi);if(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Gb=new Qg(this);Ta.hMg(Gb.rTi);Ta.GNg(Gb.WEj)}this.$.da.Aa(53).Em&&pc.a.get_instance().$j(5,null).continueWith(()=>{this.disposed||Ta.Uwi(this.Ybd,this.$.domElement,O)})}}catch(Gb){r.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Gb.message}.`)}}}Akd(O){const Ta=Vf.TaskExtensions.Uj();O=O[this.ap.nia];const Gb=this.F0b.AVc(O),hc=new Ih.a(this.$,this.je,Gb.ownerAddinInfo,Ta);return this.G9e(Ta,O,Gb,hc)}G9e(O,Ta,Gb,hc){this.F0b.Akd(Ta,this.kha,hc,new ma(this.je.Yh),
Gb,()=>{O=hc.a8g()},()=>{Ag.h(this.$).focus()});return O}ITg(O){const Ta=Vf.TaskExtensions.Uj();var Gb=this.je.Jaa(O.solutionId);if(Gb){var hc=this.je.KZ(Gb);if(Zh.HelperMethods.Gw(hc)&&0!==hc.SharedRuntime.State)return}hc=this.F0b.JTg;const wc=O.solutionId in hc?hc[O.solutionId]:null;if(wc){const $c=this.F0b.AVc(wc),hd=new Ih.a(this.$,this.je,$c.ownerAddinInfo,Ta),md=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,null!==$c.ownerAddinInfo?$c.ownerAddinInfo.storeType:O.storeType,O.assetId,
null,null,O.storeId);hc=Bd=>{if(Bd){const Qd={};for(const Pe of Bd)Qd[Pe[0]]=Pe[1];(Bd=Md.a.Ase in Qd?Qd[Md.a.Ase]:null)&&"true"===Bd.toLowerCase()&&(r.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${O.storeType}, StoreId ${O.storeId}, SolutionId ${md}.`),this.G9e(Ta,wc,$c,hd))}};r.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${O.storeType}, StoreId ${O.storeId}, SolutionId ${md}.`);if(Gb)hc(this.je.KZ(Gb).OsfPropertyBag);else if(Gb=
this.$.ea.workbookContext.WebExtensions)for(const Bd of Gb)if((1===Bd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===O.targetType&&Bd.PrimaryMarketplace.MarketplaceType.toLowerCase()===O.storeType.toLowerCase()&&Bd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===O.storeId.toLowerCase()&&Bd.PrimaryMarketplace.SolutionId.toLowerCase()===O.solutionId.toLowerCase()){hc(Bd.OsfPropertyBag);break}}}tYd(O,Ta,Gb=!1){O&&(!Gb||Ta||this.Z7c.contains(O)||this.Z7c.add(O),(Gb=
this.z2a.contains(O))&&Ta&&this.z2a.remove(O),Gb||Ta||this.z2a.add(O))}ayj(O){if((O=O.jW)&&O.mt)for(let Ta of O.mt)if(Ta.groups)for(const Gb of Ta.groups)if(Gb.controls)for(const hc of Gb.controls)if(this.tYd(hc.id,hc.enabled,!0),1===hc.controlType&&hc.menuItems)for(const wc of hc.menuItems)this.tYd(wc.id,wc.enabled,!0)}jfd(){const O=new n.a;z.EwaSettings.ma(52)&&(this.$.ea.Yg.get(27)&&(O.add(0),O.add(16)),this.$.ea.Yg.get(33)&&O.add(1),O.add(8));return O}executeDynamicAddInCommandsAPI(O){let Ta=
!0;if(void 0===O||null===O||void 0===O[Md.a.qub]||null===O[Md.a.qub])return jh.Task.Ta(!1);switch(O[Md.a.qub]){case 1:Ta=this.WWj(O);break;case 2:Ta=this.eyj(O);break;case 4:this.z2a.clear();this.z2a.addRange(this.Z7c);break;case 3:Ta=this.installContextualTab(O);break;default:Ta=!1}return jh.Task.Ta(Ta)}UBj(O){return O&&this.ap.nia in O?(O=O[this.ap.nia])?this.z2a.contains(O):!1:!1}WWj(O){var Ta=null;let Gb=null,hc=null,wc=!0;void 0!==O[Md.a.h4]&&null!==O[Md.a.h4]&&void 0!==O[this.ap.nia]&&null!==
O[this.ap.nia]&&void 0!==O[Md.a.g4]&&null!==O[Md.a.g4]&&(Ta=O[Md.a.h4],Gb=O[Md.a.f9b],hc=O[this.ap.nia],wc=O[Md.a.g4]);if(!Ta||!hc)return r.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;O=(new Ve.a(this.$.Eb,Ta,this.ap,!0)).aLa(hc);Ta={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ta.AssetId=Gb;Ta.MaskedTabId=O;Ta.IsToEnable=wc;r.ULS.sendTraceTag(537170648,220,50,y.a.hc(Ta));this.tYd(O,wc);Qi.a.BC.updateCommandUI();return!0}eyj(O){var Ta,
Gb,hc=null,wc=null;let $c=null;var hd=null;let md=!0;void 0!==O[Md.a.z9c]&&null!==O[Md.a.z9c]&&void 0!==O[Md.a.h4]&&null!==O[Md.a.h4]&&void 0!==O[this.ap.nia]&&null!==O[this.ap.nia]&&void 0!==O[Md.a.g4]&&null!==O[Md.a.g4]&&(hc=O[Md.a.z9c],wc=O[Md.a.h4],$c=O[Md.a.f9b],hd=O[this.ap.nia],md=O[Md.a.g4]);if(!hc||!wc||!hd)return r.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;O=(new Ve.a(this.$.Eb,wc,this.ap,!0)).S7e(hd);hd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
hd.StoreType=hc;hd.AssetId=$c;hd.MaskedTabId=O;hd.IsToShow=md;r.ULS.sendTraceTag(537170646,220,15,y.a.hc(hd));hc=this.kha.kja(hc,wc,1);wc=!1;if(null===(Gb=null===(Ta=null===hc||void 0===hc?void 0:hc.Ro)||void 0===Ta?void 0:Ta.jW)||void 0===Gb?0:Gb.mt)for(let Bd of hc.Ro.jW.mt)if(Bd.id===O){wc=!0;break}if(!wc)return r.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ta=[];md?appChrome.selectors.getSelectedTabId()!==O&&Ta.push(appChrome.actions.activateRibbonTab(O)):
(appChrome.selectors.getSelectedTabId()===O&&Ta.push(appChrome.actions.setCurrentTab(Jd.a.JW)),Ta.push(appChrome.actions.deactivateRibbonTab(O)));appChrome.api.dispatch(Ta);return!0}installContextualTab(O){let Ta=null,Gb=null,hc=null;var wc=null;if(void 0!==O[Md.a.h4]&&null!==O[Md.a.h4]&&void 0!==O[Md.a.g4]&&null!==O[Md.a.g4]){const $c=O[Md.a.g4];Ta=O[Md.a.h4];void 0!==$c[Md.a.EJa]&&null!==$c[Md.a.EJa]&&void 0!==$c[Md.a.FJa]&&null!==$c[Md.a.FJa]&&(Gb=$c[Md.a.EJa],hc=$c[Md.a.FJa],wc=$c[Md.a.A9c])}if(!(Ta&&
hc&&Gb&&wc))return r.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;O=this.kha.kja(wc.PrimaryMarketplace.MarketplaceType,wc.PrimaryMarketplace.SolutionId,1);if(null===O||void 0===O?0:O.Ro)return r.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;O={};O.solutionId=wc.PrimaryMarketplace.SolutionId;O.version=wc.PrimaryMarketplace.SolutionVersion;O.storeType=wc.PrimaryMarketplace.MarketplaceType;O.storeId=wc.PrimaryMarketplace.MarketplaceRef;
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?wc.AssetMarketplace?(O.assetId=wc.AssetMarketplace.SolutionId,O.assetStoreId=wc.AssetMarketplace.MarketplaceRef):(O.assetId=null,O.assetStoreId=null):(O.assetId=wc.PrimaryMarketplace.SolutionId,O.assetStoreId=wc.PrimaryMarketplace.MarketplaceRef);O.targetType=wc.WebExtensionOsfControlType;O.width=wc.TaskpaneWidth;O.height=0;O.isAddinCommands=!0;wc=new n.a;wc.add(O);O={};O[Md.a.Kob]=wc;O[Md.a.BM]=6;O[Md.a.EJa]=Gb;
O[Md.a.FJa]=hc;this.lDb(O);return!0}}Object(d.a)(bi,"AddinUICommandHandler",null,[715,208,2]);var qi=a(63),ri=a(601),Ri=a(18),Si=a(16);class Bh extends yd.a{constructor(O){super(O);this.handler=null;this.$Fg=()=>{r.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.qd&16384)}]`);const Ta=new ld.a;this.$.da.$a(53,Qd=>{r.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Ta.setResult(Qd)});const Gb=Ta.task,hc=new Cd,wc=de.a.getInstance(),$c=new Td(this.$,wc),hd=wg.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Ya),md=this.ncj(hc),Bd=wg.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya);return Vf.TaskExtensions.za(Vf.TaskExtensions.Ed([Gb,hd,md,Bd],this.ka),()=>{r.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Vf.TaskExtensions.za(wg.GetServiceTaskFactory.create(this.$.da,106,this.ka,
this.Ya),Qd=>{this.handler=new bi(this.$,Qd.result,hc,new qc,wc,$c,Ec.a.instance.Lh("Common.IExternalUICommandDefinitionMapping"));r.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Zc([this.handler]);this.$.da.Ga(198,this.handler)},this.ka,3)},this.ka,3)};this.qih=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ja.ucb(this.handler),this.$.da.GU(198),this.handler=null):r.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
this.$.da.GU(204);Si.a(Ri.a,20,this.$.da,198)}}ld(){r.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");qi.a(this.$).add(Object(dd.a)(new ri.a,{fzc:()=>{const O=this.$.ea.eI&&this.$.ea.Zb&&!!(this.$.qd&16384)&&this.$.isEditMode;this.$.ea.Zb&&r.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${O}] IsSessionFullyLoaded [${this.$.ea.eI}] IsSessionActive [${this.$.ea.Zb}] ShowCommandUI [${!!(this.$.qd&
16384)}] IsEditMode [${this.$.isEditMode}]`);return O},SZb:this.$Fg,v7b:this.qih,E3a:2}))}ncj(O){const Ta=wg.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya);return Vf.TaskExtensions.za(Ta,()=>{r.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new Je(Ta.result,O))},this.ka,3)}static la(O){yd.a.Nd(199,new Bh(O))}}Object(d.a)(Bh,"AddinUICommandHandlerFactory",yd.a,[]);var dh=a(1193),
si=a(1196),Nh=a(697);class nh extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){let O;if(z.EwaSettings.ma(395)){const Ta=wg.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,this.Ya),Gb=wg.GetServiceTaskFactory.create(this.$.da,396,this.$.ka,this.Ya);Vf.TaskExtensions.za(jh.Task.jJ(Ta,Gb),()=>{this.nb(Object(Nh.a)(this.$.da,278,()=>new dh.CustomFunctionsInstaller(this.$,Ta.result,Gb.result)))},this.$.ka,3)}else O=Object(Nh.a)(this.$.da,278,()=>new si.CustomFunctionsLegacyInstaller(this.$)),
this.nb(O)}static la(O){O.da.Ga(279,new nh(O))}}Object(d.a)(nh,"CustomFunctionsInstallerFactory",h.a,[]);var ci=a(89),oh=a(47),Fi=a(46);class di{constructor(O,Ta){this.VQa=this.WQa=null;this.lfg=(Gb,hc)=>{let wc=null,$c=null,hd=null;hc?(Object(U.a)(450,hc)?(wc=hc.YGa,hd=hc.instanceId):Object(U.a)(288,hc)&&(wc=hc.get_element(),hd=hc.instanceId),wc)?($c=Object(Z.a)(708,Gb),$c)?this.ORf(hd,wc,$c)||hd in this.VQa||(this.WQa[hd]=0,this.VQa[hd]=oh.a.instance.cD(()=>{10<=this.WQa[hd]||this.ORf(hd,wc,$c)?
(delete this.WQa[hd],this.VQa[hd].dispose(),delete this.VQa[hd]):this.WQa[hd]+=1},500,Fi.a.bPg,!0,!1)):r.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):r.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):r.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=O;this.$=Ta;this.EZc=!1;this.$.da.Ga(224,this)}la(O){this.EZc?r.ULS.sendTraceTag(537170629,0,
10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.EZc=!0,this.VQa={},this.WQa={},O?O.aLg(this.lfg):r.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(O){if(O){O.xgj(this.lfg);O=this.VQa;for(let Ta in O)ci.a.Ia(O[Ta]);this.WQa=this.VQa=null;this.EZc=!1}else r.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}ORf(O,Ta,Gb){if(this.zji(Gb,O))return!1;
O=Ta.querySelector("iframe");if(!O)return r.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;O=O.title;if(!O||!O.length)return r.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(O);return!0}zji(O,Ta){return(O=O.Yh.getOsfControl(Ta))?O.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(di,"AgaveOnSelectedReadoutHandler",null,[709]);
class Vc extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){const O=this.$.da;Vf.TaskExtensions.za(wg.GetServiceTaskFactory.Oa(O,211,212,this.Ya),Ta=>{Ta=O.Aa(224)||new di(Ta.result,this.$);this.nb(Ta)},this.ka,3)}static la(O){O.da.Ga(225,new Vc(O))}}Object(d.a)(Vc,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var Ad=a(736),Rg=a(52);const Gi=(O,Ta)=>Rg.a.rwd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,vd.AFrameworkApplication.fa.rd("MaxRetriesForLoadingScript",
0),O,Ta);var ti=a(240);class ei{constructor(O,Ta,Gb){this.iframe=O;this.onSuccess=Ta;this.onError=Gb;$addHandler(window,"message",Object(Yd.a)(this,this.Q$e,"handleResponse"))}Q$e(O){try{if(O&&O.rawEvent&&O.rawEvent.origin&&this.iframe&&this.iframe.id){var Ta=this.tLf(O.rawEvent.origin);const Gb=this.tLf(document.domain);if(Q.a.ak().equals(Gb,Ta))if(O.rawEvent.source&&O.rawEvent.source.frameElement&&O.rawEvent.source.frameElement.id&&Q.a.ak().equals(O.rawEvent.source.frameElement.id,this.iframe.id)){Ta=
null;try{Ta=JSON.parse(O.rawEvent.data)}catch(hc){r.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",hc.message)}Ta?(Ta.statusCode!==ti.a.nP||void 0!==Ta.error&&Ta.error?(r.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ta.statusCode,Ta.error),this.onError()):(r.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(Ta.authorizationCode?Ta.authorizationCode:Ta.signInUrl)),$removeHandler(window,"message",Object(Yd.a)(this,this.Q$e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):r.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):r.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):r.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else r.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else r.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else r.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Gb){r.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Gb.message)}}tLf(O){let Ta=
"";try{O&&(Ta=-1<O.indexOf("//")?O.split("/")[2]:O.split("/")[0])&&(Ta=Ta.split(":")[0],Ta=Ta.split("?")[0])}catch(Gb){r.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Gb.message)}return Ta}static la(O,Ta,Gb){new ei(O,Ta,Gb)}}Object(d.a)(ei,"ResponseHandler",null,[]);var Hi=a(252);class eh{constructor(O){this.iGa=O}tryAuthenticate(O,Ta){this.ebb(eh.Swg,()=>{O()},Ta)}tryAuthorize(O,Ta){this.ebb(eh.Yrg,O,Ta)}getSignInUrl(O,Ta){this.ebb(eh.Rke,O,Ta)}signOut(O,Ta){this.ebb(eh.RCg,
O,Ta)}ebb(O,Ta,Gb){var hc=new Hi.QueryStringBuilder("AuthenticationProxyHandler.aspx");hc.qj("responseType",O);vd.AFrameworkApplication.tZa(hc);hc=String.format("{0}{1}&{2}",this.iGa,hc.toString(),vd.AFrameworkApplication.Hi);const wc=document.createElement("iframe");wc.setAttribute("id","privateCatalogIframe");wc.setAttribute("name","privateCatalogIframe");wc.setAttribute("style","display: none");Q.a.ak().equals(O,eh.Rke)||wc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
ei.la(wc,Ta,Gb);wc.setAttribute("src",hc);document.body.appendChild(wc)}}eh.Yrg="authcode";eh.Swg="identitytoken";eh.Rke="signinurl";eh.RCg="signout";Object(d.a)(eh,"AuthenticationProxy",null,[]);class sg{}sg.getUserId="getUserId";sg.getLastStoreUpdate="laststoreupdate";sg.getEntitlement="getEntitlements";sg.getEToken="getEToken";sg.getManifest="getManifest";sg.getAppState="getAppState";sg.getKilledApps="getRemovedAddins";sg.getAppDetails="getAppDetails";sg.removeApps="removeAddin";sg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";sg.getPrivateCatalogAddIns="getAddIns";sg.getPrivateCatalogManifests="getAppManifests";sg.isStoreDisabled="isStoreDisabled";Object(d.a)(sg,"S2SWebRequestActions",null,[]);var Ii=a(576);class ph{getUserId(O,Ta){const Gb=new n.a;Gb.add(new Ld.a("corr",O));this.iX(sg.getUserId,Gb,1,Ta)}getLastStoreUpdate(O,Ta,Gb){const hc=new n.a;hc.add(new Ld.a("lc",O));hc.add(new Ld.a("corr",Ta));this.iX(sg.getLastStoreUpdate,hc,1,Gb)}getEntitlement(O,Ta,Gb,hc){O=new n.a;O.add(new Ld.a("av",
Ta));O.add(new Ld.a("corr",Gb));this.iX(sg.getEntitlement,O,1,hc)}getEToken(O,Ta,Gb,hc,wc,$c){const hd=new n.a;hd.add(new Ld.a("cmu",O));hd.add(new Ld.a("cmf",Ta));hd.add(new Ld.a("assetid",Gb));hd.add(new Ld.a("expver",hc));hd.add(new Ld.a("corr",wc));this.iX(sg.getEToken,hd,1,$c)}getManifest(O,Ta,Gb,hc){const wc=new n.a;wc.add(new Ld.a("cmu",O));wc.add(new Ld.a("assetid",Ta));wc.add(new Ld.a("corr",Gb));this.iX(sg.getManifest,wc,1,hc)}getAppState(O,Ta,Gb){const hc=new n.a;hc.add(new Ld.a("ma",O));
hc.add(new Ld.a("corr",Ta));this.iX(sg.getAppState,hc,1,Gb)}getKilledApps(O,Ta){const Gb=new n.a;Gb.add(new Ld.a("corr",O));this.iX(sg.getKilledApps,Gb,1,Ta)}getAppDetails(O,Ta,Gb,hc){const wc=new n.a;wc.add(new Ld.a("cmo",O));wc.add(new Ld.a("corr",Gb));this.sendWithBody(sg.getAppDetails,wc,Ta,2,hc,!1)}removeApps(O,Ta,Gb){const hc=new n.a;hc.add(new Ld.a("corr",Ta));this.sendWithBody(sg.removeApps,hc,O,2,Gb,!1)}getLastPrivateCatalogUpdate(O,Ta,Gb,hc,wc,$c){const hd=new n.a;hd.add(new Ld.a("catalog",
"privatecatalog"));hd.add(new Ld.a("clientCode",O));hd.add(new Ld.a("clientVersion",Ta));hd.add(new Ld.a("corr",wc));O=String.format("authorizationCode={0}&refreshToken={1}",Gb?lg.a.mf(Gb):"",hc?lg.a.mf(hc):"");this.sendWithBody(sg.getLastPrivateCatalogUpdate,hd,O,2,$c,!0)}getPrivateCatalogAddIns(O,Ta,Gb,hc,wc,$c){const hd=new n.a;hd.add(new Ld.a("catalog","privatecatalog"));hd.add(new Ld.a("clientCode",O));hd.add(new Ld.a("clientVersion",Ta));hd.add(new Ld.a("corr",wc));O=String.format("authorizationCode={0}&refreshToken={1}",
Gb?lg.a.mf(Gb):"",hc?lg.a.mf(hc):"");this.sendWithBody(sg.getPrivateCatalogAddIns,hd,O,2,$c,!0)}getPrivateCatalogManifests(O,Ta,Gb,hc,wc){const $c=new n.a;$c.add(new Ld.a("catalog","privatecatalog"));$c.add(new Ld.a("corr",hc));O=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",lg.a.mf(O),Ta?lg.a.mf(Ta):"",Gb?lg.a.mf(Gb):"");this.sendWithBody(sg.getPrivateCatalogManifests,$c,O,2,wc,!0)}isStoreDisabled(O,Ta){const Gb=new n.a;Gb.add(new Ld.a("corr",O));this.iX(sg.isStoreDisabled,
Gb,2,Ta)}iX(O,Ta,Gb,hc){this.sendWithBody(O,Ta,null,Gb,hc,!1)}sendWithBody(O,Ta,Gb,hc,wc,$c){const hd=new Hi.QueryStringBuilder("AddinServiceHandler.ashx");hd.qj("action",O);hd.qj("app",Ii.a[vd.AFrameworkApplication.ta.Pa.Hj]);for(let md of Ta)hd.qj(md.key,md.value);Ta=String.format("{0}{1}&{2}",vd.AFrameworkApplication.ta.Pa.d0,hd.toString(),vd.AFrameworkApplication.Hi);vd.AFrameworkApplication.zd.Pm(Ta,hc,Gb,null,!1,2,md=>{let Bd=null,Qd=null;md&&md.data&&(md.data.responseHeaders["X-BlockedForMinor"]&&
"1"===md.data.responseHeaders["X-BlockedForMinor"].toString()&&(md.data.httpStatus=451),Bd=md.data.ve,Qd=md.data.responseHeaders);wc(md.data.httpStatus,Bd,Qd)},md=>{var Bd=null;let Qd=null;$c&&md&&md.data&&md.data.ve&&(Bd=md.data.ve,Qd=md.data.responseHeaders);wc(md.data.httpStatus,Bd,Qd);if(vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Bd={message:"AddinServiceHandler request failed"};Bd.code=md.data.httpStatus;Bd.action=O;
if(md.data.request||md.data.request.get_headers())Bd["X-UserSessionId"]=md.data.request.get_headers()["X-UserSessionId"];408===md.data.httpStatus||503===md.data.httpStatus?r.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Bd)):r.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Bd))}else r.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",md.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+O,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(ph,"S2SWebRequestManager",
null,[]);class fi extends h.a{constructor(O){super();this.NRf=this.ddaFacade=null;this.$=O;O.da.Ga(106,this);this.Fb()}get je(){return this.ddaFacade||(this.ddaFacade=new Ad.DdaFacade(this.$,this.NRf))}create(){r.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");vd.AFrameworkApplication.disableWholeAppsForOfficeFeature?r.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${vd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
z.EwaSettings.ma(399)?Ec.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>{O.isFeatureEnabled("mso_officeStore",!0).then(Ta=>{Ad.DdaFacade.B5b=Ta;this.iIe();return null})}):this.iIe()}iIe(){const O=wg.GetServiceTaskFactory.Oa(this.$.da,224,225,this.Ya),Ta=Rg.a.rwd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.va.MaxRetriesForLoadingScript,this.$.ka,this.Ya,106),Gb=Gi(this.ka,this.Ya);Vf.TaskExtensions.za(Vf.TaskExtensions.Ed([O,Ta,Gb],this.$.ka),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?r.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${ai.a.L3()}`):this.Zdi();r.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.NRf=O.result;this.nb(this.je);r.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}Zdi(){z.EwaSettings.ma(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new ph);
this.$.ie.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new ph,new eh(vd.AFrameworkApplication.fa.appSettings.WebServiceBase),z.EwaSettings.ma(70),z.EwaSettings.ma(425));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new ph);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new ph)}dispose(){ci.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(O){new fi(O)}}Object(d.a)(fi,"DdaFacadeServiceFactory",
h.a,[]);var gi=a(462);class Ji{constructor(O,Ta,Gb,hc,wc,$c){this.$=O;this.agaveCommandManager=$c}Kc(){return!1}nc(){return!1}wc(O,Ta,Gb,hc){let wc=!1;switch(Ta.command){case -684355545:wc=!0;break;case -741808261:wc=!!Gb;break;case -859308420:wc=!!hc&&1===hc.mz;break;case 418618014:wc=1===O&&!!hc&&1===hc.mz;break;case -515602470:Ta=z.EwaSettings.ma(231)&&2===O;wc=(1===O||Ta)&&!!hc&&1===hc.mz;break;case 2086613372:wc=z.EwaSettings.ma(231)&&2===O&&!!hc&&1===hc.mz;break;case -1336341324:wc=z.EwaSettings.ma(473)&&
1===O&&!!hc&&1===hc.mz;break;case 451940422:wc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===O&&!!hc&&1===hc.mz;break;case -1444574190:case -336193495:wc=1===O&&!!hc&&1===hc.mz;break;case 1296389134:wc=1===O&&!!hc&&1===hc.mz;break;case -1473679467:wc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===O&&!!hc&&1===hc.mz;break;case 1221897806:wc=z.EwaSettings.ma(163)&&2===O;break;case 1172793074:case 1930653487:wc=
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===O;break;case -1753056834:wc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:wc=!0;break;case 301511274:wc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:wc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:wc=this.$.isEditMode&&
this.$.ea.iNb}return wc}executeCommand(O,Ta,Gb){let hc=Vf.TaskExtensions.Uj();const wc=Ta.command;switch(Ta.command){case -1473679467:gi.a(this.$,488,489,1,$c=>{hc=$c.Wgi(Gb.SourceControlId,Ta)});break;case 1296389134:this.agaveCommandManager.wKj(Gb.SourceControlId,Gb.LabelText);break;case -684355545:this.agaveCommandManager.a1c();break;case -741808261:hc=this.agaveCommandManager.insertAgave(Gb,Ta);gi.a(this.$,488,489,1,$c=>{$c.CGg(Gb)});break;case -1336341324:z.EwaSettings.ma(473)&&(hc=this.agaveCommandManager.Pkd(Gb,
O,Ta));break;case 1172793074:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(hc=this.agaveCommandManager.Pkd(Gb,O,Ta));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:hc=this.agaveCommandManager.Pkd(Gb,O,Ta);break;default:hc=$h.a(wc)}return hc}}Object(d.a)(Ji,"AgaveCommandHandler",null,
[208]);class Jh{}Object(d.a)(Jh,"Selection",null,[]);var hi=a(1304),Kh=a(1303),og=a(1305),xg=a(1394),ui=a(1306);class yh{}Object(d.a)(yh,"SmartLookupApplicationInterface",null,[]);class Ki{}Object(d.a)(Ki,"ApplicationProperties",null,[]);class ii{}Object(d.a)(ii,"EnterpriseUserInfo",null,[]);class zh{}Object(d.a)(zh,"FeatureGates",null,[]);class ji{constructor(O,Ta,Gb=!0){this.xQj=9E5;this.AQj=3E5;this.Vxd=null;this.Tsf="";this.Sxd=0;this.wtb=Date.now;this.uya=O;this.K9a=Ta;Gb&&this.gfd()}R1h(){const O=
this.wtb();if(O<this.Sxd+this.xQj)return O>this.Sxd+this.AQj&&this.gfd(),this.Tsf;this.gfd();return""}gfd(){this.Vxd=this.Vxd||new Promise(O=>{this.S1h().then(Ta=>{this.Tsf=Ta;this.Sxd=this.wtb();this.Vxd=null;O(Ta)})})}S1h(){return this.K9a&&this.K9a.length?new Promise(O=>{this.uya.UL("SmartLookup",this.K9a).then(Ta=>{Ta.IsSuccess?Ta.Token||(O(""),r.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(r.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Ta.ErrorCode+": "+Ta.ErrorMessage),O(""));O(Ta.Token)}).catch(Ta=>{Ta=Ef.c(Ta);r.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ta);O("")})}):(r.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(ji,"SmartLookupAuthenticationManager",null,[762]);class kf{static RSh(){switch(Object(Z.a)(String,vd.AFrameworkApplication.Qb.AudienceGroup)||""){case "Dogfood":if(vd.AFrameworkApplication.fa){let O=
vd.AFrameworkApplication.fa.Xa("UserPrincipalName");O=lg.a.vl(O);const Ta=vd.AFrameworkApplication.fa.aq("SmartLookupINTEnabledForSKITeam")?vd.AFrameworkApplication.fa.Cw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ta,O)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static q1h(){switch(vd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":vd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":vd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?
"INT":kf.RSh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(kf,"Utils",null,[]);var Ch=a(557),Sg=a(171);class Bg{constructor(O){r.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.ztf=vd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.DCi=vd.AFrameworkApplication.fa.Xa("SmartLookupApprovedOriginPattern");this.K9a=vd.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint");this.hDi=hg.a.lN(vd.AFrameworkApplication.fa.Xa("AppCatalogUrl")||"");this.J9a=new zh;this.J9a.EnableAllTabV2=!0;this.J9a.EnableIntentService=!0;this.J9a.EnableInDocumentSearch=vd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.J9a.EnableLocalSearch=vd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.J9a.IntentServiceEndpoint=
kf.q1h();this.cDi=new ji(O,this.K9a)}get approvedOriginPattern(){return this.DCi}wNh(){return Promise.resolve(this.xNh())}xNh(){const O=new Ki;O.anid="";O.applicationVersion=vd.AFrameworkApplication.buildVersion;O.appCorrelationId=Sg.a.create().toString();O.themePlatform=Bg.w2j;O.lcid=vd.AFrameworkApplication.lcid;O.launchUtcTime=(new Date).toUTCString();O.featureGates=this.J9a;var Ta=Ch.a.uK(vd.AFrameworkApplication.lcid);Ta=Ta?Ta.name:null;O.market=this.occ(Ta);O.uiLanguage=Ta;O.sessionId=vd.AFrameworkApplication.userSessionId;
O.themeId=0;O.parentalControl=Bg.U0i;const Gb=new ii;Gb.CountryCode=this.occ(Ta);Gb.ServiceEndpoint=this.K9a;Gb.IsGoLocal=!1;Gb.IsEnabled=this.ztf;Gb.IsEnterpriseEnabled=this.ztf;Gb.TenantRoot=this.hDi;O.enterpriseUserInfo=Gb;O.accessToken=this.cDi.R1h();return O}occ(O){O=O.split("-");return O[O.length-1]}}Bg.w2j="web";Bg.U0i="yes";Object(d.a)(Bg,"SmartLookupManager",null,[750]);class Cg extends uc.a{constructor(O){super();this.$=O;this.isFirstLaunch=!1}Kc(){return!1}nc(){return!1}wc(O,Ta){O=z.EwaSettings.ma(133);
return-983891024===Ta.command&&O}executeCommand(O,Ta){O=Vf.TaskExtensions.Uj();-983891024===Ta.command&&this.Cwi();return O}Cwi(){var O=new Bg(null);const Ta={};var Gb=Ag.h(this.$).Sb(null).originalText;Gb=Object(dd.a)(new Jh,{neighborhood:Gb,mentionStart:0,mentionLength:Gb?Gb.length:0});const hc=Object(dd.a)(new yh,{selection:Gb,entryPoint:0});O.wNh().then($c=>{$c.applicationName=Cg.appName;$c.isFirstLaunch=this.isFirstLaunch;$c.themeId=5;Ta[Cg.smartLookupApplicationInterface]=JSON.stringify(hc);
Ta[Cg.sQg]=JSON.stringify($c);this.isFirstLaunch=!1});O=new hi.a("ExcelOnline","Web","en-Us");Gb=new Kh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const wc=new og.a;wc.optionalProperties[xg.a.jj]=gd.a.instance.ga(1801);wc.optionalProperties[xg.a.taskPaneWidth]=350;wc.optionalProperties[xg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";wc.Dh=Ta;ui.a.instance.f6(Gb,"Taskpane","SmartLookupSDXTaskpane",O,wc)}}Cg.sQg="AppProperties";Cg.appName="Excel";Cg.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(d.a)(Cg,"SmartLookupCommandHandler",uc.a,[208]);class Oh extends yd.a{constructor(O){super(O)}ld(){gi.a(this.$,374,375,this.Ya,O=>{this.Zc([new Ji(this.$,null,null,null,null,O),new Cg(this.$)])})}static la(O){yd.a.Nd(76,new Oh(O))}}Object(d.a)(Oh,"AgaveCommandHandlerFactory",yd.a,[]);var Ph=a(1319),qh=a(106);class ih{constructor(){this.je=null;this.Kbb=(O,Ta,Gb,hc,wc)=>{if(2===Gb){O=wc?wc:{};Ta=O.callback;Gb=O.refresh?O.refresh:!1;if(!Ta)return 16;vd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=O.storeType?this.je.uPf(Ta,Gb,O.storeType):this.je.uda(Ta,Gb)}return 32};this.kdj=(O,Ta,Gb,hc,wc)=>{2===Gb&&(O=wc?wc.callback:null)&&this.je.$Kg(O);return 32};this.Vgi=(O,Ta,Gb,hc,wc)=>{2===Gb&&this.je.cEd(null,OSF.AgaveHostAction.InsertAgave,wc);return 32}}initialize(O){ih.initialized||(this.je=O,this.Ig(),ih.initialized=!0)}Ig(){vd.AFrameworkApplication.ub.Ne(me.a.Kbb,qh.a.frame,this.Kbb,96);vd.AFrameworkApplication.ub.Nb(me.a.dcj,qh.a.frame,this.kdj);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&vd.AFrameworkApplication.ub.Ne(me.a.gff,qh.a.frame,this.Vgi,96)}static get instance(){ih.Ma||(ih.Ma=new ih);return ih.Ma}}ih.Ma=null;ih.initialized=!1;Object(d.a)(ih,"AgaveCommandActor",null,[]);var Wg=a(1361),ki=a(1308),Qh=a(111),Rh=a(357),Ti=a(354),Ui=a(1239),Hg=a(19),Li=a(349);class vi{constructor(){this.KYd=this.NBc=null;this.vq=0;this.LBc=null}}Object(d.a)(vi,"FirstPartyAddinTaskpaneOverrides",null,[]);class li{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(d.a)(li,"IdeasSelectionContext",null,[]);class wi extends li{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(wi,"IdeasTableSelectionContext",li,[]);class rh{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(rh,"AutoFilterRange",
null,[]);class mi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(mi,"IdeasAutoFilterSource",null,[]);class xi{constructor(O,Ta){this.selection=O;this.tables=Ta}}Object(d.a)(xi,"IdeasXLIMTableBoundaries",null,[]);var Eg=a(60);const Sh=(O,Ta,Gb,hc,wc,$c,hd=null)=>{hd=O.Na(9,hd);hd.sharedInfo=Ta;return Eg.g(O,"ShowAgaveTaskpane",hd,Gb,hc,wc,$c,0)};var Tg=a(859),Fh=a(66),yi=a(132),Dh=a(40),pg=a(374),Gh=a(188),zi=a(162),Vi=a(565),Rf=a(281),sh=a(104),Wi=
a(133),Th=a(51),kh=a(146),$g=a(181);class Ai extends kh.a{constructor(){super();this.sfa="calc(100% - 46px)";this.JDa="15px";this.tfa="0";this.OJc="WACDialogPanel";this.bY=695;this.PJc=462;this.kqa="80%";this.DHc=350;this.Khb="100%";this.Rb=5;this.Fe="AppsForOfficeInsertionDialog";this.$Jc=!!vd.AFrameworkApplication.fa&&vd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Xz(){super.Xz();this.Vk.style.width=this.Khb;this.Vk.style.height=this.sfa;this.Vk.style.marginTop=
this.JDa;this.Vk.style.padding=this.tfa}fAa(){this.Vk.style.width=this.Khb;this.Vk.style.height=this.sfa;this.Vk.style.marginTop=this.JDa;this.Vk.style.padding=this.tfa;this.bY>$g.a.Qma?(this.wb.style.width=String.format("{0}px",$g.a.Qma),this.wb.style.overflowX="scroll",vd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.bY),this.wb.style.overflowX="hidden");this.wb.offsetHeight>$g.a.Pma||this.PJc+50>$g.a.Pma?(this.wb.style.height=
String.format("{0}px",$g.a.Pma),this.wb.style.overflowY="scroll",this.wb.style.top="0",vd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.$Jc||(this.wb.style.marginTop="-48px"),this.Vk.style.minHeight=String.format("{0}px",this.DHc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.kqa);this.dta()}dta(){if(this.wb){var O=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.bY>$g.a.Qma)vd.AFrameworkApplication.isRtl?this.wb.style.marginRight=
"0":this.wb.style.marginLeft="0";else{const Ta=String.format("{0}px",Math.floor(-this.wb.offsetWidth/2));vd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Ta:this.wb.style.marginLeft=Ta;vd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(O)}else r.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}SI(){super.SI();const O=document.getElementById(this.li(this.OJc));O.style.width=String.format("{0}px",this.bY);
O.style.height=this.kqa}get Hia(){return this.Vk}}Object(d.a)(Ai,"AppsForOfficeInsertionDialog",kh.a,[76]);class Mi extends kh.a{constructor(){super();this.sfa="calc(100% - 46px)";this.JDa="15px";this.tfa="0";this.OJc="WACDialogPanel";this.bY=695;this.PJc=462;this.kqa="80%";this.DHc=350;this.Khb="100%";this.Rb=5;this.Fe="SDXDialog"}Xz(){super.Xz();this.Vk.style.width=this.Khb;this.Vk.style.height=this.sfa;this.Vk.style.marginTop=this.JDa;this.Vk.style.padding=this.tfa}fAa(){this.Vk.style.width=this.Khb;
this.Vk.style.height=this.sfa;this.Vk.style.marginTop=this.JDa;this.Vk.style.padding=this.tfa;this.bY>$g.a.Qma?(this.wb.style.width=String.format("{0}px",$g.a.Qma),this.wb.style.overflowX="scroll",vd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.bY),this.wb.style.overflowX="hidden");this.wb.offsetHeight>$g.a.Pma||this.PJc+50>$g.a.Pma?(this.wb.style.height=String.format("{0}px",$g.a.Pma),this.wb.style.overflowY="scroll",
this.wb.style.top="0",vd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.Vk.style.minHeight=String.format("{0}px",this.DHc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.kqa);this.dta()}dta(){if(this.wb){var O=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.bY>$g.a.Qma)vd.AFrameworkApplication.isRtl?this.wb.style.marginRight="0":this.wb.style.marginLeft="0";else{const Ta=String.format("{0}px",Math.floor(-this.wb.offsetWidth/
2));vd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Ta:this.wb.style.marginLeft=Ta;vd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(O)}else r.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}SI(){super.SI();const O=document.getElementById(this.li(this.OJc));O.style.width=String.format("{0}px",this.bY);O.style.height=this.kqa}get Hia(){return this.Vk}}Object(d.a)(Mi,"SDXDialog",kh.a,[]);var ah=a(961),
ni=a(145),Ni=a(574),Uh;(function(O){O[O.Valid=2]="Valid";O[O.Invalid=4]="Invalid";O[O.All=6]="All"})(Uh||(Uh={}));Object(d.b)("MetadataState",Uh);var Bi=a(346);class sf extends uc.a{constructor(O,Ta,Gb,hc,wc){super();this.nBa={};this.cdd={};this.Rza=this.sdxDialog=this.i5=null;this.ncb=!1;this.Y7h=($c,hd,md,Bd,Qd)=>{if(2!==md)return 32;$c=Qd[ah.a.lvb];hd=Qd[ah.a.gZ];md=Qd[ah.a.mW];Qd=new Wg.a;Qd.Kgc=md.optionalProperties.InstanceToken;Qd.sourceLocationOverrideResourceId=md.optionalProperties[xg.a.sourceLocationOverrideResourceId];
Qd.FB=md.Dh;Qd.gZ=hd;hd=null!=Qd.Kgc?Qd.Kgc:(new Ba.a(Sg.a.create(),1)).toString();md=null!=Qd.FB?Qd.FB:{};Bd={};Bd.id=hd;Bd.solutionId=$c.getId();Bd.version=$c.kDa;Bd.storeType=$c.getStoreType();Bd.storeId=$c.getStoreId();Bd.assetId=null;Bd.assetStoreId=null;Bd.settings=md;Bd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Bd.osfControlType=OSF.OsfControlType.ContainerLevel;Bd.sourceLocationOverrideResourceId=Qd.sourceLocationOverrideResourceId;Bd.featureGates=vd.AFrameworkApplication.fa.Q2e($c.getId());
this.xlc(Qd,Bd);return 32};this.mDb=($c,hd,md,Bd,Qd)=>{2===md&&(this.i5=new Ai,this.i5.initializeAndShow("",null,null),$c=Qd.CommandValueId,hd=[],hd.push(Qd.SourceControlId),hd.push($c),hd.push(null),this.je.Cpf(this.i5.Hia,hd));return 32};this.xlc=($c,hd)=>{this.sdxDialog=new Mi;this.sdxDialog.initializeAndShow("",null,null);hd.div=this.sdxDialog.Hia;$c={};$c.InstanceId=hd.id;$c.WebExtensionType=2;$c.PrimaryMarketplace={};$c.PrimaryMarketplace.SolutionId=hd.solutionId;$c.PrimaryMarketplace.MarketplaceType=
hd.storeType;$c.PrimaryMarketplace.MarketplaceRef=hd.storeId;$c.PrimaryMarketplace.SolutionVersion=hd.version;$c.SrcLocationOverrideResourceId=hd.sourceLocationOverrideResourceId;$c.WebExtensionOsfControlType=6;this.nBa[hd.solutionId]=hd.settings;$c.OsfPropertyBag=this.dnc([],hd.solutionId);this.je.LIa($c);this.je.Yh.insertOsfControl(hd)};this.k9h=($c,hd,md,Bd,Qd)=>{if(2!==md)return 32;$c=Qd[ah.a.lvb];md=Qd[ah.a.gZ];Qd=Qd[ah.a.mW];hd=new Wg.a;hd.Kgc=Qd.optionalProperties.InstanceToken;hd.jj=Qd.optionalProperties[xg.a.jj];
hd.zS=Qd.optionalProperties[xg.a.zS];xg.a.taskPaneWidth in Qd.optionalProperties&&(hd.taskPaneWidth=Qd.optionalProperties[xg.a.taskPaneWidth]);hd.sourceLocationOverrideResourceId=Qd.optionalProperties[xg.a.sourceLocationOverrideResourceId];hd.FB=Qd.Dh;hd.onTaskPaneClose=Qd.optionalProperties[xg.a.onTaskPaneClose];hd.gZ=md;md=new xh.a(-859308420,0,2,0,"");Bd=$c.getStoreType()===OSF.StoreType.Sdx;const Pe=new Tg.a;Pe.e_=Qd.optionalProperties.HeaderCssClass||Hg.a.WJa;Pe.yUa=Qd.optionalProperties.TitleCssClass;
this.U7(md,$c.getId(),hd,Bd,Pe);return 32};this.V8h=($c,hd,md,Bd,Qd)=>{if(2!==md)return 32;$c=Qd[ah.a.lvb].getId();Qd=Qd[ah.a.mW].optionalProperties[xg.a.sourceLocationOverrideResourceId];return $c?(this.je.Yh.refreshOsfControl($c,Qd),32):8};this.t4i=$c=>{$c=$c.Result;if($c=null===$c?null:$c.SolutionId)this.je.hpe($c),sh.a(this.$).Ona(3,$c)};this.aNf=($c,hd)=>{var md;const Bd=($c=$c.Result)?$c.AgaveData:null;if(Bd){var Qd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Bd.PrimaryMarketplace.SolutionId,
Bd.PrimaryMarketplace.MarketplaceType,null===(md=null===Bd||void 0===Bd?void 0:Bd.AssetMarketplace)||void 0===md?void 0:md.SolutionId,null,null,Bd.PrimaryMarketplace.MarketplaceRef);r.ULS.shipAssertTag(537170434,0,Bd.TaskpaneWidth===sf.ljh,`Taskpane width is ${Bd.TaskpaneWidth}, assetId is ${Qd}.`);if(md=this.cdd[Bd.PrimaryMarketplace.SolutionId])md.NBc&&(Bd.TaskpaneTitle=md.NBc),md.LBc&&(Bd.TaskpaneIconId=md.LBc),md.KYd&&(Bd.TaskpaneButtonTooltip=md.KYd),0<md.vq&&(Bd.TaskpaneWidth=md.vq);hd&&(Bd.FocusOnIframeWhenLoaded=
hd.focusOnIframeWhenLoaded,hd.width&&(Bd.TaskpaneWidth=hd.width),Bd.TaskpaneIconCssClass=hd.Ek,Bd.TaskpaneHeaderCssClass=hd.e_,Bd.TaskpaneTitleCssClass=hd.yUa,Bd.IsFirstPartyOptOutAppContextOptmization=hd.isFirstPartyOptOutAppContextOptmization);this.nBa[Bd.PrimaryMarketplace.SolutionId]&&(Bd.OsfPropertyBag=this.dnc(Bd.OsfPropertyBag,Bd.PrimaryMarketplace.SolutionId));Vi.a(Bd)||(Bd.WebExtensionOsfControlType=1);Bd&&(this.je.hpe($c.SolutionId),this.je.LIa(Bd))}else r.ULS.sendTraceTag(593285650,220,
10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.eEh=$c=>{$c&&(this.mcd.aof($c),this.hBe())};this.eNf=$c=>{$c=$c.toDataURL("image/jpeg");const hd=this.je.Jaa(sf.Dbf+"."+sf.pec),md={};md.screenshot=$c;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(hd,"onScreenshot",md,()=>{})};this.u7h=($c,hd,md,Bd,Qd)=>{if(2!==md)return 32;if(Qh.a.rh(Qd)||Qd[ah.a.sFe]!==ki.a.action)return 8;hd=Qd[ah.a.mW];return hd?($c=($c=this.JYh(Qd))?this.je.Jaa($c):null)?
(Qd=this.je.x$g(Qd[ah.a.gZ],hd.optionalProperties[xg.a.KZb]),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(md=this.je.KZ($c),md.TaskpaneTitle!==hd.optionalProperties[xg.a.jj]&&(md.TaskpaneTitle=hd.optionalProperties[xg.a.jj],md.TaskpaneIconCssClass=hd.optionalProperties.IconCssClass,md.TaskpaneIconUrl=hd.optionalProperties.TaskPaneIconUrl,md.TaskpaneIconId=hd.optionalProperties.TaskPaneIconId,z.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(hd=this.je.Yh,hd.changeIframeTitle($c,md.TaskpaneTitle),md=hd.getOsfControl($c),hd.raiseOsfControlStatusChange(md)):(hd=this.je.Yh.getOsfControl($c),this.je.Yh.raiseOsfControlStatusChange(hd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady($c,Qd,this.cMb),32):8:8};this.cMb=($c,hd)=>{this.je.FGh($c,hd)};this.gLd=()=>{Vf.TaskExtensions.WJ(wg.GetServiceTaskFactory.Oa(this.$.da,20,404,1),$c=>{$c.result.y5a()},this.$.ka)};this.$=O;this.viewBlockContainerHelpers=Gb;this.je=Ta;this.mcd=
hc;this.Vh=wc;this.Vh.Nb(me.a.H8f,qh.a.frame,this.k9h);this.Vh.Nb(me.a.UYf,qh.a.frame,this.V8h);this.Vh.Nb(me.a.LVe,qh.a.frame,this.u7h);this.Vh.Nb(me.a.xlc,qh.a.frame,this.Y7h);this.Vh.Nb(me.a.mDb,qh.a.frame,this.mDb)}SLg(O){this.addHandler(sf.mFd,O)}fhj(O){this.removeHandler(sf.mFd,O)}dispose(){ci.a.Ia(this.i5);this.i5=null;this.ncb&&(this.$.ea.jo(this.gLd),this.ncb=!1);super.dispose()}a1c(){this.i5.hide()}wKj(O,Ta){if(O){this.raiseEvent(sf.mFd);const Gb=O.split("|");this.GAi(O,Ta,Gb);this.i5=new Ai;
this.i5.initializeAndShow("",null,null);this.je.Cpf(this.i5.Hia,Gb);z.EwaSettings.isChangeGateEnabled("OfficeVSO:7163330_LogAddinInstallOriginEnabledForExcel")&&(window[sf.nOg]=O===sf.aUg?"Backstage":O===sf.Knj?"Ribbon":O===sf.cOj?"TellMe":"Unknown")}}Pkd(O,Ta,Gb){var hc=Vf.TaskExtensions.Uj();if(-515602470===Gb.command||-336193495===Gb.command||2086613372===Gb.command||-1444574190===Gb.command||-1336341324===Gb.command||451940422===Gb.command)hc=this.N7h(O,Ta,Gb);418618014===Gb.command&&(Ta=new Wg.a,
Ta.jj=gd.a.instance.ga(1814),hc=this.U7(Gb,sf.eai,Ta,!0));if((Gb.tabName===this.$.Eb+Jd.a.rZf||Gb.tabName===Jd.a.u0)&&2===Gb.af||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),O[Pg.a.Jc])||O[Pg.a.Jc]===Jd.a.wV)return this.u$e(O,Gb);if(7===Gb.af&&O.SourceControlId===this.$.Eb+Jd.a.oec)return O.MenuItemId=Jd.a.cKd,this.u$e(O,Gb);1221897806===Gb.command&&(hc=this.r8f(Gb,"Format"));if(1930653487===Gb.command||1172793074===Gb.command)hc=this.r8f(Gb,"Data");-1753056834===
Gb.command&&(hc=this.fGj(Gb));932597253===Gb.command&&(r.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),ni.c(932597253,!0),Ta=new Wg.a,Ta.jj=gd.a.instance.ga(2157),Ta.sourceLocationOverrideResourceId=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?sf.C4i:sf.E4i,Ta.focusOnIframeWhenLoaded=!0,Ta.taskPaneWidth=sf.jdf,hc={},hc.LaunchSource=Object(Z.a)(String,O.SourceControlId),hc.LaunchMode="Default",Ta.FB=hc,hc=this.U7(Gb,sf.D4i,
Ta,!0));301511274===Gb.command&&(hc=this.pGj(Gb));if(515196233===Gb.command){Ta=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);if(hc=this.$.da.Aa(465))hc.Lbf(),Ta&&hc.xgi();hc=new Wg.a;hc.jj=gd.a.instance.ga(2231);const wc={};wc.SourceUILocation=Rh.a[Gb.af];Ta&&(wc.SessionID=this.$.ea.sessionId,this.IRd(wc));hc.FB=wc;Ta=new Tg.a;Ta.e_=Hg.a.WJa;hc=this.U7(Gb,sf.J_i,hc,!0,Ta,void 0,hc.jj)}1723441034===Gb.command&&(Ta=new Wg.a,Ta.jj=
gd.a.instance.ga(2243),Ta.focusOnIframeWhenLoaded=!0,Ta.taskPaneWidth=sf.u7i,hc=new Tg.a,hc.e_=Hg.a.nvh,hc=this.U7(Gb,Ni.a,Ta,!0,hc));z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&O.LoadDataFromPictureTaskpane&&(Ta={},hc=new Wg.a,hc.jj=gd.a.instance.ga(2270),Ta.SessionID=O.SessionID,hc.FB=Ta,hc.focusOnIframeWhenLoaded=!0,hc=this.U7(Gb,O.DataFromPictureAssetId,hc,!0));return hc}insertAgave(O,Ta){var Gb=Vf.TaskExtensions.Uj();const hc=this.$;let wc;var $c=O[Md.a.ssa];
wc=O[Pg.a.og];let hd=null;Tg.a.key in O&&(hd=O[Tg.a.key]);this.i5&&this.i5.hide();if(!wc||!$c)return r.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Gb;this.$.K5&&Jd.a.Loa in O&&(wc.EnabledInViewMode=O[Jd.a.Loa]);O=this.hQh(Ta.command);if(!wc.EnabledInViewMode&&!hc.$p(null,!1,O))return Gb;let md=void 0===wc.IsToBePersisted||null===wc.IsToBePersisted||wc.IsToBePersisted?0:16;if(1===wc.TargetType)Gb=this.nhi(wc,$c,Ta,hd,md);else{$c=Ag.h(hc);Gb=this.viewBlockContainerHelpers.$gb($c);
const Bd=hc.ea.isNamedObjectViewMode?hc.oa.sheetName:hc.oa.name;let Qd,Pe,Ue,of;Gb?($c=Gb.fe,Qd=$c.pf.top,Pe=$c.pf.left,Ue=Gb.iJ.x,of=Gb.iJ.y):(Qd=Pe=1,Gb=this.viewBlockContainerHelpers.JLa($c),Ue=Gb.x,of=Gb.y);const tg=this.$.pa.ya.Wb();md|=64;Gb=pg.a(this.$.userOperationManager,(gg,Yf,$f)=>{var mg=hc.pa.ya,Mg=Qd,Ig=Pe,Ng=Ue,Hh=of;gg=Rf.b(gg,this.t4i);const Xh=mg.Na(9,tg);Xh.sharedInfo=wc;Xh.sheetName=Bd;Xh.positionRow=Mg;Xh.positionCol=Ig;Xh.positionOffsetX=Ng;Xh.positionOffsetY=Hh;return Eg.g(mg,
"InsertWebExtension",Xh,gg,Yf,$f,null,0)},gg=>new Gh.a(534,0,gg,md),Ta)}return Gb}V7g(){var O=Ec.a.instance.Ub("Common.App.ICustomerFeedbackUiWrapper");if(!z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var Ta=Ec.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.mcd?this.mcd.wkb?this.hBe():Ta.instance.i9c(this.eEh):r.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ta={};vd.AFrameworkApplication.fa.Bpe(Ta);
O=O.instance.getContext(Ta);Ta={};"telemetryGroup"in O&&(Ta=O.telemetryGroup);Ta.processSessionId=O.sessionId;Ta.officeBuild=O.build;O.telemetryGroup=Ta;O.feedbackType=-1;O.userVoiceEnabled=!1;"disableIncludeScreenshot"in O||(O.disableIncludeScreenshot=!1);"screenshot"in O||(O.screenshot=!1);O.disableScreenshotPreview=!1;O.includeScreenshotSelectedDefault=!0;return O}uNf(O){if(!this.Rza&&z.EwaSettings.getBooleanFeatureGate(sf.$bi,!1)){var Ta=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ta=this.Gye(Ta);const Gb=new Tg.a;Gb.Ek=Hg.a.ibd;Gb.e_=Hg.a.xSe;Gb.yUa=Hg.a.Gad;this.Rza=this.HLb(Ta,null,!1,null,Gb);Wi.b(this.$).ud(yi.a.T4i,{["Location"]:O?Rh.a[O.af]:0,["InputMethod"]:O?Ti.a[O.method]:0},void 0,!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.C_d()}}IRd(O){const Ta=this.$.ea.Yg.get(17);Ec.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>
{Gb.isFeatureEnabled("mso_sendASmile",Ta).then(hc=>{O.FeedbackEnabled=Ta&&hc;return null})})}r8f(O,Ta){const Gb=Ag.h(this.$),hc=new Wg.a;var wc={};wc.ActiveTab=Ta;wc.DatapaneFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);wc.AceFlighting=!0;wc.ChartNewSDXRecording=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);wc.ThemeColorsFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");wc.UOMirror=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);wc.FormatTaskPaneAceButtonDark=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);wc.FormatTaskPaneBetterFeedbackButton=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);wc.FormatTaskPaneBetterScrollbar=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",
!1);wc.FormatTaskPaneUXImprovePhase2=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);this.IRd(wc);wc.startTimeMs=Date.now();wc.UserSessionId=this.$.va.UserSessionId;(Ta=Gb.ha.Sa.mo)&&(wc.SubSelection=Ta);r.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${wc.UserSessionId}, UILocation: ${void 0===O.af||null===O.af?"Null":Rh.a[O.af]}, SubSelection: ${Ta||"ChartRoot"}`);hc.FB=wc;hc.jj=gd.a.instance.ga(981);wc=new Tg.a;wc.e_=Hg.a.WJa;
return this.U7(O,sf.P1g,hc,!0,wc)}fGj(O){const Ta=new Wg.a;Ta.FB={};Ta.jj=gd.a.instance.ga(1800);Ta.zS=sf.$pf;const Gb=new Tg.a;Gb.e_=Hg.a.WJa;return this.U7(O,sf.$pf,Ta,!0,Gb,void 0,Ta.jj)}pGj(O){const Ta=new Wg.a;Ta.FB={};Ta.jj=gd.a.instance.ga(2181);const Gb=new Tg.a;Gb.e_=Hg.a.Nwh;Gb.yUa=Hg.a.BSe;return this.U7(O,sf.gIi,Ta,!0,Gb)}u$e(O,Ta){const Gb=sf.Dbf;var hc=O[Pg.a.Jc].toString();const wc={},$c=new Wg.a;$c.jj=gd.a.instance.ga(9);switch(hc){case "A0":wc.query=(O[Pg.a.og]||"").split("|").slice(2,
Li.a.QS).join("|");break;case "A1":wc.query=O.CommandValueId;break;case "Help":wc.gwdropdownflightinfo=z.EwaSettings.ma(236);wc.query="";break;case Jd.a.cKd:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?($c.jj=gd.a.instance.ga(1766),$c.sourceLocationOverrideResourceId=sf.pec,wc.feedback=this.V7g()):wc.query=hc;break;case "HelpArticle":wc.query=O[Pg.a.og];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":wc.query=hc;break;default:return jh.Task.Ta(!0)}$c.FB=
wc;hc=new Tg.a;hc.e_=Hg.a.WJa;return this.U7(Ta,Gb,$c,!1,hc,O[Jd.a.Loa]||!1)}Gye(O){const Ta={};z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ta.SolutionId=sf.Qwa,Ta.Version="0.0.0.0",Ta.StoreType=OSF.StoreType.Sdx,Ta.StoreId=OSF.StoreType.Sdx,Ta.AssetId=null,Ta.AssetStoreId=null,Ta.Height=0,Ta.Width=0):(Ta.Version="0.0.0.0",Ta.AssetId=sf.Qwa,Ta.SolutionId=sf.Qwa,Ta.AssetStoreId="",Ta.StoreType=OSF.StoreType.Sdx,Ta.Height=0,Ta.Width=0,Ta.StoreId=OSF.StoreType.Sdx);
Ta.TargetType=OSF.OsfControlTarget.TaskPane;Ta.IsToBePersisted=!1;Ta.SourceLocationOverrideResourceId=O;Ta.SharedRuntimeId=O;return Ta}N7h(O,Ta,Gb){function hc(){hd.LaunchMode="Default";z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":wc.sourceLocationOverrideResourceId="Insights.Https.Bundle";wc.jj=gd.a.instance.ga(1813);wc.zS=sf.sYc;wc.Ek=Hg.a.ibd;$c.Ek=Hg.a.ibd}const wc=new Wg.a,$c=new Tg.a,hd={};this.Rza&&
this.IRd(hd);hd.LaunchSource="";hd.StartTimeMs=Date.now();hd.CorrelationId=Sg.a.create().toString();wc.FB=hd;wc.focusOnIframeWhenLoaded=!0;wc.taskPaneWidth=sf.jdf;$c.e_=Hg.a.xSe;$c.yUa=Hg.a.Gad;switch(Gb.command){case -1444574190:let Qd;hd.LaunchMode="RecommendedPivotTables";hd.SelectionContext="";hd.LaunchSource="PivotTableHandRaise"===Object(Z.a)(String,O.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
O.SourceSelection){var md=O.SourceSelection.split(",")[0];Ta=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:md,LQf:Qd,range:Bd}=Dh.Z(md,this.$.xa)).returnValue&&!Ag.h(this.$).Bb.H5(Bd))O=this.$.xa.getItemByName(md),hd.SelectionContext=JSON.stringify(Object(dd.a)(new li,{address:Qd,addressWithSheet:md+"!"+Bd.Ew(!1),sheetId:Fh.d(O),sheetName:md,isSheetEmpty:!1,columnCount:Bd.width,rowCount:Bd.height,columnIndex:Bd.left+Ta,rowIndex:Bd.top+Ta,selectionType:"Continuous"}));
else if((O=this.$.Cb.getItemByName(Object(Z.a)(String,O.SourceSelection)))&&Fh.n(O)){var Bd=zi.a(O,!0);md=this.$.xa.getItemByName(O.sheetName);hd.SelectionContext=JSON.stringify(Object(dd.a)(new wi,{tableName:O.name,hasTableHeaders:zi.d(O),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Bd.Ew(!1),addressWithSheet:md.name+"!"+Bd.Ew(!1),sheetId:Fh.d(md),sheetName:md.name,isSheetEmpty:!1,columnCount:Bd.width,rowCount:Bd.height,columnIndex:Bd.left+Ta,rowIndex:Bd.top+Ta,selectionType:"Continuous"}))}}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?wc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":wc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";wc.jj=gd.a.instance.ga(1812);wc.zS=sf.Q2i;wc.Ek=Hg.a.TUe;$c.Ek=Hg.a.TUe;break;case -336193495:hd.LaunchMode="RecommendedCharts";z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":wc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";wc.jj=gd.a.instance.ga(1811);
wc.zS=sf.Kaj;wc.Ek=Hg.a.UUe;$c.Ek=Hg.a.UUe;break;case -1336341324:if(!z.EwaSettings.ma(473))return jh.Task.Ta(!1);hd.LaunchMode="NL";wc.zS=sf.sYc;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":wc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(z.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:wc.jj=gd.a.instance.ga(1816);hd.NLLaunchModeBrandingCandidatesIndex=
1;break;case 2:wc.jj=gd.a.instance.ga(1817);hd.NLLaunchModeBrandingCandidatesIndex=2;break;default:wc.jj=gd.a.instance.ga(1815),hd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!z.EwaSettings.ma(231))return jh.Task.Ta(!1);hd.LaunchMode="ChartDesigner";hd.LaunchSelectionMode=Ta.toString();z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":wc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
wc.jj=gd.a.instance.ga(1818);wc.zS=sf.sYc;break;case 451940422:hd.LaunchSource="AutoFilter";Bd=JSON.parse(O.CommandValueId);hd.AutoFilterSource=JSON.stringify(Object.assign(new mi,{autoFilterRange:{sheetName:Bd.AutoFilterRange.SheetName,firstColumn:Bd.AutoFilterRange.FirstColumn,lastColumn:Bd.AutoFilterRange.LastColumn,firstRow:Bd.AutoFilterRange.FirstRow,lastRow:Bd.AutoFilterRange.LastRow},autoFilterType:Bd.AutoFilterType,itemIndex:Bd.ItemIndex,id:Bd.Id}));hc();break;default:z.EwaSettings.ma(231)&&
(hd.LaunchSelectionMode=Ta.toString()),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(hd.XlimTableBoundaries=this.S2h()),hc()}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":wc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Rza?this.Rza.jp(()=>this.C1f(hd,wc)):this.yfi(Gb,wc,$c,hd)}yfi(O,Ta,Gb,hc){const wc=this.Gye(Ta.sourceLocationOverrideResourceId);
this.Rza=this.HLb(wc,Ta,!1,O,Gb,!1);return z.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(hc.NoActionMsgOnFirstInstance=!0,this.nBa[sf.Qwa]=hc,this.Rza):this.Rza.jp(()=>this.C1f(hc,Ta))}C1f(O,Ta){const Gb=this.je.Jaa(this.je.p4a(sf.Qwa,Ta.sourceLocationOverrideResourceId));if(Gb){this.nBa[sf.Qwa]=O;const hc=this.dnc(this.je.KZ(Gb).OsfPropertyBag,sf.Qwa);this.je.KZ(Gb).OsfPropertyBag=hc}this.f6(sf.Qwa,"LaunchIdeasAction",O,Ta);return jh.Task.Ta(!0)}U7(O,Ta,Gb=null,
hc=!1,wc=null,$c=!1,hd=null){Vf.TaskExtensions.Uj();Gb||(Gb=new Wg.a);const md={};z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(md.SolutionId=Ta,md.Version="0.0.0.0",md.StoreType=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,md.StoreId=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,md.AssetId=null,md.AssetStoreId=null,md.Height=0,md.Width=0):(md.Version="0.0.0.0",md.AssetId=Ta,md.SolutionId=Ta,md.AssetStoreId="",md.StoreType=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,
md.Height=0,md.Width=0,md.StoreId=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty);md.TargetType=OSF.OsfControlTarget.TaskPane;md.IsToBePersisted=!1;md.SourceLocationOverrideResourceId=Gb.sourceLocationOverrideResourceId;if(Gb.jj||hd)this.cdd[Ta]=Object(dd.a)(new vi,{NBc:Gb.jj,KYd:hd,LBc:Gb.zS});z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Gb.FB||(Gb.FB={}),Gb.FB.ShowFeedback=this.$.isFeedbackEnabled,this.nBa[Ta]=Gb.FB):
Gb.FB&&(this.nBa[Ta]=Gb.FB);Ta={};Ta[Pg.a.og]=md;hd={};hd.solutionId=md.SolutionId;hd.version=md.Version;hd.storeType=md.StoreType;hd.storeId=md.StoreId;hd.assetId=md.AssetId;hd.assetStoreId=md.AssetStoreId;hd.height=md.Height;hd.targetType=md.TargetType;hd.width=md.Width;hd.isAddinCommands=!hc;Ta[Md.a.ssa]=hd;wc||(wc=new Tg.a);wc.focusOnIframeWhenLoaded=Gb.focusOnIframeWhenLoaded;wc.width=Gb.taskPaneWidth;Ta[Tg.a.key]=wc;Ta[Jd.a.Loa]=$c;return this.insertAgave(Ta,O)}nhi(O,Ta,Gb,hc,wc){const $c=(Qd,
Pe)=>{var Ue=Qd.SolutionId;var of=OSF.OsfControl.isFirstPartyStoreString(Qd.StoreType);of&&Qd.SourceLocationOverrideResourceId&&(Ue=this.je.p4a(Ue,Qd.SourceLocationOverrideResourceId));var tg=this.je.bCe(Ue,null,Qd.SharedRuntimeId);of&&(z.EwaSettings.ma(290)&&tg&&(of=this.je.Jaa(Ue))&&(Ue=null,Ue=this.dnc(this.je.KZ(of).OsfPropertyBag,Qd.SolutionId),(of=this.je.Yh.getOsfControl(of))&&of.setSettings(Ue)),Qd.SharedRuntimeId&&tg||this.je.Yh.refreshOsfControl(Qd.SolutionId,Qd.SourceLocationOverrideResourceId));
if(!tg){const gg=this.$.pa.ya.Wb();let Yf=519;tg=($f,mg,Mg)=>{var Ig=this.$.pa.ya;$f=Rf.b($f,this.aNf);const Ng=Ig.Na(9,gg);Ng.sharedInfo=Qd;return Eg.g(Ig,"InsertAgaveTaskpane",Ng,$f,mg,Mg,hc,0)};void 0===Qd.IsToBePersisted||null===Qd.IsToBePersisted||Qd.IsToBePersisted||(Yf=538,tg=($f,mg,Mg)=>{const Ig=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.SolutionId,Qd.StoreType,Qd.AssetId,null,null,Qd.StoreId);r.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Qd.StoreType}, StoreId ${Qd.StoreId}, SolutionId ${Ig}.`);
return Sh(this.$.pa.ya,Qd,Rf.b($f,this.aNf),mg,Mg,hc,gg)});wc|=64;return pg.a(this.$.userOperationManager,tg,$f=>new Gh.a(Yf,0,$f,wc),Pe)}return Vf.TaskExtensions.iba()},hd=Qd=>{var Pe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.solutionId,Qd.storeType,Qd.assetId,null,null,Qd.storeId);r.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Pe} from ${Qd.storeType}.`);Pe={};const Ue=new n.a;Ue.add(Qd);Pe[Md.a.Kob]=Ue;Pe[Md.a.BM]=3;Qd=new xh.a(me.a.kDb,0,this.$.Hc,0,null);return this.$.Ja.Lb(Qd,
Pe)};if(!z.EwaSettings.ma(52)||O.StoreId===OSF.StoreType.FirstParty)return $c(O,Gb,hc);if(Ta.isAddinCommands)return hd(Ta);const md=new ld.a,Bd={};z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Bd.solutionId=O.SolutionId,Bd.version=O.Version):(Bd.marketplaceId=O.SolutionId,Bd.marketplaceVersion=O.Version);Bd.storeType=O.StoreType;Bd.storeId=O.StoreId;Bd.targetData=O;z.EwaSettings.ma(92)&&(Bd.clearCache=!0);this.je.Yh.isAddinCommandsAsync(Bd,(Qd,Pe,Ue)=>{md.setResult(Pe);
Qd||(Qd=Ue.targetData,Pe=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qd.SolutionId,Qd.StoreType,Qd.AssetId,null,null,Qd.StoreId),r.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Pe} from ${Qd.StoreType} during addin inserting`))});return Vf.TaskExtensions.ts(md.task,Qd=>Qd.result?hd(Ta):$c(O,Gb,hc),this.$.ka)}dnc(O,Ta){if(!this.nBa[Ta])return O;const Gb={};if(O)for(const wc of O)Gb[wc[0]]=wc[1];O=this.nBa[Ta];for(var hc of Object.keys(O))hc===sf.gEh&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?Gb[hc]=Sys.Serialization.JavaScriptSerializer.serialize(O[hc]):Gb[hc]=Sys.Serialization.JavaScriptSerializer.serialize(O[hc].toString());hc=Object.keys(Gb).length;hc=Array(hc);O=0;for(const wc of Object.keys(Gb))hc[O]=[wc,Gb[wc].toString()],O++;return hc}GAi(O,Ta,Gb){const hc=this.$.va.UserSessionId,wc=this.$.va.UICultureTag,$c=this.$.va.UICultureTagLcid,hd=this.$.va.WacHostId;let md="",Bd="";5<=Gb.length&&(md=Gb[3],Bd=Gb[4]);this.HAi(md,Bd,O,Ta,wc,$c,hc,hd)}HAi(O,Ta,Gb,hc,wc,$c,hd,md){const Bd=
{};Bd.a=hd;Bd.b=Gb;Bd.c=hc;Bd.d=O;Bd.e=Ta;Bd.f=wc;Bd.g=$c;Bd.h=md;Th.b().Qe(36,Bd)}hBe(){if(Ui.a.lyf())r.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.eNf);return}catch(O){r.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(O?O.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.eNf)}catch(O){r.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(O?O.toString():
null))}}}HLb(O,Ta=null,Gb=!1,hc=null,wc=null,$c=!0){var hd=O.SolutionId;let md=jh.Task.Ta(!1);O&&hd&&O.SharedRuntimeId&&(hc=hc||new xh.a(-859308420,0,2,0,""),hd={},hd.solutionId=O.SolutionId,hd.version=O.Version,hd.storeType=O.StoreType,hd.storeId=O.StoreId,hd.assetId=O.AssetId,hd.assetStoreId=O.AssetStoreId,hd.height=O.Height,hd.targetType=O.TargetType,hd.width=0,hd.isAddinCommands=!1,hd.sharedRuntimeId=O.SharedRuntimeId,O.Preload=$c,wc=wc?wc:new Tg.a,wc.width=0,Ta&&(wc.focusOnIframeWhenLoaded=Ta.focusOnIframeWhenLoaded,
$c=new vi,Ta.jj&&($c.NBc=Ta.jj),0<Ta.taskPaneWidth&&($c.vq=Ta.taskPaneWidth),Ta.zS&&($c.LBc=Ta.zS),this.cdd[O.SolutionId]=$c),Ta={},Ta[Pg.a.og]=O,Ta[Md.a.ssa]=hd,Ta[Tg.a.key]=wc,Ta[Jd.a.Loa]=Gb,md=this.insertAgave(Ta,hc));return md}f6(O,Ta,Gb,hc=null){if(O&&Ta){O=new Kh.a(O,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const wc=new hi.a("ExcelOnline","Web",this.$.va.UICultureTag),$c=new og.a;$c.optionalProperties[xg.a.KZb]=Gb;hc&&(hc.sourceLocationOverrideResourceId&&($c.optionalProperties[xg.a.sourceLocationOverrideResourceId]=
hc.sourceLocationOverrideResourceId),hc.jj&&($c.optionalProperties[xg.a.jj]=hc.jj),hc.Ek&&($c.optionalProperties.IconCssClass=hc.Ek),hc.HYd&&($c.optionalProperties.TaskPaneIconUrl=hc.HYd),hc.zS&&($c.optionalProperties.TaskPaneIconId=hc.zS));ui.a.instance.f6(O,ki.a.action,Ta,wc,$c)}}JYh(O){if(!Qh.a.rh(O)){var Ta=O[ah.a.lvb];if(Ta&&(Ta=Ta.getId(),O=O[ah.a.mW],Ta&&O))return this.p4a(Ta,O.optionalProperties[xg.a.sourceLocationOverrideResourceId])}return null}p4a(O,Ta=null){return O&&Ta?`${O}.${Ta}`:O}hQh(O){switch(O){case 1172793074:case 1221897806:case 1930653487:return 2;
case -515602470:case 2086613372:return z.EwaSettings.ma(231)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}C_d(){this.$.ea.tg?this.gLd():(this.$.ea.Xk(this.gLd),this.ncb=!0)}S2h(){var O=this.$.da.Aa(20);if(!O)return this.C_d(),"";O=O.y5a();if(!O)return this.C_d(),"";var Ta=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.oa.name);Ta=Fh.d(Ta);var Gb=Ag.h(this.$).ha.ra.selectedRanges;const hc=[];for(const $c of Gb){Gb=
new Bi.a($c,Ta);var wc=O.zdc(Gb,Uh.Valid);Gb=[];if(wc)for(const hd of wc)(wc=hd.table.SA)&&(wc=wc.range.toString())&&Gb.push(wc);Gb=new xi($c.toString(),Gb);hc.push(Gb)}return JSON.stringify(hc)}}sf.$bi="Microsoft.Office.Excel.IdeasXLOPreload";sf.mFd="IDS";sf.Dbf="FA000000012";sf.Qwa="FA000000005";sf.eai="HelloWorld";sf.P1g="FA000000014";sf.pec="Help.GiveFeedback.Url";sf.gEh="feedback";sf.$pf="FA000000066";sf.E4i="PowerBi.Url";sf.C4i="PowerBi.DevUrl";sf.D4i="FA000000054";sf.gIi="FA000000064";sf.J_i=
"FA000000075";sf.sYc="AnalyzeDataTaskPane";sf.Kaj="RecommendedChartsTaskPane";sf.Q2i="PivotTableTaskPane";sf.ljh=350;sf.jdf=320;sf.u7i=320;sf.nOg="g_InstallOrigin";sf.aUg="InsertAddInsFromBackstage";sf.Knj="InsertAppsForOffice";sf.cOj="LaunchAddinDialogFromTellMe";Object(d.a)(sf,"AgaveCommandManager",uc.a,[712,713]);class Ci extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){const O=this.$.da,Ta=wg.GetServiceTaskFactory.create(O,106,this.ka,this.Ya),Gb=wg.GetServiceTaskFactory.create(O,
104,this.ka,this.Ya),hc=Rg.a.loadScript(35,0,this.Ya,void 0,void 0,375);Vf.TaskExtensions.za(Vf.TaskExtensions.Ed([Gb,Ta,hc],this.ka),()=>{let wc=null;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(wc=Ec.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);ih.instance.initialize(Ta.result);const $c=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Nh.a)(this.$.da,
374,()=>new sf(this.$,Ta.result,Gb.result,wc,vd.AFrameworkApplication.ub)):new sf(this.$,Ta.result,Gb.result,wc,vd.AFrameworkApplication.ub);O.Ga(206,$c);this.nb(O.Aa(374)||O.Ga(374,$c))},this.ka,3);Ec.a.instance.register(Ph.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").xc().Fc(()=>new Ph.a(this.$.ru))}static la(O){O.da.Ga(375,new Ci(O))}}Object(d.a)(Ci,"AgaveCommandManagerFactory",h.a,[]);var Oi=a(561);class lh{constructor(){this.initialized=!1;this.agaveCommandManager=this.je=
this.k1a=null;this.rU={}}initialize(O){z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.Ooj(O)}Wgi(O,Ta){let Gb=Vf.TaskExtensions.Uj();if(this.initialized&&O&&0<O.length){let hc=this.$Mh(O);O in this.rU&&(Gb=this.agaveCommandManager.insertAgave(hc,Ta))}return Gb}CGg(O){this.initialized&&(O=O[Pg.a.og]||{},!O.SolutionId||O.SolutionId in this.rU||this.je.uda(Ta=>{this.uda(Ta)},!0))}Q8h(O){this.initialized&&(O=O||"")&&
0<O.length&&O in this.rU&&(delete this.rU[O],this.je.uda(Ta=>{this.uda(Ta)},!0))}$Mh(O){return O in this.rU?this.rU[O]:{}}uda(O){var Ta=!1;if(O&&!O.errorCode){if(O.value)for(const Gb of O.value)O=Gb[1],Gb[3]==OSF.OsfControlTarget.InContent&&O&&0<O.length&&!(O in this.rU)&&(Ta={NoReporting:!1,IsSystemInitiated:!1},Ta.description=Gb[2],Ta.iconUrl=Gb[9],Ta[Md.a.ssa]={solutionId:Gb[1],version:Gb[4],storeType:Gb[12],storeId:Gb[11],assetId:Gb[5],assetStoreId:Gb[6],targetType:Gb[3],width:Gb[7],height:Gb[8],
displayName:Gb[0],id:Gb[1]},Ta[Pg.a.og]={SolutionId:Gb[1],Version:Gb[4],StoreType:Gb[12],StoreId:Gb[11],AssetId:Gb[5],AssetStoreId:Gb[6],TargetType:Gb[3],Width:Gb[7],Height:Gb[8],Id:Gb[1]},this.rU[O]=Ta,Ta=!0);Ta&&this.Tah()}}Tah(){let O=[];for(const Ta in this.rU)O.push({id:Ta,controlType:0,title:this.rU[Ta][Md.a.ssa].displayName});if(0<O.length){for(const Ta in this.rU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ta,this.rU[Ta].iconUrl);this.$2g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:lh.syf,
isOfficeTab:!0,groups:[{id:lh.sff,title:lh.tff,controls:O}]}]});for(const Ta in this.rU)this.k1a.addCommandToMaps(Object(dd.a)(new xf.a(Ta,"-1473679467"),{legacyControlId:Ta}))}}$2g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:lh.syf,isOfficeTab:!0,groups:[{id:lh.sff,title:lh.tff,controls:[]}]}]})}Ooj(O){const Ta=wg.GetServiceTaskFactory.Oa(O.da,374,375,1),Gb=wg.GetServiceTaskFactory.create(O.da,106,O.ka,1);Vf.TaskExtensions.za(Vf.TaskExtensions.Ed([Ta,Gb],O.ka),()=>{this.agaveCommandManager=
Ta.result;this.k1a=Ec.a.instance.Lh("Common.IExternalUICommandDefinitionMapping")||new Oi.a(O.Eb,O);vd.AFrameworkApplication.ub.Nb(me.a.WTf,qh.a.frame,(hc,wc,$c,hd,md)=>{this.Q8h(md)});this.je=Gb.result;this.je.uda(hc=>{this.uda(hc)},!0);this.initialized=!0},O.ka,3)}}lh.syf="tabinsert";lh.sff="installedContentAddins";lh.tff=gd.a.instance.ga(2278);Object(d.a)(lh,"AgaveCommandRibbon",null,[711]);class oi extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)){const O=this.$.da,Ta=new lh;Ta.initialize(this.$);this.nb(O.Aa(488)||O.Ga(488,Ta))}}static la(O){O.da.Ga(489,new oi(O))}}Object(d.a)(oi,"AgaveCommandRibbonFactory",h.a,[]);var Vh=a(1302),eg=a(733);class Lh{constructor(){this.X9d=this.r9d=this.Bfa=null;this.Zjb=0}get displayName(){return this.Bfa}set displayName(O){this.Bfa=O}get email(){return this.r9d}set email(O){this.r9d=O}get federationProvider(){return this.X9d}set federationProvider(O){this.X9d=O}get identityType(){return this.Zjb}set identityType(O){this.Zjb=
O}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(O){switch(O){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ta){switch(O){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,
0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Ta){O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}static bch(O){const Ta=new Lh;Ta.displayName=O.displayName;Ta.email=O.email;switch(O.authority){case Vh.a.YJf:Ta.identityType=1;break;default:Ta.identityType=0}Ta.federationProvider="";return Ta}}Object(d.a)(Lh,"OfficeIdentityInfo",null,[]);class mh{static get vQe(){return mh.Tug}static Bcc(O){return O in mh.vQe?mh.vQe[O].toString():O}}mh.map=null;mh.Tug={["GeneralException"]:eg.a.generalException,
["AccessDenied"]:eg.a.vVc,["ApiNotAvailable"]:eg.a.apiNotAvailable,["UserNotSignedIn"]:eg.a.userNotSignedIn,["UserAborted"]:eg.a.userAborted,["UnsupportedUserIdentity"]:eg.a.UVj,["InvalidResourceUrl"]:eg.a.invalidResourceUrl,["InvalidGrant"]:eg.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:eg.a.pOg,["ResourceNotAllowed"]:eg.a.Gmj,["ClientError"]:eg.a.clientError,["ServerError"]:eg.a.serverError};Object(d.a)(mh,"SingleSignOnErrorCodeMap",null,[]);class Mh{constructor(O,Ta){this.$Rb=O;this.Zjb=Ta}get accessToken(){return this.$Rb}set accessToken(O){this.$Rb=
O}get tokenIdenityType(){return this.Zjb}set tokenIdenityType(O){this.Zjb=O}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(O){switch(O){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ta){switch(O){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}
Object(d.a)(Mh,"SingleSignOnToken",null,[]);class R{constructor(){this.M5d=null;this.Fje=this.CXb=this.tE="";this.Tke=!0;this.options=null}get authChallenge(){return this.M5d}set authChallenge(O){this.M5d=O}get correlationId(){return this.tE}set correlationId(O){this.tE=O}get policy(){return null}set policy(O){}get resource(){return this.CXb}set resource(O){this.CXb=O}get scope(){return this.Fje}set scope(O){this.Fje=O}get silentLogin(){return this.Tke}set silentLogin(O){this.Tke=O}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(O){switch(O){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ta){switch(O){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(d.a)(R,"TokenParameters",null,[447]);class Wa{constructor(O,Ta){this.uib=Ta;this.GA=O}get roamingSettings(){return null}getAccessToken(O){const Ta=this.uib.getOsfControl(this.GA),
Gb=Ta.getManifest(),hc=Gb.getMarketplaceID();this.KOa(O,hc);return OfficeExtension.WacRuntime.Utility.createPromise((wc,$c)=>{Ta.isFirstParty()&&this.uib._enableFirstPartySSO?this.Rji(Gb,O)?Ec.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(O,hc).then(hd=>{wc(hd)},hd=>{$c(hd)}):$c(eg.a.vVc):$c(eg.a.apiNotAvailable)}).then(wc=>{let $c;switch(wc.authority){case Vh.a.YJf:$c=1;break;default:$c=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Mh(wc.accessToken,
$c))},wc=>{this.logErrorResponse(O,hc,wc);return wc?OfficeExtension.WacRuntime.Utility.createPromise(($c,hd)=>{hd(OfficeExtension.WacRuntime.Utility.createRichApiException(wc,mh.Bcc(wc)))}):OfficeExtension.WacRuntime.Utility.createPromise(($c,hd)=>{hd(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,mh.Bcc(eg.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const O=this.uib.getOsfControl(this.GA);O.getManifest();const Ta=O.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Gb,hc)=>{Ec.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ta).then(wc=>{Gb(wc)},wc=>{hc(wc.toString())})}).then(Gb=>{Gb=Lh.bch(Gb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Gb)},Gb=>Gb?OfficeExtension.WacRuntime.Utility.createPromise((hc,wc)=>{wc(OfficeExtension.WacRuntime.Utility.createRichApiException(Gb,mh.Bcc(Gb)))}):OfficeExtension.WacRuntime.Utility.createPromise((hc,wc)=>
{wc(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,mh.Bcc(eg.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(O){switch(O){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 1:return this.vMh(Ta);case 3:return this.JNh();case 2:return this.OZh()}O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}vMh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,R);return this.getAccessToken(O)}JNh(){return this.getAuthContext()}OZh(){return this.getPrimaryIdentityInfo()}Rji(O,
Ta){let Gb=!1;const hc=O.getWebApplicationAuthorizations();O=null;for(const wc of hc)if(wc.getResource().toLowerCase()===Ta.resource.toLowerCase()){O=wc;Gb=!0;break}if(!Gb)return!1;Ta=Ta.scope.split(" ,+");for(const wc of Ta)if(wc&&wc.length){Ta=!1;for(const $c of O.getScopes())wc.toLowerCase()===$c.toLowerCase()&&(Ta=!0);if(!Ta)return!1}return!0}KOa(O,Ta){O=this.dyf(O.resource);r.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ta,["resource"]:O})}logErrorResponse(O,Ta,Gb){O=this.dyf(O.resource);
r.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ta,["resource"]:O,["error"]:Gb})}dyf(O){return O.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(Wa,"AuthenticationService",null,[]);class rb{create(O,Ta){return new Wa(O,Ta)}}Object(d.a)(rb,"AuthenticationServiceFactory",null,[]);var Ub=a(846),lc=a(963),Hc=a(946);class Dc{}Dc.generalException="generalException";Dc.invalidArgument="invalidArgument";Dc.notAllowed="notAllowed";Dc.apiNotAvailable="apiNotAvailable";
Dc.unresolvedPendingRequest="unresolvedPendingRequest";Dc.timeout="timeout";Dc.adalTimeout="adalTimeout";Dc.userNotSignedIn="userNotSignedIn";Dc.userAborted="userAborted";Dc.silentSignInFailed="silentSignInFailed";Dc.invalidResourceUrl="invalidResourceUrl";Dc.invalidGrant="invalidGrant";Dc.connectionLost="connectionLost";Dc.clientError="clientError";Dc.serverError="serverError";Object(d.a)(Dc,"WopiHostErrorCodes",null,[]);var Ac=a(731);class kc{}Object(d.a)(kc,"OAuthCallerMetadata",null,[]);var Oc=
a(27);class cd{constructor(O){this.uya=O;this.Kug=vd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}NFg(O,Ta,Gb,hc,wc,$c){if(!this.uya)return hc=new lc.a,hc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(hc);const hd=new kc;hd.AddinName=wc;hd.AddinTrustId=$c;let md=-1;$c=null;if(hc&&this.qjf())$c=this.uya.Rfg(Md.a.eCc,O,hc,cd.d6e(wc),hd);else{const Bd=Date.now();$c=this.uya.UL(Md.a.eCc,O,hd).then(Qd=>{md=Date.now()-
Bd;const Pe=(Ta||Gb)&&"login_required"===Qd.ErrorCode;return(Ta&&("interaction_required"===Qd.ErrorCode||"consent_required"===Qd.ErrorCode||"invalid_grant"===Qd.ErrorCode)||Pe)&&this.qjf()?this.uya.Rfg(Md.a.eCc,O,null,cd.d6e(wc),hd):Promise.resolve(Qd)})}return $c.then(Bd=>{const Qd=new lc.a;Bd.IsSuccess?(Qd.token=Bd.Token,Bd.Telemetry&&(Qd.EUa=Bd.Telemetry.fromCache,Qd.expiresOn=Bd.Telemetry.expiresOn)):(Qd.errorCode=this.$Di(Bd),Qd.NYd=this.W0i(Bd));return Qd}).catch(()=>{const Bd=new lc.a;Bd.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Bd)}).then(Bd=>{Bd.vha="OauthManager";0<=md&&(Bd.ayb=md);return Bd})}lmi(O){const Ta=(vd.AFrameworkApplication.fa.Xa(vd.AFrameworkApplication.n8)||"").toLowerCase();return(Oc.a.Pxa||"teams"===Ta&&Ac.a.lzb)&&!cd.Qli(O)||!this.uya||!this.uya.YMa()?!1:!0}qjf(){return this.Kug||1!==Hc.a.Nbc()}$Di(O){switch(O.ErrorCode){case "UserCancelled":case "interaction_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;
case "consent_required":case "invalid_grant":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:O=
O.ErrorCode===Dc.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:O.ErrorCode===Dc.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:O.ErrorCode===Dc.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:O.ErrorCode===Dc.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:O.ErrorCode===Dc.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return O}W0i(O){let Ta=
"";(O=RegExp("AADSTS(\\d+)").exec(O.ErrorMessage))&&1<O.length&&(Ta=O[1]);return Ta}static d6e(O){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,O)}static Qli(O){if(!O)return!1;O=O.toLowerCase();for(const Ta of Ub.AppsForOfficeSingleSignOnManager.mYe)if(Ta===O)return!0;return!1}}Object(d.a)(cd,"AppsforOfficeTokenFromOauthManager",null,[924]);class Wc{constructor(O){this.jDi=O}static Yoa(){if(vd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var O=
null;try{O=Ec.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ta){r.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ta)}O=new cd(O);Wc.Ma=new Wc(O)}}static getInstance(){Wc.Sae||(Wc.Yoa(),Wc.Sae=!0);return Wc.Ma}}Wc.Ma=null;Wc.Sae=!1;Object(d.a)(Wc,"AppsForOfficeOauthManagerFactory",null,[904]);var Id=a(1301),Vd=a(134);class re{constructor(O,Ta,Gb,hc){this.menuItemId=O;this.vG=Ta;this.PLj=Gb;this.QEh=hc}}Object(d.a)(re,"NewDocumentParameters",null,[]);const Me=O=>
{var Ta=O.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Gb=Ta.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Gb.addParameter("shortcuts","String[]",1,null,0);Ta.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Gb=Ta.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Gb.addParameter("shortcuts","Object",1,null,0);Ta=O.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Gb=Ta.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Gb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ta=O.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Gb=Ta.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Gb.addParameter("base64File","String",1,null,0);Ta=O.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Ta.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Gb=Ta.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Gb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ta=O.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ta.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Gb=Ta.addMethod("Register",1,"Void",0,0,"Register",0);Gb.addParameter("metadata","String",1,null,0);Gb.addParameter("javascript","String",1,null,0);Ta=O.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ta.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ta.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ta.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ta=O.addEnumType("Microsoft.Authentication.IdentityType");Ta.addEnumField("OrganizationAccount",
0);Ta.addEnumField("MicrosoftAccount",1);Ta=O.addEnumType("Microsoft.Authentication.AuthorityType");Ta.addEnumField("External",0);Ta.addEnumField("Msa",1);Ta.addEnumField("Aad",2);Ta=O.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ta.addProperty("DisplayName",4,"String",1,!1,null,0);Ta.addProperty("Email",3,"String",1,!1,null,0);Ta.addProperty("FederationProvider",2,"String",1,!1,null,0);Ta.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ta=O.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ta.addProperty("AppId",4,"String",1,!1,null,0);Ta.addProperty("Authority",2,"String",1,!1,null,0);Ta.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ta.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ta.addProperty("TenantId",6,"String",1,!1,null,0);Ta.addProperty("Upn",
1,"String",1,!1,null,0);Ta=O.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ta.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Gb=Ta.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Gb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ta.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Ta.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ta=O.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ta.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ta.addProperty("CorrelationId",7,"String",1,!1,null,0);Ta.addProperty("Policy",4,"String",1,!1,null,0);Ta.addProperty("Resource",2,"String",1,!1,null,0);Ta.addProperty("Scope",
5,"String",1,!1,null,0);Ta.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ta=O.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ta.addProperty("AccessToken",2,"String",1,!1,null,0);Ta.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ta=O.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ta.addProperty("Id",1,"String",1,
!0,null,0);Ta.addProperty("Value",2,"Object",1,!1,null,0);Ta=O.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Gb=Ta.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Gb.addParameter("id","String",1,null,0);Gb=Ta.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Gb.addParameter("id","String",1,null,0);Ta=O.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ta.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Gb=Ta.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Gb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ta=O.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ta.addEnumField("Inactive",0);Ta.addEnumField("Background",1);Ta.addEnumField("Visible",2);Ta=O.addEnumType("Microsoft.AppRuntime.Visibility");
Ta.addEnumField("Hidden",1);Ta.addEnumField("Visible",2);Ta=O.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ta.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Gb=Ta.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Gb.addParameter("jsonCreate","String",1,null,0);Gb=Ta.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Gb.addParameter("jsonUpdate",
"String",1,null,0);Gb=Ta.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Gb.addParameter("id","String",1,null,0);Gb=Ta.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Gb.addParameter("id","String",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ta=O.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ta.addProperty("Id",2,"String",1,!0,null,0);Gb=Ta.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Gb.addParameter("visibility","Boolean",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ta=O.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ta.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ta.addProperty("Id",2,"String",1,!0,null,0);Ta.addProperty("Label",4,"String",1,!0,null,0);Gb=Ta.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Gb.addParameter("enabled","Boolean",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Ta=O.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ta.addMethod("GetCount",3,"Int32",1,1,"Count",0);Gb=Ta.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Gb.addParameter("key","String",1,null,0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ta.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ta=O.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ta.addEnumField("Unknown",0);Ta.addEnumField("Basic",
1);Ta.addEnumField("Premium",2);Ta=O.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Gb=Ta.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Gb.addParameter("feature","String",1,null,0);Gb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Gb=Ta.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Gb.addParameter("feature","String",1,null,0);Gb=Ta.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Gb.addParameter("feature","String",1,null,0);Gb.addParameter("fallbackValue","Boolean",1,null,0);Ta.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Gb=Ta.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Gb.addParameter("experienceId","String",1,null,0);Gb=Ta.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Gb.addParameter("feature","String",1,null,0);Ta=O.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ta.addProperty("Id",5,"String",1,!0,null,0);Ta.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ta.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ta=O.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Ta.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ta=O.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ta.addMethod("Disable",3,"Void",0,1,"Disable",0);Ta.addMethod("Enable",2,"Void",0,1,"Enable",0);Ta.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var ef=a(186);class yf{constructor(O,Ta){this.czg=O;this.xzg=Ta}createAndOpenWorkbook(O){if(O&&
O.length>this.czg)throw r.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",O.length),OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,ef.a.ga(1760));const Ta=new re("blank","agave",O?"streamBase64":"streamEmpty",O);let Gb=null;return OfficeExtension.WacRuntime.Utility.createPromise((hc,wc)=>{const $c=new Vd.StandardDialog;$c.Rb=4;$c.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,hd=>{2===hd||0===hd?wc("Cancelled"):
(Gb=window.open(""),this.xzg.create(hc,wc,Ta).N1a())})}).then(hc=>{if(!hc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,ef.a.ga(1756));try{Gb.top.location.href=hc}catch(wc){r.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Oc.a.Bp,wc),r.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Gb.location.replace(hc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},hc=>{if("Cancelled"===hc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.pFd,ef.a.ga(1759));Gb.close();this.VOj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 1:return this.Q$g(Ta)}O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}Q$g(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.createAndOpenWorkbook(O)}VOj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,
ef.a.ga(1756));}}Object(d.a)(yf,"WacWorkbook",null,[]);const Sf=(O,Ta)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof O+", objectId="+O+", value="+Ta);return null},jf=O=>{O.add("InternalTest","PreviewExecutionMethod",Sf)};var Df=a(249),lf=a(732),Zf=a(740);class qg{constructor(O){this.jb=O}get $(){return this.jb}}Object(d.a)(qg,"RichApiPreviewExecutionContext",null,[]);var Fg=a(24),Gg=a(967),Ug=a(33),th=a(208),vf=a(211),ff=a(86),Cf=a(12);class Mf extends vf.a{constructor(O,
Ta,Gb,hc,wc){super(O,"Select Data");this.htmlSanitizationHelper=this.jqb=null;this.uKe=Ta;this.Q7c=Gb;this.htmlSanitizationHelper=wc;this.callback=hc}get qc(){return"DdaBindingPrompt"}start(O,Ta){let Gb="<div class='"+ff.a.buh+" "+Hg.a.Ao+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+ff.a.zz+"' /></div>";Gb=String.format(Gb,lg.a.Hg(this.Q7c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
z.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(this.Ib,Gb):this.Ib.innerHTML=Gb;this.jqb=Cf.DOMElementExtensions.getElementById(this.Ib,"bindingText");O=Ta?O.L3a(Ta,this.Q7c.DdaBindingsMethod.BindingId):null;(null===O||void 0===O?0:O.IsValidRef)?(Ta=new Fg.Range(O.Reference.FirstRow+1,O.Reference.FirstColumn+1,O.Reference.LastRow+1,O.Reference.LastColumn+1,!1,!1),this.jqb.value=O.Reference.SheetName+
"!"+Ta):(O=Ag.h(this.$).ha,this.jqb.value=Fh.f(this.$.oa)||!O.ra.Pg?"":O.Aia);this.initialize();this.xg()}uq(){this.u2c();this.addButton(0);this.addButton(1);super.uq()}setFocus(){Cf.DOMElementExtensions.setFocus(this.jqb)}validate(){return!0}commit(){let O=this.jqb.value.trim();const Ta=O.indexOf("!");-1!==Ta&&(O=this.K1h(O.substring(0,Ta))+O.substr(Ta));this.uKe.addBinding(this.Q7c,O,0,this.callback);return!0}$sa(){this.uKe.AQ.rf(lf.a.internalError,this.callback);super.$sa()}K1h(O){O=Eh.a.trimStart(O.trim(),
"=");return O.length?O.startsWith("'")&&O.endsWith("'")?O:Zh.HelperMethods.Q9b(O):""}}Object(d.a)(Mf,"DdaBindingPrompt",vf.a,[]);class Qf{constructor(O){this.ea=O}rf(O,Ta){if(Ta){const Gb={};Gb.Error=O;Gb.Version=this.ea.ze;Ta(Gb)}}MKa(O,Ta){this.rf(O,Ta)}IH(O,Ta){this.rf(lf.a.JZe(O.Errors[0].MessageId),Ta)}yv(O){O&&O(this.mQ())}mQ(){const O={Error:0};O.Version=this.ea.ze;return O}}Object(d.a)(Qf,"DdaErrorGenerator",null,[]);var Kf=a(282);class Lf{constructor(O,Ta,Gb){this.$=O;this.AQ=Ta;this.pA=
Gb}qAd(O,Ta){const Gb=O.DdaGoToByIdMethod.GoToType,hc=O.DdaGoToByIdMethod.SelectionMode,wc=O.DdaGoToByIdMethod.Id.toString().trim(),$c=hd=>{const md=this.$.xa.getItemByName(hd.SheetName);(null===md||void 0===md?0:md.visible)?(Ag.h(this.$).gg(hd,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.AQ.yv(Ta)):this.AQ.rf(lf.a.w0g,Ta)};0===Gb?this.XHi(wc,hc,O.DdaMethod.ControlId,$c,Ta):1===Gb?this.aIi(wc,hc,$c,Ta):this.AQ.rf(lf.a.RVj,Ta)}XHi(O,Ta,Gb,hc,wc){this.pA.ddaGetBinding(Gb,
O,$c=>{if(!Kf.a($c)&&$c.Result&&$c.Result.Reference){$c=$c.Result;var hd={};hd.SheetName=$c.Reference.SheetName;hd.FirstRow=$c.Reference.FirstRow;hd.FirstColumn=$c.Reference.FirstColumn;hd.LastRow=$c.Reference.LastRow;hd.LastColumn=$c.Reference.LastColumn;Lf.bYc(hd,Ta);1!==$c.BindingType?hc(hd):this.pA.ddaGetBindingData(Gb,O,1,0,2,0,0,-1,-1,md=>{Kf.a(md)||!md.Result?this.AQ.IH(md,wc):(md=md.Result,2!==Ta&&(hd.FirstRow-=md.Headers.length,0>hd.FirstRow&&(hd.FirstRow=0)),hc(hd))},wc)}else this.AQ.MKa(lf.a.N$f,
wc)},wc)}aIi(O,Ta,Gb,hc){var wc=Dh.z(O);wc?(wc=Dh.v(wc,this.$),Lf.bYc(wc,Ta),Gb(wc)):this.$.ea.isNamedObjectViewMode&&this.$.Cb.Qk(O)?this.$.Cb.oa=this.$.Cb.getItemByName(O):(wc=$c=>{Kf.a($c)||!$c.Result?this.$.xa.contains(O)?($c={},$c.SheetName=O,$c.FirstRow=0,$c.FirstColumn=0,$c.LastRow=0,$c.LastColumn=0,Gb($c)):this.AQ.MKa(lf.a.N$f,hc):($c=$c.Result,Lf.bYc($c,Ta),Gb($c))},this.$.xa.oa?this.pA.parseRangeForGoto(O,this.$.xa.oa.name,wc,hc):this.pA.parseRange(O,wc,hc))}static bYc(O,Ta){O.LastRow=2===
Ta?O.FirstRow:O.LastRow;O.LastColumn=2===Ta?O.FirstColumn:O.LastColumn}}Object(d.a)(Lf,"DdaNavigator",null,[]);const Nf=(O,Ta,Gb,hc,wc,$c)=>{const hd=O.Na(1);hd.request=Ta;return Eg.g(O,"ExecuteRichApiRequest",hd,Gb,hc,wc,$c,0)};var Of=a(295),ig;(function(O){O[O.unsupported=0]="unsupported";O[O.surface=1]="surface";O[O.combo=2]="combo";O[O.column=3]="column";O[O.column3D=4]="column3D";O[O.bar=5]="bar";O[O.bar3D=6]="bar3D";O[O.line=7]="line";O[O.line3D=8]="line3D";O[O.pie=9]="pie";O[O.pie3D=10]="pie3D";
O[O.scatter=11]="scatter";O[O.bubble=12]="bubble";O[O.area=13]="area";O[O.area3D=14]="area3D";O[O.doughnut=15]="doughnut";O[O.radar=16]="radar";O[O.stock=17]="stock";O[O.waterfall=18]="waterfall";O[O.funnel=19]="funnel";O[O.treemap=20]="treemap";O[O.sunburst=21]="sunburst";O[O.boxWhisker=22]="boxWhisker";O[O.histogram=23]="histogram";O[O.pareto=24]="pareto";O[O.regionMap=25]="regionMap";O[O.noVisibleSeries=26]="noVisibleSeries";O[O.complexDataSource=27]="complexDataSource";O[O.pivotChart=28]="pivotChart"})(ig||
(ig={}));Object(d.b)("ChartCategory",ig);class Xg{constructor(O,Ta){this.source=O;this.eventId=Ta}}Object(d.a)(Xg,"MacroRecorderEventData",null,[]);class Ff{constructor(O,Ta,Gb){this.parentName=O;this.$=Ta;this.request=Gb}c0h(O){var Ta;if(void 0===O||null===O||void 0===O.RequestBody||null===O.RequestBody)return null;const Gb=JSON.parse(O.RequestBody);if(void 0!==O.ActiveChartId&&null!==O.ActiveChartId){Gb.ActiveChartId=O.ActiveChartId;const hc=Ag.h(this.$).ha.Sa.$b;if(null===(Ta=null===hc||void 0===
hc?void 0:hc.floatingObject)||void 0===Ta?0:Ta.Vc)Gb.ActiveChartType=ig[hc.floatingObject.Vc.ChartCategory]}void 0!==O.SheetMultiRange&&null!==O.SheetMultiRange&&(Gb.SheetName=O.SheetMultiRange.SheetName);return Gb}q0h(O){if(void 0===O||null===O||void 0===O.Result||null===O.Result)return null;O=O.Result;return void 0===O.ResponseBody||null===O.ResponseBody||O.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(O.ResponseBody.join(""))}Mqi(O){return!!O&&!(void 0===O.eventId||null===O.eventId)&&
0<O.eventId.length}ik(O){return()=>{if(this.$.Pba){const Ta=this.KXg(this.request);if(this.Mqi(Ta)){const Gb=this.c0h(this.request),hc=this.q0h(O);if(Gb&&!Qh.a.isEmpty(Gb)&&hc&&!Qh.a.isEmpty(hc))return r.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new S(Ta,Gb,hc);r.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Gb?"(not null)":"(null)"}; responseInfo: ${hc?"(not null)":"(null)"}`}`)}}return new S(null,
null,null)}}KXg(O){const Ta=this.Nqi(O.SolutionId),Gb=Ff.J_h(O);if(Gb&&Ta)return r.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Gb,["request.SolutionId"]:O.SolutionId})}`),new Xg(O.SolutionId,Gb);O=JSON.stringify({["recorderEventId"]:Gb,["isRecorderAwareAddin"]:Ta,["request.SolutionId"]:O.SolutionId});r.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${O}`);return null}Nqi(O){if(!O)return!1;O=O.toLowerCase();return Ff.F5h().contains(O)}static F5h(){Ff.mAa||
(Ff.mAa=new v.a(Q.a.ak()),Ff.mAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ff.mAa.add("fa000000005"),Ff.mAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Ff.mAa.add("fa000000014"),Ff.mAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Ff.mAa}static J_h(O){let Ta=null;var Gb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Gb.test(O.RequestBody))Ta=Gb.exec(O.RequestBody)[1];else{O=O.RequestHeaders;if(!O)return Ta;Gb=pf.a.CKi.toLowerCase();for(let hc=0;hc<O.length;hc++)if(O[hc].Name.toLowerCase()===
Gb){Ta=O[hc].Value;break}}return Ta}}Ff.mAa=null;Object(d.a)(Ff,"DdaRichApiRequestRecorder",null,[]);class pi extends Of.a{constructor(O,Ta,Gb,hc,wc,$c,hd,md){super(10,0,Ta,md);this.Xmb=Gb;this.ojb=hc;this.Y3=wc;this.cGa=$c;this.request=hd;this.$Od=new Ff("10",O,hd)}get FEc(){return this.cGa}get Yt(){return this.Xmb}get Eaa(){return this.ojb}k3(O){return super.k3(O)||this.q_g(O)}ik(){return this.$Od.ik(this.nd)}Pfb(){const O={OperationType:3};O.RichApiRequest=this.request;return O}q_g(O){return(Ta,
Gb,hc)=>Nf(O,this.request,Rf.b(Ta,this.Xmb),Rf.a(Gb,this.ojb),hc,this.Y3)}}Object(d.a)(pi,"DdaRichApiRequestBatchOperation",Of.a,[]);class Di extends Gh.a{constructor(O,Ta,Gb,hc){super(576,0,Gb,hc);this.$Od=new Ff("576",O,Ta)}ik(){return this.$Od.ik(this.nd)}}Object(d.a)(Di,"DdaRichApiRequestOperation",Gh.a,[]);class Pi{constructor(O,Ta){this.zI=(Gb,hc)=>{this.AQ.MKa(lf.a.internalError,hc)};this.$=O;this.AQ=Ta}ddaAddBinding(O,Ta,Gb,hc,wc,$c,hd){this.jK((md,Bd,Qd)=>{var Pe=this.$.pa.ya,Ue=this.Oja();
md=Rf.b(md,$c);Bd=Rf.a(Bd,this.zI);const of=Pe.Na(9);of.controlId=O;of.bindingId=Ta;of.bindingType=Gb;of.currentSheetName=Ue;of.formula=hc;of.options=wc;return Eg.g(Pe,"DdaAddBinding",of,md,Bd,Qd,hd,0)},hd,563)}ddaReleaseBinding(O,Ta,Gb,hc){this.jK((wc,$c,hd)=>{var md=this.$.pa.ya;wc=Rf.b(wc,Gb);$c=Rf.a($c,this.zI);const Bd=md.Na(9);Bd.controlId=O;Bd.bindingId=Ta;return Eg.g(md,"DdaReleaseBinding",Bd,wc,$c,hd,hc,0)},hc,564)}ddaGetBinding(O,Ta,Gb,hc){this.jK((wc,$c,hd)=>{var md=this.$.pa.ya;wc=Rf.b(wc,
Gb);$c=Rf.a($c,this.zI);const Bd=md.Na(1);Bd.controlId=O;Bd.bindingId=Ta;return Eg.g(md,"DdaGetBinding",Bd,wc,$c,hd,hc,0)},hc,565,16)}ddaGetAllBindings(O,Ta,Gb){this.jK((hc,wc,$c)=>{var hd=this.$.pa.ya;hc=Rf.b(hc,Ta);wc=Rf.a(wc,this.zI);const md=hd.Na(1);md.controlId=O;return Eg.g(hd,"DdaGetAllBindings",md,hc,wc,$c,Gb,0)},Gb,566,16)}ddaGetBindingData(O,Ta,Gb,hc,wc,$c,hd,md,Bd,Qd,Pe){this.jK((Ue,of,tg)=>{var gg=this.$.pa.ya,Yf=this.Oja();Ue=Rf.b(Ue,Qd);of=Rf.a(of,this.zI);const $f=gg.Na(1);$f.controlId=
O;$f.bindingId=Ta;$f.coerceType=Gb;$f.valueFormat=hc;$f.filterType=wc;$f.startRow=$c;$f.startCol=hd;$f.rowCount=md;$f.colCount=Bd;$f.currentSheetName=Yf;return Eg.g(gg,"DdaGetBindingData",$f,Ue,of,tg,Pe,0)},Pe,567,16)}ddaSetBindingData(O,Ta,Gb,hc,wc,$c,hd){this.jK((md,Bd,Qd)=>{var Pe=this.$.pa.ya,Ue=this.Oja();md=Rf.b(md,$c);Bd=Rf.a(Bd,this.zI);const of=Pe.Na(9);of.controlId=O;of.bindingId=Ta;of.startRow=Gb;of.startCol=hc;of.currentSheetName=Ue;of.bindingData=wc;return Eg.g(Pe,"DdaSetBindingData",
of,md,Bd,Qd,hd,0)},hd,568)}ddaGetSelectedData(O,Ta,Gb,hc,wc,$c,hd){this.jK((md,Bd,Qd)=>{var Pe=this.$.pa.ya,Ue=this.Oja();md=Rf.b(md,$c);Bd=Rf.a(Bd,this.zI);const of=Pe.Na(1);of.controlId=O;of.coerceType=Ta;of.valueFormat=Gb;of.filterType=hc;of.currentSheetName=Ue;of.formula=wc;return Eg.g(Pe,"DdaGetSelectedData",of,md,Bd,Qd,hd,0)},hd,569,16)}ddaSetSelectedData(O,Ta,Gb,hc,wc){this.jK(($c,hd,md)=>{var Bd=this.$.pa.ya,Qd=this.Oja();$c=Rf.b($c,hc);hd=Rf.a(hd,this.zI);const Pe=Bd.Na(9);Pe.controlId=O;
Pe.currentSheetName=Qd;Pe.formula=Ta;Pe.bindingData=Gb;return Eg.g(Bd,"DdaSetSelectedData",Pe,$c,hd,md,wc,0)},wc,570)}ddaLoadSettings(O,Ta,Gb){this.jK((hc,wc,$c)=>{var hd=this.$.pa.ya;hc=Rf.b(hc,Ta);wc=Rf.a(wc,this.zI);const md=hd.Na(1);md.controlId=O;return Eg.g(hd,"DdaLoadSettings",md,hc,wc,$c,Gb,0)},Gb,501,16)}ddaSaveSettings(O,Ta,Gb,hc,wc){this.jK(($c,hd,md)=>{var Bd=this.$.pa.ya;$c=Rf.b($c,hc);hd=Rf.a(hd,this.zI);const Qd=Bd.Na(9);Qd.controlId=O;Qd.settings=Ta;Qd.overwriteIfStale=Gb;return Eg.g(Bd,
"DdaSaveSettings",Qd,$c,hd,md,wc,0)},wc,571)}ddaAddRowsColumns(O,Ta,Gb,hc,wc,$c){this.jK((hd,md,Bd)=>{var Qd=this.$.pa.ya,Pe=this.Oja();hd=Rf.b(hd,wc);md=Rf.a(md,this.zI);const Ue=Qd.Na(9);Ue.controlId=O;Ue.bindingId=Ta;Ue.isRow=Gb;Ue.currentSheetName=Pe;Ue.bindingData=hc;return Eg.g(Qd,"DdaAddRowsColumns",Ue,hd,md,Bd,$c,0)},$c,572)}ddaDeleteAllDataValues(O,Ta,Gb,hc){this.jK((wc,$c,hd)=>{var md=this.$.pa.ya,Bd=this.Oja();wc=Rf.b(wc,Gb);$c=Rf.a($c,this.zI);const Qd=md.Na(9);Qd.controlId=O;Qd.bindingId=
Ta;Qd.currentSheetName=Bd;return Eg.g(md,"DdaDeleteAllDataValues",Qd,wc,$c,hd,hc,0)},hc,573)}ddaClearBindingFormats(O,Ta,Gb,hc){this.jK((wc,$c,hd)=>{var md=this.$.pa.ya,Bd=this.Oja();wc=Rf.b(wc,Gb);$c=Rf.a($c,this.zI);const Qd=md.Na(9);Qd.controlId=O;Qd.bindingId=Ta;Qd.currentSheetName=Bd;return Eg.g(md,"DdaClearBindingFormats",Qd,wc,$c,hd,hc,0)},hc,574)}ddaSetBindingFormats(O,Ta,Gb,hc,wc,$c){this.jK((hd,md,Bd)=>{var Qd=this.$.pa.ya,Pe=this.Oja();hd=Rf.b(hd,wc);md=Rf.a(md,this.zI);const Ue=Qd.Na(9);
Ue.controlId=O;Ue.bindingId=Ta;Ue.currentSheetName=Pe;Ue.bindingData=Gb;Ue.isSetFormats=hc;return Eg.g(Qd,"DdaSetBindingFormats",Ue,hd,md,Bd,$c,0)},$c,575)}parseRange(O,Ta,Gb){this.jK((hc,wc,$c)=>{const hd=this.$.pa.ya.Wb();return Eg.v(this.$.pa.ya,O,-1,Rf.b(hc,Ta),Rf.a(wc,this.zI),$c,Gb,hd)},Gb,162,16)}parseRangeForGoto(O,Ta,Gb,hc){this.jK((wc,$c,hd)=>{const md=this.$.pa.ya.Wb();return Eg.w(this.$.pa.ya,O,Ta,Rf.b(wc,Gb),Rf.a($c,this.zI),hd,hc,md)},hc,562,16)}executeRichApiRequest(O,Ta,Gb){z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(O.RequestFlags&=8191);if(z.EwaSettings.ma(255))this.aDh(this.$.pa.ya.Wb(),Ta,()=>{this.AQ.MKa(lf.a.internalError,Gb)},Gb,O);else{let hc=Ad.DdaFacade.Thd(O);!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.uy||hc&16?(hc|=64,this.$.userOperationManager.oD(new Di(this.$,O,(wc,$c,hd)=>Nf(this.$.pa.ya,O,Rf.b(wc,Ta),Rf.a($c,this.zI),hd,Gb),hc))):(this.AQ.MKa(lf.a.EFc,Gb),r.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}Oja(){return this.$.ea.isNamedObjectViewMode?
this.$.oa.sheetName:this.$.activeItemName}jK(O,Ta,Gb,hc=0){!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.uy||hc&16?this.$.userOperationManager.oD(new Gh.a(Gb,0,O,hc|64)):(this.AQ.MKa(lf.a.EFc,Ta),r.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}aDh(O,Ta,Gb,hc,wc){let $c=Ad.DdaFacade.Thd(wc);if(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.uy||$c&16){var hd=this.$.Kb.Bc("UserAction",
"Rich Api request");this.$.userOperationManager.Ic(new pi(this.$,O,Ta,Gb,hc,hd,wc,$c|64),null)}else this.AQ.MKa(lf.a.EFc,hc),r.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(d.a)(Pi,"DdaWebServiceHelper",null,[]);class Ei{constructor(O,Ta,Gb,hc){this.EEh=O;this.fileSize=Ta;this.oIj=hc}}Object(d.a)(Ei,"DocumentFile",null,[]);class bg{}bg.generalException="GeneralException";bg.gQg="ApiNotFound";bg.pFd="OperationCancelled";bg.invalidArgument="InvalidArgument";Object(d.a)(bg,
"ErrorCodes",null,[]);class Lg{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(d.a)(Lg,"WacApiDelegates",null,[]);var bh=a(615);class Xf extends Lg{constructor(O,Ta){super();this.cmf=(Gb,hc)=>{Gb=Xf.k9g(Gb,hc);if(!bh.a(this.$,Gb))return!0;Gb=this.$.shortcutKeyManager.s7e(Gb);return!!Gb&&
0<Gb.length};this.addinId=O;this.$=Ta}replaceShortcuts(O){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,O,this.cmf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(O){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(O,this.cmf)}static Mch(O,Ta){const Gb=document.createEvent("KeyboardEvent");if(Oc.a.SF)Gb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(O&8),!!(O&32),!!(O&4),!!(O&256));else{const hc=
[];O&4&&hc.push("Shift");O&8&&hc.push("Control");O&32&&hc.push("Alt");Gb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,hc.join(" "),!1,"en-US")}O=new Sys.UI.DomEvent(Gb);O.keyCode=Ta;return O}static k9g(O,Ta){if(Oc.a.Jf)switch(Ta){case 189:Ta=173;break;case 187:Ta=61;break;case 186:Ta=59}return Xf.Mch(O,Ta)}}Object(d.a)(Xf,"ExcelWacApiDelegates",Lg,[]);class jg{constructor(O){this.yJa={};this.REi=O}xHg(O,Ta){this.Wec(O)||(this.yJa[O]={});if(this.Pli(O))return r.ULS.sendTraceTag(537163157,344,
50,`App ${O} has reach the limit of number of cached files.`),lf.a.AFi;this.yJa[O][Ta.EEh.toString()]=Ta;return lf.a.success}sSh(O,Ta){let Gb=null;this.Wec(O)&&(Gb=this.yJa[O][Ta.toString()]);Gb||r.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${O}, fileHandler:${Ta}] doesn't exist`);return Gb}Wec(O){return O in this.yJa}kej(O,Ta){if(this.Wec(O)){const Gb=this.yJa[O];delete Gb[Ta.toString()];1>Object.keys(Gb).length&&delete this.yJa[O];return Ta.toString()in Gb?lf.a.internalError:lf.a.success}return lf.a.internalError}Pli(O){return this.Wec(O)?
Object.keys(this.yJa[O]).length>=this.REi:!1}static getInstance(O){return O.da.Aa(200)||O.da.Ga(200,new jg(jg.SEi))}static JIi(){return++jg.GZg}}jg.vEi=4194304;jg.SEi=1;jg.GZg=0;Object(d.a)(jg,"GetFileApiHelper",null,[]);class fh{constructor(O){this.GA=O}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.GA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.oJi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){O=this.invokeMethod(O,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}oJi(){this.notifyActionHandlerReady();return null}}Object(d.a)(fh,"AddinInternalService",null,[]);class uh{constructor(O,Ta){this.qJ=Ta;this.GA=O}getAppRuntimeState(){return this.qJ.getAppRuntimeState(this.GA)?2:1}setAppRuntimeState(O){switch(O){case 2:O=!0;break;case 1:O=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,ef.a.ga(1760));}this.qJ.setAppRuntimeState(this.GA,O)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,Ta){switch(O){case 2:return this.yNh();case 1:return this.cuj(Ta)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,
Ta){O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}yNh(){return this.getAppRuntimeState()}cuj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");this.setAppRuntimeState(O);return null}}Object(d.a)(uh,"AppRuntimeService",null,[]);var Ah=a(968);class Wh{constructor(O,Ta,Gb,hc){this.yx=O;this.W1=Gb;this.az=hc.Yh.getOsfControl(Ta)}disable(){try{if(!ef.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.kHe();
if(!this.zlf())return this.lHe();this.W1.WUj(this.yx)}catch(O){return r.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",O.message||"Unknown"),this.iHe()}return null}enable(){try{if(!ef.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.kHe();if(!this.zlf())return this.lHe();this.W1.icj(this.yx)}catch(O){return r.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
O.message||"Unknown"),this.iHe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.eDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 3:return this.Zlh();case 2:return this.Oqh()}O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}Zlh(){return this.disable()}Oqh(){return this.enable()}eDa(){this._OnAccess();return null}kHe(){return Ah.a(eg.a.notImplemented,
ef.a.ga(1761))}lHe(){return Ah.a(eg.a.sharedRuntimeNotAvailable,ef.a.ga(1765))}iHe(){return Ah.a(eg.a.generalException,ef.a.ga(1756))}zlf(){const O=this.az.getSharedRuntimeId();return!!O&&0<O.length}}Object(d.a)(Wh,"BeforeDocumentCloseNotification",null,[]);class $i{constructor(){this.tle=this.Afe=this.zA=!1}get enabled(){return this.zA}set enabled(O){this.zA=O}get nativeRuntime(){return this.Afe}set nativeRuntime(O){this.Afe=O}get streamingEnabled(){return this.tle}set streamingEnabled(O){this.tle=
O}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(O){switch(O){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Ta){switch(O){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ta,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Ta){O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(d.a)($i,"CustomFunctionEngineStatus",null,[]);class aj{constructor(O,Ta,Gb){this.oxg=O;this.pxg=Ta;this.iBg=Gb}get status(){const O=new $i;O.enabled=this.oxg;O.streamingEnabled=this.pxg;O.nativeRuntime=!1;return O}register(O){return OfficeExtension.WacRuntime.Utility.createPromise(this.iBg(O))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(O){switch(O){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 1:return this.Xcj(Ta)}O=this.invokeMethod(O,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}Xcj(O){const Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"string");return this.register(Ta,O)}}Object(d.a)(aj,"CustomFunctionManager",null,[]);var bj=a(945);class cj{constructor(O,Ta,Gb,hc){this.y6d="";this.mUb=0;this.rP=O;this._id=Ta;this.GA=Gb;this.qJ=hc}get id(){return this._id}_RegisterStateChange(){this.mUb||this.rP.execute(O=>
{this.y6d=O.kna(this._id,Ta=>{this.qJ.JGh(this.GA,this._id,JSON.stringify(Ta))})});this.mUb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.mUb--;this.mUb||this.rP.execute(O=>{O.CLd(this._id,this.y6d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(O){switch(O){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 6:return this.Qqg();case 7:return this.Sqg()}O=
this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}Qqg(){return this._RegisterStateChange()}Sqg(){return this._UnregisterStateChange()}}Object(d.a)(cj,"LicenseFeature",null,[]);class dj{constructor(O,Ta){this.rP=Ec.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.GA=O;this.qJ=Ta;this.$zg=this.qJ.Yh.getOsfControl(this.GA)}getFeatureTier(O,Ta){return OfficeExtension.WacRuntime.Utility.createPromise(Gb=>{const hc=1===Ta?1:2===
Ta?2:0;this.rP.execute(wc=>{wc.getFeatureTier(O,hc).then($c=>{Gb(this.FWh($c))},()=>{Gb(Ta)})})})}getLicenseFeature(O){O=new cj(this.rP,O,this.GA,this.qJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}isFeatureEnabled(O,Ta){return OfficeExtension.WacRuntime.Utility.createPromise(Gb=>{this.rP.execute(hc=>{hc.isFeatureEnabled(O,Ta).then(wc=>{Gb(wc)},()=>{Gb(Ta)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(O=>{this.rP.execute(Ta=>{Ta=
Ta.isFreemiumUpsellEnabled();O(Ta)})})}launchUpsellExperience(O){if(this.$zg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.rP.execute(Ta=>{Ta.launchUpsellExperience(O)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.vVc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,Ta){switch(O){case 6:return this.Rqg(Ta)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 2:return this.lTh(Ta);case 5:return this.EWh(Ta);
case 1:return this.Bmi(Ta);case 3:return this.mni();case 4:return this.bxi(Ta)}O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}lTh(O){const Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"int");return this.getFeatureTier(Ta,O)}EWh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getLicenseFeature(O)}Bmi(O){const Ta=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"boolean");return this.isFeatureEnabled(Ta,O)}mni(){return this.isFreemiumUpsellEnabled()}bxi(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.launchUpsellExperience(O)}Rqg(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");this._TestFireStateChangedEvent(O);return null}FWh(O){switch(O){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(dj,"License",
null,[]);var jj=a(153);const kj=(O,Ta,Gb)=>hc=>(wc,$c)=>{Vf.TaskExtensions.za(wg.GetServiceTaskFactory.create(Ta.da,279,Ta.ka,1),hd=>{hd=hd.result;let md=!1;var Bd=Gb.Yh.getOsfControl(O);let Qd=null;Bd&&(Qd=Bd.getStoreType(),(Bd=Bd.getManifest())&&Bd.getSharedRuntimeForCustomFunctions("Workbook")&&(md=!0));Vf.TaskExtensions.za(hd.qff(O,Qd,hc,md),Pe=>{jj.b(Pe)?Pe.result?wc(null):$c(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,gd.a.instance.ga(1760))):$c(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,
gd.a.instance.ga(1756)))},Ta.ka,3)},Ta.ka,3)};class Xi{constructor(O){if(!O)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.tyd=O}areShortcutsInUse(O){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,Gb)=>{this.tyd.checkShortcutsInUse(O).then(hc=>{Ta(hc)}).catch(hc=>{Gb(hc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((O,Ta)=>{this.tyd.getShortcuts().then(Gb=>{O(Gb)}).catch(Gb=>{Ta(Gb)})})}replaceShortcuts(O){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,
Gb)=>{this.tyd.replaceShortcuts(O).then(()=>{Ta(null)}).catch(hc=>{Gb(hc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Ta){switch(O){case 3:return this.QRg(Ta);case 1:return this.P1h();case 2:return this.Kjj(Ta)}O=this.invokeMethod(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}QRg(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"Array<string>");return this.areShortcutsInUse(O)}P1h(){return this.getShortcuts()}Kjj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"any");return this.replaceShortcuts(O)}}Object(d.a)(Xi,"ActionService",
null,[]);var ej=a(520);class fj{constructor(){this.Kra=null}C1h(){this.Kra||(this.Kra=ej.a.jr(Ec.a.instance.Ub("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Kra}getSharedFilePickerResponse(O){return OfficeExtension.WacRuntime.Utility.createPromise((Ta,Gb)=>{try{const hc=this.C1h();jh.Task.WAA.call(null,hc).continueWith(()=>{const wc=hc.result;if(wc){let $c={};({Ft:$c}=Ef.d(O)).returnValue?wc.Cgd($c).then(hd=>{hd&&0<hd.length?Ta(hd):Gb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(hd=>{Gb(hd)}):Gb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Gb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(hc){Gb(hc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Ta){this.invokePropertySet(O,Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Ta){switch(O){case 1:return this.B1h(Ta)}O=this.invokeMethod(O,
Ta);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}B1h(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getSharedFilePickerResponse(O)}}Object(d.a)(fj,"SharedFilePicker",null,[]);class gj{createInstance(O,Ta){switch(O){case "Microsoft.Office.ActionService":return new Xi(Ta);case "Microsoft.Office.SharedFilePicker":return new fj}return null}}Object(d.a)(gj,"WacApiHost",null,[]);class hj{constructor(O,Ta,Gb,hc,wc){this.aVc=null;this.vSb=
O;this.GA=Ta;this.qJ=Gb;this.jb=hc;this.eFg=wc}hostName(){return"ExcelOnline"}appId(){return this.vSb}createInstance(O){switch(O){case "Microsoft.Authentication.AuthenticationService":return Ec.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.GA,this.qJ.Yh);case "Microsoft.Authentication.TokenParameters":return new R;case "Microsoft.ExcelServices.CustomFunctionManager":O=this.jb.ma(120);var Ta=this.jb.ma(121);return new aj(O,Ta,kj(this.vSb,
this.jb,this.qJ));case "Microsoft.AppRuntime.AppRuntimeService":return new uh(this.GA,this.qJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return O=Df.a(this.jb),new Wh(this.vSb,this.GA,O,this.qJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return O=Df.a(this.jb),new bj.DynamicRibbon(this.vSb,this.GA,this.qJ,O,O.yn(this.GA).xl);case "Microsoft.Office.Licensing.License":return new dj(this.GA,this.qJ);case "Microsoft.InternalService.AddinInternalService":return new fh(this.GA);
default:if(this.aVc||(this.aVc=new gj),Ta=this.aVc.createInstance(O,this.eFg))return Ta}r.ULS.sendTraceTag(537163155,0,10,`Typename: ${O} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,eg.a.generalException);}}Object(d.a)(hj,"RichApiHost",null,[]);var lj=a(384),ij=a(28),mj=a(118),Yi=a(35),nj=a(100),oj=a(285),pj=a(44),qj=a(250),rj=a(6),sj=a(70),tj=a(201);class Af{constructor(O,Ta,Gb,hc){this.htmlSanitizationHelper=
this.rangePicker=null;this.$=O;this.je=Ta;this.htmlSanitizationHelper=hc;this.ye=new Qf(O.ea);this.pA=new Pi(O,this.ye);this.Wwf=Gb;this.X$b=new Map}get AQ(){return this.ye}dispose(){this.$=this.X$b=null}nc(){return!1}Kc(){return!1}executeCommand(O,Ta,Gb){O=Ta.command;switch(O){case 451041795:this.ye.rf(Gb[Pg.a.og],Gb[Pg.a.Y3]);break;case 974713501:this.d8h(Gb[Pg.a.og],Gb[Pg.a.Y3]);break;case 1237877382:this.ye.yv(Gb[Pg.a.Y3]);break;default:return $h.a(O)}return jh.Task.Ta(!0)}wc(O,Ta,Gb){if(O=!!Gb)switch(Ta.command){case 974713501:case 1237877382:case 451041795:break;
default:O=!1}return O}d8h(O,Ta){var Gb,hc;const wc=O.DdaMethod;"undefined"===typeof wc.DispatchId?this.ye.rf(lf.a.internalError,Ta):Af.Hli(O)||this.$.qd&1?(wc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Mf(this.$,this,O,Ta,this.htmlSanitizationHelper)).start(this.je,O.DdaMethod.ControlId):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.b1h(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.Cyj(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(O,this.Xfd(O.DdaMethod.ControlId),0,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.cOh(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.ouj(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.bOh(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.jej(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.cNh(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.swd(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(O.DdaAddRowsColumns.IsRow=!0,this.eqe(O,Ta)):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(O.DdaAddRowsColumns.IsRow=!1,this.eqe(O,Ta)):wc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Hjh(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.n3g(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(O.DdaSetBindingFormats.IsSetFormats=!0,this.Q2f(O,Ta)):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(O.DdaSetBindingFormats.IsSetFormats=!1,this.Q2f(O,Ta)):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(O,O.DdaBindingsMethod.ItemName,O.DdaBindingsMethod.FailOnCollision?2:1,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.pTh(Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.qAd(O,Ta):wc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.pSh(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.qSh(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.lej(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(O.DdaMethod.ControlId,O),this.ye.yv(Ta)):
wc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?z.EwaSettings.ma(23)?this.ye.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):this.WFi(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?z.EwaSettings.ma(23)?this.ye.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ta):this.SFi(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(O,Ta):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(O,Ta):this.ye.rf(lf.a.tFd,Ta),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&wc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(O=this.je.KZ(O.DdaMethod.ControlId),Ta="",O&&(Ta=Ad.DdaFacade.getSolutionId(O,this.$),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Ta=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta,O.OwnerAddinStoreType||O.PrimaryMarketplace.MarketplaceType,null===
(Gb=O.AssetMarketplace)||void 0===Gb?void 0:Gb.SolutionId,null,null,O.PrimaryMarketplace.MarketplaceRef):(Gb=O.PrimaryMarketplace.MarketplaceType,Gb===OSF.StoreType.InMemory?O.OwnerAddinSolutionId&&O.AssetMarketplace&&(Gb=O.AssetMarketplace.MarketplaceType):Gb===OSF.StoreType.WopiCatalog&&(Gb=OSF.StoreType.OMEX),Ta=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta,Gb,null===(hc=O.AssetMarketplace)||void 0===hc?void 0:hc.SolutionId,null,null,O.PrimaryMarketplace.MarketplaceRef))),r.ULS.sendTraceTag(537163224,
344,50,`DDA method Id: ${wc.DispatchId}, AppID: ${Ta}`))):this.ye.rf(lf.a.nNe,Ta)}cOh(O,Ta){O.DdaGetBindingData.CoerceType=Af.D4b(O.DdaGetBindingData.CoerceType);O.DdaGetBindingData.FilterType=Af.xXe(O.DdaGetBindingData.FilterType);O.DdaGetBindingData.ValueFormat=Af.dlg(O.DdaGetBindingData.ValueFormat);if(this.nkc(O.DdaGetBindingData.CoerceType,Ta)){if(O.DdaGetBindingData){const Gb=O.DdaGetBindingData;0===Gb.FilterType&&(Gb.FilterType=2);Gb.StartCol|=0;Gb.StartRow|=0;Gb.ColCount=void 0===Gb.ColCount?
-1:Gb.ColCount;Gb.RowCount=void 0===Gb.RowCount?-1:Gb.RowCount}this.pA.ddaGetBindingData(O.DdaMethod.ControlId,O.DdaGetBindingData.BindingId,O.DdaGetBindingData.CoerceType,O.DdaGetBindingData.ValueFormat,O.DdaGetBindingData.FilterType,O.DdaGetBindingData.StartRow,O.DdaGetBindingData.StartCol,O.DdaGetBindingData.RowCount,O.DdaGetBindingData.ColCount,Gb=>{if(Kf.a(Gb)||!Gb.Result)this.ye.IH(Gb,Ta);else{const hc=this.ye.mQ();hc.Data=Af.Eye(Gb.Result);Ta(hc)}},Ta)}}ouj(O,Ta){O.DdaSetBindingData.CoerceType=
Af.D4b(O.DdaSetBindingData.CoerceType);if(this.nkc(O.DdaSetBindingData.CoerceType,Ta)){var Gb=Af.X_c(O.DdaSetBindingData.CoerceType,O.DdaSetBindingData.Data);Af.jhc(Gb)?this.ye.rf(lf.a.qDc,Ta):(1===Gb.CoerceType&&(Gb.CellFormat||(Gb.CellFormat=O.DdaSetBindingData.CellFormat),Gb.TableOptions||(Gb.TableOptions=O.DdaSetBindingData.TableOptions)),O.DdaSetBindingData&&(O.DdaSetBindingData.StartCol|=0,O.DdaSetBindingData.StartRow|=0),this.pA.ddaSetBindingData(O.DdaMethod.ControlId,O.DdaSetBindingData.BindingId,
O.DdaSetBindingData.StartRow,O.DdaSetBindingData.StartCol,Gb,hc=>{Kf.a(hc)?this.ye.IH(hc,Ta):this.ye.yv(Ta)},Ta))}}b1h(O,Ta){O.DdaGetBindingData.CoerceType=Af.D4b(O.DdaGetBindingData.CoerceType);O.DdaGetBindingData.ValueFormat=Af.dlg(O.DdaGetBindingData.ValueFormat);O.DdaGetBindingData.FilterType=Af.xXe(O.DdaGetBindingData.FilterType);if(this.nkc(O.DdaGetBindingData.CoerceType,Ta)){var Gb=this.Xfd(O.DdaMethod.ControlId);Gb?this.pA.ddaGetSelectedData(O.DdaMethod.ControlId,O.DdaGetBindingData.CoerceType,
O.DdaGetBindingData.ValueFormat,O.DdaGetBindingData.FilterType,Gb,hc=>{if(Kf.a(hc))this.ye.IH(hc,Ta);else{const wc=this.ye.mQ();wc.Data=Af.Eye(hc.Result);Ta(wc)}},Ta):this.ye.rf(lf.a.b7e,Ta)}}pSh(O,Ta){const Gb=O[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],hc=O[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],wc=O.DdaMethod.ControlId,$c=jg.getInstance(this.$);if(0>=hc)r.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.ye.rf(lf.a.oii,
Ta);else if(hc>jg.vEi)r.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.ye.rf(lf.a.W1e,Ta);else{var hd=null;switch(Gb){case 1:hd="Compressed";break;case 0:hd="Text";break;case 2:hd="Pdf";break;default:r.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Gb} is not supported.`);this.ye.rf(lf.a.kXe,Ta);return}if("Text"===hd)r.ULS.sendTraceTag(537163218,344,15,`Requested file type ${hd} is not supported.`),this.ye.rf(lf.a.kXe,Ta);else{z.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(O=new Sys.StringBuilder,O.append(Gg.a(this.$,hd)),"Pdf"===hd&&th.a.zk(O,pf.a.APf,"WholeWorkbook"),O=O.toString()):O=Gg.a(this.$,hd);var md=null,Bd=new XMLHttpRequest;Bd.onreadystatechange=()=>{if(4===Bd.readyState)if(200===Bd.status){var Qd=Bd.response;if(Qd){md=new Uint8Array(Qd);Qd=this.ye.mQ();var Pe=md.length,Ue=jg.JIi(),of={},tg=0;for(let gg=0;gg<Pe;gg+=hc){const Yf=[],$f=gg+hc<Pe?gg+hc:Pe;for(let mg=0,Mg=gg;Mg<$f;mg++,Mg++)Yf[mg]=md[Mg];of[(tg++).toString()]=Yf}of=new Ei(Ue,Pe,hc,of);of=$c.xHg(wc,
of);of!==lf.a.success?this.ye.rf(of,Ta):(Qd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Ue,Qd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Pe,r.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${hd}, the file size is ${Pe}`),Ta(Qd))}else r.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${hd}.`),this.ye.rf(lf.a.internalError,Ta)}else 500===Bd.status?this.ye.rf(lf.a.JZe(parseInt(Bd.statusText,
10)),Ta):(r.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${hd}.`),this.ye.rf(lf.a.qIi,Ta))};Bd.open("GET",O,!0);Bd.responseType="arraybuffer";Bd.setRequestHeader("If-Modified-Since","0");Bd.send(null)}}}qSh(O,Ta){var Gb=O[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],hc=O[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];O=O.DdaMethod.ControlId;(Gb=jg.getInstance(this.$).sSh(O,Gb))?(Gb=Gb.oIj,0>hc||hc>=Object.keys(Gb).length?this.ye.rf(lf.a.$ci,
Ta):(hc=Gb[hc.toString()],Gb=this.ye.mQ(),Gb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=hc,Gb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=hc.length,Ta(Gb))):this.ye.rf(lf.a.internalError,Ta)}lej(O,Ta){var Gb=O[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];O=O.DdaMethod.ControlId;Gb=jg.getInstance(this.$).kej(O,Gb);Gb===lf.a.success?this.ye.yv(Ta):this.ye.rf(Gb,Ta)}Cyj(O,Ta){O.DdaSetBindingData.CoerceType=Af.D4b(O.DdaSetBindingData.CoerceType);if(this.nkc(O.DdaSetBindingData.CoerceType,
Ta)){var Gb=this.Xfd(O.DdaMethod.ControlId);if(Gb){var hc=Af.X_c(O.DdaSetBindingData.CoerceType,O.DdaSetBindingData.Data),wc=Ag.h(this.$).ha;1===hc.CoerceType&&(!hc.Data&&wc.ra.Q5&&(hc.Headers||(hc.Headers=[]),hc.Headers.length||hc.Headers.push([]),hc.Headers[0].length||hc.Headers[0].push("")),Af.jhc(hc)||(hc.CellFormat||(hc.CellFormat=O.DdaSetBindingData.CellFormat),hc.TableOptions||(hc.TableOptions=O.DdaSetBindingData.TableOptions)));if(Af.jhc(hc))this.ye.rf(lf.a.qDc,Ta);else{var $c=wc.ra.dd.clone(),
hd=wc.ra.activeCell.clone();this.pA.ddaSetSelectedData(O.DdaMethod.ControlId,Gb,hc,md=>{var Bd;if(Kf.a(md))this.ye.IH(md,Ta);else{md=$c.clone();const Qd=hc.Headers?hc.Headers[0].length:hc.Data[0].length;1!==hc.CoerceType||hc.Data?1===hc.CoerceType&&(null===(Bd=hc.TableOptions)||void 0===Bd?0:Bd.length)&&0==hc.TableOptions[0]?(md.top+=1,md.bottom=md.top+hc.Data.length-1):md.bottom=md.top+hc.Data.length-(1===hc.CoerceType?0:1):md.bottom=md.top+1;md.right=md.left+Qd-1;Bd=md.contains(hd)?hd:md.topLeft;
wc.updateSelection(md,Bd,0);this.ye.yv(Ta)}},Ta)}}else this.ye.rf(lf.a.dBe,Ta)}}addBinding(O,Ta,Gb,hc){Ta?this.pA.ddaAddBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,O.DdaBindingsMethod.BindingType,Ta,Gb,wc=>{if(Kf.a(wc))this.ye.IH(wc,hc);else{const $c=this.ye.mQ();$c.Bindings=Array(1);$c.Bindings[0]=this.je.j2b(wc.Result);hc($c)}},hc):this.ye.rf(lf.a.Hrj,hc)}bOh(O,Ta){this.pA.ddaGetBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Gb=>{if(Kf.a(Gb)||!Gb.Result)this.ye.IH(Gb,
Ta);else{const hc=this.ye.mQ();hc.Bindings=Array(1);hc.Bindings[0]=this.je.j2b(Gb.Result);Ta(hc)}},Ta)}pTh(O){const Ta=this.ye.mQ(),Gb={};Gb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ta[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Gb;O(Ta)}jej(O,Ta){this.pA.ddaReleaseBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Gb=>{Kf.a(Gb)?this.ye.IH(Gb,Ta):this.ye.yv(Ta)},Ta)}cNh(O,Ta){this.pA.ddaGetAllBindings(O.DdaMethod.ControlId,Gb=>
{if(Kf.a(Gb))this.ye.IH(Gb,Ta);else{const hc=this.ye.mQ();if(Gb.Result){Gb=Gb.Result;hc.Bindings=Array(Gb.length);for(let wc=0;wc<Gb.length;wc++)hc.Bindings[wc]=this.je.j2b(Gb[wc])}else hc.Bindings=null;Ta(hc)}},Ta)}swd(O,Ta){this.pA.ddaLoadSettings(O.DdaMethod.ControlId,Gb=>{if(Kf.a(Gb))this.ye.IH(Gb,Ta);else{const hc=this.ye.mQ();hc.Properties=Gb.Result;Ta(hc)}},Ta)}saveSettings(O,Ta){const Gb={Settings:[]};for(let hc=0;hc<O.DdaSettingsMethod.Properties.length;hc++){const wc={};wc.Name=O.DdaSettingsMethod.Properties[hc][0];
wc.Value=O.DdaSettingsMethod.Properties[hc][1];Gb.Settings[hc]=wc}this.pA.ddaSaveSettings(O.DdaMethod.ControlId,Gb,O.DdaSettingsMethod.OverwriteIfStale,hc=>{Kf.a(hc)?this.ye.IH(hc,Ta):this.ye.yv(Ta)},Ta)}eqe(O,Ta){const Gb=Af.X_c(1,O.DdaAddRowsColumns.Data);Af.jhc(Gb)?this.ye.rf(lf.a.qDc,Ta):this.pA.ddaAddRowsColumns(O.DdaMethod.ControlId,O.DdaAddRowsColumns.BindingId,O.DdaAddRowsColumns.IsRow,Gb,hc=>{Kf.a(hc)?this.ye.IH(hc,Ta):this.ye.yv(Ta)},Ta)}Hjh(O,Ta){this.pA.ddaDeleteAllDataValues(O.DdaMethod.ControlId,
O.DdaBindingsMethod.BindingId,Gb=>{Kf.a(Gb)?this.ye.IH(Gb,Ta):this.ye.yv(Ta)},Ta)}n3g(O,Ta){this.pA.ddaClearBindingFormats(O.DdaMethod.ControlId,O.DdaClearBindingFormats.BindingId,Gb=>{Kf.a(Gb)?this.ye.IH(Gb,Ta):this.ye.yv(Ta)},Ta)}Q2f(O,Ta){const Gb={},hc=O.DdaSetBindingFormats.IsSetFormats;hc?Gb.CellFormat=O.DdaSetBindingFormats.CellFormat:Gb.TableOptions=O.DdaSetBindingFormats.TableOptions;this.pA.ddaSetBindingFormats(O.DdaMethod.ControlId,O.DdaSetBindingFormats.BindingId,Gb,hc,wc=>{Kf.a(wc)?this.ye.IH(wc,
Ta):this.ye.yv(Ta)},Ta)}executeRichApiRequest(O,Ta){var Gb;const hc=O.ArrayData,wc={},$c=Ag.h(this.$).ha;if(hc){if("WacPartition"===hc[0]){this.FCh(O,Ta);return}const Ue=Object(Z.a)(Ad.DdaFacade,Df.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===hc[0]){var hd=Ue.yn(O.DdaMethod.ControlId);hd&&(hd.bjc=!0,hd.UOf())}wc.HttpMethod=hc[1];wc.PathAndQuery=hc[2];wc.RequestHeaders=Af.u3e(hc[3]);wc.RequestBody=hc[4];wc.AppPermission=hc[5];hd=hc[6];wc.RequestFlags=hd;var md=0;if(Fh.i(this.$.oa))switch($c.Oe){case 1:md=
2;break;case 2:md=3;break;case 128:md=4;break;default:md=1}var Bd=null;$c.Sa.cB&&(Bd=$c.Sa.cB.mj);wc.SheetMultiRange=Dh.r($c.ra.selectedRanges,this.$);wc.ActiveCell=Dh.v($c.ra.activeCell,this.$);wc.ActiveChartId=Bd;wc.SelectionState=md;md=this.je.KZ(O.DdaMethod.ControlId);wc.InstanceId=md?md.InstanceId:"";if(md&&md.PrimaryMarketplace){let of;if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1))if(md.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)of=
md.PrimaryMarketplace.SolutionId,Bd=md.PrimaryMarketplace.MarketplaceType;else{if(!md.OwnerAddinSolutionId){r.ULS.sendTraceTag(512325018,344,15,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.ye.rf(lf.a.NMa,Ta);return}if(!md.OwnerAddinStoreType){r.ULS.sendTraceTag(512325017,344,15,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.ye.rf(lf.a.NMa,Ta);return}of=md.OwnerAddinSolutionId;Bd=md.OwnerAddinStoreType}else if(of=Ad.DdaFacade.getSolutionId(md,this.$),
Bd=md.PrimaryMarketplace.MarketplaceType,Bd===OSF.StoreType.InMemory){if(!md.OwnerAddinSolutionId){this.ye.rf(lf.a.NMa,Ta);return}if(md.AssetMarketplace)Bd=md.AssetMarketplace.MarketplaceType;else{this.ye.rf(lf.a.NMa,Ta);return}}else Bd===OSF.StoreType.WopiCatalog&&(Bd=OSF.StoreType.OMEX);let tg=Telemetry.PrivacyRules.GetPrivacyCompliantId(of,Bd,null===(Gb=md.AssetMarketplace)||void 0===Gb?void 0:Gb.SolutionId,null,null,md.PrimaryMarketplace.MarketplaceRef);wc.CompliantSolutionId=tg;wc.SolutionId=
of;wc.MarketplaceType=Bd;wc.SolutionVersion=md.PrimaryMarketplace.SolutionVersion;wc.StoreLocation=md.PrimaryMarketplace.MarketplaceRef}else wc.SolutionId=wc.MarketplaceType="",wc.CompliantSolutionId="";wc.IsEventsEnabled=void 0===Ue||null===Ue||Ue.ij.v1b(wc.InstanceId);wc.RequestGuid=Sg.a.create().toString();Gb=wc.RequestBody.length;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Gb>this.$.va.ExcelRichApiMaxAllowedRequestPayloadSize){this.ye.rf(lf.a.clj,Ta);r.ULS.sendTraceTag(537163213,
0,50,`Request payload size:${Gb} exceeded the limit`);return}z.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&hd&4096&&(Gb=new qg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Gb,jf,hc),wc.RequestBody=hc[4])}const Qd=Af.F6e(wc.RequestHeaders);Af.oGd++;const Pe=ij.a.Qa.zb;z.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&wc&&wc.RequestBody&&r.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${wc.RequestBody.length}`);
this.pA.executeRichApiRequest(wc,Ue=>{var of;this.W1f(Pe,!0,Ue.ServerCorrelationId);let tg=null,gg=null;var Yf=Ue.ServerCorrelationId;if(null===(of=null===Ue||void 0===Ue?void 0:Ue.Errors)||void 0===of?0:of[0])tg=Ue.Errors[0].MessageIdName,gg=Ue.Errors[0].Description,z.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&sj.a(this.$).hd.xM(Ue.Errors[0].MessageId);if(Kf.a(Ue)||!Ue.Result)this.x9a(Yf,Qd,"Server error",tg,gg),this.ye.IH(Ue,Ta);else{let mg=null;if(z.EwaSettings.ma(255))if((of=
Ue.Result)&&of.length){for(let Ng=0;Ng<of.length;Ng++)if(of[Ng].RequestGuid===wc.RequestGuid){mg=of[Ng];break}mg||this.ye.IH(Ue,Ta)}else mg=Ue.Result;else mg=Ue.Result;if(!tg&&mg&&mg.ResponseBody&&mg.ResponseBody[0])if(Ue=mg.ResponseBody[0],Ue.startsWith('{"Error":')){1<mg.ResponseBody.length&&(Ue=Ue.substring(0,Ue.indexOf("}")+1),Ue+="}");try{var $f=y.a.ki(Ue);$f.Error&&this.x9a(Yf,Qd,"Pipeline error",$f.Error.Code,$f.Error.Message)}catch(Ng){this.x9a(Yf,Qd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.x9a(Yf,
Qd);else this.x9a(Yf,Qd,"Server error",tg,gg);const Mg=(Yf=mg.SheetMultiRange)?Yf.SheetName:null;$f=mg.ActiveChartId;const Ig=mg.SelectionState;Ue=5===Ig&&!!Yf||6===Ig||7===Ig||8===Ig;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.uy&&Ue)this.ye.rf(lf.a.EFc,Ta),r.ULS.sendTraceTag(537163211,0,50,`${Ig.toString()} is not allowed`);else if(5===Ig&&Yf){if(this.$.xa&&Mg)if(this.$.xa.Qk(Mg))this.SVc(Mg);else{let Ng=null;Ng=()=>{this.$.xa.Qk(Mg)&&
(r.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.SVc(Mg),this.$.xa.iKb(Ng))};this.$.xa.yob(Ng);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Hh=null;Hh=()=>{this.$.xa.Qk(Mg)&&(this.SVc(Mg),this.$.xa.una(Hh))};this.$.xa.gha(Hh)}}}else if(6===Ig||7===Ig||8===Ig||9===Ig){if(Yf){const Ng=Dh.g(Yf.Ranges);if(Mg&&Dh.cb(Ng,!0))if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!this.$.xa.Qk(Mg)){let Hh=null;Hh=()=>{this.sjg($c,Ng,Mg,Ig);this.$.xa.una(Hh)};this.$.xa.gha(Hh)}else this.sjg($c,Ng,Mg,Ig)}7===Ig?($f="38.{"+tj.e($f)+"}",sh.a(this.$).Ona(0,$f,!0)):8===Ig&&sh.a(this.$).Ona(2,$f,!0);9===Ig&&(this.$.va.ApiCallToSetPageLayout=!0)}mg.PostProcessActions?(Yf=y.a.ki(mg.PostProcessActions),this.y4i(Yf).then(()=>{this.Hdb(mg,Ta);this.Vcd(O.DdaMethod.ControlId,wc);return Promise.resolve(null)},Ng=>{this.Hdb(mg,Ta,Ng);return Promise.reject(Ng)})):this.Hdb(mg,Ta)}},Ue=>{this.W1f(Pe,
!1,null);this.x9a(null,Qd,"Web service error");Ta(Ue)})}Vcd(O,Ta){const Gb=Object(Z.a)(Ad.DdaFacade,Df.a(this.$));(null===Gb||void 0===Gb?0:Gb.ZOd)&&Gb.yn(O)&&Af.tCj(Ta.RequestHeaders)&&(r.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${O}; SolutionId: ${Ta.SolutionId}.`),Gb.ZOd.Urh(O))}FCh(O,Ta){var Gb=this.je.KZ(O.DdaMethod.ControlId);const hc=Ad.DdaFacade.getSolutionId(Gb,this.$);var wc=null;wc=Ad.DdaFacade.Ava(Gb,this.$);
wc=new Xf(wc,this.$);wc=new hj(hc,O.DdaMethod.ControlId,this.je,this.$,wc);const $c={ResponseHeaders:[]};$c.ResponseBody=Array(1);Gb=Af.u3e(O.ArrayData[3]);const hd=Af.F6e(Gb);Gb=new yf(this.$.va.CreateWorkbookMaxAllowedBase64Size,this.Wwf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(wc,Me,Gb,O.ArrayData).then(md=>{if(!md)return this.ixd(!1,"The rich api executor call failed",hd),r.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),$c.ResponseStatusCode=500,this.Hdb($c,
Ta),null;this.ixd(!0,"The rich api executor call succeeded",hd);$c.ResponseStatusCode=md[0];$c.ResponseBody[0]=md[2];this.Hdb($c,Ta);return null},md=>{$c.ResponseStatusCode=400;$c.ResponseBody[0]=md.toString();this.ixd(!1,"The rich api executor call failed",hd);r.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${hc}`);this.Hdb($c,Ta);return null})}W1f(O,Ta,Gb){Af.oGd--;O=mj.a(ij.a.Qa,O);r.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${O}, requests pending:${Af.oGd}, request result:${Ta?
"success":"false"}, server correlationid: ${Gb}.`)}Hdb(O,Ta,Gb=null){const hc=Array(3);hc[0]=O.ResponseStatusCode;hc[1]=Af.t2h(O.ResponseHeaders);const wc=[];var $c=!1;if(Gb&&O.ResponseBody){const hd=y.a.ki(O.ResponseBody.join(""));hd.Error||($c={},$c.Error=Gb,$c.TraceIds=hd.TraceIds,$c.ProcessedResults={},$c.ProcessedResults.Results=hd.Results,wc[0]=y.a.hc($c),$c=!0)}hc[2]=$c?wc:O.ResponseBody;O=this.ye.mQ();O.Data=hc;Ta(O)}qAd(O,Ta){(new Lf(this.$,this.ye,this.pA)).qAd(O,Ta)}WFi(O,Ta){r.ULS.sendTraceTag(537163206,
0,50,"MessageParent API called!");const Gb=O[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],hc=O[Md.a.PXc],wc=O[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];O=this.$.da.Aa(232).v2a.XFi(O.DdaMethod.ControlId,Gb,hc,wc);O===lf.a.success?this.ye.yv(Ta):(r.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.ye.rf(O,Ta))}SFi(O,Ta){r.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Gb=O[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],hc=O[Md.a.PXc],wc=O[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];
this.$.da.Aa(232).v2a.zsj(O.DdaMethod.ControlId,Gb,hc,wc);this.ye.yv(Ta)}getAccessToken(O,Ta){r.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Gb=(wc,$c)=>{var hd;if(wc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)wc=this.ye.mQ(),wc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=$c.accessToken,Ta(wc);else{$c=this.je.KZ(O.DdaMethod.ControlId);let md=null!==$c.OwnerAddinStoreType?$c.OwnerAddinStoreType:$c.PrimaryMarketplace.MarketplaceType;r.ULS.sendTraceTag(537163202,
0,10,`${({["errorCode"]:wc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ad.DdaFacade.getSolutionId($c,this.$),md,null===(hd=$c.AssetMarketplace)||void 0===hd?void 0:hd.SolutionId,null,null,$c.PrimaryMarketplace.MarketplaceRef),["storeType"]:md})}.`);this.ye.rf(wc,Ta)}},hc=!z.EwaSettings.ma(23);Vf.TaskExtensions.za(wg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),wc=>{const $c=this.je.Yh,hd=Wc.getInstance();Ub.AppsForOfficeSingleSignOnManager.getInstance($c,wc.result,
hd).getAccessToken(O.DdaMethod.ControlId,hc,O,Gb)},this.$.ka)}getAuthContext(O,Ta){Vf.TaskExtensions.za(wg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),()=>{var Gb=this.je.Yh.getOsfControl(O.DdaMethod.ControlId);if(Gb.isFirstParty()){Gb=Gb.getManifest();var hc=Gb.getMarketplaceID(),wc=Gb.getWebApplicationId(),$c=Gb.getWebApplicationMsaId();Ec.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(hc).then(hd=>{const md=this.ye.mQ(),Bd={};Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
wc;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=$c||wc;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=hd.upn;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=hd.userId;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=hd.authority;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Id.a.LNh(hd.authorityType);Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=hd.isAnonymous;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
hd.tenantId;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=hd.supportsAuthToken;md[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Bd;Ta(md)},hd=>{const md=this.ye.mQ(),Bd={},Qd=new Id.a;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=wc;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=$c||wc;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Qd.upn;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Qd.userId;
Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Qd.authority;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Qd.authorityType;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Qd.isAnonymous;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Qd.tenantId;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=hd;Bd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Qd.supportsAuthToken;md[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Bd;md.Error=1;Ta(md)})}},this.$.ka)}vli(O){const Ta=Ag.h(this.$).ha;return 16===Ta.Oe&&!!Ta.Sa.$b&&!!Ta.Sa.$b.floatingObject&&Eh.a.equals(Ta.Sa.$b.floatingObject.id,O,!0)}Xfd(O){const Ta=Ag.h(this.$).ha;return Ta.ra.Pg?1===Ta.Oe||this.vli(O)?Ta.Aia:null:null}nkc(O,Ta){return 1!==O&&2!==O&&3!==O?(this.ye.rf(lf.a.nEe,Ta),!1):!0}ixd(O,Ta,Gb){const hc={};hc.a=this.$.va.UserSessionId;hc.b=O;hc.c=Ta;hc.d=null;hc.e=Gb;Th.b().Qe(37,hc)}x9a(O,Ta,Gb=null,hc=null,wc=null){const $c={};O&&($c.ServerCorrelationId=
O);void 0!==Ta&&null!==Ta&&($c.Source=Ta);Gb&&($c.ErrorType=Gb);hc&&($c.MessageId=hc);wc&&($c.StatusDescription=wc);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&hc&&"ExternalDataRefreshFailed"===hc&&($c.StatusDescription="");r.ULS.sendTraceTag(50688452,0,50,y.a.hc($c))}y4i(O){let Ta=new Promise(Gb=>{Gb(null)});for(let Gb=0;Gb<O.length;Gb++)Ta=this.x4i(Ta,O[Gb]);return Ta}x4i(O,Ta){if(!Ta)return r.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),O.then(()=>Promise.reject(Af.r4a(bg.generalException,
gd.a.instance.ga(1756),null)));switch(Ta.actionType){case 1:case 2:O=O.then(()=>{const Gb=Object(Z.a)(Ad.DdaFacade,Df.a(this.$));if(Gb.yn(Ta.controlId))switch(Gb.ij.t7h(Ta),Ta.messageType){case 14:case 100:Gb.YOd.Q1b(Ta);break;case 11:case 12:Gb.Xnj.Qpb(Ta);break;case 51:case 52:Gb.Vnj.Qpb(Ta);break;case 2101:case 2102:Gb.Wnj.Qpb(Ta);break;case 2E3:Gb.Ynj.Q1b(Ta);break;case 2201:this.$.Uba&&Gb.ZOd.HSg(Ta);break;case 2203:Gb.Znj.ISg(Ta);break;case 2700:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
Gb.XOd.Q1b(Ta)}else r.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ta.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:O=O.then(()=>{this.e7h(Ta);return Promise.resolve(null)});break;case 15:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(O=O.then(()=>{this.L8h(Ta);return Promise.resolve(null)}));break;case 4:O=O.then(()=>{if(z.EwaSettings.ma(103)){var Gb=Ag.h(this.$).ha.ra.activeCell;Gb.top!==Ta.row+1&&Gb.left!==Ta.column+1&&(Gb=Dh.v(Fg.Range.Qc(Ta.row+
1,Ta.column+1),this.$),Ag.h(this.$).gg(Gb,null,null,null,3,"DdaMethodHandler.ShowCard"));gi.a(this.$,243,242,0,hc=>{hc.Keb(Ta.row+1,Ta.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:O=O.then(()=>{Object(Z.a)(Ad.DdaFacade,Df.a(this.$)).ij.pPe(Ta.controlId,Ta.isEnableEvents);return Promise.resolve(null)});break;case 5:O=O.then(()=>this.Lgh(Ta));break;case 6:O=O.then(()=>this.D_i(Ta));break;case 8:O=O.then(()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(Z.a)(Ad.DdaFacade,Df.a(this.$)).m3g();const Gb=new qj.a(rj.a.Yj,5,null);pj.a(this.$).Ls(Gb);return Promise.resolve(null)});break;case 9:O=O.then(()=>this.suj(Ta));break;case 10:O=O.then(()=>this.x3j(Ta));break;case 11:O=O.then(()=>this.w3j());break;case 12:O=O.then(()=>this.t3j());break;case 13:O=O.then(()=>this.u3j(Ta));break;case 14:O=O.then(()=>this.v3j(Ta));break;case 16:O=O.then(()=>Promise.resolve(Ta));break;case 17:O=O.then(()=>this.Gqj(Ta,Object(Z.a)(Ad.DdaFacade,Df.a(this.$))));break;
case 18:Ag.h(this.$).focus();break;case 19:this.M9e(Ta.entryType,!1,Ta.options);break;case 20:this.M9e(Ta.entryType,!0,Ta.options);break;default:O=O.then(()=>Promise.reject(Af.r4a(bg.gQg,gd.a.instance.ga(1757),null)))}return O}L8h(O){var Ta=Object(Z.a)(Ad.DdaFacade,Df.a(this.$)).yn(O.controlId);if(Ta&&!(0===O.operationType^!Ta.Wda)){Ag.h(this.$).Ljc=!0;switch(O.operationType){case 0:var Gb=new oj.a(document.createElement("input"));Gb.text=O.range;Ta.fgi(Ag.h(this.$).yf.gfh(Gb,new lj.a(this.$)));Ta.Wda.startEdit(!0);
break;case 1:Ta.KUf();this.rangePicker=null;break;case 2:Ta.Wda.Ijg(O.range);break;case 3:Ta.Wda.Ijg(O.startingRange);Ta=O.expandSelection;Gb=O.getNextDataRegionCell;let hc=0;switch(O.keyboardDirectionValue){case 2:hc=38;O=Ta&&Gb?105288353:Ta?-31900117:Gb?542791952:137938150;break;case 3:hc=40;O=Ta&&Gb?-1297307319:Ta?-1603798598:Gb?1713663844:-798660877;break;case 0:hc=37;O=Ta&&Gb?-403586027:Ta?2039316657:Gb?-2012742350:-1470715894;break;case 1:hc=39;O=Ta&&Gb?784916030:Ta?589730764:Gb?1324884057:
-1231471547;break;default:O=1461300262}Ta=this.m6b("keydown",hc,Ta,Gb);Ag.h(this.$).nLb(Ta,new xh.a(O,1,0,8,null))}Ag.h(this.$).Ljc=!1}}m6b(O,Ta,Gb,hc){const wc=document.createEvent("KeyboardEvent");if(Oc.a.SF)wc.initKeyboardEvent(O,!1,!1,window.self,"A",0,hc,!1,Gb,!1);else{let $c="";Gb&&($c+="Shift");hc&&($c+=0<$c.length?" Control":"Control");wc.initKeyboardEvent(O,!1,!1,window.self,"A",0,$c,!1,"en-US")}O=new Sys.UI.DomEvent(wc);O.keyCode=Ta;return O}e7h(O){switch(O.operationType){case 1:Vf.TaskExtensions.za(wg.GetServiceTaskFactory.create(this.$.da,
153,this.$.ka,1),Ta=>{Ta.result.TNd()},this.$.ka,3);break;case 2:if(O=Object(Z.a)(Ad.DdaFacade,Df.a(this.$)).yn(O.controlId))O.bjc=!0,O.UOf()}}Lgh(O){const Ta=O.fileBase64;return Ta&&Ta.length>this.$.va.CreateWorkbookMaxAllowedBase64Size?Promise.reject(Af.r4a(bg.invalidArgument,gd.a.instance.ga(1760),"Application.CreateWorkbook")):(new Promise((Gb,hc)=>{const wc=new Vd.StandardDialog;wc.Rb=4;wc.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,$c=>{2!==
$c&&0!==$c||hc(Af.r4a(bg.pFd,gd.a.instance.ga(1759),"Application.CreateWorkbook"));$c=new re("blank","agave",Ta?"streamBase64":"streamEmpty",Ta);this.Wwf.create(Gb,hc,$c).N1a()})})).then(Gb=>{this.X$b.set(O.fakeFileId,Gb);return Promise.resolve(null)},Gb=>Gb?Promise.reject(Gb):Promise.reject(Af.r4a(bg.generalException,gd.a.instance.ga(1756),"Application.CreateWorkbook")))}D_i(O){return new Promise((Ta,Gb)=>{if(this.X$b.has(O.fakeFileId)){const hc=this.X$b.get(O.fakeFileId);Gb=new Vd.StandardDialog;
Gb.Rb=4;Gb.Zl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,wc=>{1===wc&&Zh.HelperMethods.lf(hc,void 0,void 0,"DdaMethodHandler.fileUrl");Ta(null)})}else Gb(Af.r4a(bg.generalException,gd.a.instance.ga(1756),"Document.Open"))})}suj(O){return new Promise(Ta=>{Object(Z.a)(Ad.DdaFacade,Df.a(this.$)).yZf=O.runtimeCalculationMode;const Gb=this.$.da.Aa(268);Gb&&Gb.tBd(3===O.runtimeCalculationMode);Ta(null)})}x3j(O){Ug.a.rCb(this.$)&&this.$.da.Aa(331).Idb(0,
O.urlStr,!0,!0,null);return Promise.resolve(null)}w3j(){Ug.a.rCb(this.$)&&this.$.da.Aa(331).Idb(1,null,!0,!0,null);return Promise.resolve(null)}t3j(){Ug.a.rCb(this.$)&&this.$.da.Aa(331).mPe();return Promise.resolve(null)}u3j(O){Ug.a.rCb(this.$)&&this.$.da.Aa(331).Idb(5,O.urlStr,!0,!0,null);return Promise.resolve(null)}v3j(O){if(Ug.a.rCb(this.$)){const Ta=this.$.da.Aa(331);for(const Gb of Ta.Daa)Gb.IsActive&&Gb.HostEditUrl&&Gb.UrlStr===O.hostEditUrlStr&&Zh.HelperMethods.lf(Gb.HostEditUrl,"_blank")}return Promise.resolve(null)}Gqj(O,
Ta){const Gb=Zf.a.dX;O=y.a.ki(O.payload);const hc={};"eventId"in O&&"payload"in O&&(hc.eventId=O.eventId,hc.payload=O.payload);Ta.gN(2201,Gb,y.a.hc(hc));return Promise.resolve(null)}M9e(O,Ta,Gb){const hc=this.$.da.Aa(5);hc&&(O=this.GOh(O))&&(Ta?hc.removeEntry(O):hc.JWc(O,Gb))}GOh(O){switch(O){case 0:return 64;case 1:if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}SVc(O){O=Object(Z.a)(nj.a,this.$.xa.getItemByName(O));(null===O||void 0===O?0:O.visible)&&O.activate(!0)}sjg(O,
Ta,Gb,hc){var wc=O.ra.Ds;const $c=wc<Ta.length&&Ta[wc].contains(O.ra.activeCell);O=$c?O.ra.activeCell:Ta[0].topLeft;wc=$c?wc:0;Ag.h(this.$).T4(Ta,wc,Gb,null,O,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===hc)}static get jih(){Af.gqa||(Af.gqa={},Af.gqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,Af.gqa[Microsoft.Office.WebExtension.CoercionType.Text]=2,Af.gqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,Af.gqa[Microsoft.Office.WebExtension.CoercionType.Html]=
4,Af.gqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Af.gqa}static get mih(){Af.Iib||(Af.Iib={},Af.Iib[Microsoft.Office.WebExtension.FilterType.All]=1,Af.Iib[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return Af.Iib}static get nih(){Af.Jib||(Af.Jib={},Af.Jib[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Af.Jib[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return Af.Jib}static u3e(O){if(!O||!O.length)return null;const Ta=Array(O.length/2);for(let Gb=
0;Gb<O.length/2;Gb++)Ta[Gb]={},Ta[Gb].Name=O[2*Gb],Ta[Gb].Value=O[2*Gb+1];return Ta}static t2h(O){if(!O||!O.length)return null;const Ta=Array(2*O.length);for(let Gb=0;Gb<O.length;Gb++)Ta[2*Gb]=O[Gb].Name,Ta[2*Gb+1]=O[Gb].Value;return Ta}static jdd(O){if(!O||!O.length)return null;const Ta=Array(O.length);for(let Gb=0,hc=O.length;Gb<hc;Gb++){const wc=O[Gb].length;if(wc){Ta[Gb]=Array(wc);for(let $c=0;$c<wc;$c++)Ta[Gb][$c]=null==O[Gb][$c]?null:O[Gb][$c].toString()}else return null}return Ta}static D4b(O){return"string"===
typeof O?Yi.a.wq(Af.jih,O,0):O}static xXe(O){return"string"===typeof O?Yi.a.wq(Af.mih,O,0):O}static dlg(O){return"string"===typeof O?Yi.a.wq(Af.nih,O,0):O}static Hli(O){switch(O.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static X_c(O,Ta){const Gb={};Gb.CoerceType=O;1===Gb.CoerceType?(Gb.Data=Af.jdd(Ta.Rows),Gb.Headers=Af.jdd(Ta.Headers)):Gb.Data=Af.jdd(Ta);return Gb}static Eye(O){return 1===O.CoerceType?{["Headers"]:O.Headers,["Rows"]:O.Data}:
O.Data}static jhc(O){return 1===O.CoerceType?!O.Data&&!O.Headers:!O.Data}static F6e(O){let Ta="Unknown";if(!O)return Ta;for(let Gb=0;Gb<O.length;Gb++)if(O[Gb].Name.toLowerCase()===pf.a.$nj){Ta=O[Gb].Value;break}return Ta}static tCj(O){if(!O)return!1;const Ta=pf.a.DKi.toLowerCase();for(let Gb=0;Gb<O.length;Gb++)if(O[Gb].Name.toLowerCase()===Ta)return!0;return!1}static r4a(O,Ta,Gb){const hc={};hc.Code=O;hc.Message=Ta;hc.Location=Gb;hc.ActionIndex=0;return hc}}Af.gqa=null;Af.Iib=null;Af.Jib=null;Af.oGd=
0;Object(d.a)(Af,"DdaMethodHandler",null,[208,2]);class Zi extends yd.a{constructor(O){super(O)}ld(){const O=wg.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Ya),Ta=wg.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Ya),Gb=Gi(this.ka,this.Ya),hc=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")?wg.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):jh.Task.Ta(null);
Vf.TaskExtensions.za(Vf.TaskExtensions.Ed([O,Ta,Gb,hc],this.ka),()=>{const $c=O.result,hd=Ec.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Zc([new Af(this.$,$c,hd,hc.result)])},this.ka,3);const wc=Ec.a.instance;Vf.TaskExtensions.za(wg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,this.Ya),()=>{wc.register(rb,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").xc().Fc(()=>new rb)},this.$.ka)}static la(O){yd.a.Nd(82,new Zi(O))}}
Object(d.a)(Zi,"DdaCommandHandlerFactory",yd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Ni("");c.a.Ni(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();
Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(O=>{Xb.la(O)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(xc.a)();Object(Uc.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(O=>{z.EwaSettings.ma(52)&&Bh.la(O)})})();(()=>{f.a.Fa(O=>{z.EwaSettings.ma(120)&&nh.la(O)})})();f.a.Fa(Vc.la);f.a.Fa(fi.la);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");
(()=>{f.a.Fa(O=>{Oh.la(O);Ci.la(O);oi.la(O)})})();f.a.Fa(Zi.la)},1464:function(u,F,a){u=a(0);var c=a(187),b=a(97);class e{constructor(){this.kOe=this.displayName=this.msb=this.Ro=this.MB=null;this.isUpgraded=!1}Alf(d,h){return this.MB.getStoreType().toLowerCase()===d.toLowerCase()&&this.MB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(u.a)(e,"AddinCommandsResourceItem",null,[]);a.d(F,"a",function(){return f});class f{constructor(){this.GGc=null;this.uLc=0;this.aNc=!1;this.fb=new b.a;this.ixg=
new c.a}rKg(d){this.fb.addHandler("AddinCommandsLoadingMessageChanged",d)}Ufj(d){this.fb.removeHandler("AddinCommandsLoadingMessageChanged",d)}get SZa(){return this.GGc}heb(d){d!==this.GGc&&(this.GGc=d,this.fb.raiseEvent("AddinCommandsLoadingMessageChanged"))}nuj(){this.uLc++;this.SZa||this.heb(CommonUIStrings.l_LoadingAddInsTitle)}HRd(){this.uLc--;this.vwd()&&(this.aNc?this.SZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.heb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.heb(null))}H3f(d=
!1){this.aNc=!0;this.heb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}FCe(){this.aNc=!1;this.vwd()?this.heb(null):this.heb(CommonUIStrings.l_LoadingAddInsTitle)}vwd(){return 0>=this.uLc}get L6a(){return this.ixg}kja(d,h,n=0){for(let m of this.L6a)if(m.Alf(d,h)&&(!m.Ro||m.Ro.jMh===n))return m;return null}Lpe(d,h,n,m){const x=new e;x.MB=d;x.Ro=h;x.msb=n;x.displayName=m;this.L6a.add(x)}sIg(d,h,n,m){const x=new e;x.MB=d;x.Ro=h;x.msb=null;x.kOe=
n;x.displayName=m;this.L6a.add(x)}sej(d,h){let n=0;for(let m of this.L6a)m.MB.getStoreType()===d&&m.MB.getSolutionId()===h?this.L6a.removeAt(n):n++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(u.a)(f,"AddinCommandsResourceManager",null,[])},732:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);var c=a(35);class b{static get UFi(){return b.Yee||(b.Yee={["-2002156328"]:b.nEe,["-1954750170"]:b.b7e,["317650254"]:b.b5g,["-1005263101"]:b.hii,["1353664579"]:b.Trj,["159671765"]:b.iii,
["1446690022"]:b.W1e,["1150069548"]:b.qDc,["-1409306331"]:b.dBe,["338507772"]:b.mKe,["-457159301"]:b.s0i,["-1037701970"]:b.Lhh,["-1893322318"]:b.nii,["965579896"]:b.Nhh,["93287890"]:b.Mhh,["358088857"]:b.cvj,["-1223650923"]:b.mKe,["2007306190"]:b.$0g,["1549955423"]:b.Jxe,["-1275974171"]:b.mii,["382101082"]:b.G_i,["-898776235"]:b.BHi,["335464256"]:b.sHi,["1677378049"]:b.lii,["-261992848"]:b.PUj,["-980820954"]:b.Jxe,["-931375837"]:b.F_i,["929186550"]:b.sph,["-982144310"]:b.t7i,["-785741187"]:b.fii,
["2125217573"]:b.pii,["299124955"]:b.gii,["1669853884"]:b.moj,["-1515932330"]:b.c5g,["314621024"]:b.IIh,["-300049690"]:b.d1g,["14766835"]:b.fAj,["-1251992761"]:b.nNe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.rGa,["49173765"]:b.rGa,["-907155566"]:b.rGa,["-1201603824"]:b.rGa,
["1541165282"]:b.rGa,["-1347753427"]:b.rGa,["134912532"]:b.rGa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static JZe(e){return c.a.wq(b.UFi,e.toString(),b.internalError)}}b.success=0;b.nEe=1E3;b.b7e=1001;b.b5g=1002;b.hii=1003;b.Trj=1004;b.iii=1005;b.W1e=1008;b.kXe=1009;b.invalidSheetName=1014;b.qDc=2E3;b.dBe=2001;b.mKe=2002;b.s0i=2003;b.Lhh=2004;b.nii=2005;b.Nhh=2007;b.Mhh=2008;b.cvj=2009;b.$0g=2014;b.Hrj=3E3;b.Jxe=3002;b.mii=3004;b.G_i=3005;b.BHi=3006;b.sHi=3007;b.lii=3008;b.PUj=3009;b.F_i=
3010;b.fAj=4002;b.tFd=5E3;b.internalError=5001;b.nNe=5002;b.NMa=5004;b.RVj=5007;b.$ci=5008;b.invalidOrTimedOutSession=5012;b.EFc=5016;b.rGa=5102;b.clj=5103;b.responsePayloadSizeLimitExceeded=5104;b.w0g=7001;b.N$f=7002;b.sph=8E3;b.t7i=8001;b.fii=8010;b.pii=8011;b.gii=8012;b.moj=8020;b.c5g=8021;b.IIh=8022;b.d1g=8023;b.AFi=11E3;b.qIi=11001;b.oii=11002;b.Yee=null;Object(u.a)(b,"DdaErrorIds",null,[])},733:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{}c.generalException="GeneralException";
c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.vVc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.pFd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.UVj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.pOg="AddinIsAlreadyRequestingToken";c.Gmj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.W8g=
"ControlIdNotFound";c.vnj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(u.a)(c,"ErrorCodes",null,[])},736:function(u,F,a){a.r(F);var c=a(0),b=a(7),e=a(15),f=a(1306),d=a(84),h=a(97);class n{constructor(ra,ya,mb){this._id=ra;this.erg=ya;this.mtg=mb;this.Yff=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get oOg(){return this.erg}get E5g(){return this.mtg}execute(ra,
ya,mb){mb=mb||{};mb.commandMode=this.Yff;ya.invokeAppCommand(this.oOg,this.E5g,mb,()=>{ra.gUi(this.id)})}}Object(c.a)(n,"AddinNativeActionBase",null,[143]);class m extends n{constructor(ra,ya){super(1,ra,ya);this.Yff=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(m,"AddinTakeSnapshotAction",n,[]);class x{B$g(ra){return new n(3,ra,this.SMh().getNativeActionName(3))}SMh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(x,"AddinNativeActionManager",null,[113]);var r=
a(146);class y{invokeAppCommand(ra,ya,mb,Hb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ra,ya,mb,Hb)}static getInstance(){y.Ma||(y.Ma=new y);return y.Ma}}y.Ma=null;Object(c.a)(y,"OSFAddinCommandsRuntimeManager",null,[107]);var t=a(4),v=a(181),w=a(27);class C extends r.a{constructor(ra,ya,mb){super();this.L9=null;this.wUc="WACDialogTitleText";this.tfa="0";this.JDa="15px";this.Ctg="0px";this.sfa="calc(100% - 30px)";this.Btg="100%";this.Aie=0;this.fb=new h.a;this.grg=new x;this.Rb=5;this.Fe=
this.RDa=mb;this.KJc=ra;this.H8d=ya;this.$Jc=!!t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}CMg(ra){this.fb.addHandler("OnDialogClosedEventKey",ra)}axj(){this.$Ea=null}Xz(){super.Xz();this.Vk.style.width="100%";this.Vk.style.height=this.dfc?this.sfa:this.Btg;this.Vk.style.marginTop=this.dfc?this.JDa:this.Ctg;this.Vk.style.padding=this.tfa}SI(){super.SI();this.wb.style.width=String.format("{0}px",this.KJc*window.innerWidth/100);this.wb.style.height=
String.format("{0}px",this.H8d*window.innerHeight/100);this.wb.style.minWidth="0px";this.$Jc&&t.AFrameworkApplication.isRtl&&100===this.KJc&&(this.wb.style.right="0px",this.wb.style.marginRight="0px");this.L9=document.getElementById(this.li(this.wUc));this.L9.style.position="absolute";this.L9.style.whiteSpace="nowrap";this.L9.style.textOverflow="ellipsis";t.AFrameworkApplication.isRtl?(this.L9.style.right="14px",this.L9.style.left="44px"):(this.L9.style.right="44px",this.L9.style.left="14px")}Pv(ra){super.Pv(ra);
this.L9&&this.L9.setAttribute("title",ra)}get Hia(){return this.Vk}ZNd(){this.wb.style.width=String.format("{0}px",this.KJc*window.innerWidth/100);this.wb.style.height=String.format("{0}px",this.H8d*window.innerHeight/100);this.wb.style.overflowY="hidden";this.wb.style.overflowX="hidden";this.wb.style.marginTop="";this.wb.style.top="";w.a.v5&&t.AFrameworkApplication.isRtl?(this.wb.style.right="",this.wb.style.marginRight=""):(this.wb.style.left="",this.wb.style.marginLeft="")}hide(){this.grg.B$g(this.RDa).execute(this,
y.getInstance(),{});this.Aie=window.setTimeout(()=>{this.fb.raiseEvent("OnDialogClosedEventKey",this.RDa);v.a.prototype.hide.call(this)},500)}gUi(ra){3===ra&&(window.clearTimeout(this.Aie),this.fb.raiseEvent("OnDialogClosedEventKey",this.RDa),super.hide())}}Object(c.a)(C,"AppsForOfficeDialog",r.a,[92,93]);class B{constructor(){this.dialog=this.Fe=null}}Object(c.a)(B,"DialogInfo",null,[]);class z{}z.url="url";z.height="height";z.width="width";z.Q8c="displayInIframe";z.Efc="hideTitle";Object(c.a)(z,
"DialogSettings",null,[]);class A{constructor(){this.height=this.width=0;this.Fe=this.controlId=this.pageUrl=null;this.Efc=this.Q8c=!1}}Object(c.a)(A,"DisplayDialogParams",null,[]);class E extends Sys.EventArgs{constructor(ra,ya,mb=null,Hb="",Zb=""){super();this.controlId=ra;this.messageType=ya;this.messageContent=mb;this.messageOrigin=Hb;this.targetOrigin=Zb}}Object(c.a)(E,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(ra,ya,mb=null,Hb="",Zb=""){super();this.controlId=
ra;this.messageType=ya;this.messageContent=mb;this.messageOrigin=Hb;this.targetOrigin=Zb}}Object(c.a)(I,"OnMessageParentEventArgs",Sys.EventArgs,[]);var L=a(41),V=a(30),T=a(171),H=a(99);class D{constructor(ra){this.fb=new h.a;this.Im=ra}KMg(ra){this.fb.addHandler("OnMessageParentEventKey",ra)}JMg(ra){this.fb.addHandler("OnMessageDialogEventKey",ra)}showDialog(ra,ya,mb,Hb){if(D.B8.lb(ya))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const bc=L.b(ra),Qc=bc[z.url];if(this.Im.getOsfControl(ya).checkAppDomains(Qc)){var Zb=new A;Zb.width=bc[z.width];Zb.height=bc[z.height];Zb.pageUrl=Qc;Zb.Q8c=bc[z.Q8c];Zb.Efc=bc[z.Efc];Zb.controlId=ya;Zb.Fe=T.a.create().toString();var mc=new B;mc.Fe=Zb.Fe;var Pc=this.Im.getOsfControl(Zb.controlId).getManifest().getDefaultDisplayName(),fd=this.Im.getOsfControl(Zb.controlId).getStoreType().toLowerCase();ra=null;var id=t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);ra=(4===t.AFrameworkApplication.ta.Pa.Hj&&"hardcodedpreinstall"===fd||id&&"sdxcatalog"===fd)&&Zb.Efc?this.createAndShowAppsForOfficeDialog(Zb.width,Zb.height,Zb.Fe,!0,Pc):this.createAndShowAppsForOfficeDialog(Zb.width,Zb.height,Zb.Fe,!1,Pc);var Dd=this.Im.getOsfControl(Zb.controlId),Zd=Dd.getManifest();id={};id.id=Zb.Fe;id.solutionId=Dd.getSolutionId();id.version=Dd.getVersion();id.storeType=fd;id.storeId=Dd.getStoreId();id.assetId=Dd.getAssetId();id.assetStoreId=Dd.getAssetStoreId();id.ownerAddinSolutionId=
Dd.getOwnerAddinSolutionId();id.ownerAddinStoreType=Dd.getOwnerAddinStoreType();id.appDomains=Zd.getAppDomains();id.dialogUrl=Qc;id.osfControlType=1;id.agaveName=Pc;id.div=ra.Hia;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(id.solutionId,id.ownerAddinStoreType||id.storeType,id.assetId,null,null,id.storeId),V.a.mw(Zb.pageUrl));this.Im.insertDialogControl(id);ra.CMg(Object(d.a)(this,this.pOi,"onDialogClosed"));mc.dialog=
ra;D.B8.ia(Zb.controlId,mc);Hb&&Hb(id);mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(bc){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",bc.message),mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}XFi(ra,ya,mb,Hb){t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Hb&&(Hb=mb);try{const Zb=this.aLa(ra);Zb&&this.fb.raiseEvent("OnMessageParentEventKey",new I(Zb,OSF.DialogMessageType.DialogMessageReceived,ya,mb,Hb))}catch(Zb){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Zb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}dIa(ra,ya){if(D.B8.lb(ra))try{const mb=D.B8.na(ra);mb.dialog&&mb.dialog.hide();this.Im.purgeDialogControl(mb.Fe);
D.B8.remove(ra);ya(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(mb){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",mb.message),ya(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),ya(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}zsj(ra,ya,mb,Hb){t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Hb&&(Hb=mb);if(D.B8.lb(ra)&&(ra=D.B8.na(ra),ra.dialog))try{this.fb.raiseEvent("OnMessageDialogEventKey",new E(ra.Fe,OSF.DialogMessageType.DialogParentMessageReceived,ya,mb,Hb))}catch(Zb){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Zb.message)}}aLa(ra){let ya=null;for(let mb of D.B8)if(mb.value.Fe===ra){ya=mb.key;break}return ya}pOi(ra,ya){if(ra=this.aLa(ya))this.Im.purgeDialogControl(ya),D.B8.remove(ra),this.fb.raiseEvent("OnMessageParentEventKey",
new I(ra,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(ra,ya,mb,Hb,Zb){ra=new C(ra,ya,mb);Zb=Hb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Zb);Hb&&(ra.dfc=!1,ra.Lt=!1);ra.initializeAndShow(Zb,null,null);ra.axj();return ra}static o5h(){return D.B8}static getInstance(ra){D.Ma||(D.Ma=new D(ra));return D.Ma}}D.Ma=null;D.B8=new H.a;Object(c.a)(D,"AppsForOfficeDialogManager",null,[78]);var G=a(846),J=a(1318),M=a(1395),Q=a(935),U=a(720),Z=a(173),
P=a(1319),S=a(119),ja=a(82),X=a(89),Y=a(640),va=a(554),N=a(684),ea=a(83),Ca=a(419),la=a(157),Ra=a(187),lb=a(38),Aa=a(5),da=a(863),aa=a(1235),fa=a(78);class Oa{constructor(){this.command=0;this.properties=null}}Object(c.a)(Oa,"DdaRequestInfo",null,[]);var ba=a(732),ka=a(76);class Pa extends fa.a{constructor(ra,ya){super();this.requests=[];this.disposed=this.A3b=!1;this.jg=()=>{if(!this.disposed){this.grid.Vb.em(this.jg);this.A3b=!1;const mb=this.requests;this.requests=[];for(let Hb of mb)this.ddaFacade.CK(Hb.command,
Hb.properties)}};this.ddaFacade=ra;this.grid=ya}yjh(ra,ya){this.disposed||(this.A3b||(this.grid.Vb.Rm(this.jg),this.A3b=!0),this.requests.push(Object(b.a)(new Oa,{command:ra,properties:ya})))}dispose(){if(!this.disposed){this.disposed=!0;this.A3b&&this.grid.Vb.em(this.jg);var ra=this.requests;this.requests=null;for(let ya of ra)(ra=ya.properties?ya.properties[ka.a.Y3]:null)&&this.ddaFacade.rf(ba.a.NMa,ra);this.ddaFacade=this.grid=null;super.dispose()}}static H5g(ra,ya){var mb=!1;974713501===ra&&(ya=
(ra=ya?ya[ka.a.og]:null)?ra.DdaMethod:null)&&ya.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(mb=ra.ArrayData,mb=!!mb&&64===(mb[6]&64));return mb}}Object(c.a)(Pa,"DdaCellEditDelayRequestHandler",fa.a,[]);var Fa=a(767);class oa extends Fa.a{constructor(ra,ya,mb,Hb,Zb,mc,Pc){super(ra,ya,mb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Hb;this.messageContent=Zb;this.messageOrigin=mc;this.targetOrigin=Pc}}Object(c.a)(oa,"DialogMessageReceivedEventArgs",
Fa.a,[]);class La extends Fa.a{constructor(ra,ya,mb,Hb,Zb,mc,Pc){super(ra,ya,mb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Hb;this.messageContent=Zb;this.messageOrigin=mc;this.targetOrigin=Pc}}Object(c.a)(La,"DialogParentMessageReceivedEventArgs",Fa.a,[]);var Ea=a(1),ca=a(21);class $a{constructor(ra){this.Yh=this.SYc=null;this.XTi=(ya,mb)=>{this.handlers.lb(mb.controlId)&&(ya=new oa(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,mb.controlId,
null,mb.messageType,mb.messageContent,mb.messageOrigin,mb.targetOrigin),this.handlers.na(mb.controlId)(ya),mb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(mb.controlId))};this.WTi=(ya,mb)=>{this.fnc.lb(mb.controlId)&&(ya=new La(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,mb.controlId,null,mb.messageType,mb.messageContent,mb.messageOrigin,mb.targetOrigin),this.fnc.na(mb.controlId)(ya))};this.handlers=new H.a;this.fnc=new H.a;this.Mg=ra;this.v2a.KMg(this.XTi);
this.v2a.JMg(this.WTi)}get v2a(){this.SYc||(this.SYc=D.getInstance(this.contextActivationMgr));return this.SYc}get contextActivationMgr(){!this.Yh&&this.Mg&&(this.Yh=this.Mg.Yh);return this.Yh}addHandler(ra,ya,mb,Hb){if(Ea.EwaSettings.ma(23))this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,mb);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Zb=mc=>{mc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(ra,
ya),this.Mg.yv(mb)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Mg.rf(mc,mb))};this.handlers.lb(ra)?Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(ra,Hb,Zb)}}kIg(ra,ya,mb){Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,mb):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.fnc.ia(ra,ya),this.Mg.yv(mb))}removeHandler(ra,
ya){Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ya):this.handlers.lb(ra)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.v2a.dIa(ra,mb=>{this.handlers.remove(ra);mb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Mg.yv(ya):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Mg.rf(mb,ya))})):this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
ya)}nfj(ra,ya){Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ya):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.fnc.remove(ra),this.Mg.yv(ya))}showDialog(ra,ya,mb){try{Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&ca.h(this.Mg.$).eb&&ca.h(this.Mg.$).To(!0),this.v2a.showDialog(ya,ra,mb,Hb=>{this.Mg.BIg(this.DYg(Hb))})}catch(Hb){e.ULS.sendTraceTag(537170496,0,10,
`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Hb.message}`),mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}DYg(ra){const ya={};ya.InstanceId=ra.id;ya.WebExtensionType=ra.osfControlType===OSF.OsfControlTarget.InContent?0:1;ya.PrimaryMarketplace={};ya.PrimaryMarketplace.SolutionId=ra.solutionId;ya.PrimaryMarketplace.SolutionVersion=ra.version;ya.PrimaryMarketplace.MarketplaceRef=ra.storeId;ya.PrimaryMarketplace.MarketplaceType=ra.storeType;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)&&(ya.OwnerAddinSolutionId=ra.ownerAddinSolutionId,ya.OwnerAddinStoreType=ra.ownerAddinStoreType);return ya}static la(ra){if(!ra.$.da.Aa(232)){const ya=new $a(ra);ra.$.da.Ga(232,ya)}}}Object(c.a)($a,"DialogMessageReceivedEventManager",null,[883]);class Qa{constructor(ra,ya){this.dB=null;this.Ifa=ra;this.GDg=ya}k0b(ra){ra&&(this.dB||(this.dB=[]),this.dB.push(ra))}Tuc(ra){this.dB&&Array.remove(this.dB,ra)}get eventId(){return this.Ifa}get targetId(){return this.GDg}get m$h(){return 0<this.dB.length}tEi(ra){return this.eventId!==
ra.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===ra.ddaBinding.Name:!0}e3b(ra){this.dB&&Array.forEach(this.dB,ya=>{ya(ra)})}nna(){this.dB=[]}}Object(c.a)(Qa,"DdaEventRegistration",null,[]);class Va{constructor(ra){this.nF=null;this.Mwa=!1;this.Pc=()=>{this.nF.forEach(ya=>{ya.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&ya.e3b(new Fa.a(ya.eventId,"",null))})};this.Mg=
ra}invokeDdaMethod(ra,ya){const mb={};mb[ka.a.og]=ra;mb[ka.a.Y3]=ya;this.Mg.CK(974713501,mb)}registerDdaEventAsync(ra,ya,mb,Hb,Zb){Va.LAb(ra)?(Va.dqd(ra)&&this.wmd(),this.nF||(this.nF=[]),ya=this.wvb(ra,mb),ya||(ya=new Qa(ra,mb),this.nF.push(ya)),ya.k0b(Hb),this.Mg.yv(Zb)):this.Mg.rf(-1,Zb)}unregisterDdaEventAsync(ra,ya,mb,Hb,Zb){Va.LAb(ra)?((ra=this.wvb(ra,mb))&&ra.Tuc(Hb),this.Mg.yv(Zb)):this.Mg.rf(-1,Zb)}wmd(){this.Mwa||(ca.h(this.Mg.$).ha.PE(this.Pc),this.Mwa=!0)}wvb(ra,ya){if(!this.nF)return null;
for(let mb=0;mb<this.nF.length;mb++){const Hb=this.nF[mb];if(Hb.eventId===ra&&Hb.targetId===ya)return Hb}return null}static LAb(ra){return ra===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static dqd(ra){return ra===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(Va,"EmbeddingPage",null,[859]);var fb=a(179);class Ka extends Fa.a{constructor(ra,ya,mb,Hb,Zb,mc,Pc,fd){super(ra,ya,mb);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=mc-Hb.Reference.FirstColumn;
this.columnCount=fd;ra=Math.max(Zb,Hb.Reference.FirstRow);Zb=Math.min(Zb+Pc-1,Hb.Reference.LastRow);ra>Zb?this.startRow=this.rowCount=void 0:(this.startRow=ra-Hb.Reference.FirstRow,this.rowCount=Zb-ra+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(Ka,"DdaBindingSelectionEventArgs",Fa.a,[]);var hb=a(200),fc=a(24),dc=a(40),wb=a(49),Tb=a(420),xb=a(33),cb=a(37),jb=a(565),qa=a(109),
za=a(52),Na=a(92),ua=a(12),Xa=a(11),ha=a(104);class ta{}ta.myh="ewa-wx-disabled-div";ta.lyh="ewa-wx-container-div";ta.ASe="ewa-ptp-nov2-flex";Object(c.a)(ta,"CssClassNames",null,[]);const wa=ta.myh,db=ta.lyh;class Jb extends fb.a{constructor(ra,ya,mb,Hb=!1){super();this.Ldb=0;this.nF=null;this.Mwa=!1;this.Lsc=null;this.IU=0;this.j7b=this.vWa=this.nJc=this.L5d=null;this.pce=!1;this.tQc=this.Wda=this.X2d=null;this.Pc=()=>{this.enabled&&(this.Jsj(),this.Lsc=dc.d(ca.h(this.$).ha.ra.selectedRanges))};
this.V9e=Zb=>{Zb.controlId===this.Hd.InstanceId&&Array.forEach(this.nF,mc=>{mc.tEi(Zb)&&mc.e3b(Zb)})};this.azf=Zb=>{if((Zb=Object(ea.a)(450,Zb))&&!Zb.Fs())if(!this.Hd||OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)||this.$.Z2){Zb.qf=this.Hd;Zb.wj=this.Mg;this.X2d=Zb;this.wyc(Zb.YGa);const mc=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&xb.a.fd(this.$)&&Xa.HelperMethods.Gw(this.Hd)&&this.Hd.Preload&&!this.Hd.TaskpaneVisible;
mc?Zb.FDd():Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Zb.FDd(),(this.Hd.SharedRuntime&&1===this.Hd.SharedRuntime.LifeTime||this.Hd.SharedRuntimeId)&&!this.Hd.TaskpaneVisible&&Zb.yg(!1)):((this.Hd.SharedRuntime&&1===this.Hd.SharedRuntime.LifeTime||this.Hd.SharedRuntimeId)&&!this.Hd.TaskpaneVisible&&Zb.yg(!1),Zb.FDd());this.U6a||(xb.a.fd(this.$)?mc||Zb.Y6():Tb.a(this.$).result.oG(Zb,!0));this.$.da.Aa(77).aVf(this.azf);this.r$=Object(ea.a)(310,
Zb)}else e.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Zb,mc)=>{3===mc.control.floatingObject.type&&mc.control.floatingObject.xl.InstanceId===this.D1.WebExtensionId&&(this.r$=Object(ea.a)(310,mc.control),this.wyc(mc.control.Jd.firstChild),ha.a(this.$).Luc(this.onFloatingObjectControlAdded))};this.jb=ra.$;this.Mg=ra;this.Hd=mb;this.Hd.InstanceId=mb.SrcLocationOverrideResourceId?ra.p4a(mb.InstanceId,mb.SrcLocationOverrideResourceId):
mb.InstanceId;this.ii=ya;this.D1={};this.D1.WebExtensionId=mb.InstanceId;this.HKf="osfControl_"+mb.InstanceId;this.G8c="disabled_"+mb.InstanceId;this.D1.BindingData=mb.BindingData;this.U6a=this.Mg.U6a(mb.InstanceId);this.bhc=this.Mg.bhc(mb.InstanceId);this.Nge=mb.WebExtensionOsfControlType;this.WNf=Hb}get controlId(){return this.Hd.InstanceId}fgi(ra){this.Wda||(this.Wda=ra)}KUf(){this.Wda&&(this.Wda.dispose(),this.Wda=null)}get controlType(){return this.Hd.WebExtensionType}get ownerAddinSolutionId(){return this.Hd.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.IU}get Dy(){return this.tQc}get uU(){return this.Hd.SrcLocationOverrideResourceId?
this.Mg.p4a(this.Hd.PrimaryMarketplace.SolutionId,this.Hd.SrcLocationOverrideResourceId):this.Hd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Hd.SrcLocationOverrideResourceId}get xl(){return this.Hd}get r$(){return this.L5d}set r$(ra){this.L5d=ra}get osfControlType(){return this.Nge}get Yta(){return this.nJc}set Yta(ra){this.nJc=ra}get i7b(){return this.vWa}set i7b(ra){this.vWa=ra}get focusOnIframeWhenLoaded(){return this.Hd.FocusOnIframeWhenLoaded}get bjc(){return this.pce}set bjc(ra){this.pce=
ra}Snd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)&&Ea.EwaSettings.ma(183)){const ya=wb.GetServiceTaskFactory.Oa(this.$.da,5,4,0);cb.TaskExtensions.za(ya,()=>{ya.result.ng(36,null)},this.ka,3);return this}if(1===this.Hd.WebExtensionType)cb.TaskExtensions.za(Tb.a(this.$),ya=>{ya.result.Gsb(this.$.da,77,5,this.azf,1)},this.ka,3);else{var ra=this.EXe();const ya=ha.a(this.$);ra||(ra={Type:3},ra.Id=this.D1.WebExtensionId,ra.WebExtensionData=this.Hd,ra.ContentHtml=
"<div/>",ra.Version=0,ra.AbsoluteLeft=0,ra.AbsoluteTop=0,ra.AbsoluteRight=0,ra.AbsoluteBottom=0,ra.Width=0,ra.Height=0,ra.ZOrder=0,ra.OriginDeltaX=0,ra.OriginDeltaY=0,ra=new hb.a(ra),ya.V5b(ra,null),ra=ya.Qq(ra.Ng()));ra?(this.wyc(ra.Jd.firstChild),this.r$=Object(ea.a)(310,ra)):ya.a0b(this.onFloatingObjectControlAdded)}return this}gef(ra){this.wyc(ra);return this}Yoc(){this.WNf||this.Mg.Yh.purgeOsfControl(this.controlId,!1);this.Igg(!0);const ra=this.EXe();ra&&ha.a(this.$).deleteFloatingObject(ra);
this.Mg.ij.Xej(this.controlId);this.Mg.ij.pPe(this.controlId,!0);this.tQc=null}RDd(ra){this.D1=ra}invokeDdaMethod(ra,ya){if(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var mb={};mb[ka.a.og]=ra;mb[ka.a.Y3]=ya;this.Mg.CK(974713501,mb)}else this.Mg.rf(ba.a.NMa,ya)}pcj(ra,ya,mb,Hb){if(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Jb.Znh(ra)||void 0!==ya&&null!==ya&&void 0!==this.L3a(ya)&&null!==this.L3a(ya))if(e.ULS.sendTraceTag(36444195,
0,50,`eventId: ${ra}, targetId: ${ya}`),Jb.Fhf(ra)&&this.ibi(),Jb.dqd(ra)&&this.wmd(),Jb.Dhf(ra))Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hb):this.Mg.$.da.Aa(232).addHandler(this.controlId,mb,Hb,ya);else if(Jb.Ehf(ra))Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hb):this.Mg.$.da.Aa(232).kIg(this.controlId,mb,Hb);else{Jb.Chf(ra)&&this.X9e(-1777565636,Hb);this.nF||(this.nF=[]);var Zb=this.wvb(ra,
ya);Zb||(Zb=new Qa(ra,ya),this.nF.push(Zb));Zb.nna();Zb.k0b(mb);this.Mg.yv(Hb);ra===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.vWa&&(this.j7b=mb)}else this.Mg.rf(3002,Hb);else this.Mg.rf(-1,Hb)}ZUj(ra,ya,mb,Hb){Jb.Dhf(ra)?Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hb):this.Mg.$.da.Aa(232).removeHandler(this.controlId,Hb):Jb.Ehf(ra)?Ea.EwaSettings.ma(23)?this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hb):this.Mg.$.da.Aa(232).nfj(this.controlId,
Hb):(Jb.Chf(ra)&&this.X9e(1592314317,Hb),ya=this.wvb(ra,ya),this.enabled?(ya&&(ya.Tuc(mb),ya.m$h||Array.remove(this.nF,ya),this.nF.length?Jb.Fhf(ra)&&this.Jgg(!1):this.Igg(!1)),this.Mg.yv(Hb)):this.Mg.rf(-1,Hb))}la(ra){ua.DOMElementExtensions.getElementById(ra,this.HKf)||ra.appendChild(ua.DOMElementExtensions.uf(this.Dy))}showHide(ra){ua.DOMElementExtensions.setVisible(this.Dy,ra)}resize(ra,ya){ua.DOMElementExtensions.Vv(this.Dy,ra);ua.DOMElementExtensions.gJ(this.Dy,ya)}iMe(ra){if(!this.IU&&!ua.DOMElementExtensions.getElementById(this.Dy,
this.G8c)&&this.Dy){const ya=document.createElement("div");ya.id=this.G8c;ya.className=wa;ya.style.backgroundImage="url("+za.a.current.fo(103)+")";ya.style.opacity=ra?"1":"0";ya.style.backgroundRepeat="no-repeat";ya.style.backgroundPosition="center";this.Dy.insertBefore(ya,this.Dy.firstChild)}this.IU++}Lqh(){0<this.IU&&this.IU--;this.IU||(ua.DOMElementExtensions.uf(ua.DOMElementExtensions.getElementById(this.Dy,this.G8c)),this.Mwa&&!dc.Q(this.Lsc,ca.h(this.$).ha.ra.selectedRanges)&&this.Pc(null,null))}L3a(ra){if(!this.D1||
!this.D1.BindingData)return null;for(let ya=0;ya<this.D1.BindingData.length;ya++)if(this.D1.BindingData[ya].Name===ra)return this.D1.BindingData[ya];return null}getDefaultIconUrl(){const ra=this.y5e();return ra?ra.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Hd.TaskpaneTitle)return this.Hd.TaskpaneTitle;const ra=this.y5e();return ra?ra.getDefaultDisplayName():null}UOf(){if(this.vWa&&this.j7b){const ra=new Fa.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.vWa);
this.j7b(ra);this.j7b=this.vWa=null}}yg(ra){this.X2d&&this.X2d.yg(ra)}Puj(){this.$.ea.isNamedObjectViewMode&&this.kqi()&&(this.$.da.Aa(34).Ouj(this.Dy),this.showHide(!1));if(this.Mg.M2j){if(!this.WNf){const ra={};ra.div=this.Dy;ra.id=this.Hd.InstanceId;ra.solutionId=this.Hd.PrimaryMarketplace.SolutionId;ra.version=this.Hd.PrimaryMarketplace.SolutionVersion;ra.storeId=this.Hd.PrimaryMarketplace.MarketplaceRef;ra.storeType=this.Hd.PrimaryMarketplace.MarketplaceType;ra.ownerAddinSolutionId=this.Hd.OwnerAddinSolutionId;
ra.ownerAddinStoreType=this.Hd.OwnerAddinStoreType;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?this.Hd.AssetMarketplace?(ra.assetId=this.Hd.AssetMarketplace.SolutionId,ra.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef):(ra.assetId=null,ra.assetStoreId=null):this.Hd.AssetMarketplace&&(ra.assetId=this.Hd.AssetMarketplace.SolutionId,ra.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef);ra.settings=this.Hd.OsfPropertyBag;Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
ra.reason=this.U6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.bhc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:ra.reason=this.U6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;ra.osfControlType=0===this.Hd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;ra.isForUILessAction=4===
this.Hd.WebExtensionOsfControlType;ra.sourceLocationOverrideResourceId=this.Hd.SrcLocationOverrideResourceId;ra.focusOnIframeWhenLoaded=this.Hd.FocusOnIframeWhenLoaded;jb.a(this.Hd)&&(ra.featureGates=t.AFrameworkApplication.fa.Q2e(ra.solutionId));ra.hostInfoFlags=0;this.Yta&&(ra.hostInfoFlags|=2);Xa.HelperMethods.Gw(this.Hd)&&(ra.hostInfoFlags|=1);this.$.Z2||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),ra.hostInfoFlags|=4);Ea.EwaSettings.ma(626)&&(ra.hostInfoFlags|=
8);Ea.EwaSettings.ma(52)&&Ea.EwaSettings.ma(92)&&!this.nJc&&(ra.virtualOsfControlActivationCallback=()=>{this.Mg.XEd(this.Hd)});ra.sharedRuntimeId=this.Hd.SharedRuntime?this.Hd.SharedRuntime.Resid:this.Hd.SharedRuntimeId;!Xa.HelperMethods.Gw(this.Hd)||this.Hd.Preload||jb.a(this.Hd)||this.Mg.Yh.getOsfControl(a(736).DdaFacade.getSolutionId(this.Hd,this.$))||(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Mg.XEd(this.Hd):this.Mg.XEd(this.Hd));
ra.initialDisplayMode=this.Hd.TaskpaneVisible?2:1;Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(ra.titleOverride=this.xl.TaskpaneTitle);this.Mg.Yh.insertOsfControl(ra)}this.IU=0}else this.iMe(!0)}Igg(ra){this.Jgg(ra);this.IUj()}ibi(){this.Ldb||this.ii.k0b(this.V9e);this.Ldb++}Jgg(ra){0<this.Ldb&&(ra?this.Ldb=0:this.Ldb--,this.Ldb||this.ii.Tuc(this.V9e))}wmd(){if(!this.Mwa){const ra=ca.h(this.$).ha;this.Lsc=dc.d(ca.h(this.$).ha.ra.selectedRanges);ra.PE(this.Pc);this.Mwa=
!0}}IUj(){this.Mwa&&(ca.h(this.$).ha.DI(this.Pc),this.Mwa=!1)}Irj(ra){var ya=new fc.Range(ra.Reference.FirstRow+1,ra.Reference.FirstColumn+1,ra.Reference.LastRow+1,ra.Reference.LastColumn+1,!1,!1);1===ra.BindingType&&(ra.HasHeaders&&--ya.top,ra.HasTotals&&(ya.bottom+=1));var mb=ca.h(this.$).ha.ra.selectedRanges;ra=ya.Zzb(this.Lsc);mb=ya.Zzb(mb);return(ya=ya.Ie(ca.h(this.$).ha.ra.activeRange))&&(qa.e(ra)&&!qa.e(mb)||!qa.e(ra)&&!qa.e(mb)&&!dc.Q(ra,mb))?ya:null}Jsj(){Array.forEach(this.nF,ra=>{if(ra.eventId!==
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&ra.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Mg.ij.v1b(this.controlId))if(ra.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)ra.e3b(new Fa.a(ra.eventId,this.controlId,null));else if(ra.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const ya=this.L3a(ra.targetId);if((null===ya||void 0===ya?0:ya.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Cb.oa.sheetName:this.$.xa.oa.name)===
ya.Reference.SheetName){const mb=this.Irj(ya);mb&&ra.e3b(new Ka(ra.eventId,this.controlId,this.Mg.j2b(ya),ya,mb.top-1,mb.left-1,mb.height,mb.width))}}})}wvb(ra,ya){if(!this.nF)return null;for(let mb=0;mb<this.nF.length;mb++){const Hb=this.nF[mb];if(Hb.eventId===ra&&Hb.targetId===ya)return Hb}return null}EXe(){const ra=ha.a(this.$).cV;for(let ya=ra.length-1;0<=ya;--ya){const mb=ra[ya];if(3===mb.floatingObject.type&&mb.floatingObject.xl.InstanceId===this.D1.WebExtensionId)return mb}return null}kqi(){for(let ra=
0;ra<this.$.Cb.count;ra++)if(this.$.Cb.getItem(ra).imageId===this.D1.WebExtensionId)return!0;return!1}wyc(ra){this.tQc=ra;this.Dy.id=this.HKf;this.Dy.className=db;this.Dy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Puj()}y5e(){if(!this.enabled)return null;const ra=jb.a(this.xl)?"":this.xl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.xl.PrimaryMarketplace.SolutionId,ra)}X9e(ra,ya){if(Ea.EwaSettings.ma(23))this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
ya);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Nge)this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,ya);else{const mb={};mb[U.a.Oob]=this.controlId;const Hb=new Na.a(ra,0,this.$.isEditMode?2:1,0,null);this.$.Ja.Lb(Hb,mb);this.Mg.yv(ya)}}catch(mb){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${mb.message}.`),this.Mg.rf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
ya)}}static Znh(ra){return ra===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ra===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Fhf(ra){return ra===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||ra===OSF.DDA.EventDispId.dispidSettingsChangedEvent||ra===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static dqd(ra){return ra===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ra===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Dhf(ra){return ra===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Ehf(ra){return ra===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Chf(ra){return ra===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Jb,"OsfControl",fb.a,[882]);class Pb{constructor(){this.VZa={}}add(ra){this.VZa[ra]=!0}remove(ra){delete this.VZa[ra]}clear(){for(const ra of Object.keys(this.VZa))delete this.VZa[ra]}kaf(){return 0<Object.keys(this.VZa).length}RMh(){return Object.keys(this.VZa)}}Object(c.a)(Pb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var eb=a(58);class Ma{constructor(ra,ya,mb){this.BTf=this.ATf=0;this.hNb=this.ybb=null;this.wMi=()=>{var Hb=ca.h(this.$).ha.Sa.cB;if(this.Npd(Hb)&&(Hb=this.Jwb(Hb))){var Zb={};Zb.chartId=Hb;Zb.worksheetId=this.Pja();Zb=eb.a.hc(Zb);this.nja(51,Hb,Zb);this.nja(51,this.Pja(),Zb)}};this.xMi=()=>{if(this.ybb){var Hb={};Hb.chartId=this.ybb;Hb.worksheetId=this.hNb;Hb=eb.a.hc(Hb);this.nja(52,this.ybb,Hb);this.nja(52,this.hNb,Hb)}Hb=ca.h(this.$).ha.Sa.cB;this.Npd(Hb)?(this.ybb=this.Jwb(Hb),this.hNb=this.Pja()):
this.hNb=this.ybb=null};this.$=ra;this.ij=ya;this.ii=mb}Qpb(ra){51===ra.messageType?this.ATf=this.kHa(ra.actionType,this.ATf,this.wMi):52===ra.messageType&&(this.BTf=this.kHa(ra.actionType,this.BTf,this.xMi))}kHa(ra,ya,mb){if(1===ra)ya||ca.h(this.$).ha.Sa.gXc(mb),ya++,this.Byj();else if(2===ra){if(1>ya)return ya;1===ya&&ca.h(this.$).ha.Sa.lMd(mb);ya--}return ya}nja(ra,ya,mb){ya&&this.ij.q_(ra,ya)&&this.ii.gN(ra,ya,mb)}Jwb(ra){return ra&&ra.floatingObject?(ra=ra.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===ra.length?ra[0]:null:null}Pja(){const ra=this.$.xa.oa;return ra&&0===ra.uG?ra.sheetId:null}Byj(){const ra=ca.h(this.$).ha.Sa.cB;this.Npd(ra)&&(this.ybb=this.Jwb(ra),this.hNb=this.Pja())}Npd(ra){return!!ra&&!!ra.floatingObject&&0===ra.floatingObject.type}}Object(c.a)(Ma,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var ob=a(740),Ia=a(193),Da=a(611),nb=a(100),Ua=a(350),W=a(55);class sa extends fa.a{constructor(ra,ya,mb){super();this.IU=this.vAa=0;this.Pc=(Hb,Zb)=>{if(this.enabled&&!(this.vjf()||
null!==Zb&&void 0!==Zb&&Zb.Kmf)&&(Hb=Object(ea.a)(nb.a,this.$.xa.oa))&&0===Hb.uG){const mc=Hb.sheetId,Pc=this.O1e();let fd=null,id=null;this.ij.ymf()&&(fd=this.grid.Bb.Bj(this.grid.ha.ra.activeCell),id=mc in this.Wkc?this.Wkc[mc]:null);this.Qve(mc,Pc)&&cb.TaskExtensions.za(W.Task.Ta(!0),()=>{this.H9h(mc,Pc);this.s9h(mc,Pc,fd,id)},this.ka);this.iNe(mc,Pc,fd)}};this.$=ra;this.ij=ya;this.ii=mb;this.grid=ca.h(ra);this.oOa={};this.Wkc={}}get enabled(){return!this.IU&&0<this.vAa}Q1b(ra){Object(ea.a)(Ua.a,
this.$.xa);1===ra.actionType?(this.vAa||this.grid.ha.PE(this.Pc),this.vAa++):2!==ra.actionType||1>this.vAa||(1===this.vAa&&this.grid.ha.DI(this.Pc),this.vAa--)}fyc(ra){ra?this.IU++:(0<this.IU&&this.IU--,this.IU||this.Pc(null,new Da.a(!1)))}O1e(){return this.grid.ha.ra.selectedRanges}Qve(ra,ya){return Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!ra&&Ia.e(this.oOa)||ra in this.oOa)&&!dc.Q(this.oOa[ra],ya):ra in this.oOa&&!dc.Q(this.oOa[ra],
ya)}iNe(ra,ya,mb){this.oOa[ra]=dc.d(ya);this.Wkc[ra]=mb}vjf(){return this.grid.eb||this.grid.ri}aYe(ra,ya){this.ij.q_(14,ra)&&this.ii.gN(14,ra,ya);this.ij.q_(14,ob.a.dX)&&this.ii.gN(14,ob.a.dX,ya)}H9h(ra,ya){const mb={};mb.worksheetId=ra;mb.address=this.Aid(ya);ya=eb.a.hc(mb);this.aYe(ra,ya)}s9h(ra,ya,mb,Hb){if(this.ij.ymf()){var Zb="";let mc="";Hb&&(Zb=Hb.mj);mb&&(mc=mb.mj);Hb?mb?(ya=mb.usedRange.Zzb(ya),Zb!==mc&&this.Eac(Zb,"",ra),this.Eac(mc,this.Aid(ya),ra)):this.Eac(Zb,"",ra):mb&&(Zb=mb.usedRange.Zzb(ya),
this.Eac(mc,this.Aid(Zb),ra))}}Eac(ra,ya,mb){if(this.ij.q_(100,ra)){const Hb={};Hb.address=ya;Hb.worksheetId=mb;this.ii.gN(100,ra,eb.a.hc(Hb))}}Aid(ra){return dc.i(ra,",",this.$,!1)}dispose(){0<this.vAa&&this.grid.ha.DI(this.Pc);this.Wkc=this.oOa=null;this.vAa=0;this.ii=this.ij=this.$=this.grid=null}}Object(c.a)(sa,"RichApiEventSelectionChangedHandler",fa.a,[]);var vb=a(346);class gc extends sa{constructor(ra,ya,mb){super(ra,ya,mb);this.Iof=this.Jof=null}O1e(){return vb.a.Rsb(this.grid.ha.rangePicker.lL)}Qve(ra,
ya){return this.Jof!==ra||!dc.Q(this.Iof,ya)}iNe(ra,ya){this.Jof=ra;this.Iof=dc.d(ya)}vjf(){return!this.grid.eb&&!this.grid.ri}aYe(ra,ya){this.ij.q_(2700,ob.a.dX)&&this.ii.gN(2700,ob.a.dX,ya)}}Object(c.a)(gc,"RichApiEventPickedRangesChangedHandler",sa,[]);class Bc{constructor(ra,ya,mb){this.jRa=this.iRa=0;this.JHa=this.Mha=null;this.yCf=()=>{var Hb=ca.h(this.$).ha.Sa.cB;if(0<this.jRa&&this.Mha&&this.JHa){var Zb={};Zb.shapeId=this.Mha;Zb.worksheetId=this.JHa;Zb=eb.a.hc(Zb);this.fireEvent(2102,this.Mha,
Zb)}this.Zri(Hb)?(this.Mha=this.jTj(Hb),this.JHa=this.Pja(),this.Mha&&this.JHa)?0<this.iRa&&(Hb={},Hb.shapeId=this.Mha,Hb.worksheetId=this.JHa,Hb=eb.a.hc(Hb),this.fireEvent(2101,this.Mha,Hb)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Mha}', or worksheet id: '${this.JHa}' from a Floating object or gridview.`):this.JHa=this.Mha=null};this.$=ra;this.ij=ya;this.ii=mb}Qpb(ra){const ya=ca.h(this.$).ha;1===ra.actionType?(this.iRa||this.jRa||ya.Sa.gXc(this.yCf),
2101===ra.messageType?this.iRa++:2102===ra.messageType&&this.jRa++):2===ra.actionType&&(2101===ra.messageType?this.iRa=0<this.iRa?this.iRa-1:0:2102===ra.messageType&&(this.jRa=0<this.jRa?this.jRa-1:0),this.iRa||this.jRa||ya.Sa.lMd(this.yCf))}Zri(ra){return!!ra&&!!ra.floatingObject&&(0===ra.floatingObject.type||7===ra.floatingObject.type||1===ra.floatingObject.type||3===ra.floatingObject.type||5===ra.floatingObject.type)}jTj(ra){if(!ra||!ra.floatingObject)return null;ra=ra.floatingObject.id;var ya=
ra.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));ya=ya&&1===ya.length?ya[0]:null;return ya?ya:(e.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${ra}', but we failed.`),null)}Pja(){const ra=this.$.xa.oa;return ra&&0===ra.uG?ra.sheetId:null}fireEvent(ra,ya,mb){ya&&this.ij.q_(ra,ya)&&this.ii.gN(ra,ya,mb)}}Object(c.a)(Bc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Sa{constructor(ra,ya,mb){this.ETf=this.DTf=this.FTf=this.CTf=
0;this.OZi=(Hb,Zb)=>{Hb=Object(ea.a)(nb.a,Zb.oa);this.D8a(Hb)&&(Zb={},Zb.worksheetId=Hb.sheetId,Zb=eb.a.hc(Zb),this.nja(11,Hb.sheetId,Zb))};this.RZi=(Hb,Zb)=>{Hb=Object(ea.a)(nb.a,Zb.UD);this.D8a(Hb)&&(Zb={},Zb.worksheetId=Hb.sheetId,Zb=eb.a.hc(Zb),this.nja(12,Hb.sheetId,Zb))};this.PZi=(Hb,Zb)=>{Hb=Object(ea.a)(nb.a,Zb.oa);this.D8a(Hb)&&(Zb={},Zb.worksheetId=Hb.sheetId,Hb=eb.a.hc(Zb),this.nja(11,null,Hb,!0))};this.QZi=(Hb,Zb)=>{Hb=Object(ea.a)(nb.a,Zb.UD);this.D8a(Hb)&&(Zb={},Zb.worksheetId=Hb.sheetId,
Hb=eb.a.hc(Zb),this.nja(12,null,Hb,!0))};this.$=ra;this.ij=ya;this.ii=mb}Qpb(ra){11===ra.messageType?ra.targetId===ob.a.dX?this.KSg(ra.actionType):this.JSg(ra.actionType):12===ra.messageType&&(ra.targetId===ob.a.dX?this.LSg(ra.actionType):this.MSg(ra.actionType))}JSg(ra){this.CTf=this.kHa(ra,this.CTf,this.OZi)}MSg(ra){this.FTf=this.kHa(ra,this.FTf,this.RZi)}KSg(ra){this.DTf=this.kHa(ra,this.DTf,this.PZi)}LSg(ra){this.ETf=this.kHa(ra,this.ETf,this.QZi)}kHa(ra,ya,mb){1===ra?ya=this.CZc(ya,mb):2===ra&&
(ya=this.u8c(ya,mb));return ya}CZc(ra,ya){ra||this.$.xa.Xf(ya);ra++;return ra}u8c(ra,ya){if(1>ra)return ra;1===ra&&this.$.xa.Eg(ya);ra--;return ra}D8a(ra){return!!ra&&0===ra.uG}nja(ra,ya,mb,Hb=!1){ya=Hb?ob.a.dX:ya;this.ij.q_(ra,ya)&&this.ii.gN(ra,ya,mb)}}Object(c.a)(Sa,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var na=a(239),ib=a(14),Ib=a(224);class ec extends Sys.EventArgs{constructor(ra,ya,mb,Hb){super();this.sheet=ra;this.X0g=ya;this.offsetX=mb;this.offsetY=Hb}}Object(c.a)(ec,"ClickInActiveCellEventArgs",
Sys.EventArgs,[]);class qb{constructor(ra,ya,mb){this.t4b=null;this.Ptd=!1;this.onPointerDown=Hb=>{let Zb;3===Hb.tb?({W0a:Zb}=this.gridView.Vbc(Hb.clientPoint),this.Ptd=!!Zb&&this.gridView.ha.ra.qNe(Zb)):this.Ptd=!1;this.t4b=Hb.clientPoint;return!1};this.gd=Hb=>{if(this.gridView.inRangePicker||this.gridView.ri||this.Ptd||Hb.shiftKey||Hb.ctrlKey||Hb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.t4b||!Hb.clientPoint||Hb.clientPoint.x!==this.t4b.x||Hb.clientPoint.y!==this.t4b.y)return!1;const Zb=
({W0a:Hb}=this.gridView.Vbc(Hb.clientPoint)).returnValue,mc=Object(ea.a)(nb.a,this.$.xa.oa);if(Zb&&mc&&0===mc.uG){if(!this.gridView.ha.ra.C4.contains(Hb))return!1;Hb=new ec(mc,Hb,Xa.HelperMethods.JGd(Zb.x),Xa.HelperMethods.JGd(Zb.y));this.SZi(Hb)}return!1};this.$=ra;this.gridView=ca.h(ra);this.ij=ya;this.ii=mb;this.Odj()}dispose(){this.vVj()}Odj(){for(const ra of this.gridView.Mn){const ya=ra.domElement;na.a.instance.sa(ib.a.pointerDown,ya,this.onPointerDown);Ib.a.instance.sa(ib.a.click,ya,this.gd)}}vVj(){for(const ra of this.gridView.Mn){const ya=
ra.domElement;na.a.instance.Ba(ib.a.pointerDown,ya,this.onPointerDown);Ib.a.instance.Ba(ib.a.click,ya,this.gd)}}SZi(ra){var ya=ra.sheet;if(this.D8a(ya)){var mb={};mb.worksheetId=ya.sheetId;mb.address=ra.X0g.toString();mb.offsetX=ra.offsetX;mb.offsetY=ra.offsetY;ra=ya.sheetId;this.ij.q_(21,ra)&&(ya=eb.a.hc(mb),this.ii.gN(21,ra,ya));ra=ob.a.dX;this.ij.q_(21,ra)&&(mb=eb.a.hc(mb),this.ii.gN(21,ra,mb))}}D8a(ra){return!!ra&&0===ra.uG}}Object(c.a)(qb,"RichApiEventSingleClickedHandler",null,[]);class Ha{constructor(ra,
ya,mb){this.AJb=0;this.pbb=this.vbb=null;this.IJf=()=>{const Hb=ca.h(this.$).ha.Sa.cB;if(Hb)if(this.nnf(Hb)){const Zb=this.Pja();this.Wcd(Zb);this.vbb=Hb.floatingObject.id;this.pbb=Zb}else this.vbb&&(this.Wcd(this.pbb),this.pbb=this.vbb=null);else this.vbb&&(this.Wcd(this.pbb),this.pbb=this.vbb=null)};this.$=ra;this.ij=ya;this.ii=mb}Q1b(ra){2E3===ra.messageType&&(1===ra.actionType?(this.AJb||ca.h(this.$).ha.Sa.gXc(this.IJf),this.AJb++,this.Wuj()):2===ra.actionType&&this.AJb&&(1===this.AJb&&ca.h(this.$).ha.Sa.lMd(this.IJf),
this.AJb--))}Wcd(ra){var ya;const mb={};mb.worksheetId=ra;mb.revisionLoad=!1;if(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(Ea.EwaSettings.ma(701)||Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Hb=ca.h(this.$).ha.Sa.cB;(null===(ya=null===Hb||void 0===Hb?void 0:Hb.floatingObject)||void 0===ya?0:ya.Vc)?mb.selectedVisualId=Hb.floatingObject.Vc.VisualID:mb.selectedVisualId=null}ya=
eb.a.hc(mb);ra&&this.ij.q_(2E3,ra)&&this.ii.gN(2E3,ra,ya)}Pja(){const ra=this.$.xa.oa;return ra&&0===ra.uG?ra.sheetId:null}Wuj(){const ra=ca.h(this.$).ha.Sa.cB;this.nnf(ra)&&(this.vbb=ra.floatingObject.id,this.pbb=this.Pja())}nnf(ra){return!!ra&&ra.lud()}}Object(c.a)(Ha,"RichApiEventVisualSelectionChangedHandler",null,[]);class Ab{constructor(ra,ya,mb){this.BJb=0;this.Gmg=!0;this.Tac=0;this.Lsd=!0;this.jCe=()=>{const Hb=document.hasFocus();if(this.Gmg!==Hb){if(Hb){const Zb=eb.a.hc({});this.ii.gN(2203,
ob.a.dX,Zb)}this.Gmg=Hb}};this.kCe=Hb=>{(0<Hb.timeRemaining()||Hb.didTimeout)&&this.jCe();window.requestIdleCallback(this.kCe)};this.$=ra;this.ij=ya;this.ii=mb;window.requestIdleCallback||(this.Lsd=!1)}ISg(ra){1===ra.actionType?(this.BJb||this.bTg(),this.BJb++):2!==ra.actionType||1>this.BJb||(1===this.BJb&&this.Kkh(),this.BJb--)}bTg(){if(this.ij.q_(2203,ob.a.dX))if(this.Lsd){const ra={};ra.timeout=this.$.va.CheckFocusTimeout;this.Tac=window.requestIdleCallback(this.kCe,ra)}else this.Tac=window.setInterval(this.jCe,
this.$.va.CheckFocusTimeInterval)}Kkh(){this.Lsd?window.cancelIdleCallback(this.Tac):window.clearInterval(this.Tac)}}Object(c.a)(Ab,"RichApiEventWorkbookActivatedHandler",null,[]);var Yb;(function(ra){ra[ra.none=0]="none";ra[ra.registerEvent=1]="registerEvent";ra[ra.unregisterEvent=2]="unregisterEvent";ra[ra.customFunction=3]="customFunction";ra[ra.showCard=4]="showCard";ra[ra.createWorkbook=5]="createWorkbook";ra[ra.openWorkbook=6]="openWorkbook";ra[ra.enableEvents=7]="enableEvents";ra[ra.closeWorkbook=
8]="closeWorkbook";ra[ra.setCalculationMode=9]="setCalculationMode";ra[ra.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";ra[ra.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";ra[ra.workbookLinksEnableContent=12]="workbookLinksEnableContent";ra[ra.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";ra[ra.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";ra[ra.rangePicker=15]="rangePicker";ra[ra.enableRichApiRecording=16]="enableRichApiRecording";ra[ra.recordAction=
17]="recordAction";ra[ra.focus=18]="focus";ra[ra.businessBarShow=19]="businessBarShow";ra[ra.businessBarHide=20]="businessBarHide"})(Yb||(Yb={}));Object(c.b)("PostProcessActionType",Yb);var Bb=a(249);class Qb{constructor(ra,ya,mb){this.IKf=null;this.Ucd=(Hb,Zb)=>{const mc=ob.a.dX,Pc={};Pc.eventId=Hb;Pc.payload=Zb;this.ij.q_(2201,mc)&&this.ii.gN(2201,mc,eb.a.hc(Pc))};this.$=ra;this.ij=ya;this.ii=mb;this.Hfi()}HSg(ra){1===ra.actionType?(this.$.Pba=!0,Object(ea.a)(a(736).DdaFacade,Bb.a(this.$)).Vcd(!0)):
2===ra.actionType&&(this.$.Pba=!1);this.IKf=ra.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${Yb[ra.actionType]}; controlId: ${this.IKf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Pba}.`)}Urh(ra){Object(ea.a)(a(736).DdaFacade,Bb.a(this.$)).dYe(ra,this.$.Pba)}Hfi(){this.$.MV&&cb.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(this.$.da,297,298,1),ra=>{(ra=ra.result)&&ra.init(this.Ucd)},this.$.ka,3)}}Object(c.a)(Qb,"RichApiMacroRecorderEventHandler",
null,[]);class sc{}Object(c.a)(sc,"SessionRecreationInfo",null,[]);class kb{constructor(ra,ya,mb){this.$=ra;this.ij=ya;this.runtimeCalculationMode=mb}jIi(){return Ea.EwaSettings.ma(256)?this.ij.x$h()||0!==this.runtimeCalculationMode:!1}PXg(){var ra={};ra.eventRegistrationInfos=this.ij.bTh();ra.runtimeCalculationMode=this.runtimeCalculationMode;ra=Object(b.a)(new sc,{runtimeState:ra});const ya={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};ya.RequestBody=JSON.stringify(ra);
ya.RequestFlags=1;return ya}}Object(c.a)(kb,"RichApiRuntimeStateHandler",null,[]);class Eb{constructor(ra,ya,mb,Hb,Zb,mc,Pc,fd,id){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=ra;this.processUtcTime=ya;this.dequeueUtcTime=mb;this.inQueueDurationInMS=Hb;this.executionDurationInMS=Zb;this.operationCount=mc;this.ServerCorrelationId=
Pc;this.UserOperationName=fd;this.IsDocumentHidden=id}}Object(c.a)(Eb,"UserOperationQueueItemsStatisticsData",null,[]);var Gc=a(331),zc=a(31),yb=a(19),gb=a(294),Kb=a(50),sd=a(595),Sb=a(66),yc=a(59),Fc=a(71);class Zc extends Gc.a{constructor(ra,ya,mb){super(mb,ra);this.owa=this.hashCode=null;this.t5b=!1;this.$m=(Hb,Zb)=>{Zb.Yc.hash===this.hashCode&&this.owa&&Object(ea.a)(a(736).DdaFacade,this.$.da.Aa(35)).QFj(this.owa.InstanceId)};this.tf=(Hb,Zb)=>{switch(Zb.Yc.block.state){case 1:case 3:case 5:this.gea(Zb)}};
this.Ij=()=>{this.PIb(!0)};this.Lo=(Hb,Zb)=>{this.isVisible&&this.UUa(Zb.UD);this.clearCache()};this.ue=(Hb,Zb)=>{this.XTa(Zb.oa,!!Zb.UD)};this.dO=()=>{this.$.ea.Lma()};this.vVa=ya;this.domElement.classList.add(zc.a.u$b);this.domElement.classList.add(yb.a.Ao);mb.tabIndex=0;this.XTa(this.$.oa,!1);this.Gc.la("mousedown",this.dO);this.Gc.la("contextmenu",Hb=>{Fc.g(Hb)});this.$.xa.IJ(this.Lo);this.$.Cb.IJ(this.Lo);this.$.Cb.Xf(this.ue);this.$.xa.Xf(this.ue);this.Da.nt(this.tf);this.Da.gH(this.$m);this.Da.hw(this.Ij);
this.lv(this.dza)}get Da(){return this.vVa}dispose(){this.$&&(this.$.xa.sL(this.Lo),this.$.Cb.sL(this.Lo),this.$.Cb.Eg(this.ue),this.$.xa.Eg(this.ue));this.vVa&&(this.vVa.cr(this.tf),this.vVa.CI(this.$m),this.vVa.ex(this.Ij));this.Ky(this.dza);this.clearCache();X.a.Ia(this.vVa);this.vVa=null;ua.DOMElementExtensions.uf(this.domElement);super.dispose()}Ouj(ra){ua.DOMElementExtensions.uf(ua.DOMElementExtensions.getElementById(this.domElement,ra.id));this.domElement.appendChild(ra)}fod(){if(this.owa&&
!this.t5b){var ra=Object(ea.a)(a(736).DdaFacade,Bb.a(this.$)).yn(this.owa.InstanceId);ra&&(ra.resize(this.owa.Width,this.owa.Height),ra.la(this.domElement),ra.showHide(!0),this.t5b=!0)}}F8a(){return!0}gea(ra){this.owa=ra.Yc.block.ke;this.t5b=!1;this.fod()}UUa(ra){this.$.ea.n5&&ra&&(ra.Yu||(ra.Yu=new gb.a),ra.Yu.fi=new Kb.a(this.domElement.scrollLeft,this.domElement.scrollTop),ra.Yu.hIb=20)}clearCache(){this.Da.oRa(this.hashCode);this.owa=this.hashCode=null;this.t5b=!1}XTa(ra,ya){if(this.isVisible=
!!ra&&Sb.o(ra))this.hashCode=this.Da.hsa(ra,yc.a.A7b,this.hashCode),this.Lyc(ya)}static lHa(ra){if(!ra.da.Aa(34)){const ya=ra.wf;ra.da.Ga(34,new Zc(ra,new sd.a(ra,ra.ea,ra.pa.Nk,3,0),ya.appendChild(ya.ownerDocument.createElement("div"))))}}}Object(c.a)(Zc,"WebExtensionView",Gc.a,[881,739,2]);var Rd=a(226),Ed=a(374),ne=a(439),ze=a(188),Be=a(60),td=a(116),Se=a(47),$b=a(46),Xc=a(153),ed=a(110),Rc=a(63),Fd=a(28),Nd=a(29),zd=a(282),Sd=a(22),se=a(13),He=a(281),Gd=a(739),fe=a(51),$d=a(147),qe=a(866);const pe=
ra=>{$d.a.sendOtelEvent(Object.assign(new qe.a,{otelEvent:ra}))},Ne=ra=>{$d.a.sendOtelCustomerContent(Object.assign(new qe.a,{otelEvent:ra}))};var Le=a(201),gf=a(865),Ye=a(25),$e=a(223);a.d(F,"DdaFacade",function(){return Ya});class Ya extends lb.a{constructor(ra,ya){super();this.ii=this.Im=this.ea=null;this.Cf=[];this.KJa=null;this.disposed=this.initialized=this.JRb=this.TJe=!1;this.RCa=null;this.brc=[];this.NJe=[];this.pQa=[];this.l2a=null;this.AGd=new Y.a(va.a.ak());this.E0b=new N.a(va.a.ak());
this.QHb=[];this.aMf=[];this.E7b=350;this.Wxa=this.ofa=null;this.fVc=!1;this.hje=this.gje=this.fje=this.dje=this.$ie=this.eje=this.aje=this.cje=this.Zie=this.bje=null;this.Bf=()=>{this.RCa=this.ea.Ho.WebExtensions;for(var mb=this.Cf.length-1;0<=mb;--mb){var Hb=this.Cf[mb],Zb;if(Zb=!this.BGh(Hb.controlId))Zb=Hb,Zb=Ea.EwaSettings.ma(120)?!Zb.Yta:!0;Zb&&(Hb.Yoc(),this.Cf.splice(mb,1))}if(this.RCa)for(let mc=0,Pc=this.RCa.length;mc<Pc;mc++)mb=this.RCa[mc],(Hb=this.yn(mb.WebExtensionId))&&Hb.RDd(mb)};
this.Zpc=mb=>{this.raiseEvent("csc",mb.getID())};this.cEd=(mb,Hb,Zb)=>{if(Hb===OSF.AgaveHostAction.KeyboardShortcuts){var mc=Object(ea.a)(Object,Zb);Hb={};Hb.keyCode=mc.keyCode;Hb.type="keydown";Hb.ctrlKey=mc.ctrlKey;Hb.shiftKey=mc.shiftKey;Hb.altKey=mc.altKey;Hb.metaKey=mc.metaKey;mc=this.yn(mb);mb=mc.r$;Hb.srcElement=Object(Ca.a)(450,mb)?mb.YGa:ca.h(this.$).mc;mb=new Sys.UI.DomEvent(Hb);mc=Ya.Ava(mc.xl,this.$);Hb={};Hb.focusedAddinId=mc;mc=new Na.a(1461300262,1,this.$.Hc,6,null);ca.h(this.$).nLb(mb,
mc,Hb)}else if(Hb===OSF.AgaveHostAction.Select)this.I9e(!0);else if(Hb===OSF.AgaveHostAction.UnSelect)this.I9e(!1);else if(Hb===OSF.AgaveHostAction.CancelDialog)this.CK(-684355545,null);else if(Hb===OSF.AgaveHostAction.InsertAgave)mb={},Zb&&(mb[U.a.ssa]=Zb,mb[ka.a.og]=Ya.Vsb(Zb),this.CK(-741808261,mb));else if(Hb===OSF.AgaveHostAction.InsertDevManifest)mb={},Zb&&(mb[U.a.ssa]=Zb,mb[ka.a.og]=Ya.Vsb(Zb),this.CK(-741808261,mb));else if(Hb===OSF.AgaveHostAction.InsertDevManifestError)mb=Object(ea.a)(Object,
Zb),mb={[U.a.OXc]:this.Im.getDevManifestInvalidUrlErrorString(mb.manifestUrl)},this.CK(-2025863019,mb);else if(Hb===OSF.AgaveHostAction.NotifyHostError)mb={[U.a.OXc]:this.Im.getManifestInvaildErrorString()},this.CK(-2025863019,mb);else if(Hb===OSF.AgaveHostAction.RefreshAddinCommands)Ea.EwaSettings.ma(52)&&this.CK(Ye.a.refreshAddinCommands,null);else if(Hb===OSF.AgaveHostAction.CtrlF6Exit||Hb===OSF.AgaveHostAction.CtrlF6ExitShift){if(mc=this.$.da.Aa(15)){(mb=this.yn(mb).r$)&&mb.VAc();w.a.Jf&&document.activeElement.blur();
var Pc={keyCode:117,type:"keydown",ctrlKey:!0};Pc.shiftKey=Hb===OSF.AgaveHostAction.CtrlF6ExitShift;Pc.srcElement=Object(Ca.a)(450,mb)?mb.YGa:ca.h(this.$).mc;mb=new Sys.UI.DomEvent(Pc);mc.Dma(mb)}}else if(Hb===OSF.AgaveHostAction.PageIsReady){if((mb=this.yn(mb).r$)&&mb.b_a===OSF.OsfControlTarget.TaskPane&&(mb=this.$.da.Aa(183))&&this.Cf){Hb=xb.a.fd(this.$);for(mc of this.Cf)Ya.eNa(mc.uU)&&(Hb?mb.kg(!0,!1):mb.setFocusOnToolbarFirstElement())}}else if(Hb===OSF.AgaveHostAction.TabExit){Hb=this.yn(mb);
const Dd=Hb.r$;if(Dd)if(Dd.b_a===OSF.OsfControlTarget.InContent)Dd.lof();else{if(Dd.b_a===OSF.OsfControlTarget.TaskPane)if(xb.a.fd(this.$))w.a.Jf&&document.activeElement.blur(),Z.UISurfaces.aj().then(Zd=>{const bc=Object(Ca.a)(450,Dd)?Dd:null;bc?bc.isResizable?Zd.focusResizeHandle():Zd.focusTabbedTaskPaneArea():Zd.focusTabbedTaskPaneArea();return null});else if(Hb=this.$.da.Aa(183))w.a.Jf&&document.activeElement.blur(),(mb=document.getElementById(this.$.Eb+Aa.a.$nc))&&ua.DOMElementExtensions.isVisible(mb)?
ua.DOMElementExtensions.setFocus(mb):Hb.setFocusOnToolbarFirstElement()}else Hb&&4===Hb.osfControlType&&this.Im.notifyAgave(mb,OSF.AgaveHostAction.TabIn)}else if(Hb===OSF.AgaveHostAction.TabExitShift)(Hb=this.yn(mb),mc=Hb.r$)?mc.b_a===OSF.OsfControlTarget.InContent?mc.mof():mc.b_a===OSF.OsfControlTarget.TaskPane&&(mb=Object(Ca.a)(450,mc)?mc:null)&&(w.a.Jf&&document.activeElement.blur(),mb.O3f()):Hb&&4===Hb.osfControlType&&this.Im.notifyAgave(mb,OSF.AgaveHostAction.TabIn);else if(Hb===OSF.AgaveHostAction.EscExit||
Hb===OSF.AgaveHostAction.ExitNoFocusable||Hb===OSF.AgaveHostAction.ExitNoFocusableShift)if(mc=this.yn(mb).r$)mc.VAc();else{if(Hb===OSF.AgaveHostAction.EscExit){Hb=null;for(Pc of D.o5h())if(Pc.value.Fe===mb){Pc.value.dialog.hide();Hb=Pc.key;break}Hb&&(mb=this.yn(Hb))&&4!==mb.osfControlType&&this.Yh.notifyAgave(Hb,OSF.AgaveHostAction.TabIn)}}else if(Hb===OSF.AgaveHostAction.InstallCustomFunctions)if(Ea.EwaSettings.ma(120)){Rc.a(this.$).iZe(()=>!1);var fd=this.$.da;cb.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(fd,
278,279,1),Dd=>{Dd=Dd.result;fd.Aa(278)||fd.Ga(278,Dd);const Zd=Zb.osfControl.getStoreType();Dd.nff(Zb.osfControl.getSolutionId(),Zd,Ya.sRh(Zb.osfControl),Zb).Ina()},this.ka,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Hb===OSF.AgaveHostAction.UninstallCustomFunctions)if(Ea.EwaSettings.ma(120)){Rc.a(this.$).iZe(()=>!1);var id=this.$.da;cb.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(id,278,279,
1),Dd=>{Dd=Dd.result;id.Aa(278)||id.Ga(278,Dd);Dd.Lgg(Zb.solutionId,Zb.storeType).Ina()},this.ka,3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Hb===OSF.AgaveHostAction.SendTelemetryEvent?pe(Zb):Hb===OSF.AgaveHostAction.SendCustomerContent?Ne(Zb):Hb===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.Ewi(Zb):Hb===OSF.AgaveHostAction.RefreshRibbonGallery?Ea.EwaSettings.getBooleanFeatureGate($e.a.eB,
!1)?(mb=this.$.da.Aa(519))&&mb.aMa(Zb):(mb=this.$.da.Aa(352))&&mb.aMa(Zb):Hb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.ufj(Zb.solutionId),xb.a.fd(this.$)||(mb=this.$.da.Aa(183))&&mb.lA(),Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&t.AFrameworkApplication.ub.Zd(Ye.a.WTf,2,Zb.solutionId)):Hb===OSF.AgaveHostAction.GetOriginalControlId&&(mb=new J.a(this.$.Eb,Zb.ownerAddinSolutionId,new da.a,!0),Zb.originalControlId=mb?mb.fKe(Zb.controlId):
Zb.controlId)};this.Ksj=(mb,Hb)=>{const Zb=Array(2);Zb[0]=Hb;Zb[1]=null;this.ii.LGh(mb,JSON.stringify(Zb))};this.wZi=()=>{this.$.oa&&Sb.o(this.$.oa)&&this.$.da.Aa(34).fod()};this.ed=()=>{this.kqf()};this.GR=(mb,Hb)=>{var Zb,mc;1===Hb.Lr&&(mb=Hb.Tf)&&(Hb=new Eb(ed.toTimestamp(mb.enqueueUtcTime),ed.toTimestamp(mb.processUtcTime),ed.toTimestamp(mb.dequeueUtcTime),ed.getElapsedMilliseconds(mb.enqueueUtcTime,mb.processUtcTime),ed.getElapsedMilliseconds(mb.processUtcTime,mb.dequeueUtcTime),mb.operationCount,
(null===(mc=null===(Zb=mb.operation)||void 0===Zb?void 0:Zb.nd)||void 0===mc?0:mc.ServerCorrelationId)?mb.operation.nd.ServerCorrelationId:null,mb.operation?Enum.toString(ne.a,mb.operation.operationName):null,Gd.a.BD(ed.getElapsedMilliseconds(mb.enqueueUtcTime,Fd.a.Qa.zb))),Zb=Sys.Serialization.JavaScriptSerializer.serialize(Hb),e.ULS.sendTraceTag(50872916,0,50,Zb))};this.Tc=(mb,Hb)=>{!this.ea.Zb&&Rd.a(Hb)?(Array.forEach(this.Cf,this.mBf),this.Cf.length=0,this.JRb=!1):(Hb.VH&&(e.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),this.xYf()),this.wL(),Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.JRb=!1))};this.No=()=>{Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.xYf());this.wL();Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.JRb=
!1)};this.mBf=mb=>{mb.Yoc();this.raiseEvent("cd",mb.controlId)};this.jb=ra;this.fYc=ya;this.initialize();$a.la(this);this.yZf=0;(ra=(ra=!(w.a.Dp||w.a.y5))&&(!Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!w.a.Jf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.jxg={}}get C1b(){return this.ofa||(this.ofa=new P.a(this.$.ru))}dXc(ra){this.addHandler("cd",ra)}wgj(ra){this.removeHandler("cd",ra)}bLg(ra){this.addHandler("csc",ra)}ygj(ra){this.removeHandler("csc",
ra)}ZKg(ra){this.addHandler("ca",ra)}vgj(ra){this.removeHandler("ca",ra)}$Kg(ra){this.addHandler("ci",ra)}aLg(ra){this.addHandler("ekros",ra)}xgj(ra){this.removeHandler("ekros",ra)}dGd(ra,ya){try{return JSON.parse(ra)[ya].toLowerCase()}catch(mb){return""}}sBj(ra){const ya=this.dGd(ra,"AudienceGroup"),mb=this.dGd(ra,"SessionOrigin");try{const Hb=parseInt(this.dGd(ra,"Ring"),10);if("automation"!==ya&&"bluechicken"!==mb&&-2<=Hb)return!0}catch(Hb){if("automation"!==ya&&"bluechicken"!==mb)return!0}return!1}get Yh(){if(!this.Im){const ra=
{},ya=!(this.$.qd&1),mb=za.a.current.mL,Hb=this.$.workbookContext,Zb=S.a.ML+S.a.Q4b;ra.pageBaseUrl=mb.LayoutsContentUrlPrefix;ra.appName=OSF.AppName.ExcelWebApp;ra.appVersion="16";ra.appSettings=this.nVh();ra.singleSignOnSettings=G.AppsForOfficeSingleSignOnManager.V1h();ra.clientMode=ya?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;ra.appUILocale=this.$.va.UICultureTag;ra.dataLocale=this.$.va.DataCultureTag;ra.docUrl=Hb.ClientUrl;ra.hostControl=this;ra.formFactor=OSF.FormFactor.Default;ra.lcid=
this.$.GG.toString();ra.localizedScriptsUrl=S.a.ML+S.a.$3c;ra.localizedImagesUrl=Zb;ra.localizedStylesUrl=S.a.ML+S.a.hFe;ra.localizedResourcesUrl=Zb;ra.osfOmexBaseUrl=mb.OsfOmexBaseUrl;ra.firstPartyManifestCDNUrl=mb.FirstPartyAddInManifestCDN;ra.sdxAssetsToPrefetchMapping=t.AFrameworkApplication.fa.Xa("SdxAssetsToPrefetchMapping");ra.sdxCdnUrl=mb.SdxCdnUrl;ra.sdxDmsUrl=mb.SdxDmsUrl;ra.devCatalogUrl=mb.DevCatalogUrl;ra.controlStatusChanged=this.Zpc;ra.notifyHost=this.cEd;ra.allowExternalMarketplace=
this.$.ea.Yg.get(27)&&Ya.B5b;ra.enableAddinCommands=Ea.EwaSettings.ma(52);ra.enableBlackForestRedirect=Ea.EwaSettings.ma(87);ra.enableMyOrg=this.$.ea.Yg.get(33);ra.enableMyApps=this.$.ea.Yg.get(34);ra.enableDevCatalog=Ea.EwaSettings.ma(43);ra.enablePrivateCatalog=this.lCj();ra.enableTaskpaneUpgradeToAppCommand=Ea.EwaSettings.ma(92);ra.showSignOutFromPrivateCatalogMessage=this.$.ea.Yg.get(36);ra.enableUploadFileDevCatalog=Ea.EwaSettings.ma(52)&&!Ea.EwaSettings.ma(279);ra.userNameHashCode=V.a.mw(t.AFrameworkApplication.userName);
ra.envCode=this.$.va.OfficeAddinTelemetryDataSourceCode.toString();ra.enableSingleSignOnForAddin=!Ea.EwaSettings.ma(23)&&t.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;ra.enableDisplayBlockedMinorError=Ea.EwaSettings.ma(180);ra.hideAppsExtensionUrl=t.AFrameworkApplication.hideAppsExtensionUrl;ra.enableAnonymousUseLegacyCatalogService=Ea.EwaSettings.ma(170);ra.enableInsertDialogAccessibilityFix=Ea.EwaSettings.ma(177);ra.disableAppsForOfficeThirdParty=Ea.EwaSettings.ma(183);ra.enableFirstPartySSO=
Ea.EwaSettings.ma(195);ra.wacSessionId=this.$.va.UserSessionId;ra.disableLogging=!this.$.va.AriaLoggingIsEnabled;ra.enableFirstPartySDXErrorMessages=Ea.EwaSettings.ma(208);ra.enableRichApiCellEditDelay=Ea.EwaSettings.ma(187);ra.isHostDocumentDomain=Ea.EwaSettings.ma(223);ra.loggableUserId=t.AFrameworkApplication.fa.Xa("LoggableUserId");ra.sessionStartInfoJson=t.AFrameworkApplication.fa.Xa("SessionStartInfoJson");ra.wopiHostOriginFromPostMessage=t.AFrameworkApplication.wopiHostOriginFromPostMessage;
ra.wopiHostOriginFromWacPropBag=t.AFrameworkApplication.fa.Xa("PostMessageOrigin");ra.wacIsEmbedded=t.AFrameworkApplication.fa.qa("IsEmbedded");ra.accessibilityAllowFocusAddinTaskpane=t.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");ra.enableRemoveAppCommandsAddin=t.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");ra.isHostFrameTrustCheckEnabledForAddIns=t.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");ra.isHostFrameTrusted=t.AFrameworkApplication.isHostFrameTrusted;
ra.agaveAddinUploadEnabled=Ea.EwaSettings.ma(45);ra.hostAllowedOfficeStore=t.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");ra.hostAllowedSdxEmbedding=t.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");ra.hostInstallAddIns=t.AFrameworkApplication.fa.Xa("HostInstallAddIns");ra.hostInstallAddInsIsEnabled=t.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");ra.approvedAddIns=t.AFrameworkApplication.fa.Xa("ApprovedAddIns");ra.addinEnforceHttpsIsEnabled=this.sBj(ra.sessionStartInfoJson);
ra.hostFeatureGateFlag=0;ra.isUpnCheckEnabled=t.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");ra.wacUpn=t.AFrameworkApplication.fa.Xa("UserPrincipalName");ra.isReactRibbonEnabled=xb.a.isReactRibbonEnabled();ra.enableSetFocusOnTaskpaneOnUserAction=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);ra.isSafariWithIndexedDBDisabled=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&w.a.KNa;ra.isIndexedDBDisabled=
Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&w.a.KNa||Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&w.a.Jf;ra.enableCustomShortcuts=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");ra.changeGetModifierKeyStringOutputOrder=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");ra.officeJsUrl=t.AFrameworkApplication.CL("OfficeJs/excel.js",5);ra.enableOfficeJsUrlParam=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.Im=new OSF.ContextActivationManager(ra);this.Im.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Im.setWSA(t.AFrameworkApplication.Tn);this.Im&&"undefined"!==typeof this.Im.hostCheckReadyHandler&&t.AFrameworkApplication.XLg(Object(d.a)(this.Im,this.Im.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const mc=ja.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Im.setOAuthManager(mc)}catch(mc){}}return this.Im}get M2j(){return this.fVc}get ij(){return this.bje}get Dna(){return this.Zie}get YOd(){return this.cje}get XOd(){return this.aje}get Xnj(){return this.eje}get Vnj(){return this.$ie}get Wnj(){return this.dje}get Ynj(){return this.fje}get Znj(){return this.gje}get ZOd(){return this.hje}get BV(){return this.jxg}get $(){return this.jb}j2b(ra){const ya=
{};ya.Name=ra.Name;ya.BindingType=ra.BindingType;ya.HasHeaders=ra.HasHeaders;ra.IsValidRef&&(ya.ColCount=ra.Reference.LastColumn-ra.Reference.FirstColumn+1,ya.RowCount=ra.Reference.LastRow-ra.Reference.FirstRow+1);return ya}Cpf(ra,ya){const mb=this.TWg(ya);if(t.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")){let Hb=null;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==mb.assetId&&
"undefined"!==typeof mb.assetId&&null!==ya&&"LaunchAddinDialogFromTellMe"===ya[0]&&(Hb="{98143890-AC66-440E-A448-ED8771A02D52}");this.Im.launchInsertDialog(ra,Hb,mb)}else this.Im.launchInsertDialog(ra,null,mb)}uda(ra,ya){if(t.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.uPf(ra,ya,OSF.StoreTypeEnum.MarketPlace);else{const mb={};mb.callbackFunc=ra;mb.storeType=OSF.StoreTypeEnum.MarketPlace;mb.fromInsertDialog=!1;mb.refresh=ya;this.Im.queryEntitlementDetails(mb)}}uPf(ra,
ya,mb){const Hb={};Hb.callbackFunc=ra;Hb.storeType=mb;Hb.fromInsertDialog=!1;Hb.refresh=ya;this.Im.queryEntitlementDetails(Hb)}invokeDdaMethod(ra,ya){const mb=this.yn(ra.DdaMethod.ControlId);mb?mb.invokeDdaMethod(ra,ya):this.rf(ba.a.internalError,ya)}registerDdaEventAsync(ra,ya,mb,Hb,Zb){(ya=this.yn(ya))?Ya.LAb(ra)?ya.pcj(ra,mb,Hb,Zb):this.rf(ba.a.tFd,Zb):this.rf(ba.a.internalError,Zb)}unregisterDdaEventAsync(ra,ya,mb,Hb,Zb){(ya=this.yn(ya))?Ya.LAb(ra)?ya.ZUj(ra,mb,Hb,Zb):this.rf(ba.a.tFd,Zb):this.rf(ba.a.internalError,
Zb)}dispose(){this.disposed||(this.$.Kl(this.ed),this.ea.tk(this.Tc),this.ea.YR(this.No),this.ea.Nv(this.Bf),this.fYc.detach(this),this.$.userOperationManager.ko(this.GR),this.brc=this.Cf=this.ii=this.fYc=this.jb=null,this.KJa&&(this.KJa.dispose(),this.KJa=null),X.a.Ia(this.YOd),X.a.Ia(this.XOd),this.l2a&&(this.l2a.dispose(),this.l2a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}$fd(ra){return(ra=this.yn(ra))?ra.getDefaultIconUrl():null}fyc(ra){if(this.TJe!==
ra){this.TJe=ra;for(let ya=0,mb=this.Cf.length;ya<mb;ya++){const Hb=this.Cf[ya];ra?Hb.iMe(!1):Hb.Lqh()}this.YOd.fyc(ra);this.XOd.fyc(ra)}}NRh(ra){return(ra=this.yn(ra))?ra.getDefaultDisplayName():null}rf(ra,ya,mb=!0){const Hb={};Hb[ka.a.og]=ra;Hb[ka.a.Y3]=ya;this.CK(451041795,Hb,mb)}yv(ra){const ya={};ya[ka.a.Y3]=ra;this.CK(1237877382,ya)}CK(ra,ya,mb=!0){const Hb=new Na.a(ra,0,this.$.Hc,0,null),Zb=ya?ya[ka.a.Y3]:null;this.l2a&&ca.h(this.$).eb&&Pa.H5g(ra,ya)?this.l2a.yjh(ra,ya):(ra=this.$.Ja.Lb(Hb,
ya),mb&&cb.TaskExtensions.za(ra,mc=>{Xc.a(mc)?this.rf(ba.a.internalError,Zb,!1):mc.result||(ca.h(this.$).eb?this.rf(ba.a.NMa,Zb,!1):this.rf(ba.a.internalError,Zb,!1))},this.ka,8))}h8g(ra){return!!this.mja(ya=>Ya.getSolutionId(ya.xl,this.$)===Ya.getSolutionId(ra,this.$)&&ya.xl.PrimaryMarketplace.MarketplaceType===ra.PrimaryMarketplace.MarketplaceType&&ya.xl.PrimaryMarketplace.MarketplaceRef===ra.PrimaryMarketplace.MarketplaceRef&&ya.xl.PrimaryMarketplace.SolutionVersion===ra.PrimaryMarketplace.SolutionVersion)}yn(ra){return this.mja(ya=>
ya.controlId.startsWith(ra))}oGh(ra){return this.mja(ya=>ya.Yta===ra)}FXe(ra){return this.mja(ya=>ya.uU===ra&&!!ya.Yta)}UXe(ra,ya,mb,Hb){return this.mja(Zb=>Zb.uU===ra&&Zb.xl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===ya.toLowerCase()&&Zb.xl.PrimaryMarketplace.MarketplaceType.toLowerCase()===mb.toLowerCase()&&!!Zb.xl.SharedRuntime&&!!Zb.xl.SharedRuntime.Resid&&!!Hb&&!!Hb.Resid&&Zb.xl.SharedRuntime.Resid.toLowerCase()===Hb.Resid.toLowerCase())}wSg(ra,ya){if(ra=this.yn(ra))ra.la(ya),ra.showHide(!0)}QFj(ra){(ra=
this.yn(ra))&&ra.showHide(!1)}LIa(ra){var ya;if(1!==ra.WebExtensionType||this.$.qd&8388608&&ra.TaskpaneVisible||this.$.qd&8388608&&!ra.TaskpaneVisible&&Xa.HelperMethods.Gw(ra)){let mb=null;Xa.HelperMethods.Gw(ra)&&(mb=Ya.Ava(ra,this.$),ra.TaskpaneWidth||(ra.TaskpaneWidth=this.E7b));const Hb=(new Jb(this,this.ii,ra)).Snd();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra.PrimaryMarketplace.SolutionId,Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?ra.OwnerAddinStoreType||ra.PrimaryMarketplace.MarketplaceType:ra.PrimaryMarketplace.MarketplaceType,null===(ya=ra.AssetMarketplace)||void 0===ya?void 0:ya.SolutionId,null,null,ra.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${ra.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Xa.HelperMethods.Gw(ra)}`);mb&&(Hb.Yta=mb);this.Cf.push(Hb);this.Wxa=null;this.U6a(ra.InstanceId)||(ra=String.format("{0}|{1}|{2}|{3}|{4}",ra.PrimaryMarketplace.SolutionId,ra.PrimaryMarketplace.SolutionVersion,
ra.PrimaryMarketplace.MarketplaceRef,ra.PrimaryMarketplace.MarketplaceType,ra.WebExtensionType),this.raiseEvent("ci",ra))}}wHj(ra,ya){ra.TaskpaneWidth=this.E7b;ra.TaskpaneVisible=!0;const mb={};mb.SolutionId=ra.PrimaryMarketplace.SolutionId;mb.TargetType=ra.WebExtensionType;mb.Version=ra.PrimaryMarketplace.SolutionVersion;mb.StoreType=ra.PrimaryMarketplace.MarketplaceType;mb.StoreId=ra.PrimaryMarketplace.MarketplaceRef;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?ra.AssetMarketplace?(mb.AssetId=ra.AssetMarketplace.SolutionId,mb.AssetStoreId=ra.AssetMarketplace.MarketplaceRef):(mb.AssetId=null,mb.AssetStoreId=null):(mb.AssetId=ra.PrimaryMarketplace.SolutionId,mb.AssetStoreId=ra.PrimaryMarketplace.MarketplaceRef);mb.Width=ra.TaskpaneWidth;const Hb=new Jb(this,this.ii,ra,!0);Hb.Snd();this.Cf.push(Hb);const Zb=()=>{this.qRa(Hb.controlId);this.Yh.purgeOsfControl(Hb.controlId,!1);ya()};let mc=null;mc=Se.a.instance.cD(()=>{Hb.Dy&&(X.a.Ia(mc),mc=null,this.Yh.insertBlankControlWithErrorUX(this.pIb(Hb,
mb),Zb))},100,$b.a.lih)}fbh(ra){if(ra&&ra.length){var ya=[];ra.forEach(mb=>{if(mb.ContainsCustomFunctions){const Hb=Ya.Ava(mb,this.$);this.AGd.contains(Hb)||(this.AGd.add(Hb),this.aMf.push(mb));this.h8g(mb)||ya.push(mb)}});ya.length&&this.aHe(ya)}}$Ie(ra,ya){this.yn(ra.InstanceId)||(ya=ya(),ra=(new Jb(this,this.ii,ra)).gef(ya),this.Cf.push(ra),this.Wxa=null)}jFj(ra){Ya.e2a.lb(ra)&&Ya.e2a.na(ra).initializeAndShowWithTitle()}tai(ra){Ya.e2a.lb(ra)&&Ya.e2a.na(ra).hide()}FYh(ra){var ya=null;let mb,Hb,
Zb=null;mb=Ya.ckd(ra,!0);if(!mb)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),W.Task.Ta(null);(Hb=this.Im.getOsfControl(Ya.getSolutionId(mb,this.$)))&&(ya=Hb.getManifest())&&(Zb=ya.getSharedRuntimeForCustomFunctions("Workbook"));if(ya=Zb&&1===Zb.LifeTime?this.UXe(mb.PrimaryMarketplace.SolutionId,mb.PrimaryMarketplace.MarketplaceRef,mb.PrimaryMarketplace.MarketplaceType,Zb):this.oGh(ra))return W.Task.Ta(ya.controlId);const mc=
new la.a;Xa.HelperMethods.qkc(Zb)&&(mb.SharedRuntime=Zb);ra=Hb?Hb.getNotificationParams():[];if(!ra.length)return this.EHe(mb);this.l8f(ra,()=>{cb.TaskExtensions.za(mc.task,()=>{this.EHe(mb)},this.ka,3)},()=>{});return mc.task}PMh(ra){ra=Ya.ckd(ra,!1);if(!ra)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let ya=null;var mb=this.Im.getOsfControl(Ya.getSolutionId(ra,this.$));mb&&(mb=mb.getManifest())&&(ya=mb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
return Xa.HelperMethods.qkc(ya)&&(ra=this.UXe(ra.PrimaryMarketplace.SolutionId,ra.PrimaryMarketplace.MarketplaceRef,ra.PrimaryMarketplace.MarketplaceType,ya))?ra.controlId:null}A$g(ra,ya){var mb=Ya.ckd(ra,!1);if(mb){var Hb=null,Zb=this.Im.getOsfControl(Ya.getSolutionId(mb,this.$));Zb&&(Zb=Zb.getManifest())&&(Hb=Zb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Xa.HelperMethods.qkc(Hb)){mb.SharedRuntime=Hb;var mc=mb.PrimaryMarketplace.SolutionId;Zb=mb.PrimaryMarketplace.SolutionVersion;
var Pc=OSF.OsfManifestManager.getCachedManifest(mc,Zb);if(Pc)if(this.E0b.lb(ra))Hb=this.E0b.na(ra),cb.TaskExtensions.za(Hb,Dd=>{(Dd=Dd.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Dd,ya,this.ii.cMb)},this.ka,3);else{var fd={};fd.solutionId=mc;fd.version=Zb;fd.storeType=mb.PrimaryMarketplace.MarketplaceType;fd.storeId=mb.PrimaryMarketplace.MarketplaceRef;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?mb.AssetMarketplace?(fd.assetId=
mb.AssetMarketplace.SolutionId,fd.assetStoreId=mb.AssetMarketplace.MarketplaceRef):(fd.assetId=null,fd.assetStoreId=null):(fd.assetId=mc,fd.assetStoreId=null);fd.targetType=OSF.OsfControlTarget.TaskPane;var id=new la.a;mb=cb.TaskExtensions.Uj();mb=new aa.a(this.$,this,fd,mb);Hb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(mc,Hb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Pc,Hb,Zb);mb.createUILessSandbox(fd,Pc,(Dd,Zd)=>{Dd&&!Zd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Dd,
ya,this.ii.cMb),id.setResult(Dd)):id.setResult(null);this.E0b.remove(ra)});this.E0b.ia(ra,id.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}ZBe(ra){(ra=this.FXe(ra))&&(ra.xl.SharedRuntime||this.NJb(ra.controlId))}NJb(ra){(ra=this.FXe(ra))&&this.qRa(ra.controlId)}vnh(ra,ya){if(!this.Cf||!ra||!ya)return!1;if(ra.toLowerCase()===ya.toLowerCase())return!0;let mb=null,Hb=null;for(let Zb=0,mc=this.Cf.length;Zb<mc;Zb++){const Pc=this.Cf[Zb];
if(Pc.ownerAddinSolutionId&&(Pc.controlId===ra&&(mb=Pc.ownerAddinSolutionId.toLowerCase()),Pc.controlId===ya&&(Hb=Pc.ownerAddinSolutionId.toLowerCase()),mb&&Hb))break}return mb&&mb===Hb?!0:!1}BIg(ra){this.yn(ra.InstanceId)||(ra=new Jb(this,this.ii,ra),this.Cf.push(ra),this.Wxa=null)}AUf(ra){if(this.Cf&&0<=ra&&ra<this.Cf.length){const ya=this.Cf[ra],mb=ya.Dy;this.Cf.splice(ra,1);this.mBf(ya);ua.DOMElementExtensions.uf(mb)}}qRa(ra){if(this.Cf)for(let ya=0,mb=this.Cf.length;ya<mb;ya++)if(this.Cf[ya].controlId===
ra){this.AUf(ya);break}}ufj(ra){if(this.Cf){ra=ra.toLowerCase();for(let ya=0,mb=this.Cf.length;ya<mb;ya++)if(ra===this.Cf[ya].ownerAddinSolutionId.toLowerCase()){this.AUf(ya);break}}}aTg(ra){ra.Oi&&(this.yn(ra.floatingObject.xl.InstanceId)||(this.bhc(ra.floatingObject.xl.InstanceId)||this.brc.push(ra.floatingObject.xl.InstanceId),this.LIa(ra.floatingObject.xl)),this.ea.isNamedObjectViewMode&&this.wSg(ra.floatingObject.xl.InstanceId,ra.Jd))}Jaa(ra){if(this.Cf)for(let ya=0,mb=this.Cf.length;ya<mb;ya++)if(1===
this.Cf[ya].controlType&&Sd.a.equals(this.Cf[ya].uU,ra,!0))return this.Cf[ya].controlId;return null}QFh(ra){const ya=[];if(this.Cf)for(let mb=0,Hb=this.Cf.length;mb<Hb;mb++)Sd.a.equals(this.Cf[mb].uU,ra,!0)&&ya.push(this.Cf[mb].controlId);return ya}vGh(ra,ya){if(!ya||!ra)return null;if(this.Cf)for(let mb=0,Hb=this.Cf.length;mb<Hb;mb++)if(1===this.Cf[mb].controlType&&Sd.a.equals(this.Cf[mb].uU,ra,!0)&&this.Cf[mb].xl.SharedRuntime&&Sd.a.equals(this.Cf[mb].xl.SharedRuntime.Resid,ya.Resid,!0))return this.Cf[mb].controlId;
return null}p4a(ra,ya=null){return ra?ya?`${ra}.${ya}`:ra:""}bCe(ra,ya,mb){if(this.Wxa===ra)return!0;this.Wxa=ra;let Hb=null,Zb=!1;if(!Hb&&this.Cf)for(let mc=0,Pc=this.Cf.length;mc<Pc;mc++)if(1===this.Cf[mc].controlType&&Sd.a.equals(this.Cf[mc].uU,ra,!0)){let fd=!1,id=!1;ya?(fd=!0,id=!!this.Cf[mc].xl.SharedRuntime&&Sd.a.equals(this.Cf[mc].xl.SharedRuntime.Resid,ya.Resid,!0)):mb&&(fd=!0,id=Sd.a.equals(this.Cf[mc].xl.SharedRuntimeId,mb,!0));if(!fd||id){id&&this.Cf[mc].yg(!0);Hb=this.Cf[mc].controlId;
Zb=!0;this.Wxa=null;break}}Hb&&this.raiseEvent("ca",Hb);return Zb}setAppRuntimeState(ra,ya){var mb;if(ra){const Hb=this.yn(ra);if(Hb&&Xa.HelperMethods.Gw(Hb.xl))Hb.yg(ya),ya&&(this.raiseEvent("ca",ra),(null===(mb=Hb.Dy)||void 0===mb?0:mb.firstChild)&&(ra=Hb.Dy.firstChild.title)&&0<ra.length&&this.C1b.Csj(ra));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(se.a.instance.ga(2244));}else throw e.ULS.sendTraceTag(537170564,0,15,
"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(se.a.instance.ga(2245));}getAppRuntimeState(ra){if(ra)if((ra=this.yn(ra))&&Xa.HelperMethods.Gw(ra.xl))ra=ra.xl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(se.a.instance.ga(2244));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(se.a.instance.ga(2245));return ra}L3a(ra,ya){return(ra=
this.yn(ra))?ra.L3a(ya):null}U6a(ra){return this.dCe(this.brc,ra)}bhc(ra){return this.dCe(this.NJe,ra)}hpe(ra){this.NJe.push(ra)}KZ(ra){return(ra=this.yn(ra))?ra.xl:null}vBd(ra){this.raiseEvent("ekros",ra,this)}XEd(ra){if(ra){var ya=this.yn(ra.InstanceId);ya&&(ra.SharedRuntime||ra.SharedRuntimeId||(this.qRa(ya.controlId),this.Yh.purgeOsfControl(ya.controlId,!1)),ya={},ya.SolutionId=ra.PrimaryMarketplace.SolutionId,ya.TargetType=ra.WebExtensionType,ya.Version=ra.PrimaryMarketplace.SolutionVersion,
ya.StoreType=ra.PrimaryMarketplace.MarketplaceType,ya.StoreId=ra.PrimaryMarketplace.MarketplaceRef,Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?ra.AssetMarketplace?(ya.AssetId=ra.AssetMarketplace.SolutionId,ya.AssetStoreId=ra.AssetMarketplace.MarketplaceRef):(ya.AssetId=null,ya.AssetStoreId=null):(ya.AssetId=ra.PrimaryMarketplace.SolutionId,ya.AssetStoreId=ra.PrimaryMarketplace.MarketplaceRef),ya.Width=ra.TaskpaneWidth,ya.SharedRuntimeId=ra.SharedRuntimeId,
this.jfg(ya))}}Via(){this.ii.Via()}gN(ra,ya,mb){this.ii.gN(ra,ya,mb)}dYe(ra,ya){ya=Ya.Qeh(ya);ra=this.KZ(ra);this.ii.Dac(ra.InstanceId,2202,ob.a.dX,ya)}Vcd(ra){for(let ya=0,mb=this.Cf.length;ya<mb;ya++)this.dYe(this.Cf[ya].controlId,ra)}GGh(ra,ya){ya=Ya.fah(ya);this.ii.Dac(ra,65539,"",ya)}JGh(ra,ya,mb){this.ii.Dac(ra,1,ya,mb)}FGh(ra,ya){this.ii.KGh(ra,ya)}x$g(ra,ya){return[[2,1E3,"",JSON.stringify([ra,ya]),0,!1]]}Xji(){return!!this.Dna&&this.Dna.kaf()}m3g(){this.Dna&&this.Dna.clear()}HGh(){if(this.Dna&&
this.Dna.kaf()){var ra=this.Dna.RMh();for(const ya of ra){ra=this.QFh(ya);for(const mb of ra)this.ii.Dac(mb,65540,"","{}")}}}icj(ra){this.Dna.add(ra)}WUj(ra){this.Dna.remove(ra)}mja(ra){if(!this.Cf)return null;for(const ya of this.Cf)if(ra(ya))return ya;return null}EHe(ra){const ya=new la.a,mb=Ya.Ava(ra,this.$);if(Xa.HelperMethods.Gw(ra))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.YLf(ra,Hb=>{Hb?(ra.InstanceId=Hb.InstanceId,ra.WebExtensionOsfControlType=
3,ra.TaskpaneVisible=!1,this.LIa(ra),ya.setResult(ra.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra.PrimaryMarketplace.SolutionId,ra.PrimaryMarketplace.MarketplaceType,null,null,null,ra.PrimaryMarketplace.MarketplaceRef)} failed`),ya.setException(Error.create("Null insert data")))});else{Ya.e2a.ia(ra.InstanceId,new M.a);const Hb=Ya.e2a.na(ra.InstanceId).Hia;this.ebh(ra,Hb,mb);this.YLf(ra,null);ya.setResult(ra.InstanceId)}return ya.task}ebh(ra,
ya,mb){this.yn(ra.InstanceId)||(ra=new Jb(this,this.ii,ra),ra.Yta=mb,ra.gef(ya),this.Cf.push(ra),this.Wxa=null)}YLf(ra,ya){const mb=Ya.Ava(ra,this.$);if(!this.AGd.contains(mb))this.QHb.push(ra),1<=this.QHb.length&&this.ZLf(ra,ya);else if(ya)for(const Hb of this.aMf)if(Ya.Ava(Hb,this.$)===mb){ya(Hb,0);break}}ZLf(ra,ya){let mb=null;const Hb={};Hb.SolutionId=Ya.getSolutionId(ra,this.$);Hb.TargetType=ra.WebExtensionType;Hb.Version=ra.PrimaryMarketplace.SolutionVersion;Hb.StoreType=ra.PrimaryMarketplace.MarketplaceType;
Hb.StoreId=ra.PrimaryMarketplace.MarketplaceRef;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?ra.AssetMarketplace?(Hb.AssetId=ra.AssetMarketplace.SolutionId,Hb.AssetStoreId=ra.AssetMarketplace.MarketplaceRef):(Hb.AssetId=null,Hb.AssetStoreId=null):(Hb.AssetId=ra.PrimaryMarketplace.SolutionId,Hb.AssetStoreId=ra.PrimaryMarketplace.MarketplaceRef);Hb.Width=ra.TaskpaneWidth;Hb.ContainsCustomFunctions=!0;Xa.HelperMethods.Gw(ra)&&(Hb.SharedRuntimeId=ra.SharedRuntime.Resid);
const Zb=this.$.pa.ya;ra=this.$.pa.ya.Wb();const mc=Zb.Na(9,ra);mc.sharedInfo=Hb;const Pc=id=>{id=td.a.Pe(id.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Nd.a.sc(id)}`)},fd=id=>{id&&!zd.a(id)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hb.SolutionId,Hb.StoreType,Hb.AssetId,null,null,Hb.StoreId)} finish with errors: ${Nd.a.sc(id.Errors)}`);
this.QHb.shift();0<this.QHb.length&&this.ZLf(this.QHb[0],ya)};if(ya){const id=Dd=>{const Zd=Dd.Result;(mb=Zd?Zd.AgaveData:null)||ya(null,Dd.Errors?Dd.Errors[0].ErrorCause:5001);ya(mb,0)};ra=(Dd,Zd,bc)=>Be.g(Zb,"InsertAgaveTaskpane",mc,He.b(Dd,fd,id),He.a(Zd,Pc),bc,null,0)}else ra=(id,Dd,Zd)=>Be.g(Zb,"InsertAgaveTaskpane",mc,He.b(id,fd),He.a(Dd,Pc),Zd,null,0);Ed.a(this.$.userOperationManager,ra,id=>new ze.a(519,0,id,64),null)}lCj(){return this.$.ie.get(35)}TLd(ra){ra=this.yn(ra);(null===ra||void 0===
ra?0:ra.Wda)&&ra.KUf()}tJi(ra){var ya=this.mja(mb=>Ya.eNa(mb.uU));ya&&(ya=this.Yh.getOsfControl(ya.controlId))&&ya.notifyAgave(OSF.AgaveHostAction.SendMessage,ra)}Kki(){return!!this.mja(ra=>1===ra.controlType&&Ya.eNa(ra.uU))}Jki(){const ra=this.mja(ya=>Ya.eNa(ya.uU));return ra?ra.Dy?ua.DOMElementExtensions.isVisible(ra.Dy):!1:!1}Ovj(){const ra=this.mja(ya=>Ya.eNa(ya.uU));ra&&(ra.yg(!0),this.raiseEvent("ca",ra.controlId))}initialize(){const {DdaEventDispatch:ra}=a(1365),ya=void 0===this.$||null===
this.$||Ea.EwaSettings.ma(256);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");ya&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(Zc.lHa(this.$),this.ea=this.$.ea,this.ii=new ra(this.$),this.$.ll(this.ed),this.ea.Wj(this.Tc),this.ea.zM(this.No),this.ea.nu(this.Bf),this.$.userOperationManager.ur(this.GR),this.kqf(),this.GTi(),this.Wei(),this.$.da.Ga(35,
this),this.fYc.la(this),ya&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.bje=new ob.a,ya&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.eje=new Sa(this.$,this.ij,this.ii),new qb(this.$,this.ij,this.ii),this.cje=new sa(this.$,this.ij,this.ii),this.aje=new gc(this.$,this.ij,this.ii),this.$ie=new Ma(this.$,this.ij,this.ii),this.dje=new Bc(this.$,this.ij,this.ii),this.fje=new Ha(this.$,this.ij,this.ii),this.gje=
new Ab(this.$,this.ij,this.ii),this.$.MV&&(this.hje=new Qb(this.$,this.ij,this.ii)),Ea.EwaSettings.ma(187)&&(this.l2a=new Pa(this,ca.h(this.$))),Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Zie=new Pb),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}BGh(ra){if(!this.RCa)return null;for(let ya=0,mb=this.RCa.length;ya<mb;ya++)if(ra.startsWith(this.RCa[ya].WebExtensionId))return this.RCa[ya];return null}kqf(){var ra,
ya=this.ea;if(ya.Zb&&!this.JRb){if(ya.workbookContext){if(this.fVc=this.$.ea.Yg.get(22),null===(ra=ya.workbookContext.WebExtensions)||void 0===ra?0:ra.length){ra=ya.workbookContext.WebExtensions;ya=!1;for(let mb=ra.length-1;0<=mb;mb--){if(!this.ea.isNamedObjectViewMode){this.brc.push(ra[mb].InstanceId);if(1!==ra[mb].WebExtensionType){ra.splice(mb,1);continue}if(Xa.HelperMethods.Gw(ra[mb])&&0!==ra[mb].SharedRuntime.State)1===ra[mb].SharedRuntime.State?ra[mb].TaskpaneVisible=!1:2===ra[mb].SharedRuntime.State?
ra[mb].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!ra[mb].ContainsCustomFunctions&&!ra[mb].TaskpaneVisible&&!jb.a(ra[mb])){ra.splice(mb,1);continue}}const Hb=OSF.OsfControl.isFirstPartyStoreString(ra[mb].PrimaryMarketplace.MarketplaceType);if(Ea.EwaSettings.ma(183)&&!Hb&&(ra.splice(mb,1),!ya)){ya=!0;const Zb=wb.GetServiceTaskFactory.Oa(this.$.da,5,4,3);cb.TaskExtensions.za(Zb,()=>{Zb.result.ng(36,null)},this.ka,3)}Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&
ra[mb].PrimaryMarketplace&&Ya.eNa(ra[mb].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),ra.splice(mb,1))}this.aHe(ra)}}else this.fVc=!1;this.JRb=!0}}I9e(ra){const ya=ca.h(this.$),mb=ya.ha.Sa.$b;if(mb&&ra){ra=!1;if(this.Cf)for(const Hb of this.Cf)if(Ya.eNa(Hb.uU)||Ya.Sni(Hb.uU)){ra=!0;break}ra||ya.ha.Sa.vH(mb)}}GTi(){this.Yh&&this.ea.isNamedObjectViewMode&&this.$.oa&&Sb.o(this.$.oa)&&(this.$.da.Aa(34).dR?this.$.da.Aa(34).fod():
this.$.da.Aa(34).lv(this.wZi))}aHe(ra){let ya=null;ya=mb=>{const Hb=mb.WebExtensionData,Zb=mb.IsTaskPane,mc=mb.RecordHandler,Pc=()=>{this.pQa.shift();0<this.pQa.length&&ya(this.pQa[0])};if(this.Jaa(Hb.PrimaryMarketplace.SolutionId))Pc();else{Zb&&(Hb.WebExtensionOsfControlType=1);var fd=jb.a(Hb);if(!Zb||Hb.TaskpaneVisible||fd||Hb.SharedRuntime&&0!==Hb.SharedRuntime.State||Hb.ContainsCustomFunctions){var id=new Jb(this,this.ii,Hb,!Zb);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hb.PrimaryMarketplace.SolutionId,
Hb.PrimaryMarketplace.MarketplaceType,null,null,null,Hb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Hb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Xa.HelperMethods.Gw(Hb)}`);id.Snd();Xa.HelperMethods.Gw(Hb)&&(id.Yta=Ya.Ava(Hb,this.$),Hb.TaskpaneWidth=this.E7b);fd&&(Hb.WebExtensionToolTip="");Zb&&Hb.TaskpaneVisible&&!fd&&(Hb.TaskpaneWidth=this.E7b);this.Cf.push(id);var Dd=this.Wxa=null;Dd=Se.a.instance.cD(()=>{id.Dy&&(X.a.Ia(Dd),Dd=null,mc&&mc(mb,id),Pc())},100,$b.a.kih)}else Pc()}};
for(let mb=0;mb<ra.length;mb++)if(!this.yn(ra[mb].InstanceId))if(1!==ra[mb].WebExtensionType)this.LIa(ra[mb]);else if(!Ea.EwaSettings.ma(52))this.Hnb(ra[mb],ya);else if(this.$.qd&8388608||ra[mb].TaskpaneVisible){const Hb={};Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(Hb.solutionId=ra[mb].PrimaryMarketplace.SolutionId,Hb.version=ra[mb].PrimaryMarketplace.SolutionVersion);Hb.marketplaceId=ra[mb].PrimaryMarketplace.SolutionId;Hb.marketplaceVersion=ra[mb].PrimaryMarketplace.SolutionVersion;
Hb.storeType=ra[mb].PrimaryMarketplace.MarketplaceType;Hb.storeId=ra[mb].PrimaryMarketplace.MarketplaceRef;Hb.targetData=ra[mb];this.Yh.isAddinCommandsAsync(Hb,(Zb,mc,Pc)=>{if(Zb){var fd=Pc.targetData;if(mc){if(Ea.EwaSettings.ma(86))if(Hb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Zb=Hb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),mc=Hb.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Zb||mc)&&Xa.HelperMethods.Gw(fd)&&this.Hnb(fd,
ya);else if(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.p8h(Pc,ya);else{let id=!1;this.uda(Dd=>{if(!Dd.errorCode){if(Dd.value)for(const Zd of Dd.value){if(id)break;id=Le.e(Zd[1])===Le.e(fd.PrimaryMarketplace.SolutionId)}id?Xa.HelperMethods.Gw(fd)&&this.Hnb(fd,ya):(Dd={},Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Dd.SolutionId=Pc.solutionId,Dd.Version=Pc.version):(Dd.SolutionId=Pc.marketplaceId,
Dd.Version=Pc.marketplaceVersion),Dd.StoreType=fd.PrimaryMarketplace.MarketplaceType,Dd.StoreId=Pc.storeId,Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Dd.AssetId=null,Dd.AssetStoreId=null):(Dd.AssetId=Pc.marketplaceId,Dd.AssetStoreId=Pc.storeId),Dd.Width=fd.TaskpaneWidth,Dd.TargetType=fd.WebExtensionType,fd.TaskpaneVisible=!0,this.Rne(Dd,fd,ya))}},!0)}}else this.Hnb(fd,ya)}else Zb=Pc.targetData,e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Zb.PrimaryMarketplace.SolutionId,
Zb.PrimaryMarketplace.MarketplaceType,null,null,null,Zb.PrimaryMarketplace.MarketplaceRef)} from ${Zb.PrimaryMarketplace.MarketplaceType} during document loading`)})}}p8h(ra,ya){let mb=!1;this.uda(Hb=>{const Zb=ra.targetData;if(!Hb.errorCode){if(Hb.value)for(const mc of Hb.value){if(mb)break;mb=Le.e(mc[1])===Le.e(Zb.PrimaryMarketplace.SolutionId)}mb?Xa.HelperMethods.Gw(Zb)&&this.Hnb(Zb,ya):(Hb={},Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Hb.SolutionId=
ra.solutionId,Hb.Version=ra.version):(Hb.SolutionId=ra.marketplaceId,Hb.Version=ra.marketplaceVersion),Hb.StoreType=Zb.PrimaryMarketplace.MarketplaceType,Hb.StoreId=ra.storeId,Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Hb.AssetId=null,Hb.AssetStoreId=null):(Hb.AssetId=ra.marketplaceId,Hb.AssetStoreId=ra.storeId),Hb.TargetType=Zb.WebExtensionType,Hb.Width=Zb.TaskpaneWidth,Zb.TaskpaneVisible=!0,this.Rne(Hb,Zb,ya))}},!0)}Hnb(ra,ya){const mb={};mb.WebExtensionData=
ra;mb.IsTaskPane=!0;this.pQa.push(mb);1===this.pQa.length&&ya(mb)}Rne(ra,ya,mb){const Hb={};Hb.ActivationInfo=ra;Hb.WebExtensionData=ya;Hb.IsTaskPane=!1;Hb.RecordHandler=(Zb,mc)=>{const Pc=Zb.ActivationInfo;this.Yh.insertBlankControlWithErrorUX(this.pIb(mc,Pc),()=>{this.qRa(mc.controlId);this.Yh.purgeOsfControl(mc.controlId,!1);this.jfg(Pc)})};this.pQa.push(Hb);1===this.pQa.length&&mb(Hb)}jfg(ra){var ya={};ya.solutionId=ra.SolutionId;ya.version=ra.Version;ya.storeType=ra.StoreType;ya.storeId=ra.StoreId;
ya.assetId=ra.AssetId;ya.assetStoreId=ra.AssetStoreId;ya.targetType=ra.TargetType;ya.sharedRuntimeId=ra.SharedRuntimeId;ra=new Ra.a;ra.add(ya);ya={};ya[U.a.Kob]=ra;ya[U.a.BM]=3;ra=new Na.a(Ye.a.kDb,0,this.$.Hc,0,null);this.$.Ja.Lb(ra,ya)}pIb(ra,ya){const mb={};mb.div=ra.Dy;mb.id=ra.controlId;mb.solutionId=ya.SolutionId;mb.version=ya.Version;mb.storeId=ya.StoreId;mb.storeType=ya.StoreType;mb.osfControlType=OSF.OsfControlTarget.TaskPane;return mb}xYf(){if(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const mb=
[];for(var ra=0;ra<this.Cf.length;ra++){var ya=this.Cf[ra];0!==ya.osfControlType&&3!==ya.osfControlType&&4!==ya.osfControlType||mb.push(ya)}ra=!1;for(ya=0;ya<mb.length;ya++){const Hb=mb[ya];this.qRa(Hb.controlId);!ra&&Hb&&Hb.xl&&(ra=Xa.HelperMethods.Gw(Hb.xl))}ra&&this.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}Ea.EwaSettings.ma(395)&&cb.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(this.$.da,278,279,3),mb=>{mb&&(mb=mb.result)&&(this.$.da.Aa(278)||this.$.da.Ga(278,mb),mb.rff().Ina())},
this.ka,3)}wL(){var ra=new kb(this.$,this.ij,this.yZf);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Ea.EwaSettings.ma(256)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.ij||null===this.ij));if(ra.jIi()){const ya=()=>{},mb=Zb=>{Zb=td.a.Pe(Zb.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Nd.a.sc(Zb)}.`)},
Hb=ra.PXg();ra=Ya.Thd(Hb);ra|=64;this.$.userOperationManager.oD(new ze.a(507,0,(Zb,mc,Pc)=>Be.g(this.$.pa.ya,"ExecuteRichApiRequest",this.QXg(Hb),He.b(Zb,ya),He.a(mc,mb),Pc,null,0),ra))}}QXg(ra){const ya=this.$.pa.ya.Na(1);ya.request=ra;return ya}dCe(ra,ya){if(ra)for(let mb=0;mb<ra.length;mb++)if(Sd.a.equals(ra[mb],ya,!0))return!0;return!1}TWg(ra){const ya={};ya.navigationMode=OSF.OsfNavigationMode.DefaultMode;ya.assetId=null;ya.category=null;if(!ra||3>ra.length)return ya;if(ra[0]){const mb=parseInt(ra[0],
10);isNaN(parseInt(mb,10))||(ya.navigationMode=mb)}ra[1]&&(ya.assetId=ra[1]);ra[2]&&(ya.category=ra[2]);return ya}Wei(){if(Ea.EwaSettings.ma(60)){var ra=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(ra&&"*"!==ra.trim()){this.KJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Va(this),ra,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.ie.get(2));try{this.KJa.init()}catch(ya){try{this.KJa.dispose()}catch(mb){}this.KJa=null;e.ULS.sendTraceTag(537170510,
0,10,"EmbeddingEnpoint failed to initialize. Error message: "+ya.message)}ra={};ra.a=this.$.va.UserSessionId;fe.b().Qe(39,ra)}}}l8f(ra,ya,mb){const Hb=Ya.fWg(ra[0]),Zb=Hb.Iha,mc=Hb.Jia;Hb.Iha=()=>{Zb&&Zb();const Pc=Hb.HMa!==OSF.InfoType.Error?ya:null;ra.shift();ra.length?this.l8f(ra,Pc,mb):Pc&&Pc()};Hb.Jia=()=>{mc&&mc();mb&&Hb.HMa!==OSF.InfoType.Error&&mb()};Q.a.TUd(Hb)}nVh(){const ra={};ra.AddinRibbonControlsOverriddenByApi=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
ra.AddinActionDefinitionHybridMode=Ea.EwaSettings.ma(629).toString();ra.UseActionIdForUILessCommand=Ea.EwaSettings.ma(632).toString();ra.AllowStorageAccessByUserActivationOnIFrame=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();ra.RequirementSetRibbonApiOnePointTwo=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();ra.flightingTreatmentVariables=t.AFrameworkApplication.fa.Lac;
ra.ShortcutInfoArrayInUserPreferenceData=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return ra}static get B5b(){return Ya.M7d}static set B5b(ra){Ya.M7d=ra}static getSolutionId(ra){let ya=ra.PrimaryMarketplace.SolutionId;Ea.EwaSettings.ma(288)&&ra.OwnerAddinSolutionId&&(ya=ra.OwnerAddinSolutionId);return ya}static Thd(ra){let ya=0;Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ra.RequestFlags&1&&256!==
(ra.RequestFlags&256)||(ya=16):ya=ra.RequestFlags&1?0:16;return ya}static Ava(ra,ya){ya=Ya.getSolutionId(ra,ya);return Ya.S1e(ya,ra.PrimaryMarketplace.SolutionVersion,ra.PrimaryMarketplace.MarketplaceType,ra.PrimaryMarketplace.MarketplaceRef)}static Qeh(ra){return JSON.stringify({["recording"]:ra})}static fah(ra){const ya={};ya.visibility=ra?"Visible":"Hidden";return JSON.stringify(ya)}static sRh(ra){let ya=ra.getSolutionId(),mb=ra.getVersion(),Hb=ra.getStoreType();ra=ra.getStoreId();return Ya.S1e(ya,
mb,Hb,ra)}static S1e(ra,ya,mb,Hb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",ra,ya,Ya.r2h(mb).toString(),Hb)}static ckd(ra,ya){var mb=ra.split("|");if(7>mb.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==mb[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${mb[0]}'.`),null;let Hb=mb[1];const Zb=mb[2],mc=Ya.s2h(mb[3]),Pc=mb[4];mb=
mb[5];Hb&&Hb.length||(Hb=mb);mb={};mb.InstanceId=String.format("{{{0}}}",T.a.create().toString());mb.WebExtensionOsfControlType=4;mb.WebExtensionType=1;mb.PrimaryMarketplace={};mb.PrimaryMarketplace.SolutionId=Hb;mb.PrimaryMarketplace.SolutionVersion=Zb;mb.PrimaryMarketplace.MarketplaceRef=Pc;mb.PrimaryMarketplace.MarketplaceType=mc;mb.ContainsCustomFunctions=ya?!0:!1;ya&&(mb.OsfPropertyBag=[["customFunctionAddinId",ra]]);return mb}static s2h(ra){ra=parseInt(ra,10);return ra===OSF.StoreTypeEnum.MarketPlace?
OSF.StoreType.OMEX:ra===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:ra===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:ra===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:ra===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:ra===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:ra===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:ra===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:ra===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:ra===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:ra===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static r2h(ra){return ra===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:ra===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:ra===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:ra===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:ra===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:ra===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:ra===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
ra===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:ra===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:ra===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:ra===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static Vsb(ra){const ya={};ya.Version=ra.version;ya.AssetId=ra.assetId;Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?ya.AssetStoreId=ra.assetStoreId:ya.AssetStoreId=null!==ra.assetStoreId?
ra.assetStoreId.toString():null;ya.StoreType=ra.storeType;ya.Height=ra.height;ya.SolutionId=ra.solutionId;ya.StoreId=ra.storeId;ya.TargetType=ra.targetType;ya.Width=1===ya.TargetType?0:ra.width;ya.SharedRuntimeId=ra.sharedRuntimeId;return ya}static LAb(ra){return ra===OSF.DDA.EventDispId.dispidSettingsChangedEvent||ra===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||ra===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||ra===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||ra===
OSF.DDA.EventDispId.dispidRichApiMessageEvent||ra===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||ra===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||ra===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static fWg(ra){return Object(b.a)(new gf.a,{HMa:ra.infoType,id:ra.id,title:ra.title,description:ra.description,buttonText:ra.buttonTxt,Iha:ra.buttonCallback,Ffc:ra.highPriority,Jia:ra.dismissCallback,errorCode:ra.errorCode,mdf:ra.iframeNotificationUrl})}static eNa(ra){let ya=
"FA000000014"===ra;ya||(ya="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===ra);return ya}static Sni(ra){return"FA000000005"===ra}}Ya.e2a=new H.a;Ya.M7d=!0;Object(c.a)(Ya,"DdaFacade",lb.a,[182,857,708,858,859,2])},740:function(u,F,a){a.d(F,"a",function(){return e});u=a(0);var c=a(15),b=a(111);class e{constructor(){this.qLd=0;this.QW={};this.zta={}}KYh(f,d){return this.QW[e.$_c(f,d)]}pPe(f,d){d||void 0!==this.zta[f]&&null!==this.zta[f]?d&&void 0!==this.zta[f]&&null!==this.zta[f]&&delete this.zta[f]:
this.zta[f]=1}v1b(f){return void 0===this.zta[f]||null===this.zta[f]}t7h(f){const d=e.$_c(f.messageType,f.targetId);1===f.actionType?this.P8h(f.controlId,f.messageType,d):2===f.actionType&&this.A9h(f.controlId,f.messageType,d)}Xej(f){if(f){var d=Object.keys(this.QW);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.QW[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.QW[h])}}q_(f,d){f=e.$_c(f,d);f=this.QW[f];return!!f&&0<Object.keys(f).length}x$h(){return!b.a.isEmpty(this.QW)}ymf(){return 0<
this.qLd}bTh(){const f=[],d=this.QW;for(let m in d){var h=m,n=d[m];for(let x in n){n=x;const r={};r.eventType=parseInt(h.split("#")[0],10);r.targetId=h.split("#")[1];r.addinId=n;f.push(r)}}return f}P8h(f,d,h){if(this.QW[h])h=this.QW[h],h[f]=h[f]?h[f]+1:1;else{let n={};n[f]=1;this.QW[h]=n}100===d&&this.qLd++}A9h(f,d,h){if(this.QW[h]){const n=this.QW[h];if(f){const m=n[f];1===m?(delete n[f],Object.keys(n).length||delete this.QW[h]):n[f]=m-1;100===d&&this.qLd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static $_c(f,d){return String.format("{0}#{1}",f,d)}}e.dX="Workbook";Object(u.a)(e,"RichApiEventRegistration",null,[])},767:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=
f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(u.a)(c,"DdaEventArgs",null,[])},815:function(u,F,a){u=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(u.a)(c,"AddInDataTransferObject",null,[]);a.d(F,"a",function(){return b});class b{constructor(e,f,d){this.iSb=e;this.arg=f;this.brg=d}get mt(){return this.iSb}get XHg(){return this.arg}get YHg(){return this.brg}static m4a(e){return(e=e.jW)?Object.assign(new c,{tabs:e.mt.toArray(),
id:e.XHg,title:e.YHg}):null}}Object(u.a)(b,"OneLineRibbonExtensibility",null,[])},846:function(u,F,a){a.r(F);u=a(0);var c=a(187),b=a(15),e=a(99);class f{constructor(){this.startTime=0;this.callback=null}}Object(u.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(u.a)(d,"AccessTokenInformation",null,[902]);var h=a(963);class n{constructor(){this.token=null;this.expiresOn=0;this.vha=this.authChallenge=null}}Object(u.a)(n,"CachedTokenInfo",null,[]);class m{constructor(){this.MSb=
new c.a;this.l$=this.k$=!1;this.Qoa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Fse=null}get callbacks(){return this.MSb}}Object(u.a)(m,"SSORequestInfo",null,[]);class x extends m{constructor(){super();this.errorCode=0}}Object(u.a)(x,"SSOFailedRequestInfo",m,[]);var r=a(4);class y{constructor(L,V,T,H){this.sT=new c.a;this.VG=new c.a;this.Rpa=null;this.dmb=new c.a;this.Gde=Promise.resolve(null);this.Pke=!1;this.CXb=V;this.Ntg=L;this.sle=T;this.frg=H}lDj(L){if(this.Rpa&&this.Rpa.authChallenge===
L.authChallenge){if(Date.now()/1E3+y.HEi>this.Rpa.expiresOn)return this.Rpa=null,!1;L=new h.a;L.token=this.Rpa.token;L.expiresOn=this.Rpa.expiresOn;L.vha=this.Rpa.vha;L.EUa=!0;L.ayb=0;this.tyb(L);return!0}return!1}QBj(L){for(let V=0;V<this.VG.count;V++)if(this.VG.na(V).authChallenge===L.authChallenge&&this.VG.na(V).Qoa===L.Qoa){let T;(T=this.VG.na(V)).retryCount=T.retryCount+1;L.retryCount=this.VG.na(V).retryCount;if(this.VG.na(V).retryCount<y.fFi||!this.VG.na(V).k$&&L.k$||!this.VG.na(V).l$&&L.l$){if(!this.VG.na(V).k$&&
L.k$||!this.VG.na(V).l$&&L.l$)L.retryCount=0;this.VG.removeAt(V);break}L=new h.a;L.errorCode=this.VG.na(V).errorCode;this.tyb(L);return!0}return!1}QJg(L,V){for(let T=0;T<this.VG.count;T++)if(this.VG.na(T).Qoa===L.Qoa&&this.VG.na(T).authChallenge===L.authChallenge)return;this.VG.add(Object.assign(new x,{k$:L.k$,l$:L.l$,authChallenge:L.authChallenge,Qoa:L.Qoa,errorCode:V,retryCount:L.retryCount}))}get resource(){return this.CXb}Ted(L,V,T,H,D,G){const {AppsForOfficeSingleSignOnManager:J}=a(846);""===
T&&(T=null);if(this.Pke)J.l6(G,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var M=null;for(let Q of this.sT)if(Q.k$===L&&Q.l$===V&&Q.authChallenge===T&&Q.Qoa===D){M=Q;break}M||(M=Object.assign(new m,{k$:L,l$:V,authChallenge:T,Fse:H,Qoa:D,retryCount:0,startTime:J.Bw()}),this.sT.add(M));M.retryCount=0;M.callbacks.add(G);this.Gde=this.Gde.then(()=>{var {AppsForOfficeSingleSignOnManager:Q}=a(846);if(0<this.sT.count){var U=this.sT.na(0);if(this.lDj(U)||this.QBj(U))return null;
for(let P=0;P<this.dmb.count;)this.dmb.na(P)+y.NOj<Q.Bw()?this.dmb.removeAt(P):P++;if(this.dmb.count>=y.bFi||this.sT.count>=y.DEi)return U=new h.a,U.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.tyb(U),null;let Z=null;r.AFrameworkApplication.ta&&(Q=r.AFrameworkApplication.ta.lE)&&(Z=Q.Bc("ComponentAttach",this.Ntg+y.mDg));return U.Qoa.NFg(this.resource,U.k$,U.l$,U.authChallenge,this.frg,U.Fse).then(P=>{Z&&Z.stop();this.tyb(P)},()=>{Z&&Z.stop();const P=new h.a;P.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.tyb(P)})}return null})}}tyb(L){const {AppsForOfficeSingleSignOnManager:V}=a(846);try{if(this.sT.count){var T=this.sT.na(0);this.sT.removeAt(0);var H=null;L.errorCode||(H=new d,H.accessToken=L.token);L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.QJg(T,L.errorCode);var D={};null!=L.ayb&&(D.getTokenSilentTime=L.ayb.toString());null!=L.Hjd&&(D.getTokenPopupTime=L.Hjd.toString());null!=L.ehd&&(D.getIDTokenTime=L.ehd.toString());null!=L.EUa&&(D.tokenCached=L.EUa.toString());L.NYd&&(D.detailedError=L.NYd);L.vha&&(D.authLibrary=L.vha);T.retryCount&&(D.retryCount=T.retryCount);for(var G of T.callbacks)V.l6(G,L.errorCode,H,D);null!=L.EUa&&L.EUa||this.dmb.add(T.startTime);if(!L.errorCode)for(null!=L.expiresOn&&(this.Rpa=Object.assign(new n,{token:L.token,
expiresOn:L.expiresOn,authChallenge:T.authChallenge,vha:L.vha})),this.VG.clear(),G=0;G<this.sT.count;)if(this.sT.na(G).authChallenge===T.authChallenge){for(let J of this.sT.na(G).callbacks)V.l6(J,L.errorCode,H,D);this.sT.removeAt(G)}else G++}}catch(J){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",J.message)}}shutdown(){this.Pke=!0;this.sT.clear()}}y.NOj=6E4;y.bFi=6;y.DEi=6;y.fFi=3;y.HEi=300;y.mDg="GetAccessToken";Object(u.a)(y,"SSOCallbackManager",null,[]);
var t=a(720),v=a(731),w=a(120),C=a(80),B=a(27),z=a(30),A=a(147),E=a(347);a.d(F,"AppsForOfficeSingleSignOnManager",function(){return I});class I{constructor(L,V,T=null){this.EGc=new e.a;const H=new c.a;V&&H.add(V.jDi);T&&H.addRange(T);this.Im=L;this.nEg=H}Ued(L,V,T,H,D,G,J,M,Q,U){U=Object.assign(new f,{startTime:I.Bw(),callback:U});try{const S=!!T&&""!==T;var Z=U.startTime;const ja=this.getOsfControl(L);let X=ja.getStoreType()||"",Y=ja.getOwnerAddinStoreType()||"",va=ja.getSolutionId()||"";const N=
ja.getVersion()||"";X=X.toLowerCase();Y=Y.toLowerCase();va=va.toLowerCase();var P=C.a.dhd(V)||"";const ea=C.a.dhd(ja.getIframeUrl())||"",Ca=P.toLowerCase()===ea.toLowerCase();P=X;"inmemory"===X&&(P=Y);const la=Telemetry.PrivacyRules.GetPrivacyCompliantId(va,P,ja.getAssetId(),null,null,ja.getStoreId()),Ra={["callInstanceId"]:Z.toString(),["controlSolutionId"]:la,["controlVersion"]:N,["storeType"]:X,["ownerStoreType"]:Y,["allowConsentPrompt"]:H.toString(),["forMSGraphAccess"]:D.toString(),["allowSignInPrompt"]:G.toString(),
["hasAddinAuthChallenge"]:S.toString(),["securityOriginEqualsSourceLocation"]:Ca.toString(),["singleSignOnEnabled"]:J.toString(),["accountTypeFilter"]:M||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ra);A.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:w.a.Zj(Ra)}));Z=!0;const lb=r.AFrameworkApplication.fa.Xa("HostAuthType");switch(M){case "aad":Z="aad"===lb;break;case "msa":Z="msa"===lb;break;default:Z=!M||"noFilter"===M}if(Z){M=
null;if(J)for(let Aa of this.nEg)if(Aa.lmi(va)){M=Aa;break}M?this.isSSOAddin(L)?(J=!0,"omex"===P&&(J=!1),"spapp"===P||"spcatalog"===P?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),I.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):D&&!J?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),I.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)):(D&&"exchange"===P&&(H=!1),this.Ted(L,V,T,P,H,G,Q,M,U))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),I.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):I.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else I.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(S){this.Wlc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
S.message),I.l6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(L,V,T,H){this.Ued(L,T[t.a.PXc]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,V,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,H)}Ted(L,V,T,H,D,G,J,M,Q){this.EGc.lb(L)?H=this.EGc.na(L):(H=new y(L,this.getWebApplicationResource(L).split(",")[0],H,this.getDefaultDisplayName(L)),this.EGc.add(L,H));const U=H.resource;L=I.o0h(U,this.getWebApplicationId(L));const Z=OfficeExt.WACUtils.getHostSecure(V);L&&Z?L.toLowerCase()===Z.toLowerCase()?H.Ted(D,G,T,J,M,Q):(I.LOa('SSO Resource "'+U+'" cannot be used from "'+V+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),I.l6(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(L||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Z||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),I.l6(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Wlc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(L){return this.Im.getOsfControl(L)}isSSOAddin(L){return this.getOsfControl(L).getManifest().isSSOAddin()}getWebApplicationId(L){return this.getOsfControl(L).getManifest().getWebApplicationId()}getWebApplicationResource(L){return this.getOsfControl(L).getManifest().getWebApplicationResource()}getDefaultDisplayName(L){return this.getOsfControl(L).getManifest().getDefaultDisplayName()}static V1h(){try{const L=
{};B.a.Pxa&&v.a.lzb&&(L.UiHostSupportsAuthTokenAddinList=I.mYe);L.UiHostSupportsAuthToken=v.a.lzb;return L}catch(L){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",L.message)}return null}static getInstance(L,V,T=null){I.Ma||(I.Ma=new I(L,T));return I.Ma}static LOa(L){window.console.warn&&window.console.warn(L)}static o0h(L,V){if(!L)return"";V||(V="");let T=L.toLowerCase();var H=V.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(H)||
(I.LOa('SSO App Id "'+V+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));T.endsWith(H)||(I.LOa('SSO Resource "'+L+'" does not end with App Id "'+V+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!T.startsWith("https://")&&!T.startsWith("api://"))return I.LOa('SSO Resource "'+L+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(V=0;V<L.length;V++){H=L.charAt(V);const D=z.a.charCodeAt(L,V);if(33>D||126<D||"&"===H||"?"===H||"#"===H||"%"===H||"\\"===H)return I.LOa('SSO Resource "'+L+'" contains an invalid character "'+H+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+H+"' in resource URI."),""}if(0<=L.indexOf("::"))return I.LOa('SSO Resource "'+L+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
L.length)return I.LOa('SSO Resource "'+L+'" is '+L.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+L.length+"."),"";T.startsWith("api://")&&(T="https://"+T.substring(6,T.length));return 8===T.length?"":OfficeExt.WACUtils.getHostSecure(T)||""}static l6(L,V,T,H){var D=L.startTime;let G=0;0<D&&(G=I.Bw()-D);D={["callInstanceId"]:D.toString(),["callDuration"]:G.toString(),["errorCode"]:V.toString()};if(H)for(let J in H)D[J]=
H[J];b.ULS.sendTraceTag(51401116,344,50,"{0}",D);A.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:w.a.Zj(D)}));L.callback(V,T)}static Bw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(L){}return Date.now()}}I.mYe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");I.Ma=null;Object(u.a)(I,
"AppsForOfficeSingleSignOnManager",null,[870])},863:function(u,F,a){a.d(F,"a",function(){return b});u=a(0);var c=a(13);class b{constructor(){this.FVe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.EVe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1628),c.a.instance.ga(1632)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1629),c.a.instance.ga(1633)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1630),c.a.instance.ga(1634)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1631),c.a.instance.ga(1635)]};this.D$b=null}get nia(){return"SourceControlId"}get vN(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}jXh(){if(!this.D$b){this.D$b={};for(const e of Object.keys(this.FVe))this.D$b[e]=this.FVe[e];for(const e of Object.keys(this.EVe))this.D$b[e]=this.EVe[e][0]}}}Object(u.a)(b,"AddinCommandsStringProvider",null,[852])},865:function(u,F,a){a.d(F,"a",function(){return c});
u=a(0);class c{constructor(){this.HMa=0;this.Iha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Ffc=!1;this.mdf=this.Jia=null}}Object(u.a)(c,"AddInCommandsNotificationParameters",null,[])},935:function(u,F,a){u=a(0);var c=a(15),b=a(84),e=a(152),f=a(14),d=a(87);class h extends Sys.UI.Control{constructor(H,D,G,J){super(document.createElement("div"));this.$S=this.YS=this.Xv=this.PG=this.XG=this.Mpa=this.mra=null;this.Pjb=this.Bqa=!1;this.content=this.Yp=null;this.E1=0;
this.txe=null;this.bU=0;this.rIf=null;this.Ole=H;this.$ge=D;this.BP=G;this.SJ=J;this.mg=D.ownerDocument;this.cfc=this.Lt=this.hkb=!1}get nW(){this.mra||(this.mra=this.mg.createElement("div"),this.mra.id=this.li("WACCalloutOuter"),this.mra.className="WACCalloutOuter",this.mra.setAttribute(d.a.Ld,d.a.v_a),this.mra.style.width=this.E1+"px");return this.mra}get eqb(){if(!this.Mpa){this.Mpa=this.mg.createElement("div");this.Mpa.id=this.li("WACCalloutBeakContainer");this.Mpa.className="WACCalloutBeakContainer";
var H="CalloutBeakTopFilled_32x16x32";if(5===this.bU||6===this.bU||4===this.bU)H="CalloutBeakBottomFilled_32x16x32";H=e.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.Mpa.appendChild(H)}return this.Mpa}set eqb(H){this.Mpa=H}get lNa(){return this.hkb}get title(){return this.Yp}set title(H){this.Yp!==H&&(this.Yp=H,this.YS&&(this.YS.innerText=this.Yp))}get Lt(){return this.Bqa}set Lt(H){this.Bqa!==H&&(this.Bqa=H,this.XG&&(this.XG.contains(this.Xv)&&!this.Bqa?this.XG.removeChild(this.Xv):!this.XG.contains(this.Xv)&&
this.Bqa&&this.ape()))}get cfc(){return this.Pjb}set cfc(H){this.Pjb!==H&&(this.Pjb=H,this.XG&&(this.XG.contains(this.YS)&&!this.Pjb?this.XG.removeChild(this.YS):!this.XG.contains(this.YS)&&this.Pjb&&this.tqe()))}show(){this.hkb||(this.wbh(),this.uo(),this.$ge.appendChild(this.nW),this.nW.style.display="Block",this.Nyj(),this.hkb=!0,this.rIf&&this.rIf())}dismiss(){this.hkb&&(this.t2a(),this.$ge.removeChild(this.nW),this.hkb=!1,this.SJ&&this.SJ())}dispose(){this.dismiss();this.YS=this.Xv=this.PG=this.Mpa=
this.XG=this.mra=null;Sys.Component.prototype.dispose.call(this)}li(H){return this.get_element().id+H}wbh(){this.XG=this.mg.createElement("div");this.XG.id=this.li("WACCalloutHeader");this.XG.className="WACCalloutHeader";this.Lt&&this.ape();this.cfc&&this.tqe();this.PG=this.mg.createElement("div");this.PG.id=this.li("WACCalloutContent");this.PG.className="WACCalloutContent";this.PG.style.width=190<this.E1?this.E1-26+"px":"164px";this.PG.appendChild(this.content);this.nW.appendChild(this.eqb);this.nW.appendChild(this.XG);
this.nW.appendChild(this.PG)}ape(){this.Xv=this.mg.createElement("a");this.Xv.className="WACCalloutCloseAnchor";this.Xv.id=this.li("WACCalloutCloseAnchor");this.Xv.href="#";this.XG.appendChild(this.Xv);const H=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Xv.appendChild(H)}tqe(){this.YS=this.mg.createElement("div");this.YS.className="WACCalloutTitle UIFontBold";this.YS.style.width=190<this.E1?this.E1-30+"px":"160px";this.YS.id=
this.li("WACCalloutTitle");this.YS.innerText=this.title;this.XG.contains(this.Xv)?this.XG.insertBefore(this.YS,this.Xv):this.XG.appendChild(this.YS)}Nyj(){var H=this.Ole;let D;if(1===this.bU){var G=this.txe.y+16;D=-16}else 2===this.bU||3===this.bU||0===this.bU?(G=H.y+H.height+15,D=-15):(G=H.y-this.nW.clientHeight-15-2,D=this.nW.clientHeight-1);this.nW.style.top=G+"px";this.eqb.style.top=D+"px";1===this.bU?(H=this.txe.x-16,this.nW.style.left="50%",this.nW.style.marginLeft=-this.E1/2+"px",G=Sys.UI.DomElement.getBounds(this.nW),
this.eqb.style.left=H-G.x+"px"):(G=H.x+this.Ole.width/2,2===this.bU||5===this.bU?(H=20,G-=36):0===this.bU||4===this.bU?(H=this.E1/2-16,G-=this.E1/2):(H=this.E1-20-32,G=G-this.E1+36),this.nW.style.left=G+"px",this.eqb.style.left=H+"px")}uo(){this.Lt&&!this.$S&&(this.$S=Object(b.a)(this,this.N$,"closeHandler"),this.BP.sa(f.a.click,this.Xv,this.$S,null))}t2a(){this.Lt&&this.$S&&(this.BP.Ba(f.a.click,this.Xv,this.$S),this.$S=null)}N$(){this.dismiss();return!0}}Object(u.a)(h,"Callout",Sys.UI.Control,[188]);
class n extends h{constructor(H,D,G,J,M,Q=null){super(H,G,M.yX,Q);this.gfe=0;this.E1=this.oXh(J);this.WYa=D;this.ef=M;this.OPj=7;this.Al=this.WYa.ownerDocument.createElement("div");this.Al.className="ModalCalloutControlOverlay";this.Al.tabIndex=0;this.WYa.insertBefore(this.Al,this.WYa.firstChild)}show(){this.lNa||(this.ef.xsc(),this.ef.XP(!1),this.Al.style.zIndex=String(this.ef.G2),super.show(),this.Nj(),this.gfe=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.OPj))}dismiss(){this.lNa&&
(this.ef.bN(!1),this.gk(),this.WYa&&this.WYa.contains(this.Al)&&this.WYa.removeChild(this.Al),super.dismiss(),window.clearTimeout(this.gfe))}Nj(){this.ef.qsa(Object(b.a)(this,this.dismiss,"dismiss"));this.ef.Uy.sa(f.a.click,this.Al,Object(b.a)(this,this.gd,"onClick"))}gk(){this.ef.Jcb(Object(b.a)(this,this.dismiss,"dismiss"));this.ef.Uy.Ba(f.a.click,this.Al,Object(b.a)(this,this.gd,"onClick"))}gd(){this.dismiss();return!0}oXh(H){let D=0;switch(H){case 0:D=190;break;case 1:D=250;break;case 2:D=300;
break;case 3:D=360}return D}}Object(u.a)(n,"ModalCallout",h,[]);var m=a(463),x=a(173);class r extends n{constructor(H,D,G,J,M,Q=null){super(H,D,G,J,M,Q);this.rWb=null}show(){if(!this.lNa){const H=Object.assign(new m.a,{onShow:()=>{n.prototype.show.call(this)}});x.UISurfaces.NH().then(D=>{const G=D.externalNotification();this.rWb=D.addNotification(G,H);return null},D=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})}}dismiss(){this.lNa&&this.rWb&&(x.UISurfaces.NH().then(H=>
{H.removeNotification(this.rWb);return this.rWb=null},H=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(u.a)(r,"ReactManagedModalCallout",n,[]);var y=a(4);class t{static jdh(H,D,G){return y.AFrameworkApplication.ta.Pa.iR?new r(H,D,G,3,y.AFrameworkApplication.ta,null):new n(H,D,G,3,y.AFrameworkApplication.ta,null)}}Object(u.a)(t,"ModalCalloutControlFactory",null,[]);var v=a(54),w=a(861),C=a(582),B=a(862),z=a(134),A=a(56),E=a(39),
I=a(82),L=a(815),V=a(695);a.d(F,"a",function(){return T});class T{static get C1b(){return T.ofa||(T.ofa=I.a.instance.Lh("Common.Utils.IAriaNotifier"))}static hHe(H,D,G,J){T.wJ&&T.wJ.lNa&&T.wJ.dismiss();T.wJ=t.jdh(D,H,H);T.wJ.content=G;V.b(J)||(T.wJ.title=J,T.wJ.cfc=!0);H=new Sys.UI.Bounds(0,0,A.a.bec(),A.a.aec());T.wJ.bU=T.dPh(H,D,T.wJ.E1);T.wJ.show();T.C1b&&T.C1b.sendNotification(G.innerText,!0)}static w5c(H,D,G,J=null){x.UISurfaces.NH().then(M=>{let Q=null;T.amb&&(M.removeNotification(T.amb),T.amb=
null);const U=M.callout(Object.assign(new w.a,{target:H,title:D,content:G,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new B.a,{onDismiss:()=>{M.removeNotification(Q)},directionalHint:null!=J?J:null})})),Z=Object.assign(new m.a,{expirationOptions:Object.assign(new C.a,{displayTimeoutSeconds:7,onExpire:()=>{M.removeNotification(T.amb)}})});Q=T.amb=M.addNotification(U,Z);return null},M=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
M);return null})}static RUd(H,D=null){T.wJ&&T.wJ.lNa&&T.wJ.dismiss();const G=new z.StandardDialog;G.BTa=!1;G.Rb=0;G.gA(v.a.pwi,CommonUIStrings.l_DialogError,V.b(H)?T.a2e():H,D)}static TUd(H){T.wJ&&T.wJ.lNa&&T.wJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",H.errorCode));const D=V.b(H.description)?T.a2e():H.description,G=new z.StandardDialog;let J=null;H.Iha?(G.Rb=1,G.pc(1,H.buttonText),G.T0(1)):G.Rb=0;J=M=>{1===M?H.Iha():H.Jia&&H.Jia()};
G.BTa=!1;0===H.HMa?G.gA(H.errorCode,H.title?H.title:CommonUIStrings.l_DialogError,D,J):1===H.HMa?G.sX(H.title?H.title:CommonUIStrings.l_DialogWarning,D,J):G.zBa(H.title?H.title:CommonUIStrings.l_DialogInfo,D,J)}static dPh(H,D,G){let J=4;const M=H.x+H.width-D.x-D.width;D.x-H.x+D.width/2<=G/2?J=5:M+D.width/2<=G/2&&(J=6);return J}static UEj(H,D,G,J=!1){(D=L.a.m4a(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,M=>{M&&(J||T.w5c(M,
G,H,5))})}static VEj(H,D,G=!1){T.UEj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,H),D,D.startedNode?D.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,H),G)}static TEj(H,D,G,J){if(T.fkg)H=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,G,J,CommonUIStrings.l_InsertionDialogRefresh)),T.w5c(D,H,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=
E.a.vp(D);var M=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Q=document.createElement("span");Q.innerText=M[0];var U=document.createElement("span");U.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,G,J,CommonUIStrings.l_InsertionDialogRefresh);U.className="UIFontBold";G=document.createElement("span");G.innerText=M[1];J=document.createElement("div");Sys.UI.DomElement.addCssClass(J,"ModalCalloutControl");J.appendChild(Q);J.appendChild(U);J.appendChild(G);
T.hHe(H,D,J,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static mGj(H,D){var G=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,J=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;T.fkg?T.w5c(D,G,J):(D=E.a.vp(D),T.hHe(H,D,T.vYg(J),G))}static vYg(H){const D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=H;return D}static a2e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get fkg(){return y.AFrameworkApplication.ta.Pa.Pi&&
y.AFrameworkApplication.ta.Pa.iR}}T.wJ=null;T.amb=null;T.ofa=null;Object(u.a)(T,"AddInCommandsNotificationFactory",null,[])},945:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(1464),e=a(147),f=a(120),d=a(720),h=a(733),n=a(347);class m{constructor(v,w,C,B){this.zA=!1;this._id=v;this.yx=w;this.W1=C;this.Hd=B}get enabled(){return this.zA}set enabled(v){const {DynamicRibbon:w}=a(945);var C=this.Hd.OwnerAddinStoreType;const B=this.Hd.PrimaryMarketplace.MarketplaceRef,z=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:
null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,C,null,null,null,B);C={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,C,z,null,null,B),["ownerAddinStoreType"]:C,["ribbonControlType"]:"Button",["toggle"]:v};e.a.sendTelemetryEvent(Object.assign(new n.a,{name:w.RBc+"ControlUpdate",dataFields:f.a.Zj(C)}));this.zA=v;this.W1.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.yx,["PrivacyCompliantSolutionId"]:A,
["SourceControlId"]:this.id,["MethodData"]:this.zA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(v){switch(v){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v,
w){switch(v){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertySetAsync(v,w){this.invokePropertySet(v,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v,w){switch(v){case 5:return this.vvj(w);case 1:return this.eDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,w){v=this.invokeMethod(v,
w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}vvj(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setEnabled(v);return null}eDa(){this._OnAccess();return null}}Object(u.a)(m,"RibbonButton",null,[]);class x{constructor(v,w,C,B){this._id=v;this.yx=w;this.W1=C;this.Hd=B}get id(){return this._id}setVisibility(v){const {DynamicRibbon:w}=a(945),C=this.Hd.OwnerAddinStoreType;var B=this.Hd.PrimaryMarketplace.MarketplaceRef;const z=this.Hd.AssetMarketplace?
this.Hd.AssetMarketplace.SolutionId:null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,C,z,null,null,B);B={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,C,z,null,null,B),["ownerAddinStoreType"]:C,["ribbonControlType"]:"Tab",["toggle"]:v};e.a.sendTelemetryEvent(Object.assign(new n.a,{name:w.RBc+"ControlUpdate",dataFields:f.a.Zj(B)}));this.W1.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.yx,
["PrivacyCompliantSolutionId"]:A,["StoreType"]:C,["SourceControlId"]:this.id,["MethodData"]:v})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(v){switch(v){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
}invokePropertySetAsync(v,w){this.invokePropertySet(v,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v,w){switch(v){case 3:return this.qzj(w);case 1:return this.eDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,w){v=this.invokeMethod(v,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}qzj(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setVisibility(v);
return null}eDa(){this._OnAccess();return null}}Object(u.a)(x,"RibbonTab",null,[]);var r=a(968),y=a(186);a.d(F,"DynamicRibbon",function(){return t});class t{constructor(v,w,C,B,z){this.yx=v;this.qJ=C;this.W1=B;this.Hd=z;this.uib=this.qJ.Yh;this.az=this.uib.getOsfControl(w);this.bzg=this.az.getManifest()}get buttons(){return null}executeRequestCreate(v){try{var w=this.Hd.OwnerAddinStoreType;const B=this.Hd.PrimaryMarketplace.MarketplaceRef,z=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:
null;var C=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,w,z,null,null,B);const A={["addinSolutionId"]:C,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,w,z,null,null,B),["ownerAddinStoreType"]:this.Hd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new n.a,{name:t.RBc+"ExecuteRequestCreate",dataFields:f.a.Zj(A)}));const E=y.a.ki(v);v={};w={};w[d.a.EJa]=this.az;w[d.a.FJa]=E;w[d.a.A9c]=this.Hd;v[d.a.qub]=
3;v[d.a.h4]=this.yx;v[d.a.f9b]=C;v[d.a.g4]=w;this.W1.CK(-1014260128,v);let I=t.Abc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,I)}catch(B){C=t.Abc("ExecuteRequestCreate",!1,B.toString()),c.ULS.sendTraceTag(538572825,0,50,C)}return null}executeRequestUpdate(v){try{var w=this.Hd.OwnerAddinStoreType;const B=this.Hd.PrimaryMarketplace.MarketplaceRef,z=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null;var C=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yx,w,z,null,
null,B);const A={["addinSolutionId"]:C,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,w,z,null,null,B),["ownerAddinStoreType"]:this.Hd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new n.a,{name:t.RBc+"ExecuteRequestUpdate",dataFields:f.a.Zj(A)}));const E=y.a.ki(v);v={};w={};w[d.a.EJa]=this.az;w[d.a.FJa]=E;w[d.a.A9c]=this.Hd;v[d.a.qub]=3;v[d.a.h4]=this.yx;v[d.a.f9b]=C;v[d.a.g4]=w;this.W1.CK(-1014260128,
v);let I=t.Abc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,I)}catch(B){C=t.Abc("ExecuteRequestUpdate",!1,B.toString()),c.ULS.sendTraceTag(538572823,0,50,C)}return null}getButton(v){let w=null;if(!this.Qhf())return this.jHe();if(v&&0<v.length){if(!this.pCe(v))return this.CHe(v);w=new m(v,this.yx,this.W1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)}getTab(v){let w=null;if(!this.Qhf())return this.jHe();if(this.az.getOwnerAddinControlRecreated())return this.wch();
if(v&&0<v.length){if(!this.pCe(v))return this.CHe(v);w=new x(v,this.yx,this.W1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(v){switch(v){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
}invokePropertySetAsync(v,w){this.invokePropertySet(v,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v){switch(v){case 1:return this.eDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,w){switch(v){case 7:return this.WCh(w);case 6:return this.XCh(w);case 3:return this.JOh(w);case 5:return this.R2h(w)}v=this.invokeMethod(v,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}WCh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,"string");return this.executeRequestCreate(v)}XCh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestUpdate(v)}JOh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getButton(v)}R2h(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getTab(v)}eDa(){this._OnAccess();return null}CHe(v){return r.a(h.a.W8g,y.a.ga(1762)+v)}jHe(){return r.a(h.a.vnj,y.a.ga(1758))}wch(){return r.a(h.a.hostRestartNeeded,
y.a.ga(1763))}Qhf(){var v=this.az.getSharedRuntimeId();v=!!v&&0<v.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",v));return v}pCe(v){const w=this.bzg.getRibbonExtensionControlMap();return v in w||this.h2g(v)}h2g(v){var w=this.rGh();if(w){w=w.kOe;for(const C of w.tabs){if(C.id===v)return!0;for(const B of C.groups)for(const z of B.controls){if(z.id===v)return!0;if("Menu"===z.type){w=z;for(const A of w.items)if(A.id===v)return!0}}}}return!1}rGh(){return b.a.getInstance().kja(this.Hd.PrimaryMarketplace.MarketplaceType,
this.Hd.PrimaryMarketplace.SolutionId,1)}static Abc(v,w,C){const B={};B.methodName="DynamicRibbon."+v;B.result=w?"Succeeded":"Failed";B.message=C;return y.a.hc(B)}}t.RBc="Office.Online.Extensibility.Ribbon.";Object(u.a)(t,"DynamicRibbon",null,[])},955:function(u,F,a){a.d(F,"a",function(){return b});var c=a(956);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},962:function(u,F,a){a.d(F,"a",function(){return c});
const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},963:function(u,F,a){a.d(F,"a",function(){return c});u=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.vha=this.EUa=this.ehd=this.Hjd=this.ayb=this.NYd=null}}Object(u.a)(c,"AppsForOfficeOauthResult",null,[])},968:function(u,F,a){a.d(F,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/dd78884b319addf762b3f036cdcd5b64/EwaDSEsNext.agave.js.map