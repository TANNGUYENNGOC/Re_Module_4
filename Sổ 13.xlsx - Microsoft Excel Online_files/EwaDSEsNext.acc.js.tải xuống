'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1123:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1124:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1125:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-svg-icon{height:100%;width:100%}")}},1126:function(u,F,a){function c(m,x){this.ID=m;this.type=x}function b(m,x){this.value=m;this.contextId=x}function e(m,x,r,y,t,v,w,C){this.type=m;this.startTime=null==r||void 0==r.value?new b(r,null):r;this.endTime=null==y||void 0==y.value?new b(y,null):y;null!=t&&void 0!=t.value||new b(t,null);null!=v&&void 0!=v.value||new b(v,null);this.operationType=C}function f(m){this.ID=
m}function d(){this.Qe=[];this.apb=[];this.wYc=0;this.duration=this.startTime=null;this.m9b={};this.Xyd=this.Czd=this.WZc=-1}function h(m){var x;return(null!=document.body.style.msTransform?x=m.style.msTransform:null!=document.body.style.webkitTransform?x=m.style.webkitTransform:null!=document.body.style.mozTransform?x=m.style.H5j:null!=document.body.style.oTransform?x=m.style.J5j:null!=document.body.style.transform&&(x=m.style.transform),x)?(x=x.replace("rotate(",""),x=x.replace("deg)",""),parseFloat(x)):
0}a.d(F,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),W5j:new b(0,null),m5j:new b(0,null),operationType:0};u=Array(1);u[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,u[0],null,0,1,1),new e(7,2,0,u[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(m,16)}}();d.prototype={Qe:null,bQg:5,apb:null,wYc:0,startTime:null,
duration:null,m9b:null,WZc:-1,Czd:-1,Xyd:-1};d.prototype.Start=function(){this.startTime=new Date;this.m9b={}};d.prototype.GetRecentAnimationStats=function(){var m,x=[],r=0;for(m=n.wYc;m<n.bQg;m++)null!=n.apb[m]&&(x[r]=n.apb[m],r++);for(m=0;m<n.wYc;m++)null!=n.apb[m]&&(x[r]=n.apb[m],r++);return x};d.prototype.GetAnimationSqmStats=function(){var m=[];return m[0]=0>n.WZc?0:n.WZc,m[1]=0>n.Czd?0:n.Czd,m[2]=0>n.Xyd?0:n.Xyd,m};var n=new d},1127:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);
const b=()=>{c.a.Ni(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1141:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(38);class f extends e.a{constructor(na){super();na.da.Ga(376,this)}NNg(na){this.addHandler("TAF",na)}Jij(na){this.removeHandler("TAF",na)}X8i(){this.raiseEvent("TAF")}}Object(u.a)(f,"GridHighlightBehaviorEventManager",e.a,[328,2]);class d extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){this.nb(this.$.da.Aa(376)||new f(this.$))}static la(na){na.da.Ga(377,new d(na))}}Object(u.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,
[]);var h=a(49),n=a(37),m=a(27),x=a(78),r=a(15),y=a(239),t=a(14),v=a(156),w=a(5),C=a(113),B=a(12);class z extends Sys.EventArgs{constructor(na,ib){super();this.start=na;this.C6a=ib}}Object(u.a)(z,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var A=a(33);class E extends e.a{constructor(na){super();this.Nmc=[3];this.Aqa=void 0;this.gridView=na;this.YCc=A.a.hR(this.gridView.$);this.wB=A.a.wB(this.gridView.$)}get coloredReferencesManager(){const na=this.gridView.$.da.Aa(281);na||r.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return na}get lB(){if(this.Aqa)return this.Aqa;const na=this.gridView.$.da.Aa(464);na||r.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
na.lB||r.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Aqa=na.lB}pMg(na){this.addHandler("mrek",na)}dx(na,ib,Ib){for(const ec of this.gridView.Mn)y.a.instance.sa(t.a.Kj,ec.domElement,na);y.a.instance.sa(t.a.Sf,document.documentElement,ib);this.gridView.fc.t9b(!0);Ib&&y.a.instance.sa(t.a.Fy,this.gridView.zj,ib)}u0d(na,ib,Ib){for(const ec of this.gridView.Mn)y.a.instance.Ba(t.a.Kj,ec.domElement,na);y.a.instance.Ba(t.a.Sf,
document.documentElement,ib);this.gridView.fc.t9b(!1);Ib&&y.a.instance.Ba(t.a.Fy,this.gridView.zj,ib)}Pcj(na,ib){for(const Ib of this.gridView.Mn)v.a.instance.sa(t.a.$f,Ib.domElement,na);v.a.instance.sa(t.a.xe,document.documentElement,ib)}hVj(na,ib){for(const Ib of this.gridView.Mn)v.a.instance.Ba(t.a.$f,Ib.domElement,na);v.a.instance.Ba(t.a.xe,document.documentElement,ib)}IHe(na,ib,Ib,ec){const qb=document.createElement("div");qb.className=ib;for(const Ha of Ib)qb.classList.add(Ha);na.appendChild(qb);
y.a.instance.sa(t.a.pointerDown,qb,ec);return qb}X6e(na){na=na.Gb.parentNode;if(!na)return r.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;na=parseInt(na.getAttribute(w.a.C6a),10);return isNaN(na)?(r.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.Cv(3,1,na)}RMb(na,ib,Ib=!0){na=Ib&&(this.wB?!!this.lB&&
this.lB.Joi(na):!!this.coloredReferencesManager&&this.coloredReferencesManager.Ioi(na));for(const ec of ib)B.DOMElementExtensions.setVisible(ec,na)}Dbc(){return this.gridView.Ul?C.a(this.gridView.$):this.gridView.Vb}TRf(){if(this.wB){var na=this.Dbc();na&&this.lB?this.YCc?na.bC(null):this.lB.lgb(na,null):(r.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Zg(this.Nmc),this.gridView.qb.Ti(null,
this.Nmc))}else this.Aaj()}Aaj(){const na=this.Dbc();na&&this.coloredReferencesManager?this.YCc?na.bC(null):this.coloredReferencesManager.bC(na,null):(r.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Zg(this.Nmc),this.gridView.qb.Ti(null,this.Nmc))}dQf(na,ib){this.raiseEvent("mrek",new z(na,ib))}}Object(u.a)(E,"BehaviorHelperMethods",e.a,[]);var I=a(89),L=a(39);e=a(95);
class V extends e.a{constructor(na,ib=null){super(na,ib)}WZa(){}}Object(u.a)(V,"HighlightFlyweightBehavior",e.a,[]);var T=a(19),H=a(464),D=a(76),G=a(11),J=a(117),M=a(224),Q=a(45);e=a(238);var U=a(8),Z=a(69),P=a(1),S=a(34);class ja extends e.a{constructor(na,ib,Ib){super(document.createElement("div"));this.X6b=null;this.vRb=!1;this.onPointerDown=ec=>{ec=S.a(this.$)?S.a(this.$).Vd(ec):ec;this.vRb=!1;if(3===(D.a.Db=ec.tb)){const qb=ec.Ca.rawEvent,Ha=qb.srcElement||qb.target;B.DOMElementExtensions.Af(this.domElement,
Ha)&&B.DOMElementExtensions.Af(qb.currentTarget,Ha)&&(this.vRb=!0,this.X6b=ec.clientPoint)}return!1};this.Rf=ec=>{ec=S.a(this.$)?S.a(this.$).Vd(ec):ec;this.raiseEvent("GrPointerUp",ec);return this.vRb=!1};this.Hh=ec=>{ec=S.a(this.$)?S.a(this.$).Vd(ec):ec;3===ec.tb&&this.vRb&&this.s$h(ec.clientPoint)&&(this.raiseEvent("GrDrag"),this.vRb=!1);return!1};this.gd=ec=>{S.a(this.$)&&S.a(this.$).Vd(ec);return!0};this.$=Ib;Ib=!P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(Ib?
Z.a.fVe:Z.a.eVe);this.domElement.classList.add(Z.a.y$b);na.appendChild(this.domElement);B.DOMElementExtensions.setVisible(this.domElement,!1);this.SLa=document.createElement("div");this.SLa.classList.add(Z.a.x$b);this.SLa.style.borderColor=ib;this.domElement.appendChild(this.SLa);y.a.instance.sa(t.a.pointerDown,this.domElement,this.onPointerDown);y.a.instance.sa(t.a.Sf,this.domElement,this.Rf);v.a.instance.sa(t.a.xe,this.domElement,this.Rf);y.a.instance.sa(t.a.Kj,this.domElement,this.Hh);v.a.instance.sa(t.a.$f,
this.domElement,this.Hh);M.a.instance.sa(t.a.click,this.domElement,this.gd)}qre(na){this.addHandler("GrDrag",na)}DVf(na){this.removeHandler("GrDrag",na)}ore(na){this.addHandler("GrContxt",na)}CVf(na){this.removeHandler("GrContxt",na)}rre(na){this.addHandler("GrPointerUp",na)}EVf(na){this.removeHandler("GrPointerUp",na)}dispose(){Q.a.nna(this.domElement);super.dispose()}ajg(na){this.domElement.parentNode.removeChild(this.domElement);na.appendChild(this.domElement)}L2f(){this.domElement.classList.remove(Z.a.y$b);
this.SLa.classList.remove(Z.a.x$b);this.SLa.classList.add(Z.a.gVe)}ohg(){this.SLa.classList.remove(Z.a.gVe);this.SLa.classList.add(Z.a.x$b);this.domElement.classList.add(Z.a.y$b)}s$h(na){return!!this.X6b&&(3<Math.abs(na.x-this.X6b.x)||3<Math.abs(na.y-this.X6b.y))}static Kwb(na){return P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(na=S.a(na.$)?S.a(na.$).zoom:U.a.f0,Math.round(9/Math.max(na,1))):9}}ja.Gyd=0;Object(u.a)(ja,"TouchGrippie",e.a,[]);class X extends V{constructor(na,
ib,Ib,ec){super(ib);this.Ttd=this.WYc=this.qpb=!1;this.Oqb=null;this.Nba=this.Otd=!1;this.Vw=()=>{this.qpb&&this.Otd?this.roa():this.b5()};this.yDf=Ha=>{3===Ha.tb&&(this.Otd=!0,this.roa());return!1};this.zDf=Ha=>{if(3===Ha.tb){if(!Ha.Gb||this.vmi(Ha))return!1;this.Otd=!1;this.b5()}return!1};this.Dg=()=>{this.Nba&&this.y0d();this.roa();this.Ttd=!1};this.Np=()=>{this.b5();this.Ttd=!0};this.rza=(Ha,Ab)=>{Ab.e5===this.e5&&(Ab.visible?this.Ttd||this.roa():this.b5())};this.kJf=()=>{this.ADf(this.fP.domElement,
!1)};this.Mzf=()=>{this.ADf(this.JM.domElement,!0)};this.upc=(Ha,Ab)=>{this.ha.dAa(Ab)};this.vpc=(Ha,Ab)=>{this.ha.dAa(H.b(Ab))};this.sGb=()=>{3===D.a.Db?this.roa():this.b5();this.Nba&&1===D.a.Db&&this.y0d()};this.lJf=()=>{this.juj()};this.oOe=()=>{this.b5()};this.Ln=()=>{this.ha.Sa.$b&&this.b5()};this.Azf=()=>{this.b5()};this.rDf=(Ha,Ab)=>{this.y0d();3===Ab.tb?this.roa():this.b5()};this.ttc=()=>{this.qpb&&(this.b5(),this.roa())};const qb=Ib.$;this.yq=Ib;this.ha=Ib.ha;this.rba=na;this.Krj=ib;this.paneType=
ec;na=this.domElement.currentStyle;ib="#000000";na&&(ib=na.borderTopColor);this.fP=new ja(this.Ocd(),ib,qb);this.JM=new ja(this.Ocd(),ib,qb);this.pkf=qb.ea.isNamedObjectViewMode&&1===qb.workbookContext.NovMode;this.fP.qre(this.kJf);this.fP.ore(this.upc);this.fP.rre(this.vpc);this.JM.qre(this.Mzf);this.JM.ore(this.upc);this.JM.rre(this.vpc);for(const Ha of this.gridView.Mn)v.a.instance.sa(t.a.vf,Ha.domElement,this.zDf),v.a.instance.sa(t.a.xe,Ha.domElement,this.yDf);Ib.view.ot(this.Vw);Ib.Vb.Yk(this.oOe);
Ib.qb.Gob(this.rza);Ib.YWc(this.Azf);qb.QA(this.ttc);Ib.lv(this.ttc);this.ha.KY(this.Dg);this.ha.V2(this.Np);Ib.FC(this.Ln);this.ha.W_b(this.rDf);D.a.Are(this.sGb);n.TaskExtensions.za(h.GetServiceTaskFactory.Oa(qb.da,376,377,0),Ha=>{Ha.result.NNg(this.lJf)},qb.ka,3)}get gridView(){return this.yq}dispose(){I.a.rc([this.fP,this.JM]);this.fP.DVf(this.kJf);this.fP.CVf(this.upc);this.fP.EVf(this.vpc);this.JM.DVf(this.Mzf);this.JM.CVf(this.upc);this.JM.EVf(this.vpc);for(var na of this.gridView.Mn)v.a.instance.Ba(t.a.vf,
na.domElement,this.zDf),v.a.instance.Ba(t.a.xe,na.domElement,this.yDf);this.gridView.view.er(this.Vw);this.gridView.Vb.Gk(this.oOe);this.gridView.qb.qKb(this.rza);this.gridView.bMd(this.Azf);this.gridView.$.aE(this.ttc);this.gridView.Ky(this.ttc);this.ha.RW(this.Dg);this.ha.t7(this.Np);this.gridView.bE(this.Ln);this.ha.Guc(this.rDf);D.a.MVf(this.sGb);this.Nba&&r.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(na=this.gridView.$.da.Aa(376))&&na.Jij(this.lJf);
super.dispose()}mTa(){if(!this.rba.range||!this.rba.range.equals(this.Ddb))return!1;const na=!this.gridView.BNa();return this.gridView.eb&&na&&(this.Ddb.isRow||this.Ddb.hf)?!1:this.Nba?!0:3===D.a.Db}b5(){this.qpb&&(this.fP.set_visible(!1),this.JM.set_visible(!1),this.qpb=!1)}roa(){if(this.mTa()){this.PYj();var na=B.DOMElementExtensions.getBoundingClientRect(this.Oqb);na||r.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.pkf,this.WYc,this.gridView.zj,this.gridView.ib.tj);var ib=B.DOMElementExtensions.getBoundingClientRect(this.Krj),Ib=new Sys.UI.Bounds(ib.x-na.x,ib.y-na.y,ib.width,ib.height),ec=this.Ddb,qb=ec.topLeft,Ha=ec.bottomRight,Ab=ec.isRow||ec.hf;if(ec.hf){var Yb=this.bGh();ec=Ib.x-2*ja.Kwb(this.gridView);var Bb=Yb;var Qb=Ib.x+ib.width}else ec.isRow?(ec=Qb=this.aGh(),Bb=Ib.y-2*ja.Kwb(this.gridView),Yb=Ib.y+ib.height):(Bb=Ib.y,Yb=Ib.y+ib.height,this.gridView.rtl?
(ec=Ib.x+ib.width,Qb=Ib.x):(ec=Ib.x,Qb=Ib.x+ib.width));ib=ja.Gyd+(Ab?0:ja.Kwb(this.gridView));this.fP.style.left=G.HelperMethods.uc(ec-ib);this.fP.style.top=G.HelperMethods.uc(Bb-ib);this.JM.style.left=G.HelperMethods.uc(Qb-ib);this.JM.style.top=G.HelperMethods.uc(Yb-ib);this.fP.set_visible(this.Nif(Bb,ec,qb,Ab,na));this.JM.set_visible(this.Nif(Yb,Qb,Ha,Ab,na));this.qpb=!0}}Nif(na,ib,Ib,ec,qb){const Ha=B.DOMElementExtensions.getBoundingClientRect(this.gridView.Df(this.paneType).domElement);qb=new Sys.UI.Bounds(Ha.x-
qb.x-3,Ha.y-qb.y-3,Ha.width+6,Ha.height+6);return(this.gridView.ib.Mi(Ib)===this.paneType||ec)&&L.a.EN(qb,new Sys.UI.Point(ib,na))}PYj(){if(this.pkf!==this.WYc){this.Oqb=null;const na=this.Ocd();this.fP.ajg(na);this.JM.ajg(na)}}bGh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+ja.Gyd-ja.Kwb(this.gridView))/2}aGh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+ja.Gyd-ja.Kwb(this.gridView))/2}yHf(){this.roa()}vmi(na){return B.DOMElementExtensions.cSa(na.Gb,
T.a.Ao)&&(this.yni(na)||this.zni(na))}zni(na){if(this.gridView.rtl)na=na.clientPoint.x;else{const ib=B.DOMElementExtensions.getBoundingClientRect(na.Gb);na=na.clientPoint.x-(ib.x+ib.width-J.a.Ou)}return 0<na&&na<=J.a.Ou}yni(na){const ib=B.DOMElementExtensions.getBoundingClientRect(na.Gb);na=na.clientPoint.y-(ib.y+ib.height-J.a.Ou);return 0<na&&na<=J.a.Ou}ADf(na,ib){this.Nba&&r.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.o1c(na,ib,this.Nba);
this.b5()}juj(){this.Nba||(r.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Nba=!0,this.fP.L2f(),this.JM.L2f(),this.gridView.ha.sourceRange=this.gridView.ha.ra.dd,this.roa())}y0d(){this.Nba&&(r.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Nba=!1,this.fP.ohg(),this.JM.ohg())}Ocd(){this.Oqb||(this.WYc=!1,this.Oqb=this.gridView.zj);return this.Oqb}}Object(u.a)(X,"SelectionTouchGrippiesBehaviorBase",V,[]);class Y extends X{constructor(na,
ib,Ib,ec){super(na,ib,Ib,ec)}get e5(){return 19}get Ddb(){return this.gridView.ha.ra.activeRange}mTa(){const na=this.gridView.ri||this.gridView.eb;return!this.gridView.ha.ra.Pg&&!na&&super.mTa()}}Object(u.a)(Y,"DiscontinuousSelectionTouchGrippiesBehavior",X,[]);var va=a(174);class N extends V{constructor(na){super(na);const ib=document.createElement("div");ib.className=Z.a.vBh;na.appendChild(ib)}}Object(u.a)(N,"SelectionBorderBehavior",V,[]);class ea{}ea.aBh="ewr-selection-draghandle";ea.fBh="ewr-selection-draghandle-grab";
ea.qBh="ewr-selection-draghandle-top-ie";ea.rBh="ewr-selection-draghandle-top-ie-enhanced";ea.oBh="ewr-selection-draghandle-top";ea.pBh="ewr-selection-draghandle-top-enhanced";ea.dBh="ewr-selection-draghandle-bottom-ie";ea.eBh="ewr-selection-draghandle-bottom-ie-enhanced";ea.bBh="ewr-selection-draghandle-bottom";ea.cBh="ewr-selection-draghandle-bottom-enhanced";ea.iBh="ewr-selection-draghandle-left-ie";ea.jBh="ewr-selection-draghandle-left-ie-enhanced";ea.gBh="ewr-selection-draghandle-left";ea.hBh=
"ewr-selection-draghandle-left-enhanced";ea.mBh="ewr-selection-draghandle-right-ie";ea.nBh="ewr-selection-draghandle-right-ie-enhanced";ea.kBh="ewr-selection-draghandle-right";ea.lBh="ewr-selection-draghandle-right-enhanced";ea.nVe="ewr-selection-dragtooltip";ea.oVe="ewr-selection-dragtooltip-updated";ea.CBh="ewr_selection_rearrangeleft";ea.DBh="ewr_selection_rearrangeright";ea.EBh="ewr_selection_rearrangetop";ea.BBh="ewr_selection_rearrangebottom";ea.selecting="selecting";ea.FBh="ewr-selection-resizemarqueehandle";
ea.IBh="ewr-selection-resizemarqueehandle-topleft";ea.JBh="ewr-selection-resizemarqueehandle-topright";ea.GBh="ewr-selection-resizemarqueehandle-bottomleft";ea.HBh="ewr-selection-resizemarqueehandle-bottomright";ea.RAh="ewr-marquee-thick";ea.VAh="ewr-resizemarqueehandle-thick";Object(u.a)(ea,"CssClassNames",null,[]);var Ca=a(249),la=a(21);class Ra extends N{constructor(na,ib,Ib,ec){super(na);this.ZTa=!1;this.joe=this.koe=null;this.csa=0;this.$h=P.EwaSettings.getBooleanFeatureGate(va.a.U8b,!1);this.Tli=
P.EwaSettings.getBooleanFeatureGate(va.a.soh,!1);this.WEc=this.Mfc=this.gF=0;this.Xw=this.hb=this.sourceRange=this.dna=null;this.Rf=qb=>{qb=S.a(this.$).Vd(qb);return this.mEd(qb)};this.onPointerDown=qb=>{qb=S.a(this.$).Vd(qb);if(2===qb.tb&&qb.ho===Sys.UI.MouseButton.leftButton&&!this.ZTa){var Ha=this.Hdc(qb);if(!Ha)return r.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.hb=Ha.clone();this.sourceRange=this.hb.clone();this.dna=this.hb;
if(Ha=this.AXh(qb))this.nh=5,this.WEc=Ha.top-this.sourceRange.top,this.Mfc=Ha.left-this.sourceRange.left,la.h(this.$).yf.gm(this.$h?Ra.DJa:Ra.l9c),this.eqc(qb),this.ZTa=!0,Ca.b(this.$,!0)}return!1};this.Hh=qb=>{qb=S.a(this.$).Vd(qb);if(this.$h&&this.hqc(qb))return!0;if(qb=this.ha.io(qb.clientPoint,qb.Gb,5,void 0,void 0,!0)){qb=this.Pha(qb);if(this.hb.equals(qb))return!0;this.hb=qb;if(!this.Xy())return r.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.qvb(!0),!1}return!0};this.ed=(qb,Ha)=>{Ha.IN||(P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.fBa(this.$.isEditMode&&this.ooa()):this.fBa(this.$.isEditMode))};this.ms=[];this.$=ib;this.ha=la.h(this.$).ha;this.paneType=Ib;this.vo=ec;ib=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ib=this.Tli?ib?[ea.pBh,ea.cBh,ea.hBh,ea.lBh]:[ea.rBh,ea.eBh,ea.jBh,ea.nBh]:ib?[ea.oBh,ea.bBh,ea.gBh,ea.kBh]:[ea.qBh,ea.dBh,ea.iBh,ea.mBh];for(const qb of ib)ib=
this.vo.IHe(na,qb,this.$h?[ea.fBh]:[ea.aBh],this.onPointerDown),this.ms.push(ib);this.$.ll(this.ed);P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.fBa(this.$.isEditMode)}get qb(){return la.h(this.$).qb}get nh(){return this.ha.selectionType}set nh(na){this.ha.selectionType=na}dispose(){this.ms.forEach(na=>{y.a.instance.Ba(t.a.pointerDown,na,this.onPointerDown)});this.ms.length=0;this.dna=this.sourceRange=this.hb=null;r.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.csa}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.Kl(this.ed),1===this.csa&&(r.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.yt(this.joe,this.koe,!1)));super.dispose()}mEd(na){if(5!==this.nh)return!1;(na=this.pza(na))||this.qvb(!1);Ca.b(this.$,!1);return na}dx(na,ib){r.ULS.shipAssertTag(537159377,0,!this.csa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.csa+=1;this.joe=na;this.koe=ib;this.vo.dx(na,
ib,this.JCc())}Pha(na){if(!na||!this.hb)return r.ULS.shipAssertTag(537159376,0,!!na,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),r.ULS.shipAssertTag(537159375,0,!!this.hb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ib=this.hb.clone();1!==this.gF&&(ib.left=Math.max(na.left-this.Mfc,1),ib.right=ib.left+this.sourceRange.width-1);2!==this.gF&&(ib.top=Math.max(na.top-this.WEc,1),ib.bottom=ib.top+this.sourceRange.height-1);return this.XZa(ib)}yt(na,
ib,Ib=!0,ec=!0){r.ULS.shipAssertTag(537159374,0,1===this.csa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.csa;this.$h||la.h(this.$).yf.gm(w.a.SQ);this.vo.u0d(na,ib,this.JCc());Ib&&this.r2c(ec);this.gF=0;this.ZTa=!1}XZa(na){var ib=la.h(this.$);let Ib=na;if(ib.ib.X4){if(!ib.Sb(na.topLeft)){ib=ib.jk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ib.HH,this.dna.top!==na.top?1:2);try{ib.Rk=this.dna.top<na.top||this.dna.left<na.left,ib.Is(na.topLeft),
Ib=ib.$$cu().range}finally{ib&&ib.dispose()}}Ib.right=Ib.left+na.width-1;Ib.bottom=Ib.top+na.height-1}return this.dna=Ib}fBa(na){this.ms.forEach(ib=>{B.DOMElementExtensions.setVisible(ib,na)})}AXh(na){const ib=na.Gb;na=na.clientPoint;if(!ib||!na)return r.ULS.shipAssertTag(537159373,0,!!ib,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),r.ULS.shipAssertTag(537159372,0,!!na,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;na.y+=ib===this.ms[Ra.CJa]?
2:ib===this.ms[Ra.o9c]?-2:0;na.x+=ib===this.ms[Ra.p9c]?2:ib===this.ms[Ra.BJa]?-2:0;return this.ha.io(na,ib,5,void 0,void 0,!0)}}Ra.l9c="move";Ra.F1a="copy";Ra.DJa="grabbing";Ra.CJa=0;Ra.o9c=1;Ra.p9c=2;Ra.BJa=3;Object(u.a)(Ra,"DragSelectionClickBehaviorBase",N,[]);class lb extends Ra{constructor(na,ib,Ib,ec,qb,Ha){super(na,ib,Ib,qb);this.Za=this.pG=null;this.y$e=()=>{this.qvb(!0)};P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.fBa(this.ooa()&&this.$.isEditMode);
this.gridView=la.h(this.$);this.WF=ec;this.coloredReferencesManager=this.$.da.Aa(281);r.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.wB=A.a.wB(this.$))na=this.$.da.Aa(464),r.ULS.shipAssertTag(512312961,0,!!na,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.lB=na.lB;
for(const Ab of this.ms)y.a.instance.sa(t.a.wW,Ab,this.WF.Qcf),y.a.instance.sa(t.a.Fy,Ab,this.WF.Rcf);this.WZa(Ha)}WZa(na){this.vo.RMb(na,this.ms);this.WF.HAa()}eqc(na){r.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.FMa=!0;this.Za.WE(!1);this.nh=5;this.WF.RNe(na.Gb);this.Za.textBox.removeSelection();this.Za.g0b(this.y$e);this.dx(this.Hh,this.Rf);this.gF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0}pza(){const na=
this.sG();this.nh=-1;this.yt(this.Hh,this.Rf);return na}r2c(){this.gridView.FMa=!1;this.WF.SNe(this.ms[0]);this.Za.textBox.setCaretPositionToEnd();this.Za.Ruc(this.y$e);this.vo.TRf()}qvb(na){r.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");na&&this.yt(this.Hh,this.Rf)}Hdc(na){this.Za=this.vo.Dbc();this.pG=this.vo.X6e(na);return this.Za&&this.pG&&this.pG.range?this.pG.range:(r.ULS.shipAssertTag(537159388,
0,!!this.Za,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),r.ULS.shipAssertTag(537159387,0,!!this.pG,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),r.ULS.shipAssertTag(537159386,0,!!this.pG.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}sG(){return this.pG?this.wB?this.lB.PEb(this.Za,this.pG,this.hb):this.coloredReferencesManager.PEb(this.Za,this.pG,this.hb):(r.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}Xy(){return this.sG()}JCc(){return!0}hqc(){return!1}ooa(){return!0}}Object(u.a)(lb,"DragMarqueeClickBehavior",Ra,[]);var Aa=a(85),da=a(108),aa=a(171),fa=a(419),Oa=a(13),ba=a(225),ka=a(24),Pa=a(763),Fa=a(40),oa=a(188),La=a(708),Ea=a(116),ca=a(29),$a=a(281),Qa=a(60);const Va=(na,ib,Ib,ec,qb,Ha,Ab,Yb=null)=>{Yb=na.Na(41,Yb);Yb.sourceRange=ib;Yb.destinationRange=Ib;return Qa.g(na,"RearrangeRowColumn",Yb,ec,qb,Ha,Ab,0)},fb=(na,ib,Ib,ec,qb,Ha,Ab=null)=>{Ab=na.Na(1,Ab);Ab.moveRange=ib;return Qa.g(na,
"MoveLineItems",Ab,Ib,ec,qb,Ha,0)};class Ka{constructor(na,ib){this.destinationRange=this.sourceRange=null;this.sourceRange=na;this.destinationRange=ib}}Object(u.a)(Ka,"MacroRecorderTableRowColumnRearrangedPayload",null,[108]);var hb=a(44);class fc extends Ra{constructor(na,ib,Ib,ec,qb){super(na,ib,Ib,qb);this.Nia=Oa.a.instance.ga(2263);this.jub=Oa.a.instance.ga(2264);this.loa=Oa.a.instance.ga(2265);this.mNb=Oa.a.instance.ga(2266);this.hA=this.Qh=null;this.Vq=this.hf=this.isRow=this.Wq=!1;this.RI=
this.wH=null;this.$n=this.FCb=0;this.onKeyDown=Ha=>{if(this.$h){if(this.o5(Ha)||Ha.Ca.keyCode===Aa.a.x8)return this.w5||(da.KeyInputManager.instance.sa(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.w5=!0),!this.Eu&&this.o5(Ha)&&(la.h(this.$).yf.gm(fc.F1a),this.Eu=!0),this.Fu||Ha.Ca.keyCode!==Aa.a.x8||(la.h(this.$).yf.gm(Ra.DJa),this.Fu=!0,2===this.$n?(this.Mx(!1),this.gF=0,this.Qh=this.Vq?[11]:[12],this.Wq=this.Vq,this.gRa(),this.hJ()):3===this.$n?(this.v3(!1),this.gF=this.isRow?1:
2,this.uO(),this.Xy()):1===this.$n&&(this.Yha(!1),this.uO(),this.Xy())),!0}else if(!this.Eu&&(Ha.Ca.keyCode===Aa.a.B1||m.a.isMac&&Ha.Ca.keyCode===Aa.a.afa))return da.KeyInputManager.instance.sa(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),la.h(this.$).yf.gm(fc.F1a),this.Eu=!0;return!1};this.onKeyUp=Ha=>{if(this.$h){if(this.o5(Ha)||Ha.Ca.keyCode===Aa.a.x8)return this.FCb=this.o5(Ha)?0:1,this.Cp&&la.h(this.$).yf.gm(Ra.DJa),Ha.Ca.keyCode===Aa.a.x8&&(2===this.$n?(this.v3(!1),this.gF=0,this.uO(!0),
this.Xy(!0)):3===this.$n?(this.Mx(!1),this.gF=this.isRow?1:2,this.Qh=this.isRow?[11]:[12],this.gRa(!0),this.hJ(!0)):1===this.$n&&(this.Mx(!1),this.Qh=this.Vq?[11]:[12],this.tAa(!0),this.hJ(!0))),this.dpa(this.FCb),!0}else if(Ha.Ca.keyCode===Aa.a.B1||m.a.isMac&&Ha.Ca.keyCode===Aa.a.afa)return this.dpa(),this.Cp&&la.h(this.$).yf.gm(Ra.l9c),!0;return!1};this.iL=Ha=>{Ha=S.a(this.$).Vd(Ha);5===this.nh?this.mEd(Ha):(this.Cp=!1,this.qb.Zg(this.Qh),!this.$.$p([this.hb],!1)||this.gKd()||this.oBb()||(this.ha.sourceRange=
this.sourceRange.clone(),this.$h?this.EId():this.jvb(),this.ty()?this.hb.top>this.sourceRange.top&&(Ha=this.hb.height,this.hb.top-=Ha,this.hb.bottom-=Ha):this.hb.left>this.sourceRange.left&&(Ha=this.hb.width,this.hb.left-=Ha,this.hb.right-=Ha),this.sG()));this.yt(this.hL,this.iL);this.tableRange=null;this.nh=-1;this.$h&&(this.hA=null,this.$n=0);return!0};this.P6=()=>{this.Cp=!1;this.$n=0;this.qb.Zg(this.Qh);if(!this.$.$p([this.hb],!1))return this.yt(this.O6,this.P6),this.nh=-1,!0;if(!(this.ha.ra.dd.equals(this.hb)||
this.Fba(this.hb)||this.Fba(this.sourceRange)||this.oBb()||(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.oaa]:this.Eu,[w.a.V8b]:!0,[w.a.X8b]:this.Wq,[w.a.NU]:this.ha.sourceRange,[w.a.MU]:this.ha.ra.dd,[w.a.AJa]:this.Fu}),this.Eu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Wq)){var Ha=this.hb.height;this.hb.top-=Ha;this.hb.bottom-=Ha}else this.hb.left>this.sourceRange.left&&(this.hf||this.hb.top===this.sourceRange.top&&
!this.Wq)&&(Ha=this.hb.width,this.hb.left-=Ha,this.hb.right-=Ha);this.sG()}this.yt(this.O6,this.P6);this.hA=this.tableRange=null;this.nh=-1;this.Wq=!1;return!0};this.hL=Ha=>{var Ab=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ab&&(Ha=S.a(this.$).Vd(Ha));var Yb=Ha.clientPoint;Ab||(Ha=S.a(this.$).Vd(Ha));this.$h&&(this.Xw=Ha);if(Ha=this.ha.io(Yb,Ha.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(Ha.topLeft)){Ab=la.h(this.$);const Qb=Ab.fg(Ha);var Bb=Ab.Df(this.paneType);
Yb=La.a.Vs(Bb.view.fi,this.domElement.parentNode,Yb,Ab.rtl);Bb=!1;let sc=2;this.ty()&&Yb.y-Qb.topLeft.y>Qb.height/2?(Bb=!0,sc=1):!this.ty()&&Yb.x-Qb.topLeft.x>Qb.width/2&&(Bb=!0);if(Bb){Ab=Ab.jk("DragSelectionClickBehavior.OnPointerMoveRearrange",Ab.HH,sc);try{Ab.Is(Ha),Ab.$$mn(),Ha=Ab.$$cu().range}finally{Ab&&Ab.dispose()}}this.hb=this.n3(Ha);this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Qh);this.qb.Sn(this.Qh);this.qb.Zg(this.nB());if(6!==this.nh){for(Ha=1;4>=Ha;Ha++)Ab=this.Tg[Ha.toString()],
Ab.parentNode.removeChild(Ab),this.qb.Cv(this.ty()?11:12,Ha).zf.appendChild(Ab);this.nh=6}}else if(this.hb=this.Pha(Ha),this.$h)this.myb(!1);else if(this.qb.Ti(this.hb,this.nB()),this.qb.Sn(this.nB()),this.qb.Zg(this.Qh),5!==this.nh){for(Ha=1;4>=Ha;Ha++)Ab=this.Tg[Ha.toString()],Ab.parentNode.removeChild(Ab),this.qb.Cv(this.Zaa(),Ha).zf.appendChild(Ab);this.nh=5}this.Sy()}return!0};this.O6=Ha=>{var Ab=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ab&&(Ha=S.a(this.$).Vd(Ha));
var Yb=Ha.clientPoint;Ab||(Ha=S.a(this.$).Vd(Ha));this.Xw=Ha;if(Ab=this.ha.io(Yb,Ha.Gb,5,void 0,void 0,!0)){if(this.Cyb(Ab))return this.hb=this.Pha(Ab),this.lyb(!1),!0;var Bb=la.h(this.$),Qb=Bb.fg(Ab),sc=Bb.Df(this.paneType);Yb=La.a.Vs(sc.view.fi,this.domElement.parentNode,Yb,Bb.rtl);sc=!1;let kb=2;this.Wq=!1;if(this.isRow||this.hf){this.isRow&&Yb.y-Qb.topLeft.y>Qb.height/2?(sc=!0,kb=1):this.hf&&Yb.x-Qb.topLeft.x>Qb.width/2&&(sc=!0);if(sc){Ha=Bb.jk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
Bb.HH,kb);try{Ha.Is(Ab),Ha.$$mn(),Ab=Ha.$$cu().range}finally{Ha&&Ha.dispose()}}this.hb=this.Pha(Ab)}else{Yb.x-Qb.topLeft.x===Qb.width?(this.Wq=!1,sc=!0):Yb.y-Qb.topLeft.y>Qb.height/2&&(this.Wq=sc=!0,kb=1);this.hA&&(this.Wq=this.Vq);if(sc){Bb=Bb.jk("DragSelectionClickBehavior.OnPointerMoveDragInsert",Bb.HH,kb);try{Bb.Is(Ab),Bb.$$mn(),Ab=Bb.$$cu().range}finally{Bb&&Bb.dispose()}}this.qb.Zg(this.Qh);this.Qh=this.Wq?[11]:[12];for(Bb=1;4>=Bb;Bb++)(Qb=this.Tg[Bb.toString()])&&Qb.parentNode.removeChild(Qb),
this.Tg[Bb.toString()]=null;this.eA(Ha.clientPoint,Ha.Gb,this.Wq?11:12,!0);this.hb=this.n3(Ab)}this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Qh);this.qb.Sn(this.Qh);this.qb.Zg(this.nB());if(6!==this.nh){for(Ha=1;4>=Ha;Ha++)Ab=this.Tg[Ha.toString()],Ab.parentNode.removeChild(Ab),this.qb.Cv(this.isRow||this.Wq?11:12,Ha).zf.appendChild(Ab);this.nh=6}this.Sy()}return!0};this.Dg=()=>{this.domElement.classList.remove(ea.selecting)};this.Np=()=>{this.domElement.classList.add(ea.selecting)};this.Pc=
()=>{if(this.$.isEditMode){const Ha=this.ooa();this.fBa(Ha)}};this.Hma=()=>{this.$h?this.Cp&&5<=this.nh&&(this.tableRange?this.Fu?this.Mx(!0):this.Yha(!0):this.Fu?this.isRow||this.hf?this.Mx(!0):this.v3(!0):this.isRow||this.hf?this.v3(!0):this.Mx(!0)):this.Cp&&5<=this.nh&&(this.tableRange?(this.qb.Zg(this.Qh),this.yt(this.hL,this.iL)):(this.qb.Zg(this.nB()),this.yt(this.Hh,this.Rf)))};this.tableManager=ec;P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.fBa(this.ooa()&&
this.$.isEditMode);this.tableRange=null;this.Tg={};this.w5=this.Fu=this.Eu=this.Cp=!1;this.ha.V2(this.Np);this.ha.KY(this.Dg);this.ha.v0b(this.Hma);this.ha.PE(this.Pc);this.Xgb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.t7(this.Np),this.ha.RW(this.Dg),this.ha.pKb(this.Hma),this.ha.DI(this.Pc));if(this.Tg)for(let na=1;4>=na;na++)B.DOMElementExtensions.uf(this.Tg[na.toString()]);this.Tg=this.Qh=null;this.Eu&&this.dpa();this.$h&&this.Fu&&this.dpa(1);
super.dispose()}eqc(na){this.$h&&(this.Xw=na,this.hA=null,this.Vq=this.isRow=this.hf=this.Wq=!1,da.KeyInputManager.instance.sa(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown));this.Cp=!0;this.tableRange=this.J0c(this.tableManager.Bn(this.sourceRange.topLeft));la.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.$h?(this.hA=this.tableRange,this.$n=1,this.Qh=(this.Vq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:
[12],this.nh=6,this.dx(this.hL,this.iL),this.wH=this.Nia,this.RI=this.loa,this.eA(na.clientPoint,na.Gb,this.Vq?11:12,!0,!0),this.hJ(!0)):(this.Qh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.dx(this.hL,this.iL),this.eA(na.clientPoint,na.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.$h?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.$n=3,this.gF=this.isRow?1:2,this.nh=
6,this.Qh=this.isRow?[11]:[12],this.dx(this.O6,this.P6),this.wH=this.Nia,this.RI=this.loa,this.eA(na.clientPoint,na.Gb,this.isRow?11:12,!0,!0),this.hJ(!0)):(this.$n=2,this.gF=0,this.dx(this.Hh,this.Rf),this.wH=this.jub,this.RI=this.mNb,this.eA(na.clientPoint,na.Gb,this.Zaa(),!1,!0),this.Xy(!0))):(this.dx(this.Hh,this.Rf),da.KeyInputManager.instance.sa(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.gF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.eA(na.clientPoint,na.Gb,this.Zaa(),
!1),this.Xy()))}pza(){this.Cp=!1;this.$h&&(this.$n=0);this.qb.Zg(this.nB());if(!this.$.$p([this.hb],!1))return this.yt(this.Hh,this.Rf),this.nh=-1,!0;if(this.ha.ra.dd.equals(this.hb)||this.Fba(this.hb)||this.Fba(this.sourceRange))this.nh=-1;else{this.sG();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,ib=this.ha.ra.dd;this.$h?this.$.Xc(-694765314,2,30,{[w.a.oaa]:this.Eu,[w.a.NU]:na,[w.a.MU]:ib,[w.a.AJa]:this.Fu}):this.$.Xc(-694765314,2,30,{[w.a.oaa]:this.Eu,[w.a.NU]:na,
[w.a.MU]:ib})}!this.$h&&this.tableRange||this.yt(this.Hh,this.Rf);return!0}r2c(na){na&&(da.KeyInputManager.instance.Ba(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.$h&&la.h(this.$).yf.gm(w.a.SQ),this.Cp=!1);for(na=1;4>=na;na++){const ib=this.Tg[na.toString()];ib&&ib.parentNode.removeChild(ib);this.Tg[na.toString()]=null}this.Qh=null}hqc(na){const ib=this.ha.io(na.clientPoint,na.Gb,5,void 0,void 0,!0);this.Xw=na;return this.Cyb(ib)?(this.hb=this.n3(ib),this.lyb(!0),!0):this.yld(ib)?
(this.hb=this.Pha(ib),this.myb(!0),!0):!1}Cyb(na){return!!this.hA&&1!==this.$n&&!!na&&this.hA.contains(na.topLeft)}yld(na){return!!this.hA&&1===this.$n&&!!na&&!this.hA.contains(na.topLeft)}lyb(na){this.tableRange=this.hA;this.$n=1;const ib=!this.Fu;na?(this.Mx(!1),this.Qh=this.Vq?[11]:[12],this.tAa(ib),this.hJ(ib)):(this.v3(!1),this.uO(ib),this.Xy(ib))}myb(na){this.tableRange=null;this.$n=2;const ib=!this.Fu;na?(this.Mx(!1),this.Qh=this.Vq?[11]:[12],this.Wq=this.Vq,this.gRa(ib),this.hJ(ib)):(this.Yha(!1),
this.uO(ib),this.Xy(ib))}Hdc(){return this.ha.ra.dd}sG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Xy(na=!1){this.qb.Ti(this.hb,this.nB());this.qb.Sn(this.nB());this.Sy(na);return!0}hJ(na=!1){this.qb.Ti(this.hb,this.Qh);this.qb.Sn(this.Qh);this.Sy(na)}qvb(){r.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}JCc(){return!1}ooa(){if(!la.h(this.$).ha.ra.Pg)return!1;const na=la.h(this.$).getRangeInformation(this.ha.ra.dd);
for(const ib of na)if(Object(fa.a)(ba.PivotTableRange,ib))return!1;return!0}J0c(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.oba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const ib=new ka.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!ib.equals(na))return this.sourceRange=ib,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.$h?this.Vq=na.left===this.sourceRange.left&&
na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.ty())return na}return null}n3(na){const ib=na.clone();this.ty()?ib.left=Math.max(na.left-this.Mfc,1):ib.top=Math.max(na.top-this.WEc,1);ib.right=ib.left+this.sourceRange.width-1;ib.bottom=ib.top+this.sourceRange.height-1;return this.XZa(ib)}oBb(){const na=this.hb.topLeft.Cd(this.sourceRange);return na||this.$h&&
!this.tableRange?na:this.ty()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}gKd(){if(this.ty()&&this.hb.left!==this.tableRange.left||!this.ty()&&this.hb.top!==this.tableRange.top){const na=ca.a.$c(1,1,0,915,0,2065438552,"RearrangeInvalidDest");hb.a(this.$).Rr([na]);return!0}return!1}EId(){const na=this.$.Kb.Bc("UserAction","RearrangeRowColumnClientSide"),ib={["CopyPasteTargetType"]:1,["OperationId"]:aa.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.Fu,
["EncounteredDeploymentErrors"]:!1},Ib=this.Eu?2:1,ec=this.$.da.Aa(254);(new Promise((qb,Ha)=>{this.jvb(Ab=>{Ab.Errors&&0<Ab.Errors.length?Ha(new Pa.a(22,Ab.Errors)):qb(!0)},Ab=>{Ab=Ea.a.Pe(Ab.data);Ha(new Pa.a(22,Ab))})})).then(()=>{r.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');ec&&ec.Lrf(ib,Ib,this.sourceRange,this.hb);return Promise.resolve(!0)},qb=>{r.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${qb?
copyPasteInfra.getStringifiedError(qb):"null"}, copyPasteTargetType="${1}"`);return ec?ec.FGf(qb,ib,Ib,this.sourceRange,this.hb):Promise.reject(qb)})}jvb(na=null,ib=null){const Ib={};this.ty()?(Ib.FirstRow=this.hb.top-1,Ib.FirstColumn=0,Ib.DeltaColumn=0,Ib.DeltaRow=this.hb.bottom-this.hb.top+1):(Ib.FirstRow=0,Ib.FirstColumn=this.hb.left-1,Ib.DeltaColumn=this.hb.right-this.hb.left+1,Ib.DeltaRow=0);Ib.LastRow=U.a.Mz;Ib.LastColumn=U.a.Pw;Ib.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Cb.getItemByName(this.$.Cb.oa.name).sheetName;
const ec=Fa.v(this.sourceRange,this.$);this.$.userOperationManager.Ic(new oa.a(514,0,(qb,Ha,Ab)=>Va(this.$.pa.ya,ec,Ib,na?$a.b(qb,na):qb,ib?$a.a(Ha,ib):Ha,Ab,null),64,()=>new Ka(ec,Ib)),null)}Fba(na){na=la.h(this.$).getRangeInformation(na);for(let ib=0,Ib=na.length;ib<Ib;++ib)if(Object(fa.a)(ba.PivotTableRange,na[ib]))return na=ca.a.$c(1,0,0,900,0,2105176604,"InsDelCellsPivotTable"),hb.a(this.$).Rr([na]),!0;return!1}eA(na,ib,Ib,ec,qb=!1){var Ha=B.DOMElementExtensions.getBoundingClientRect(ib);let Ab=
ib===this.ms[Ra.CJa]||ib===this.ms[Ra.o9c];if(this.$h){var Yb=ib===this.ms[Ra.p9c]||ib===this.ms[Ra.BJa];this.isRow&&Yb||this.hf&&Ab?Yb="100px":(Ab=this.isRow||Ab,Yb=(Ab?qb?fc.RZd:fc.XZd:qb?fc.QZd:fc.UZd)+"px");ib=Ab?ib===this.ms[Ra.CJa]?"top":"bottom":ib===this.ms[Ra.BJa]?"right":"left";na=100*(Ab?na.x-Ha.x:na.y-Ha.y)/(Ab?Ha.width:Ha.height);for(Ha=1;4>=Ha;Ha++){ec=document.createElement("div");var Bb=document.createElement("div");const Qb=document.createElement("div");ec.appendChild(Bb);ec.appendChild(Qb);
qb&&(Bb=document.createElement("div"),ec.appendChild(Bb),Qb.style.fontWeight="bold");ec.className=ea.oVe;this.Tg[Ha.toString()]=ec;this.qb.Cv(Ib,Ha).zf.appendChild(ec);ec=this.Tg[Ha.toString()];ec.style[ib]=Yb;ec.style[Ab?"left":"top"]=na+"%"}}else for(qb=(Ab?-fc.WZd:-fc.TZd)+"px",Yb=Ab?ib===this.ms[Ra.CJa]?"top":"bottom":ib===this.ms[Ra.BJa]||ec?"right":"left",ib=100*(Ab?ec?0:na.x-Ha.x:na.y-Ha.y)/(Ab?Ha.width:Ha.height),na=1;4>=na;na++)Ha=document.createElement("div"),Ha.className=ea.nVe,this.Tg[na.toString()]=
Ha,this.qb.Cv(Ib,na).zf.appendChild(Ha),Ha=this.Tg[na.toString()],Ha.style[Yb]=qb,Ha.style[Ab?"left":"top"]=ib+"%"}Sy(na=!1){const ib=this.hb.toString();if(this.$h)for(var Ib=1;4>=Ib;Ib++)if(this.Xgb){const ec=this.Tg[Ib.toString()];ec&&ec.childNodes&&0<ec.childNodes.length&&(ec.childNodes[0].innerText=ib,ec.childNodes[1].innerText=this.wH,na&&(ec.childNodes[2].innerText=this.RI))}else this.Tg[Ib.toString()].childNodes[0].innerText=ib,this.Tg[Ib.toString()].childNodes[1].innerText=this.wH,na&&(this.Tg[Ib.toString()].childNodes[2].innerText=
this.RI);else for(na=1;4>=na;na++)if(this.Xgb){if(Ib=this.Tg[na.toString()])Ib.innerText=ib}else this.Tg[na.toString()].innerText=ib}dpa(na=0){0===na?this.Eu=!1:1===na&&(this.Fu=!1);this.$h&&(this.Eu||this.Fu)||(da.KeyInputManager.instance.Ba(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.w5=!1)}Mx(na){this.qb.Zg(this.nB());this.yt(this.Hh,this.Rf,void 0,na)}v3(na){this.qb.Zg(this.Qh);this.yt(this.O6,this.P6,void 0,na)}Yha(na){this.qb.Zg(this.Qh);this.yt(this.hL,this.iL,void 0,na)}uO(na=
!1){this.nh=5;this.dx(this.Hh,this.Rf);this.wH=this.jub;this.RI=this.mNb;this.eA(this.Xw.clientPoint,this.Xw.Gb,this.Zaa(),!1,na)}gRa(na=!1){this.nh=6;this.dx(this.O6,this.P6);this.wH=this.Nia;this.RI=this.loa;this.eA(this.Xw.clientPoint,this.Xw.Gb,this.isRow||this.Vq?11:12,!0,na)}tAa(na=!1){this.nh=6;this.dx(this.hL,this.iL);this.wH=this.Nia;this.RI=this.loa;this.eA(this.Xw.clientPoint,this.Xw.Gb,this.ty()?11:12,!0,na)}o5(na){return na.Ca.keyCode===Aa.a.B1||m.a.isMac&&na.Ca.keyCode===Aa.a.afa}ty(){return!this.$h&&
this.isRow||this.$h&&this.Vq}Zaa(){return this.$h?48:6}nB(){return this.$h?fc.n9c:fc.q9c}}fc.TZd=50;fc.WZd=25;fc.UZd=-85;fc.XZd=-40;fc.QZd=-120;fc.RZd=-50;fc.F1a="copy";fc.q9c=[6];fc.n9c=[48];Object(u.a)(fc,"DragSelectionClickBehavior",Ra,[]);var dc=a(82);class wb extends Ra{constructor(na,ib,Ib,ec,qb){super(na,ib,Ib,qb);this.Qh=null;this.hf=this.isRow=!1;this.Dg=()=>{this.domElement.classList.remove(ea.selecting)};this.Np=()=>{this.domElement.classList.add(ea.selecting)};this.Pc=()=>{if(this.$.isEditMode){const Ha=
this.ooa();this.fBa(Ha)}};this.tableManager=ec;P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.fBa(this.ooa()&&this.$.isEditMode);this.Tg={};this.Cp=!1;this.ha.V2(this.Np);this.ha.KY(this.Dg);this.ha.PE(this.Pc);this.Xgb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.t7(this.Np),this.ha.RW(this.Dg),this.ha.DI(this.Pc),P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.pKb(this.Hma));
if(this.Tg)for(let na=1;4>=na;na++)B.DOMElementExtensions.uf(this.Tg[na.toString()]);this.Tg=this.Qh=null;super.dispose()}r2c(na){na&&(this.$h&&la.h(this.$).yf.gm(w.a.SQ),da.KeyInputManager.instance.Ba(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.Cp=!1);for(na=1;4>=na;na++){const ib=this.Tg[na.toString()];ib&&ib.parentNode.removeChild(ib);this.Tg[na.toString()]=null}this.Qh=null}Hdc(){return this.ha.ra.dd}sG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Xy(na=!1){this.qb.Ti(this.hb,
this.nB());this.qb.Sn(this.nB());this.Sy(na);return!0}hJ(na=!1){this.qb.Ti(this.hb,this.Qh);this.qb.Sn(this.Qh);this.Sy(na)}qvb(){r.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}JCc(){return!1}eA(na,ib,Ib,ec,qb=!1){var Ha=B.DOMElementExtensions.getBoundingClientRect(ib);let Ab=ib===this.ms[Ra.CJa]||ib===this.ms[Ra.o9c];if(this.$h){var Yb=ib===this.ms[Ra.p9c]||ib===this.ms[Ra.BJa];this.isRow&&Yb||this.hf&&
Ab?Yb="100px":(Ab=this.isRow||Ab,Yb=(Ab?qb?wb.RZd:wb.XZd:qb?wb.QZd:wb.UZd)+"px");ib=Ab?ib===this.ms[Ra.CJa]?"top":"bottom":ib===this.ms[Ra.BJa]?"right":"left";na=100*(Ab?na.x-Ha.x:na.y-Ha.y)/(Ab?Ha.width:Ha.height);for(Ha=1;4>=Ha;Ha++){ec=document.createElement("div");var Bb=document.createElement("div");const Qb=document.createElement("div");ec.appendChild(Bb);ec.appendChild(Qb);qb&&(Bb=document.createElement("div"),ec.appendChild(Bb),Qb.style.fontWeight="bold");ec.className=ea.oVe;this.Tg[Ha.toString()]=
ec;this.qb.Cv(Ib,Ha).zf.appendChild(ec);ec=this.Tg[Ha.toString()];ec.style[ib]=Yb;ec.style[Ab?"left":"top"]=na+"%"}}else for(qb=(Ab?-wb.WZd:-wb.TZd)+"px",Yb=Ab?ib===this.ms[Ra.CJa]?"top":"bottom":ib===this.ms[Ra.BJa]||ec?"right":"left",ib=100*(Ab?ec?0:na.x-Ha.x:na.y-Ha.y)/(Ab?Ha.width:Ha.height),na=1;4>=na;na++)Ha=document.createElement("div"),Ha.className=ea.nVe,this.Tg[na.toString()]=Ha,this.qb.Cv(Ib,na).zf.appendChild(Ha),Ha=this.Tg[na.toString()],Ha.style[Yb]=qb,Ha.style[Ab?"left":"top"]=ib+"%"}Uig(na,
ib,Ib){const ec=la.h(this.$),qb=ec.fg(na);var Ha=ec.Df(this.paneType);Ib=La.a.Vs(Ha.view.fi,this.domElement.parentNode,Ib,ec.rtl);Ha=!1;let Ab=2;ib&&Ib.y-qb.topLeft.y>qb.height/2?(Ha=!0,Ab=1):!ib&&Ib.x-qb.topLeft.x>qb.width/2&&(Ha=!0);if(Ha){ib=ec.jk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",ec.HH,Ab);try{ib.Is(na),ib.$$mn(),ib.$$cu()}finally{ib&&ib.dispose()}}}Yha(na){this.qb.Zg(this.Qh);this.yt(this.hL,this.iL,void 0,na)}Mx(na){this.qb.Zg(this.nB());this.yt(this.Hh,this.Rf,
void 0,na)}Zaa(){return this.$h?48:6}nB(){return this.$h?wb.n9c:wb.q9c}o5(na){return na.Ca.keyCode===Aa.a.B1||m.a.isMac&&na.Ca.keyCode===Aa.a.afa}Fba(na){na=la.h(this.$).getRangeInformation(na);for(let ib=0,Ib=na.length;ib<Ib;++ib)if(Object(fa.a)(ba.PivotTableRange,na[ib]))return na=ca.a.$c(1,0,901,900,0,2105176604,"InsDelCellsPivotTable"),hb.a(this.$).Rr([na]),!0;return!1}}wb.TZd=50;wb.WZd=25;wb.UZd=-85;wb.XZd=-40;wb.QZd=-120;wb.RZd=-50;wb.q9c=[6];wb.n9c=[48];Object(u.a)(wb,"DragSelectionClickBehaviorTemporary",
Ra,[]);class Tb extends wb{constructor(na,ib,Ib,ec,qb){super(na,ib,Ib,ec,qb);this.hA=null;this.Vq=this.Wq=!1;this.FCb=0;this.RI=this.wH=null;this.$n=0;this.Nia=Oa.a.instance.ga(2263);this.jub=Oa.a.instance.ga(2264);this.loa=Oa.a.instance.ga(2265);this.mNb=Oa.a.instance.ga(2266);this.onKeyDown=Ha=>{if(this.$h){if(this.o5(Ha)||Ha.Ca.keyCode===Aa.a.x8)return this.w5||(da.KeyInputManager.instance.sa(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.w5=!0),!this.Eu&&this.o5(Ha)&&(la.h(this.$).yf.gm(Ra.F1a),
this.Eu=!0),this.Fu||Ha.Ca.keyCode!==Aa.a.x8||(la.h(this.$).yf.gm(Ra.DJa),this.Fu=!0,2===this.$n?(this.Mx(!1),this.gF=0,this.Qh=this.Vq?[11]:[12],this.Wq=this.Vq,this.gRa(),this.hJ()):3===this.$n?(this.v3(!1),this.gF=this.isRow?1:2,this.uO(),this.Xy()):1===this.$n&&(this.Yha(!1),this.uO(),this.Xy())),!0}else if(!this.Eu&&(Ha.Ca.keyCode===Aa.a.B1||m.a.isMac&&Ha.Ca.keyCode===Aa.a.afa))return da.KeyInputManager.instance.sa(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),la.h(this.$).yf.gm(Ra.F1a),
this.Eu=!0;return!1};this.onKeyUp=Ha=>{if(this.$h){if(this.o5(Ha)||Ha.Ca.keyCode===Aa.a.x8)return this.FCb=this.o5(Ha)?0:1,this.Cp&&la.h(this.$).yf.gm(Ra.DJa),Ha.Ca.keyCode===Aa.a.x8&&(2===this.$n?(this.v3(!1),this.gF=0,this.uO(!0),this.Xy(!0)):3===this.$n?(this.Mx(!1),this.gF=this.isRow?1:2,this.Qh=this.isRow?[11]:[12],this.gRa(!0),this.hJ(!0)):1===this.$n&&(this.Mx(!1),this.Qh=this.Vq?[11]:[12],this.tAa(!0),this.hJ(!0))),this.dpa(this.FCb),!0}else if(Ha.Ca.keyCode===Aa.a.B1||m.a.isMac&&Ha.Ca.keyCode===
Aa.a.afa)return this.dpa(),this.Cp&&la.h(this.$).yf.gm(Ra.l9c),!0;return!1};this.iL=Ha=>{Ha=S.a(this.$).Vd(Ha);5===this.nh?this.mEd(Ha):(this.Cp=!1,this.qb.Zg(this.Qh),!this.$.$p([this.hb],!1)||this.gKd()||this.oBb()||(this.ha.sourceRange=this.sourceRange.clone(),this.$h?this.EId():this.jvb(),this.ty()?this.hb.top>this.sourceRange.top&&(Ha=this.hb.height,this.hb.top-=Ha,this.hb.bottom-=Ha):this.hb.left>this.sourceRange.left&&(Ha=this.hb.width,this.hb.left-=Ha,this.hb.right-=Ha),this.sG()),this.Iwd());
this.yt(this.hL,this.iL);this.tableRange=null;this.nh=-1;this.$h&&(this.hA=null,this.$n=0);return!0};this.P6=()=>{this.Cp=!1;this.$n=0;this.qb.Zg(this.Qh);if(!this.$.$p([this.hb],!1))return this.yt(this.O6,this.P6),this.nh=-1,!0;if(!(this.ha.ra.dd.equals(this.hb)||this.Fba(this.hb)||this.Fba(this.sourceRange)||this.oBb()||(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.oaa]:this.Eu,[w.a.V8b]:!0,[w.a.X8b]:this.Wq,[w.a.NU]:this.ha.sourceRange,[w.a.MU]:this.ha.ra.dd,
[w.a.AJa]:this.Fu}),this.Eu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Wq)){var Ha=this.hb.height;this.hb.top-=Ha;this.hb.bottom-=Ha}else this.hb.left>this.sourceRange.left&&(this.hf||this.hb.top===this.sourceRange.top&&!this.Wq)&&(Ha=this.hb.width,this.hb.left-=Ha,this.hb.right-=Ha);this.sG()}this.yt(this.O6,this.P6);this.hA=this.tableRange=null;this.nh=-1;this.Wq=!1;this.Iwd();return!0};this.hL=Ha=>{const Ab=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Ab&&(Ha=S.a(this.$).Vd(Ha));var Yb=Ha.clientPoint;Ab||(Ha=S.a(this.$).Vd(Ha));this.$h&&(this.Xw=Ha);if(Ha=this.ha.io(Yb,Ha.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(Ha.topLeft)){if(this.Uig(Ha,this.ty(),Yb),this.hb=this.n3(Ha),this.ha.sourceRange=this.hb,this.qb.Ti(this.hb,this.Qh),this.qb.Sn(this.Qh),this.qb.Zg(this.nB()),6!==this.nh){for(Yb=1;4>=Yb;Yb++)Ha=this.Tg[Yb.toString()],Ha.parentNode.removeChild(Ha),this.qb.Cv(this.ty()?11:12,Yb).zf.appendChild(Ha);this.nh=6}}else if(this.hb=
this.Pha(Ha),this.$h)this.myb(!1);else if(this.qb.Ti(this.hb,this.nB()),this.qb.Sn(this.nB()),this.qb.Zg(this.Qh),5!==this.nh){for(Yb=1;4>=Yb;Yb++)Ha=this.Tg[Yb.toString()],Ha.parentNode.removeChild(Ha),this.qb.Cv(this.Zaa(),Yb).zf.appendChild(Ha);this.nh=5}this.Sy()}return!0};this.O6=Ha=>{var Ab=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ab&&(Ha=S.a(this.$).Vd(Ha));var Yb=Ha.clientPoint;Ab||(Ha=S.a(this.$).Vd(Ha));this.Xw=Ha;if(Ab=this.ha.io(Yb,Ha.Gb,5,
void 0,void 0,!0)){if(this.Cyb(Ab))return this.hb=this.Pha(Ab),this.lyb(!1),!0;var Bb=la.h(this.$),Qb=Bb.fg(Ab),sc=Bb.Df(this.paneType);Yb=La.a.Vs(sc.view.fi,this.domElement.parentNode,Yb,Bb.rtl);sc=!1;let kb=2;this.Wq=!1;if(this.isRow||this.hf){this.isRow&&Yb.y-Qb.topLeft.y>Qb.height/2?(sc=!0,kb=1):this.hf&&Yb.x-Qb.topLeft.x>Qb.width/2&&(sc=!0);if(sc){Ha=Bb.jk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Bb.HH,kb);try{Ha.Is(Ab),Ha.$$mn(),Ab=Ha.$$cu().range}finally{Ha&&Ha.dispose()}}this.hb=
this.Pha(Ab)}else{Yb.x-Qb.topLeft.x===Qb.width?(this.Wq=!1,sc=!0):Yb.y-Qb.topLeft.y>Qb.height/2&&(this.Wq=sc=!0,kb=1);this.hA&&(this.Wq=this.Vq);if(sc){Bb=Bb.jk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Bb.HH,kb);try{Bb.Is(Ab),Bb.$$mn(),Ab=Bb.$$cu().range}finally{Bb&&Bb.dispose()}}this.qb.Zg(this.Qh);this.Qh=this.Wq?[11]:[12];for(Bb=1;4>=Bb;Bb++)(Qb=this.Tg[Bb.toString()])&&Qb.parentNode.removeChild(Qb),this.Tg[Bb.toString()]=null;this.eA(Ha.clientPoint,Ha.Gb,this.Wq?11:
12,!0);this.hb=this.n3(Ab)}this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Qh);this.qb.Sn(this.Qh);this.qb.Zg(this.nB());if(6!==this.nh){for(Ha=1;4>=Ha;Ha++)Ab=this.Tg[Ha.toString()],Ab.parentNode.removeChild(Ab),this.qb.Cv(this.isRow||this.Wq?11:12,Ha).zf.appendChild(Ab);this.nh=6}this.Sy()}return!0};this.Hma=()=>{this.$h?this.Cp&&5<=this.nh&&(this.tableRange?this.Fu?this.Mx(!0):this.Yha(!0):this.Fu?this.isRow||this.hf?this.Mx(!0):this.v3(!0):this.isRow||this.hf?this.v3(!0):this.Mx(!0)):this.Cp&&
5<=this.nh&&(this.tableRange?(this.qb.Zg(this.Qh),this.yt(this.hL,this.iL)):(this.qb.Zg(this.nB()),this.yt(this.Hh,this.Rf)))};this.tableRange=null;this.w5=this.Eu=this.Fu=!1;this.ha.v0b(this.Hma)}dispose(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.pKb(this.Hma);this.Eu&&this.dpa();this.$h&&this.Fu&&this.dpa(1);super.dispose()}eqc(na){this.$h&&(this.Xw=na,this.hA=null,this.Vq=this.isRow=this.hf=this.Wq=!1,da.KeyInputManager.instance.sa(t.a.Pb,
this.domElement.ownerDocument.body,this.onKeyDown));this.Cp=!0;this.tableRange=this.J0c(this.tableManager.Bn(this.sourceRange.topLeft));la.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.$h?(this.hA=this.tableRange,this.$n=1,this.Qh=(this.Vq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.dx(this.hL,this.iL),this.wH=this.Nia,this.RI=this.loa,this.eA(na.clientPoint,na.Gb,this.Vq?11:12,!0,!0),this.hJ(!0)):
(this.Qh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.dx(this.hL,this.iL),this.eA(na.clientPoint,na.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.$h?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.$n=3,this.gF=this.isRow?1:2,this.nh=6,this.Qh=this.isRow?[11]:[12],this.dx(this.O6,this.P6),this.wH=this.Nia,this.RI=this.loa,this.eA(na.clientPoint,na.Gb,this.isRow?11:12,
!0,!0),this.hJ(!0)):(this.$n=2,this.gF=0,this.dx(this.Hh,this.Rf),this.wH=this.jub,this.RI=this.mNb,this.eA(na.clientPoint,na.Gb,this.Zaa(),!1,!0),this.Xy(!0))):(this.dx(this.Hh,this.Rf),da.KeyInputManager.instance.sa(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.gF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.eA(na.clientPoint,na.Gb,this.Zaa(),!1),this.Xy()))}pza(){this.Cp=!1;this.$h&&(this.$n=0);this.qb.Zg(this.nB());if(!this.$.$p([this.hb],!1))return this.yt(this.Hh,this.Rf),
this.nh=-1,!0;if(this.ha.ra.dd.equals(this.hb)||this.Fba(this.hb)||this.Fba(this.sourceRange))this.nh=-1;else{this.sG();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,ib=this.ha.ra.dd;this.$h?this.$.Xc(-694765314,2,30,{[w.a.oaa]:this.Eu,[w.a.NU]:na,[w.a.MU]:ib,[w.a.AJa]:this.Fu}):this.$.Xc(-694765314,2,30,{[w.a.oaa]:this.Eu,[w.a.NU]:na,[w.a.MU]:ib})}!this.$h&&this.tableRange||this.yt(this.Hh,this.Rf);this.Iwd();return!0}hqc(na){const ib=this.ha.io(na.clientPoint,na.Gb,5,
void 0,void 0,!0);this.Xw=na;return this.Cyb(ib)?(this.hb=this.n3(ib),this.lyb(!0),!0):this.yld(ib)?(this.hb=this.Pha(ib),this.myb(!0),!0):!1}Sy(na=!1){const ib=this.hb.toString();if(this.$h)for(var Ib=1;4>=Ib;Ib++)if(this.Xgb){const ec=this.Tg[Ib.toString()];ec&&ec.childNodes&&0<ec.childNodes.length&&(ec.childNodes[0].innerText=ib,ec.childNodes[1].innerText=this.wH,na&&(ec.childNodes[2].innerText=this.RI))}else this.Tg[Ib.toString()].childNodes[0].innerText=ib,this.Tg[Ib.toString()].childNodes[1].innerText=
this.wH,na&&(this.Tg[Ib.toString()].childNodes[2].innerText=this.RI);else for(na=1;4>=na;na++)if(this.Xgb){if(Ib=this.Tg[na.toString()])Ib.innerText=ib}else this.Tg[na.toString()].innerText=ib}Cyb(na){return!!this.hA&&1!==this.$n&&!!na&&this.hA.contains(na.topLeft)}yld(na){return!!this.hA&&1===this.$n&&!!na&&!this.hA.contains(na.topLeft)}lyb(na){this.tableRange=this.hA;this.$n=1;const ib=!this.Fu;na?(this.Mx(!1),this.Qh=this.Vq?[11]:[12],this.tAa(ib),this.hJ(ib)):(this.v3(!1),this.uO(ib),this.Xy(ib))}myb(na){this.tableRange=
null;this.$n=2;const ib=!this.Fu;na?(this.Mx(!1),this.Qh=this.Vq?[11]:[12],this.Wq=this.Vq,this.gRa(ib),this.hJ(ib)):(this.Yha(!1),this.uO(ib),this.Xy(ib))}ooa(){if(!la.h(this.$).ha.ra.Pg)return!1;const na=la.h(this.$).getRangeInformation(this.ha.ra.dd);for(const ib of na)if(Object(fa.a)(ba.PivotTableRange,ib))return!1;return!0}J0c(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.oba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const ib=
new ka.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!ib.equals(na))return this.sourceRange=ib,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.$h?this.Vq=na.left===this.sourceRange.left&&na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.ty())return na}return null}n3(na){const ib=na.clone();
this.ty()?ib.left=Math.max(na.left-this.Mfc,1):ib.top=Math.max(na.top-this.WEc,1);ib.right=ib.left+this.sourceRange.width-1;ib.bottom=ib.top+this.sourceRange.height-1;return this.XZa(ib)}oBb(){const na=this.hb.topLeft.Cd(this.sourceRange);return na||this.$h&&!this.tableRange?na:this.ty()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}gKd(){if(this.ty()&&this.hb.left!==this.tableRange.left||!this.ty()&&this.hb.top!==this.tableRange.top){const na=ca.a.$c(1,1,0,915,0,
2065438552,"RearrangeInvalidDest");hb.a(this.$).Rr([na]);return!0}return!1}EId(){const na=this.$.Kb.Bc("UserAction","RearrangeRowColumnClientSide"),ib={["CopyPasteTargetType"]:1,["OperationId"]:aa.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.Fu,["EncounteredDeploymentErrors"]:!1},Ib=this.Eu?2:1,ec=this.$.da.Aa(254);(new Promise((qb,Ha)=>{this.jvb(Ab=>{Ab.Errors&&0<Ab.Errors.length?Ha(new Pa.a(22,Ab.Errors)):qb(!0)},Ab=>{Ab=Ea.a.Pe(Ab.data);Ha(new Pa.a(22,Ab))})})).then(()=>
{r.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');ec&&ec.Lrf(ib,Ib,this.sourceRange,this.hb);return Promise.resolve(!0)},qb=>{r.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${qb?copyPasteInfra.getStringifiedError(qb):"null"}, copyPasteTargetType="${1}"`);return ec?ec.FGf(qb,ib,Ib,this.sourceRange,this.hb):Promise.reject(qb)})}jvb(na=null,ib=null){const Ib={};this.ty()?
(Ib.FirstRow=this.hb.top-1,Ib.FirstColumn=0,Ib.DeltaColumn=0,Ib.DeltaRow=this.hb.bottom-this.hb.top+1):(Ib.FirstRow=0,Ib.FirstColumn=this.hb.left-1,Ib.DeltaColumn=this.hb.right-this.hb.left+1,Ib.DeltaRow=0);Ib.LastRow=U.a.Mz;Ib.LastColumn=U.a.Pw;Ib.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Cb.getItemByName(this.$.Cb.oa.name).sheetName;const ec=Fa.v(this.sourceRange,this.$);this.$.userOperationManager.Ic(new oa.a(514,0,(qb,Ha,Ab)=>Va(this.$.pa.ya,ec,Ib,na?$a.b(qb,na):qb,ib?$a.a(Ha,ib):Ha,Ab,
null),64,()=>new Ka(ec,Ib)),null)}dpa(na=0){0===na?this.Eu=!1:1===na&&(this.Fu=!1);this.$h&&(this.Eu||this.Fu)||(da.KeyInputManager.instance.Ba(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.w5=!1)}uO(na=!1){this.nh=5;this.dx(this.Hh,this.Rf);this.wH=this.jub;this.RI=this.mNb;this.eA(this.Xw.clientPoint,this.Xw.Gb,this.Zaa(),!1,na)}gRa(na=!1){this.nh=6;this.dx(this.O6,this.P6);this.wH=this.Nia;this.RI=this.loa;this.eA(this.Xw.clientPoint,this.Xw.Gb,this.isRow||this.Vq?11:12,!0,na)}tAa(na=
!1){this.nh=6;this.dx(this.hL,this.iL);this.wH=this.Nia;this.RI=this.loa;this.eA(this.Xw.clientPoint,this.Xw.Gb,this.ty()?11:12,!0,na)}ty(){return!this.$h&&this.isRow||this.$h&&this.Vq}v3(na){this.qb.Zg(this.Qh);this.yt(this.O6,this.P6,void 0,na)}Iwd(){const na=dc.a.instance.Ub("Common.ISystemInitiatedFeedback");na&&na.execute(ib=>{ib.logActivity("DragDrop",null)})}}Object(u.a)(Tb,"DragSelectionClickBehaviorCellRangeAndTable",wb,[]);var xb=a(321),cb=a(142);class jb extends wb{constructor(na,ib,Ib,
ec,qb){super(na,ib,Ib,ec,qb);this.Hma=()=>{this.Cp&&this.Yha(!0);5===this.nh&&this.Mx(!0)};this.iL=Ha=>{S.a(this.$).Vd(Ha);this.Cp=!1;this.qb.Zg(this.Qh);this.ha.sourceRange=this.sourceRange.clone();this.amf?this.$.Xc(927125067,D.a.Db,30,null):this.e7a?(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.oaa]:!0,[w.a.NU]:this.ha.sourceRange,[w.a.MU]:this.ha.ra.dd,[w.a.AJa]:!1}),la.h(this.$).yf.gm(w.a.SQ),this.e7a=!1):this.K6i();this.yt(this.hL,this.iL);this.nh=-1;
return!0};this.hL=Ha=>{Ha=S.a(this.$).Vd(Ha);const Ab=Ha.clientPoint;this.Xw=Ha;let Yb=this.ha.io(Ab,Ha.Gb,5,void 0,void 0,!0);if(Yb){if(!this.zsd(Yb))return this.i7h(Ha),!0;this.Uig(Yb,this.isRow,Ab);if(this.isRow||this.hf)this.hb=this.n3(Yb);this.ha.sourceRange=this.hb;this.qb.Ti(this.hb,this.Qh);this.qb.Sn(this.Qh);this.qb.Zg(this.nB());this.Sy()}return!0};this.onKeyDown=Ha=>this.o5(Ha)?(this.w5||(da.KeyInputManager.instance.sa(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.w5=!0),
this.e7a||(la.h(this.$).yf.gm(Ra.F1a),this.e7a=!0),!0):!1;this.onKeyUp=Ha=>{this.o5(Ha)&&(da.KeyInputManager.instance.Ba(t.a.Fd,this.domElement.ownerDocument.body,this.onKeyUp),this.w5=!1,this.Cp?la.h(this.$).yf.gm(Ra.DJa):la.h(this.$).yf.gm(w.a.SQ),this.e7a=!1);return!0};this.kFf=Ha=>{Ha.Errors&&0<Ha.Errors.length?(r.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${ca.a.sc(Ha.Errors)}]`),this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right,this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1?(this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.hb.top||(this.hb.top-=this.sourceRange.height),this.hb.bottom=this.hb.top+this.sourceRange.height-1):this.sourceRange.left<=this.hb.left&&this.sourceRange.right>=this.hb.left-1?(this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right):(this.sourceRange.left>this.hb.left||(this.hb.left-=this.sourceRange.width),this.hb.right=this.hb.left+this.sourceRange.width-1);this.sG();this.nh=-1};this.jFf=Ha=>{Ha=Ea.a.Pe(Ha.data);r.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${ca.a.sc(Ha)}]`)};this.ha.v0b(this.Hma);this.e7a=this.w5=!1}dispose(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.pKb(this.Hma);
super.dispose()}eqc(na){this.Xw=na;this.isRow=this.hf=!1;this.Cp=!0;da.KeyInputManager.instance.sa(t.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown);(this.jc=this.tableManager.cka(this.sourceRange))||r.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.amf=(new cb.a(this.$.xa)).ji;la.h(this.$);la.h(this.$).yf.gm(Ra.DJa);this.zsd(this.hb)?(this.isRow=this.ori(),this.hf=this.$ki(),this.isRow||
this.hf?(this.S7a=!1,this.tAa(na),this.hb=this.n3(this.hb),this.hJ()):(this.S7a=!0,this.uO(na),this.Xy())):(this.S7a=!0,this.uO(na),this.Xy())}pza(){return this.amf?(this.$.Xc(927125067,D.a.Db,30,null),this.Mx(!0),this.S7a=!1,this.nh=-1,!0):this.e7a?(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.oaa]:!0,[w.a.NU]:this.ha.sourceRange,[w.a.MU]:this.ha.ra.dd,[w.a.AJa]:!1}),la.h(this.$).yf.gm(w.a.SQ),this.Mx(!0),this.Cp=this.S7a=!1,this.nh=-1,!0):5===this.nh?(this.Mx(!0),
this.S7a=!1,this.qFj(),this.nh=-1,!0):!1}hqc(na){const ib=this.ha.io(na.clientPoint,na.Gb,5,void 0,void 0,!0);this.Xw=na;return this.S7a?!1:this.zsd(ib)?(this.j7h(na),!0):!1}Sy(){let na=new ka.Range(this.hb.top,this.hb.left,this.hb.bottom,this.hb.right,!1,!0);6===this.nh&&(this.isRow?(--na.top,na.bottom=na.top+this.hb.height-1):(--na.left,na.right=na.left+this.hb.width-1));for(let ib=1;4>=ib;ib++)if(this.Xgb){const Ib=this.Tg[ib.toString()];Ib&&Ib.childNodes&&0<Ib.childNodes.length&&(Ib.childNodes[0].innerText=
na.toString())}else this.Tg[ib.toString()].childNodes[0].innerText=na.toString()}ooa(){if(!la.h(this.$).ha.ra.Pg)return!1;var na=la.h(this.$).getRangeInformation(this.ha.ra.dd);for(var ib of na)if(Object(fa.a)(ba.PivotTableRange,ib)&&(na=this.tableManager.cka(ib)))return ib=!na.isOlap||!na.$Na(!0),r.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",na),na.isActionable&&ib;return!1}n3(na){na=na.clone();this.isRow?
(na.left=this.sourceRange.left,na.right=this.jc.right,na.bottom=na.top+this.sourceRange.height-1):this.hf?(na.top=this.sourceRange.top,na.bottom=this.jc.AL.bottom,na.right=na.left+this.sourceRange.width-1):r.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.XZa(na)}K6i(){const na={},ib=Fa.v(this.sourceRange,this.$);la.h(this.$).getRangeInformation(this.hb);if(this.isRow){ib.FirstColumn=na.FirstColumn=this.hb.left-
1;ib.LastColumn=na.LastColumn=this.hb.right-1;if(this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1){r.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.hb.top?na.LastRow=na.FirstRow=this.hb.top-1:(na.FirstRow=this.hb.top-this.sourceRange.height-1,na.LastRow=na.FirstRow+this.sourceRange.height-1)}else{na.FirstRow=this.hb.top;na.LastRow=this.hb.bottom-1;if(this.sourceRange.left<=this.hb.left&&
this.sourceRange.right>=this.hb.left-1){r.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}na.LastColumn=this.sourceRange.left>this.hb.left?na.FirstColumn=this.hb.left-1:na.FirstColumn=this.hb.left-this.sourceRange.width-1}const Ib={};Ib.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Cb.getItemByName(this.$.Cb.oa.name).sheetName;Ib.Ranges=Array(2);Ib.Ranges[0]=ib;Ib.Ranges[1]=na;this.SCh(Ib)}SCh(na){this.$.userOperationManager.Ic(new oa.a(265,
0,(ib,Ib,ec)=>fb(this.$.pa.ya,na,this.kFf?$a.b(ib,this.kFf):ib,this.jFf?$a.a(Ib,this.jFf):Ib,ec,null),64),null)}zsd(na){return null!==this.jc&&(null===this.jc.AL||na.left>=this.jc.AL.left)&&(null===this.jc.fF||na.right<=this.jc.fF.right)&&(null===this.jc.fF||na.top>=this.jc.fF.top)&&(null===this.jc.AL||na.bottom<=this.jc.AL.bottom)}ori(){return null!==this.jc&&null!==this.jc.AL&&this.jc.AL.top<=this.hb.top&&this.jc.AL.left<=this.hb.left&&this.jc.AL.right>=this.hb.left}$ki(){return null!==this.jc&&
null!==this.jc.fF&&this.jc.fF.top===this.hb.top&&this.jc.fF.left<=this.hb.left&&this.jc.fF.right>=this.hb.right}tAa(na){this.nh=6;this.Qh=this.isRow?[11]:[12];this.dx(this.hL,this.iL);this.eA(na.clientPoint,na.Gb,this.isRow?11:12,!0,!1)}uO(na){this.nh=5;this.dx(this.Hh,this.Rf);this.eA(na.clientPoint,na.Gb,this.Zaa(),!1,!1)}j7h(na){this.Mx(!1);this.tAa(na);this.hb=this.n3(this.hb);this.hJ()}i7h(na){this.Yha(!1);this.uO(na);this.Xy()}qFj(){if(!this.Fba(this.hb)){var na=ca.a.$c(1,0,903,902,0,2069074184,
"PivotTableInvalidMove");na.HelpTopicId=xb.a.gJj;na.HelpDescription=Oa.a.instance.ga(910);hb.a(this.$).Rr([na])}}}Object(u.a)(jb,"DragSelectionClickBehaviorPivotTableRange",wb,[]);var qa=a(375);class za extends N{constructor(na,ib){super(na);this.Dg=()=>{this.domElement.classList.remove(ea.selecting);qa.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Np=()=>{this.domElement.classList.add(ea.selecting)};this.onPointerDown=Ib=>{2===Ib.tb&&Ib.ho===Sys.UI.MouseButton.leftButton&&
(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.ra.dd,qa.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Pca=()=>{this.gridView.$.Xc(1983983164,2,30,null);return!0};this.ed=()=>{B.DOMElementExtensions.setVisible(this.Haa,this.gridView.$.isEditMode)};this.W6=()=>{B.DOMElementExtensions.setVisible(this.Haa,!1)};this.V6=()=>{B.DOMElementExtensions.setVisible(this.Haa,!0)};this.tDf=()=>{B.DOMElementExtensions.setVisible(this.Haa,!1)};
this.sDf=()=>{B.DOMElementExtensions.setVisible(this.Haa,!0)};this.bGb=(Ib,ec)=>{B.DOMElementExtensions.setVisible(this.Haa,!ec.noe)};this.gridView=ib;ib=document.createElement("div");ib.className=Z.a.uBh;this.Haa=ib;this.ed(null,null);na.appendChild(ib);y.a.instance.sa(t.a.pointerDown,this.Haa,this.onPointerDown);M.a.instance.sa(t.a.Dk,this.Haa,this.Pca);this.gridView.ha.V2(this.Np);this.gridView.ha.KY(this.Dg);this.gridView.$.ll(this.ed);this.gridView.$.rb.D0b(this.W6);this.gridView.$.rb.C0b(this.V6);
this.gridView.Uqe(this.bGb);this.gridView.fc.Yk(this.tDf);this.gridView.fc.Rm(this.sDf)}dispose(){y.a.instance.Ba(t.a.pointerDown,this.Haa,this.onPointerDown);M.a.instance.Ba(t.a.Dk,this.Haa,this.Pca);this.gridView.$&&(this.gridView.ha.t7(this.Np),this.gridView.ha.RW(this.Dg),this.gridView.$.Kl(this.ed),this.gridView.$.rb.hvc(this.W6),this.gridView.$.rb.gvc(this.V6),this.gridView.lVf(this.bGb),this.gridView.fc.Gk(this.tDf),this.gridView.fc.em(this.sDf));super.dispose()}}Object(u.a)(za,"FillHandleClickBehavior",
N,[]);class Na extends V{constructor(na,ib){super(na);this.RWi=Ib=>{const ec=G.HelperMethods.Do(Ib);var qb=this.qwa.E2d(Ib.clientPoint);if(!qb)return!1;var Ha=qb.fe,Ab=this.qwa.Da.gxb(Ha.hashCode).Iva(qb.iJ);if(!Ab)return!1;Ib=Ha.Zi.domElement;qb=G.HelperMethods.Xpe(G.HelperMethods.zxb(Ha.domElement,Ib),qb.iJ);Ha=0;Ab=this.qwa.Sb(Ab.getRange());for(let Bb=0,Qb=Na.xBe.length;Bb<Qb;++Bb){const sc=Na.xBe[Bb];if((128===sc||64===sc)&&this.qwa.$.isEditMode)continue;var Yb=Ab.oLa(sc);if(!Yb||!Yb.N6a||"none"===
Yb.N6a.style.display)continue;Yb=Yb.N6a;const kb=G.HelperMethods.zxb(Yb,Ib);Yb=new Sys.UI.Bounds(kb.x,kb.y,Yb.offsetWidth,Yb.offsetHeight);if(L.a.EN(Yb,qb)){Ha=sc;break}}return 0!==Ha?(Ab.invoke(Ha,ec),!0):!1};this.nwg=ib;M.a.instance.sa(t.a.click,na,this.RWi)}get qwa(){return this.nwg}}Na.xBe=[1,2,32,256,128,64];Object(u.a)(Na,"IPadSelectionClickThroughBehavior",V,[]);var ua=a(22);class Xa{constructor(na){this.Qcf=ib=>{this.MDc(ib.Gb,1);return!0};this.Rcf=ib=>{this.MDc(ib.Gb,-1);return!0};this.Dg=
()=>{this.ord=!1};this.Np=()=>{this.ord=!0};this.gridView=na;this.l6a=0;this.ord=this.xic=!1;this.a6=Number.NaN;this.gridView.ha.V2(this.Np);this.gridView.ha.KY(this.Dg);this.gridView.ha.v0b(this.Dg)}dispose(){this.gridView.ha.t7(this.Np);this.gridView.ha.RW(this.Dg);this.gridView.ha.pKb(this.Dg)}HAa(){this.l6a=0;this.xic=!1;this.a6=Number.NaN}RNe(na){this.xic=!0;this.MDc(na,1)}SNe(na){this.xic=!1;this.MDc(na,-1)}MDc(na,ib){if(na)if(na.parentNode)if(this.ord)isNaN(this.a6)||(this.$Dc(this.a6,!1),
this.a6=Number.NaN);else if(na=parseInt(na.parentNode.getAttribute(w.a.C6a),10),isNaN(na))r.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.a6)&&na!==this.a6){if(this.xic)return;this.$Dc(this.a6,!1)}if(isNaN(this.a6)||na!==this.a6)this.a6=na,this.l6a=0;!this.l6a&&0<ib&&this.$Dc(na,!0);this.l6a=Math.max(this.l6a+ib,0);!this.l6a&&0>ib&&(this.$Dc(na,!1),this.a6=Number.NaN)}else r.ULS.shipAssertTag(537159367,
0,!!na.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else r.ULS.shipAssertTag(537159368,0,!!na,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}$Dc(na,ib){for(let ec=1;4>=ec;ec++){var Ib=this.gridView.qb.Cv(3,ec,na).zf;B.DOMElementExtensions.toggleCssClass(Ib,ea.RAh,ib);for(Ib=Ib.firstChild;Ib;Ib=Ib.nextSibling)ua.a.contains(Ib.className,"resizemarqueehandle",!0)&&B.DOMElementExtensions.toggleCssClass(Ib,ea.VAh,ib)}}}Object(u.a)(Xa,"MarqueeHoveringManager",
null,[]);var ha=a(178),ta=a(83),wa=a(824),db=a(1237);class Jb extends V{constructor(na,ib){super(na);this.fqc=()=>{if(!this.Bu)return r.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Bu.xQf(this.SH,!1);this.Bu.JPe(this.SH,!1);if(3===this.Bu.model.state)return!0;this.Bu.Ncf(!0);return!0};this.k0=()=>{if(!this.Bu)return!1;this.Bu.Q8i();this.Bu.fOd(this.SH,!1);if(3===this.Bu.model.state)return!0;this.Bu.Ncf(!1);return!0};
this.onPointerDown=Ib=>this.Bu?2===Ib.tb&&Ib.ho===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.xGb=()=>{if(!this.Bu)return!1;this.Bu.fOd(this.SH,!0);this.Bu.xQf(this.SH,!0);this.Bu.JPe(this.SH,!0);this.Bu.XLb(!0);return!0};this.onDoubleClick=Ib=>{if(Ib.Ca)return Ib.Ca.stopPropagation(),!0;r.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Bu=Object(ta.a)(db.a,ib.metadata);this.EF=document.createElement("div");this.EF.id=
`${na.id}-${w.a.nBe}`;this.EF.className=wa.a.O0g;this.SH=document.createElement("div");this.SH.id=`${na.id}-${w.a.A1c}`;this.SH.className=wa.a.A1c;this.EF.appendChild(this.SH);na.appendChild(this.EF);r.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");y.a.instance.sa(t.a.wW,this.EF,this.fqc);y.a.instance.sa(t.a.Fy,this.EF,this.k0);y.a.instance.sa(t.a.pointerDown,this.EF,this.onPointerDown);ha.a.instance.sa(t.a.click,
this.EF,this.xGb);ha.a.instance.sa(t.a.Dk,this.EF,this.onDoubleClick);B.DOMElementExtensions.setVisible(this.EF,ib.isVisible)}dispose(){y.a.instance.Ba(t.a.wW,this.EF,this.fqc);y.a.instance.Ba(t.a.Fy,this.EF,this.k0);y.a.instance.Ba(t.a.pointerDown,this.EF,this.onPointerDown);ha.a.instance.Ba(t.a.click,this.EF,this.xGb);ha.a.instance.Ba(t.a.Dk,this.EF,this.onDoubleClick);B.DOMElementExtensions.uf(this.SH);this.SH=null;B.DOMElementExtensions.uf(this.EF);this.Bu=this.EF=null;super.dispose()}WZa(na){this.Bu=
Object(ta.a)(db.a,na.metadata);na.isVisible!==na.eya&&(this.Bu.rzj(na.isVisible?1:0),B.DOMElementExtensions.setVisible(this.EF,na.isVisible))}}Object(u.a)(Jb,"RangeCatchUpActivityHighlightBehavior",V,[]);class Pb extends X{constructor(na,ib,Ib,ec){super(na,ib,Ib,ec)}get e5(){return 16}get Ddb(){return this.gridView.ha.rangePicker.$ed(!1)}mTa(){return(this.gridView.inRangePicker||this.gridView.ri)&&super.mTa()}}Object(u.a)(Pb,"RangePickerTouchGrippiesBehavior",X,[]);class eb extends V{constructor(na,
ib){super(na);const Ib=document.createElement("div"),ec=document.createElement("div");Ib.className=ib?ea.CBh:ea.EBh;ec.className=ib?ea.DBh:ea.BBh;na.appendChild(Ib);na.appendChild(ec)}}Object(u.a)(eb,"RearrangeHighlightBehavior",V,[]);var Ma;(function(na){na[na.topLeft=0]="topLeft";na[na.topRight=1]="topRight";na[na.bottomLeft=2]="bottomLeft";na[na.bottomRight=3]="bottomRight";na[na.error=4]="error"})(Ma||(Ma={}));Object(u.b)("Corner",Ma);class ob extends V{constructor(na,ib,Ib,ec,qb){super(na);this.Za=
this.pG=null;this.S3=0;this.hb=this.sourceRange=null;this.ZTa=!1;this.onPointerDown=Ha=>{Ha=S.a(this.$).Vd(Ha);if(this.k7f(Ha)&&!this.ZTa){this.$rf();this.Za=this.vo.Dbc();this.pG=this.vo.X6e(Ha);if(!this.Za||!this.pG||!this.pG.range)return r.ULS.shipAssertTag(537159361,0,!!this.Za,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),r.ULS.shipAssertTag(537159360,0,!!this.pG,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),r.ULS.shipAssertTag(537159331,0,
!!this.pG.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.hb=this.pG.range.clone();this.sourceRange=this.hb.clone();this.S3=this.O2e(Ha);if(4===this.S3)return r.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Ab=this.I4e(Ha,!0);if(!Ab)return r.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;
if(!this.vIe(Ab))return r.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.FMa=!0;this.Za.WE(!1);this.WF.RNe(Ha.Gb);this.vo.dQf(!0,this.rba.oU);this.Za.textBox.removeSelection();this.Za.g0b(this.z$e);this.rTf();this.ZTa=!0;Ca.b(this.$,!0)}return!0};this.Hh=Ha=>{Ha=S.a(this.$).Vd(Ha);Ha=this.I4e(Ha,!1);if(!Ha)return!0;Ha=this.vIe(Ha);if(!Ha)return r.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),
this.Aac(!0),!1;if(this.hb.equals(Ha))return!0;this.hb=Ha;Ha=this.Xy();Ha||(r.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Aac(!0));return Ha};this.Rf=Ha=>{S.a(this.$).Vd(Ha);Ha=this.sG();r.ULS.shipAssertTag(537159325,0,Ha,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.Aac(!Ha);return Ha};this.z$e=()=>{this.Aac(!0)};this.gridView=ib;this.$=ib.$;this.xL=[];this.ha=this.gridView.ha;this.WF=Ib;this.vo=ec;this.rba=
qb;this.coloredReferencesManager=this.$.da.Aa(281);r.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.wB=A.a.wB(this.$))ib=this.$.da.Aa(464),r.ULS.shipAssertTag(510255176,0,!!ib,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.lB=ib.lB;for(const Ha of this.DYf())ib=this.vo.IHe(na,
Ha,this.Gse(),this.onPointerDown),this.xL.push(ib);for(const Ha of this.xL)y.a.instance.sa(t.a.wW,Ha,this.WF.Qcf),y.a.instance.sa(t.a.Fy,Ha,this.WF.Rcf);this.WZa(qb)}dispose(){this.xL.forEach(na=>{y.a.instance.Ba(t.a.pointerDown,na,this.onPointerDown)});this.xL.length=0;super.dispose()}WZa(na){this.rba=na;this.Pse(na);this.vo.RMb(na,this.xL,this.DUd());this.WF.HAa()}I4e(na,ib){const Ib=na.Gb;na=na.clientPoint;if(!Ib||!na)return r.ULS.shipAssertTag(537159324,0,!!Ib,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),
r.ULS.shipAssertTag(537159323,0,!!na,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ib&&(na=this.$vf(na));ib=this.ha.io(na,Ib,0,!0,!1,!0);ib||(na=this.$vf(na),ib=this.ha.io(na,Ib,0,!0,!1,!0));return ib}$vf(na){na.y+=0===this.S3||1===this.S3?2:-2;na.x+=0===this.S3||2===this.S3?2:-2;return na}vIe(na){if(!na||!this.sourceRange)return r.ULS.shipAssertTag(537159322,0,!!na,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),r.ULS.shipAssertTag(537159321,0,!!this.sourceRange,
"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.S3)return new ka.Range(na.top,na.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.S3)return new ka.Range(na.top,this.sourceRange.left,this.sourceRange.bottom,na.right,!0,!1);if(2===this.S3)return new ka.Range(this.sourceRange.top,na.left,na.bottom,this.sourceRange.right,!0,!1);if(3===this.S3)return new ka.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,na.right,!0,!1);r.ULS.shipAssertTag(537159320,
0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Ma[this.S3]}`);return null}sG(){return this.wB?this.lB.PEb(this.Za,this.pG,this.hb):this.coloredReferencesManager.PEb(this.Za,this.pG,this.hb)}Xy(){return this.sG()}Aac(na){na&&r.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.WF.SNe(this.xL[0]);this.vo.dQf(!1,this.rba.oU);this.Za.textBox.setCaretPositionToEnd();
this.Za.Ruc(this.z$e);this.ihg();this.ZTa=this.gridView.FMa=!1;Ca.b(this.$,!1);this.vo.TRf()}}Object(u.a)(ob,"ResizeMarqueeBehaviorBase",V,[]);class Ia extends ob{constructor(na,ib,Ib,ec,qb){super(na,ib,Ib,ec,qb)}DYf(){return[ea.IBh,ea.JBh,ea.GBh,ea.HBh]}Gse(){return[ea.FBh]}O2e(na){na=na.Gb;if(na===this.xL[0])return 0;if(na===this.xL[1])return 1;if(na===this.xL[2])return 2;if(na===this.xL[3])return 3;r.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}rTf(){this.vo.dx(this.Hh,this.Rf,!0)}ihg(){this.vo.u0d(this.Hh,this.Rf,!0)}k7f(na){return 2===(D.a.Db=na.tb)&&na.ho===Sys.UI.MouseButton.leftButton}DUd(){return!0}$rf(){r.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}Pse(na){for(const ib of this.xL)ib.style.backgroundColor=na.zf.style.borderColor}}Object(u.a)(Ia,"ResizeMarqueeMouseBehavior",ob,[]);class Da extends ob{constructor(na,ib,Ib,ec,qb){super(na,ib,Ib,
ec,qb);this.sGb=()=>{const Ha=3===D.a.Db;this.cvd&&!Ha?this.vo.RMb(this.rba,this.xL,!1):!this.cvd&&Ha&&this.vo.RMb(this.rba,this.xL,!0);this.cvd=Ha};this.XVi=(Ha,Ab)=>{Ab.C6a===this.rba.oU&&this.vo.RMb(this.rba,this.xL,!Ab.start&&this.DUd())};D.a.Are(this.sGb);this.cvd=3===D.a.Db;this.vo.pMg(this.XVi)}dispose(){D.a.MVf(this.sGb);super.dispose()}DYf(){return[Z.a.KAh,Z.a.JAh]}Gse(){const na=!P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[na?Z.a.fVe:Z.a.eVe,Z.a.y$b,na?Z.a.IAh:
Z.a.x$b]}O2e(na){na=na.Gb;if(na===this.xL[0])return 0;if(na===this.xL[1])return 3;r.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}rTf(){m.a.Iw?this.vo.dx(this.Hh,this.Rf,!1):this.vo.Pcj(this.Hh,this.Rf)}ihg(){m.a.Iw?this.vo.u0d(this.Hh,this.Rf,!1):this.vo.hVj(this.Hh,this.Rf)}k7f(na){return 3===(D.a.Db=na.tb)}DUd(){return 3===D.a.Db}$rf(){r.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}Pse(){}}
Object(u.a)(Da,"ResizeMarqueeTouchBehavior",ob,[]);class nb extends V{constructor(na,ib){super(na);nb.Bsb(na,T.a.$Ah+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.horizontal);nb.Bsb(na,T.a.ZAh+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.vertical);nb.Bsb(na,T.a.WAh+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.horizontal);nb.Bsb(na,T.a.YAh+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.vertical);nb.Bsb(na,Z.a.XAh)}static Bsb(na,ib,Ib){const ec=document.createElement("div");ec.className=ib;Ib&&(ec.style.backgroundImage=
`url("${Ib}")`);na.appendChild(ec)}}Object(u.a)(nb,"SelectionCutCopyBehavior",V,[]);class Ua extends V{constructor(na){super(na);appChrome.renderSpinner(na)}}Object(u.a)(Ua,"SelectionPasteBehavior",V,[]);class W extends V{constructor(na,ib){super(na);W.Ssb(na,T.a.ABh+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.horizontal);W.Ssb(na,T.a.zBh+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.vertical);W.Ssb(na,T.a.wBh+" "+Z.a.Xua,null===ib||void 0===ib?void 0:ib.horizontal);W.Ssb(na,T.a.yBh+" "+Z.a.Xua,null===
ib||void 0===ib?void 0:ib.vertical);W.Ssb(na,Z.a.xBh)}static Ssb(na,ib,Ib){const ec=document.createElement("div");ec.className=ib;Ib&&(ec.style.backgroundImage=`url("${Ib}")`);na.appendChild(ec)}}Object(u.a)(W,"SelectionRangePickerBehavior",V,[]);class sa extends X{constructor(na,ib,Ib,ec){super(na,ib,Ib,ec)}get e5(){return 0}get Ddb(){return this.gridView.ha.ra.dd}mTa(){const na=this.gridView.ri||this.gridView.eb;return this.gridView.ha.ra.Pg&&!na&&super.mTa()}}Object(u.a)(sa,"SelectionTouchGrippiesBehavior",
X,[]);var vb=a(52);class gc extends x.a{constructor(na,ib){super();this.Npb=(Ib,ec)=>{Ib=ec.e5;const qb=this.gridView;ec=ec.dbi;const Ha=ec.zf,Ab=ec.x$;m.a.$g&&Ab.push(new Na(Ha,qb));switch(Ib){case 24:ec.x$.push(new Jb(Ha,ec));break;case 0:ec.x$.push(new za(Ha,qb));m.a.Dp||(P.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(Ab.push(new Tb(Ha,this.gridView.$,ec.paneType,this.tableManager,this.vo)),P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&Ab.push(new jb(Ha,this.gridView.$,ec.paneType,this.tableManager,this.vo))):Ab.push(new fc(Ha,this.gridView.$,ec.paneType,this.tableManager,this.vo)));Ab.push(new sa(ec,Ha,qb,ec.paneType));break;case 3:Ab.push(new N(Ha));m.a.Dp||(Ab.push(new lb(Ha,this.gridView.$,ec.paneType,this.WF,this.vo,ec)),Ab.push(new Ia(Ha,this.gridView,this.WF,this.vo,ec)),Ab.push(new Da(Ha,this.gridView,this.WF,this.vo,ec)));break;case 4:case 5:Ab.push(new nb(Ha,this.$te));break;case 30:Ab.push(new Ua(Ha));break;case 16:Ab.push(new W(Ha,
this.$te));Ab.push(new Pb(ec,Ha,qb,ec.paneType));break;case 11:case 12:Ab.push(new eb(Ha,11===Ib));break;case 17:Ab.push(new N(Ha));break;case 19:Ab.push(new N(Ha)),Ab.push(new Y(ec,Ha,qb,ec.paneType))}ec.h2b=!0};this.$=na;this.gridView=la.h(na);this.tableManager=ib;this.WF=new Xa(this.gridView);this.vo=new E(this.gridView);this.gridView.qb&&(this.gridView.qb.MLg(this.Npb),this.gridView.qb.update(!1));na.da.Ga(64,this)}get $te(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.Zte&&(this.Zte={vertical:vb.a.current.fo(105),horizontal:vb.a.current.fo(106)});return this.Zte}dispose(){this.gridView.qb.$gj(this.Npb);this.WF&&(this.WF.dispose(),this.WF=null);super.dispose()}}Object(u.a)(gc,"GridHighlightsBehaviorManager",x.a,[]);class Bc extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){n.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),na=>{this.nb(this.$.da.Aa(64)||new gc(this.$,na.result))},this.ka,3)}static la(na){na.da.Ga(149,
new Bc(na))}}Object(u.a)(Bc,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(F,"a",function(){return Sa});const Sa=()=>{c.a.Fa(Bc.la);c.a.Fa(d.la)}},1149:function(u,F,a){var c=a(9);u=a(0);var b=a(694),e=a(49),f=a(37),d=a(184),h=a(55);class n{constructor(Sa){this.Goh=Sa}nc(){return!1}executeCommand(Sa,na){Sa=na.command;na=null;switch(Sa){case 1243860697:this.Goh.uQj();break;default:na=d.a(Sa)}return na||h.Task.Ta(!0)}wc(Sa,na){return 1243860697===na.command}Kc(){return!1}}Object(u.a)(n,"SheetDropdownMenuCommandHandler",
null,[208]);class m extends b.a{constructor(Sa){super(Sa)}ld(){this.$.ky(Sa=>{Sa.ogc().then(()=>{f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,32,33,this.Ya),na=>{this.Zc([new n(na.result.ZAj)])},this.$.ka)})})}static la(Sa){b.a.Nd(392,new m(Sa))}}Object(u.a)(m,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var x=a(222),r=a(5),y=a(74),t=a(33),v=a(1),w=a(15),C=a(27),B=a(178),z=a(14),A=a(89),E=a(45),I=a(239),L=a(156),V=a(108),T=a(39),H=a(419),D=a(83),G=a(13),J=a(35);class M{constructor(){this.vMe=
new J.a(!0);this.LJc=0}get H8c(){return this.LJc}get navigationButtonsDisabled(){return!!(this.H8c&1)}get operationButtonsDisabled(){return!!(this.H8c&2)}dRg(Sa,na){this.vMe.add(Sa,na);this.JS()}JS(){this.LJc=0;J.a.forEach(this.vMe.Gu,Sa=>{this.LJc=this.H8c|Sa.value})}}Object(u.a)(M,"SheetTabBarDisabledStateManager",null,[]);var Q=a(238),U=a(31);class Z{}Z.Wxh="ewa-stb-uir";Z.JSe="ewa-stb-drag";Z.Gxh="ewa-stb-navarea";Z.Hxh="ewa-stb-navarea-dimensions";Z.Jxh="ewa-stb-navbutton";Z.wU="cui-disabled";
Z.Ixh="ewa-stb-navareaextra";Z.xia="cui-img-container";Z.Axh="ewa-stb-contentarea";Z.KSe="ewa-stb-left-scrollable";Z.VSe="ewa-stb-right-scrollable";Z.Uxh="ewa-stb-tabarea";Z.Txh="ewa-stb-sheettabmoveindicator";Z.XSe="ewa-stb-tabs";Z.eNj="tab-active";Z.mNj="tab-inactive";Z.lNj="tab-hover";Z.Vxh="ewa-stb-tabs-ghost";Z.gNj="tab-anchor-text";Z.dark="dark";Z.light="light";Z.fNj="tab-active-text";Z.jNj="tab-content-container";Z.oNj="tab-text";Z.Mxh="ewa-stb-nsv-inactive";Z.Nxh="ewa-stb-nsv-inactive-svg";
Z.Kxh="ewa-stb-nsv-active";Z.Lxh="ewa-stb-nsv-active-svg";Z.wwh="ewa_nsv_margin";Z.Bxh="ewa-stb-disable-scrollbar";Z.ixi="leave-size-fixed-on-tab-hover-old";Z.hxi="leave-size-fixed-on-tab-hover";Z.OSe="ewa-stb-locked-sheet";Z.PSe="ewa-stb-locked-sheet-svg-16px";Z.Cxh="ewa-stb-dropdown-menu-button";Z.Ush="ewa-active-sheet-menu-item";Object(u.a)(Z,"CssClassNames",null,[]);var P=a(734),S=a(19),ja=a(259),X=a(102),Y=a(188),va=a(247),N=a(46),ea=a(286),Ca=a(52),la=a(12),Ra=a(71),lb=a(320),Aa=a(11),da=a(100),
aa=a(350),fa=a(21),Oa=a(191),ba=a(375),ka=a(371),Pa=a(44),Fa=a(224),oa=a(85);class La extends Q.a{constructor(Sa,na,ib=!1){super(Sa);this.sbb=this.Wsa=null;this.$=na;this.$X=ib}get disabled(){return this.$X}dispose(){this.sbb=this.Wsa=this.$=null;super.dispose()}ES(Sa){this.$X=Sa;this.domElement.setAttribute(r.a.Isa,Sa.toString());la.DOMElementExtensions.toggleCssClass(this.domElement,P.a.wU,Sa)}}Object(u.a)(La,"SheetBarButton",Q.a,[]);var Ea=a(710);class ca extends La{constructor(Sa,na,ib,Ib=!1){super(document.createElement("a"),
na,Ib);this.gd=ec=>{this.disabled||this.$.Xc(-1935155518,ec.tb,30,null);return!0};this.zGb=ec=>{ec="mouseover"===ec.type||"focus"===ec.type;const qb=ba.a(this.$)?this.sbb:this.Wsa;Aa.HelperMethods.EZd(qb,this.Jha,this.Jha+r.a.Tfc,ec&&!fa.h(this.$).inRangePicker)};this.uh=()=>{this.ES(!0)};this.jg=()=>{this.ES(!1)};this.Jha=v.EwaSettings.ma(494)?S.a.Lad:S.a.FTe;this.Wsa=ib.pb(this.domElement,G.a.instance.ga(509),0,this.Jha,G.a.instance.ga(510),Ea.a.X3c,Ib);Sa.appendChild(this.domElement);this.Gc.la("contextmenu",
ec=>{Ra.g(ec)});v.EwaSettings.ma(494)||(this.Gc.la("mouseover",this.zGb),this.Gc.la("mouseout",this.zGb));Fa.a.instance.sa(z.a.click,this.domElement,this.gd);this.Cla=V.KeyInputManager.instance.Ns(this.domElement,this.gd,oa.a.Mh,oa.a.GX);fa.h(this.$).fc.Yk(this.uh);fa.h(this.$).fc.Rm(this.jg)}dispose(){Fa.a.instance.Ba(z.a.click,this.domElement,this.gd);V.KeyInputManager.instance.Tv(this.domElement,this.Cla);fa.h(this.$)&&fa.h(this.$).fc&&(fa.h(this.$).fc.Gk(this.uh),fa.h(this.$).fc.em(this.jg));
super.dispose()}ES(Sa){const na=ca.h7f(this.$);super.ES(Sa||na)}static h7f(Sa){return!Sa.isEditMode||!Sa.xa.count}}Object(u.a)(ca,"InsertSheetButton",La,[]);class $a extends La{constructor(Sa,na,ib){super(document.createElement("a"),na);this.gd=Ib=>{this.$.Xc(-684145703,Ib.tb,0,null);return!0};this.zGb=Ib=>{Aa.HelperMethods.EZd(this.mze,this.Jha,this.Jha+r.a.Tfc,("mouseover"===Ib.type||"focus"===Ib.type)&&!fa.h(this.$).inRangePicker)};this.$=na;this.Jha=v.EwaSettings.ma(494)?S.a.Lad:S.a.FTe;this.mze=
ib.pb(this.domElement,G.a.instance.ga(511),0,this.Jha,G.a.instance.ga(512),Ea.a.X3c);Sa.appendChild(this.domElement);this.Gc.la("contextmenu",Ib=>{Ra.g(Ib)});this.Gc.la("mouseover",this.zGb);this.Gc.la("mouseout",this.zGb);Fa.a.instance.sa(z.a.click,this.domElement,this.gd);this.Cla=V.KeyInputManager.instance.Ns(this.domElement,this.gd,oa.a.Mh,oa.a.GX)}dispose(){Fa.a.instance.Ba(z.a.click,this.domElement,this.gd);V.KeyInputManager.instance.Tv(this.domElement,this.Cla);this.mze=null;super.dispose()}}
Object(u.a)($a,"InsertTemplateButton",La,[]);class Qa{constructor(Sa,na){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Sa;this.newSheetIndex=na}getSheetName(){return this.sheetName}}Object(u.a)(Qa,"MacroRecorderSheetReorderedPayload",null,[108]);var Va=a(92);class fb extends Q.a{constructor(Sa,na){super(document.createElement("div"));this.HR=()=>{w.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.KWf(!1,"OnSheetsChanged")};this.IOi=()=>{this.Nj()};this.HOi=()=>{this.gk()};
this.$=Sa;this.MNj=na;this.XU=!1;this.GPb=0}dispose(){this.gk();super.dispose()}uQj(){this.KWf(!0,"TogglerSheetDropdownMenu")}KWf(Sa,na){w.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${na}, toggle: ${Sa}, toggleStateId: ${this.GPb}`);Sa&&(this.GPb+=1);const ib=this.$.Kb.Bc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${na}, toggle: ${Sa}, toggleStateId: ${this.GPb}, sheetCount: ${this.$.xa.count}`);Sa=this.zfh();appChrome.renderSheetDropdownMenu(this.domElement,
this.MNj,Sa,this.GPb,this.IOi,this.HOi,()=>{ib.stop()},ba.a(this.$))}zfh(){const Sa=this.$.xa,na=[];for(let Ib=0;Ib<Sa.count;Ib++){var ib=Object(D.a)(da.a,Sa.getItem(Ib));0===ib.VB&&(ib=this.yfh(ib),na.push(ib))}return na}yfh(Sa){const na={};na.key=Sa.name;na.text=Sa.name;na.onClick=this.Afh(Sa);Sa.active&&(na.className=ba.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Z.Ush);return na}Afh(Sa){return()=>{const na=new Va.a(-1876836819,0,this.$.Hc,30,null);this.$.Ja.Lb(na,{[r.a.ITd]:Sa.name})}}Nj(){if(!this.XU){const Sa=
this.$.xa;Sa.Xf(this.HR);Sa.aXc(this.HR);Sa.JY(this.HR);Sa.gha(this.HR);Sa.HGa(this.HR);Sa.xre(this.HR);Sa.JZa(this.HR);this.XU=!0}}gk(){if(this.XU){const Sa=this.$.xa;Sa.Eg(this.HR);Sa.dMd(this.HR);Sa.s7(this.HR);Sa.una(this.HR);Sa.vRa(this.HR);Sa.KVf(this.HR);Sa.hKb(this.HR);this.XU=!1}}}Object(u.a)(fb,"SheetDropdownMenu",Q.a,[377,2]);var Ka=a(354);class hb extends La{constructor(Sa,na,ib){super(document.createElement("a"),Sa,!0);this.ug=()=>{this.ES(!1);this.$.ea.jo(this.ug)};this.gd=Ib=>{this.qeg(Ib.tb);
return!0};this.onKeyDown=Ib=>13===Ib.Ca.keyCode||32===Ib.Ca.keyCode?(this.qeg(Ib.tb),!0):!1;this.Wsa=na.pb(this.domElement,G.a.instance.ga(513),0,S.a.zxh,G.a.instance.ga(513),Ea.a.K6h,this.disabled);this.domElement.classList.add(Z.Cxh);ib.appendChild(this.domElement);this.Jqh();this.xcj()}dispose(){this.cVj();super.dispose()}ES(Sa){super.ES(Sa||!this.$.ea.ala)}Jqh(){const Sa=this.$.ea;Sa.tg?this.ES(!1):Sa.Xk(this.ug)}qeg(Sa){this.disabled||(w.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${Ka.a[Sa]}`),
this.$.Ja.Lb(new Va.a(1243860697,Sa,this.$.Hc,30,null)))}xcj(){Fa.a.instance.sa(z.a.click,this.domElement,this.gd);V.KeyInputManager.instance.sa(z.a.Pb,this.domElement,this.onKeyDown)}cVj(){Fa.a.instance.Ba(z.a.click,this.domElement,this.gd);V.KeyInputManager.instance.Ba(z.a.Pb,this.domElement,this.onKeyDown)}}Object(u.a)(hb,"SheetDropdownMenuAnchor",La,[]);var fc=a(60);const dc=(Sa,na,ib,Ib,ec,qb,Ha,Ab=null)=>{Ab=Sa.Na(9,Ab);Ab.sheetName=na;Ab.newSheetIndex=ib;return fc.g(Sa,"ReorderSheets",Ab,Ib,
ec,qb,Ha,0)};var wb=a(173),Tb=a(128),xb=a(187),cb=a(132),jb=a(59),qa=a(209),za=a(199),Na=a(167),ua=a(133);class Xa{constructor(Sa,na,ib){this.ym=na;this.Lw=ib;this.sheet=Sa;this.altText=G.a.instance.ga(1988)}NK(){return this.sheet.active}ird(){return this.sheet.isLockPausedInSession}jta(){return this.ym?S.a.NSe:this.NK()?S.a.MSe:S.a.LSe}Goa(){return this.sheet.ji?Ea.a.kPf:Ea.a.QUj}kYd(){return 16}Xha(){return null}kta(){return this.ym?this.Lw?Z.PSe:Z.OSe:null}OZd(){return null}Us(){return null}ond(){return 0}EYc(){return!0}}
Object(u.a)(Xa,"LockPausedSheetIconDataSource",null,[391]);class ha{constructor(Sa,na,ib){this.ym=na;this.Lw=ib;this.sheet=Sa;this.altText=G.a.instance.ga(1987)}NK(){return this.sheet.active}ird(){return this.sheet.ji}jta(){return this.ym?S.a.NSe:this.NK()?S.a.MSe:S.a.LSe}Goa(){return Ea.a.kPf}kYd(){return 16}Xha(){return null}kta(){return this.ym?this.Lw?Z.PSe:Z.OSe:null}OZd(){return null}Us(){return null}ond(){return 0}EYc(){return!0}}Object(u.a)(ha,"LockedSheetIconDataSource",null,[391]);class ta{constructor(Sa,
na,ib,Ib){this.sheet=Sa;this.altText=G.a.instance.ga(1899);this.IQj=na;this.e8f=ib;this.Lw=Ib}NK(){return this.sheet.active}ird(){return this.sheet.Gd.Hv}Xha(){return this.Lw?this.NK()?Z.Lxh:Z.Nxh:this.NK()?Z.Kxh:Z.Mxh}jta(){return!this.NK()&&this.e8f()?S.a.yzh:S.a.xzh}Goa(){return!this.NK()&&this.e8f()?Ea.a.iBj:Ea.a.hBj}kYd(){return 14}kta(){return Z.wwh}OZd(){return this.sheet.Gd.Pnb}Us(){return this.IQj}ond(){return 8}EYc(){return!1}}Object(u.a)(ta,"NamedSeetViewSheetIconDataSource",null,[391]);
var wa=a(157),db=a(127);class Jb{constructor(Sa,na){this.Vqa=this.Y1=this.PBa=this.Hl=null;this.Pkf=!1;this.zTc=this.Goa=this.kta=this.Xha=this.jta=null;this.fO=()=>{this.dataSource.NK()&&f.TaskExtensions.za(this.IDb,()=>{dialogControls.renderToolTip(this.dataSource.Us(),"SheetIconTooltip",this.dataSource.OZd(),this.WI,10,!1,!1,1)},this.$.ka,3)};this.eO=()=>{this.dataSource.NK()&&this.clearToolTip()};this.$=Sa;this.dataSource=na;this.Lw=t.a.Rsd()}get Gc(){return this.Y1||(this.Y1=db.a.instance.$d(this.WI))}get IDb(){if(this.Vqa)return this.Vqa;
const Sa=new wa.a;this.$.ky(na=>{f.TaskExtensions.za(na.kwd(),()=>{Sa.setResult(!0)},this.$.ka,3)});return this.Vqa=Sa.task}get WI(){return this.zTc}Eig(){if(this.WI&&(this.Hl||this.PBa)){if(this.Lw){var Sa=this.dataSource.Goa();this.Goa!==Sa&&(this.PBa&&this.PBa.parentNode.removeChild(this.PBa),this.cff(),this.Goa=Sa)}else Sa=this.dataSource.jta(),this.jta!==Sa&&(this.gNd(this.Hl,this.jta,Sa),this.jta=Sa);Sa=this.dataSource.Xha();this.Xha!==Sa&&(this.Lw?this.yjj(this.PBa,this.Xha,Sa):this.gNd(this.Hl,
this.Xha,Sa),this.Xha=Sa);Sa=this.dataSource.kta();this.kta!==Sa&&(this.gNd(this.WI,this.kta,Sa),this.kta=Sa);this.dataSource.Us()&&!this.dataSource.NK()&&this.clearToolTip()}}RFj(Sa,na,ib){this.ngi(Sa,na,ib);la.DOMElementExtensions.setVisible(this.WI,this.dataSource.ird())}clearToolTip(){f.TaskExtensions.za(this.IDb,()=>{dialogControls.clearToolTip(this.dataSource.Us())},this.$.ka,3)}ngi(Sa,na,ib){this.WI&&this.Pkf!==Sa&&(this.WI.parentNode.removeChild(this.WI),this.kta=this.Xha=this.Goa=this.jta=
this.zTc=null,this.dataSource.Us()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.WI||(this.zTc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.WI,P.a.xia),Sys.UI.DomElement.addCssClass(this.WI,S.a.zt),v.EwaSettings.ma(494)?Sa===this.dataSource.EYc()?na.appendChild(this.WI):na.insertBefore(this.WI,ib):Sa?na.insertBefore(this.WI,ib):na.appendChild(this.WI),this.Lw?this.cff():(this.Hl=document.createElement("img"),this.Hl.tabIndex=-1,this.Hl.alt=this.dataSource.altText,
this.WI.appendChild(this.Hl),this.Hl.src=Ca.a.me(this.dataSource.ond())),this.dataSource.Us()&&(this.Gc.la("mouseover",this.fO,!0),this.Gc.la("mouseout",this.eO,!0)),this.Pkf=Sa)}yjj(Sa,na,ib){Sa&&(Sys.UI.DomElement.removeCssClass(Sa,na),Sys.UI.DomElement.addCssClass(Sa,ib))}gNd(Sa,na,ib){na&&Sys.UI.DomElement.removeCssClass(Sa,na);ib&&Sys.UI.DomElement.addCssClass(Sa,ib)}dispose(){A.a.Ia(this.Y1)}cff(){const Sa=this.$.da.Aa(388);Sa?(this.PBa=Sa.hka(this.dataSource.Goa(),this.dataSource.kYd()))?this.WI.appendChild(this.PBa):
w.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Goa()} was not found.`):w.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(u.a)(Jb,"SheetIcon",null,[2]);var Pb=a(355),eb=a(95),Ma=a(153);class ob extends eb.a{constructor(Sa,na){super(Sa.domElement);this.onKeyDown=ib=>{121===ib.keyCode&&ib.shiftKey&&!this.koa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.koa.anchor),
Ra.g(ib))};this.Pca=ib=>{if(!this.$.isEditMode||this.koa.disabled)return!0;this.rename(!1,ib.tb);return!0};this.$l=ib=>this.koa.disabled?!0:this.showContextMenu(ib.clientPoint,ib.tb,ib.Gb);this.yke=Sa;this.$=na;Fa.a.instance.sa(z.a.Dk,Sa.domElement,this.Pca);Pb.a.instance.sa(Sa.domElement,this.$l);this.Gc.la("keydown",this.onKeyDown)}get koa(){return this.yke}dispose(){this.koa&&(Fa.a.instance.Ba(z.a.Dk,this.koa.domElement,this.Pca),Pb.a.instance.Ba(this.koa.domElement,this.$l),this.yke=null);this.$=
null;super.dispose()}showContextMenu(Sa,na,ib){this.koa.activate(na,t.a.Dtd());na=new Va.a(-1075099431,na,this.$.Hc,30,null);let Ib;return!Ma.a(Ib=this.$.Ja.Lb(na,{[r.a.I6f]:Sa,[ob.$Aj]:this.koa.sheet,[r.a.J6f]:ib}))&&(6!==Ib.status||Ib.result)}rename(Sa,na){this.$.Xc(817296323,na,Sa?19:0,null)}}ob.$Aj="Sheet";Object(u.a)(ob,"SheetOpsSheetClickHelper",eb.a,[]);var Ia=a(41);class Da extends La{constructor(Sa,na,ib,Ib,ec,qb,Ha){super(document.createElement("li"),Sa);this.v3c=this.u3c=this.H6f=this.G6f=
0;this.X6c=.5;this.XU=this.GTd=!1;this.color=this.xJc=this.hF=this.aFb=this.bP=null;this.njc=this.Hjf=!1;this.a7b="#BEBBB8";this.UGc=null;this.onKeyDown=Ab=>13!==Ab.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Rz=Ab=>32!==Ab.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.fO=()=>{this.disabled||(this.sS.pXi(this),this.sS.RF||this.coa(!0,void 0,"OnMouseOver"))};this.eO=()=>{this.disabled||this.coa(!1,void 0,"OnMouseOut")};this.yGb=()=>{this.sS.RF||(this.sKj(),this.sheet.$0||
fa.h(this.$).PKb(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.L6=()=>{this.yPe(!1);return!1};this.gd=Ab=>{if(this.disabled)return!0;const Yb=fa.h(this.$);this.sheet.active||3!==Ab.tb?this.ym?this.activateSheet(Ab.tb):t.a.Dtd()&&Yb.focus():(!t.a.YNa(this.$)&&!this.pCb||Yb.eb||Yb.ri||Yb.Qtb(),this.activateSheet(Ab.tb));return 3!==Ab.tb};this.onPointerDown=Ab=>{if(this.disabled)return!0;this.yPe(!0);fa.h(this.$).inRangePicker&&w.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var Yb=3===Ab.tb;if(2===Ab.tb||Yb&&this.Ixa)this.ym?(this.coa(!0,!Yb,"OnPointerDown"),Yb=h.Task.delay(Yb?this.H6f:this.G6f).jp(()=>!0)):Yb=this.activateSheet(Ab.tb),this.IBb&&(this.njc=!0,this.sS.svc=f.TaskExtensions.za(Yb,()=>{this.njc&&this.sS.rXi(this,Ab)},this.ka,11));return!1};this.Rf=Ab=>{if(this.disabled||!this.IBb&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;const Yb=this.sS.RF&&!t.a.$jf();this.njc=!1;this.ym&&this.coa(2===Ab.tb,void 0,"OnPointerUp");
this.sS.svc&&(f.TaskExtensions.za(this.sS.svc,()=>{this.sS.qXi(this)},this.ka,11),this.sS.svc=null);return Yb};this.jO=()=>{this.njc=!1;this.GTd||this.coa(!1,void 0,"OnTouchMove");return!1};this.oDe=new ob(this,Sa);this.ym=qb;this.Lw=Ha;this.pCb=t.a.pCb(Sa);this.eqd=v.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.Lw;this.ym?(this.G6f=Sa.va.SheetDragReorderDelayInMilliseconds,this.H6f=Sa.va.SheetDragReorderDelayInMillisecondsForTouch,this.u3c=18,this.v3c=20):(this.u3c=
19,this.v3c=22);this.$=Sa;this.jYb=Ib;this.sS=ec;this.IBb=ec.tte();this.Kfh();this.F$g();this.Omd=Sa.Kb.Qg("UserAction",this.name);this.hrd=!1;la.DOMElementExtensions.Pu(this.domElement,r.a.ds,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.hF);this.ioa=new xb.a;Sa=new ha(this.sheet,this.ym,this.Lw);this.ioa.add(new Jb(this.$,Sa));this.$.ea.iNb&&(Sa=new Xa(this.sheet,this.ym,this.Lw),this.ioa.add(new Jb(this.$,Sa)));this.eqd||(Sa=new ta(this.sheet,this.sS.Zyc,()=>
this.color?Da.PUd(this.color):!1,this.Lw),this.aFb=new Jb(this.$,Sa),this.ioa.add(this.aFb));this.Ixa=this.sS.Ixa;this.Mgb();this.Ndj();this.uye=new ea.a(this.domElement,1);na.insertBefore(this.domElement,ib);ba.a(this.$)&&this.yjg(!0)}get kjh(){return this.xJc||(this.xJc=za.a.rp("#F5F5F5"))}get name(){return this.bP.innerText}set name(Sa){this.bP&&(this.bP.innerText=Sa,this.zDc(),this.zjg())}get sheet(){return this.jYb}get anchor(){return this.UGc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Sa){this.anchor.tabIndex=
Sa}$Th(){return la.DOMElementExtensions.Hf(this.anchor)?this.anchor:null}dispose(){if(this.XU){I.a.instance.Ba(z.a.pointerDown,this.domElement,this.onPointerDown);V.KeyInputManager.instance.Ba(z.a.Pb,this.domElement,this.onKeyDown);V.KeyInputManager.instance.Ba(z.a.Gp,this.domElement,this.Rz);Fa.a.instance.Ba(z.a.click,this.domElement,this.gd);I.a.instance.Ba(z.a.wW,this.domElement,this.yGb);I.a.instance.Ba(z.a.Fy,this.domElement,this.L6);if(this.IBb||v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))I.a.instance.Ba(z.a.Sf,
this.domElement,this.Rf),this.Ixa&&(L.a.instance.Ba(z.a.xe,this.domElement,this.Rf),L.a.instance.Ba(z.a.$f,this.domElement,this.jO));this.XU=!1;this.a7b="#BEBBB8"}A.a.rc([this.oDe,this.uye]);this.bP=this.hF=this.UGc=this.sS=this.uye=this.oDe=null;if(this.ioa){for(let Sa of this.ioa)Sa.dispose();this.ioa=null}this.color=this.jYb=null;super.dispose()}ES(Sa){Sa&&this.coa(!1,!1);super.ES(Sa)}wVd(Sa){if(jb.a.Bg.iR){this.CMe();var na=e.GetServiceTaskFactory.Oa(this.$.da,322,323,1);f.TaskExtensions.za(na,
ib=>{wb.UISurfaces.NH().then(Ib=>{const ec=ib.result;ec.hxj(Ib);ec.show(Sa);return null},Ib=>{w.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Ib}`);return null})},this.ka,3)}}aqe(){if(this.sheet.active&&this.$.vr){var Sa=this.$.vr,na=fa.h(this.$),ib=na.Dj;if(this.sheet.Gd.Hv){if(!this.aFb){var Ib=new ta(this.sheet,this.sS.Zyc,()=>this.color?Da.PUd(this.color):!1,this.Lw);this.aFb=new Jb(this.$,Ib);this.ioa.add(this.aFb)}ib&&na.Cgb(1);
Sa.classList.add(S.a.jVe);Sa=Da.Hhd(r.a.Ewf);na=Da.Hhd(r.a.nAd);ib=Da.Hhd(r.a.vwf);Ib=this.sheet.Gd.BUd;this.sheet.Gd.BUd=!1;"true"===ib&&Ib&&this.$.ea.EUd?(Tb.a.Qu(r.a.vwf,"false",Tb.a.bW),this.$.ea.EUd=!1,this.wVd(3)):"true"===Sa&&"true"===na&&"true"===ib?this.$.ea.FUd&&this.$.ea.DNb&&(this.sheet.Gd.fI?(Sa=1,Tb.a.Qu(r.a.nAd,"false",Tb.a.bW),this.$.ea.DNb=!1):Sa=0,Tb.a.Qu(r.a.Ewf,"false",Tb.a.bW),this.$.ea.FUd=!1,this.wVd(Sa)):this.sheet.Gd.fI&&"true"===na&&"true"===ib&&this.$.ea.DNb&&(Tb.a.Qu(r.a.nAd,
"false",Tb.a.bW),this.$.ea.DNb=!1,this.wVd(2))}else this.CMe(),ib&&na.Cgb(0),Sa.classList.remove(S.a.jVe)}}CMe(){const Sa=this.$.da.Aa(322);Sa&&Sa.dismiss()}Mgb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.Q7a()?Z.eNj:Z.mNj;v.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.bP.parentNode.classList.add(Z.hxi):this.bP.parentNode.classList.add(Z.ixi);this.zjg();this.eqd&&this.aqe();this.SFj();this.Gjg();this.zDc();this.eqd||this.aqe()}oXi(){this.GTd=
!0;this.coa(!0,!0,"OnSheetReorderStarted")}nXi(){this.GTd=!1;this.coa(!1,void 0,"OnSheetReorderEnded")}activate(Sa=0,na=!1){this.U3b()||(this.sheet.activate(),na&&fa.h(this.$).focus(),Sa={["InputMethod"]:Ka.a[Sa],["AppMode"]:this.$.Hc,["Location"]:"canvas"},ua.b(this.$).ud(cb.a.WAj,Sa))}yjg(Sa){this.a7b=Sa?"#797775":"#BEBBB8";this.X6c=Sa?-.5:.5;this.xJc=Sa?za.a.rp("#3B3A39"):za.a.rp("#F5F5F5");this.Gjg()}Ztj(Sa){this.IBb=Sa}QCd(Sa){Sa.n4c();this.HBe(Sa)}HBe(Sa){Sa.q1a();this.sheet.activate()}fGg(Sa){Sa=
new Va.a(-1876836819,Sa,this.$.Hc,30,null);return this.$.Ja.Lb(Sa,{[r.a.ITd]:this.sheet.name})}zjg(){this.bP.parentNode.setAttribute("sheet-title",this.bP.innerText)}zDc(){const Sa=this.CNh();this.anchor.setAttribute(r.a.mv,Sa);this.anchor.setAttribute(r.a.sha,this.sheet.active.toString())}CNh(){const Sa=this.sheet.Gd.Hv,na=this.sheet.Gd.Pnb,ib=this.sheet.ji,Ib=this.sheet.isLockPausedInSession;return Sa&&ib?String.format(G.a.instance.mb(20),this.name,na):Sa&&Ib?String.format(G.a.instance.mb(22),this.name,
na):Sa?String.format(G.a.instance.mb(19),this.name,na):ib?String.format(G.a.instance.mb(18),this.name):Ib?String.format(G.a.instance.mb(21),this.name):this.name}activateSheet(Sa=0){if(t.a.Dtd()){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.U3b())return h.Task.Ta(!1);Na.a.current.kS="ActivateSheet";this.sheet.activate();return h.Task.Ta(!0)}return this.fGg(Sa)}Gjg(){const Sa=this.sheet.tabColor;this.color=Sa?za.a.rp(Sa):this.kjh;this.Hjf=Da.PUd(this.color);
this.coa(!1,void 0,"UpdateTabColor")}coa(Sa,na=!1,ib=null){if(this.sheet){ib=this.sheet.active;var Ib=this.Q7a(),ec=!!this.sheet.tabColor,qb=za.a.BG(ib||Ib?qa.a.white:this.color);this.hF.style.background="";ib||Ib?(ec?v.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.qMa?this.Zyj():this.ym?this.Yyj():this.Xyj():this.ym||(this.hF.style.backgroundColor=qb),this.hF.style.height=this.u3c.toString()+"px"):(this.hF.style.filter="",this.hF.style.backgroundColor=
qb,this.hF.style.height=this.v3c.toString()+"px");this.bP.className=ib?Z.fNj:Ib?Z.dark:this.Hjf?Z.light:Z.dark;for(let Ha of this.ioa)Ha.Eig();this.ym&&(Sa&&!ec&&(this.hF.style.backgroundColor="#E1DFDD"),la.DOMElementExtensions.toggleCssClass(this.domElement,Z.lNj,Sa),na?(ec||(this.hF.style.backgroundColor=this.a7b),this.domElement.style.backgroundColor=this.a7b):(ec||(this.hF.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.bP.style.fontWeight=ib||Ib||!this.ym&&Sa?this.ym?
"600":"bold":""}else w.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${ib}`)}Yyj(){const Sa=this.hF.style,na=za.a.BG(Da.K1c(this.color,this.X6c));Sa.background=na}Xyj(){const Sa=this.hF.style,na=za.a.BG(Da.K1c(this.color,1)),ib=za.a.BG(Da.K1c(this.color,this.X6c));Sa.background=`$linear-gradient(${na}, ${ib})`}Zyj(){this.hF.style.background="transparent"}F$g(){this.UGc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=Z.gNj;la.DOMElementExtensions.Pu(this.anchor,r.a.Apb,null,null);this.tabIndex=-1}Kfh(){this.hF=document.createElement("span");this.hF.className=Z.jNj;this.bP=document.createElement("span");this.bP.className=Z.oNj;this.bP.dir=this.sheet.rtlName?"rtl":"ltr";this.hF.appendChild(this.bP)}SFj(){const Sa=this.$.EJ;for(let na of this.ioa)na.RFj(Sa,this.hF,this.bP)}Q7a(){return fa.h(this.$).Q7a(this.sheet)}sKj(){this.Omd.start();this.hrd=!0}yPe(Sa){this.hrd&&
(this.Omd.stop(),w.ULS.sendTraceTag(537153686,0,50,Ia.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Omd.Ac,["Has been clicked"]:Sa})),this.hrd=!1)}Ndj(){I.a.instance.sa(z.a.pointerDown,this.domElement,this.onPointerDown);V.KeyInputManager.instance.sa(z.a.Pb,this.domElement,this.onKeyDown);V.KeyInputManager.instance.sa(z.a.Gp,this.domElement,this.Rz);this.Gc.la("mouseover",this.fO);this.Gc.la("mouseout",this.eO);I.a.instance.sa(z.a.wW,this.domElement,
this.yGb);I.a.instance.sa(z.a.Fy,this.domElement,this.L6);if(this.IBb||v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))I.a.instance.sa(z.a.Sf,this.domElement,this.Rf),this.Ixa&&(L.a.instance.sa(z.a.xe,this.domElement,this.Rf),L.a.instance.sa(z.a.$f,this.domElement,this.jO));Fa.a.instance.sa(z.a.click,this.domElement,this.gd);this.XU=!0}U3b(){const Sa=this.$.da.Aa(65);return Sa&&Sa.bla()?(Sa.Iwc(),this.HBe(Sa),!0):!1}static Hhd(Sa){let na=Tb.a.get(Sa);na||(Tb.a.Qu(Sa,
"true",Tb.a.bW),na=Tb.a.get(Sa));return na}static K1c(Sa,na){if(1<na||-1>na)return Sa;let ib=Sa.r,Ib=Sa.g;Sa=Sa.b;0<na?(ib=ib*(1-na)+255*na,Ib=Ib*(1-na)+255*na,Sa=Sa*(1-na)+255*na):(ib*=1+na,Ib*=1+na,Sa*=1+na);return qa.a.jwb(Math.round(ib),Math.round(Ib),Math.round(Sa))}static PUd(Sa){return 128>=(222*Sa.r+707*Sa.g+71*Sa.b)/1E3}}Object(u.a)(Da,"SheetTabButton",La,[]);class nb extends La{constructor(Sa,na,ib){super(document.createElement("a"),na);this.Jha=v.EwaSettings.ma(494)?S.a.Lad:S.a.Syh;ib.pb(this.domElement,
G.a.instance.ga(713),0,this.Jha,G.a.instance.ga(713),Ea.a.X3c,!0);Sa.appendChild(this.domElement);this.Gc.la("contextmenu",Ib=>{Ra.g(Ib)})}}Object(u.a)(nb,"WorkbookProtectionButton",La,[]);var Ua=a(51),W=a(42),sa=a(57);class vb extends Q.a{constructor(Sa,na,ib=null,Ib=null){super(na);this.sheetTabActivatePreviousHidden=G.a.instance.ga(722);this.sheetTabActivateNextHidden=G.a.instance.ga(724);this.svgIconProvider=null;this.zh=[];this.cL=Array(6);this.yAd=Array(6);this.dTa=this.Vzb=this.UH=this.bzc=
this.reb=this.dzc=this.NTd=this.hl=null;this.isRtl=!1;this.RK=this.vv=0;this.P8b=this.rvc=!1;this.csc=this.Mna=0;this.ZM=this.f4=this.qaa=this.Z8b=null;this.nec=this.tD=0;this.TOb=null;this.MCb=-1;this.pZ=null;this.crc=0;this.MAc=-1;this.fna=0;this.mua=new M;this.ANc=!1;this.svc=this.ezc=this.kNb=this.uke=this.a0=null;this.zce=!1;this.Knd=null;this.Pzd=!1;this.htmlSanitizationHelper=this.tke=null;this.ND=(ec,qb)=>{this.kIf(qb.item)};this.uza=(ec,qb)=>{ec=this.$.xa.oa.index;for(let Ha=0,Ab=this.zh.length;Ha<
Ab;Ha++){const Yb=this.RQ(Ha);if(Yb.name===qb.oldName){Yb.name=qb.newName;this.y0();Ha===ec&&this.L0(6);break}}};this.oIf=(ec,qb)=>{(ec=this.M3a(qb.item))&&ec.Mgb()};this.pIf=(ec,qb)=>{qb.visible?(this.VSa(!1),this.lIf(qb.item)):this.kIf(qb.item)};this.$N=ec=>{this.RF?(this.pZ=ec,this.uQb()):(this.pZ&&(this.csc+=this.pZ.clientPoint.x-ec.clientPoint.x),this.pZ=ec,Math.abs(this.csc)>=this.yoh&&this.uQb());return!0};this.jO=ec=>{ec.Ca.preventDefault();return!1};this.X0f=ec=>{this.T0f(ec,!0)};this.W0f=
ec=>{this.T0f(ec,!1)};this.I6=ec=>{if(this.RF&&(this.Hz||this.bmf(ec)))if(this.P8b=this.dif(ec),this.Hz){let qb;ec=(qb=this.RQ(this.tD+1))?qb.sheet:null;this.reorderSheets(ec,this.tD+1===this.LTd,!0)}else ec=this.Pzd?null:this.Knd,this.reorderSheets(ec,this.Pzd,!0);this.yQ();return!0};this.Gh=(ec,qb)=>{qb.UD&&this.E1d(qb.UD);this.eyc(!1);this.y0();qb.oa&&(this.E1d(qb.oa),this.L0(6),this.ea.Lma())};this.Qyf=(ec,qb)=>{this.rEc(qb.item)};this.Ryf=(ec,qb)=>{this.rEc(qb.item)};this.Syf=(ec,qb)=>{this.rEc(qb.item)};
this.JPa=(ec,qb)=>{this.rEc(qb.item)};this.bza=()=>{this.L2c()};this.ed=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.L2c();this.G6c();v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(sa.d(this.$)||sa.e(this.$))&&(W.PageLoadTrackingInfo.instance.aS(r.a.qBa,["sheetTabBar"]),W.PageLoadTrackingInfo.instance.WW(r.a.qBa,["sheetTabBar"]));this.o6c();this.y0();this.VSa(!0);this.L0(6)};this.gj=()=>{this.isVisible&&(this.y0(),this.L0(6))};this.Bf=()=>{Object(H.a)(ca,
this.UH)===X.k(this.$.lg)&&this.o6c();for(const ec of this.zh)ec.Ztj(!X.k(this.$.lg))};this.nIf=(ec,qb)=>{this.ojj(qb.item,qb.isUserOperation)};this.QGb=(ec,qb)=>{this.lIf(qb.item)};this.onKeyDown=ec=>{switch(ec.keyCode){case 9:var qb=this.domElement.querySelectorAll(la.DOMElementExtensions.Gr);const Ha=la.DOMElementExtensions.um(qb);qb=la.DOMElementExtensions.oB(qb);la.DOMElementExtensions.hBa(ec,Ha,qb);break;case 39:case 37:la.DOMElementExtensions.W3f(ec,this.domElement.querySelectorAll(la.DOMElementExtensions.Gr),
39===ec.keyCode?!this.isRtl:this.isRtl)}w.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${ec.keyCode}`)};this.onScroll=()=>{this.hl.scrollLeft!==this.Mna&&this.QOj()};this.hO=ec=>{if(ec.ctrlKey||ec.B3)return!1;this.hl.scrollLeft+=Math.floor(30*ec.VCa);if(this.Hz&&this.RF){const qb=this.i3e("OnMouseWheel");qb&&this.nYd(0<ec.VCa,qb.x+qb.width/2)}return!0};this.bG=(ec,qb)=>{if(this.mua)this.O$e("PartialInteractivity",qb.uM?3:0);else{this.yQ(!1);this.nSd(qb.uM);for(const Ha of this.qxe)Ha&&
Ha.ES(qb.uM);for(const Ha of this.zh)Ha&&Ha.ES(qb.uM)}};this.bGb=(ec,qb)=>{ec=0;qb.noe&&(ec=2|(qb.aBj?1:0));this.O$e("ComponentRangePicker",ec)};this.$=Sa;this.ea=this.$.ea;this.g9b=(this.Hz=t.a.$jf())&&!v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.ym=v.EwaSettings.ma(494);this.Lw=t.a.Rsd();this.Zlf=this.ym&&!this.$.Jw;this.Hz&&(this.zce=this.ym&&!C.a.Iw);this.THi=this.$.va.SheetTabNavigateButtonLongKeyPressPeriodMS;this.SHi=this.$.va.SheetTabNavigateButtonIntervalPeriodMS;
this.yoh=this.$.va.SheetTabDragStartPixelThreshold;this.tQa=this.uQa=-1;this.L4c=!1;this.htmlSanitizationHelper=Ib;this.Lw&&(this.svgIconProvider=ib);this.LC=new ea.a(this.domElement,3);this.ym&&this.domElement.classList.add(Z.Wxh);this.sdh();this.Uah();this.tdh();v.EwaSettings.FN()&&document.getElementById(r.a.nba)||this.yeh();this.eyc(!0);this.ed(null,null);Sa=this.$.xa;Sa.Xf(this.Gh);Sa.aXc(this.bza);Sa.JY(this.ND);Sa.gha(this.QGb);Sa.HGa(this.uza);Sa.xre(this.nIf);Sa.JZa(this.pIf);Sa.YLg(this.oIf);
Sa.lXc(this.Qyf);Sa.ure(this.Ryf);Sa.vre(this.Syf);Sa.wre(this.JPa);this.$.ll(this.ed);this.$.QA(this.gj);ja.a(this.$).di(this);this.$.da.Ga(32,this);v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.nu(this.Bf);this.czc=this.Ce.$d(this.domElement);this.czc.la("keydown",this.onKeyDown);Pa.a(this.$).oq()&&this.bG(null,new ka.a(!0));Pa.a(this.$).Zf.c$(this.bG);fa.h(this.$).Uqe(this.bGb);this.czc.la("mousedown",ec=>{ec.preventDefault()});B.a.instance.sa(z.a.GD,
this.domElement,this.hO);this.MTd=this.Ce.$d(this.hl);this.MTd.la("scroll",this.onScroll);this.QOj=lb.a(()=>{this.y0()},200,this.$.ka,N.a.fBj,!0);this.$.wD(r.a.YHj);this.Zlf&&(this.tke=new fb(this.$,this.dTa.domElement));v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&W.PageLoadTrackingInfo.instance.C0(r.a.qBa,["sheetTabBar"])}get mc(){return this.domElement}get Hf(){return this.isVisible}get de(){return va.a.KTd}get RF(){return this.ANc}get LTd(){return this.zh.length}get Zyc(){return this.uke}get Ixa(){return this.zce}get navigationButtonsDisabled(){return!!this.mua&&
this.mua.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.mua&&this.mua.operationButtonsDisabled}get xAd(){return this.ym?this.$.EJ?[S.a.h$b,S.a.SSe,S.a.USe,S.a.g$b,S.a.Uua,S.a.Uua]:[S.a.g$b,S.a.USe,S.a.SSe,S.a.h$b,S.a.Uua,S.a.Uua]:this.$.EJ?[S.a.h$b,S.a.RSe,S.a.TSe,S.a.g$b,S.a.Uua,S.a.Uua]:[S.a.g$b,S.a.TSe,S.a.RSe,S.a.h$b,S.a.Uua,S.a.Uua]}get zAd(){return this.$.EJ?[null,Ea.a.fFe,Ea.a.dFe]:[null,Ea.a.dFe,Ea.a.fFe]}get ONf(){return this.$.EJ?[null,Ea.a.gFe,Ea.a.eFe]:[null,Ea.a.eFe,
Ea.a.gFe]}get sDb(){if(this.isRtl){if(C.a.SF)return 0;if(C.a.Jf)return-1*(this.hl.scrollWidth-this.hl.clientWidth);if(C.a.Iw)return this.hl.scrollWidth-this.hl.clientWidth;w.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get iLb(){if(this.isRtl){if(C.a.SF)return this.hl.scrollWidth-this.hl.clientWidth;if(C.a.Jf||C.a.Iw)return 0;w.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.hl.scrollWidth-
this.hl.clientWidth}get qxe(){return this.mua?[this.UH,this.Vzb]:[this.UH,this.Vzb,this.dTa]}get nNj(){return this.zh.concat(this.dTa)}get ZAj(){return this.tke}pb(Sa,na,ib,Ib,ec,qb,Ha=!1){Sa.removeAttribute("Href");Sa.setAttribute(r.a.Ld,r.a.pt);Sa.className=Z.Jxh;Sa.title=na;Sa.tabIndex=0;this.Lw&&qb?ib=this.svgIconProvider.zba(qb,12,12,Sa,24,24):(na=document.createElement("span"),na.className=this.ym?S.a.p4g:S.a.zt,na.classList.add(P.a.xia),na.tabIndex=-1,Sa.appendChild(na),qb=document.createElement("img"),
qb.src=Ca.a.me(ib),qb.className=Ib,qb.alt=ec,qb.tabIndex=-1,na.appendChild(qb),ib=qb);Ha&&Sa.classList.add(P.a.wU);return ib}dispose(){if(this.$){var Sa=this.$.xa;Sa.Eg(this.Gh);Sa.dMd(this.bza);Sa.s7(this.ND);Sa.una(this.QGb);Sa.vRa(this.uza);Sa.KVf(this.nIf);Sa.hKb(this.pIf);Sa.ghj(this.oIf);Sa.pMd(this.Qyf);Sa.HVf(this.Ryf);Sa.IVf(this.Syf);Sa.JVf(this.JPa);this.$.Kl(this.ed);this.$.aE(this.gj);Pa.a(this.$)&&Pa.a(this.$).Zf.Lda(this.bG);this.mua&&fa.h(this.$).lVf(this.bGb);B.a.instance.Ba(z.a.GD,
this.domElement,this.hO)}A.a.rc(this.yAd);this.yAd=null;if(this.cL)for(Sa=0;Sa<this.cL.length;Sa++){const na=la.DOMElementExtensions.vK(this.cL[Sa],this.domElement,!1,"a");na&&E.a.nna(na)}A.a.Ia(this.LC);A.a.Ia(this.czc);A.a.Ia(this.MTd);this.MTd=this.czc=this.Vzb=this.UH=this.LC=null;this.$&&this.Hz&&this.yQ(!1);this.qaa=null;this.ERd(null,"Dispose");this.TOb=this.ZM=this.Z8b=null;this.L2c();this.reb=this.dzc=this.NTd=this.hl=this.cL=this.$=this.ea=null;super.dispose()}kg(Sa,na){if(!na){w.ULS.shipAssertTag(537153760,
0,0<this.zh.length,"There is no sheet tab button.");if(!this.zh.length)return!1;Sa=null;for(const ib of this.zh)if(Sa=ib.$Th())break;if(!Sa)return w.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;la.DOMElementExtensions.setFocus(Sa)}return!na}mh(Sa){return la.DOMElementExtensions.Af(this.mc,Sa)}sj(){}dk(){}reorderSheets(Sa,na,ib){if(this.a0&&this.a0!==Sa){const Ib=this.a0.index;this.njj(this.a0,Sa,na);Sa=Sa?Sa.index-1:na?this.$.xa.count-1:0;Ib!==Sa&&(this.zBi(Ib,Sa,ib),
this.mrh(this.a0.name,Sa))}}W4h(Sa){Sa=this.lja(Sa);return-1!==Sa&&this.vv<=Sa&&Sa<=this.RK?this.zh[Sa].domElement:null}wZj(Sa){if(this.Lw){for(var na=0;na<this.cL.length;na++){const ib=this.cL[na];if(ib&&this.svgIconProvider){const Ib=ib.parentNode;this.NUf(ib);Ib&&(this.cL[na]=this.svgIconProvider.zba(Sa?this.ONf[na]:this.zAd[na],12,12,Ib,24,24))}}for(na=0;na<this.zh.length;na++)this.zh[na].yjg(Sa);this.dTa&&this.dTa.Wsa&&this.xjg(Ea.a.L6h,this.dTa,Sa);this.UH&&this.UH.Wsa&&this.xjg(Ea.a.s6g,this.UH,
Sa)}}xjg(Sa,na,ib){na.sbb||(na.sbb=this.svgIconProvider.zba(Sa,12,12,na.Wsa.parentNode,24,24));na.sbb&&(la.DOMElementExtensions.setVisible(na.Wsa,!ib),la.DOMElementExtensions.setVisible(na.sbb,ib))}rXi(Sa,na){var ib=fa.h(this.$);const Ib=ib.inRangePicker,ec=Aa.HelperMethods.Do(na);if(ib.eb&&!Ib){const qb=ib.Ul?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Ha=void 0;v.EwaSettings.T7a&&(Ha=[Object(Oa.a)(ib.fc.textBox.WBa)]);Oa.b(this.$).kCa(ec.rawEvent,qb,Ha);ib.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}ib=this.Ixa&&3===na.tb;!(2===na.tb&&ec.button===Sys.UI.MouseButton.leftButton||ib)||Ib||this.RF||Pa.a(this.$).oq()||(ib&&Sa.oXi(),this.MCb=na.clientPoint.x,this.pZ=na,this.vUg(Sa))}pXi(Sa){!this.Hz&&this.RF&&this.FVd(Sa.sheet,!1)}qXi(Sa){this.Hz||(this.RF&&this.reorderSheets(Sa.sheet,!1,!0),this.yQ());this.y0()}tte(){return this.$.isEditMode&&!X.k(this.$.lg)}y0(){const Sa=Aa.HelperMethods.t6(()=>{this.tXj();this.ym&&this.zyj();this.nSd()});w.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Sa}`)}zyj(){const Sa=this.RK===this.zh.length-1;la.DOMElementExtensions.toggleCssClass(this.reb,this.$.EJ?Z.VSe:Z.KSe,!!this.vv);la.DOMElementExtensions.toggleCssClass(this.reb,this.$.EJ?Z.KSe:Z.VSe,!Sa)}nSd(Sa=!1){const na=!this.vv,ib=this.RK===this.zh.length-1;this.D4f(4,this.sheetTabActivatePreviousHidden,!na);this.D4f(5,this.sheetTabActivateNextHidden,!ib);this.tyc(0,na||Sa);this.tyc(1,na||Sa);this.tyc(2,ib||Sa);this.tyc(3,
ib||Sa)}D4f(Sa,na,ib){if(Sa=this.cL[Sa]){la.DOMElementExtensions.setVisible(Sa,ib);var Ib=this.Q4e(Sa);Ib.title="img"===Sa.nodeName?Sa.alt=0<this.zh.length&&ib?na:"":Sa.title=0<this.zh.length&&ib?na:"";Ib.tabIndex=ib?0:-1}}Q4e(Sa){return this.Lw?Sa.parentNode:Sa.parentNode.parentNode}tyc(Sa,na){if(Sa=this.cL[Sa])Sa=this.Q4e(Sa),void 0!==Sa&&null!==Sa&&(!this.zh.length||na?(Sa.classList.add(P.a.wU),Sa.setAttribute(r.a.Isa,"true")):(Sa.classList.remove(P.a.wU),Sa.setAttribute(r.a.Isa,"false")))}VSa(Sa){const na=
this.$.EJ?this.zh.length-1:0;let ib=this.n7e(this.$.EJ?0:this.zh.length-1);ib&&(ib.borderRightWidth=Sa?"1px":"0");this.vv!==this.RK&&(ib=this.n7e(na))&&(ib.borderRightWidth="0")}nqe(Sa,na){this.zh||(this.zh=[]);-1===na?this.zh.push(Sa):this.zh.splice(na,0,Sa)}u6b(Sa,na){let ib=-1,Ib=null;na||(ib=this.bYh(Sa.index),-1!==ib&&(Ib=this.ELa(ib)));Sa=new Da(this.$,this.hl,Ib,Sa,this,this.ym,this.Lw);this.nqe(Sa,ib);la.DOMElementExtensions.setVisible(Sa.domElement,!0)}FVd(Sa,na){var ib=this.M3a(Sa);if(ib){this.Knd=
Sa;this.Pzd=na;Sa=ib.domElement;ib=this.isRtl?Sa.offsetLeft+(this.hl.scrollWidth-this.hl.clientWidth-this.hl.scrollLeft):Sa.offsetLeft-this.hl.scrollLeft;if(!this.isRtl&&na||this.isRtl&&!na)ib+=Sa.offsetWidth;this.bzc.style.left=Aa.HelperMethods.uc(ib-4);la.DOMElementExtensions.setVisible(this.bzc,!0)}}acf(){la.DOMElementExtensions.setVisible(this.bzc,!1)}L0(Sa){const na=Aa.HelperMethods.t6(()=>{switch(Sa){case 0:this.Xwc(0);break;case 1:this.Xwc(this.vv-1);break;case 2:this.Xwc(this.vv+1);break;
case 3:this.scrollIntoView(this.zh.length-1);break;case 4:this.vv&&1<=this.zh.length&&(this.Xne(this.vv-1),this.bQd());break;case 5:this.RK!==this.zh.length-1&&1<=this.zh.length&&(this.Xne(this.RK+1),this.bQd());break;case 6:this.bQd()}});this.g9b&&this.RF&&this.uQb();w.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Sa}, duration = ${na}`)}Xne(Sa){(Sa=this.RQ(Sa))&&Sa.activate()}AGh(Sa){if(0===Sa.VB){const na=this.$.xa;let ib=0;for(let Ib=0,ec=na.count;Ib<ec;Ib++){const qb=
Object(D.a)(da.a,na.getItem(Ib));if(qb===Sa)return ib;0===qb.VB&&ib++}}return-1}nGh(Sa){const na=this.$.xa;for(let ib=Sa.index+1,Ib=na.count;ib<Ib;ib++)if(Sa=Object(D.a)(da.a,na.getItem(ib)),0===Sa.VB)return Sa;return null}lja(Sa){for(let na=0;na<this.zh.length;na++){const ib=this.RQ(na);if(!ib)w.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${na}] is null even though index is not out of bounds!`);else if(ib.sheet===Sa)return na}return-1}M3a(Sa){Sa=
this.lja(Sa);return this.RQ(Sa)}zBi(Sa,na,ib){const Ib={};Ib.a=this.$.va.UserSessionId;Ib.b=ib;Ib.c=this.P8b;Ib.d=Sa;Ib.e=na;Ib.f=this.$.xa.count;Ua.b().Qe(2,Ib,ib)}njj(Sa,na,ib){const Ib=Object(D.a)(aa.a,this.$.xa);na?(na=na.index,na=Sa.index<na?na-1:na):na=ib?Ib.count-1:0;Ib.reorderSheet(Sa,na,!0)}a4f(Sa){fa.h(this.$).yf.gm(Sa)}vUg(Sa){if(!this.rvc){const na=this.domElement.ownerDocument.body;this.Hz?(I.a.instance.sa(z.a.Kj,document.documentElement,this.$N),this.Ixa&&(L.a.instance.sa(z.a.$f,document.documentElement,
this.$N),L.a.instance.sa(z.a.$f,this.domElement,this.jO))):(I.a.instance.sa(z.a.Kj,na,this.$N),L.a.instance.sa(z.a.$f,na,this.$N));I.a.instance.sa(z.a.Sf,document.documentElement,this.I6);L.a.instance.sa(z.a.xe,na,this.I6);this.rvc=!0}this.a0=Sa.sheet;this.P8b=!1;this.Hz?(this.ZM=null,this.Z8b=Sa,this.qaa=Sa.domElement,this.ERd(la.DOMElementExtensions.getBoundingClientRect(this.qaa),"BeginSheetTabButtonDrag")):(w.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(Z.JSe),this.domElement.style.cursor="",this.a4f("pointer"))}yQ(Sa=!0){if(this.rvc){this.a4f(r.a.SQ);const na=this.domElement.ownerDocument.body;this.Hz?(I.a.instance.Ba(z.a.Kj,document.documentElement,this.$N),this.Ixa&&(L.a.instance.Ba(z.a.$f,document.documentElement,this.$N),L.a.instance.Ba(z.a.$f,this.domElement,this.jO))):(I.a.instance.Ba(z.a.Kj,na,this.$N),L.a.instance.Ba(z.a.$f,na,this.$N));I.a.instance.Ba(z.a.Sf,document.documentElement,this.I6);L.a.instance.Ba(z.a.xe,
na,this.I6);this.ANc=this.rvc=!1}this.csc=0;this.P8b=!1;this.Knd=this.a0=null;this.Hz?(this.qaa&&(this.qaa.style.visibility="visible",this.qaa=null),this.Z8b=null,this.ERd(null,"EndSheetTabButtonDrag"),this.ZM&&(this.ZM.parentNode&&this.ZM.parentNode.removeChild(this.ZM),this.ZM=null),this.Alj(Sa)):(this.domElement.classList.remove(Z.JSe),this.acf())}Alj(Sa){this.xXd(Sa);this.tD=this.MCb=-1}mrh(Sa,na){const ib=this.$.pa,Ib=ib?ib.ya:null;this.$.userOperationManager.Ic(new Y.a(557,0,(ec,qb,Ha)=>dc(Ib,
Sa,na,ec,qb,Ha,null),64,()=>new Qa(Sa,na)),null)}RQ(Sa){return 0<=Sa&&Sa<this.zh.length?this.zh[Sa]:null}m7e(Sa){return(Sa=this.RQ(Sa))?Sa.sheet:null}ELa(Sa){return(Sa=this.RQ(Sa))?Sa.domElement:null}n7e(Sa){return(Sa=this.ELa(Sa))?Sa.style:null}bYh(Sa){const na=this.$.xa;Sa+=1;let ib=-1;const Ib=this.zh?this.zh.length:0;for(;Sa<na.count;){const ec=Object(D.a)(da.a,na.getItem(Sa));if(0===ec.VB){for(ib=0;ib<Ib&&this.m7e(ib)!==ec;ib++);break}Sa++}return-1===ib||ib===Ib?-1:ib}kIf(Sa){var na=this.M3a(Sa);
na&&(this.Hz&&this.RF&&(w.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.yQ()),this.hl.removeChild(na.domElement),na=Array.indexOf(this.zh,na),this.zh.splice(na,1),this.y0(),(!this.isRtl&&na===this.zh.length||this.isRtl&&!na)&&this.VSa(!0),this.g9b&&this.RF?Sa===this.a0?(this.yQ(),this.L0(6)):this.uQb():
this.L0(6))}lIf(Sa){const na=Object(D.a)(da.a,Sa);this.Hz&&this.RF&&(w.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.yQ());if(0===na.VB){this.VSa(!1);var ib=this.lja(Sa);-1===ib&&(w.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.u6b(na,!1),ib=this.lja(Sa));this.W$e(ib,!0)}}ojj(Sa,na){const ib=this.M3a(Sa);ib&&(this.Hz&&this.RF&&!na&&(w.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.yQ()),Sa=this.aNj(Sa,ib),!v.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Hz&&Sa&&na&&Sa.nXi())}aNj(Sa,
na){var ib=Array.indexOf(this.zh,na);const Ib=this.AGh(Object(D.a)(da.a,Sa));if(-1===Ib||-1===ib)return null;ib!==Ib||this.Hz?(this.VSa(!1),{aHh:this.vv,kwi:this.RK}=vb.kjj(ib,Ib,this.vv,this.RK),na&&na.domElement.parentNode===this.hl&&(this.hl.removeChild(na.domElement),this.zh.splice(ib,1)),na=this.nGh(Sa),ib=this.lja(na),na=new Da(this.$,this.hl,this.ELa(ib),Object(D.a)(da.a,Sa),this,this.ym,this.Lw),this.nqe(na,ib),ib=this.lja(Sa),this.W$e(ib,!1,!this.ym)):na=null;return na}$rh(){const Sa=this.zh?
this.zh.length:0,na=this.vv,ib=this.RK;for(let Ib=0;Ib<Sa;Ib++){const ec=this.RQ(Ib),qb=Ib>=na;ec&&(ec.tabIndex=qb&&Ib<=ib?0:-1)}}dWj(){const Sa=this.zh?this.zh.length:0;for(let na=0;na<Sa;na++){const ib=this.RQ(na);ib&&ib.Mgb()}}W$e(Sa,na,ib=!0){na&&Sa<=this.vv&&this.vv++;this.$rh();this.VSa(!0);this.y0();this.g9b&&this.RF?this.uQb():ib&&this.L0(6)}eyc(Sa){const na=this.$.EJ;if(Sa||this.isRtl!==na)this.isRtl=na,this.domElement.classList.remove(this.isRtl?S.a.QSe:S.a.WSe),this.domElement.classList.add(this.isRtl?
S.a.WSe:S.a.QSe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.dWj();Sa||this.VSa(!0);for(Sa=0;Sa<this.cL.length;Sa++)0!==Sa&&3!==Sa&&(!this.ym||4!==Sa&&5!==Sa)&&this.E4f(Sa)}sdh(){const Sa=this.NTd=document.createElement("div");Sa.className=Z.Gxh;this.ym&&Sa.classList.add(Z.Hxh);this.domElement.appendChild(Sa);this.o6b(Sa,1,717,716);this.o6b(Sa,2,719,718);this.Zlf&&(this.dTa=new hb(this.$,this,Sa));this.ym||this.o6b(Sa,4,723,722)}tdh(){const Sa=this.dzc=document.createElement("div");Sa.className=
Z.Ixh;this.domElement.appendChild(Sa);this.ym||this.o6b(Sa,5,725,724);this.o6c()}yeh(){const Sa=document.getElementById(r.a.XAj),na=document.getElementById(r.a.YAj);Sa&&!na&&w.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Sa.parentNode.id}. progressBar div has child: ${!!Sa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(r.a.DTd)}`);const ib=t.a.emf(this.$);if(ib&&Sa&&na)this.domElement.appendChild(Sa),
this.kNb=Sa.firstChild,this.ezc=document.getElementById(r.a.DTd),na.style.visibility="visible";else{const Ib=document.createElement("div"),ec=document.createElement("div");Ib.className=S.a.Rxh;ec.className=S.a.Pxh;v.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(ec.id=r.a.neb);ec.style.display="none";const qb=document.createElement("div");qb.className=S.a.Sxh;const Ha=document.createElement("div");Ha.className=S.a.Qxh;const Ab=document.createElement("div");Ab.className=
S.a.Oxh;ec.appendChild(qb);ec.appendChild(Ha);ec.appendChild(Ab);Ib.appendChild(ec);this.domElement.appendChild(Ib);this.kNb=ec;this.ezc=Ha;w.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",ib,Sa,na)}}E4f(Sa){var na=this.cL[Sa];if(na)if(this.Lw){const ib=na.parentNode;this.NUf(na);na=ba.a(this.$)?this.ONf[Sa]:this.zAd[Sa];this.cL[Sa]=
this.svgIconProvider.zba(na,12,12,ib,24,24)}else na.className=this.xAd[Sa]}NUf(Sa){(null===Sa||void 0===Sa?0:Sa.parentNode)&&Sa.parentNode.removeChild(Sa)}Uah(){const Sa=this.reb=document.createElement("div");Sa.className=Z.Axh;this.domElement.appendChild(Sa);this.Bfh(Sa)}Bfh(Sa){const na=document.createElement("div");na.className=Z.Uxh;na.classList.add(Z.Bxh);this.$.printingEnabled||na.classList.add(U.a.dVe);Sa.appendChild(na);this.hl=document.createElement("ul");la.DOMElementExtensions.Pu(this.hl,
r.a.jZc,null,null);this.hl.className=U.a.XSe;na.appendChild(this.hl);this.ldh();this.uke=document.createElement("div");this.Zyc.id="SheetIconTooltipContainer";na.appendChild(this.Zyc)}ldh(){const Sa=document.createElement("div");var na="<div class='"+S.a.s4g+"'>{0}</div>";const ib=Ca.a.Dfd(S.a.Ryh,0,"55_16_N","");na=String.format(na,ib);v.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(Sa,na):Sa.innerHTML=na;Sa.className=Z.Txh;la.DOMElementExtensions.setVisible(Sa,!1);this.bzc=Sa;this.hl.appendChild(Sa)}G6c(){const Sa=this.$.xa;for(let na=0,ib=Sa.count;na<ib;na++){const Ib=Object(D.a)(da.a,Sa.getItem(na));0===Ib.VB&&(this.u6b(Ib,!0),Ib.active&&Ib.activate())}}L2c(){A.a.rc(this.zh);this.zh=[];this.RK=this.vv=0}o6b(Sa,na,ib,Ib){const ec=document.createElement("a");Sa.appendChild(ec);Sa=this.zAd[na];this.cL[na]=this.pb(ec,
G.a.instance.ga(Ib),0,this.xAd[na],G.a.instance.ga(ib),Sa);if(5===na||4===na)la.DOMElementExtensions.vK(this.cL[na],ec,!1,"span").style.marginTop="10px";this.E4f(na);ib=this.yAd[na]=this.Ce.$d(ec);I.a.instance.sa(z.a.pointerDown,ec,Ha=>Ha.ctrlKey&&this.$Ni(na)?!0:this.sFf(na));I.a.instance.sa(z.a.Sf,ec,()=>this.tFf());L.a.instance.sa(z.a.xe,ec,()=>this.tFf());I.a.instance.sa(z.a.pointerOut,ec,()=>this.D2c());V.KeyInputManager.instance.sa(z.a.Pb,ec,Ha=>13!==Ha.Ca.keyCode&&32!==Ha.Ca.keyCode||this.L4c?
!1:(this.L4c=!0,this.sFf(na)));V.KeyInputManager.instance.sa(z.a.Fd,ec,Ha=>13===Ha.Ca.keyCode||32===Ha.Ca.keyCode?(this.L4c=!1,this.D2c()):!1);const qb=this.tte();Ib=Ha=>{"mouseup"===Ha.type&&this.Hz&&this.RF||Ra.g(Ha);ec.classList.contains(P.a.wU)||(qb?this.hUi(Ha,na):this.ym||this.uFf(Ha,na))};ib.la("mouseover",Ib);ib.la("mouseout",Ib);ib.la("focus",Ib);ib.la("blur",Ib);qb&&ib.la("mouseup",Ib)}dif(Sa){let na=!1;const ib=this.$.wf;ib&&(na=T.a.EN(la.DOMElementExtensions.getBoundingClientRect(ib),
Sa.clientPoint));return na}bmf(Sa){return T.a.EN(la.DOMElementExtensions.getBoundingClientRect(this.domElement),Sa.clientPoint)||this.dif(Sa)}wGh(Sa){let na=null;const ib=Sa.clientPoint;let Ib=this.vv;if(this.bmf(Sa))for(Ib=this.vv;Ib<=this.RK;Ib++)if(na=this.RQ(Ib))if(Sa=la.DOMElementExtensions.getBoundingClientRect(na.domElement),!this.isRtl&&ib.x<Sa.x+Sa.width||this.isRtl&&ib.x>Sa.x)break;return{returnValue:na,GEj:Ib>this.RK}}uQb(){if(this.Hz){if(!this.ZM){w.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.ZM=this.qaa.cloneNode(!0);if(!this.v_f(this.ZM,this.qaa,!0,"UpdateDragAndDropState"))return;this.qaa.style.visibility="hidden";this.ZM.classList.add(Z.Vxh);this.ZM.style.borderRightWidth="";this.nec=this.pZ.clientPoint.x-this.f4.width/2;this.ZM.style.left=this.nec+"px";this.tD=this.lja(this.a0);0>this.tD&&w.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.g9b&&(this.tD=this.lja(this.a0));var Sa=la.DOMElementExtensions.getBoundingClientRect(this.hl),
na=Sa.x;Sa=Sa.x+Sa.width;let ib=this.pZ.clientPoint.x-this.f4.width/2;ib=Math.min(ib,Sa-this.f4.width);ib=Math.max(ib,na);this.ZM.style.transform="translateX("+Math.abs(ib-this.nec)*(this.nec<ib?1:-1)+"px)";const Ib=this.pZ.clientPoint.x>this.MCb;let ec=this.pZ.clientPoint.x;ib>=Sa-this.f4.width?(ec=Sa-this.f4.width/2,this.ZPd()||this.fna||(w.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.crc=
this.hl.scrollLeft,this.fna=window.requestAnimationFrame(this.X0f))):ib<=na?(ec=na+this.f4.width/2,this.YPd()||this.fna||(w.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.crc=this.hl.scrollLeft,this.fna=window.requestAnimationFrame(this.W0f))):this.fna&&(w.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.xXd());
this.pZ.clientPoint.x!==this.MCb&&(this.nYd(Ib,ec),this.MCb=this.pZ.clientPoint.x)}else(Sa=({GEj:na}=this.wGh(this.pZ)).returnValue)?this.FVd(Sa.sheet,na):this.acf();this.ANc=!0}nYd(Sa,na){let ib;for(;({r3b:ib}=this.zoh(na,Sa)).returnValue;)this.TOb=ib,this.XPg(Sa)}XPg(Sa){if(this.TOb){var na=(Sa?1:-1)*this.f4.width;if(Sa&&!this.$.EJ||!Sa&&this.$.EJ){var ib=this.qaa;var Ib=this.tD+1;var ec=!0}else ib=(Ib=this.RQ(this.tD+1))?Ib.domElement:null,Ib=this.tD-1,ec=!1;if(this.v_f(this.TOb,ib,ec,"AnimateSheetSwap")){w.ULS.sendTraceTag(537153738,
0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.tD} and other sheet-index ${Ib}. amount of sheets in the bar: ${this.LTd} isMovingRight: ${Sa}`);0<=this.tD&&this.tD<this.zh.length&&0<=Ib&&Ib<this.zh.length?(Sa=this.zh[Ib],this.zh[Ib]=this.zh[this.tD],this.zh[this.tD]=Sa):(w.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.zh.length}, ghostIndex: ${this.tD}, swappedSheetIndex: ${Ib}`),this.yQ());this.tD=
Ib;var qb=this.TOb;qb.style.transform="translateX("+na+"px)";window.requestAnimationFrame(()=>{qb.style.transform="translateX(0px)"})}}}v_f(Sa,na,ib,Ib){const ec=qb=>qb?`Node ID: ${qb.id} , Node class: ${qb.className}, Node name: ${qb.nodeName},`:null;try{return this.hl.insertBefore(Sa,na),!0}catch(qb){return Sa=this.M3a(this.a0),w.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Sa?Sa!==this.Z8b?"Changed":"NoChange":"Removed",Ib,ec(na),ec(na.parentNode),ec(this.hl),ib,this.tD,this.LTd,qb),this.yQ(),!1}}zoh(Sa,na){var ib=this.$.EJ===na?this.RQ(this.tD-1):this.RQ(this.tD+1);if(!ib)return{returnValue:!1,r3b:null};ib=ib.domElement;const Ib=la.DOMElementExtensions.getBoundingClientRect(ib);return this.f4?na?{returnValue:Sa+this.f4.width/2>=Ib.x+.5*Ib.width,r3b:ib}:{returnValue:Sa-this.f4.width/2<=Ib.x+.5*Ib.width,r3b:ib}:(w.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.yQ(),{returnValue:!1,r3b:ib})}T0f(Sa,na){let ib;ib=na?this.X0f:this.W0f;if(-1===this.MAc)this.MAc=Sa,this.fna=window.requestAnimationFrame(ib);else{Sa=Math.floor((Sa-this.MAc)/1E3*300);var Ib=this.iLb>this.sDb?1:-1;this.scrollLeft(Math.abs(this.hl.scrollLeft-(na?this.crc+Sa*Ib:this.crc-Sa*Ib))*(na?-1:1));if(Sa=this.i3e("ScrollStep"))this.nYd(na,Sa.x+Sa.width/2),na&&!this.ZPd()||!na&&!this.YPd()?this.fna=window.requestAnimationFrame(ib):(w.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.xXd())}}ZPd(){const Sa=this.iLb>this.sDb;return Sa&&this.Mna>=this.iLb||!Sa&&this.Mna<=this.iLb}YPd(){const Sa=this.iLb>this.sDb;return Sa&&this.Mna<=this.sDb||!Sa&&this.Mna>=this.sDb}xXd(Sa=!0){this.hl&&(this.Mna=this.hl.scrollLeft);window.cancelAnimationFrame(this.fna);this.fna=0;this.MAc=-1;Sa&&this.y0()}ERd(Sa,na){Sa||w.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${na}`);this.f4=Sa}$Ni(Sa){return 2===Sa?(this.L0(3),
!0):1===Sa?(this.L0(0),!0):!1}sFf(Sa){w.ULS.shipAssertTag(537153732,0,-1===this.uQa&&-1===this.tQa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.uQa&&(window.clearTimeout(this.uQa),this.uQa=-1);-1!==this.tQa&&(window.clearInterval(this.tQa),this.tQa=-1);this.L0(Sa);this.uQa=window.setTimeout(()=>{this.IKj(Sa)},this.THi);return!0}IKj(Sa){this.tQa=window.setInterval(()=>{this.L0(Sa)},this.SHi)}tFf(){this.D2c();
return!this.Hz||!this.RF}D2c(){window.clearTimeout(this.uQa);window.clearInterval(this.tQa);this.tQa=this.uQa=-1;return!0}uFf(Sa,na){const ib=this.xAd[na];Aa.HelperMethods.EZd(this.cL[na],ib,ib+r.a.Tfc,"mouseover"===Sa.type||"focus"===Sa.type)}hUi(Sa,na){const ib=this.vic(na),Ib=5===na;if("mouseup"===Sa.type){if(Ib||4===na)ib||this.reorderSheets(null,Ib,!1),this.yQ()}else!this.Hz&&this.RF?(ib||this.FVd(this.m7e(Ib?this.RK:this.vv),Ib),this.L0(Ib?2:1)):this.ym||this.uFf(Sa,na)}vic(Sa){return!!la.DOMElementExtensions.Egd(this.cL[Sa],
"a").title}rEc(Sa){this.E1d(Sa);this.y0()}E1d(Sa){(Sa=this.M3a(Sa))&&Sa.Mgb()}bQd(){var Sa=this.$.xa;if(Sa.oa&&(!sa.e(this.$)||Sa.count))if(Sa=this.lja(Sa.oa),-1===Sa)w.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var na=this.ELa(Sa);Sa<this.vv?this.Xwc(Sa):Sa>this.vv&&!this.Etd(na)&&this.scrollIntoView(Sa)}}tXj(){this.vv=0;this.RK=this.zh.length-1;let Sa=!1;for(let na=0;na<this.zh.length;na++){const ib=this.RQ(na);if(!ib)break;
const Ib=this.Etd(ib.domElement);ib.tabIndex=Ib?0:-1;if(!Sa&&Ib)this.vv=na,Sa=!0;else if(Sa&&!Ib){this.RK=na-1;break}}}Xwc(Sa){this.$.xa.count&&(this.zh.length||this.G6c(),this.P2f(this.ELa(Math.max(0,Math.min(Sa,this.zh.length-1)))),this.y0())}scrollIntoView(Sa){w.ULS.shipAssertTag(537153697,0,Sa>=this.vv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.zh.length||this.G6c();var na=this.ELa(Math.max(0,Math.min(Sa,
this.zh.length-1))),ib=this.ELa(this.vv);if(!this.Etd(na)){na=la.DOMElementExtensions.getBoundingClientRect(na);var Ib=la.DOMElementExtensions.getBoundingClientRect(this.reb);na=this.isRtl?Ib.x-na.x:na.x+na.width-(Ib.x+Ib.width);for(Ib=0;ib&&Ib<na;){const ec=la.DOMElementExtensions.getBoundingClientRect(ib);Ib+=ec.width;ib=ib.nextSibling}ib?this.P2f(ib):w.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.vv}, lastVisibleSheetTabIndex = ${this.RK}, scroll to index: ${Sa}`)}this.y0()}}P2f(Sa){const na=
la.DOMElementExtensions.getBoundingClientRect(this.hl);Sa=la.DOMElementExtensions.getBoundingClientRect(Sa);this.isRtl?this.scrollLeft(Math.floor(na.x+na.width-(Sa.x+Sa.width+.5))):this.scrollLeft(Math.ceil(na.x-Sa.x-.5))}scrollLeft(Sa){(0>Sa&&this.ZPd()||0<Sa&&this.YPd())&&w.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const na=this.hl.scrollLeft;if(this.isRtl){if(C.a.SF||C.a.Jf){this.hl.scrollLeft=this.Mna=na-Sa;
return}if(C.a.ZH){this.hl.scrollLeft=this.Mna=na+Sa;return}w.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.hl.scrollLeft=this.Mna=na-Sa}Etd(Sa){Sa=la.DOMElementExtensions.getBoundingClientRect(Sa);const na=la.DOMElementExtensions.getBoundingClientRect(this.reb);return Sa&&na?Sa.x>=na.x-1&&Sa.x+Sa.width<=na.x+na.width+1:(w.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}Ndh(){const Sa=
this.dzc;if(ca.h7f(this.$))this.ym?(A.a.Ia(this.UH),this.UH=new ca(Sa,this.$,this,!0)):(A.a.Ia(this.UH),this.UH=null);else if(!this.UH||this.ym)A.a.Ia(this.UH),X.k(this.$.lg)?this.UH=new nb(Sa,this.$,this):this.UH=new ca(Sa,this.$,this)}BIe(Sa,na){var ib=this.$.xa;if(!this.$.isEditMode||!ib.count)A.a.Ia(na),na=null;else if(!na)if(ib=this.ym?this.NTd:this.dzc,X.k(this.$.lg))na=new nb(ib,this.$,this);else switch(Sa){case 0:na=new ca(ib,this.$,this);break;case 1:na=new $a(ib,this.$,this);break;default:w.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return na}o6c(){v.EwaSettings.ma(418)?(this.UH=this.BIe(0,this.UH),this.Vzb=this.BIe(1,this.Vzb)):this.Ndh()}i3e(Sa){const na=la.DOMElementExtensions.getBoundingClientRect(this.ZM);na||(w.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Sa}: GetBoundingClientRect returned null for the dragged sheet.`),
this.yQ());return na}O$e(Sa,na){this.mua.dRg(Sa,na);this.yQ(!1);this.nSd(this.navigationButtonsDisabled);for(const ib of this.nNj)ib&&ib.ES(this.navigationButtonsDisabled);for(const ib of this.qxe)ib&&ib.ES(this.operationButtonsDisabled)}static kjj(Sa,na,ib,Ib){Sa<ib?(na>ib&&ib--,na>Ib&&Ib--):Sa>Ib?(na<ib&&ib++,na<Ib&&Ib++):na<ib&&ib++;return{aHh:ib,kwi:Ib}}}Object(u.a)(vb,"SheetTabBarControl",Q.a,[351,2,34]);class gc extends x.a{constructor(Sa){super();this.$=Sa;this.Fb()}create(){const Sa=this.$.Eb;
if(y.a(this.$.va,1))W.PageLoadTrackingInfo.instance.Oda(r.a.qBa,["sheetTabBar"]);else{var na=document.getElementById(Sa+r.a.N7c);if(na){v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&W.PageLoadTrackingInfo.instance.bBa(r.a.qBa);var ib=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")?e.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):h.Task.Ta(null),
Ib=t.a.Rsd()?e.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Ya):h.Task.Ta(null);f.TaskExtensions.za(f.TaskExtensions.Ed([Ib,ib],this.$.ka),()=>{this.nb(this.$.da.Aa(32)||new vb(this.$,na,Ib.result,ib.result))},this.$.ka,3)}else W.PageLoadTrackingInfo.instance.Oda(r.a.qBa,["sheetTabBar"])}}static la(Sa){Sa.da.Ga(33,new gc(Sa))}}Object(u.a)(gc,"SheetTabBarFactory",x.a,[]);a.d(F,"a",function(){return Bc});const Bc=()=>{c.a.Fa(Sa=>{gc.la(Sa);m.la(Sa)})}},1156:function(u,F,a){var c=a(9),b=a(1);u=a(0);
var e=a(222),f=a(15),d=a(31),h=a(5),n=a(12),m=a(22),x=a(13),r=a(254),y=a(21),t=a(30);class v{constructor(fa){this.Dwc=fa||""}static get iPe(){return v.x9d||(v.x9d=new v(""))}static get Axd(){return v.zee||(v.zee=v.jed(2).Dwc)}static f4a(fa){fa=t.a.Hg(fa||"");return new v(fa)}static nbc(fa){return v.f4a(x.a.instance.ga(fa))}static jed(fa){return new v(x.a.instance.Ua(fa))}static CJh(fa,...Oa){return v.BJh(x.a.instance.mb(fa),...Oa)}static BJh(fa,...Oa){const ba=Oa.length,ka=Array(ba);for(let Pa=0;Pa<
ba;Pa++)ka[Pa]=(Oa[Pa]||v.iPe).Dwc;return new v(String.format(fa,ka))}}v.x9d=null;v.zee=null;Object(u.a)(v,"SafeHtml",null,[364]);const w=(fa,Oa)=>{Oa&&(fa.append(Oa),fa.append(v.Axd))};class C{constructor(fa,Oa,ba,ka=null){this.DAf=(Pa,Fa)=>{this.qRf(Fa.Wd.command)};this.$=fa;this.htmlSanitizationHelper=ka;this.mfa=document.createElement("div");this.mfa.setAttribute(h.a.b3,h.a.Ak);this.mfa.className=d.a.Cad;Oa.insertBefore(this.mfa,ba);this.xga=document.createElement("div");this.xga.setAttribute(h.a.b3,
h.a.Ak);this.xga.className=d.a.Cad;Oa.insertBefore(this.xga,this.mfa);this.Xyg=x.a.instance.Ua(2);this.w$=document.createElement("div");this.w$.setAttribute(h.a.Ld,h.a.Hsa);this.w$.setAttribute(h.a.Jsa,h.a.wpb);this.w$.className=d.a.Cad;Oa.insertBefore(this.w$,this.xga);this.register();this.$.da.Ga(211,this)}get pya(){return this.Xyg}get isActive(){return!0}get activeCell(){return y.h(this.$).Sb(null)}get Bsd(){return b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")}dispose(){this.$&&
this.unregister();n.DOMElementExtensions.uf(this.w$);n.DOMElementExtensions.uf(this.mfa);n.DOMElementExtensions.uf(this.xga);this.xga=this.mfa=this.w$=this.$=null}setEnabled(fa){this.A3f(this.xga,fa)}tvj(){this.A3f(this.mfa,!0)}readText(fa){this.$Ib(v.f4a(fa),!0)}UQa(fa){this.$Ib(v.f4a(fa),!1)}tRf(fa,Oa){if(1>Oa||!fa)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ba=new Sys.StringBuilder;fa=String.format(x.a.instance.mb(34),Oa,fa);w(ba,fa);w(ba,x.a.instance.ga(856));
this.$Ib(v.f4a(ba.toString()),!1)}}jaj(fa,Oa,ba){if(1>ba||1>Oa||Oa>ba||!fa)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ka=new Sys.StringBuilder;w(ka,fa);ka.append(String.format(x.a.instance.mb(55),Oa,ba));this.$Ib(v.f4a(ka.toString()),!1)}}qRf(fa){fa=this.u0h(fa);this.$Ib(fa,!1)}$Ib(fa,Oa){if(fa=fa?fa.Dwc:null)Oa=Oa?this.xga:this.mfa,m.a.equals(Oa.innerHTML,fa,!1)&&(fa+=v.Axd),this.Bsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(Oa,fa):Oa.innerHTML=
fa}acb(fa,Oa){this.w$.getAttribute(h.a.Jsa)!==Oa&&this.w$.setAttribute(h.a.Jsa,Oa);fa=fa?v.f4a(fa).Dwc:"";this.Bsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(this.w$,fa):this.w$.innerHTML=fa}kaj(fa,Oa,ba,ka){const Pa=x.a.instance.mb(54);f.ULS.shipAssertTag(537153949,0,!(void 0===fa||null===fa));f.ULS.shipAssertTag(537153948,0,!(void 0===Oa||null===Oa));f.ULS.shipAssertTag(537153947,0,!(void 0===ba||null===ba));f.ULS.shipAssertTag(537153946,0,!(void 0===ka||null===ka));f.ULS.shipAssertTag(537153945,
0,!(void 0===Pa||null===Pa));fa=String.format(Pa,fa||"",Oa||"",ba||"",ka||"");this.acb(fa,h.a.jHa)}hWj(fa){var Oa=this.xga.style;fa?(fa=r.a.J2b(fa.cell,Oa),Oa=fa.ZB,Oa.top=Oa.left=Oa.bottom=Oa.right=null,fa.X2()):Oa.cssText=""}u0h(fa){switch(fa){case -1985798686:return v.nbc(12);case -911352779:return v.nbc(11);case 237279923:return v.nbc(13);case -1502853784:return v.jed(81);case -111689794:return v.jed(78);case -287251124:return this.Jid(1329,Oa=>Oa.bold);case -1925065947:return this.Jid(1330,Oa=>
Oa.italic);case 1764140053:return this.Jid(1331,Oa=>Oa.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ja,"Can't register to CommandHandlerManager's event"),this.$.Ja&&this.$.Ja.osa(this.DAf))}unregister(){this.$&&this.$.Ja.yAa(this.DAf)}A3f(fa,Oa){const ba=fa===this.mfa;Oa?(fa.setAttribute(h.a.Jsa,h.a.jHa),ba&&fa.setAttribute(h.a.Ld,h.a.Hsa),fa.setAttribute(h.a.b3,h.a.xr),fa.removeAttribute(h.a.b3),
this.Bsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Ri(fa,fa.innerHTML+" "):fa.innerHTML+=" "):(fa.removeAttribute(h.a.Jsa),ba&&fa.removeAttribute(h.a.Ld),fa.setAttribute(h.a.b3,h.a.Ak))}Jid(fa,Oa){const ba=this.activeCell;if(!ba)return null;const ka=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),Pa=[7,8];Oa=Oa(ba)?!0:!1;return v.CJh(ka?Pa[+Oa]:Pa[+!Oa],v.nbc(fa))}}Object(u.a)(C,"AriaLiveNotifier",null,[336,295,2]);var B=a(49),z=a(37);class A extends e.a{constructor(fa){super();
this.$=fa;this.Fb()}create(){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")){const fa=B.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);z.TaskExtensions.za(z.TaskExtensions.Ed([fa],this.$.ka),()=>{this.nb(this.$.da.Aa(211)||new C(this.$,this.$.ru,this.$.wf,fa.result))},this.ka,3)}else this.nb(this.$.da.Aa(211)||new C(this.$,this.$.ru,this.$.wf))}static la(fa){fa.da.Ga(212,
new A(fa))}}Object(u.a)(A,"AriaLiveNotifierFactory",e.a,[]);var E=a(27),I=a(213),L=a(138),V=a(65);class T{constructor(fa,Oa){this.x0=this.MW=this.sO=null;this.xja=Oa;this.Peh(fa);this.g5i();b.EwaSettings.xb()&&fa.da.Ga(244,this)}get isActive(){return!!this.xja&&document.activeElement===this.xja}readText(fa){fa=String.format(x.a.instance.mb(30),fa);this.sO.setAttribute(h.a.mv,fa);this.MW.setAttribute(h.a.mv,fa);this.YMj()}dispose(){this.x0&&this.x0.parentNode&&this.x0.parentNode.removeChild(this.x0);
this.MW=this.sO=this.x0=this.xja=null}Peh(fa){var Oa=fa.Eb+"readoutElementWrapper";const ba=fa.Eb+"readoutElement1",ka=fa.Eb+"readoutElement2";this.x0=document.getElementById(Oa);this.x0||(this.x0=document.createElement(I.a.div),this.x0.id=Oa,this.sO=document.createElement(I.a.label),this.sO.id=ba,this.sO.setAttribute(L.a.contentEditable,V.a.mRb),this.sO.setAttribute(h.a.Ld,h.a.x_a),this.MW=document.createElement(I.a.label),this.MW.id=ka,this.MW.setAttribute(L.a.contentEditable,V.a.mRb),this.MW.setAttribute(h.a.Ld,
h.a.x_a),this.sO.style.width="0px",this.sO.style.height="0px",this.MW.style.width="0px",this.MW.style.height="0px",this.sO.tabIndex=-1,this.MW.tabIndex=-1,this.x0.appendChild(this.sO),this.x0.appendChild(this.MW),fa=fa.Eb+h.a.r5b,Oa=document.getElementById(fa),f.ULS.shipAssertTag(537153942,3,!!Oa,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${fa}`),Oa&&Oa.appendChild(this.x0))}g5i(){this.xja&&this.sO&&this.MW&&(this.xja.setAttribute(h.a.a3,this.sO.id),
this.xja.setAttribute(h.a.gZc,`${this.sO.id} ${this.MW.id}`))}YMj(){if(this.isActive){let fa="";n.DOMElementExtensions.hasAttribute(this.xja,h.a.a3)&&(fa=this.xja.getAttribute(h.a.a3).toString());this.xja.setAttribute(h.a.a3,fa===this.sO.id?this.MW.id:this.sO.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static s7a(){if(null==T.Vvb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!E.a.KNa)T.Vvb=
!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(T.Vvb=!1,E.a.ZH||E.a.Jf)T.Vvb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return T.Vvb}static la(fa){T.s7a()&&fa.da.Ga(244,new T(fa,y.h(fa).fc.textBox.Le))}}T.Vvb=null;Object(u.a)(T,"FocusBasedReadout",null,[295,2]);class H extends e.a{constructor(fa){super();this.$=fa;this.Fb()}create(){T.s7a()?
y.h(this.$).fc.textBox.iU(()=>{const fa=this.$.da.Aa(244)||new T(this.$,y.h(this.$).fc.textBox.Le);this.nb(fa)}):this.nb(null)}static la(fa){fa.da.Ga(315,new H(fa))}}Object(u.a)(H,"FocusBasedReadoutFactory",e.a,[]);var D=a(7),G=a(89),J=a(83);const M=fa=>{switch(fa){case 1:return 1452;case 2:return 1453;case 3:return 1454;case 4:return 1455;case 5:return 1456;case 6:return 1457;case 7:return 1458;case 8:return 1459;case 9:return 1460;case 10:return 1461;case 11:return 1462;case 12:return 1463;case 13:return 1464;
case 14:return 1465;case 15:return 1466;case 16:return 1467;case 17:return 1468;case 18:return 1469;case 19:return 1470;case 20:return 1471;case 21:return 1472;case 22:return 1475;case 23:return 1473;case 24:return 1474;case 25:return 1476;case 26:return 1477;case 27:return 1478;case 28:return 1479;default:return 1480}};var Q=a(24),U=a(40),Z=a(212),P=a(47),S=a(46),ja=a(122);class X{static get Z9i(){return X.hie||(X.hie=RegExp("([A-Z]+)","g"))}static get Y9i(){return X.gie||(X.gie=RegExp("([A-Z])",
"g"))}static get u2g(){return X.U6d||(X.U6d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static xid(fa){return X.h6e(fa.toString())}static h6e(fa){return X.u2g.test(fa)?fa.replace(X.Z9i,"$1 ").replace(X.Y9i,' "$1"').trim():fa}static Ijj(fa){const Oa=fa.lastIndexOf("!");return fa.substring(0,-1<Oa?Oa+1:0)+X.h6e(fa.substring(-1<Oa?Oa+1:0,fa.length))}}X.hie=null;X.gie=null;X.U6d=null;Object(u.a)(X,"RangeAriaExtensions",
null,[]);class Y{constructor(){this.activeItemName=null;this.Llf=!1;this.tableName=null;this.g1a=0;this.zBc=!1}}Object(u.a)(Y,"SelectionReadoutState",null,[]);a(66);var va=a(76);class N{constructor(fa,Oa,ba,ka,Pa){this.gridReadoutNotifier=null;this.Wbb=!1;this.Ysa=this.Hpb=null;this.xda=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):y.h(this.$).eb||this.H1b.tq()};
this.YKi=()=>{if(!y.h(this.$).ha.Sa.asd){var Fa,oa=({activeCell:Fa}=this.EMh()).returnValue;this.readText(oa,Fa)}};this.Mp=()=>{const Fa=this.activeCell;this.readText("Editing",Fa);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Fa&&Fa.$ec&&!y.h(this.$).taf||this.H1b.cancel()};this.Pc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.xda(),this.Wbb&&y.h(this.$).inRangePicker&&1===va.a.Db&&(null===this.Hpb?this.Hpb=P.a.instance.create(this.ZJd,N.JVc,"readSelectedRanges"):this.Hpb.tq()))};this.$=Oa;this.ariaLiveNotifier=fa;this.sparklineManager=ka;this.tableManager=ba;this.WD=new Y;this.s7a=T.s7a();this.Wbb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.s7a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=Pa:this.gridReadoutNotifier=Oa.da.Aa(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),N.JVc=700);this.H1b=P.a.instance.create(this.YKi,N.JVc,S.a.Urj,!1);this.Nj()}get activeCell(){return y.h(this.$).Sb(null)}dispose(){this.$&&this.gk();G.a.Ia(this.H1b);this.sparklineManager=this.$=this.H1b=null}O0e(fa,Oa,ba=!0){if(!fa)return"";var ka=this.$.da;const Pa=new Sys.StringBuilder;this.SQg(Pa,fa,Oa);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Fa=this.tableManager.cka(fa.range);(null===
Fa||void 0===Fa?0:Fa.bVd)&&this.yue(Pa,Fa);Fa=this.tableManager.Bn(fa.range);(null===Fa||void 0===Fa?0:Fa.oba)&&this.yue(Pa,Fa)}Fa=fa.mba?this.G3e(fa):fa.text;w(Pa,Fa);Fa=this.$.activeItemName;this.WD.activeItemName!==Fa&&(w(Pa,Fa),this.WD.activeItemName=Fa);Fa=1===Oa.length?U.K(Oa).isSingle?"":x.a.instance.ga(852):String.format(x.a.instance.mb(31),Oa.length);w(Pa,Fa);for(var oa of Oa)w(Pa,X.xid(oa)),1===Oa.length&&N.yti(oa)&&(Fa=y.h(this.$).Da.rs(oa.bottomRight),void 0!==Fa&&null!==Fa&&Fa.text&&
(Fa=Fa.mba?this.F3e(Fa,Fa.text):Fa.text,w(Pa,Fa)));oa=fa.cell;oa=this.RYh(oa.qoj,oa.u5g);w(Pa,oa);this.BQg(Pa,fa);ba&&(fa.X7a?w(Pa,x.a.instance.ga(840)):fa.Fxa&&w(Pa,x.a.instance.ga(841)));if(fa.hasAutoFilter||fa.Y4)this.TQg(Pa,fa.hasAutoFilter?fa.cell.autoFilterType:fa.cell.F2i),ba&&w(Pa,x.a.instance.ga(843));Z.c(this.$,fa.range)&&w(Pa,x.a.instance.ga(847));this.yQg(Pa,fa);ba=(ba=ka.Aa(14))?ba.BNh():"";w(Pa,ba);fa.rB&&(ba=y.h(this.$).Da.rs(fa.range),ba=!!ba&&ba.Kaf,N.vBj(fa)?N.zQg(Pa,fa):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
ba?w(Pa,x.a.instance.ga(845)):w(Pa,x.a.instance.ga(844)));fa.uV&&(w(Pa,x.a.instance.ga(846)),fa.Byb&&w(Pa,String.format(x.a.instance.mb(16),fa.Zhh)),w(Pa,fa.iconName));fa.hasRichValueIcon&&(oa=this.$.da.Aa(271),ba="",oa&&fa.cell.Vpf&&(oa=oa.KU(fa.cell.Vpf))&&oa.DomainId.Id!==N.a3j&&(ba=oa.Name),fa.cell.Jji?(w(Pa,String.format(x.a.instance.mb(187),ba)),w(Pa,x.a.instance.ga(1803))):(w(Pa,String.format(x.a.instance.mb(185),ba)),w(Pa,x.a.instance.ga(1802))));this.f$h(fa)&&w(Pa,N.tUh(fa));(ka=ka.Aa(231))&&
w(Pa,ka.U3e(Oa,!0));1===Oa.length&&Oa[0].isSingle&&N.uBj(fa,Oa[0],this.$)&&(Oa=this.$.da.Aa(271))&&w(Pa,Oa.MNh());fa.JPb&&fa.KPb&&w(Pa,fa.KPb);(Oa=fa.cell.h1g)&&w(Pa,Oa);fa.ANa&&fa.YHb&&(fa=fa.CGd)&&(w(Pa,x.a.instance.ga(1979)),w(Pa,fa));return Pa.toString()}Cze(fa){this.Ysa=this.WD;this.WD=Object(D.a)(new Y,{activeItemName:this.Ysa.activeItemName,zBc:fa?this.Ysa.zBc:!1,tableName:fa?this.Ysa.tableName:"",g1a:fa?this.Ysa.g1a:-1})}WYf(){this.Ysa&&(this.WD=this.Ysa,this.Ysa=null)}RYh(fa,Oa){return 2===
fa||2===Oa?x.a.instance.ga(874):1===fa||1===Oa?x.a.instance.ga(875):""}G3e(fa){return this.F3e(fa.cell,fa.text)}SQg(fa,Oa,ba){if(ba&&1===ba.length&&ba[0].isSingle){ba="";var ka=this.tableManager.cka(Oa.range);if(ka){ba=ka.pivotTableName;this.FYc(fa,ba);var Pa=ka.Xhc?x.a.instance.ga(835):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Pa+=(ka.altText?ka.altText+" . ":"")+(ka.altTextSummary?ka.altTextSummary:""));this.Aue(fa,!0,ba,Pa);w(fa,this.tableManager.mri(ka,
Oa.range)?x.a.instance.ga(837):"");w(fa,this.tableManager.Zki(ka,Oa.range)?x.a.instance.ga(836):"")}else if(ka=this.tableManager.Bn(Oa.range)){ba=(Pa=y.h(this.$).Bb.Bj(Oa.range))?Pa.name:"";this.FYc(fa,ba);let Fa="";Pa&&(Fa=(Pa.mUa?Pa.mUa+" . ":"")+(Pa.nUa?Pa.nUa:""));this.Aue(fa,!1,ba,Fa);w(fa,this.tableManager.Pif(ka,Oa.range)?x.a.instance.ga(836):"")}else this.FYc(fa,ba),this.WD.tableName="",this.WD.g1a=-1}}FYc(fa,Oa){Oa!==this.WD.tableName&&this.WD.tableName&&(fa.append(x.a.instance.ga(this.WD.zBc?
834:833)),w(fa," "+this.WD.tableName))}Aue(fa,Oa,ba,ka){ba!==this.WD.tableName&&(fa.append(x.a.instance.ga(Oa?832:831)),w(fa," "+ba),w(fa,ka),this.WD.tableName=ba,this.WD.zBc=Oa,this.WD.g1a=-1)}yue(fa,Oa){const ba=y.h(this.$).ha.ra.activeCell;if(ba.top!==Oa.top&&ba.left!==this.WD.g1a){fa.append(x.a.instance.ga(836));Oa=new Q.Range(Oa.top,ba.left,Oa.top,ba.left,!0,!0);w(fa,X.xid(Oa));if(Oa=y.h(this.$).Sb(Oa))Oa=Oa.mba?this.G3e(Oa):Oa.text,w(fa,Oa);this.WD.g1a=ba.left}}F3e(fa,Oa){const ba=fa.o6a;return fa.zwa?
String.format(x.a.instance.mb(14),Oa,ba):String.format(x.a.instance.mb(13),Oa,X.Ijj(ba))}Nj(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var fa=y.h(this.$);f.ULS.shipAssertTag(537153929,0,!!fa,"Can't register to grid's events");fa&&(fa.Vb.Yk(this.Mp),fa.Da.hw(this.xda),fa.FC(this.xda),this.Wbb&&fa.Vb.Rm(this.jg.bind(this)),fa=fa.ha,f.ULS.shipAssertTag(537153928,0,!!fa,"Can't register to selectionManager's events"),fa&&(fa.hH(this.Pc),fa.fH(this.xda),
fa.Sa.T2(this.xda),this.Wbb&&(this.ZJd=this.ZJd.bind(this))))}}gk(){if(this.$){var fa=y.h(this.$);fa&&(fa.Vb.Gk(this.Mp),fa.Da.ex(this.xda),fa.bE(this.xda),this.Wbb&&fa.Vb.em(this.jg),fa=fa.ha)&&(fa.kG(this.xda),fa.rL(this.xda),fa.Sa.tna(this.xda))}}readText(fa,Oa){this.s7a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(fa):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(fa),
this.Wbb&&!Oa||this.ariaLiveNotifier.hWj(Oa))}jg(){this.Hpb&&this.Hpb.cancel()}ZJd(){this.readText(this.f1h())}f1h(){let fa="";y.h(this.$).ha.rangePicker.lL.forEach(()=>{fa+=void 0});return fa+=" selected"}EMh(){let fa;fa=null;var Oa=y.h(this.$).ha;if(1!==Oa.Oe&&!Oa.Sa.$b)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${Oa.Oe} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:fa};switch(Oa.Oe){case 2:return{returnValue:this.BPh(Oa),
activeCell:fa};case 64:var ba=Oa.Sa.$b.floatingObject,ka="";if(Oa=Oa.Sa.$b.Ys||Oa.Sa.$b.Jd)ka=(ka=Oa.firstChild)?n.DOMElementExtensions.getTextContent(ka):"";return{returnValue:String.format(x.a.instance.mb(53),N.Bbc(ba.altText,ba.altTextDescription,ba.name),ka,ba.altTextDescription),activeCell:fa};case 4:return{returnValue:N.KPg(Oa.Sa.$b.floatingObject),activeCell:fa};case 512:return{returnValue:ja.a.n2e(Oa.Sa.$b.floatingObject.C9c),activeCell:fa};case 8:return ba=Oa.Sa.$b.floatingObject,{returnValue:String.format(x.a.instance.mb(51),
ba?ba.name:""),activeCell:fa};case 1:return fa=this.activeCell,{returnValue:this.O0e(fa,Oa.ra.selectedRanges),activeCell:fa}}return{returnValue:"",activeCell:fa}}BPh(fa){const Oa=new Sys.StringBuilder;Oa.append(N.M1g(fa));const ba=this.$.da.Aa(231);ba&&w(Oa,ba.U3e(fa.Sa.$b.floatingObject,!1));return Oa.toString()}f$h(fa){fa=fa.Vgf();let Oa=!1;this.WD.Llf!==fa&&(this.WD.Llf=fa,Oa=!0);return Oa}BQg(fa,Oa){if(Oa.Lyb)if(Oa=this.sparklineManager.c2h(Oa)){var ba=x.a.instance,ka=ba.ga;a:switch(Oa.type){case 0:var Pa=
828;break a;case 1:Pa=829;break a;default:Pa=830}ba=ka.call(ba,Pa);w(fa,String.format(x.a.instance.mb(25),ba));Oa=String.format(x.a.instance.mb(24),X.xid(Oa.wJj));w(fa,Oa)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),w(fa,String.format(x.a.instance.mb(25),""))}TQg(fa,Oa){switch(Oa){case 1:case 11:w(fa,x.a.instance.ga(848));break;case 6:w(fa,x.a.instance.ga(848));w(fa,x.a.instance.ga(850));break;case 7:w(fa,x.a.instance.ga(848));w(fa,x.a.instance.ga(851));
break;case 2:w(fa,x.a.instance.ga(849));w(fa,x.a.instance.ga(850));break;case 3:w(fa,x.a.instance.ga(849));w(fa,x.a.instance.ga(851));break;default:w(fa,x.a.instance.ga(849))}}yQg(fa,Oa){var ba;const ka=this.$.da.Aa(65);Oa=ka?ka.YKa(Oa.range):null;let Pa="";const Fa=Object(J.a)(332,Oa);if(Oa)Pa=!Oa.C7a&&Fa&&Fa.Ysi?String.format(x.a.instance.mb(29),Fa.ONj):String.format(x.a.instance.mb(23),Oa.author);else if(null===(ba=null===ka||void 0===ka?void 0:ka.Ym)||void 0===ba?0:ba.CF)Pa=String.format(x.a.instance.mb(28),
ka.Ym.VN.author);w(fa,Pa)}static KPg(fa){return String.format(x.a.instance.mb(52),N.Bbc(fa.altText,fa.altTextDescription,fa.name),fa.altTextDescription)}static tUh(fa){return x.a.instance.ga(fa.Vgf()?838:839)}static Bbc(fa,Oa,ba){return fa||Oa?fa:ba}static M1g(fa){var Oa=fa.Sa.$b;fa=Oa.floatingObject;const ba=fa.Vc,ka=ba.ChartTitle,Pa=fa.altText,Fa=fa.altTextDescription,oa=!!(ba.Attributes&4);return(Oa=Oa.getSelectionDescription())?Oa:ba.DataRangeForDisplay?String.format(x.a.instance.mb(oa?49:47),
N.Bbc(Pa,Fa,fa.name),Fa,ka,x.a.instance.ga(M(ba.ChartCategory)),ba.DataRangeForDisplay):String.format(x.a.instance.mb(oa?50:48),N.Bbc(Pa,Fa,fa.name),Fa,ka,x.a.instance.ga(M(ba.ChartCategory)))}static vBj(fa){return b.EwaSettings.ma(101)&&(fa.k7a||fa.Vhc)}static zQg(fa,Oa){Oa.STa?Oa.k7a?w(fa,String.format(x.a.instance.mb(26),Oa.STa.topLeft.toString())):Oa.Vhc&&(Oa=Oa.STa.DS(),w(fa,String.format(x.a.instance.mb(27),(Oa.LastColumn-Oa.FirstColumn+1).toString(),(Oa.LastRow-Oa.FirstRow+1).toString()))):
f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static uBj(fa,Oa,ba){return fa.rB||!b.EwaSettings.ma(137)?!1:(fa=ba.da.Aa(271))?fa.thc(Oa):!1}static yti(fa){return fa.top===fa.bottom&&fa.left+1===fa.right||fa.top+1===fa.bottom&&fa.left===fa.right}}N.a3j=268435712;N.JVc=500;Object(u.a)(N,"SelectionReadoutHandler",null,[333,2]);var ea=a(55),Ca=a(697);class la extends e.a{constructor(fa){super();
this.$=fa;this.Fb()}create(){const fa=this.$.da,Oa=B.GetServiceTaskFactory.Oa(fa,211,212,this.Ya),ba=B.GetServiceTaskFactory.Oa(fa,66,134,this.Ya),ka=B.GetServiceTaskFactory.Oa(fa,240,239,this.Ya);let Pa=ea.Task.Ta(null);b.EwaSettings.xb()&&(Pa=B.GetServiceTaskFactory.Oa(fa,244,315,this.Ya));z.TaskExtensions.za(z.TaskExtensions.Ed([Oa,ba,ka,Pa],this.ka),()=>{const Fa=Object(Ca.a)(this.$.da,226,()=>new N(Oa.result,this.$,ba.result,ka.result,Pa.result));this.nb(Fa)},this.$.ka,3)}static la(fa){fa.da.Ga(227,
new la(fa))}}Object(u.a)(la,"SelectionReadoutHandlerFactory",e.a,[]);class Ra{constructor(fa,Oa){this.$=Oa;this.ariaLiveNotifier=fa}xRf(){const fa=this.DNh();this.ariaLiveNotifier.acb(fa,h.a.wpb)}DNh(){const fa=new Sys.StringBuilder;this.$.workbookContext&&w(fa,this.$.workbookContext.WorkbookFileName);w(fa,x.a.instance.ga(854));w(fa,this.FNh());w(fa,this.ENh());w(fa,x.a.instance.ga(855));return fa.toString()}FNh(){return this.$.isEditMode?x.a.instance.ga(859):x.a.instance.ga(860)}ENh(){var fa=this.l2j();
const Oa=this.$.xa.oa;fa=1!==fa?String.format(x.a.instance.mb(32),fa):x.a.instance.ga(853);fa=new Sys.StringBuilder(fa);Oa&&Oa.sheetName&&(fa.append(v.Axd),fa.append(String.format(x.a.instance.mb(33),Oa.sheetName)));return fa.toString()}l2j(){let fa=0;for(const Oa of this.$.xa.items)Oa.visible&&fa++;return fa}}Object(u.a)(Ra,"WorkbookReadout",null,[]);class lb{constructor(fa,Oa,ba){this.mEf=()=>{this.p3d.xRf();this.ariaLiveNotifier.setEnabled(!0)};this.$=Oa;this.ariaLiveNotifier=fa;this.p3d=new Ra(fa,
Oa);this.Uac=ba.Xhd(this.$);this.Uac.eMg(this.mEf)}dispose(){this.Uac&&this.Uac.nhj(this.mEf);this.Uac=this.ariaLiveNotifier=this.$=null}}Object(u.a)(lb,"EmbeddedWorkbookReadoutHandler",null,[2]);class Aa{constructor(fa,Oa){this.iW=()=>{this.Dd||this.Wte()};this.Dd=!1;this.rZ=Oa.nZ;this.ariaLiveNotifier=fa;this.p3d=new Ra(fa,Oa);this.rZ&&this.rZ.dR?this.Wte():this.Nj()}dispose(){this.gk();this.ariaLiveNotifier=this.rZ=null;this.Dd=!0}Nj(){if(this.rZ){this.rZ.lv(this.iW);this.rZ.Da.hw(this.iW);this.rZ.FC(this.iW);
var fa=Object(J.a)(186,this.rZ);fa&&(fa.Vb.Yk(this.iW),fa.ha.hH(this.iW),fa.ha.fH(this.iW),fa.ha.Sa.T2(this.iW))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}gk(){if(this.rZ){this.rZ.Da.ex(this.iW);this.rZ.bE(this.iW);const fa=Object(J.a)(186,this.rZ);fa&&(fa.Vb.Gk(this.iW),fa.ha.kG(this.iW),fa.ha.rL(this.iW),fa.ha.Sa.tna(this.iW))}}Wte(){this.p3d.xRf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.tvj();this.dispose()}}
Object(u.a)(Aa,"WorkbookReadoutHandler",null,[2]);class da extends e.a{constructor(fa){super();this.$=fa;this.Fb()}create(){const fa=B.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Ya);if(this.$.LK){const Oa=B.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya);z.TaskExtensions.za(z.TaskExtensions.Ed([fa,Oa],this.$.ka),()=>{const ba=Object(Ca.a)(this.$.da,228,()=>new lb(fa.result,this.$,Oa.result));this.nb(ba)},this.$.ka,3)}else z.TaskExtensions.za(fa,Oa=>{const ba=Object(Ca.a)(this.$.da,228,()=>
new Aa(Oa.result,this.$));this.nb(ba)},this.$.ka,3)}static la(fa){fa.da.Ga(229,new da(fa))}}Object(u.a)(da,"WorkbookReadoutHandlerFactory",e.a,[]);a.d(F,"a",function(){return aa});const aa=()=>{c.a.Fa(fa=>{A.la(fa);b.EwaSettings.xb()?H.la(fa):T.la(fa);la.la(fa);da.la(fa)})}},1159:function(u,F,a){var c=a(9);u=a(0);var b=a(694),e=a(49),f=a(37),d=a(15),h=a(4),n=a(31),m=a(5),x=a(24),r=a(76),y=a(58);class t{constructor(Va,fb){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=Va;this.sortType=
fb}iV(){return this.autoFilterOptions}}Object(u.a)(t,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[108]);class v{constructor(Va){this.autoFilterOptions=null;this.autoFilterOptions=Va}iV(){return this.autoFilterOptions}}Object(u.a)(v,"MacroRecorderRangeItemFilteredPayload",null,[108]);var w=a(1129),C=a(40),B=a(374),z=a(188),A=a(60),E=a(162),I=a(212),L=a(47),V=a(46),T=a(12),H=a(282),D=a(1),G=a(184),J=a(22),M=a(281),Q=a(21);class U{constructor(Va,fb){this.tableRange=this.tableRanges=null;this.styleIndex=
0;this.tableRanges=Va;this.tableRange=C.l(Va.Ranges[0],Va.SheetName);this.styleIndex=fb}}Object(u.a)(U,"MacroRecorderTableStyleAppliedPayload",null,[108]);class Z extends U{constructor(Va,fb,Ka,hb){super(Va,Ka);this.isCreation=this.hasHeaders=!1;this.hasHeaders=fb;this.isCreation=hb}}Object(u.a)(Z,"MacroRecorderRangeFormatedAsTablePayload",U,[]);class P{constructor(Va,fb,Ka){this.description=this.title=this.tableRange=null;this.tableRange=Va;this.title=fb;this.description=Ka}Bn(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}
Object(u.a)(P,"MacroRecorderTableAltTextEditedPayload",null,[108]);class S{constructor(Va,fb){this.newName=this.oldName=null;this.oldName=Va;this.newName=fb}}Object(u.a)(S,"MacroRecorderTableRenamedPayload",null,[108]);class ja{constructor(Va){this.originalRange=null;this.originalRange=Va}}Object(u.a)(ja,"MacroRecorderTableResizedPayload",null,[108]);class X{constructor(Va,fb,Ka){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=Va;this.optionType=fb;this.isPivotTable=Ka}}
Object(u.a)(X,"MacroRecorderTableStyleOptionToggledPayload",null,[108]);var Y=a(29),va=a(44);class N{constructor(Va){this.tableName=null;this.tableName=Va}}Object(u.a)(N,"MacroRecorderTableConvertedToRangePayload",null,[108]);var ea=a(809);class Ca{constructor(Va,fb,Ka){this.vsd=!1;this.sharedSheetRange=fb;this.$=Va;this.ei=this.$.Kb.Qg("UserAction","ConvertToRangeManager");this.tableName=Ka}ebb(){this.ei.start();const Va=this.$.pa.ya.Wb();return ea.i(this.$.pa.ya,this.sharedSheetRange,fb=>{this.showDialog(fb)},
null,null,null,Va)}showDialog(Va){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.ei.Ac} milliseconds`);Va&&!H.a(Va)&&((this.vsd=Va.Result)?(Va=Y.a.$c(3,2,0,738,0,-66108047,"ConvertToRange"),f.TaskExtensions.za(va.a(this.$).vj(Va),fb=>{d.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.ei.Ac} milliseconds`);0===fb.result&&this.I9g()},this.$.ka,11)):this.J9g());this.ei.stop();
d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.ei.Ac} milliseconds`)}Dye(){const Va={};Va.IsQueryTable=this.vsd;Va.Range=this.sharedSheetRange;return Va}I9g(){const Va=this.$.pa.ya;d.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.egf(194,(fb,Ka,hb)=>ea.d(Va,this.Dye(),fb,Ka,hb,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}J9g(){const Va=this.$.pa.ya;
d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.egf(193,(fb,Ka,hb)=>ea.c(Va,this.Dye(),fb,Ka,hb,null),()=>new N(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}egf(Va,fb,Ka=null){B.a(this.$.userOperationManager,fb,hb=>new z.a(Va,0,hb,void 0,Ka),null)}}Object(u.a)(Ca,"ConvertToRangeManager",null,[]);var la=a(1128),Ra=a(948),lb=a(13);class Aa extends Ra.a{constructor(Va,fb){super(Va);this.ZOb=fb}get qc(){return"FormatAsTableDialog"}get eC(){return 215}get Pl(){return lb.a.instance.ga(732)}ik(){const Va=
C.s(this.aaa.TableRange);return()=>new Z(Va,this.hasHeaders,this.ZOb,!0)}mH(){const Va=C.s(this.aaa.TableRange),fb=this.aaa.HasTotalRow;return(Ka,hb,fc)=>ea.h(this.$.pa.ya,Va,this.hasHeaders,!1,fb,this.ZOb,Ka,hb,fc,null)}}Object(u.a)(Aa,"FormatAsTableReactDialog",Ra.a,[]);Ra=a(284);var da=a(88);class aa extends Ra.a{constructor(Va){super(Va);this.CNj=(fb,Ka)=>{1===fb&&this.jSj(C.D(this.uLf(Ka[aa.JQf])))};this.nxb=fb=>{fb=this.nhd(fb);return this.Eed(fb)};this.gridView=Q.h(Va);this.ra=this.gridView.ha.ra;
this.drc=this.gridView.Bb.Bj(this.ra.activeCell).usedRange;Va=this.oN(this.drc.toString());this.initializeAndShow(lb.a.instance.ga(733),this.CNj,Va)}get qc(){return"ResizeTableDialog"}uLf(Va){Va=Va.startsWith("=")?Va.substring(1,Va.length):Va;if(({sheetName:Va,range:fb}=C.Z(Va,this.$.xa)).returnValue&&fb){var fb=C.v(fb,this.$);fb.SheetName=J.a.equals(Va,"",!0)?this.$.oa.name:Va;return fb}return null}oN(Va){return{[aa.yV]:"ResizeTableDialog",[aa.JQf]:Va,["getInputErrorIfInvalid"]:this.nxb}}nhd(Va){Va=
this.uLf(Va);if(!Va)return 1;const fb=C.D(Va);return J.a.equals(Va.SheetName,this.$.oa.sheetName,!0)&&this.drc.top===fb.top&&this.drc.Cd(fb)?0:2}Eed(Va){let fb="";switch(Va){case 1:fb=lb.a.instance.ga(75);break;case 2:fb=da.a.If(lb.a.instance.ga(74))}return fb}jSj(Va){this.$.Xc(-1400250766,r.a.Db,8,{["ResizeTableRange"]:Va,["OriginalTableRange"]:this.drc})}}aa.yV="id";aa.JQf="range";Object(u.a)(aa,"ResizeTableDialog",Ra.a,[]);class fa extends Ra.a{constructor(Va){super(Va);Va=Q.h(this.$);Va=Va.Bb.Bj(Va.ha.ra.activeCell);
J.a.rh(Va.mUa)?this.yFd="":this.yFd=Va.mUa;J.a.rh(Va.nUa)?this.xFd="":this.xFd=Va.nUa;Va=this.oN(this.yFd,this.xFd);this.initializeAndShow(lb.a.instance.ga(742),this.sNj,Va)}get qc(){return"TableAltTextDialog"}sNj(Va,fb){1===Va&&(Va=fb[fa.WPj],fb=fb[fa.lkh],Va===this.yFd&&fb===this.xFd||this.$.Xc(868579142,r.a.Db,8,{["Title"]:Va,["Description"]:fb}))}oN(Va,fb){return{["id"]:"AltTextDialog",["title"]:Va,["description"]:fb}}}fa.yV="id";fa.WPj="title";fa.lkh="description";Object(u.a)(fa,"TableAltTextDialog",
Ra.a,[]);var Oa=a(773),ba=a(774),ka=a(112),Pa=a(70),Fa=a(55),oa=a(33),La=a(145),Ea=a(102);class ca{constructor(Va,fb,Ka,hb){this.menuId=null;this.uSa=-1;this.VNi=fc=>{if(!H.a(fc)){const wb=Q.h(this.$);var dc=new x.Range(1,1,1,1,!0,!1);dc=C.v(dc,this.$);null!=fc.Result&&(La.a("CreateSampleTable.NewSheet"),dc.SheetName=fc.Result.toString());wb.gg(dc,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.TIf=()=>{this.Eda()};this.JYi=fc=>{if(!(this.ra.TMa()||(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
H.a(fc)||this.kNa())&&H.a(fc)&&this.kNa())){fc=this.ra.activeCell;var dc=this.ra.activeRange;const wb=this.tableManager.Lg.usedRange;2===this.uSa&&E.g(this.tableManager.Lg)&&fc.bottom===wb.bottom&&(dc=dc.R5?new x.Range(dc.top-1,dc.left,dc.bottom-1,dc.right,!1,!0):new x.Range(dc.top,dc.left,dc.bottom-1,dc.right,!1,!0),fc=dc.contains(fc)?fc:x.Range.Qc(dc.bottom,fc.left),Q.h(this.$).ha.updateSelection(dc,fc,0,3))}};this.bYi=fc=>{H.a(fc)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
this.$.df()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.aYi=()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.df()};this.cYi=(fc,dc)=>{dc&&this.FS(dc);H.b(fc,-569193796)&&(Pa.a(this.$).hd.xM(-569193796),this.Xwi(fc.Errors[0]))};this.$=Va;this.tableManager=fb;this.namedSheetViewPublic=Ka;this.frame=this.$.frame;this.ha=Q.h(this.$).ha;this.ra=this.ha.ra;this.Dz=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.vB=oa.a.vB(this.$);this.tableStyleManager=hb;this.tableStyleManager.jNg(this.TIf)}nc(Va,fb){switch(fb){case -544558380:return!(this.tableManager&&this.ra.HK()&&!this.kNa()&&E.d(this.tableManager.Lg));case 1544516694:return!(this.tableManager&&(this.ra.HK()?!this.kNa():this.ra.TMa()));case -697806646:case 323142015:return!this.ra.HK();case 341449783:case 2128797448:return D.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ra.HK()?!this.kNa():
this.ra.TMa())):!(this.tableManager&&this.tableManager.Ftd(this.ra.activeCell));case -123538519:return!(this.ra.HK()&&this.tableStyleManager&&this.tableStyleManager.Gtd());case 756677940:return!(D.EwaSettings.ma(402)&&this.eji());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.fji());case 844144422:return!this.ra.HK();case -723113214:return!this.ra.HK();case 1371713064:case 875133075:return!oa.a.vB(this.$)||Ea.k(this.$.lg)}return!1}executeCommand(Va,fb,Ka){var hb;
Va=f.TaskExtensions.Uj();const fc=this.$.pa.ya;let dc=null,wb=1;const Tb=fb.command,xb=this.$.pa.ya.Wb();let cb=null;if(this.vB)switch(Tb){case -2058042992:case 504133448:case -798968736:case 477776686:I.d(this.$,Ka.TopCellAddress,Tb,null);break;case -1400250766:I.d(this.$,Ka.OriginalTableRange,Tb,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const qa=Q.h(this.$);I.d(this.$,qa.ha.ra.activeCell,Tb,null)}switch(Tb){case -2058042992:const qa=
y.a.ki(Ka[r.a.og]);D.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!qa.CriteriaType&&(qa.CriteriaType=0);ca.M2f(this.$,qa);dc=(W,sa,vb)=>ea.a(fc,qa,null,null,!1,!1,!1,Oa.a.v5a(ka.a.pHa,ba.a.clearAutoFilter,W),sa,vb,null);wb=176;cb=()=>new v(qa);break;case 504133448:case -798968736:case 477776686:const za=y.a.ki(Ka[r.a.og]),Na=Ka.TopCellAddress;ca.M2f(this.$,za);const ua=504133448===fb.command?1:-798968736===fb.command?2:3;if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&
Na){Ka=this.tableManager.Bn(Na);if(!Ka){var jb=this.$.xa.oa;(null===(hb=C.D(jb.Z0))||void 0===hb?0:hb.contains(Na))?Ka=C.D(jb.Z0):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Ka&&!this.$.ZYc([Ka],!0,1))break}else if(Ka&&!this.$.$p([Ka],!0,1))break}dc=(W,sa,vb)=>A.H(fc,za,ua,M.b(W,this.cYi),sa,vb,Na,xb);wb=177;cb=()=>new t(za,ua);break;case 341449783:case 2128797448:this.uSa=341449783===Tb?
0:2;({SCa:dc,operationName:wb,ik:cb}=this.toggleTableStyleOption(fc,xb));break;case -712419744:this.Dz?this.Qff(Ka[m.a.event]):this.Qff(null);break;case 875133075:case 1371713064:let Xa=C.r(this.ra.selectedRanges,this.$);if(!Xa)break;const ha=this.R0h(Ka);dc=(W,sa,vb)=>ea.e(fc,Xa,ha,M.b(W,this.VNi),sa,vb,null,xb);hb="TestHost"===this.$.va.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.va.HostName||hb,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");
wb=1025;break;case 1868184698:if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({sAb:hb,SCa:dc,ik:cb}=this.Dfg(null,xb),hb)){wb=206;break}new la.a(this.$);break;case 844144422:new aa(this.$);break;case 1544516694:case -544558380:if(hb=Ka[r.a.Jc])this.uSa=this.Z2h(hb),-1!==this.uSa&&({SCa:dc,operationName:wb,ik:cb}=this.toggleTableStyleOption(fc,xb));break;case 756677940:if(this.kNa()&&this.Qkf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}const ta=Ka.Text,wa=this.nWh();if(wa){dc=(sa,vb,gc)=>ea.j(fc,ta,wa,M.b(sa,this.bYi),M.a(vb,this.aYi),gc,xb);wb=217;let W=null;this.tableManager.Lg?W=this.tableManager.Lg.name:this.tableManager.dId?W=this.tableManager.dId.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");W&&(cb=()=>new S(W,ta))}else return d.ULS.sendTraceTag(537151175,0,
10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Fa.Task.Ta(!1);break;case 323142015:if(this.kNa())break;return(new Ca(this.$,this.Yed(),this.tableManager.Lg.name)).ebb();case -1400250766:wb=211;dc=this.pmj(Ka,fc,xb);const db=C.m(Ka.OriginalTableRange,this.$.xa.oa);cb=()=>new ja(db);break;case 1872288872:this.tableManager.I8i();break;case -123538519:const Jb=this.Y2h(Ka);hb=J.a.contains(Ka[r.a.Jc],m.a.vIb,!0)||J.a.contains(Ka[m.a.vG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";
d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${hb} with style index ${Jb.toString()}`);let Pb=this.a7e();Pb&&(dc=(W,sa,vb)=>ea.b(fc,Pb,Jb,W,sa,vb,null,xb),cb=()=>new U(Pb,Jb),wb=212);break;case 753331043:hb=Ka[r.a.Jc];if(!hb)break;const eb=Number.parseInvariant(hb);if(this.ra.HK()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${eb}`);let W=this.a7e();W&&(dc=(sa,vb,
gc)=>ea.h(fc,W,!1,!1,!1,eb,sa,vb,gc,null,xb),cb=()=>new Z(W,!1,eb,!1),wb=215);break}if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({sAb:Ka,SCa:dc,ik:cb}=this.Dfg(eb,xb),Ka)){wb=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${eb}`);new Aa(this.$,Number.parseInvariant(hb));break;case 71074531:const Ma=Ka.HasHeader,ob=Ka.TableRange;dc=(W,sa,vb)=>ea.f(fc,ob,Ma,!1,!1,W,sa,vb,null);cb=()=>
new w.a(Ma,ob);wb=206;break;case -723113214:new fa(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");wb=1022;const Ia=Ka.Title,Da=Ka.Description,nb=this.Yed();dc=(W,sa,vb)=>ea.g(fc,Ia,Da,nb,W,sa,vb,null);let Ua;this.tableManager.Lg&&(jb=J.a.rh(this.tableManager.Lg.mUa)?"":this.tableManager.Lg.mUa,Ua=J.a.rh(this.tableManager.Lg.nUa)?"":this.tableManager.Lg.nUa);cb=Ia==jb?()=>new P(nb,void 0,Da):Da==Ua?()=>new P(nb,Ia,void 0):()=>new P(nb,Ia,Da);break;default:return G.a(Tb)}if(dc){const qa=
za=>new z.a(wb,0,za,void 0,cb);Va=!this.namedSheetViewPublic||-2058042992!==Tb&&504133448!==Tb&&-798968736!==Tb&&477776686!==Tb?B.a(this.$.userOperationManager,dc,qa,fb):this.namedSheetViewPublic.xTa().continueWith(za=>{za.result&&B.a(this.$.userOperationManager,dc,qa,fb)})}return Va}toggleTableStyleOption(Va,fb){const Ka=this.ra.TMa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Ka?"PivotTable":"table"} style option ${this.uSa} was toggled.`);const hb=this.Yed();return{SCa:(fc,
dc,wb)=>ea.l(Va,hb,this.uSa,M.b(fc,this.JYi),dc,wb,null,fb),operationName:196,ik:()=>new X(hb,this.uSa,Ka)}}pmj(Va,fb,Ka){const hb=Va.OriginalTableRange,fc=C.m(Va.ResizeTableRange,this.$.xa.oa),dc=()=>{this.tableManager.Fcg(hb)},wb=Tb=>{Tb.Errors&&this.tableManager.Fcg(hb)};return(Tb,xb,cb)=>ea.k(fb,fc,M.b(Tb,wb),M.a(xb,dc),cb,null,Ka)}Y2h(Va){var fb=-1;Va[r.a.Jc]&&(fb=Va[r.a.Jc],fb=J.a.contains(fb,m.a.vIb,!0)?this.tableStyleManager.mxb(fb):Number.parseInvariant(Va[r.a.Jc]));return fb}R0h(Va){return(Va=
Va[r.a.Jc])?Number.parseInvariant(Va):0}wc(Va,fb){Va=!1;switch(fb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:Va=!0;break;case 756677940:Va=D.EwaSettings.ma(402);break;case 875133075:case 1371713064:Va=oa.a.vB(this.$)}return Va}Kc(Va,fb,Ka){Va=
!1;switch(fb){case "PopulateTableMoreStylesMenu":this.menuId=Ka.MenuId;this.tableStyleManager.Gtd()||this.tableStyleManager.z5a("formatAsTableMenu");Va=this.tableStyleManager.QMf(fb,Ka);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Ka.MenuId,this.tableStyleManager.Gtd()||this.tableStyleManager.z5a("accessibilityTab"),Va=this.tableStyleManager.QMf(fb,Ka)}return Va}dispose(){this.tableStyleManager.gij(this.TIf)}Eda(){(J.a.contains(this.menuId,"Format",!0)||J.a.contains(this.menuId,"Accessible",
!0))&&this.menuId&&this.frame.px(this.menuId)}Yed(){return C.v(this.ra.activeCell,this.$)}nWh(){const Va=this.tableManager.Wud;return Va?C.v(Va,this.$):null}Qff(Va){if(this.tableManager){var fb=Q.h(this.$),Ka=this.ra.activeCell,hb=this.tableManager.Bn(Ka),fc=null;if(!hb||hb.EBa)for(let dc of fb.gia)for(let wb of dc)fb=wb.Mt,Ka.left>=fb[0]&&Ka.left<=fb[fb.length-1]&&(fc=(fb=wb.us(Ka).vK())?T.DOMElementExtensions.nk(fb,n.a.fte):null);else{const dc=fb.Sb(x.Range.Qc(hb.top,Ka.left));if(this.Dz){L.a.instance.create(()=>
{dc.invoke(8,Va)},0,V.a.ycg,!0,!0);return}fc=dc.oLa(56).N6a}fc&&L.a.instance.create(()=>{T.DOMElementExtensions.Ugc(fc,null)},0,V.a.ycg,!0,!0)}}Z2h(Va){Va=Number.parseInvariant(Va);return-1<Va&&8>=Va?Va:-1}kNa(){return!this.tableManager.Lg}Qkf(){return this.tableManager.dId?!1:(d.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}fji(){const Va=this.ra.HK(),fb=this.ra.Pg&&!Q.h(this.$).Bb.J5(this.ra.dd);return Va||fb}eji(){return this.ra.HK()||
!this.Qkf()}b3h(Va){const fb=[];for(const Ka of Va)if(Va=I.b(this.$,Ka),null===Va||void 0===Va?0:Va.length)for(const hb of Va)hb.usedRange&&!fb.includes(hb.usedRange)&&fb.push(hb.usedRange);return fb}a7e(){const Va=this.ra.selectedRanges;let fb=[];if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))fb=this.b3h(Va);else for(const Ka of Va)Q.h(this.$).Bb.J5(Ka)&&fb.push(Ka);return fb&&fb.length?C.r(fb,this.$):null}FS(Va){oa.a.sla(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,
430,431,1),fb=>{fb.result.Nea(Va);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ka,3)}Xwi(Va){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,446,447,0),fb=>{fb.result.Jfh(this.$,Va)},this.$.ka,3)}static M2f(Va,fb){fb.SheetName=Va.oa.name;fb.NamedObjectView=Va.ea.isNamedObjectViewMode}Dfg(Va,fb){let Ka,hb;if(!this.ra.Pg||1!=this.ra.dd.RC)return{sAb:!1,SCa:Ka,ik:hb};let fc=C.v(this.ra.dd,this.$);fc.LastColumn=fc.FirstColumn+
3-1;fc.LastRow=fc.FirstRow+4-1;const dc=C.D(fc),wb=Q.h(this.$);if(!dc.Kz||!wb.Bb.Gxa(dc))return{sAb:!1,SCa:Ka,ik:hb};h.AFrameworkApplication.Ip("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{sAb:!1,SCa:Ka,ik:hb};if(null==Va)Ka=(Tb,xb,cb)=>ea.f(this.$.pa.ya,fc,!1,!1,!1,Tb,xb,cb,fb),hb=()=>new w.a(!1,fc);else{const Tb=C.s(fc);Ka=(xb,cb,jb)=>ea.h(this.$.pa.ya,Tb,!1,!1,!1,Va,
xb,cb,jb,fb);hb=()=>new Z(Tb,!1,Va,!0)}return{sAb:!0,SCa:Ka,ik:hb}}}Object(u.a)(ca,"TableCommandHandler",null,[208]);class $a extends b.a{constructor(Va){super(Va)}dispose(){super.dispose()}ld(){const Va=e.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),fb=e.GetServiceTaskFactory.create(this.$.da,330,this.ka,this.Ya),Ka=e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Ya);if(oa.a.vB(this.$)){const hb=e.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Ya);f.TaskExtensions.za(Fa.Task.jJ(Va,
Ka,fb,hb),()=>{this.Zc([new ca(this.$,Va.result,Ka.result,fb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.ka,3)}else f.TaskExtensions.za(Fa.Task.jJ(Va,Ka,fb),()=>{this.Zc([new ca(this.$,Va.result,Ka.result,fb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.ka,3)}static la(Va){b.a.Nd(86,new $a(Va))}}Object(u.a)($a,"TableCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return Qa});const Qa=()=>{c.a.Fa(Va=>
{$a.la(Va)})}},1165:function(u,F,a){u=a(0);var c=a(84),b=a(553),e=a(15);class f{constructor(){this.vGc={}}XFg(Ra){this.vGc[Ra.id.toString()]=Ra}pJi(Ra){const lb=this.vGc;for(let Aa in lb)lb[Aa].notify(Ra,!1);this.vGc={}}N7i(Ra,lb){lb&&this.XFg(lb);return this.aHf(Ra,lb)}b$c(Ra){this.pJi(Ra)}ePe(Ra,lb){Ra.notify(lb,!0)}}Object(u.a)(f,"AEventEmitter",null,[330]);var d;(function(Ra){Ra[Ra.notStarted=0]="notStarted";Ra[Ra.waiting=1]="waiting";Ra[Ra.shouldRetry=2]="shouldRetry";Ra[Ra.complete=3]="complete"})(d||
(d={}));Object(u.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(Ra){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[Ra]},"ResultType",this.C6e());this._state=Ra}}Object(u.a)(h,"AEventResult",null,[381]);class n extends h{constructor(){super();this.LTc=this.Nlb=null;this.state=0;this.FMc=this.fbe=!1}get LR(){return this.Nlb}get Doa(){return this.LTc}get Ahi(){return this.fbe}C6e(){return"GetMoreInfo Result"}}
Object(u.a)(n,"GetMoreInfoResult",h,[380,381]);var m=a(4),x=a(80),r=a(39),y=a(687),t=a(376),v=a(164),w=a(643),C=a(576),B=a(106),z=a(25);class A{constructor(Ra,lb,Aa,da,aa,fa,Oa,ba){this.La=Ra;this.Ah=lb;this.Frg=Aa;this.J1=da;this.he=aa;this.jLc=fa;this.swg=Oa;this.PYb=ba}mcj(){this.n$a.Nb(z.a.openUrlInNewTab,B.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.n$a.Nb(z.a.bQa,B.a.frame,Object(c.a)(this,this.bQa,"openDocumentUrl"));m.AFrameworkApplication.YM?this.Arf():this.n$a.Ne(z.a.O8b,
B.a.frame,Object(c.a)(this,this.O8b,"documentLoaded"),96)}openUrlInNewTab(Ra,lb,Aa,da,aa){aa&&aa.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:aa.SourceControlId,["AppType"]:C.a[this.Fca]}),r.a.lf(aa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}bQa(Ra,lb,Aa,da,aa){if(aa&&aa.MenuItemId){const fa=m.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),Oa=m.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");
e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",fa,Oa);if(fa&&Oa){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:aa.SourceControlId,["AppType"]:C.a[this.Fca]});Ra=aa.MenuItemId.toString();const ba={};ba[t.a.YQa]="1";ba[t.a.documentUrl]=Ra;ba[t.a.reason]=w.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");m.AFrameworkApplication.pV().execute(ka=>{ka.Rj(v.a.tua,ba)})}else this.openUrlInNewTab(Ra,
lb,Aa,da,aa)}return 32}O8b(){this.Arf();return 32}IOa(Ra,lb,Aa=""){if(lb&&lb.MF){const da=y.a[lb.status];lb=lb.MF.getTime();const aa=this.Bw()-lb;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:Ra,["RequestStatus"]:da,["ElapsedMs"]:aa,["StartTime"]:lb,["Notes"]:Aa})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Ra})}Arf(){var Ra=m.AFrameworkApplication.fa.qa("QPGVCI"),lb=x.a.iy(document.URL,
"wdNewAndOpenCt",Ra);if(lb){lb=parseInt(lb);var Aa=x.a.iy(document.URL,"wdPreviousSession",Ra);Ra=x.a.iy(document.URL,"wdPreviousCorrelation",Ra);var da=m.AFrameworkApplication.fa.qa("NAOPLP");if(m.AFrameworkApplication.YM){var aa=m.AFrameworkApplication.YM.getTime();!lb||lb>aa?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:lb,["DocumentLoadedTime"]:aa,["SessionId"]:Aa,["Correlation"]:Ra}):e.ULS.sendTraceTag(5849683,202,
da?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:aa-lb,["ClickTimestamp"]:lb,["SessionId"]:Aa,["Correlation"]:Ra})}else e.ULS.sendTraceTag(5849681,202,da?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:lb,["SessionId"]:Aa,["Correlation"]:Ra})}}get n$a(){return this.La.value}get gFb(){return this.Ah.value}get Swf(){return this.Frg.value}get Fca(){return this.J1.value}get Knc(){return this.he.value}get Bw(){return this.jLc}get d0(){return this.swg.value}get supportsGetMoreInfoForPersonalStorage(){return this.PYb.value}static get instance(){return A.Ma||
(A.Ma=A.iN())}static iN(){return new A(new b.a(()=>m.AFrameworkApplication.ub),new b.a(()=>m.AFrameworkApplication.zd),new b.a(()=>m.AFrameworkApplication.ta),new b.a(()=>m.AFrameworkApplication.ta.Pa.Hj),new b.a(()=>m.AFrameworkApplication.Fi),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.ta.Pa.d0),new b.a(()=>m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}A.Ma=null;Object(u.a)(A,"NewAndOpenCommonHelpers",null,[329]);var E=a(107);class I{constructor(Ra,lb,Aa){this.aYb=
this.Xi=null;this.YRc=0;this.gCg=Ra;this.he=lb;this.C8d=Aa}XOg(){this.YRc=this.kdb+1}jOd(Ra){this.Xi&&(this.he.np(this.Xi),this.Xi=null);Ra&&(this.YRc=0)}CKj(Ra){const lb=this.LPj;0<=lb?(this.XOg(),this.jOd(!1),this.Xi=new E.a(4,1,lb,Ra,107),this.he.Fg(this.Xi)):(this.jOd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.C8d}))}get kdb(){return this.YRc}get LPj(){return this.kdb>=this.m2f.length?-1:this.m2f[this.kdb]}get m2f(){if(!this.aYb){const Ra=(this.gCg.value||"0").split(",");
this.aYb=[];for(let lb=0;lb<Ra.length;lb++){const Aa=parseInt(Ra[lb]);isNaN(Aa)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.C8d,["Entry"]:Ra[lb]}):Array.add(this.aYb,Aa)}}return this.aYb}}Object(u.a)(I,"RetryHelper",null,[]);var L=a(41),V=a(30);class T extends f{constructor(Ra,lb){super();this.o2=Ra;this.omb=new I(lb,this.KEb.Knc,"GetMoreInfo");this.$o=new n}zDi(){this.wyd("Document opened")}bdh(Ra){return()=>{this.wyd(Ra,!0)}}aHf(Ra,lb=
null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Ra});3===this.$o.state?(lb&&this.ePe(lb,this.$o),e.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Ra})):this.wyd(Ra);return this.$o}wyd(Ra,lb=!1){this.omb.jOd(!lb);1===this.$o.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Ra,["RetryIndex"]:this.omb.kdb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",
{["Trigger"]:Ra,["RetryIndex"]:this.omb.kdb}),this.$o.state=1,lb=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.KEb.d0,m.AFrameworkApplication.Hi),this.KEb.gFb.bha(lb,1,null,null,[T.she,T.rle],!1,5,this.ech(),this.dch(Ra),null))}ech(){return Ra=>{var lb=!1;let Aa=!1;var da=!1,aa;m.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(Ra.data.ve?({Ft:aa}=L.d(Ra.data.ve)).returnValue?aa?(da=!0,this.$o.LTc=aa.StorageServiceDisplayName,this.$o.Nlb=T.knf(aa.PersonalFileStorageUrl)?aa.PersonalFileStorageUrl:
"",""===this.$o.LR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Xa("FileSource")&&(this.$o.Nlb=x.a.Gda(m.AFrameworkApplication.breadcrumbFolderUrl)),lb=""===this.$o.LR&&""!==this.$o.Doa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));da||((aa=Ra.data.responseHeaders)?(this.$o.LTc=(aa[T.rle]||"").toString(),lb=(aa[T.she]||"").toString(),this.$o.Nlb=T.knf(lb)?lb:"",""===this.$o.LR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Xa("FileSource")?(this.$o.Nlb=x.a.Gda(m.AFrameworkApplication.breadcrumbFolderUrl),lb=""===this.$o.LR&&""!==this.$o.Doa):lb=""===lb&&""!==this.$o.Doa):(e.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),Aa=!0));da=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.omb.kdb,Aa,lb,da);this.KEb.IOa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Ra.data,da);this.F2f(3,lb,Aa)}}dch(Ra){return lb=>{this.KEb.IOa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",lb.data,"Failure");this.F2f(2);this.omb.CKj(this.bdh(Ra))}}F2f(Ra,lb=!1,Aa=!1){this.$o.state=Ra;this.$o.fbe=
lb;this.$o.FMc=Aa;this.b$c(this.$o)}get KEb(){return this.o2.value}static get instance(){return T.Ma||(T.Ma=T.iN())}static iN(){return new T(new b.a(()=>A.instance),new b.a(()=>m.AFrameworkApplication.yXh))}static knf(Ra){if(!Ra)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(V.a.vl(Ra).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}T.she="PersonalFileStorageUrl";T.rle=
"StorageServiceDisplayName";T.Ma=null;Object(u.a)(T,"GetMoreInfoActor",f,[]);var H=a(103),D=a(97);class G{constructor(Ra,lb,Aa,da,aa){this.Zwg=6E4;this.Hdf="inactive";this.boe="active";this.jT=!0;this.he=Ra;this.Zvg=lb;this.jLc=Aa;this.bZb=da;this.fb=new D.a;aa&&this.uKj();this.hde=this.e4e()}Toe(Ra){this.fb.addHandler(this.boe,Ra)}vIg(Ra){this.fb.addHandler(this.Hdf,Ra)}uKj(){const Ra=new E.a(5,2,this.Zwg,Object(c.a)(this,this.Hci,"inactiveLoop"),108);this.Ici.Fg(Ra)}Hci(){const Ra=this.e4e(),lb=
this.Bw()-Ra;lb>this.kCc&&this.jT&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:lb}),this.jT=!1,this.fb.raiseEvent(this.Hdf));Ra-this.hde>this.kCc&&(this.jT=!0,this.fb.raiseEvent(this.boe));this.hde=Ra}get Ici(){return this.he.value}get e4e(){return this.Zvg}get Bw(){return this.jLc}get kCc(){return this.bZb.value}static get instance(){return G.Ma||(G.Ma=G.iN())}static iN(){return new G(new b.a(()=>H.a.instance),()=>m.AFrameworkApplication.xvd.getTime(),()=>
(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.kCc),!0)}}G.Ma=null;Object(u.a)(G,"InactivityManager",null,[]);var J=a(83),M=a(907);class Q extends h{constructor(){super();this.qfe=this.sfe=this.rfe=null;this.state=this.jme=0;this.FMc=!1}get Zzd(){return this.rfe}get dwf(){return this.sfe}get Yzd(){return this.qfe}get RPj(){return this.jme}C6e(){return"MruActor Result"}}Object(u.a)(Q,"MruResult",h,[383,381]);var U=a(240);class Z{constructor(Ra,lb,Aa){this.task=null;this.ugc=Ra;this.dFi=lb;
this.taskManager=Aa;this.retryCount=this.Yzb=0;this.gRc=this.TCb=null}Tpi(Ra,lb){return Ra===U.a.Idd||20===lb||18===lb||3===lb}eri(Ra){return 3===Ra||5===Ra||6===Ra||7===Ra||9===Ra||10===Ra||11===Ra||12===Ra||13===Ra||14===Ra||15===Ra||16===Ra||23===Ra||26===Ra||27===Ra||28===Ra}get Psc(){return this.gRc}reset(){this.Yzb=this.retryCount=0;this.gRc=this.TCb=null;this.task&&(this.taskManager.np(this.task),this.task=null)}Igi(Ra,lb,Aa,da){this.gRc=String.format("{0}_{1}",Aa,da);if(this.retryCount>=this.dFi)return e.ULS.sendTraceTag(562656907,
202,50,"Max retries exceeded"),!1;if(this.Tpi(Aa,da))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.eri(da)&&1<=this.Yzb)return this.TCb=Aa,!1;lb=Math.max(lb,this.ugc*Math.pow(2,this.Yzb));if(26===da)lb=Math.max(lb,3E4);else if(27===da||28===da)lb=Math.max(lb,6E4);9===da||412===Aa&&(null==this.TCb||412!==this.TCb)?lb=500:this.Yzb+=1;this.TCb=Aa;this.retryCount+=1;this.task&&this.taskManager.np(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
lb);this.task=new E.a(2,1,lb,Ra,107);this.taskManager.Fg(this.task);return!0}}Object(u.a)(Z,"RetryManager",null,[]);var P=a(98),S=a(136),ja=a(137);class X{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(u.a)(X,"WriteOptions",null,[]);var Y=a(557),va=a(189);class N extends f{constructor(Ra,lb,Aa,da,aa,fa,Oa){super();this.o2=Ra;this.Oyg=lb;this.xra=new Z(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.OD.Knc);this.Xra=new Z(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.OD.Knc);this.eBg=Aa;this.xne=da;this.oFg={};this.nT=new Q;this.Vvg=aa;this.mWb="";this.Zv=fa;this.A9d=Oa}get DFc(){return this.oFg}eej(){this.OD.n$a.Nb(z.a.renameMostRecentlyUsedFileEntry,
B.a.frame,Object(c.a)(this,this.$ij,"renameMruEntry"))}$ij(){return this.x3d("Rename")}HDi(){this.guf("File Opened")}IDi(){this.guf("IntervalUpdate")}guf(Ra){e.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:Ra});this.x3d(Ra)}H4(Ra){(Ra=V.a.H4(Ra))&&Ra.startsWith(".")&&(Ra=Ra.substring(1,Ra.length));return Ra}h0e(){switch(this.OD.Fca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}F4h(Ra){var lb=
this.Vvg();if(!lb)return null;const Aa=new X;Aa.documentUrl=this.A9d.value?encodeURI(lb):lb;Aa.mruItemId=this.mWb;Aa.app=this.h0e();if(lb=this.Zv())Aa.folderName=lb.breadcrumbFolderName,lb=lb.sn,Aa.documentName=V.a.Pq(lb),Aa.documentExt=this.H4(lb);Ra&&(Aa.documentName?Aa.documentName.length?255<=Aa.documentName.length?Ra.set("DocumentNameLength","Long"):2084<=Aa.documentName.length&&Ra.set("DocumentNameLength","VeryLong"):Ra.set("DocumentNameLength","0"):Ra.set("DocumentNameLength","Null"));return JSON.stringify(Aa)}x3d(Ra,
lb=!1){if(4===this.OD.Fca&&!m.AFrameworkApplication.sua)return 2;var Aa=S.a.gs();Aa&&(Aa.set("Trigger",Ra),Aa.set("IsRetry",lb?"true":"false"),Aa.set("MruIdSent",this.mWb?"true":"false"),Aa.set("URLEncoded",this.A9d.value?"true":"false"));P.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Aa);Ra=this.F4h(Aa);if(!Ra)return lb=!m.AFrameworkApplication.webEditingEnabled,Aa&&(Aa.set("WebEditingIsEnabled",m.AFrameworkApplication.webEditingEnabled?"true":"false"),Aa.set("ProtectedFile",m.AFrameworkApplication.Zsc?
"true":"false")),P.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",lb,!1,Object.assign(new va.a,{extendedProperties:Aa})),2;this.Xra&&!lb&&this.Xra.reset();Aa=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.OD.d0,this.localeName);this.xne?this.DFc["X-FileId"]=m.AFrameworkApplication.Hi:Aa+=String.format("&{0}",m.AFrameworkApplication.Hi);m.AFrameworkApplication.Qb&&(this.DFc["X-Office-AudienceGroup"]=Object(J.a)(String,m.AFrameworkApplication.Qb.AudienceGroup)||"");this.DFc["X-Timeout"]=
15E3;return this.OD.gFb.Pm(Aa,2,Ra,this.DFc,!0,5,Object(c.a)(this,this.J3j,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.Mgh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}J3j(Ra){this.E$e(Ra.data)}E$e(Ra){const lb=S.a.gs();this.Xra&&(lb&&this.Xra.Psc&&(lb.set("LastError",this.Xra.Psc),lb.set("NumRetries",this.Xra.retryCount.toString())),this.Xra.reset());const Aa=M.c(Ra.ve);Aa&&Aa.diagnostics_data&&(this.mWb=Aa.diagnostics_data.mru_id);Ra=
+Ra.E3-+Ra.MF;lb&&lb.set("RequestDuration",Ra.toString());P.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new va.a,{extendedProperties:lb}))}Mgh(Ra){if(Ra.data.httpStatus===U.a.Xsb)this.E$e(Ra.data);else{var lb=Ra.data.httpStatus===U.a.nIb,Aa=S.a.gs();this.R$e(this.Xra,Ra,this.zgh(),Aa);Aa&&(Aa.set("StatusCode",Ra.data.httpStatus.toString()),lb||this.rWc(Ra.data,Aa));P.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ra.data.httpStatus),lb,!1,Object.assign(new va.a,
{extendedProperties:Aa}))}}zgh(){return()=>{this.x3d("Retry",!0)}}EXh(){this.Kmc("Polling")}DXh(){this.Kmc("Retry",!0)}BDi(){this.Kmc("Open")}ADi(){this.Kmc("Activity")}Kmc(Ra,lb=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Ra});const Aa=S.a.gs();Aa&&(Aa.set("Trigger",Ra),Aa.set("IsRetry",lb?"true":"false"));P.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Aa);this.xra&&!lb&&this.xra.reset();this.fch(Object(c.a)(this,this.GXh,"getMruV2FromServerSuccessCallback"),
Object(c.a)(this,this.CXh,"getMruFromServerFailureCallback"))}rWc(Ra,lb){Ra&&Ra.responseHeaders&&(Ra=Ra.responseHeaders["X-CorrelationId"])&&lb.set("ServerCorrelationId",Ra)}oAi(Ra,lb){Ra&&(lb&&lb.set("RequestDuration",(+Ra.E3-+Ra.MF).toString()),P.Health.instance.recordKpiSuccess("GetMru",Object.assign(new va.a,{extendedProperties:lb})))}GXh(Ra){this.HXh(Ra)}HXh(Ra){var lb="";let Aa=null,da=null,aa=null;const fa=M.c(Ra.data.ve);fa&&(Aa=fa.places?fa.places.items:[],da=fa.documents?fa.documents.items:
[],(aa=M.a(fa,!1))&&(lb=L.c(aa)));m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pa.A_&&ja.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(lb,!0));lb=S.a.gs();this.xra&&(lb&&this.xra.Psc&&(lb.set("LastError",this.xra.Psc),lb.set("NumRetries",this.xra.retryCount.toString())),this.xra.reset());aa||Aa||da?(this.OD.IOa("MruActor.GetMruV2FromServerSuccessCallback",Ra.data,"Success"),this.fEc(3,aa,Aa,da),this.oAi(Ra.data,lb)):(this.OD.IOa("MruActor.GetMruV2FromServerSuccessCallback",
Ra.data,"Failure: Invalid JSON"),lb&&this.rWc(Ra.data,lb),P.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new va.a,{extendedProperties:lb})),this.fEc(3,null,null,null,!0));this.b$c(this.nT)}R$e(Ra,lb,Aa,da){let aa=0,fa=0;const Oa=M.c(lb.data.ve);Oa&&(null!=Oa.response_code&&(aa=Oa.response_code,da&&da.set("MruResponseCode",aa.toString()),9===aa&&(this.mWb="")),Oa.error_data&&null!=Oa.error_data.retry_after_ms&&(fa=Oa.error_data.retry_after_ms,da&&da.set("ExpectedRetryAfter",
fa.toString())));Ra&&(lb=Ra.Igi(Aa,fa,lb.data.httpStatus,aa),da&&(da.set("CurrentRetryCount",Ra.retryCount.toString()),da.set("RetryScheduled",lb?"true":"false")))}CXh(Ra){this.FXh(Ra)}FXh(Ra){const lb=Ra.data.httpStatus===U.a.nIb,Aa=S.a.gs();Aa&&(Aa.set("StatusCode",Ra.data.httpStatus.toString()),lb||this.rWc(Ra.data,Aa));this.OD.IOa("MruActor.GetMruFromServerFailureCallback",Ra.data,"Failure");this.fEc(2);this.R$e(this.xra,Ra,Object(c.a)(this,this.DXh,"getMruFromServerRetryTask"),Aa);P.Health.instance.recordKpiFailure("GetMru",
String.format("RequestFailed_{0}",Ra.data.httpStatus),lb,!1,Object.assign(new va.a,{extendedProperties:Aa}));this.b$c(this.nT);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pa.A_&&ja.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}fEc(Ra,lb=null,Aa=null,da=null,aa=!1){if(3!==this.nT.state||3===Ra)this.nT.rfe=lb,this.nT.sfe=Aa,this.nT.qfe=da,this.nT.state=Ra,this.nT.FMc=aa,this.nT.jme=this.OD.Bw()}aHf(Ra,
lb){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Ra,["ResultState"]:this.nT.state});lb&&3===this.nT.state&&this.ePe(lb,this.nT);return this.nT}fch(Ra,lb){this.fEc(1);let Aa;const da={};Aa=String.format(this.OD.d0+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.h0e(),this.localeName);this.eBg.value||(Aa+="&entity=docs");m.AFrameworkApplication.Qb&&(da["X-Office-AudienceGroup"]=Object(J.a)(String,m.AFrameworkApplication.Qb.AudienceGroup)||"");this.xne?
da["X-FileId"]=m.AFrameworkApplication.Hi:Aa+=String.format("&{0}",m.AFrameworkApplication.Hi);this.OD.gFb.Pm(Aa,1,null,da,!0,5,Ra,lb,null)}get OD(){return this.o2.value}get localeName(){return this.Oyg.value}static get instance(){return N.Ma||(N.Ma=N.iN())}static iN(){return new N(new b.a(()=>A.instance),new b.a(()=>Y.a.uK(m.AFrameworkApplication.lcid).name),new b.a(()=>m.AFrameworkApplication.ta.Pa.Iv),m.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>m.AFrameworkApplication.ta.Pa.Ox,
()=>m.AFrameworkApplication.sm,new b.a(()=>m.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}N.Ma=null;Object(u.a)(N,"MruActor",f,[]);class ea{constructor(){this.pnb=this.rie=this.gb=null;this.Lm=!1}get name(){return"Common.App.NewAndOpen.Core"}Xh(Ra){this.gb=Ra;Ra.register(329,"Common.INewAndOpenCommonHelpers").xc().Fc(()=>A.instance);Ra.register(330,"Common.IEventEmitter<Common.IGetMoreInfoResult>").xc().Fc(()=>T.instance);Ra.register(330,"Common.IEventEmitter<Common.IMruResult>").xc().Fc(()=>
N.instance)}init(){m.AFrameworkApplication.fa.Ev(()=>{this.Kzb()})}Kzb(){this.gb.resolve("Common.INewAndOpenCommonHelpers");this.gb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.gb.resolve("Common.IEventEmitter<Common.IMruResult>");var Ra=!1;A.instance.mcj();m.AFrameworkApplication.fma&&(Ra=!0);m.AFrameworkApplication.sRf&&(N.instance.BDi(),0<m.AFrameworkApplication.ewf&&this.ype(),this.oAj(),Ra=!0);m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Ra&&T.instance.zDi();
m.AFrameworkApplication.vYj&&(Ra=N.instance,Ra.eej(),Ra.HDi(),H.a.instance.Fg(this.wYj))}oAj(){G.instance.Toe(Object(c.a)(N.instance,N.instance.ADi,"makeGetMruRequestActivityTrigger"));G.instance.Toe(Object(c.a)(this,this.ype,"addGetMruFromServerTask"));G.instance.vIg(Object(c.a)(this,this.Qjh,"deleteGetMruFromServerTask"))}Qjh(){H.a.instance.np(this.fwf)}ype(){H.a.instance.Fg(this.fwf)}get fwf(){return this.rie||(this.rie=new E.a(5,2,m.AFrameworkApplication.ewf,Object(c.a)(N.instance,N.instance.EXh,
"getMruFromServerTask"),109))}get wYj(){return this.pnb||(this.pnb=new E.a(2,2,6E4*m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(N.instance,N.instance.IDi,"makeUpdateMruTask"),197))}dispose(){this.Lm||(this.Lm=!0,this.pnb&&(H.a.instance.np(this.pnb),this.pnb=null))}}Object(u.a)(ea,"CorePackageManager",null,[3,4,2]);var Ca=a(248);a.d(F,"a",function(){return la});const la=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");
Ca.a.instance.Ei(new ea)}},1169:function(u,F,a){u=a(0);var c=a(4),b=a(222),e=a(15),f=a(84),d=a(54),h=a(196);class n{constructor(){this.hke=this.PSc=!1;const Ka=c.AFrameworkApplication.yk;0>=Ka||(this.yk=Ka,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.yk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Dha}),h.a.instance.EXc(Object(f.a)(this,this.SPa,"onSessionExpiredDetected")),h.a.instance.CXc(Object(f.a)(this,this.XHf,
"onSessionExpiringDetected")))}SPa(){h.a.instance.JMd(Object(f.a)(this,this.SPa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.f9h()}XHf(){h.a.instance.IMd(Object(f.a)(this,this.XHf,"onSessionExpiringDetected"));this.hke||this.PSc||(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.hke=!0,this.fHj())}f9h(){this.PSc||(c.AFrameworkApplication.mG(d.a.Hxc),this.PSc=!0,this.eHj())}}Object(u.a)(n,"ASessionExpirationManager",
null,[]);var m=a(89),x=a(38),r=a(29),y=a(13),t=a(44),v=a(250),w=a(6),C=a(81),B=a(253),z=a(70);class A extends n{constructor(Ka){super();this.Ra=new x.a;this.AH=this.inb=!1;this.$=Ka}Vre(Ka){this.Ra.addHandler("SessionExpired",Ka)}Dob(Ka){this.Ra.addHandler("TokenRefreshed",Ka)}Xuc(Ka){this.Ra.removeHandler("TokenRefreshed",Ka)}get accessTokenExpiringMessage(){const Ka=(new Date(this.yk)).format(this.$.va.ShortTimeFormat);return String.format(y.a.instance.mb(78),Ka)}get tokenExpired(){return this.inb}get veb(){return!1}get bca(){return!1}get OKd(){return!1}get Y5(){return!1}afc(){return h.a.instance.lR(c.AFrameworkApplication.yk)}dispose(){m.a.Ia(this.Ra);
this.$=null}fHj(){this.$.isEditMode&&this.Bec(!1)}eHj(){this.inb=!0;this.Bec(!0);this.Ra.raiseEvent("SessionExpired")}Bec(Ka){e.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${Ka}, GotDeploymentOrTimedOutError ${this.$.ea.S4}`);const hb=this.$.rb.kp;Ka&&hb&&hb.isVisible&&1299163859===hb.error.MessageId&&this.$.rb.kp.sv();const fc=this.$c(Ka);t.a(this.$).Ls(new v.a(w.a.ey,5,()=>{const dc=z.a(this.$),wb=dc.hd.activityState;wb[C.a.J2]=this.$.xqb(this.$.isEditMode);
wb[C.a.wM]=C.a.k$a;wb[B.a.Hq]=w.a.accessTokenExpiringWarning;dc.hd.rr([fc])}))}$c(Ka){return Ka?r.a.eJe():this.vfh()}vfh(){const Ka=r.a.$c(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");Ka.Description=this.accessTokenExpiringMessage;return Ka}}Object(u.a)(A,"EwaAccessTokenExpirationManager",n,[541,542,2]);var E=a(7),I=a(171),L=a(80),V=a(641),T=a(28);class H{constructor(Ka,hb){this.uJb=!1;this.correlationID=Ka;this.Q6c=hb;this.wCc=!1;this.creationTime=T.a.Qa.zb}}Object(u.a)(H,"RefreshAccessTokenContext",
null,[]);var D=a(58),G=a(60),J=a(172),M=a(46),Q=a(110),U=a(118),Z=a(1),P=a(22),S=a(143),ja=a(36),X=a(115);class Y{}Object(u.a)(Y,"Error",null,[]);class va{}Object(u.a)(va,"NamedResult",null,[]);class N extends va{}Object(u.a)(N,"ErrorInfo",va,[]);class ea{constructor(Ka,hb){this.eZb=Ka;this.TG=hb}get tokens(){return this.eZb}get errors(){return this.TG}}Object(u.a)(ea,"TokenRefreshArgs",null,[470]);class Ca{constructor(Ka,hb){this.documentVisibilityObserver=null;this.Ra=new x.a;this.Kx=null;this.mfb=
this.gmb=!1;this.Vtc=null;this.zJb=!1;this.wxd=!0;this.sde=this.Qce=this.AH=this.inb=!1;this.aT=null;this.F$e=()=>{if(this.$.ea.Zb)this.daf(!1);else if(this.wxd){this.wxd=!1;const fc=z.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${fc.gi?fc.gi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Udg()}]`)}};this.Tc=(fc,dc)=>{this.context&&(fc=this.$.ea,dc.VH&&this.context.uJb&&
!this.context.wCc?(this.context.wCc=!0,dc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},dc.IsUserActive=fc.Re.Ir,dc.RefreshAccessTokenCorrelationID=this.context.correlationID,dc=D.a.hc(dc),e.ULS.sendTraceTag(537170708,0,50,dc)):!this.gmb||fc.Zb||this.context.Q6c||(dc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Kx&&(this.Kx.cancel(),dc.Aborted=!0,dc.ResetStopRefreshRetriesUntilTokenExpired=!0,
this.mfb=!1),dc.TimeUntilTokenExpirationInMin=this.Udg(),dc.RefreshAccessTokenCorrelationID=this.context.correlationID,dc=D.a.hc(dc),e.ULS.sendTraceTag(572019856,0,50,dc)))};this.oza=()=>{if(this.context&&this.context.uJb&&!this.context.wCc){var fc={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};fc.CreatedForExpired=this.context.Q6c;fc.RefreshAccessTokenCorrelationID=this.context.correlationID;fc.OpenWorkbookErrors=r.a.sc(this.$.ea.dG);fc.ExecutionContextErrors=r.a.sc(z.a(this.$).hd.errors);
fc.accesstokenTTL=c.AFrameworkApplication.yk;fc=D.a.hc(fc);e.ULS.sendTraceTag(537170707,0,15,fc)}};this.caf=()=>{this.mfb=!1;this.daf(!0)};this.$Ed=()=>{this.zJb&&(this.$.ea.Re.BAa(this.$Ed),this.zJb=!1);this.wag()};this.$=Ka;this.IZd=hb;this.LKd=Ka.Kb.Qg("WebServiceCall","refreshToken");h.a.instance.EXc(this.caf);h.a.instance.CXc(this.F$e);hb=this.$.ea;hb.Wj(this.Tc);hb.n0b(this.oza);this.jGi=this.$.va.MinTokenLifetimeForRegularExpirationPromptInMin;this.M6f=this.$.va.ShortAccessTokenExpirationPromptSeconds;
this.CSf=this.$.va.RefreshAccessTokenDurationLimitInSec;this.Jjg(Ka.ea.XKf,c.AFrameworkApplication.yk);Ka=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.yk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Dha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.l3d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.n3d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${Ka}`);this.$.da.$a(291,fc=>{this.documentVisibilityObserver=
fc})}Vre(Ka){this.Ra.addHandler("SessionExpired",Ka)}Dob(Ka){this.Ra.addHandler("TokenRefreshed",Ka)}Xuc(Ka){this.Ra.removeHandler("TokenRefreshed",Ka)}get tokenExpired(){return this.inb}get bca(){return this.Qce}get Y5(){return this.sde}get context(){return this.aT}get veb(){return this.Y5?!1:this.$.ea.Re.Ir?1>X.a.y6:6>X.a.z6}get OKd(){return this.gmb}afc(){return h.a.instance.lR(c.AFrameworkApplication.yk)}dispose(){h.a.instance.JMd(this.caf);h.a.instance.IMd(this.F$e);const Ka=this.$.ea;Ka&&(Ka.tk(this.Tc),
Ka.Zuc(this.oza));m.a.Ia(this.Ra);this.documentVisibilityObserver=this.$=null}Udg(){return this.afc()?0:(c.AFrameworkApplication.yk-(new Date).getTime())/6E4}Jjg(Ka,hb){if(0<hb&&!this.afc()){const fc=c.AFrameworkApplication.fa.rd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.zY),dc=(hb-Ka.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=dc,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${hb}] creationTime [${Ka.getTime()}] tokenLifetimeInMin [${dc}]`);
dc<this.jGi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.M6f}] tokenLifetimeInMin [${dc}]`),c.AFrameworkApplication.zY=this.M6f):c.AFrameworkApplication.zY!==fc&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${fc}] tokenLifetimeInMin [${dc}]`),c.AFrameworkApplication.zY=fc)}}O$g(Ka){return!this.context||
this.context.uJb||this.context.Q6c!==Ka?(Ka=new H(I.a.create().toString(),Ka),this.context&&!this.context.wCc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${Ka.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.uJb}] `),this.aT=Ka,!0):!1}Blj(Ka){Ka&&this.AH&&!this.bca&&this.$.ea.Re.Ir&&!this.Y5&&(this.AH=!1)}daf(Ka){this.Blj(Ka);if(!(this.gmb||this.mfb&&!Ka||this.AH)&&
this.veb){this.gmb=!0;var hb=this.context?this.context.creationTime:null,fc=this.O$g(Ka);this.wxd=!0;var dc=this.$.ea,wb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};wb.newContextCreated=fc;wb.IsUserActive=dc.Re.Ir;wb.IsSessionActive=dc.Zb;wb.ContainsChangesWorkbookOperations=this.$.userOperationManager.xta();wb.isSessionExpired=Ka;wb.stopRefreshRetriesUntilTokenExpired=this.mfb;wb.FailedToRefreshExpiredToken=this.AH;wb.numOfFailuresWhileUserIsActive=X.a.y6;wb.numOfFailuresWhileUserIsInActive=
X.a.z6;wb.numOfFailuresWhileOffline=X.a.Uya;wb.RefreshAccessTokenCorrelationID=this.context.correlationID;fc&&hb&&(wb.TimeInMinFromPreviosContextCreation=Math.round(U.b(T.a.Qa,hb)/60));hb=D.a.hc(wb);e.ULS.sendTraceTag(40416199,0,50,hb);this.LKd.start();this.Qce=dc.Re.Ir;this.Kx=new V.a;this.Jxi(Ka);var Tb=this.IZd.Vbj(!Ka,this.Kx?this.Kx.token:null);Tb.continueWith(()=>{this.u3g();const xb=this.IZd.b7i(Tb);this.LKd.stop();const cb=this.afc();if(!xb||Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
cb){const jb=Tb.result.errors;xb&&cb&&this.DHg(jb);this.N8h(jb,Ka)}else this.mfb=!1,this.O8h(Tb.result.tokens,Ka);this.gmb=!1},8)}}DHg(Ka){const hb=[Object(E.a)(new Y,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];Ka.add(Object(E.a)(new N,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:hb}))}Jxi(Ka){Ka&&(this.$.ea.Re.Ir?this.wag():(this.$.ea.Re.hha(this.$Ed),this.zJb=!0))}wag(){this.Vtc=J.AsyncMethodContext.Er(()=>{this.Ubj()},1E3*this.CSf,M.a.Dbj,this.Vtc)}u3g(){this.Vtc&&
this.Vtc.cancel();this.zJb&&(this.$.ea.Re.BAa(this.$Ed),this.zJb=!1);this.Kx=null}Ubj(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.CSf}]`);this.Kx.cancel()}N8h(Ka,hb){this.mfb=!0;hb&&(this.AH||(this.inb=this.AH=!0),this.IZd.yBb(Ka)&&(this.sde=!0));const fc=!hb||this.veb&&!X.a.vzc?40380379:39982555;hb=this.GHe(hb);hb.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";hb.FailedToRefreshExpiredToken=
this.AH;hb.LastErrorIsPermanent=this.Y5;if(0<Ka.count){var dc=Ka.na(0);hb.errorName=dc.Name;0<dc.Errors.length&&(hb.ErrorId=dc.Errors[0].Id,dc=dc.Errors[0].Details,hb.ErrorDetails=this.Ynh(dc.toString())?"PiiScrubbed":dc)}hb=D.a.hc(hb);e.ULS.sendTraceTag(fc,0,15,hb);this.Ra.raiseEvent("TokenRefreshed",new ea(null,Ka))}Ynh(Ka){return P.a.contains(Ka,"makes the internet safe for businesses",!0)}GHe(Ka){const hb={},fc=this.$.ea;hb.Name="";hb.IsUserActive=fc.Re.Ir;hb.IsSessionActive=fc.Zb;hb.GotDeploymentOrTimedOutError=
fc.S4;hb.TimeInSecFromLastStatefulSuccessfulRequest=fc.m1;hb.TimeFromLastUserActivityInMs=fc.Re.Lfb;hb.calledFromSessionExpiredFlow=Ka;hb.RefreshTokenDurationInMS=this.LKd.Ac;hb.numOfFailuresWhileUserIsActive=X.a.y6;hb.numOfFailuresWhileUserIsInActive=X.a.z6;hb.numOfFailuresWhileOffline=X.a.Uya;hb.RefreshAccessTokenCorrelationID=this.context.correlationID;hb.accessTokenTTL=c.AFrameworkApplication.yk;hb.ContainsChangesWorkbookOperations=this.$.userOperationManager.xta();hb.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.si.toString():"Unknown";hb.TimeFromFirstOpenInHr=Math.floor(U.b(T.a.Qa,Q.toUtc(fc.XKf))/3600);return hb}O8h(Ka,hb){this.AH=!1;this.ZZj();this.Jjg(new Date,c.AFrameworkApplication.yk);const fc=this.$.ea,dc=!hb&&fc.Re.Ir,wb=!this.$.isEditMode&&fc.bcb;hb=this.GHe(hb);hb.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";hb.shouldTriggerSilentReloadAfterExpiring=dc;hb.WopiTokenTaskItemPriority=c.AFrameworkApplication.n3d;hb.isDirtyViewSession=wb;hb=D.a.hc(hb);
e.ULS.sendTraceTag(39982556,0,15,hb);this.Ra.raiseEvent("TokenRefreshed",new ea(Ka,null));wb?fc.Re.Ir&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),fc.Odd()):fc.Re.Ir?dc&&(Ka=z.a(this.$).hd.activityState,Ka[X.a.egb]=!0,Ka[S.a.DY]=!0,Ka[ja.a.$r]=this.$.isEditMode,t.a(this.$).Ls(new v.a(w.a.Xna,2,null))):fc.Zb&&G.j(this.$.pa.ya,!0,!1,!1,null,null,null,null,
null)}ZZj(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=L.a.NT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.LP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=L.a.NT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.AY,c.AFrameworkApplication.yk.toString()),this.$.ea.Sqc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.va.AccessToken=c.AFrameworkApplication.accessToken;this.$.va.AccessTokenValidTo=c.AFrameworkApplication.yk;void 0!==this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.NT(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.LP,c.AFrameworkApplication.accessToken),this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.NT(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.AY,c.AFrameworkApplication.yk.toString()));void 0!==this.$.va.EmbedConfiguratorUrl&&null!==this.$.va.EmbedConfiguratorUrl&&(this.$.va.EmbedConfiguratorUrl=L.a.NT(this.$.va.EmbedConfiguratorUrl,c.AFrameworkApplication.LP,c.AFrameworkApplication.accessToken),this.$.va.EmbedConfiguratorUrl=L.a.NT(this.$.va.EmbedConfiguratorUrl,c.AFrameworkApplication.AY,c.AFrameworkApplication.yk.toString()));this.context.uJb=!0}}Object(u.a)(Ca,"EwaAccessTokenExpirationRefreshManager",null,[541,
542,2]);var la=a(187),Ra=a(157),lb=a(83),Aa=a(419);class da{}da.i_b="ActivityDuration";da.error="Error";da.ead="Errors";da.failed="Failed";da.OGh="FirstActivity";da.initialized="Initialized";da.Wvi="LastActivity";da.eZf="RetryOverride";da.$kj="RequestGroups";da.requests="Requests";da.TYf="Responses";da.Ixc="SessionDuration";da.status="Status";da.success="Success";da.successful="Successful";da.tokens="Tokens";Object(u.a)(da,"SessionExpirationStrings",null,[]);var aa=a(107);class fa{constructor(Ka){this.Yo=
{};this.UX={};this.BAg={};this.urf=15;this.Lce=!1;this.kCg=new Date;this.LVb=new Date;this.he=Ka;this.VYb=new aa.a(2,2,6E4*this.urf,Object(f.a)(this,this.Jmg,"writeMeasures"),135,"SL",!1);this.he.Fg(this.VYb);this.Ifi()}Jmg(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.hc({["Aggregate"]:this.UX,["Current"]:this.Yo}))}Ifi(){this.UX[da.$kj]=0;this.UX[da.requests]=0;this.UX[da.TYf]=0;this.UX[da.status]=da.initialized;this.UX[da.OGh]=new Date;this.UX[da.Ixc]=0;this.UX[da.i_b]=0;this.UX[da.Ixc]=0;this.Yo[da.Ixc]=
0;this.UX[da.i_b]=0;this.Yo[da.i_b]=0}Gnd(Ka,hb){var fc=Ka[hb];fc=fc?fc:0;fc++;Ka[hb]=fc;this.cSd(Ka)}cSd(Ka){const hb=new Date;Ka[da.i_b]=+hb-+this.LVb;this.LVb=hb;Ka[da.Ixc]=+this.LVb-+this.kCg;Ka[da.Wvi]=this.LVb}W0(Ka,hb){this.Yo[Ka]=hb;this.cSd(this.Yo)}ARd(Ka,hb){this.Yo[Ka]=hb;this.cSd(this.Yo)}incrementCounter(Ka){this.Gnd(this.Yo,Ka);this.Gnd(this.UX,Ka);this.Gnd(this.BAg,Ka)}flush(){this.Lce||(this.UX[da.status]=this.Yo[da.status],this.Jmg(this.VYb),this.he.Ana(this.VYb,6E4*this.urf))}stop(){e.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.Lce=!0;this.he.np(this.VYb)}}Object(u.a)(fa,"SessionLogger",null,[501]);var Oa=a(98),ba=a(642),ka=a(30),Pa=a(376),Fa=a(164),oa=a(939),La=a(189),Ea=a(166);class ca{constructor(Ka,hb,fc,dc=null,wb=!1,Tb=null,xb=!1,cb=!1){this.G9=0;this.z2=this.Xi=null;this.eZb=new la.a;this.TG=new la.a;this.xk=null;this.sXa=!1;this.knb=this.lnb=null;this.he=Ka;this.Hhe=hb;this.Hhe.execute(jb=>{jb.dm(Fa.a.Jmd,Object(f.a)(this,this.lSi,"onHostResponseReceived"))});
this.aH=fc;this.kme=new oa.a("WebServiceCall","TokenRefresh");this.kh=dc||new fa(Ka);this.fCg=wb;this.xT=Tb?Tb:ba.SessionStatusManager.instance;this.z9d=xb;this.fUb=cb}lSi(Ka){if(Ka.MessageId!==Fa.a.Jmd)Ea.a(39408099,306,15,"Unexpected message.");else{var hb=new la.a,fc=new la.a;this.kh.incrementCounter(da.TYf);var dc=Ka.Values[Pa.a.s2f];if(!dc||0>=dc.length)Ea.a(40122317,306,15,"Found no tokens in the dictionary"),dc=Ka.Values;Ea.a(40122318,306,100,"The Tokens array contains {0} tokens",dc.length);
this.kh.W0("Correlation",Ka.CorrelationId);var wb="";for(let cb=0;cb<dc.length;cb++){this.kh.ARd(da.tokens,dc.length);var Tb=dc[cb],xb=Tb;if(!xb||!xb.Name)continue;this.kh.incrementCounter(xb.Name);const jb=Tb;if(jb&&jb.Value)Ea.a(39408128,306,100,"Received token with name: {0}",jb.Name),hb.add(jb),this.eZb.add(jb),this.fUb||this.kh.W0(da.status,da.success),this.z9d&&this.xT&&this.xT.bmj();else if(Tb=this.Z0h(Tb),Ea.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
xb.Name,JSON.stringify(Tb),this.z2),fc.add(Tb),this.fUb||(this.TG.add(Tb),wb=JSON.stringify(Tb),this.kh.W0(da.error,JSON.stringify(Tb)),this.kh.W0(da.status,da.failed)),this.z9d)for(const qa of Tb.Errors)xb=this.USh(qa),this.xT&&this.xT.XJg(xb)}this.fUb?(0<fc.count?this.knb?this.knb(new ea(hb,fc)):Ea.a(512267295,306,15,"Received errors but the promise has completed"):this.lnb?this.lnb(new ea(hb,fc)):Ea.a(512267294,306,15,"Received valid tokens but the promise has completed"),Ea.a(512344162,306,50,
"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",hb.count,fc.count,Ka.CorrelationId,this.z2)):(0<fc.count&&""!==wb?(dc=Object.assign(new La.a,{extendedProperties:new Map}),dc.extendedProperties.set("Errors",wb),dc.extendedProperties.set("RetryCount",this.G9.toString()),dc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),dc.extendedProperties.set("IsTokenExpiring",this.sXa.toString()),Oa.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,dc)):Oa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Ea.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",hb.count,fc.count,Ka.CorrelationId,this.z2),0<fc.count&&!this.yBb(fc)?(Ka=this.aH.D6e(fc),Ka!==this.aH.ldb&&(this.kh.ARd(da.eZf,Ka),this.he.Ana(this.Xi,Ka))):(this.kh.flush(),this.Xi&&(Ea.a(39408131,306,100,"Deleting task {0} from task manager",this.Xi.name),this.he.np(this.Xi)),this.xk&&!this.xk.task.isCompleted?
this.xk.setResult(new ea(hb,fc)):Ea.a(512267293,306,15,"Received results but the task has completed")))}}Z0h(Ka){if(!Ka)return null;const hb=Object.assign(new N,{Name:Ka.Name,Errors:[]});for(const fc of Ka.Errors)Ka=new Y,Ka.Id=fc.Id,Ka.Details=ka.a.Rid(fc.Details,500),hb.Errors.push(Ka);return hb}requestTokensOnce(){this.aYf()}aYf(){c.AFrameworkApplication.nya("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.G9>=this.aH.Ouf?(Ea.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.z2),this.MHe(this.xk,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Oa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.D1f())}D1f(){const Ka={};Ka[Pa.a.s2f]=this.aH.tokens;const hb=I.a.create().toString();Ea.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.aH.tokens),this.G9+1,hb,this.z2);this.Hhe.execute(fc=>{fc.Rj(Fa.a.nue,Ka,hb)});this.G9++;this.kh.incrementCounter(da.requests)}MHe(Ka,
hb,fc){const dc=new la.a;for(let wb=0;wb<this.aH.tokens.length;wb++){const Tb=Object.assign(new N,{Name:this.aH.tokens[wb],Errors:[Object.assign(new Y,{Id:hb,Details:fc})]});dc.add(Tb);this.TG.add(Tb)}this.he.np(this.Xi);this.kh.W0(da.ead,JSON.stringify(this.TG));this.kh.W0(da.status,da.failed);Ka&&!Ka.task.isCompleted&&Ka.setResult(new ea(new la.a,this.TG))}Vbj(Ka,hb=null){c.AFrameworkApplication.nya("258ec738;j5j99381");c.AFrameworkApplication.nya("85gid169;g470d326");this.kme.start();this.sXa=
Ka;this.z2=I.a.create().toString();Ea.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.z2,this.sXa);this.G9=0;this.TG.clear();this.eZb.clear();const fc=new Ra.a;this.xk=fc;hb&&hb.R(()=>{const dc=!!fc&&!fc.task.isCompleted;Ea.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.z2,this.sXa,dc);dc&&this.MHe(fc,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.fUb?this.bYf(this.aH.Ouf).then(dc=>
{this.xk&&!this.xk.task.isCompleted&&this.xk.setResult(dc);this.knb=this.lnb=null;this.kh.W0(da.ead,JSON.stringify(this.TG));this.kh.W0(da.status,da.success);this.kh.flush()}).catch(dc=>{this.xk&&!this.xk.task.isCompleted&&this.xk.setResult(Object(lb.a)(470,dc));this.knb=this.lnb=null;this.kh.W0(da.ead,JSON.stringify(this.TG));this.kh.W0(da.status,da.failed);this.kh.flush()}):(this.Xi=new aa.a(this.aH.priority,2,this.aH.ldb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Fa.a.nue,
!0),this.fCg&&this.aYf(),this.he.Fg(this.Xi));return this.xk.task}bYf(Ka){const hb=this,fc=new Promise((cb,jb)=>{hb.lnb=cb;hb.knb=jb;Oa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);hb.D1f()}),dc=this,wb=new Promise((cb,jb)=>{window.setTimeout(()=>{jb(dc.RHe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},dc.aH.ldb)});let Tb=Ka;const xb=this;return new Promise((cb,jb)=>{Tb--;Promise.race([fc,wb]).then(qa=>{Oa.Health.instance.recordKpiSuccess("WACTokenRefresh",
null);cb(qa)}).catch(qa=>{var za=xb.aH.ldb;if(Object(Aa.a)(470,qa)&&(qa=Object(lb.a)(470,qa),0<qa.errors.count)){xb.Xzi(qa.errors);xb.rr(qa.errors);if(xb.yBb(qa.errors)){jb(qa);return}const Na=xb.aH.D6e(qa.errors);Na!==xb.aH.ldb?(xb.kh.ARd(da.eZf,Na),za=Na):xb.sti(qa.errors)&&(za=0)}Tb?window.setTimeout(()=>{xb.bYf(Tb).then(cb).catch(jb)},za):(za=xb.RHe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),xb.rr(za.errors),jb(za),Ea.a(512267292,
306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",xb.z2))})})}rr(Ka){for(let hb of Ka)this.TG.add(hb)}sti(Ka){if(!Ka.count)return!1;Ka=Ka.na(Ka.count-1);return Ka.Errors.length?"TIMEOUT"==Ka.Errors[0].Id:!1}RHe(Ka,hb){const fc=new la.a;for(let dc=0;dc<this.aH.tokens.length;dc++){const wb=this.Cbh(this.aH.tokens[dc],Ka,hb);fc.add(wb)}return new ea(new la.a,fc)}Cbh(Ka,hb,fc){return Object.assign(new N,{Name:Ka,Errors:[Object.assign(new Y,{Id:hb,Details:fc})]})}Xzi(Ka){if(Ka.count){Ka=
Ka.na(Ka.count-1);Ka=JSON.stringify(Ka);var hb=Object.assign(new La.a,{extendedProperties:new Map});hb.extendedProperties.set("Errors",Ka);hb.extendedProperties.set("RetryCount",this.G9.toString());hb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());hb.extendedProperties.set("IsTokenExpiring",this.sXa.toString());Oa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,hb);this.kh.W0(da.error,Ka);this.kh.W0(da.status,da.failed)}}b7i(Ka){this.kme.stop();
const hb=this.$9h(Ka.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!hb,this.z2,this.sXa,this.G9,this.TG.count,0<Ka.result.errors.count?Ka.result.errors.na(0).Name:"",0<Ka.result.errors.count&&0<Ka.result.errors.na(0).Errors.length?Ka.result.errors.na(0).Errors[0].Id:"",0<Ka.result.errors.count&&0<Ka.result.errors.na(0).Errors.length?
Ka.result.errors.na(0).Errors[0].Details:"");return hb?!1:this.a7i(Ka.result.tokens)}yBb(Ka){return this.aH.yBb(Ka)}a7i(Ka){for(let hb=0;hb<Ka.count;hb++){const fc=Ka.na(hb);if(fc.Name===Pa.a.accessToken){const dc=(new Date).getTime();fc.Expiry>c.AFrameworkApplication.yk?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:fc.Expiry,["NowGetTime"]:dc,["BootTime"]:c.AFrameworkApplication.Dha},"PreviousAccessTokenTtl",c.AFrameworkApplication.yk),c.AFrameworkApplication.accessToken=
fc.Value,c.AFrameworkApplication.yk=Math.floor(fc.Expiry),c.AFrameworkApplication.m3d=dc,c.AFrameworkApplication.gZa=Math.floor(fc.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:fc.Expiry,["NowGetTime"]:dc,["BootTime"]:c.AFrameworkApplication.Dha},"PreviousAccessTokenTtl",c.AFrameworkApplication.yk)}}return!0}$9h(Ka){let hb=!1;for(let fc=0;fc<Ka.count;fc++){hb=!0;const dc=Ka.na(fc);e.ULS.sendTraceTag(39706829,
217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",dc.Name,JSON.stringify(dc.Errors),this.z2)}return hb}USh(Ka){let hb=d.a.Hxc;Ka=parseInt(Ka.Id);if(isNaN(Ka))hb=d.a.e3j;else{switch(Ka){case 401:hb=d.a.h3j;break;case 403:hb=d.a.c3j;break;case 500:hb=d.a.d3j;break;case 503:hb=d.a.g3j}hb===d.a.Hxc&&(hb=500<Ka?d.a.f3j:d.a.b3j)}return hb}}Object(u.a)(ca,"TokenRefreshManager",null,[471]);class $a{constructor(){this.ldb=c.AFrameworkApplication.k3j;this.Ouf=c.AFrameworkApplication.i3j;this.tokens=
c.AFrameworkApplication.M5h();this.priority=c.AFrameworkApplication.n3d;this.Uie=this.Yxj();this.kVc=c.AFrameworkApplication.L5h()}yBb(Ka){Ka=JSON.stringify(Ka);if(this.kVc&&0<this.kVc.length)for(const hb of this.kVc)if(0<hb.length&&0<=Ka.indexOf(hb))return!0;return!1}D6e(Ka){try{if(Ka)for(let hb of Ka)if(hb.Errors)for(const fc of hb.Errors)if(fc.Id in this.Uie)return Number.parseInvariant(this.Uie[fc.Id].toString())}catch(hb){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",
hb.toString())}return this.ldb}Yxj(){const Ka={};try{if(!c.AFrameworkApplication.mec()||0>=c.AFrameworkApplication.mec().length||""===c.AFrameworkApplication.mec()[0])return Ka;for(const hb of c.AFrameworkApplication.mec())0<hb.length&&(Ka[hb]=c.AFrameworkApplication.j3j)}catch(hb){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",hb.toString())}return Ka}}Object(u.a)($a,"TokenRefreshPolicy",null,[468]);class Qa extends b.a{constructor(Ka){super();
this.$=Ka;this.Fb()}create(){c.AFrameworkApplication.PN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.nb(this.Hbh()):this.nb(this.$.da.Aa(38)||this.$.da.Ga(38,new A(this.$)))}Hbh(){var Ka=this.$.da.Aa(38);if(Ka)return Ka;Ka=new ca(c.AFrameworkApplication.Fi,c.AFrameworkApplication.pV(),new $a);return this.$.da.Ga(38,new Ca(this.$,Ka))}static la(Ka){Ka.da.Ga(39,new Qa(Ka))}}Object(u.a)(Qa,
"AccessTokenExpirationManagerFactory",b.a,[]);var Va=a(9);a.d(F,"a",function(){return fb});const fb=()=>{Va.a.Fa(Qa.la)}},1201:function(u,F,a){u=a(0);var c=a(84),b=a(146);class e extends b.a{constructor(z){super(!1,!1,!0);this.bSb=z}start(){const z={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.bSb.Pmd}};this.initializeAndShow("",Object(c.a)(this,this.anj,"resultHandler"),z)}anj(z,A){1===z&&(this.bSb.Pmd=A.tooltipPersistenceEnabled)}}Object(u.a)(e,"AccessibilitySettingsDialog",
b.a,[]);var f=a(106),d=a(25);class h{constructor(z,A){this.La=z;this.bSb=A}Ig(){this.La.Nb(d.a.CEj,f.a.frame,Object(c.a)(this,this.DEj,"showAccessibilitySettingsDialogHandler"))}DEj(){(new e(this.bSb)).start();return 32}}Object(u.a)(h,"AccessibilitySettingsDialogActor",null,[335]);var n=a(157),m=a(4);const x=z=>{const A=new n.a;m.AFrameworkApplication.zd.Pm(r(z),1,null,null,!0,2,E=>{200===E.data.httpStatus?A.setResult("true"===E.data.ve.toLowerCase()):A.setResult(!1)},()=>{A.setResult(!1)},null,void 0,
void 0,void 0,void 0,"7");return A.task},r=z=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",z,m.AFrameworkApplication.Hi);var y=a(137);class t{constructor(){this.cXa=null}get Pmd(){return!!this.cXa}set Pmd(z){z!==this.cXa&&(this.cXa=z,y.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(z),this.xlf()&&m.AFrameworkApplication.zd.Pm(r("saveHoverableRibbonTooltipIsEnabled"),2,
z.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}myi(){const z=new n.a;if(this.cXa)z.setResult(this.cXa);else if(this.xlf()){const A=x("getHoverableRibbonTooltipIsEnabled");A.continueWith(()=>{this.cXa=A.result;y.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A.result);z.setResult(A.result)},8)}else z.setResult(!1)}xlf(){const z=m.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),A=m.AFrameworkApplication.fa.qa("IsAnonymousUser");
return z&&!A}}Object(u.a)(t,"AccessibilitySettingsInfo",null,[334]);var v=a(248),w=a(166);class C{constructor(){this.gb=null}get name(){return"Common.App.AccessibilitySettings"}Xh(z){this.gb=z;this.gb.register(t,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Fc(()=>new t).xc();this.gb.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Fc(()=>
new h(m.AFrameworkApplication.ub,this.gb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).xc()}init(){const z=this.gb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),A=this.gb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");z&&A?(A.Ig(),z.myi()):w.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){v.a.instance.Ei(new C)}}Object(u.a)(C,
"AccessibilitySettingsPackage",null,[3,4]);a.d(F,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");C.main()}},1202:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(89),d=a(27),h=a(419),n=a(480),m=a(523),x=a(165),r=a(225),y=a(24),t=a(66),v=a(40),w=a(162),C=a(212),B=a(47),z=a(46),A=a(12),E=a(71),I=a(127),L=a(1),V=a(11),T=a(21),H=a(346),D=a(239),G=a(14),J=a(156),M=a(95),Q=a(5),U=a(249),Z=a(76),P=a(44),S=a(34);class ja extends M.a{constructor(ka,
Pa,Fa,oa){super(ka);this.Gcg=[6];this.Bcg=[26];this.es=null;this.lBb=this.kkc=!1;this.Es=this.lba=null;this.z5=!1;this.onPointerDown=La=>{if(1!==this.$.Ja.KH())return!0;La=S.a(this.$).Vd(La);if(this.xB)return!0;var Ea=P.a(this.$).lrd||P.a(this.$).oq();if(this.ftd||Ea)return this.Zcb(),!0;this.Es=this.im;this.BLd();this.rmd();Ea=2===La.tb&&La.ho===Sys.UI.MouseButton.leftButton;const ca=3===La.tb;if(Ea||ca)La=this.ha.io(La.clientPoint,La.Gb,5,void 0,void 0,!0),La||(La=this.Es),this.lBb=Ea,this.kkc=
ca,this.Es=this.z8e(La),this.rmd(),Ea?this.cdj():ca&&this.Wdj(),U.b(this.$,!0);return!0};this.Hh=La=>{La=S.a(this.$).Vd(La);if(!this.xB)return!1;let Ea=this.lBb?this.ha.io(La.clientPoint,La.Gb,5,void 0,void 0,!0):this.ha.io(La.clientPoint,La.Gb,5,!0,!1,!0);this.z5&&!Ea&&(Ea=this.ha.mpb(La.clientPoint,La.Gb,5));Ea&&(La=this.z8e(this.XZa(Ea)),this.B2b(La.bottomRight),this.Es.equals(La)||(this.Es=La,this.PJb(!1),this.BLd(!1),this.rmd(!1),this.Xai(),this.qb.update(!1)),this.aXj(this.Es));return!0};this.Rf=
La=>{S.a(this.$).Vd(La);if(!this.xB)return!1;this.resizeTable();this.Zcb();return!0};this.aHb=La=>{S.a(this.$).Vd(La);if(!this.xB)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Zcb();return!0};this.k0=La=>{S.a(this.$).Vd(La);this.Zcb();return!0};this.Vzf=()=>{this.xB&&this.Zcb()};this.gridView=Pa;this.$=Pa.$;this.tableManager=oa;this.ha=Pa.ha;this.qb=Pa.qb;this.parentElement=ka;this.lYg();d.a.Dp||
d.a.y5||D.a.instance.sa(G.a.pointerDown,this.lba,this.onPointerDown);this.im=Fa;this.NNc=this.ftd=!1;this.tableManager.GKg(this.Vzf);this.z5=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7030316_NewTableResizeExperience")}get xB(){return this.lBb||this.kkc}get xmf(){return this.NNc}dispose(){this.Zcb();this.tableManager.cgj(this.Vzf);this.xmf||d.a.Dp||d.a.y5||D.a.instance.Ba(G.a.pointerDown,this.lba,this.onPointerDown);if(this.xB){U.b(this.$,!1);try{this.Uv()}catch(ka){e.ULS.sendTraceTag(537151236,
0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ka}`)}}this.parentElement&&this.parentElement.contains(this.lba)&&this.parentElement.removeChild(this.lba);this.lba=this.parentElement=null;super.dispose()}z8e(ka){const Pa=ka.bottom-this.im.topLeft.bottom-1;return 0<=ka.right-this.im.topLeft.right+1&&0<=Pa&&ka.bottom>=this.im.top&&ka.right>=this.im.left?new y.Range(this.im.top,this.im.left,ka.bottom,ka.right,!1,!1):this.Es}rmd(ka=!0){this.myc([this.Es],6,ka);this.qb.Sn(this.Gcg)}PJb(ka=
!0){this.qb.Zg(this.Gcg);this.myc([null],6,ka)}BLd(ka=!0){this.qb.Zg(this.Bcg);this.myc([null],26,ka)}Xai(){const ka=this.BNj();0<ka.length&&(this.myc(ka,26,!1),this.qb.Sn(this.Bcg))}BNj(){const ka=[];this.im.contains(this.Es)&&(this.im.right!==this.Es.right&&ka.push(new y.Range(this.im.top,this.Es.right+1,this.Es.bottom,this.im.right,!1,!1)),this.im.bottom!==this.Es.bottom&&ka.push(new y.Range(this.Es.bottom+1,this.im.left,this.im.bottom,this.im.right,!1,!1)));return ka}resizeTable(){if(!this.Es.equals(this.im)){const ka=
new y.Range(this.im.top,this.im.left,this.Es.bottom,this.Es.right,!1,!1);this.pSj(ka);this.ftd=!0}}onKeyDown(ka){S.a(this.$).Vd(ka);return!0}T$a(){this.xmf&&(d.a.Dp||d.a.y5||(D.a.instance.sa(G.a.pointerDown,this.lba,this.onPointerDown),this.lba.classList.remove("ewr-table-resize-default-cursor"),this.NNc=this.lba.disabled=!1),this.NNc=!1)}lYg(){const ka=document.createElement("div");ka.className="ewr-table-resize-handle";const Pa=document.createElement("div");Pa.className="ewr-table-resize-fillhandle-higher";
const Fa=document.createElement("div");Fa.className="ewr-table-resize-fillhandle-broader";ka.appendChild(Pa);ka.appendChild(Fa);this.lba=ka;this.parentElement.appendChild(this.lba)}B2b(ka){const Pa=this.z5?2:5;let Fa=60;const oa=this.Es.contains(ka);let La=ka.top,Ea=ka.bottom,ca=ka.left,$a=ka.right,Qa=null;if(oa){if(this.gridView.MK(this.im.topLeft)&&!this.im.EBa)return;this.z5?ka.bottom<this.Es.bottom?(La=Math.max(1,Ea-Pa,this.im.top),Fa=16):(ca=Math.max(1,$a-Pa,this.im.left),Fa=4):(La=Math.max(1,
Ea-Pa,this.im.top),ca=Math.max(1,$a-Pa,this.im.left));Ea=La;$a=ca;Qa=new y.Range(La,ca,La,ca,!1,!1)}else this.z5?ka.right>=this.im.right?($a+=Pa,Fa=8):ka.bottom>=this.im.bottom&&(Ea+=Pa,Fa=32):(Ea+=Pa,$a+=Pa),La=Ea,ca=$a,Qa=new y.Range(Ea,$a,Ea,$a,!1,!1),Fa=16;this.gridView.MK(Qa)||(this.es?this.es.Ep||(this.es=B.a.instance.create(()=>{this.gridView.Kt(Qa,Fa,"TableResizeBehavior.BringRangeIntoView")},40,z.a.Ecg)):this.es=B.a.instance.create(()=>{this.gridView.Kt(Qa,Fa,"TableResizeBehavior.BringRangeIntoView")},
40,z.a.Ecg))}XZa(ka){let Pa=ka;if(this.gridView.ib.X4){if(!this.gridView.Sb(ka.topLeft)){const Fa=this.gridView.jk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.HH,this.Es.top!==ka.top?1:2);try{Fa.Rk=this.Es.top<ka.top||this.Es.left<ka.left,Fa.Is(ka.topLeft),Pa=Fa.$$cu().range}finally{Fa&&Fa.dispose()}}Pa.right=Pa.left+ka.width-1;Pa.bottom=Pa.top+ka.height-1}return Pa}myc(ka,Pa,Fa=!0){const oa=[];for(const La of ka)oa.push(new H.a(La,t.d(this.$.oa)));this.qb.lx(oa,[Pa],!0,void 0,Fa)}cdj(){this.z5&&
D.a.instance.sa(G.a.Kj,document.documentElement,this.Hh);for(const ka of this.gridView.Mn)D.a.instance.sa(G.a.Kj,ka.domElement,this.Hh);D.a.instance.sa(G.a.Sf,document.documentElement,this.Rf);this.oMe()}Wdj(){this.z5&&J.a.instance.sa(G.a.$f,document.documentElement,this.Hh);for(const ka of this.gridView.Mn)J.a.instance.sa(G.a.$f,ka.domElement,this.Hh);J.a.instance.sa(G.a.xe,document.documentElement,this.aHb);this.oMe()}Uv(){this.lBb&&this.lVj();this.kkc&&this.xVj()}lVj(){this.z5&&D.a.instance.Ba(G.a.Kj,
document.documentElement,this.Hh);for(const ka of this.gridView.Mn)D.a.instance.Ba(G.a.Kj,ka.domElement,this.Hh);D.a.instance.Ba(G.a.Sf,document.documentElement,this.Rf);this.ASf()}xVj(){this.z5&&J.a.instance.Ba(G.a.$f,document.documentElement,this.Hh);for(const ka of this.gridView.Mn)J.a.instance.Ba(G.a.$f,ka.domElement,this.Hh);J.a.instance.Ba(G.a.xe,document.documentElement,this.aHb);this.ASf()}oMe(){this.z5||D.a.instance.sa(G.a.Fy,document.documentElement,this.k0);this.gridView.fc.t9b(!0)}ASf(){this.z5||
D.a.instance.Ba(G.a.Fy,document.documentElement,this.k0);this.gridView.fc.t9b(!1)}pSj(ka){this.$.Xc(-1400250766,Z.a.Db,30,{["ResizeTableRange"]:ka,["OriginalTableRange"]:this.im})}aXj(ka){if(!this.im.contains(ka)){ka=this.ANj();for(const Pa of ka)if(this.tableManager.Ftd(Pa)){this.gridView.yf.gm(Q.a.dJi);return}}this.gridView.rtl?this.gridView.yf.gm(Q.a.lIi):this.gridView.yf.gm(Q.a.oKi)}Zcb(){if(this.xB){U.b(this.$,!1);try{this.Uv()}catch(ka){e.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ka}`)}}this.es&&
(this.es.cancel(),this.es.dispose());this.kkc=this.lBb=!1;this.PJb();this.BLd();U.b(this.$,!1);this.gridView.yf.gm(Q.a.SQ)}ANj(){const ka=[];this.im.right!==this.Es.right&&ka.push(new y.Range(this.im.top,this.im.right+1,this.Es.bottom,this.Es.right,!1,!1));this.im.bottom!==this.Es.bottom&&ka.push(new y.Range(this.im.bottom+1,this.im.left,this.Es.bottom,this.im.right,!1,!1));return ka}static createInstance(ka,Pa,Fa,oa){if(!Pa)return null;const La=ka.qb;La.lx(Fa,[27],!0);La.Sn(ja.tNj);Fa=La.Cv(27,ka.ib.Mi(Pa.bottomRight),
ja.lSh(Pa,Fa)).zf;return new ja(Fa,ka,Pa,oa)}static lSh(ka,Pa){var Fa;for(let oa=0;oa<Pa.length;oa++)if((null===(Fa=Pa[oa])||void 0===Fa?0:Fa.range)&&Pa[oa].range.equals(ka))return oa;return 0}}ja.tNj=[27];Object(u.a)(ja,"TableResizeBehavior",M.a,[]);var X=a(7);M=a(238);class Y{}Y.gyh="ewa-ttrd-buttonarea";Object(u.a)(Y,"CssClassNames",null,[]);var va=a(50),N=a(132),ea=a(92),Ca=a(22),la=a(13),Ra=a(254),lb=a(133),Aa=a(262);class da extends M.a{constructor(ka){super(document.createElement("div"));this.MVc=
this.qqd=this.pLf=this.UQ=!1;this.$Lb=null;this.Sh=()=>{C.c(this.$,this.gridView.ha.ra.activeCell)?(this.UMa=!0,this.xsb(!1)):(this.p_=this.UMa=!1,this.uhg())};this.Tt=()=>{this.UMa?this.xsb(!0):this.p_=!1};this.Zzf=()=>{this.MVc=!0;this.UMa&&(this.p_=!1)};this.onContentReady=()=>{this.$.isEditMode?C.c(this.$,this.gridView.ha.ra.activeCell)&&(this.UMa=!0,this.xsb(!1)):this.p_=!1};this.aza=()=>{this.MVc=!1;this.UMa?this.xsb(!1):this.p_=!1};this.tf=(Pa,Fa)=>{this.UMa&&(Pa=this.gridView.Rab(Fa.Yc.block.qe.BlockCachePosition.PaneType).gC(Fa.Yc.hash))&&
(Pa.OMd(this.jbf),Pa.LXc(this.jbf))};this.jbf=()=>{this.GWf()};this.$=ka;this.gridView=T.h(this.$);this.parentElement=this.domElement;this.parentElement.className=Y.gyh;this.NLa=this.gridView.zj;this.UMa=!0;this.qfi();this.FSg();this.xsb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get p_(){return this.qqd}set p_(ka){this.qqd!==ka&&(this.qqd=this.isVisible=ka)}get iCb(){return!!(this.$.qd&16)}get woi(){const ka=this.gridView.ha.ra.activeCell;return ka.right===
ka.maxColumns}get Knb(){const ka=this.gridView.Sb(null);return ka&&this.gridView.I5(ka.range)?this.awa(ka):(ka&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.Gkh();this.$=this.gridView=this.parentElement=this.NLa=null;super.dispose()}eQh(ka){const Pa=this.R3h(this.gridView.Sb(null).range);return Pa?`=SUBTOTAL(${ka},${Pa})`:null}R3h(ka){var Pa=T.h(this.$).Bb.Bj(ka);if(!Pa)return null;Pa=w.a(Pa,!1);Pa.right=
Pa.left=ka.left;return Pa.toString()}qfi(){da.DM={};da.DM["100"]=la.a.instance.ga(1101);da.DM["101"]=la.a.instance.ga(1104);da.DM["102"]=la.a.instance.ga(1103);da.DM["103"]=la.a.instance.ga(1108);da.DM["104"]=la.a.instance.ga(1105);da.DM["105"]=la.a.instance.ga(1106);da.DM["109"]=la.a.instance.ga(1102);da.DM["107"]=la.a.instance.ga(1109);da.DM["110"]=la.a.instance.ga(1111);da.DM["111"]=la.a.instance.ga(1162)}V0i(){var ka=this.gridView.Sb(null);if(ka&&(ka=ka.rB?ka.formulaBarText:null))if("=SUBTOTAL("===
ka.substring(0,10)){if(ka=ka.substring(10,13),ka in da.DM)return ka}else return"111";return"100"}FSg(){this.gridView.Da.nt(this.tf);this.gridView.ha.fH(this.Sh);this.gridView.lv(this.onContentReady);this.gridView.fc.Yk(this.Zzf);this.gridView.fc.Rm(this.aza)}Gkh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.rL(this.Sh),this.gridView.Da.cr(this.tf)),this.gridView.Ky(this.onContentReady),this.gridView.fc&&(this.gridView.fc.Gk(this.Zzf),this.gridView.fc.em(this.aza)),this.uhg())}xsb(ka){this.lXj(ka);
this.iCb&&(this.$Lj(),this.Knb?(this.pLf||this.PSg(),this.MVc?this.p_=!1:(this.p_=!0,this.GWf())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.p_=!1))}GWf(){appChrome.renderTableTotalRowOptions(this.parentElement,da.DM,da.DM[this.V0i()].toString(),Math.round(S.a(this.$).yi(17)),ka=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ka}`);let Pa=
{["SelectedOption"]:da.DM[ka],["FunctionKeyCode"]:ka,["Location"]:"canvas"};lb.b(this.$).ud(N.a.FNj,Pa,null,!0);if("111"===ka)return this.Lii(),!0;if("100"!==ka){this.$Lb=this.eQh(ka);if(!this.$Lb)return e.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.HSa(this.$Lb)}else this.HSa("");A.DOMElementExtensions.setFocus(this.gridView.Vb.textBox.domElement);return!0})}Lii(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const ka=new ea.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ja.Lb(ka)}awa(ka){if(!ka)return null;var Pa=this.gridView.fc.textBox.domElement;var Fa=0<A.DOMElementExtensions.getHeight(Pa)&&0<A.DOMElementExtensions.getWidth(Pa)&&0<=Pa.offsetTop&&0<=Pa.offsetLeft;if(Fa)Pa=A.DOMElementExtensions.awa(Pa,this.gridView.zj);else{Pa=this.gridView.getCellBounds(ka.cell);var oa=A.DOMElementExtensions.getBoundingClientRect(this.gridView.zj);Pa=new Sys.UI.Bounds(Pa.x-oa.x,Pa.y-oa.y,Pa.width,Pa.height)}if(Pa)if(Fa)2<
Pa.height&&2<Pa.height&&(Pa.x+=1,Pa.y+=1,Pa.height-=2,Pa.width-=2);else if(Fa=T.h(this.$).sK(ka.cell))Fa=Fa.width,oa=Ca.a.equals(Ra.a.Rwb(ka.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&oa&&(Pa.x=Pa.x+Pa.width-Fa),ka.wla&&this.gridView.rtl===oa&&(Pa.width=Fa);else return null;return Pa}lXj(ka){var Pa=this.Knb;if(Pa){var Fa=17>=Pa.height?Pa.y:Pa.y+Pa.height-17-2;Pa=this.woi?this.gridView.rtl?Pa.x:Pa.x+Pa.width-(17<Pa.height?17:Pa.height):this.gridView.rtl?Pa.x-(17<Pa.height?17:Pa.height):
Pa.x+Pa.width;var oa=S.a(this.$).eka(new Sys.UI.Point(Pa,Fa));this.parentElement.style.top=V.HelperMethods.uc(oa.y);this.parentElement.style.left=V.HelperMethods.uc(oa.x);S.a(this.$).pxj(this.parentElement);ka&&(this.p_=this.gridView.skc(new va.a(Pa,Fa)))}else this.p_=!1}PSg(){this.NLa.insertBefore(this.parentElement,this.NLa.firstChild);this.pLf=!0}$Lj(){this.UQ||(this.gridView.view.ot(this.Tt),this.UQ=!0)}uhg(){this.UQ&&this.gridView.view&&(this.gridView.view.er(this.Tt),this.UQ=!1)}HSa(ka){const Pa=
this.gridView.Vb,Fa=this.gridView.Sb(null);Fa&&(ka=Object(X.a)(new Aa.a,{Text:ka}),this.gridView.setCell(ka,Fa.range,0,127,null),Pa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}da.ENj="TableTotalRowDropDownIconButtonId";da.DM=null;Object(u.a)(da,"TableTotalRowOptions",M.a,[2]);class aa extends n.a{constructor(ka){super(T.h(ka));this.Sqb=this.j1=this.CBc=this.Qqb=null;this.fue=!1;this.gde=null;this.xTb=0;this.c7b=null;this.S1b=()=>{const Pa={},Fa=this.Bid();for(let La in Fa){const Ea=Fa[La];
if(!Ea)continue;const ca=this.W2h(Ea);if(ca){if(ca in this.qGa){var oa=this.qGa[ca];if(oa.xB){oa.im.equals(Ea)||(oa.im=Ea);delete this.qGa[ca];Pa[ca]=oa;continue}}(oa=ja.createInstance(T.h(this.$),Ea,this.bNh(),this))?Pa[ca]=oa:e.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${Ea.Ew(!1)}`)}}this.b4b(null,null);this.fSb=Pa};this.b4b=()=>{const Pa=this.qGa;for(let La in Pa){var Fa=La,oa=Pa[La];oa&&(oa.dispose(),delete this.qGa[Fa])}this.fSb=
{}};this.NQf=()=>{this.b4b(null,null);this.S1b(null,null)};this.onFocus=()=>{this.gde=T.h(this.$).ha.ra.activeCell};this.BR=()=>{this.$.isEditMode&&this.Sh(null,null)};this.Sh=()=>{!this.fue&&C.c(this.$,this.gridView.ha.ra.activeCell)&&this.wyi()};this.eW=()=>{this.Ozb(1);this.$.ea.jo(this.eW)};this.iIb=()=>{this.fue=!0;this.CBc=new da(this.$)};this.$=ka;this.gridView=T.h(this.$);this.$.da.Ga(66,this);this.fSb={};this.S1b(null,null);this.$.xa&&this.$.xa.Xf(this.NQf);this.yXc(this.S1b);this.$.ea.IY(this.BR);
this.gridView.ha.fH(this.Sh);this.$.isEditMode&&this.Sh(null,null)}yXc(ka){this.addHandler(n.a.Tbb,ka)}DMd(ka){this.removeHandler(n.a.Tbb,ka)}GKg(ka){this.addHandler("tce",ka)}cgj(ka){this.removeHandler("tce",ka)}get qGa(){return this.fSb}get Wud(){return this.gde}get bJa(){return this.xTb}get Lg(){const ka=T.h(this.$);return ka.Bb.Bj(ka.ha.ra.activeCell,!1)}get dId(){return this.Wud?T.h(this.$).Bb.Bj(this.Wud,!1):null}Ftd(ka){return!!this.C5e(ka)}Bn(ka){return this.x_h(this.k6e(ka))}Awb(ka){return this.k6e(ka)}Tdj(ka){ka?
(this.Sqb?this.Sqb!==ka&&(f.a.Ia(this.j1),this.j1=null,this.Sqb=ka):this.Sqb=ka,this.j1||(this.j1=I.a.instance.$d(this.Sqb)),this.j1.Oi("focusin")||this.j1.la("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Pif(ka,Pa){return ka?ka.oba&&ka.top===Pa.top:(e.ULS.shipAssertTag(537151244,0,!!ka,"autofilterRange can't be null"),!1)}cka(ka){ka=this.Qqb?v.I(ka,this.Qqb):this.view.getRangeInformation(ka);return 0<ka.length&&
Object(h.a)(r.PivotTableRange,ka[0])?ka[0]:null}Zki(ka,Pa){return ka?!ka.Xhc&&!!ka.fF&&ka.fF.Cd(Pa):(e.ULS.shipAssertTag(537151243,0,!!ka,"Pivot table can't be null"),!1)}mri(ka,Pa){return ka?!ka.Xhc&&!!ka.AL&&ka.AL.Cd(Pa):(e.ULS.shipAssertTag(537151242,0,!!ka,"Pivot table can't be null"),!1)}L_b(ka){super.L_b(ka);if((ka=V.HelperMethods.N5e(ka))&&0<ka.length){this.Qqb=Array(ka.length);for(let Pa=0;Pa<ka.length;Pa++)this.Qqb[Pa]=x.a.JQ(ka[Pa])}}HJb(){super.HJb();this.Qqb=null}k$g(ka,Pa){return this.RGe(ka,
Pa).returnValue}RGe(ka,Pa){var Fa=!1;if(!ka||!Pa)return{returnValue:!1,RY:Fa};ka=ka.clone();ka.right+=1;ka.left=ka.right;return!ka.Kz||ka.top<Pa.ib.$i&&(Fa=ka.clone(),Fa.bottom>=Pa.ib.$i&&(Fa.bottom=Pa.ib.$i-1),!({RY:Fa}=this.QGe(Fa,Pa)).returnValue)||ka.bottom>=Pa.ib.$i&&(Fa=ka.clone(),Fa.top<=Pa.ib.$i&&(Fa.top=Pa.ib.$i),!({RY:Fa}=this.QGe(Fa,Pa)).returnValue)?{returnValue:!1,RY:Fa}:{returnValue:!0,RY:Fa}}Fcg(ka){(ka=this.Bn(ka.topLeft))&&ka.toString()in this.qGa&&(this.qGa[ka.toString()].ftd=!1)}I8i(){this.raiseEvent("tce")}Zh(ka,
Pa){if(!this.CBc)return!1;switch(Pa){case -569786022:case 541421805:if(this.CBc.p_){const Fa=document.getElementById(da.ENj);Fa&&B.a.instance.create(()=>{A.DOMElementExtensions.Ugc(Fa,null)},0,z.a.xNj,!0,!0)}return!0;default:return!1}}dispose(){this.b4b(null,null);this.DMd(this.S1b);this.$.xa.Eg(this.NQf);this.$.Jl(this.b4b);this.fSb=null;this.$.ea&&this.$.ea.B0(this.BR);this.gridView.ha.rL(this.Sh);this.CBc=null;L.EwaSettings.ma(402)&&this.j1&&(f.a.Ia(this.j1),this.j1=null);super.dispose()}t9h(ka,
Pa,Fa,oa){const La=this.gridView.Bb.Bj(new y.Range(Pa,Fa,Pa,Fa,!1,!1));if(this.c7b=La){var Ea=La.usedRange,ca=ka.ctrlKey||d.a.isMac&&E.b(ka),$a=!ka.shiftKey&&ca;ka=ka.shiftKey&&!ca;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(T.h(this.$).ha.selectionType=3);switch(oa){case 0:this.xTb=0;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Pa=this.M6c(ka,Ea.top,Fa,Ea.bottom,Fa),this.HSd(Pa,$a,ka)):this.ISd(Ea.top,Fa,Ea.bottom,
Fa,w.d(La),w.g(La),$a);break;case 1:this.xTb=1;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Pa=this.M6c(ka,Pa,Ea.left,Pa,Ea.right),this.HSd(Pa,$a,ka)):this.ISd(Pa,Ea.left,Pa,Ea.right,!1,!1,$a);break;case 2:this.xTb=2;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Pa=this.M6c(ka,Ea.top,Ea.left,Ea.bottom,Ea.right),this.HSd(Pa,$a,ka)):this.ISd(Ea.top,Ea.left,Ea.bottom,Ea.right,w.d(La),w.g(La),$a);break;default:e.ULS.shipAssertTag(537151240,
0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${oa.toString()}`);return}L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(T.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}TBj(ka){const Pa=
this.c7b.usedRange;return this.Vkf(ka)||1!==this.bJa&&this.Vkf(new y.Range(Pa.top,ka.left,Pa.bottom,ka.right,!1,!1))?!0:!1}yJd(ka){return ka.Autofilters}QGe(ka,Pa){let Fa;Fa=!1;const oa=Pa.ib.Mi(ka),La=Pa.Df(oa).ui;if(!La)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${oa}`),{returnValue:!1,RY:Fa};if(!La.Ie(ka))return{returnValue:!0,RY:Fa};ka=Pa.jk("TableManager.CouldExpandImpl",ka,2);try{for(;ka.$$mn();){if(ka.$$cu().text||ka.Zn.Laf)return Fa=
!0,{returnValue:!1,RY:Fa};if(ka.$$cu().$H)return{returnValue:!1,RY:Fa}}}finally{ka&&ka.dispose()}return{returnValue:!0,RY:Fa}}x_h(ka){if(!ka)return null;const Pa=new m.AutofilterRange(ka.top,ka.left,ka.bottom,ka.right,null,null,null,ka.id,ka.oba);Pa.EBa=ka.EBa;const Fa=this.gridView.Bb.Bj(ka,!0);if(!Fa)return null;for(let oa=0,La=this.rangeList.length;oa<La;oa++){const Ea=this.rangeList[oa],ca=this.gridView.Bb.Bj(Ea,!0);ca&&ca.name===Fa.name&&Ea!==ka&&this.tqi(Ea)&&(Pa.union(Ea),Ea.EBa&&(Pa.EBa=!0))}return Pa}tqi(ka){return!!T.h(this.$).Bb.Bj(ka)}bNh(){const ka=
[];for(const Pa of this.rangeList){const Fa=new H.a(this.Bn(Pa.topLeft),t.d(this.$.oa));ka.push(Fa)}return ka}Bid(){const ka={};for(const Pa of this.rangeList){if(!Pa)continue;const Fa=this.Bn(Pa.topLeft);Fa&&(ka[Fa.toString()]=this.Bn(Pa.topLeft))}return ka}wyi(){this.$.ea.tg?this.Ozb(0):this.$.ea.Xk(this.eW)}Ozb(ka){this.$.ky(Pa=>{Pa.Taa(ka).then(this.iIb)})}W2h(ka){const Pa=this.gridView.Bb.Bj(ka);return Pa?Pa.name:ka.toString()}ISd(ka,Pa,Fa,oa,La,Ea,ca){const $a=ka+(La?1:0),Qa=Fa-(Ea?1:0),Va=
this.gridView.inRangePicker||this.gridView.ri;let fb=!1;const Ka=new y.Range($a,Pa,Qa,oa,!1,!1);if(La||Ea){La=Va?H.a.Rsb(this.gridView.ha.rangePicker.lL):this.gridView.ha.ra.selectedRanges;for(const hb of La){fb=this.Wrb(hb,$a,Pa,Qa,oa);La=this.Wrb(hb,ka,Pa,Fa,oa);if(Va&&fb)break;if(!Va&&(fb||La)){this.gridView.ha.updateSelection(hb,hb.topLeft,0,1);if(ca&&La)return;break}}}fb&&(Ka.top=ka,Ka.bottom=Fa);ka=Ka.topLeft;ca?this.gridView.ha.updateSelection(Ka,ka,0,1):Va?this.gridView.ha.mx([Ka],0,ka,0):
this.gridView.ha.updateSelection(Ka,ka,0,3)}HSd(ka,Pa,Fa){ka&&(Fa=Fa?T.h(this.$).ha.ra.activeCell:ka.topLeft,Pa?this.gridView.ha.updateSelection(ka,Fa,0,1):this.gridView.ha.mx([ka],0,Fa,0))}M6c(ka,Pa,Fa,oa,La){const Ea=w.d(this.c7b),ca=w.g(this.c7b),$a=Pa+(1!==this.bJa&&Ea?1:0),Qa=oa-(1!==this.bJa&&ca?1:0),Va=this.gridView.inRangePicker||this.gridView.ri;if(ka){var fb=L.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Va&&!H.a.Rsb(this.gridView.ha.rangePicker.lL).length?
new y.Range($a,Fa,Qa,La,!1,!1):Va?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ra.activeCell;fb=new y.Range(fb.top<$a?fb.top:$a,fb.left<Fa?fb.left:Fa,fb.bottom>Qa?fb.bottom:Qa,fb.right>La?fb.right:La,!1,!1)}else fb=new y.Range($a,Fa,Qa,La,!1,!1);if(1!==this.bJa&&(Ea||ca)&&(!ka||ka&&this.Wrb(fb,$a,Fa,Qa,La))){ka=Va?H.a.Rsb(this.gridView.ha.rangePicker.lL):this.gridView.ha.ra.selectedRanges;for(const Ka of ka)if(this.Wrb(Ka,$a,Fa,Qa,La)){fb.top=Pa;fb.bottom=oa;break}}return fb}Vkf(ka){const Pa=
this.gridView.inRangePicker||this.gridView.ri?H.a.Rsb(this.gridView.ha.rangePicker.lL):this.gridView.ha.ra.selectedRanges;for(const Fa of Pa)if(this.Wrb(Fa,ka.top,ka.left,ka.bottom,ka.right))return!0;return!1}Wrb(ka,Pa,Fa,oa,La){return!!ka&&ka.top===Pa&&ka.bottom===oa&&ka.left===Fa&&ka.right===La}}Object(u.a)(aa,"TableManager",n.a,[319,2]);class fa extends b.a{constructor(ka){super();this.tableManager=null;this.$=ka;this.Fb()}create(){this.nb(this.tableManager||(this.tableManager=new aa(this.$)))}}
Object(u.a)(fa,"TableManagerFactory",b.a,[]);var Oa=a(1219);a.d(F,"a",function(){return ba});const ba=()=>{c.a.Fa(ka=>{ka.da.Ga(134,new fa(ka));ka.da.Ga(330,new Oa.a(ka))})}},1219:function(u,F,a){u=a(0);var c=a(222),b=a(49),e=a(37),f=a(7),d=a(15),h=a(111),n=a(818),m=a(1463),x=a(725),r=a(1393),y=a(38),t=a(5),v=a(161),w=a(76),C=a(60),B=a(162),z=a(47),A=a(46),E=a(110);a(28);var I=a(193),L=a(29),V=a(282),T=a(1),H=a(22),D=a(13);a(30);class G{}Object(u.a)(G,"TableStyleElement",null,[]);var J=a(751),M=a(209),
Q=a(90),U=a(528);class Z{static Asf(va,N){return Z.Icg[va.Type]-Z.Icg[N.Type]}static Y4a(va,N){try{return appChrome.buildTableStyleGalleryIconNew(Z.QBa,Z.Joa,va,N)}catch(ea){return null}}static zmf(va){return va&&w.a.Jc in va&&(va=va[w.a.Jc])?H.a.YI(va,t.a.vIb):!1}static Cta(va){const N=[];let ea=0;for(const Ca of va){N[ea]={};N[ea].backgroundColor="white";N[ea].color="black";for(let la in Ca)switch(va=Ca[la],la){case "background-color":N[ea].backgroundColor=va;break;case "color":N[ea].color=va;break;
case "font-size":N[ea].fontSize=va;break;case "border-bottom":N[ea].borderBottom=va;break;case "border-right":N[ea].borderRight=va;break;case "border-left":N[ea].borderLeft=va;break;case "border-top":N[ea].borderTop=va}ea++}return N}static F5b(va,N){const ea=[];if(null===va||void 0===va?0:va.TableStyleElementsList){var Ca=0===va.Category;for(let la=0;la<Z.Joa;la++)ea.push(...Z.bRh(va,N,Ca,la))}else{if(Z.i8c)return Z.i8c;va={color:"black","background-color":"white"};for(N=0;N<Z.Joa;N++)for(Ca=0;Ca<
Z.QBa;Ca++)ea.push(va);Z.i8c=ea}return ea}static X2h(va,N){if(!va.TableStyleElementsList)return"";let ea="";for(const Ca of va.TableStyleElementsList)if(Ca.BackgroundColor&&"#000000"!==Ca.BackgroundColor)switch(Ca.Type){case 0:ea=Ca.BackgroundColor;break;case 5:case 7:if(N.fia||N.hS)ea=Ca.BackgroundColor;break;case 3:case 4:if(N.firstCol||N.lastCol)ea=Ca.BackgroundColor;break;case 2:N.totalRow&&(ea=Ca.BackgroundColor);break;case 1:N.headerRow&&(ea=Ca.BackgroundColor)}return ea}static G4b(va){va=new M.a(parseInt(String("0x"+
va.substr(1,2)),16),parseInt(String("0x"+va.substr(3,2)),16),parseInt(String("0x"+va.substr(5,2)),16));return J.a.rLa(va)}static V7e(va,N){if(!va||!N)return"";N=(N=Z.X2h(va,N))?Z.G4b(N)+", ":D.a.instance.ga(2064)+", ";switch(va.Index){case 0:return N+D.a.instance.ga(1998);case 1:return N+D.a.instance.ga(1999);case 2:return N+D.a.instance.ga(2E3);case 3:return N+D.a.instance.ga(2001);case 4:return N+D.a.instance.ga(2002);case 5:return N+D.a.instance.ga(2003);case 6:return N+D.a.instance.ga(2004);case 7:return N+
D.a.instance.ga(2005);case 8:return N+D.a.instance.ga(2006);case 9:return N+D.a.instance.ga(2007);case 10:return N+D.a.instance.ga(2008);case 11:return N+D.a.instance.ga(2009);case 12:return N+D.a.instance.ga(2010);case 13:return N+D.a.instance.ga(2011);case 14:return N+D.a.instance.ga(2012);case 15:return N+D.a.instance.ga(2013);case 16:return N+D.a.instance.ga(2014);case 17:return N+D.a.instance.ga(2015);case 18:return N+D.a.instance.ga(2016);case 19:return N+D.a.instance.ga(2017);case 20:return N+
D.a.instance.ga(2018);case 21:return N+D.a.instance.ga(2019);case 22:return N+D.a.instance.ga(2020);case 23:return N+D.a.instance.ga(2021);case 24:return N+D.a.instance.ga(2022);case 25:return N+D.a.instance.ga(2023);case 26:return N+D.a.instance.ga(2024);case 27:return N+D.a.instance.ga(2025);case 28:return N+D.a.instance.ga(2026);case 29:return N+D.a.instance.ga(2027);case 30:return N+D.a.instance.ga(2028);case 31:return N+D.a.instance.ga(2029);case 32:return N+D.a.instance.ga(2030);case 33:return N+
D.a.instance.ga(2031);case 34:return N+D.a.instance.ga(2032);case 35:return N+D.a.instance.ga(2033);case 36:return N+D.a.instance.ga(2034);case 37:return N+D.a.instance.ga(2035);case 38:return N+D.a.instance.ga(2036);case 39:return N+D.a.instance.ga(2037);case 40:return N+D.a.instance.ga(2038);case 41:return N+D.a.instance.ga(2039);case 42:return N+D.a.instance.ga(2040);case 43:return N+D.a.instance.ga(2041);case 44:return N+D.a.instance.ga(2042);case 45:return N+D.a.instance.ga(2043);case 46:return N+
D.a.instance.ga(2044);case 47:return N+D.a.instance.ga(2045);case 48:return N+D.a.instance.ga(2046);case 49:return N+D.a.instance.ga(2047);case 50:return N+D.a.instance.ga(2048);case 51:return N+D.a.instance.ga(2049);case 52:return N+D.a.instance.ga(2050);case 53:return N+D.a.instance.ga(2051);case 54:return N+D.a.instance.ga(2052);case 55:return N+D.a.instance.ga(2053);case 56:return N+D.a.instance.ga(2054);case 57:return N+D.a.instance.ga(2055);case 58:return N+D.a.instance.ga(2056);case 59:return N+
D.a.instance.ga(2057);default:return va.Name?va.Name:""}}static cYh(va){return(va+1)%Z.Sbi}static Zxb(va,N,ea=""){return va||!ea?`${Z.ddf}, ${va.Index.toString()}, -version, ${N.toString()}`:`${Z.ddf}, ${ea}, -version, ${N.toString()}`}static bRh(va,N,ea,Ca){const la=[];for(let Ra=0;Ra<Z.QBa;Ra++)la.push(Z.Ufd(va,N,ea,Ca,Ra));return la}static Ufd(va,N,ea,Ca,la){va=va.TableStyleElementsList;let Ra=new G;const lb={};if(!va)return lb;for(var Aa of va)if(0===Aa.Type){Ra=Aa;break}Aa=!!Ra.BackgroundColor;
let da="";!ea&&Ra.TableStyleBorderFromatList&&0<Ra.TableStyleBorderFromatList.length&&(da=Ra.TableStyleBorderFromatList[0].Color);lb["background-color"]=Aa?Ra.BackgroundColor:"#FFFFFF";Ra.FontColor||(Ra.FontColor="#000000");lb.color=Ra.FontColor;Z.XBe(Ca,la,lb,Ra,da,ea,Aa);for(const aa of va)aa&&0!==aa.Type&&(2!==aa.Type||Aa||(aa.BackgroundColor=Ra.BackgroundColor),Z.wtd(aa,Ca,la,N)&&(aa.BackgroundColor&&(lb["background-color"]=aa.BackgroundColor),lb.color=aa.FontColor||Ra.FontColor,Z.XBe(Ca,la,lb,
aa,da,ea,Aa)));return lb}static lV(va,N,ea,Ca,la,Ra){ea&&(ea.Color&&!ea.Style&&(ea.Style=1),ea.Style&&!ea.Color&&(ea.Color=la?"#000000":Ca?Ca:Ra?"#FFFFFF":"#000000"),N[Z.borders[va]]="1px "+Z.WV[ea.Style]+" "+ea.Color)}static wtd(va,N,ea,Ca){return-1===va.Type?!1:Z.ytd(va,N,ea,Ca)||Z.Esi(va,N,ea,Ca)||Z.ztd(va,N,ea,Ca)}static Esi(va,N,ea,Ca){return!N&&Ca.headerRow||N===Z.Joa-1&&Ca.totalRow?!1:1===N%2&&5===va.Type&&Ca.hS&&Ca.headerRow||1<N&&!!((N-1)%(va.BandSize+1))&&6===va.Type&&Ca.hS&&Ca.headerRow||
!(N%2)&&5===va.Type&&Ca.hS&&!Ca.headerRow||!!(N%(va.BandSize+1))&&6===va.Type&&Ca.hS&&!Ca.headerRow||!(ea%2)&&7===va.Type&&Ca.fia||!!(ea%(va.BandSize+1))&&8===va.Type&&Ca.fia}static ztd(va,N,ea,Ca){return N===Z.Joa-1&&2===va.Type&&Ca.totalRow||ea===Z.QBa-1&&N===Z.Joa-1&&12===va.Type&&Ca.totalRow&&Ca.lastCol||!ea&&N===Z.Joa-1&&11===va.Type&&Ca.totalRow&&Ca.firstCol||ea===Z.QBa-1&&4===va.Type&&Ca.lastCol}static ytd(va,N,ea,Ca){return!N&&1===va.Type&&Ca.headerRow||!ea&&3===va.Type&&Ca.firstCol||!ea&&
!N&&9===va.Type&&Ca.headerRow&&Ca.firstCol||ea===Z.QBa-1&&!N&&10===va.Type&&Ca.headerRow&&Ca.lastCol}static XBe(va,N,ea,Ca,la,Ra,lb){if(Ca.TableStyleBorderFromatList)for(const Aa of Ca.TableStyleBorderFromatList)if(Aa.Style)switch(Aa.Position){case 0:va&&12!==Ca.Type&&11!==Ca.Type&&2!==Ca.Type&&5!==Ca.Type&&6!==Ca.Type||Z.lV(0,ea,Aa,la,Ra,lb);break;case 1:va!==Z.Joa-1&&1!==Ca.Type&&10!==Ca.Type&&9!==Ca.Type&&5!==Ca.Type&&6!==Ca.Type||Z.lV(1,ea,Aa,la,Ra,lb);break;case 2:N&&12!==Ca.Type&&10!==Ca.Type&&
7!==Ca.Type&&8!==Ca.Type&&4!==Ca.Type||Z.lV(2,ea,Aa,la,Ra,lb);break;case 3:N!==Z.QBa-1&&9!==Ca.Type&&11!==Ca.Type&&3!==Ca.Type&&7!==Ca.Type&&8!==Ca.Type||Z.lV(3,ea,Aa,la,Ra,lb);break;case 5:N!==Z.QBa-1&&3!==Ca.Type&&4!==Ca.Type&&7!==Ca.Type&&8!==Ca.Type&&Z.lV(3,ea,Aa,la,Ra,lb);break;case 6:va!==Z.Joa-1&&2!==Ca.Type&&1!==Ca.Type&&5!==Ca.Type&&6!==Ca.Type&&Z.lV(1,ea,Aa,la,Ra,lb)}}static $2h(){const va=Array(12);va[0]=0;va[7]=1;va[8]=2;va[5]=3;va[6]=4;va[4]=5;va[3]=6;va[1]=7;va[2]=8;va[9]=9;va[10]=10;
va[11]=11;va[12]=13;return va}}Z.Joa=5;Z.QBa=5;Z.Sbi=5;Z.ddf="TableStyleIcon";Z.WV=[null,Q.a.solid,Q.a.dashed,Q.a.dotted,Q.a.dashed,Q.a.dotted,Q.a.dashed,Q.a.double];Z.borders=[U.a.borderTop,U.a.borderBottom,U.a.borderLeft,U.a.borderRight];Z.Icg=Z.$2h();Z.i8c=null;Object(u.a)(Z,"TableStyleHelper",null,[]);class P{constructor(va,N,ea,Ca,la,Ra){this.headerRow=va;this.totalRow=N;this.firstCol=ea;this.lastCol=Ca;this.hS=la;this.fia=Ra}equals(va){return va?this.headerRow===va.headerRow&&this.totalRow===
va.totalRow&&this.firstCol===va.firstCol&&this.lastCol===va.lastCol&&this.fia===va.fia&&this.hS===va.hS:!1}}Object(u.a)(P,"TableStyleOptions",null,[]);var S=a(792);class ja extends y.a{constructor(va,N,ea){super();this.T5i={["height"]:"100%"};this.xJb={};this.RIa=this.xjd=0;this.lastSyncTime=new Date;this.bea=-1;this.pO=null;this.cna={};this.NL=null;this.ZI={};this.oUa={};this.Stc=null;this.aCb=this.v7a=this.isInitialized=this.Okf=!1;this.Swc=null;this.bBc=this.EOb=this.nZe=!1;this.ORi=(Ca,la,Ra)=>
{let lb=!1;if(V.a(Ca))-315732528!==Ca.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${L.a.sc(Ca.Errors)}`),this.mDf(null,la,Ra));else if(d.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(Ca=Ca.Result)&&Ca.TableStyleItems.length){Ra=60<Ca.TableStyleItems.length;var Aa=!1,da=!1;if(this.NL)for(var aa=0;60>aa;++aa){const fa=Ca.TableStyleItems[aa],Oa=
this.NL.TableStyleItems[aa];if(fa.HasStyleViolations!==Oa.HasStyleViolations){lb=da=!0;break}for(let ba=0;9>ba&&!(ba>=fa.TableStyleElementsList.length);ba++)if(!H.a.equals(fa.TableStyleElementsList[ba].BackgroundColor,Oa.TableStyleElementsList[ba].BackgroundColor,!1)){lb=Aa=!0;break}}else{this.RIa=0;for(aa of Ca.TableStyleItems)aa.TableStyleElementsList&&aa.TableStyleElementsList.sort(Z.Asf),this.ZI[aa.Name]=aa}if(Aa||da)for(Aa=0;60>Aa;++Aa)da=Ca.TableStyleItems[Aa],this.ZI[da.Name]=da;if(Ra&&this.NL)for(d.ULS.sendTraceTag(42821700,
0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${Ca.TableStyleItems.length-60}`),lb=!0,Ra=60;Ra<Ca.TableStyleItems.length;++Ra)Aa=Ca.TableStyleItems[Ra],Aa.Name in this.ZI||Aa.TableStyleElementsList&&Aa.TableStyleElementsList.sort(Z.Asf),this.ZI[Aa.Name]=Aa;if(S.a(this.ZI).length!==Ca.TableStyleItems.length)for(lb=!0,Aa=Ra=60;Aa<this.NL.TableStyleItems.length;)Ra>=Ca.TableStyleItems.length?delete this.ZI[this.NL.TableStyleItems[Aa].Name]:Ra>=Ca.TableStyleItems.length||
!H.a.equals(Ca.TableStyleItems[Ra].Name,this.NL.TableStyleItems[Aa].Name,!1)?delete this.ZI[this.NL.TableStyleItems[Aa].Name]:++Ra,++Aa;this.NL=Ca;this.SSf(lb);lb&&this.g0c();la&&("accessibility"===la?(this.EOb=!1,this.bBc=!0):this.bBc=!1);this.Okf||(this.Usi()&&this.$.df(),this.Okf=!0);this.xjd=0;this.aCb||this.nZe?this.bBc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.nZe=!0)}};this.mDf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");
this.xjd++;5>this.xjd&&z.a.instance.create(()=>{this.z5a("getTableStylesFailed")},1E3,A.a.Hcg,!0,!0)};this.SIf=()=>{this.aCb&&(this.aCb=!1,this.Swc&&this.Swc(),z.a.instance.create(()=>{this.z5a("galleryMenuClosed")},1E3,A.a.Hcg,!0,!0))};this.$=va;this.Va=N;this.tableManager=ea;this.$.da.Ga(329,this);this.D0c=this.Uwb();this.$.Ja.KZa(this.SIf)}aaf(va){const N=this.tableManager.Lg;if(!N)return!1;va=va[w.a.Jc];if(!va)return!1;switch(Number.parseInvariant(va)){case 0:return B.d(N);case 1:return B.c(N);
case 2:return B.g(N);case 3:return B.e(N);case 4:return B.f(N);case 5:return B.b(N);case 6:return N.hasAutoFilter}return!1}QMf(va,N){if(h.a.isEmpty(this.ZI))return!0;if("PopulateTableMoreStylesMenu"!==va&&"PopulateTableAccessibleStylesMenu"!==va)return!1;if("PopulateTableAccessibleStylesMenu"===va&&!this.bBc)return this.EOb||(this.EOb=!0,this.z5a("accessibilityTab")),!0;this.aCb=!0;const ea=this.Va.fq("TableStylesMenu"),Ca=this.Va.bB("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),
la=this.Va.bB("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ra=this.Va.bB("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),lb=this.Va.bB("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let Aa=-123538519,da;if(N.MenuId)if(H.a.contains(N.MenuId,"FormatAsTable",!0))Aa=753331043,this.v7a=!0;else{da=D.a.instance.ga(1997);var aa=Z.Zxb(null,1,"-1");T.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?lb.lu("-1",Aa,"QueryTableStyle",
0,"-1",aa,void 0,void 0,da):lb.lu("-1",Aa,"QueryTableStyle",0,"-1",void 0,void 0,void 0,da);this.v7a=!1}aa=0;const fa=this.ZI;for(let Oa in fa){const ba=fa[Oa];if("PopulateTableAccessibleStylesMenu"===va&&ba.HasStyleViolations)continue;let ka;da=Z.V7e(ba,this.Uwb());ka=Z.Zxb(ba,this.RIa);if(ba)switch(ba.Category){case 0:Ca.lu(ba.Index.toString(),Aa,"QueryTableStyle",0,ba.Index.toString(),ka,void 0,void 0,da);aa++;break;case 3:la.lu(ba.Index.toString(),Aa,"QueryTableStyle",0,ba.Index.toString(),ka,
void 0,void 0,da);break;case 2:Ra.lu(ba.Index.toString(),Aa,"QueryTableStyle",0,ba.Index.toString(),ka,void 0,void 0,da);break;case 1:lb.lu(ba.Index.toString(),Aa,"QueryTableStyle",0,ba.Index.toString(),ka,void 0,void 0,da)}}0<aa&&this.R2(ea,Ca,1965);this.R2(ea,lb,1966);this.R2(ea,Ra,1967);this.R2(ea,la,1968);N.MenuItems=ea.MC();this.isInitialized||(this.isInitialized=!0);return!0}kld(va){va[n.a.On]=!1;let N=va[w.a.Jc];if(N&&!h.a.isEmpty(this.ZI)){H.a.contains(va.ParentMenuId,"FormatAsTable",!0)?
this.v7a=!0:this.v7a=!1;this.v7a||this.fig();Z.zmf(va)&&(N=this.mxb(N).toString());var ea=this.Uwb();va[n.a.Alt]="-1"===N?D.a.instance.ga(1997):Z.V7e(this.wjd(N),ea);if(N in this.oUa&&ea.equals(this.D0c))this.SMf(va,N,ea,!0);else{if(!this.Stc||this.Stc&&!this.Stc.Ep)this.cna={},this.Stc=z.a.instance.create(()=>{this.SSf();this.D0c=this.Uwb()},0,A.a.DNj,!0,!0);this.$Gd(ea,va,N)}}}getTableStyleIndexFromName(va){if(!va||h.a.isEmpty(this.ZI))return-1;if(va in this.ZI)return this.ZI[va].Index;this.z5a("getTableStyleIndexFromName");
return-1}Gtd(){return!!this.NL}mxb(va){this.pO||this.g0c();return va in this.pO?this.pO[va]:-1}z5a(va){if(this.$.isEditMode){var N=new Date;if(30<E.getElapsedSeconds(this.lastSyncTime,N)||h.a.isEmpty(this.ZI)||this.EOb){let ea=this.$.pa.ya.Wb();this.lastSyncTime=N;va=this.EOb&&"accessibilityTab"===va||"galleryMenuClosed"===va;C.m(this.$.pa.ya,va,this.ORi,this.mDf,null,va?"accessibility":"normal",ea)}}}dispose(){this.pO=this.oUa=this.NL=this.ZI=null;this.$.Ja.jKb(this.SIf);super.dispose()}jNg(va){this.addHandler("RefreshTableStyleGallery",
va)}gij(va){this.removeHandler("RefreshTableStyleGallery",va)}g0c(){const va={};this.tableManager.Lg&&(this.bea=this.getTableStyleIndexFromName(this.tableManager.Lg.BBc));for(let N=1;7>=N;N++)va["preview"+N]=this.gXh(N);this.pO=va}gXh(va){var N=this.NL.TableStyleItems.length;N=4>=this.bea?this.bea+va-1:4<this.bea&&this.bea<N-4?4===va?this.bea:Math.floor(this.bea+va-4):this.bea+va-1;-1===N||N.toString()in this.oUa||(N=va-3);return N}fig(){if(this.tableManager.Lg){let va=!1;const N=this.getTableStyleIndexFromName(this.tableManager.Lg.BBc);
if(N!==this.bea){if(this.pO){const ea=this.pO;for(let Ca in ea)ea[Ca]===N&&(va=!0)}this.bea=N;va||h.a.isEmpty(this.oUa)||this.g0c()}}}R2(va,N,ea){const Ca=this.Va.Ec();Ca.gq="Thin";Ca.title=D.a.instance.ga(ea);Ca.buttons.push(N);va.tc.push(Ca)}Uwb(){const va=this.tableManager.Lg;return this.v7a||!va?new P(!0,!1,!1,!1,!0,!1):new P(B.d(va),B.g(va),B.c(va),B.e(va),B.f(va),B.b(va))}SSf(va=!1){const N={},ea={},Ca=this.Uwb();if(!h.a.isEmpty(this.ZI)&&(this.tableManager.Lg&&this.fig(),!Ca.equals(this.D0c)||
va||h.a.isEmpty(this.oUa))){this.RIa=Z.cYh(this.RIa);va=this.ZI;for(var la in va){const Ra=va[la],lb=Z.Zxb(Ra,this.RIa);N[Ra.Index.toString()]=Z.Y4a(Z.Cta(Z.F5b(Ra,Ca)),lb);ea[lb]=N[Ra.Index.toString()];this.sAa(ea)}la=Z.Zxb(null,this.RIa,"-1");N["-1"]=Z.Y4a(Z.Cta(Z.F5b(null,Ca)),la);ea[la]=N["-1"];this.sAa(ea);I.c(this.oUa,N,!1)}}Usi(){const va=v.a(this.$);return va?va.Em.dA===t.a.RQa:!1}$Gd(va,N,ea){Number.parseInvariant(ea);"-1"===ea&&H.a.contains(N.ParentMenuId,"FormatAsTable",!0)||this.SMf(N,
ea,va,!1)}SMf(va,N,ea,Ca){const la=Z.Zxb(null,this.RIa,N);Z.zmf(va)?(la in this.cna?ea=this.cna[la]:(ea=Z.Cta(Z.F5b(this.wjd(N),ea)),this.cna[la]=ea),va[n.a.GalleryButtonProps]=Object(f.a)(new m.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:la,Alt:va[n.a.Alt],MenuItemId:N,TableCellStyles:ea,TableStyles:this.T5i})):(va[x.a.Icon]=la,va[n.a.GalleryButtonProps]=Object(f.a)(new r.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:la,Alt:va[n.a.Alt],MenuItemId:N}),Ca||(Ca=[],this.wjd(N),
"-1"===N||H.a.contains(va.ParentMenuId,"FormatAsTable",!0)||(Ca=Z.F5b(this.NL.TableStyleItems[Number.parseInvariant(N)],ea)),this.oUa[N]=Z.Y4a(Z.Cta(Ca),la)))}sAa(va){if(this.aCb)this.Swc=()=>{this.sAa(va)};else{this.Swc=null;var N=[];for(let Ca in va){var ea=Ca;ea in this.xJb?N.push(ea):this.xJb[ea]=!0}try{0<N.length&&appChrome.api.unregisterIcons(N),h.a.isEmpty(va)||appChrome.api.registerIconProvider(()=>va)}catch(Ca){}}}wjd(va){va=Number.parseInvariant(va);if(-1===va||!this.NL)return null;if(60<
va)for(let N=60;N<this.NL.TableStyleItems.length;++N){const ea=this.NL.TableStyleItems[N];if(ea.Index===va)return ea}return this.NL.TableStyleItems[va]}}Object(u.a)(ja,"TableStyleManager",y.a,[227,2]);var X=a(55);a.d(F,"a",function(){return Y});class Y extends c.a{constructor(va){super();this.tableStyleManager=null;this.$=va;this.Fb()}create(){const va=b.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya),N=b.GetServiceTaskFactory.Oa(this.$.da,66,134,this.Ya);e.TaskExtensions.za(X.Task.jJ(va,
N),()=>{this.nb(this.tableStyleManager||(this.tableStyleManager=new ja(this.$,va.result,N.result)))},this.$.ka,8)}}Object(u.a)(Y,"TableStyleManagerFactory",c.a,[])},1232:function(u,F,a){u=a(0);var c=a(222),b=a(15),e=a(164),f=a(247),d=a(376),h=a(4),n=a(644),m=a(87),x=a(95),r=a(259),y=a(161),t=a(74),v=a(423),w=a(49),C=a(37),B=a(92),z=a(71),A=a(1),E=a(573),I=a(21),L=a(33);class V extends x.a{constructor(U,Z){super(U);this.mT=[];this.bde=null;this.$Kb=P=>{let S="forward";P.Values[d.a.direction]?S=P.Values[d.a.direction].toLowerCase():
b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");P=0;let ja=!0;"backward"===S?(P=this.Sud.length-1,ja=!1):"forward"===S?(P=0,ja=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${S}`);this.Yvf(ja,P,!1)};this.lEf=()=>{this.mT=[]};this.KPa=P=>{-411645385===this.$.shortcutKeyManager.vs(P,!0)&&this.wjf()&&(this.$.Ja.Lb(new B.a(-411645385,1,this.$.Hc,6,null),{["event"]:P},P),P.stopPropagation())};this.jTi=P=>{this.Dma(P)};this.jb=Z;this.yq=
I.h(this.jb);this.Gc.la("keydown",this.jTi);this.Gc.la("keyup",this.KPa);r.a(Z).vNg(this.lEf);t.a(Z.va,27)&&C.TaskExtensions.za(w.GetServiceTaskFactory.Oa(Z.da,21,137,1),P=>{P=P.result;P.so(e.a.wcf);P.dm(e.a.wcf,this.$Kb)},Z.ka)}get $(){return this.jb}get Sud(){this.mT.length||(this.mT=this.a4e());return this.mT}get Ela(){return this.bde}set Ela(U){this.bde=U;this.mT=this.a4e()}dispose(){this.$&&r.a(this.$).uij(this.lEf);this.jb=null;this.mT.length=0;super.dispose()}D6i(U){this.Dma(U)}Yvf(U,Z,P=!0,
S=null){var ja=this.TMj(U,Z,P,S);if(!ja){P=Z;var X=U?1:-1,Y=this.Sud;do{ja=!1;if(t.a(this.$.va,27)){if(P+=X,P>=Y.length||0>P)ja=!0}else P=(P+X+Y.length)%Y.length;if(ja){this.zCi(U,Z,S);break}else if(ja=this.ocg(U,Z,P,!1,S))break}while(P!==Z)}}TMj(U,Z,P=!0,S=null){let ja=null;0<=Z&&(ja=this.mT[Z]);return(null===ja||void 0===ja?0:ja.Hf)&&ja.kg(U,P)?(S&&z.g(S),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${ja.de} into a sub region`),ja.sj(),!0):!1}ocg(U,Z,P,S,ja=null){P=this.mT[P];
if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const X=r.a(this.jb).qB(f.a.wKa),Y=r.a(this.jb).qB(f.a.hyb),va=this.yq.ha.Sa.s_;if(P===Y&&va||P===X&&!S&&!va)return!1}if((null===P||void 0===P?0:P.Hf)&&P.kg(U,!1)){ja&&z.g(ja);P.sj();if(U=this.mT[Z])U.dk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${U.de} to ${P.de}`);return!0}return!1}zCi(U,Z,P=null){P&&z.g(P);if(Z=this.mT[Z])Z.dk(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${Z.de}`);
C.TaskExtensions.za(w.GetServiceTaskFactory.Oa(this.$.da,21,137,0),S=>{S.result.Rj(e.a.znb,{[d.a.direction]:U?"forward":"backward"})},this.$.ka)}Dma(U){var Z=this.$.isEditMode?y.a(this.$):null;if(!this.$.rb.Bxa||V.Zni(Z))if(117===U.keyCode&&(U.ctrlKey||z.b(U))){Z=this.T6e(U.target);var P=!U.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${Z}`);if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)){var S=r.a(this.jb).qB(f.a.eLb);S=this.mT.indexOf(S);h.AFrameworkApplication.ta.Pa.Kw&&this.$.D_&&-1!==S&&Z===S&&n.ShyRibbon.OJ(this.$.Teb,0)}else h.AFrameworkApplication.ta.Pa.Kw&&this.$.D_&&1===Z&&n.ShyRibbon.OJ(this.$.Teb,0);this.Yvf(P,Z,!0,U)}else 117!==U.keyCode||V.CWe?-411645385===this.$.shortcutKeyManager.vs(U)?this.wjf()&&(this.$.Ja.Lb(new B.a(-411645385,1,this.$.Hc,6,null),{["event"]:U},U),U.stopPropagation()):1588554917===this.$.shortcutKeyManager.vs(U)?0===this.mode?(E.a(this.$)||this.$.Ja.Lb(new B.a(1588554917,
1,this.$.Hc,6,null),{["event"]:U},U),U.preventDefault(),U.stopPropagation()):3===this.mode&&(U.preventDefault(),U.stopPropagation()):A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.vs(U)?(Z=this.T6e(U.target),S=r.a(this.jb).qB(f.a.eLb),P=r.a(this.jb).qB(f.a.wKa),S=this.mT.indexOf(S),P=this.mT.indexOf(P),h.AFrameworkApplication.ta.Pa.Kw&&this.$.D_&&-1!==S&&Z===S&&1===this.$.Teb&&n.ShyRibbon.OJ(1,0),-1!==P&&Z!==P&&this.ocg(!0,
Z,P,!0,U)):this.A7h(U):(U=v.a.BC.notificationBar.O3(m.a.fTh(),!1),L.a.a8a()?U.image=3:U.image=0,v.a.BC.notificationBar.DC(U),V.CWe=!0)}T6e(U){const Z=this.Sud;for(let P=0,S=Z.length;P<S;++P){const ja=Z[P];if(ja&&ja.mh(U))return P}return-1}a4e(){const U=[];for(let Z=0,P=this.Ela.length;Z<P;Z++){const S=r.a(this.$).qB(this.Ela[Z]);S&&U.push(S)}return U}wjf(){return 0===this.mode||4===this.mode}static Zni(U){return U?U.inKeytipMode:!1}}V.CWe=!1;Object(u.a)(V,"AccessibilityManager",x.a,[360,2]);var T=
a(149),H=a(22),D=a(13);class G extends V{constructor(U){super(document.documentElement,U);this.qC=0;this.eUg=[f.a.GGe,f.a.rBd,f.a.lfc,f.a.MZd,f.a.eLb,f.a.i0c,f.a.Wdd,f.a.x9e,f.a.q_c,f.a.HBc,f.a.jIj,f.a.hyb,f.a.w1c,f.a.wKa,f.a.KTd,f.a.C1c,f.a.Kag,f.a.cqf,f.a.M_c];this.O1j=[f.a.lfc,f.a.rlg,f.a.qlg,f.a.slg];this.f6i=[f.a.lfc,f.a.pOf,f.a.qOf,f.a.sOf];this.b1g=[f.a.yZe,f.a.w9e,f.a.Udd,f.a.Sdd];this.K5i=[f.a.GGe,f.a.rBd,f.a.i0c,f.a.Wdd,f.a.q_c,f.a.HBc,f.a.hyb,f.a.w1c,f.a.wKa,f.a.KTd,f.a.QNf,f.a.C1c,f.a.M_c];
this.U5i=[f.a.hyb,f.a.DZe];const Z=D.a.instance.Ua(253);this.Yvj=this.$.shortcutKeyManager.mLa(Z);this.mode=0;U.da.Ga(15,this);C.TaskExtensions.za(w.GetServiceTaskFactory.Oa(U.da,21,137,1),P=>{P=P.result;P.so(e.a.znb);P.dm(e.a.znb,this.$Kb)},U.ka)}get mode(){return this.qC}set mode(U){this.qC=U;switch(U){case 0:this.Ela=this.eUg;break;case 2:this.Ela=this.O1j;break;case 3:this.Ela=this.f6i;break;case 4:this.Ela=this.b1g;break;case 5:this.Ela=this.K5i;break;case 6:this.Ela=this.U5i;break;default:b.ULS.shipAssertTag(537170759,
0,!0,"Accessibility Mode value is not in allowed values")}}Dma(U){this.$.qd&65536&&super.Dma(U)}A7h(U){if(H.a.equals(this.Yvj,this.$.shortcutKeyManager.Xgd(U),!1)){const Z=T.b(this.$);if(null===Z||void 0===Z?0:Z.Hf)z.g(U),Z.kg(!0,!1)}}}Object(u.a)(G,"EwaAccessibilityManager",V,[]);class J extends c.a{constructor(U){super();this.$=U;this.Fb()}create(){this.nb(this.$.da.Aa(15)||new G(this.$))}static la(U){U.da.Ga(157,new J(U))}}Object(u.a)(J,"AccessibilityManagerFactory",c.a,[]);var M=a(9);a.d(F,"a",
function(){return Q});const Q=()=>{M.a.Fa(J.la)}},1233:function(u,F,a){var c=a(9);u=a(0);var b=a(15),e=a(222),f=a(37),d=a(52),h=a(1),n=a(289),m=a(213);class x{}x.YSe="ewa-svg-icon";Object(u.a)(x,"CssClassNames",null,[]);var r=a(49),y=a(12),t=a(317),v=a(185);class w{constructor(z,A){this.htmlSanitizationHelper=null;this.ug=()=>{this.hqf();this.$.ea.jo(this.ug)};this.$=z;this.ncg={};this.lYd={};this.htmlSanitizationHelper=A;(A=this.I3e("excelInitialAppSprite"))?(this.rqe(A),this.$.ea.tg?this.hqf():
z.ea.Xk(this.ug),this.$.da.Ga(388,this)):b.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.lYd=null;this.$.ea.jo(this.ug)}hka(z,A,E=null,I=null){let L;(L=this.lYd[z])||(this.lYd[z]=L=this.v1i(this.ncg[z]));if(!L)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${z} was not found in loaded SVG sprites.`),null;const V=L.cloneNode(!0);if(!V.style){const T=t.b(L),H=t.b(V),D={};D.iconId=z;D.isOriginalNodeStyleNull=void 0===
L.style||null===L.style;D.isOriginalNodeCurrentStyleNull=void 0===L.currentStyle||null===L.currentStyle;D.isClonedNodeCurrentStyleNull=void 0===V.currentStyle||null===V.currentStyle;D.originalNode=T.substring(0,T.indexOf(">")+1);D.clonedNode=H.substring(0,H.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(D)}`)}V.setAttribute("style",`height: ${A}px; width: ${A}px;`);I&&(z=document.createElement("title"),
h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")?this.htmlSanitizationHelper.Ri(z,I):z.innerHTML=I,V.insertBefore(z,V.childNodes[0]));if(E)for(const T of E)Sys.UI.DomElement.addCssClass(V,T);return V}zba(z,A,E,I,L=0,V=0,T=null,H=null){L&&V||(V=y.DOMElementExtensions.getBoundingClientRect(I),L=V.height,V=V.width);if(T=this.hka(z,A,T,H))I.appendChild(T),(I=y.DOMElementExtensions.QZ(T,"style",
null))?T.setAttribute("style",I+` margin: ${(L-A)/2}px ${(V-E)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${z}`);return T}hqf(){f.TaskExtensions.za(r.GetServiceTaskFactory.Oa(this.$.da,283,284,0),z=>{z=v.c(z.result.kn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.za(z,()=>{const A=this.I3e("excelUiSlice20Sprite");A?this.rqe(A):b.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")},
this.$.ka,3)},this.$.da.ka,3)}rqe(z){for(const A of z)A.type===m.a.jYd&&(this.ncg[A.id]=A)}v1i(z){if(!z)return null;const A=z.viewBox;z=z.children;const E=document.createElementNS(n.a.mYd,m.a.jYd);Sys.UI.DomElement.addCssClass(E,x.YSe);E.setAttribute("focusable","false");E.setAttribute("viewBox",A);this.EJg(E,z);return E}EJg(z,A){for(const I of A){const L=document.createElementNS(n.a.mYd,I.type);for(let V in I){A=V;var E=I[V];"className"===A?L.setAttribute("class",E):L.setAttribute(A,E)}z.appendChild(L)}}I3e(z){return(z=
window[z])?z.icons:null}}Object(u.a)(w,"SvgIconProvider",null,[354,2]);class C extends e.a{constructor(z){super();this.$=z;this.Fb()}create(){var z=[130];if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")){z=d.a.ON(z,4,this.Ya,void 0,void 0,void 0,387);const A=r.GetServiceTaskFactory.Oa(this.$.da,498,499,0);f.TaskExtensions.za(f.TaskExtensions.Ed([z,A],this.$.ka),()=>{window.excelInitialAppSprite?
this.nb(this.$.da.Aa(388)||new w(this.$,A.result)):b.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}else f.TaskExtensions.za(d.a.ON(z,4,this.Ya,void 0,void 0,void 0,387),()=>{window.excelInitialAppSprite?this.nb(this.$.da.Aa(388)||new w(this.$,null)):b.ULS.sendTraceTag(509694111,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}static la(z){z.da.Ga(387,new C(z))}}Object(u.a)(C,"SvgIconProviderFactory",e.a,[]);a.d(F,"a",function(){return B});
const B=()=>{c.a.Fa(C.la)}},1258:function(u,F,a){var c=a(9);u=a(0);var b=a(222),e=a(21),f=a(480);class d extends f.a{constructor(m,x){super(m);x.Ga(240,this)}c2h(m){for(const x of this.rangeList)if(m.range.contains(x))return x;return null}yJd(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?m.getSparklineRanges():null}}Object(u.a)(d,"SparklineManager",f.a,[325]);class h extends b.a{constructor(m){super();this.sparklineManager=null;this.$=
m;this.Fb()}create(){this.nb(this.sparklineManager||(this.sparklineManager=new d(e.h(this.$),this.$.da)))}static la(m){m.da.Ga(239,new h(m))}}Object(u.a)(h,"SparklineManagerFactory",b.a,[]);a.d(F,"a",function(){return n});const n=()=>{c.a.Fa(h.la)}},1280:function(u,F,a){u=a(0);var c=a(144),b=a(600);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.jpd()&&c.WacAirSpace.pCc()}animate(h,n,m,x,r){n&&c.WacAirSpace.FL(h.element,n);c.WacAirSpace.animate(h,x,r);m&&c.WacAirSpace.zej(h.element,
m)}}Object(u.a)(e,"AnimationManager",b.a,[2]);var f=a(101);a.d(F,"a",function(){return d});const d=()=>{f.a.Tl.Ga(141,new e)}},1454:function(u,F,a){a.r(F);u=a(1201);F=a(1165);var c=a(1123),b=a(1124),e=a(1125),f=a(1127);a(1126);var d=a(1232),h=a(1280),n=a(9),m=a(0),x=a(222),r=a(187),y=a(553),t=a(15),v=a(814),w=a(520),C=a(82),B=a(4),z=a(78),A=a(907);class E extends z.a{constructor(D){super();this.Pvd=null;this.$=D;t.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}knj(){const D=new r.a,
G=w.a.jr(C.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>")),J=new y.a(()=>G.result);this.Pvd=new y.a(()=>new v.a(J.value,null));if(!this.Pvd)return D;var M=this.Pvd.value.a_("NewAndOpenCoreManager",!1);if(!M||3!==M.state||!M.Yzd)return M?t.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${M.state}, mruResult MruDocuments is null: ${!M.Yzd}`):t.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;
M=M.Yzd;const Q=["xlsx","xlsb","xlsm"];for(let Z=0;Z<M.length;Z++){var U=M[Z];if(0>Array.indexOf(Q,U.extension))continue;const P=`${U.title}.${U.extension}`,S=A.b(U,B.AFrameworkApplication.isRtl);U=U.url;P&&S&&U?D.add({[E.fileName]:P,[E.friendlyPath]:S,[E.section]:"mru",[E.absoluteUrl]:U}):U||t.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return D}dispose(){super.dispose()}}E.fileName="FileName";E.friendlyPath="FriendlyPath";E.section="Section";
E.absoluteUrl="AbsoluteUrl";Object(m.a)(E,"NewAndOpenCoreManager",z.a,[615,2]);class I extends x.a{constructor(D){super();this.$=D;this.Fb()}create(){this.nb(this.$.da.Aa(451)||this.$.da.Ga(451,new E(this.$)))}static la(D){D.da.Ga(164,new I(D))}}Object(m.a)(I,"NewAndOpenCoreFactory",x.a,[]);m=a(1156);x=a(1258);z=a(1233);var L=a(1202),V=a(1159),T=a(1149),H=a(1169);a=a(1141);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(u.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(F.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(d.a)();n.a.Fa(I.la);Object(h.a)();Object(m.a)();Object(x.a)();Object(z.a)();Object(f.a)();Object(L.a)();Object(V.a)();Object(T.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(H.a)();
Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/c5206e911af8361b765a607b8e03a984/EwaDSEsNext.acc.js.map