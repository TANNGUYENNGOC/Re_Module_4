'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1446:function(u,F,a){a.r(F);var c=a(0),b=a(513),e=a(48),f=a(9),d=a(52),h=a(89),n=a(55),m=a(83),x=a(222),r=a(420),y=a(37),t=a(7),v=a(15),w=a(85),C=a(82),B=a(224),z=a(14),A=a(108),E=a(4),I=a(87),L=a(147),V=a(120),T=a(574),H=a(95),D=a(734),G=a(5),J=a(723),M=a(132),Q=a(374),U=a(188),Z=a(283),P=a(33),S=a(247),ja=a(565),X=a(12),Y=a(1),va=a(11),N=a(13),ea=a(21),Ca=a(133),la=a(152),Ra=a(347),lb=a(684),Aa=a(554),da=
a(19);const aa=da.a.Fad;class fa extends H.a{constructor(Sb,yc,Fc,Zc){super(Sb);this.hte='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.R0b=null;this.Zmd=this.aeg=!1;this.Fae=this.wj=this.qf=null;this.vq=0;this.button=null;this.mPf=!1;this.pec="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=Rd=>{if(void 0!==Rd.Ca&&null!==Rd.Ca&&Rd.Ca.keyCode===w.a.Yy)if(Rd.Ca.shiftKey){if(!P.a.fd(this.$)){Rd=this.$.da.Aa(183);if(!Rd)return!1;Rd.RRd()}}else this.kg(!0,
!1),Rd.Ca.preventDefault(),Rd.Ca.stopPropagation();return!0};this.Zpc=(Rd,Ed)=>{Object.getType(Ed)===String&&Ed.toString()===this.qf.InstanceId&&(Rd=!!this.title,Ed=!this.Zmd,Rd&&this.jPe(),this.lgg(),P.a.fd(this.$)&&(Rd&&this.aeg||Ed&&this.Zmd)&&this.c8.updateTaskPane(this.i1,this.aC))};this.uma=()=>{var Rd;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&this.wj.TLd(this.qf.InstanceId);const Ed=ja.a(this.qf);if(Ed)if(this.qf.TaskpaneTitle===N.a.instance.ga(981))v.ULS.sendTraceTag(537151139,
9,50,"Chart task pane closed");else if(this.qf.PrimaryMarketplace)if("FA000000005"===this.qf.PrimaryMarketplace.SolutionId){v.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let ne="Unknown",ze="Unknown",Be="Unknown";null===(Rd=this.qf.OsfPropertyBag)||void 0===Rd?void 0:Rd.forEach(td=>{2===td.length&&("LaunchMode"===td[0]?ne=td[1]:"CorrelationId"===td[0]?ze=td[1]:"LaunchSelectionMode"===td[0]&&(Be=td[1]))});Rd={["LaunchMode"]:ne,["CorrelationId"]:ze,["LaunchSelectionMode"]:Be,["Location"]:"taskPane"};
Ca.b(this.$).ud(M.a.I4g,Rd,void 0,!0);'"Default"'===ne?C.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(td=>{td.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===ne?C.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(td=>{td.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",null)}):'"RecommendedPivotTables"'===ne&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?C.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(td=>
{td.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===ne&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&C.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(td=>{td.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",null)})}else P.a.cji()&&"FA000000043"===this.qf.PrimaryMarketplace.SolutionId?"Record Actions"===this.qf.TaskpaneTitle&&(this.$.Pba=!1,v.ULS.sendTraceTag(537151137,0,50,
"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.qf.PrimaryMarketplace.SolutionId===T.a?this.Krf(!1):Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)&&"FA000000075"===this.qf.PrimaryMarketplace.SolutionId&&(Rd=this.$.da.Aa(465))&&Rd.YMe();va.HelperMethods.Gw(this.qf)?this.yg(!1):(P.a.fd(this.$)?this.c8.hideTaskPane(this.i1):this.raiseEvent("AgavePaneRemovedEventKey"),this.wj.qRa(this.qf.InstanceId),
P.a.fd(this.$)||this.c8.lA());ea.h(this.$).setFocus();if(1===this.qf.WebExtensionOsfControlType&&!Ed){this.qf.TaskpaneVisible=!1;const ne=this.$.pa.ya.Wb();Q.a(this.$.userOperationManager,(ze,Be,td)=>Z.c(this.$.pa.ya,this.qf.InstanceId,!1,ze,Be,td,ne),ze=>new U.a(547,0,ze,64),null)}return!0};this.LFf=(Rd,Ed)=>{Object.getType(Ed)===String&&Ed.toString()===this.qf.InstanceId&&(P.a.fd(this.$)?this.c8.hideTaskPane(this.i1):this.raiseEvent("AgavePaneRemovedEventKey"))};this.KFf=(Rd,Ed)=>{Object.getType(Ed)===
String&&Ed.toString()===this.qf.InstanceId&&(this.B_d(),P.a.fd(this.$)?this.Y6():this.c8.oG(this,!0))};this.onResize=()=>{this.H$c()};this.$=yc;this.c8=Fc;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")&&Zc?Zc.Ri(this.domElement,String.format(this.hte,aa,this.$.Eb+G.a.hYc,this.$.Eb+G.a.gYc)):this.domElement.innerHTML=String.format(this.hte,aa,this.$.Eb+G.a.hYc,this.$.Eb+G.a.gYc);
this.nrg=X.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+G.a.gYc);this.usa=X.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+G.a.hYc);Y.EwaSettings.ma(415)&&(this.R0b=X.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId"));Sb=X.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");this.Moa=this.Dah();Sb.appendChild(this.Moa);B.a.instance.sa(z.a.click,this.Moa,this.uma);this.Ekc=A.KeyInputManager.instance.Ns(this.Moa,this.uma,
w.a.Mh);P.a.fd(this.$)||A.KeyInputManager.instance.sa(z.a.Pb,this.Moa,this.onCloseButtonTabKeyDown);X.DOMElementExtensions.setVisible(this.usa,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.H$c();this.$&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&this.domElement.classList.add(D.a.ASe);this.$.QA(this.onResize)}NP(Sb){this.addHandler("AgavePaneRemovedEventKey",Sb)}ZR(Sb){this.removeHandler("AgavePaneRemovedEventKey",
Sb)}sKg(Sb){this.addHandler("AgavePaneReadyKey",Sb)}Vfj(Sb){this.removeHandler("AgavePaneReadyKey",Sb)}get YGa(){return this.nrg}get jh(){return 6}get Ek(){return this.qf.TaskpaneIconCssClass||""}get wN(){return this.qf.TaskpaneButtonTooltip||this.qf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.Fae}get Kp(){return this.qf.TaskpaneWidth}get isResizable(){const Sb=yc=>{var Fc,Zc;return(null===(Zc=null===(Fc=this.qf)||void 0===Fc?void 0:Fc.PrimaryMarketplace)||void 0===Zc?void 0:Zc.SolutionId)===
yc};return!OSF.OsfControl.isFirstPartyStoreString(this.qf.PrimaryMarketplace.MarketplaceType)&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||Sb("FA000000043")||Sb("FA000000054")||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&Sb("FA000000005")||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&Sb("FA000000050")?!0:!1}get de(){return S.a.cPg}get mc(){return this.domElement}get Hf(){return!!this.qf}get title(){return this.wj.NRh(this.qf.InstanceId)}get titleText(){return this.title}get b_a(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.qf.InstanceId}get i1(){return"AgaveTaskPane-"+
this.instanceId.replace(RegExp("[{}]","g"),"")}get aC(){const Sb=this.c8.xva(this.mc,this.titleText,this.Kp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Kp,void 0,this.iconUrl,this.qf.TaskpaneIconId,va.HelperMethods.Gw(this.qf));if(Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.qf.SrcLocationOverrideResourceId===this.pec){Sb.contentProps.type="OcvFeedbackTaskPaneProps";Sb.hideHeader=
!1;let yc=JSON.parse(this.qf.OsfPropertyBag[0][1]);yc.IsProd=!0;Sb.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:yc,taskPaneLocation:Sb.location,taskPaneIdToClose:this.i1}}return Sb}startEdit(){return!0}VAc(){return!0}lof(){this.wj.Yh.notifyAgave(this.qf.InstanceId,OSF.AgaveHostAction.TabIn)}mof(){this.wj.Yh.notifyAgave(this.qf.InstanceId,OSF.AgaveHostAction.TabInShift)}FDd(){this.wj.dXc(this.LFf);this.wj.ZKg(this.KFf);let Sb=this.wj.$fd(this.qf.InstanceId);this.title&&Sb||this.wj.bLg(this.Zpc);
this.title&&this.jPe();this.raiseEvent("AgavePaneReadyKey");P.a.fd(this.$)&&(""!==this.Ek?d.a.me(10):d.a.current.fo(102),this.hig(),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&P.a.fd(this.$)&&va.HelperMethods.Gw(this.qf)&&this.qf.Preload&&!this.qf.TaskpaneVisible?this.v6b():this.Y6())}v6b(){this.c8.v6b(this.i1,this.aC)}Y6(){this.c8.Y6(this.i1,this.aC)}dispose(){var Sb,yc;this.mPf||(null===(yc=null===(Sb=this.qf)||void 0===Sb?void 0:Sb.PrimaryMarketplace)||void 0===
yc?void 0:yc.SolutionId)!==T.a||this.Krf(!0);B.a.instance.Ba(z.a.click,this.Moa,this.uma);A.KeyInputManager.instance.Tv(this.Moa,this.Ekc);P.a.fd(this.$)||A.KeyInputManager.instance.Ba(z.a.Pb,this.Moa,this.onCloseButtonTabKeyDown);this.wj&&(this.wj.ygj(this.Zpc),this.wj.wgj(this.LFf),this.wj.vgj(this.KFf),this.$&&(this.$.aE(this.onResize),this.$=null));this.$=this.qf=null;super.dispose()}hig(){this.qf&&this.lgg()}IR(Sb){Sb||this.B_d()}yg(Sb){if(this.qf){const yc=this.qf.TaskpaneVisible!==Sb;this.qf.TaskpaneVisible=
Sb;P.a.fd(this.$)?Sb||this.c8.hideTaskPane(this.i1):this.c8.lA();va.HelperMethods.Gw(this.qf)&&yc&&this.wj.GGh(this.instanceId,Sb)}}nq(){let Sb=!1;this.qf&&this.$.qd&8388608&&(Sb=this.qf.TaskpaneVisible);return Sb}Fs(){return!this.qf||OSF.OsfControl.isFirstPartyStoreString(this.qf.PrimaryMarketplace.MarketplaceType)||this.$.Z2?va.HelperMethods.Gw(this.qf)?this.qf.TaskpaneVisible:!!this.qf:!1}kg(Sb,yc){return yc?!1:(this.B_d(),this.wj.Yh.notifyAgave(this.qf.InstanceId,Sb?OSF.AgaveHostAction.TabIn:
OSF.AgaveHostAction.TabInShift),!0)}mh(Sb){return X.DOMElementExtensions.Af(this.mc,Sb)}sj(){}dk(){}VQ(Sb,yc){var Fc=yc.querySelectorAll(X.DOMElementExtensions.Gr);yc=X.DOMElementExtensions.um(Fc);Fc=X.DOMElementExtensions.oB(Fc);let Zc=!1;yc===Sb.Gb&&Sb.Ca.shiftKey?((Sb=document.getElementById(this.$.Eb+G.a.$nc))&&X.DOMElementExtensions.isVisible(Sb)?X.DOMElementExtensions.setFocus(Sb):this.kg(!1,!1),Zc=!0):Fc!==Sb.Gb||Sb.Ca.shiftKey||(this.O3f(),Zc=!0);return Zc}O3f(){this.Moa&&X.DOMElementExtensions.setFocus(this.Moa)}Dah(){const Sb=
document.createElement("a");Sb.tabIndex=0;Sb.id="AgaveTaskpaneCloseButtonId";Sb.className=G.a.xfb+(E.AFrameworkApplication.isRtl?G.a.Maa:G.a.Naa);Sb.title=N.a.instance.ga(10);Sb.setAttribute(I.a.Ld,I.a.pt);Sb.style.borderColor="transparent";Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?Sb.style.margin="6px 6px 0px 6px":Sb.style.margin="6px";Sb.style.zIndex="2";Sb.style.position="relative";const yc=document.createElement("span");yc.className="StandardButtonImage clip16x16 StandardButtonImageNoText";
yc.id=Sb.id+"-close";const Fc=la.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,N.a.instance.ga(793));yc.appendChild(Fc);Sb.appendChild(yc);return Sb}jPe(){this.usa.innerText=this.title;this.usa.style.textOverflow="ellipsis";this.usa.style.whiteSpace="nowrap";this.usa.style.overflowX="hidden";this.qf.TaskpaneTitleCssClass&&(this.usa.className=this.usa.className+" "+this.qf.TaskpaneTitleCssClass);Y.EwaSettings.ma(415)&&(this.R0b.className=this.R0b.className+" "+this.qf.TaskpaneHeaderCssClass);
X.DOMElementExtensions.setVisible(this.usa,!0);this.button&&(this.button.p0a.title=this.title);this.H$c();this.aeg=!0}lgg(){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.Ek&&!P.a.fd(this.$)){if(this.button){var Sb=d.a.me(10),yc=this.button.Hl;yc.setAttribute("src",Sb);yc.setAttribute("class",this.Ek)}return}}else if(this.Ek){this.button&&(Sb=d.a.me(10),yc=this.button.Hl,yc.setAttribute("src",Sb),yc.setAttribute("class",this.Ek));return}if(yc=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?
this.qf.TaskpaneIconUrl?this.qf.TaskpaneIconUrl:this.wj.$fd(this.qf.InstanceId):this.wj.$fd(this.qf.InstanceId))this.$.Uba&&this.qf.PrimaryMarketplace&&this.qf.PrimaryMarketplace.SolutionId===J.a.solutionId&&(yc=this.tVh(yc)),P.a.fd(this.$)?this.Fae=yc:(Sb=this.button.Hl,Sb.setAttribute("src",yc),yc=d.a.current.fo(102),Sb.setAttribute("onerror","this.onerror = null;this.src = '"+yc+"';")),this.Zmd=!0}tVh(Sb){const yc=J.a.Adc(this.$),Fc=J.a.G4(this.$),Zc=J.a.fba(this.$),Rd=J.a.Gxb(this.$),Ed=this.qf.SrcLocationOverrideResourceId,
ne=P.a.fd(this.$);return Ed===yc?ne?Sb.replace("/icon-32.png","/record-tp-20.png"):Sb.replace("/icon-32.png","/record-tp-32.png"):Ed===Fc?ne?Sb.replace("/icon-32.png","/code-tp-20.png"):Sb.replace("/icon-32.png","/code-tp-32.png"):Ed===Zc?ne?Sb.replace("/icon-32.png","/rfb-tp-20.png"):Sb.replace("/icon-32.png","/rfb-tp-32.png"):Ed===Rd?ne?Sb.replace("/icon-32.png","/flowconnector-tp-20.png"):Sb.replace("/icon-32.png","/flowconnector-tp-32.png"):Sb}H$c(){this.$&&!Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
(this.YGa.style.height=va.HelperMethods.uc(this.c8.ZO.offsetHeight-this.R0b.offsetHeight))}B_d(){this.wj.vBd(this)}Krf(Sb){Sb={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:Sb.toString()};const yc=new lb.a(Aa.a.ak());yc.add("PaneClosedTime",3);yc.add("IsSessionEnded",1);L.a.sendTelemetryEvent(Object(t.a)(new Ra.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:V.a.Zj(Sb,yc)}));this.mPf=!0}}Object(c.a)(fa,"AgaveTaskPane",H.a,[34,450,472,310]);var Oa=a(49);class ba extends x.a{constructor(Sb){super();
this.WFd=[];this.ZJf=null;this.bzf=yc=>{this.nb(Object(m.a)(450,yc))};this.$=Sb;this.Fb()}create(){const Sb=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")?Oa.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):n.Task.Ta(null),yc=r.a(this.$);y.TaskExtensions.za(y.TaskExtensions.Ed([yc,Sb],this.$.ka),()=>{const Fc=new fa(document.createElement("div"),this.$,yc.result,Sb.result);
this.WFd.push(Fc);Fc.sKg(this.bzf);this.Ra.raiseEvent(x.a.m_c,null,Fc)},this.ka,3)}dispose(){for(const Sb of this.WFd)Sb.Vfj(this.bzf);h.a.rc(this.WFd);h.a.Ia(this.ZJf);this.$=this.ZJf=null;super.dispose()}}Object(c.a)(ba,"AgaveTaskPaneFactory",x.a,[]);var ka=a(30),Pa=a(238),Fa=a(210),oa=a(259),La=a(60),Ea=a(47),ca=a(46),$a=a(326),Qa=a(71),Va=a(22),fb=a(285),Ka=a(281);const hb=da.a.Hzh,fc=`<div class="${da.a.Fad}"><div title="{0}" class="${da.a.Rwh}">{0}</div></div><div><div class="${da.a.Mwh}">{1}</div><div class="${da.a.Owh} ${da.a.Ao}" id="parametersSection">&nbsp;</div><div align="bottom" class="${da.a.Lwh}"><button class="${da.a.wSe} ${da.a.Kwh}" id="applyButton" type="submit">{2}</button><button class="${da.a.wSe}" id="resetButton" type="button">{3}</button></div></div>`,
dc=`<div><div class="${da.a.Pwh}"><label for="{2}" title="{1}">{0}</label></div><div class="${da.a.Qwh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;class wb extends Pa.a{constructor(Sb,yc,Fc,Zc){super(Sb);this.qSd=this.zWa=this.k1=null;this.vq=0;this.htmlSanitizationHelper=null;this.YHf=()=>{this.zWa=null};this.uxj=()=>{h.a.Ia(this.qSd);this.qSd=null;this.isVisible!==this.aUd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.B6g=(Rd,Ed)=>Va.a.compare(Rd.Name,Ed.Name,!0);
this.jzf=Rd=>{Qa.g(Rd);if(!this.Esa.domElement.classList.contains(da.a.f$b)){ea.h(this.$).To(!0);var Ed=[];for(Rd=0;Rd<this.k1.length;Rd++){const ze=this.zWa[Rd],Be=this.k1[Rd].text;ze.Values=[Be];Be&&Ed.push(ze)}if(Ed.length){var ne=this.$.pa.ya.Wb();this.Esa.addCssClass(da.a.f$b);this.$.userOperationManager.Ic(new U.a(142,0,(ze,Be,td)=>La.F(this.$.pa.ya,Ed,!1,0,!1,Ka.b(ze,this.fXi),Ka.a(Be,this.eXi),td,null,ne)),null)}}};this.SVi=Rd=>{Qa.g(Rd);Rd=this.k1;for(let Ed=0,ne=Rd.length;Ed<ne;Ed++)Rd[Ed].text=
""};this.fXi=()=>{this.Esa.removeCssClass(da.a.f$b)};this.eXi=()=>{this.Esa.removeCssClass(da.a.f$b)};this.XGb=(Rd,Ed)=>{13===Ed.charCode&&this.jzf(Ed)};this.$=yc;this.taskPaneManager=Fc;this.htmlSanitizationHelper=Zc;yc=String.format(fc,this.titleText,N.a.instance.ga(1325),N.a.instance.ga(1326),N.a.instance.ga(1327));this.htmlSanitizationHelper&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
this.htmlSanitizationHelper.Ri(Sb,yc):Sb.innerHTML=yc;this.Uab=this.getElementById("parametersSection");this.Esa=new $a.a(this.getElementById("applyButton"));this.Esa.Gc.la("click",this.jzf);this.VNd=new $a.a(this.getElementById("resetButton"));this.VNd.Gc.la("click",this.SVi);this.$.ea.Wj(this.YHf);oa.a(this.$).di(this)}NP(Sb){this.get_events().addHandler("RemoveParamTpEventKey",Sb)}ZR(Sb){this.get_events().removeHandler("RemoveParamTpEventKey",Sb)}QE(Sb){this.addHandler("parameterTaskPaneVilibilityChanged",
Sb)}lG(Sb){this.removeHandler("parameterTaskPaneVilibilityChanged",Sb)}get w8b(){this.Bef();return this.zWa}get mc(){return this.domElement}get Kp(){return 250}get isResizable(){return!1}get Hf(){return this.isVisible}get de(){return S.a.M0i}get jh(){return 2}get Ek(){return hb}get wN(){return N.a.instance.ga(1066)}get aUd(){return!!this.w8b&&0<this.w8b.length&&!this.$.isEditMode}get titleText(){return N.a.instance.ga(1324)}get aC(){return this.taskPaneManager.xva(this.mc,this.titleText,this.Kp,this.isResizable,
()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}yg(Sb){P.a.fd(this.$)&&(Sb?(this.Bef(),this.taskPaneManager.Y6("ParametersTaskPane",this.aC)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}nq(){return this.aUd}Fs(){return this.aUd}IR(){}dispose(){this.$&&this.$.ea.tk(this.YHf);this.OUf();h.a.rc([this.Esa,this.VNd]);this.zWa=this.Uab=this.$=this.Esa=this.VNd=null;super.dispose()}kg(Sb,yc){yc||(this.k1&&0<this.k1.length?this.k1[0]:this.Esa).focus();
return!yc}mh(Sb){return X.DOMElementExtensions.Af(this.mc,Sb)}sj(){}dk(){}VQ(){return!1}Bef(){!this.zWa&&this.$.qd&2048&&this.NSg(this.$.workbookContext.TaskPaneParameters,this.$.va.SlicerParameters)}NSg(Sb,yc){var Fc=[];this.OUf();if(!this.$.isEditMode&&Sb&&0<Sb.length){var Zc=this.B6g;if(yc&&0<yc.length){var Rd=new Fa.a([...yc]);Rd.q$.sort(Zc)}else Rd=null;for(let ne=0,ze=Sb.length;ne<ze;ne++){var Ed=Sb[ne];yc&&!(0>va.HelperMethods.jw(Rd,0,Rd.Yja(),Ed,Zc))||Ed.IsPivotPageField||Ed.IsSlicer||Fc.push(Ed)}}this.zWa=
Fc;if(this.Uab&&(this.isVisible!==0<Fc.length&&(this.qSd=Ea.a.instance.create(this.uxj,500,ca.a.N0i,!0,!0)),this.htmlSanitizationHelper&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.QJ(this.Uab):this.Uab.innerHTML="",Fc.length)){yc="";Sb=[];for(let ne=0,ze=Fc.length;ne<ze;ne++)Zc=this.$.Eb+"param"+ne,Sb.push(Zc),Ed=Fc[ne],Rd=Ed.Name?ka.a.Hg(Ed.Name):
"",Ed=Ed.Comment?ka.a.XQ(Ed.Comment):"",yc+=String.format(dc,Rd,Ed,Zc);this.htmlSanitizationHelper&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.Ri(this.Uab,yc):this.Uab.innerHTML=yc;yc=[];for(let ne=0,ze=Fc.length;ne<ze;ne++)Fc=new fb.a(document.getElementById(Sb[ne])),yc.push(Fc),Fc.cMg(this.XGb);this.k1=yc}}OUf(){if(this.k1){for(let Sb=0,yc=
this.k1.length;Sb<yc;Sb++)this.k1[Sb].lhj(this.XGb);h.a.rc(this.k1);this.k1=null}}static OSg(Sb,yc,Fc){const Zc=Sb.da;let Rd=Zc.Aa(17);if(!Rd){const Ed=document.getElementById(Sb.Eb+G.a.O0i);Ed&&(Rd=Zc.Ga(17,new wb(Ed,Sb,yc,Fc)))}return Rd}}Object(c.a)(wb,"ParametersTaskPane",Pa.a,[125,472,34,2]);class Tb extends x.a{constructor(Sb){super();this.$=Sb;this.Fb()}create(){const Sb=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
Oa.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):n.Task.Ta(null),yc=r.a(this.$);y.TaskExtensions.za(y.TaskExtensions.Ed([yc,Sb],this.$.ka),()=>{this.nb(wb.OSg(this.$,yc.result,Sb.result))},this.ka,3)}}Object(c.a)(Tb,"ParametersTaskPaneFactory",x.a,[]);var xb=a(694),cb=a(184);class jb{nc(){return!1}executeCommand(Sb,yc){Sb=yc.command;switch(Sb){case 329273335:case 1962240939:case 296943390:case -625072140:return n.Task.Ta(!0);default:return cb.a(Sb)}}wc(Sb,yc,Fc,Zc){if(Sb=!!Zc&&2===Zc.mz)switch(yc.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:Sb=!1}return Sb}Kc(){return!1}}Object(c.a)(jb,"TaskPaneCommandHandler",null,[208]);class qa extends xb.a{constructor(Sb){super(Sb)}ld(){this.Zc([new jb])}static la(Sb){xb.a.Nd(115,new qa(Sb))}}Object(c.a)(qa,"TaskPaneCommandHandlerFactory",xb.a,[]);var za=a(1321),Na=a(173);class ua{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(ua,"TaskPaneGroupAppProps",null,[]);var Xa=a(27),ha=a(38),ta=a(213);class wa{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(wa,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var db=a(293),Jb=a(18),Pb=a(16),eb=a(127);class Ma{constructor(Sb){this.width=Sb}}Object(c.a)(Ma,"ActiveTaskPaneData",null,[]);class ob extends ha.a{constructor(Sb,yc){super();this.isVisible=!1;
this.IYd=this.zea=-1;this.lLe=40;this.oh=this.OL=this.animationManager=this.jJc=null;this.nDd=()=>{this.qYf()};this.KBc=new Set;this.KBc.add("FieldListTaskPane");this.KBc.add("PivotTableSettingsTaskPane");this.KBc.add("SlicerSettingsTaskPane");this.jb=yc;oa.a(this.$).di(this);this.jA=Sb;this.Z9a=this.qXg();P.a.fj(yc)||E.AFrameworkApplication.ta.Pa.Ve||(this.jA.style.bottom=this.$.qd&4?va.HelperMethods.uc(this.$.uea):"0");this.W$b={};this.cPb={};this.$4d={};this.FYd=eb.a.instance.$d(this.mc);this.FYd.la("focusin",
this.nDd);this.wgi()}get $(){return this.jb}get Uga(){return this.$4d}get XM(){return this.jJc}get isCollapsed(){return!this.XM}dispose(){oa.a(this.$).Zz(this);const Sb=this.W$b;for(let yc in Sb)({key:yc,value:Sb[yc]}).value();this.cPb=this.$4d=this.W$b=null;this.FYd.hD();this.Z9a=this.jA=this.FYd=null;super.dispose()}xva(Sb,yc,Fc,Zc,Rd,Ed,ne,ze,Be=ob.vxi,td=ob.uxi,Se=null,$b=null,Xc=!1){const ed=Object(t.a)(new wa,{getContent:()=>Sb});ed.isSharedRuntime=Xc;return Object(t.a)(new za.a,{hideHeader:!0,
contentProps:ed,title:yc,width:Fc,location:2,onOpen:Rd,onClose:Ed,onShow:ne,onHide:ze,iconUrl:Se,iconId:$b,enableResize:Zc,minResizeWidth:Be,maxResizeWidth:td})}Y6(Sb,yc){Na.UISurfaces.aj().then(Fc=>{Sb in this.Uga?Fc.setSelectedTaskPane(Sb):Fc.showTaskPane(Sb,yc);return null})}v6b(Sb,yc){Na.UISurfaces.aj().then(Fc=>{Fc.initializeHiddenSharedRuntimeTaskPane(Sb,yc);const Zc=this.$.domElement;Zc.addEventListener("scroll",function Ed(){0!=Zc.scrollLeft&&(Zc.scrollLeft=0,Zc.removeEventListener("scroll",
Ed))})})}updateTaskPane(Sb,yc){Na.UISurfaces.aj().then(Fc=>{Fc.updateTaskPane(Sb,yc);return null})}setSelectedTaskPane(Sb){Na.UISurfaces.aj().then(yc=>{yc.setSelectedTaskPane(Sb);return null})}hideTaskPane(Sb){Na.UISurfaces.aj().then(yc=>{yc.hideTaskPane(Sb,ob.QNj);return null})}get mc(){return this.jA}get Hf(){return this.isVisible}get de(){return S.a.HBc}kg(Sb,yc){return yc?!1:(this.o1f(),!0)}mh(Sb){return X.DOMElementExtensions.Af(this.mc,Sb)}sj(){this.$.frame.Me.vk(this.de)}dk(){}qXg(){const Sb=
document.createElement(ta.a.div);Sb.style.height="0px";Sb.style.width="0px";Sb.tabIndex=-1;return Sb}DMh(){var Sb=X.DOMElementExtensions.getElementById(this.jA,"tabStripFocusZone");if(Sb){Sb=Sb.getElementsByTagName("button");for(let yc=0;yc<Sb.length;yc++)if(Boolean.parse(Sb[yc].getAttribute("aria-selected")))return Sb[yc].getAttribute("aria-controls")}return null}d7g(Sb){return(Sb=window.getComputedStyle(Sb,null).getPropertyValue("transition-duration"))?parseInt(Sb.endsWith("ms")?parseFloat(Sb):
1E3*parseFloat(Sb),10):0}Fcj(){const Sb=document.getElementById("tabbedTaskPaneContainer");Sb&&Sb.addEventListener("transitionend",()=>this.KHa(-1))}wgi(){Na.UISurfaces.aj().then(Sb=>{let yc;Sb.renderTaskPaneGroups(null,this.jA,(yc=new ua,yc.middleContainer=this.Z9a,yc.onOpen=(Fc,Zc)=>{this.isVisible=!0;-1===this.zea&&(this.zea=this.d7g(Zc));P.a.fj(this.$)||(this.Uga[Fc]=new Ma(X.DOMElementExtensions.eQ(X.DOMElementExtensions.getElementById(Zc,ob.Qcg))))},yc.onClose=Fc=>{this.isVisible=0<Sb.selectors.getTabbedTaskPaneCount();
v.ULS.sendTraceTag(537014371,0,50,`Closing of ${Fc} TaskPane`);if(!this.isVisible)this.XYe(),P.a.fj(this.$)||E.AFrameworkApplication.ta.Pa.Ve||window.requestAnimationFrame(()=>{this.K0b(this.Z9a)});else if(!P.a.fj(this.$)&&this.XM&&this.XM!==Fc){const Zc=1<Sb.selectors.getTabbedTaskPaneCount()?this.Rdc():0,Rd=1===Sb.selectors.getTabbedTaskPaneCount()?-1*this.Rdc():0;this.Nse(Fc,this.XM,Zc,Rd)}P.a.fj(this.$)?this.KHa(this.zea):(E.AFrameworkApplication.ta.Pa.Ve&&0>=this.zea&&this.KHa(this.zea),delete this.Uga[Fc]);
delete this.cPb[Fc]},yc.onShow=(Fc,Zc)=>{null!=this.ei&&(this.ei.stop(),this.ei=null);this.jJc=Fc;this.qYf();1!==Zc&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Loj()},0)});P.a.fj(this.$)?window.requestAnimationFrame(()=>{this.KHa(this.zea)}):E.AFrameworkApplication.ta.Pa.Ve&&0>=this.zea?window.requestAnimationFrame(()=>{this.KHa(this.zea)}):window.requestAnimationFrame(()=>{this.eqj(this.Z9a,this.zea)})},yc.onHide=(Fc,Zc,Rd)=>{const Ed=this.DMh();Ed!==Fc&&(this.ei=this.$.Kb.Bc("UserAction",
"TaskPaneToggle"),v.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Fc} to ${Ed}`));Rd?P.a.fj(this.$)||this.K0b(this.Z9a):!P.a.fj(this.$)&&Ed&&(Fc=1===Object.keys(this.Uga).length?this.Rdc():0,this.Nse(this.XM,Ed,this.Rdc(),Fc));this.jJc=null;Rd&&1!==Zc&&this.XYe();P.a.fj(this.$)&&window.requestAnimationFrame(()=>{this.KHa(this.zea)})},yc.setFocusCallback=(Fc,Zc)=>{Zc&&(this.cPb[Fc]=Zc)},yc.onResizeStart=()=>{P.a.fj(this.$)||this.XXc(va.HelperMethods.uc(0))},yc.onResizeEnd=()=>{P.a.fj(this.$)?
this.KHa():(this.K0b(this.Z9a),this.Uga[this.XM]=this.yjd(this.XM));v.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.XM} TaskPane`)},yc));E.AFrameworkApplication.ta.Pa.Ve&&!P.a.fj(this.$)&&this.Fcj();return null})}K0b(Sb){this.XXc(this.$.isChromeRtl?Sb.style.left:Sb.style.right)}XXc(Sb){v.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.XM}`);this.$.ylj(Sb)}KHa(Sb=0){-1<Sb?n.Task.delay(Sb+this.lLe).continueWith(()=>{this.$.cAa(db.a.WZ("ResetContentAreaMargin"))}):
this.$.cAa(db.a.WZ("ResetContentAreaMargin"))}Nse(Sb,yc,Fc,Zc){yc=yc.endsWith(ob.GYd)?yc.substring(0,yc.length-ob.GYd.length):yc;yc=this.R8e(yc);Zc=yc+Zc;Sb=this.R8e(Sb);Zc<Sb&&this.XXc(va.HelperMethods.uc(yc+Fc))}eqj(Sb,yc){window.setTimeout(()=>{this.K0b(Sb)},yc+this.lLe)}Rdc(){return-1!==this.IYd?this.IYd:this.IYd=X.DOMElementExtensions.eQ(X.DOMElementExtensions.getElementById(this.jA,"tabStripFocusZone"))}yjd(Sb){return X.DOMElementExtensions.eQ(X.DOMElementExtensions.getElementById(X.DOMElementExtensions.getElementById(this.jA,
Sb+ob.GYd),ob.Qcg))}R8e(Sb){if(Sb in this.Uga){const yc=this.Uga[Sb].width;return 0<yc?yc:this.yjd(Sb)}return Sb?this.yjd(Sb):0}XYe(){ea.h(this.$).setFocus()}Loj(){if(this.cPb[this.XM]){const Sb=this.cPb[this.XM];Sb&&Sb(null,null)}else this.KBc.has(this.XM)||this.o1f()}o1f(){Na.UISurfaces.aj().then(Sb=>{1<Sb.selectors.getTabbedTaskPaneCount()?Sb.focusTabbedTaskPaneArea():(Sb=X.DOMElementExtensions.getElementById(this.mc,"AgaveTaskpaneCloseButtonId"))?Sb.focus():(Sb=X.DOMElementExtensions.um(this.mc.querySelectorAll("button")))&&
Sb.focus();return null})}qYf(){this.$.domElement.scrollLeft=0;Xa.a.KNa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}QE(Sb){this.addHandler(ob.chb,Sb)}lG(Sb){this.removeHandler(ob.chb,Sb)}get ZO(){return this.jA}get $B(){v.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}Gsb(Sb,yc,Fc,Zc,Rd){let Ed=Sb.Aa(yc);Ed||(Ed=Pb.a(Jb.a,Fc,Sb,yc),Ed.SetScriptLoadFlavor(Rd));
Zc&&Ed.ZWc(Zc);const ne=""+yc;let ze=null;const Be=()=>{Ed.create();ze()};this.W$b[ne]=ze=()=>{Ed.Juc(Be);delete this.W$b[ne]};Ed.Z_b(Be)}initialize(){v.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}S8f(){}zN(){v.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}oG(){v.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}sqe(){v.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}PXf(){v.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}$xb(){v.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}rfd(){v.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}cja(){v.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}lA(){v.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){v.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}RRd(){v.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(Sb){const yc=
ob.mYg(Sb.Eb,Sb.isChromeRtl,Sb);ob.USg(Sb,yc);return new ob(yc,Sb)}static mYg(Sb,yc,Fc){const Zc=document.createElement("div");Zc.id=Sb+G.a.IBc;P.a.fj(Fc)?Zc.classList.add(da.a.r2j):(Zc.classList.add(yc?da.a.t2j:da.a.s2j),E.AFrameworkApplication.ta.Pa.Ve&&Zc.classList.add(da.a.pAa));return Zc}static USg(Sb,yc){Sb.isMobileMode&&yc.setAttribute("aria-hidden","true");E.AFrameworkApplication.ta.Pa.Ve?document.getElementById("FarPaneRegion").appendChild(yc):(P.a.fj(Sb)&&yc.classList.add(da.a.Cth),document.getElementById(Sb.Eb+
G.a.X0a).insertBefore(yc,Sb.IBa))}}ob.vxi=300;ob.uxi=950;ob.QNj=2;ob.GYd="-panel";ob.Qcg="ExcelTaskPaneContentWrapper";ob.i$f="rtpSizeChanged";ob.tEe="rtpCollapsed";ob.bLf="rtpAdded";ob.chb="rtpVisibility";Object(c.a)(ob,"ReactTaskPaneManager",ha.a,[465,34,2]);var Ia=a(96),Da=a(156),nb=a(239),Ua=a(419),W=a(84),sa=a(556);class vb extends Sys.EventArgs{constructor(){super()}}Object(c.a)(vb,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var gc=a(45);const Bc=D.a.mwh,Sa=D.a.owh,na=`<span class='${da.a.Crb} ${D.a.pwh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;
class ib extends Pa.a{constructor(Sb){super(document.createElement("a"));this.Ra=new ha.a;this.htmlSanitizationHelper=this.Sle=null;this.gd=()=>{this.enabled&&this.Ra.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=Sb}FKg(Sb){this.Ra.addHandler("tpButtonClicked",Sb)}eVf(Sb){this.Ra.removeHandler("tpButtonClicked",Sb)}get p0a(){return this.domElement}get taskPane(){return this.Sle}get enabled(){return super.enabled}set enabled(Sb){Sb!==super.enabled&&(this.domElement.classList.toggle(D.a.wU),
this.domElement.classList.toggle(Sa),this.domElement.tabIndex=Sb?0:-1,super.enabled=Sb)}get Hl(){return this.domElement.firstChild.firstChild}dispose(){h.a.rc([this.Ra]);this.Ra=null;this.domElement&&gc.a.nna(this.domElement);super.dispose()}vgi(Sb){const yc=6===Sb.jh;var Fc=yc&&!Sb.Ek;Fc=String.format(na,Sb.wN,Sb.Ek,Fc?d.a.current.fo(102):d.a.me(10),D.a.xia,Fc?String.format('style="width:24px;{0}:0px"',"left"):"");Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.Ri(this.domElement,Fc):this.domElement.innerHTML=Fc;this.domElement.classList.add(Bc);this.domElement.classList.add(Sa);this.domElement.title=Sb.wN;this.domElement.tabIndex=0;X.DOMElementExtensions.Pu(this.domElement,G.a.pt,null,null);this.Sle=Sb;yc&&(Sb=this.taskPane,null===Sb||void 0===Sb?void 0:Sb.hig());B.a.instance.sa(z.a.click,this.domElement,this.gd);A.KeyInputManager.instance.Ns(this.domElement,this.gd,w.a.Mh)}}Object(c.a)(ib,"TaskPaneButton",Pa.a,[550]);class Ib extends H.a{constructor(Sb,
yc,Fc,Zc){super(Sb);this.animationManager=this.d6=this.Ee=null;this.lM=this.bWa=!1;this.c8d=0;this.jb=null;this.jNc=!1;this.htmlSanitizationHelper=null;this.Sz=()=>{this.Gni||(this.lA(),this.$.df())};this.yCd=(Rd,Ed)=>{this.onButtonClick(Rd,Ed)};this.D6=()=>{this.BDc()};this.$=yc;this.htmlSanitizationHelper=Zc;oa.a(this.$).di(this);this.$.Cb.Xf(this.D6);this.configuration=Fc;this.baseName=va.HelperMethods.Yva(this.domElement,this.configuration.Scg||this.configuration.i1);this.V$b={};this.zfb=[];this.ku=
[];this.Fqb={};this.Tle=document.getElementById(this.baseName+this.configuration.EYd);this.ZO||v.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.EYd} not found`);this.KDg=document.getElementById(this.baseName+this.configuration.i1);this.jA||v.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.i1} not found`);this.LDg=document.getElementById(this.baseName+this.configuration.LZd);
this.OL||v.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.LZd} not found`);Sb=String.format(Ib.RNj,this.baseName+this.configuration.Ceg,this.baseName+Ib.bPb);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Ri(this.OL,Sb):this.OL.innerHTML=Sb;this.q6d=document.getElementById(this.baseName+Ib.bPb);
this.ize||v.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ib.bPb} not found`);(this.Eqb=document.getElementById(this.baseName+Ib.bPb))||v.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ib.bPb} not found`);this.ftg=this.gIe(this.configuration.rEe,this.oEe);this.etg=this.yHe(this.configuration.pEe,N.a.instance.ga(1293),this.W5h,this.e1a,!0);this.$ug=this.gIe(this.configuration.hWe,this.hDh);this.Zug=this.yHe(this.configuration.fWe,
N.a.instance.ga(1292),this.X5h,this.gKa,!1);X.DOMElementExtensions.setVisible(this.gKa,!1);B.a.instance.sa(z.a.click,this.d1a,Object(W.a)(this,this.Toc,"onCollapseIconClicked"));B.a.instance.sa(z.a.click,this.fKa,Object(W.a)(this,this.jpc,"onExpandIconClicked"));B.a.instance.sa(z.a.click,this.e1a,Object(W.a)(this,this.Toc,"onCollapseIconClicked"));B.a.instance.sa(z.a.click,this.gKa,Object(W.a)(this,this.jpc,"onExpandIconClicked"));A.KeyInputManager.instance.sa(z.a.Pb,this.d1a,Object(W.a)(this,this.AAf,
"onCollapseIconKeyDown"));A.KeyInputManager.instance.sa(z.a.Pb,this.fKa,Object(W.a)(this,this.eCf,"onExpandIconKeyDown"))}QE(Sb){this.addHandler(Ib.chb,Sb);Sb(this,new vb(this.isVisible,X.DOMElementExtensions.isVisible(this.OL)))}lG(Sb){this.removeHandler(Ib.chb,Sb)}get OL(){return this.LDg}get mc(){return this.OL}get Hf(){return this.bWa}set Hf(Sb){this.bWa=Sb}get jA(){return this.KDg}get de(){return S.a.SJi}get ZO(){return this.Tle}get $B(){return this.ku}get oh(){return this.Ee}get XM(){return null}get Uga(){return null}get isCollapsed(){return this.lM}get i7c(){return this.c8d}get $(){return this.jb}set $(Sb){this.jb=
Sb}get ize(){return this.q6d}get d1a(){return this.etg}get fKa(){return this.Zug}get e1a(){return this.ftg}get gKa(){return this.$ug}get Gni(){return this.jNc}get X5h(){return this.configuration.qEe}get W5h(){return this.configuration.gWe}Gsb(Sb,yc,Fc,Zc,Rd){let Ed=Sb.Aa(yc);Ed||(Ed=Pb.a(Jb.a,Fc,Sb,yc),Ed.SetScriptLoadFlavor(Rd));Zc&&Ed.ZWc(Zc);const ne=""+yc;ne in this.V$b||Ed.w0b((td,Se)=>{this.N6(Se)});let ze=null;const Be=()=>{Ed.create();ze()};this.V$b[ne]=ze=()=>{Ed.Juc(Be);delete this.V$b[ne]};
Ed.Z_b(Be)}dispose(){if(this.ku)for(let yc=0,Fc=this.ku.length;yc<Fc;yc++)this.ku[yc].eVf(this.yCd),this.ku[yc].dispose();const Sb=this.V$b;for(let yc in Sb)({key:yc,value:Sb[yc]}).value();this.$.ea&&this.$.Cb&&this.$.Cb.Eg(this.D6);this.Eqb=this.q6d=this.Tle=this.Ee=this.Fqb=this.zfb=this.ku=null;B.a.instance.Ba(z.a.click,this.d1a,Object(W.a)(this,this.Toc,"onCollapseIconClicked"));B.a.instance.Ba(z.a.click,this.fKa,Object(W.a)(this,this.jpc,"onExpandIconClicked"));B.a.instance.Ba(z.a.click,this.e1a,
Object(W.a)(this,this.Toc,"onCollapseIconClicked"));B.a.instance.Ba(z.a.click,this.gKa,Object(W.a)(this,this.jpc,"onExpandIconClicked"));A.KeyInputManager.instance.Ba(z.a.Pb,this.d1a,Object(W.a)(this,this.AAf,"onCollapseIconKeyDown"));A.KeyInputManager.instance.Ba(z.a.Pb,this.fKa,Object(W.a)(this,this.eCf,"onExpandIconKeyDown"));super.dispose()}kg(Sb,yc){if(yc)return!1;this.Ee&&!this.isCollapsed?(Sb=this.oh.taskPane,Sb.Hf&&Sb.kg(!0,!1)||X.DOMElementExtensions.setFocus(this.oh.p0a)):X.DOMElementExtensions.setFocus(this.fKa);
return!0}mh(Sb){return this.isVisible?X.DOMElementExtensions.Af(this.domElement,Sb)||X.DOMElementExtensions.Af(this.domElement,X.DOMElementExtensions.kxb(Sb)):!1}sj(){}dk(){this.Ee&&this.Ee.taskPane.dk()}setFocusOnToolbarFirstElement(){this.isCollapsed?X.DOMElementExtensions.setFocus(this.fKa):X.DOMElementExtensions.setFocus(this.d1a)}RRd(){for(let Sb=this.ku.length-1;0<=Sb;Sb--)if(this.ku[Sb].isVisible){X.DOMElementExtensions.setFocus(this.ku[Sb].p0a);return}this.setFocusOnToolbarFirstElement()}$xb(Sb){const yc=
[];for(let Fc=this.ku.length-1;0<=Fc;Fc--)this.ku[Fc].taskPane.jh===Sb&&yc.push(this.ku[Fc].taskPane);return yc}rfd(Sb){const yc=[];for(let Fc=0;Fc<this.ku.length;Fc++)this.ku[Fc].taskPane.jh===Sb&&yc.push(this.ku[Fc]);return yc}sqe(Sb){if(Sb){let yc;const Fc=Object(m.a)(450,Sb);Fc?(yc=new ib(this.htmlSanitizationHelper),yc.domElement.id=this.baseName+"bt_"+Sb.jh.toString()+"_"+Sb.qf.InstanceId,this.Eqb.appendChild(yc.domElement),this.Fqb["6"]=yc,Fc.button=yc):yc=this.Fqb[Sb.jh.toString()];yc.vgi(Sb);
yc.FKg(this.yCd);yc.isVisible=Sb.nq();yc.enabled=Sb.Fs();this.zfb.push(Sb);this.ku.push(yc);Ib.eHi(Sb,this.ZO);this.Grh(yc);this.BDc()}}oG(Sb,yc){let Fc;for(const Zc of this.ku)Fc=Zc.taskPane,Fc.jh===Sb.jh&&Fc==Sb&&this.N3b(Zc,yc)}xva(){v.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}Y6(){v.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}v6b(){v.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){v.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){v.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){v.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}S8f(Sb,yc){Sb?(this.jNc=!0,this.JSd(!1)):
(this.jNc=!1,this.JSd(!0),yc&&(this.lA(),this.$.df()))}zN(Sb){if(!this.zfb.includes(Sb)){let Fc=null;Fc=()=>{this.Ffj(Sb);Sb.ZR(Fc)};Sb.NP(Fc);this.sqe(Sb);var yc=Object(m.a)(540,Sb);yc&&(yc.QE(this.Sz),this.Sz(yc,Sys.EventArgs.Empty));if(yc=Object(m.a)(126,Sb))yc.QE(this.Sz),this.Sz(yc,Sys.EventArgs.Empty);if(yc=Object(m.a)(489,Sb))yc.QE(this.Sz),this.Sz(yc,Sys.EventArgs.Empty);this.raiseEvent(Ib.bLf,null,Sb);this.lA()}}N3b(Sb,yc){if(Sb.taskPane.Fs()&&Sb.taskPane.nq()){if(this.Ee){this.Ee.domElement.classList.remove(Ib.Inb);
this.Ee.taskPane.isVisible=!1;if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Fc=Object(m.a)(450,this.Ee.taskPane);Fc&&Fc.wj.TLd(Fc.qf.InstanceId)}this.d6=this.Ee}this.Ee=Sb;this.Ee.taskPane.isVisible=!0;this.Ee.domElement.classList.add(Ib.Inb);yc&&this.cja(!1,!1);this.Lgb()}}onButtonClick(Sb){let yc=!1;if(this.Ee!==Sb){yc=!0;const Fc=Sb.taskPane.mc;this.animationManager.v5i(Fc);if(this.Ee){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Zc=
Object(m.a)(450,this.Ee.taskPane);Zc&&Zc.wj.TLd(Zc.qf.InstanceId)}this.Ee.taskPane.isVisible=!1;this.Ee.domElement.classList.remove(Ib.Inb)}this.d6=this.Ee;this.Ee=Sb;this.Ee.domElement.classList.add(Ib.Inb);this.Ee.taskPane.isVisible=!0;this.Lgb();this.animationManager.ZCh(Fc)}this.cja(!(this.isCollapsed||yc),!1)}Lgb(){const Sb=this.i7c;let yc=0;this.Ee&&(yc=this.Ee.taskPane.vq?this.Ee.taskPane.vq:this.Ee.taskPane.Kp);yc!==Sb&&(this.c8d=yc,this.isCollapsed||(this.animationManager&&this.Ee?this.animationManager.b1b(this.jA,
Sb,yc,this.oh.taskPane):this.jA.style.width=va.HelperMethods.uc(yc)),this.GRa(),this.raiseEvent(Ib.i$f,null,this))}VM(Sb){const yc=new ib(this.htmlSanitizationHelper);yc.isVisible=!1;yc.domElement.id=this.baseName+"bt_"+Sb.toString();this.Eqb.appendChild(yc.domElement);this.Fqb[Sb.toString()]=yc}BDc(){if(void 0!==this.ku&&null!==this.ku){void 0===this.Ee||null===this.Ee||this.Ee.taskPane.Fs()||(this.Ee.domElement.classList.remove(Ib.Inb),this.Ee.taskPane.isVisible=!1,this.Ee.taskPane.nq()&&(this.d6=
this.Ee),this.Ee=null);var Sb=null;for(let yc=0;yc<this.ku.length;yc++)if(this.zfb[yc].nq()){const Fc=this.zfb[yc].Fs();(this.ku[yc].enabled=Fc)&&!Sb&&(Sb=this.ku[yc])}void 0!==this.Ee&&null!==this.Ee||!Sb||(void 0!==this.d6&&null!==this.d6&&this.d6.taskPane.Fs()&&this.d6.taskPane.nq()?this.N3b(this.d6,!1):this.N3b(Sb,!1));void 0!==sa.a(this.$)&&null!==sa.a(this.$)&&sa.a(this.$).isVisible&&void 0!==this.Ee&&null!==this.Ee&&1!==this.Ee.taskPane.jh&&(sa.a(this.$).isVisible=!1);void 0!==this.Ee&&null!==
this.Ee&&7!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(52),null===Sb||void 0===Sb?0:Sb.isVisible)&&(Sb.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&8!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(233))&&(Sb.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&9!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(248))&&(Sb.isVisible=!1);Y.EwaSettings.ma(291)&&void 0!==this.Ee&&null!==this.Ee&&12!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(302))&&(Sb.isVisible=!1);Y.EwaSettings.ma(474)&&void 0!==this.Ee&&null!==this.Ee&&15!==
this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(365))&&(Sb.isVisible=!1);P.a.mud(this.$)&&void 0!==this.Ee&&null!==this.Ee&&13!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(334))&&(Sb.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&14!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(346))&&(Sb.isVisible=!1);void 0!==this.Ee&&null!==this.Ee&&16!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(371))&&(Sb.isVisible=!1);Y.EwaSettings.qjc()&&void 0!==this.Ee&&null!==this.Ee&&17!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(408))&&(Sb.isVisible=
!1);Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&void 0!==this.Ee&&null!==this.Ee&&18!==this.Ee.taskPane.jh&&(Sb=this.$.da.Aa(415))&&(Sb.isVisible=!1);this.Lgb()}}AFh(Sb,yc){X.DOMElementExtensions.setVisible(this.e1a,!Sb);X.DOMElementExtensions.setVisible(this.gKa,Sb);Sb&&this.raiseEvent(Ib.tEe,null,this);this.Lgb();yc&&X.DOMElementExtensions.setFocus(Sb?this.fKa:this.d1a)}Jec(Sb,yc){this.$.Xc(Sb,yc,26,null)}N6(Sb){Sb.JO&&this.zN(Sb.JO)}Ffj(Sb){if(Sb){const yc=
this.ku.length;let Fc=!1;for(let Zc=0;Zc<yc;Zc++){const Rd=this.ku[Zc];if(Rd.taskPane===Sb){this.Eqb.removeChild(Rd.p0a);delete this.Fqb[Sb.jh.toString()];Array.remove(this.zfb,Sb);Array.remove(this.ku,Rd);Rd.eVf(this.yCd);Rd.taskPane.mc.parentNode.removeChild(Rd.taskPane.mc);this.Ee&&this.Ee.taskPane===Rd.taskPane&&(this.Ee=null);this.d6&&this.d6.taskPane===Rd.taskPane&&(this.d6=null);Fc=!0;break}}Fc&&this.BDc()}}Grh(Sb){const yc=Sb.taskPane.jh,Fc=!!this.Ee&&1===this.Ee.taskPane.jh;(1===yc||!Fc&&
2===yc)&&this.N3b(Sb,!1)}static eHi(Sb,yc){const Fc=Sb.mc;Fc.parentNode&&Fc.parentNode.removeChild(Fc);yc.appendChild(Fc);Sb.isVisible=!1}yHe(Sb,yc,Fc,Zc,Rd){const Ed=document.createElement("a");Ed.setAttribute(G.a.OY,Rd?G.a.Ak:G.a.xr);Ed.setAttribute(G.a.Ld,G.a.pt);Ed.tabIndex=0;Ed.classList.add(da.a.zt);Ed.classList.add(Sb);Ed.classList.add(D.a.lwh);Sb=String.format(Ib.Q2g,yc,Fc,d.a.me(10));Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.Ri(Ed,Sb):Ed.innerHTML=Sb;Zc.appendChild(Ed);return Ed}}Ib.chb="tpVisibility";Ib.RNj=`<div id='{0}' class='${D.a.rwh}'><div id='{1}' class='${D.a.qwh}'></div></div>`;Ib.Q2g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Ib.bPb="novTaskpaneButtonGroup";Ib.Inb=D.a.nwh;Ib.i$f="tpSizeChanged";Ib.tEe="tpCollapsed";Ib.bLf="tpAdded";Object(c.a)(Ib,"TaskPaneControl",H.a,[465,34,2]);var ec=a(50),qb=a(370),Ha=a(708);class Ab{constructor(){this.gWe=this.qEe=this.fWe=this.pEe=
this.hWe=this.rEe=this.Ceg=this.LZd=this.EYd=this.i1=this.Scg=null}}Object(c.a)(Ab,"Configuration",null,[]);a(433);var Yb=a(296);class Bb extends Yb.a{constructor(Sb){super(5,Sb)}}Object(c.a)(Bb,"ResizeAnimationEvent",Yb.a,[]);var Qb=a(475),sc=a(586),kb=a(101);class Eb{constructor(Sb,yc){this.Tcg=null;this.$=yc;this.taskPane=Sb}RCh(){this.Tcg=X.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Eb+G.a.EBd);const Sb=Eb.H6c(this.taskPane),yc=Eb.H6c(this.Tcg),Fc=sc.a(kb.a.Tl);Fc.animate(Sb,
G.a.Vyc);Fc.animate(yc,G.a.Vyc)}v5i(Sb){Sb.style.opacity="0"}ZCh(Sb){sc.a(kb.a.Tl).animate(Eb.H6c(Sb),G.a.Vyc)}b1b(Sb,yc,Fc,Zc){yc||(Zc.isVisible=!0);this.$.GRa(Fc);sc.a(kb.a.Tl).animate(Eb.Yeh(Sb,yc,Fc),G.a.Vyc,null,null,()=>{this.$.GAa();Fc||1===Zc.jh||(Zc.isVisible=!1);Zc.IR(Fc<yc)})}static Yeh(Sb,yc,Fc){Sb=new Bb(Sb);Sb.YPg(yc,Fc);return Sb}static H6c(Sb){Sb=new Qb.a(Sb);Sb.JJ(0,1);return Sb}}Object(c.a)(Eb,"TaskPaneAnimationManager",null,[499]);const Gc=`<div id="{0}" class="${D.a.vwh}" runat="server"></div></div><div id="{1}" class="${D.a.uwh} ${D.a.Ao}" runat="server"></div>`,
zc=`<button type="button" id="{0}" class="${D.a.swh}"></button><span><div id="{1}" class="${D.a.twh}"></div></span>`,yb=D.a.fwh;class gb extends Ib{constructor(Sb,yc,Fc,Zc){super(Sb,Fc,gb.Pah(),Zc);this.vrc=null;this.Jtd=!1;this.yS=null;this.VUi=Rd=>{var Ed=!1;if(9===Rd.Ca.keyCode){Ed=this.oh.taskPane.VQ(Rd,this.OL);if(!Ed){Ed=this.$.da.Aa(52);var ne=this.domElement.querySelectorAll(this.oh.taskPane===Ed?Ed.Gr:qb.a.E0i);Ed=X.DOMElementExtensions.um(ne);ne=X.DOMElementExtensions.oB(ne);Ed=X.DOMElementExtensions.hBa(Rd.Ca,
Ed,ne)}return Ed}ne=Ia.FocusManager.instance().hi;if(null===ne||void 0===ne?0:ne.MN)return Ed;27===Rd.Ca.keyCode&&this.oh.taskPane.yg(!1);return Ed};this.ed=()=>{this.OL.style.bottom=this.jA.style.bottom=this.$.qd&4&&!E.AFrameworkApplication.ta.Pa.Ve?va.HelperMethods.uc(this.$.uea):"0";this.lA()};this.TGf=Rd=>{Object(Ua.a)(450,this.oh.taskPane)&&(this.oh.taskPane.YGa.firstChild.style[G.a.pointerEvents]="none");this.Jtd=!0;this.yS=this.vxb(Rd.clientPoint);Da.a.instance.sa(z.a.$f,this.domElement.ownerDocument.body,
this.nqc);Da.a.instance.sa(z.a.xe,this.domElement.ownerDocument.body,this.oqc);nb.a.instance.sa(z.a.Kj,this.domElement.ownerDocument.body,this.nqc);nb.a.instance.sa(z.a.Sf,this.domElement.ownerDocument.body,this.oqc);return!0};this.oqc=()=>{Object(Ua.a)(450,this.oh.taskPane)&&(this.oh.taskPane.YGa.firstChild.style[G.a.pointerEvents]="");this.Jtd=!1;Da.a.instance.Ba(z.a.$f,this.domElement.ownerDocument.body,this.nqc);Da.a.instance.Ba(z.a.xe,this.domElement.ownerDocument.body,this.oqc);nb.a.instance.Ba(z.a.Kj,
this.domElement.ownerDocument.body,this.nqc);nb.a.instance.Ba(z.a.Sf,this.domElement.ownerDocument.body,this.oqc);return!0};this.nqc=Rd=>{this.Jtd&&(Rd=this.vxb(Rd.clientPoint),Rd=Ha.a.jE(Rd,this.yS),this.Lte(Rd.x));return!0};this.TVi=Rd=>{void 0!==Rd.Ca&&null!==Rd.Ca&&(9===Rd.Ca.keyCode?Rd.Ca.shiftKey?(Rd=Object(Ua.a)(34,this.oh.taskPane)?this.oh.taskPane:null)&&Rd.kg(!1,!1):this.setFocusOnToolbarFirstElement():37!==Rd.Ca.keyCode&&39!==Rd.Ca.keyCode||this.Lte(37===Rd.Ca.keyCode?-20:20));return!0};
this.$.domElement.classList.add(yb);this.Rcg=yc;this.initialize();A.KeyInputManager.instance.sa(z.a.Pb,this.domElement,this.VUi);this.dPb=X.DOMElementExtensions.getElementById(yc.parentNode,this.$.Eb+G.a.$nc);this.MBc=X.DOMElementExtensions.getElementById(yc.parentNode,this.$.Eb+G.a.Lxf);this.dPb.title=N.a.instance.ga(2227);Da.a.instance.sa(z.a.vf,this.MBc,this.TGf);nb.a.instance.sa(z.a.pointerDown,this.MBc,this.TGf);A.KeyInputManager.instance.sa(z.a.Pb,this.dPb,this.TVi)}get de(){return S.a.HBc}get oEe(){return this.OL}get hDh(){return this.oEe}Lgb(){super.Lgb();
this.dPb&&(this.oh&&this.oh.taskPane.isResizable?(this.dPb.style.display="block",this.MBc.style.display="block"):(this.dPb.style.display="none",this.MBc.style.display="none"))}get xCc(){const Sb=this.OL;return Sb&&X.DOMElementExtensions.isVisible(Sb)?qb.a.xCc:0}PXf(Sb){Sb&&(this.animationManager=Sb);this.Skj();this.animationManager=Sb||new Eb(this.jA,this.$);this.animationManager.RCh()}dispose(){this.vrc&&this.vrc.lG(this.Sz);sa.a(this.$)&&sa.a(this.$).lG(this.Sz);const Sb=this.$.da.Aa(52);Sb&&Sb.lG(this.Sz);
this.$.Kl(this.ed);h.a.rc([this.vrc]);this.vrc=null;super.dispose()}initialize(){this.PXf(null);this.VM(0);this.VM(1);this.VM(2);this.VM(7);this.VM(8);this.VM(9);this.VM(10);Y.EwaSettings.ma(291)&&this.VM(12);Y.EwaSettings.ma(474)&&this.VM(15);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.VM(13):P.a.mud(this.$)&&this.VM(13);this.VM(14);this.VM(16);Y.EwaSettings.qjc()&&this.VM(17);Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.VM(18);this.lA()}lA(){var Sb=0;let yc=0;for(let Fc=this.$B.length-1;0<=Fc;Fc--){const Zc=this.$B[Fc].taskPane.nq(),Rd=this.$B[Fc].taskPane;if(this.$B[Fc].isVisible=Zc)yc++,(1!==Rd.jh&&(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Rd.jh)&&14!==Rd.jh&&16!==Rd.jh||Rd.Fs())&&Sb++}Sb=0<Sb;X.DOMElementExtensions.setVisible(this.OL,Sb);this.JSd(Sb);X.DOMElementExtensions.setVisible(this.gKa,Sb&&this.isCollapsed);X.DOMElementExtensions.setVisible(this.e1a,
Sb&&!this.isCollapsed);X.DOMElementExtensions.setVisible(this.ize,1<yc);this.BDc()}cja(Sb,yc){if(this.isCollapsed!==Sb){Sb||(this.Rcg.style.display=E.AFrameworkApplication.ta.Pa.Ve?"flex":"block");var Fc=this.i7c;this.lM=!this.isCollapsed;var Zc=Sb?Fc:0;Fc=Sb?0:Fc;this.oh&&(this.animationManager.b1b(this.jA,Zc,Fc,this.oh.taskPane),this.GRa());Sb&&(this.Rcg.style.display="none");this.AFh(Sb,yc)}}JSd(Sb){const yc=this.isVisible!==Sb;this.Hf=Sb;X.DOMElementExtensions.setVisible(this.domElement,Sb);yc&&
(E.AFrameworkApplication.ta.Pa.Ve&&X.DOMElementExtensions.toggleCssClass(this.domElement,D.a.Vvh,Sb),this.GRa(),this.raiseEvent(Ib.chb,new vb(Sb,Sb),this))}Toc(Sb){if(Sb.Gb===this.e1a&&3!==Sb.tb)return!1;this.Jec(296943390,Sb.tb);this.cja(!0,!0);return!0}jpc(Sb){if(Sb.Gb===this.gKa&&3!==Sb.tb)return!1;this.Jec(-625072140,Sb.tb);this.cja(!1,!0);return!0}AAf(Sb){return 13===Sb.Ca.keyCode?(this.Jec(296943390,Sb.tb),this.cja(!0,!0),!0):!1}eCf(Sb){return 13===Sb.Ca.keyCode?(this.Jec(-625072140,Sb.tb),
this.cja(!1,!0),!0):!1}GRa(){let Sb=0;this.$.qd&262144&&(Sb+=this.xCc,X.DOMElementExtensions.isVisible(this.jA)&&!this.isCollapsed&&(Sb+=this.i7c));this.$.GRa(Sb)}gIe(Sb,yc){const Fc=document.createElement("div");Fc.classList.add(Sb);yc.insertBefore(Fc,yc.firstChild);return Fc}Skj(){const Sb=this.domElement;let yc=document.getElementById(this.$.Eb+G.a.X0a);E.AFrameworkApplication.ta.Pa.Ve&&(yc=document.getElementById("FarPaneRegion"));Sb.parentNode&&Sb.parentNode!==yc&&Sb.parentNode.removeChild(Sb);
yc.appendChild(Sb);this.u9h()}u9h(){const Sb=this.jA,yc=this.OL,Fc=this.$.ea;Sb.style.right="0";E.AFrameworkApplication.ta.Pa.Ve||(Sb.style.marginRight=va.HelperMethods.uc(qb.a.xCc));Sb.style.bottom=this.$.qd&4&&!E.AFrameworkApplication.ta.Pa.Ve?va.HelperMethods.uc(this.$.uea):"0";this.ZO.style.bottom="0";yc.style.right="0";this.$.ll(this.ed);Fc.eI&&this.ed(null,null)}vxb(Sb){const yc=new ec.a(0,0);return Ha.a.Vs(yc,this.jA,Sb,!1)}Lte(Sb){const yc=this.jA.offsetWidth;Sb=yc-Sb;Sb<this.oh.taskPane.Kp?
Sb=this.oh.taskPane.Kp:950<Sb&&(Sb=950);this.oh.taskPane.vq=Sb;const Fc=new Eb(this.jA,this.$);Fc.b1b(this.jA,yc,Sb,this.oh.taskPane);Object(Ua.a)(450,this.oh.taskPane)||Fc.b1b(this.oh.taskPane.mc,yc,Sb,this.oh.taskPane);this.$.GRa(this.OL.offsetWidth+Sb);this.$.cAa(db.a.WZ("AnimateTaskpaneResize"))}static la(Sb,yc){let Fc=null;Sb.Kb&&(Fc=Sb.Kb.Qg("ComponentAttach","AttachTaskPanePickerControl"),Fc.start());const Zc=gb.oYg(Sb.Eb),Rd=gb.nYg(Sb.Eb,yc),Ed=gb.pYg(Sb.Eb);Zc.appendChild(Ed);Zc.appendChild(Rd);
gb.VSg(Sb,Zc);Sb=new gb(Zc,Rd,Sb,yc);Fc&&Fc.stop();return Sb}static oYg(Sb){const yc=document.createElement("div");yc.id=Sb+G.a.IBc;return yc}static nYg(Sb,yc){const Fc=document.createElement("div");Fc.id=Sb+G.a.Kxf;Fc.className=D.a.gwh;let Zc=String.format(Gc,Sb+G.a.QJi,Sb+G.a.AR);Zc+=String.format(zc,Sb+G.a.$nc,Sb+G.a.Lxf);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?yc.Ri(Fc,Zc):
Fc.innerHTML=Zc;E.AFrameworkApplication.ta.Pa.Ve&&X.DOMElementExtensions.toggleCssClass(Fc,D.a.pAa,!0);return Fc}static pYg(Sb){const yc=document.createElement("div");yc.id=Sb+G.a.EBd;yc.className=D.a.cyh;yc.style.zIndex="100";E.AFrameworkApplication.ta.Pa.Ve&&X.DOMElementExtensions.toggleCssClass(yc,D.a.pAa,!0);return yc}static VSg(Sb,yc){(E.AFrameworkApplication.ta.Pa.Ve?document.getElementById("FarPaneRegion"):document.getElementById(Sb.Eb+G.a.X0a)).appendChild(yc)}static Pah(){const Sb=new Ab;
Sb.Scg=G.a.IBc;Sb.i1=G.a.Kxf;Sb.EYd=G.a.AR;Sb.LZd=G.a.EBd;Sb.Ceg=G.a.RJi;Sb.rEe=D.a.iwh;Sb.hWe=D.a.kwh;Sb.pEe=D.a.hwh;Sb.fWe=D.a.jwh;Sb.qEe=D.a.OUe;Sb.gWe=D.a.PUe;return Sb}}Object(c.a)(gb,"TaskPanePickerControl",Ib,[]);class Kb extends x.a{constructor(Sb){super();this.$=Sb;this.Fb()}create(){if(P.a.fd(this.$))this.nb(ob.la(this.$));else if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")){const Sb=
Oa.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);y.TaskExtensions.za(Sb,()=>{this.nb(gb.la(this.$,Sb.result))},this.ka,3)}else this.nb(gb.la(this.$,null))}static la(Sb){Sb.da.Ga(50,new Kb(Sb))}}Object(c.a)(Kb,"TaskPaneManagerFactory",x.a,[]);class sd extends e.a{constructor(Sb){super(Sb);this.St=()=>{this.$.ea.XR(this.St);this.pJe()};this.$=Sb}pJe(){const Sb=this.$.da;Sb.Ga(72,new Tb(this.$));Sb.Ga(77,new ba(this.$));Kb.la(this.$);qa.la(this.$)}static main(){f.a.Fa(Sb=>{b.a.Cdf(Sb.domElement.ownerDocument,
d.a.current.fo(97),()=>{Sb.EI()});const yc=new sd(Sb);Sb.ea.Fv?yc.pJe():Sb.ea.RT(yc.St)})}}Object(c.a)(sd,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");sd.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/dc47f647c331ce0d74954d13978e7b34/EwaDSEsNext.tp.js.map