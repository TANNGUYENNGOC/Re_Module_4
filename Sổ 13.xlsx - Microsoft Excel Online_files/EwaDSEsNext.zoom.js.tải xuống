'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1131:function(u,F,a){a.d(F,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1452:function(u,F,a){a.r(F);var c=a(9);u=a(0);var b=a(694),e=a(15),f=a(826),d=a(8),h=a(76),n=a(184),m=a(375),x=a(34),r=a(55);class y{constructor(N){this.$=N}nc(){return!1}executeCommand(N,ea,Ca){let la=!1;N=ea.command;const Ra=x.a(this.$);11!==ea.af&&7!==ea.af&&6!==ea.af&&2!==ea.af&&14!==ea.af&&15!==ea.af&&16!==ea.af&&e.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${ea.af}`);const lb=6===ea.af;switch(ea.command){case -1365094462:case -1441674458:Ra.LFc(Math.floor(10*
Ra.zoom)/10+.1,lb);la=!0;break;case 1056010365:case 1664364901:Ra.LFc(Math.ceil(10*Ra.zoom)/10-.1,lb);la=!0;break;case 346087880:Ra.LFc(d.a.f0,lb);la=!0;break;case -1918142559:case 1517993347:h.a.Jc in Ca?(Ca=parseFloat(Ca[h.a.Jc]),Ca!==Ra.zoom&&Ra.KFc(Ca,1517993347===ea.command),la=!0):e.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:ea=parseFloat(Ca[f.a.Value]);isNaN(ea)||Ra.KFc(ea/100,!0);la=!0;break;case 1409187195:Ra.zoomFitToScreen();
la=!0;break;case -1836771825:Ra.zoomFitToScreenUndo(),la=!0}return la?r.Task.Ta(!0):n.a(N)}wc(N,ea){switch(ea.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return x.a(this.$).MX();case -1365094462:case 1056010365:case -2096586688:return m.a(this.$);default:return!1}}Kc(){return!1}}Object(u.a)(y,"ZoomCommandHandler",null,[208]);class t extends b.a{constructor(N){super(N)}ld(){this.Zc([new y(this.$)])}static la(N){b.a.Nd(370,
new t(N))}}Object(u.a)(t,"ZoomCommandHandlerFactory",b.a,[]);F=a(222);var v=a(89),w=a(27),C=a(82),B=a(545),z=a(50),A=a(5),E=a(161),I=a(66),L=a(293),V=a(132),T=a(40),H=a(33),D=a(12),G=a(11),J=a(104),M=a(21),Q=a(309),U=a(133);class Z{constructor(N){this.F6a=this.wgc=0;this.H3b=null;this.wif=!1;this.$=N;this.wif=N.ukc}rni(){return M.h(this.$).eb?(e.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.rb.uy?(e.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}gQi(N){this.H3b=new Sys.UI.Point(Math.round(N.zva.center.x),Math.round(N.zva.center.y));this.wgc=x.a(this.$).zoom;this.F6a=N.zva.scale;let ea={["InitialZoom"]:this.wgc,["Location"]:"canvas",["InputMethod"]:N.tb};U.b(this.$).ud(V.a.D2i,ea);e.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.H3b.x},${this.H3b.y}), initial zoom ${this.wgc}, initial scale ${this.F6a}`);
this.N9a(N,"onGestureStart");return!0}fQi(N){if(!this.F6a)return e.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.N9a(N,"OnGestureEvent"),!0;if(!isFinite(this.F6a))return e.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.F6a}`),this.N9a(N,"OnGestureEvent"),!0;const ea=N.zva.scale/this.F6a*this.wgc;x.a(this.$).Umg(ea,this.H3b);e.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ea}. Current scale ${N.zva.scale}`);this.N9a(N,"OnGestureEvent");return!0}eQi(N){x.a(this.$).Vmg();e.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.N9a(N,"OnGestureEnd")}dQi(N){e.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.N9a(N,"OnGestureCancel")}N9a(N,ea){var Ca,la,Ra;this.wif&&(e.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ea},        eventArgs non-null: ${isNullOrUndefined(N)}, gestureData non-null: ${isNullOrUndefined(null===
N||void 0===N?void 0:N.zva)},        srcEvent non-null: ${isNullOrUndefined(null===(Ca=null===N||void 0===N?void 0:N.zva)||void 0===Ca?void 0:Ca.srcEvent)}`),null===(Ra=null===(la=null===N||void 0===N?void 0:N.zva)||void 0===la?void 0:la.srcEvent)||void 0===Ra?void 0:Ra.preventDefault())}}Object(u.a)(Z,"PinchToZoomAdapter",null,[539]);var P=a(38);class S extends P.a{constructor(){super()}yse(N){this.addHandler("ZCIEK",N)}nWf(N){this.removeHandler("ZCIEK",N)}xse(N){this.addHandler("ZCUIK",N)}mWf(N){this.removeHandler("ZCUIK",
N)}iOg(N){this.addHandler("ZCEK",N)}Yij(N){this.removeHandler("ZCEK",N)}W9i(){this.raiseEvent("ZCIEK")}V9i(){this.raiseEvent("ZCUIK")}X9i(){this.raiseEvent("ZCEK")}}Object(u.a)(S,"ZoomEventManager",P.a,[538]);var ja=a(22);class X extends P.a{constructor(N){super();this.statusBarManager=null;this.EZe=!1;this.$=N;this.$.da.$a(29,ea=>{this.statusBarManager=ea;ea.HJ(this)})}Jq(N){this.addHandler("Zoom",N)}dr(N){this.removeHandler("Zoom",N)}Pz(){this.Fn("QueryZoomStatus")&&this.raiseEvent("Zoom")}ps(N,
ea){return"QueryZoomStatus"!==N?!1:this.K8h(ea)}Fn(){return x.a(this.$).MX()}dispose(){this.statusBarManager&&(this.statusBarManager.jG(this),this.statusBarManager=null);this.$=null;super.dispose()}U8e(N){N=this.j5h(N);if(!N)return null;N=N.getElementsByClassName("cui-ctl-mediumlabel");return 1!==N.length?(e.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):N[0]}K8h(N){if(!this.$)return!1;const ea=x.a(this.$).NRb,Ca=this.U8e("HandleQueryZoomStatusCommand");
Ca?ja.a.equals(N.LabelText.toString(),ea,!1)||(Ca.innerText="",this.u4f(N,ea)):this.u4f(N,ea);return!0}u4f(N,ea){N.LabelText=ea}j5h(N){var ea=D.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ea)return ea=(ea=this.$.ea.dc)?ea.inEmbedView:!1,w.a.Dp||ea||e.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${N}`),null;this.EZe||(this.EZe=!0,e.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${N}`));
return ea}}Object(u.a)(X,"ZoomStatusBarManager",P.a,[2,281,185]);class Y extends B.a{constructor(N){super(N);this.zoomEventManager=this.aya=this.bDb=null;this.gDb=-1;this.tif=!1;this.Pc=()=>{this.gDb=-1};e.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.khb=new X(N);this.E2i()&&(e.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.DSg());this.fej()}dispose(){this.khb&&(v.a.Ia(this.khb),this.khb=null);this.zoomEventManager&&(this.$.da.GU(419),
this.zoomEventManager=null);this.tif&&this.glh();super.dispose()}MX(){return!0}Umg(N,ea){N=this.kva(N);if(M.h(this.$).rtl){const Ca=Math.round(D.DOMElementExtensions.getBounds(this.$.wf).width*x.a(this.$).zoom);this.bDb=new Sys.UI.Point(Ca-ea.x,ea.y)}else this.bDb=ea;this.jBa(N,!1,"ZoomWithPinch")}JFc(){return!0}IFc(N,ea){var Ca=w.a.isMac?.07:.15;N=this.zoom+(N?Ca:-Ca);N=this.kva(N);M.h(this.$).rtl?(Ca=Math.round(D.DOMElementExtensions.getBounds(this.$.wf).width*x.a(this.$).zoom),this.aya=new Sys.UI.Point(Ca-
ea.x,ea.y)):this.aya=ea;ea=this.zoom;this.jBa(N,!0,"ZoomWithMouse");ea={["InitialZoom"]:ea,["FinalZoom"]:N,["Location"]:"canvas"};U.b(this.$).ud(V.a.h4j,ea)}Vmg(){this.bDb=null}KFc(N,ea){this.jBa(this.kva(N),!1,ea?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Wmg(N){isNaN(N)?e.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.jBa(this.kva(N),!1,"ZoomToLevelInExcelLive")}Xmg(N){this.jBa(this.kva(N),!1,"ZoomWithActionPen")}LFc(N,
ea){this.jBa(this.kva(N),!0,ea?"ZoomWithShortcuts":"ZoomWithButtons")}P6e(N,ea){const Ca=M.h(this.$).rtl,[la,Ra]=this.aid(Ca),[lb,Aa]=this.akd(N,Ra);return this.aya?(N=this.Jhd(this.aya,N,ea,Ra,la,"ZoomWithMouse"),this.aya=null,N):this.bDb?this.Jhd(this.bDb,N,ea,Ra,la,"ZoomWithPinch"):M.h(this.$).ha.Sa.s_?this.g4j(N,ea,Ra,la,lb,Aa,M.h(this.$).rtl):this.i4j(N,ea,Ra,la,lb,Aa,M.h(this.$).rtl)}U0f(N,ea,Ca){if(N){e.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${N.x} ${N.y}) (new top-left) from zoom:${ea} to zoom:${Ca}`);
N=new z.a(N.x,N.y);Ca=M.h(this.$).rtl;[,Ca]=this.aid(Ca);const [la,Ra]=this.akd(ea,Ca);M.h(this.$).$se(N,la,Ra,"ApplicationZoom")}else e.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ea} to zoom:${Ca}`)}zoomFitToScreen(){const N=this.zoom;var ea=M.h(this.$).rtl;const [Ca,la]=this.aid(ea),[Ra,lb]=this.akd(N,la);var Aa=M.h(this.$).ha.Sa.s_;(ea=Aa?this.T2e(this.Fab,Ra,lb,!1):this.Y6e(this.Fab,la,Ca,Ra,lb,ea,!1))?(ea=Math.min(Ra/(ea.width+100),lb/(ea.height+100)),ea=this.jHh(ea),this.jBa(ea,
!0,"ZoomWithFitToScreen"),Aa?M.h(this.$).ha.Sa.gta(M.h(this.$).ha.Sa.$b,!1):(Aa=T.v(M.h(this.$).ha.ra.activeRange,this.$),M.h(this.$).gg(Aa,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.gDb=N,this.tif||this.ASg()):e.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${Aa}`)}zoomFitToScreenUndo(){this.jBa(this.gDb,!1,"ZoomWithFitToScreen")}JUd(){return-1!==this.gDb}ASg(){const N=M.h(this.$);N&&(N.ha.hH(this.Pc),N.FC(this.Pc))}glh(){const N=
M.h(this.$);N&&(N.ha.kG(this.Pc),N.bE(this.Pc))}jHh(N){N=Math.min(N,d.a.qFi);N=Math.max(N,d.a.lGi);return Math.round(100*N)/100}jBa(N,ea,Ca){if(this.GFc()){var la=M.h(this.$).view.visibleArea.toString();N=this.kva(N);var Ra=I.d(this.$.xa.oa);Ra||(Ra=B.a.oxf);M.h(this.$).Eh.d1(5,Q.a.FFc,Ca);M.h(this.$).Eh.Yla(Q.a.FFc,this.$.ea.ze);e.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${N} to sheet ${Ra} origin ${Ca} prevZoom ${this.zoom}`);this.Azj(Ra,N);this.zoomEventManager.X9i();
this.XRj(Ca);this.hSj(ea);this.gDb=-1;m.b(this.$,Ca);N=M.h(this.$).view.visibleArea.toString();e.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${la}, NewGridVisibleArea: ${N}, IsShyRibbonActive: ${this.$.D_}`)}}yQh(N){return(N=G.HelperMethods.sD(this.$.wf,this.$.domElement,N))?N:new Sys.UI.Point(0,0)}aid(N){const ea=this.yQh(N);N=this.hVh(ea,N);return[ea,N]}akd(N,ea){const Ca=D.DOMElementExtensions.getBounds(this.$.wf);return[Math.round((Ca.width-ea.x)*N),Math.round((Ca.height-
ea.y)*N)]}hVh(N,ea){ea=G.HelperMethods.sD(M.h(this.$).domElement,this.$.domElement,ea);return ea?(N=new Sys.UI.Point(Math.round(ea.x-N.x),Math.round(ea.y-N.y)),N):new Sys.UI.Point(0,0)}i4j(N,ea,Ca,la,Ra,lb,Aa){return(Aa=this.Y6e(N,Ca,la,Ra,lb,Aa))?this.P5e(Aa,N,ea,Ca,la,Ra,lb):null}Y6e(N,ea,Ca,la,Ra,lb,Aa=!0){var da=T.F(M.h(this.$).ha.ra.selectedRanges);if(Aa&&(da=da.Ie(T.F(M.h(this.$).dec())),!da))return e.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;const aa=M.h(this.$).Sb(da.topLeft);da=M.h(this.$).Sb(da.bottomRight);if(!aa||!da)return e.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;N=aa.cell.$Q===da.cell.$Q&&aa.cell.ZQ===da.cell.ZQ?this.pPh(N,da,ea,Ca,la,lb):this.Y3h(N,aa,da,ea,Ca,la,lb);return N?Aa?this.yYe(N,la,Ra):N:(e.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}yYe(N,ea,
Ca){if(0>N.x||N.x>ea)N.x=0;if(0>N.y||N.y>Ca)N.y=0;N.x+N.width>ea&&(N.width=ea-N.x);N.y+N.height>Ca&&(N.height=Ca-N.y);return N}Y3h(N,ea,Ca,la,Ra,lb,Aa){ea=M.h(this.$).getCellBounds(ea.cell);if(!ea)return null;const da=M.h(this.$).getCellBounds(Ca.cell);if(!da)return null;let aa=Ra.x;Aa&&(aa=0,ea.x=Math.round(lb/N)-ea.x-Math.round(ea.width),da.x=Math.round(lb/N)-da.x-Math.round(da.width));N=new Sys.UI.Bounds(Math.round((ea.x-la.x)*N)-aa,Math.round((ea.y-la.y)*N-Ra.y),Math.round((da.x+da.width-ea.x)*
N),Math.round((da.y+da.height-ea.y)*N));Ca=Ca.cell.getRange();e.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Ca.top}, b:${Ca.bottom}, r:${Ca.right}, l:${Ca.left}) in bounds (${N.x}, ${N.y}, ${N.width}, ${N.height})`);return N}pPh(N,ea,Ca,la,Ra,lb){const Aa=M.h(this.$).getCellBounds(ea.cell);if(!Aa)return null;let da=la.x;lb&&(da=0,Aa.x=Math.round(Ra/N)-Aa.x-Math.round(Aa.width));N=new Sys.UI.Bounds(Math.round((Aa.x-
Ca.x)*N)-da,Math.round((Aa.y-Ca.y)*N-la.y),Math.round(Aa.width*N),Math.round(Aa.height*N));ea=ea.cell.getRange();e.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ea.top}, l:${ea.left}) in bounds (${N.x}, ${N.y}, ${N.width}, ${N.height})`);return N}g4j(N,ea,Ca,la,Ra,lb){const Aa=this.T2e(N,Ra,lb);return Aa?this.P5e(Aa,N,ea,Ca,la,Ra,lb):null}P5e(N,ea,Ca,la,Ra,lb,Aa){N=new Sys.UI.Point(this.s6e(lb,N.x,N.width),this.s6e(Aa,N.y,N.height));
return this.Jhd(N,ea,Ca,la,Ra)}s6e(N,ea,Ca){return N===Ca?(e.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),N/2):N*ea/(N-Ca)}T2e(N,ea,Ca,la=!0){const Ra=M.h(this.$).ha.Sa.$b.domElement;var lb=G.HelperMethods.sD(Ra,M.h(this.$).domElement,M.h(this.$).rtl);if(!lb)return e.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const Aa=M.h(this.$).cyb();
lb=new Sys.UI.Point(Math.round((lb.x-Aa.topLeft.x)*N),Math.round((lb.y-Aa.topLeft.y)*N));N=new Sys.UI.Bounds(lb.x,lb.y,Math.round(Ra.offsetWidth*N),Math.round(Ra.offsetHeight*N));return la?this.yYe(N,ea,Ca):N}Jxf(){this.khb.Pz()}NJi(N){"ZoomToLevelInExcelLive"===N?this.zoomEventManager.W9i():this.zoomEventManager.V9i()}fej(){this.zoomEventManager=this.$.da.Ga(419,new S)}Jhd(N,ea,Ca,la,Ra,lb=""){var Aa=M.h(this.$).rtl?0:Ra.x;Ra="ZoomWithPinch"===lb||"ZoomWithMouse"===lb?new Sys.UI.Point(N.x-Aa-Math.round(la.x*
ea),N.y-Ra.y-Math.round(la.y*ea)):N;Ra=new Sys.UI.Point(Math.round(Ra.x/ea),Math.round(Ra.y/ea));e.ULS.shipAssertTag(537149770,0,!!ea,"Original zoom level must be different than 0");Aa=Ca/ea;Ra=new Sys.UI.Point(Math.round(Ra.x*(1-1/Aa)),Math.round(Ra.y*(1-1/Aa)));"ZoomWithMouse"===lb||"ZoomWithPinch"===lb?(Ra.x+=Math.round((la.x-M.h(this.$).Or)*(Aa-1)),Ra.y+=Math.round((la.y-M.h(this.$).UJ)*(Aa-1))):(Aa=Math.round(la.x*(Ca-ea)),0<Aa&&Ra.x>Aa&&(Ra.x+=Aa),ea=Math.round(la.y*(Ca-ea)),0<ea&&Ra.y>ea&&
(Ra.y+=ea));"ZoomWithMouse"===lb&&(N.x||(Ra.x=0),N.y||(Ra.y=0));N=M.h(this.$).cyb();return new Sys.UI.Point(Ra.x+N.topLeft.x,Ra.y+N.topLeft.y)}DSg(){const N=[];C.a.instance.Ub("Common.IGestureInputManager").execute(ea=>{0===ea.GUh()&&ea.Jcj(document.body,new Z(this.$),N)})}E2i(){return this.GFc()&&(w.a.Bp&&w.a.gxa(67)||this.$.ukc)}Azj(N,ea){m.a(this.$)?this.setZoomLevel(N,ea,this.C3d,d.a.NNf):this.setZoomLevel(N,ea,this.zoomPerSheetId,this.Fab)}setZoomLevel(N,ea,Ca,la){Ca.remove(N);ea!==la&&Ca.add(N,
ea)}XRj(N){this.j5f();this.$.cAa(L.a.WZ("TriggerImmediateZoomOperations"));this.i_j();this.NJi(N)}i_j(){this.gri()?this.$.df():this.khb.Pz();const N=this.khb.U8e("UpdateZoomStatusBar");N&&(N.innerText=this.NRb)}gri(){const N=E.a(this.$);return N?N.Em.dA===(H.a.Hxa(this.$)?A.a.xtc:this.$.Eb+A.a.xZf):!1}hSj(N){M.h(this.$).f4j(N);this.SOg()}SOg(){const N=J.a(this.$);if(N)for(const ea of M.h(this.$).Da.rD()){if(!ea){e.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");
continue}if(!ea.Pk)continue;const Ca=ea.Li;if(Ca)for(let la=0;la<Ca.count;la++)if(2===Ca.eg(la).type){const Ra=N.Qq(Ca.eg(la).Ng());Ra?(Ra.Rea(!1),e.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):e.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else e.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(u.a)(Y,
"ZoomManager",B.a,[]);class va extends F.a{constructor(N){super();this.$=N;this.Fb()}create(){const N=new Y(this.$);this.k_j(N);this.$.da.Ga(368,N);this.nb(N)}k_j(N){const ea=x.a(this.$);if(ea){var Ca=ea.fkd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");N.TSd(Ca);N.Mwc(ea.sDc)}else e.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(N){N.da.Ga(369,
new va(N))}}Object(u.a)(va,"ZoomManagerFactory",F.a,[]);a=a(1131);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(N=>{va.la(N);t.la(N)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/f7584874ded917171039774b2e072087/EwaDSEsNext.zoom.js.map