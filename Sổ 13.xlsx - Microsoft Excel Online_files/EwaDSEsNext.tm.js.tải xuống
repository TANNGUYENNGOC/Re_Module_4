'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{1283:function(u,F,a){a.r(F);u=a(0);var c=a(15),b=a(98),e=a(78),f=a(11),d=a(222);class h extends d.a{constructor(r){super();this.$=r;this.Fb()}create(){const {RenderingFidelityTracker:r}=a(1283);let y=this.$.da.Aa(462);y||(y=this.$.da.Ga(462,new r));this.nb(y)}}Object(u.a)(h,"RenderingFidelityTrackerFactory",d.a,[]);var n=a(42),m=a(1);a.d(F,"RenderingFidelityTracker",function(){return x});class x extends e.a{constructor(){super();
this.oGi=3E4;this.Wfb={};this.A2d={};this.Uxe={};b.Health.instance.addQosPillar("Fidelity")}static la(r){r.da.Ga(463,new h(r))}QPg(r,y,t,v){if(!(n.PageLoadTrackingInfo.instance.gwa(new Date)<this.oGi)){var w=f.HelperMethods.t6(()=>{var C=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(y),B=Object.keys(C),z=this.Uxe[r];for(var A=0;A<B.length;A++){var E=B[A];this.A2d[E]||(null===z||void 0===z?0:z[E])&&this.Wfb[E]&&(this.Wfb[E]-=z[E])}this.Uxe[r]=C;A=m.EwaSettings.isChangeGateEnabled("OfficeVSO:7190709_ThickAndMediumBorder");
for(E=0;E<B.length;E++){z=B[E];if(this.A2d[z])continue;let I=C[z];this.Wfb[z]&&(I+=this.Wfb[z]);if(gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(z,I)){this.A2d[z]=!0;C=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(z);B=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(z);A=A?!("ThickBorder"===z||"MediumBorder"===z):!0;C&&B&&A&&b.Health.instance.recordQosError(C,[B],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+
z+", isHC:"+t+", scaleFactor:"+v+"}");break}else this.Wfb[z]=I}});1<w&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${w}`)}}}Object(u.a)(x,"RenderingFidelityTracker",e.a,[456,2])},1426:function(u,F,a){function c(xa){var Ba=xa.replace(/-.*/g,()=>"");Ba=sc.get(Ba);return null!==Ba&&void 0!==Ba?Ba:xa.startsWith("ooux")?"ooux":"other"}a.r(F);var b=a(0),e=a(15);class f{constructor(){this.WinOrientation=
this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=
this.NavUserAgent=this.NavPlugins=null}}Object(b.a)(f,"BrowserInfo",null,[]);class d{constructor(){this.Version=this.Name=null}}Object(b.a)(d,"PluginInfo",null,[]);var h=a(4),n=a(27);class m{static vAi(){if(h.AFrameworkApplication.fa.qa("LogBrowserInfoIsEnabled")){var xa=m.iKh();try{const Ba=JSON.stringify(xa);e.ULS.sendTraceTag(6903563,102,50,Ba)}catch(Ba){e.ULS.sendTraceTag(6903564,102,15,Ba.message)}}else e.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static sZh(){const xa=
window.navigator.plugins;if(!xa||!xa.length)return null;const Ba=[];for(let pc=0;pc<xa.length;pc++){const nd=xa[pc].name,Ld=xa[pc].version;Array.add(Ba,Object.assign(new d,{Name:nd,Version:Ld}))}return Ba}static iKh(){const xa=new f,Ba=new Sys.StringBuilder;m.Jt(pc=>{xa.DocElemClientHeight=pc},()=>document.documentElement.clientHeight,Ba);m.Jt(pc=>{xa.DocElemClientWidth=pc},()=>document.documentElement.clientWidth,Ba);m.Jt(pc=>{xa.DocElemOffsetHeight=pc},()=>document.documentElement.offsetHeight,
Ba);m.Jt(pc=>{xa.DocElemOffsetWidth=pc},()=>document.documentElement.offsetWidth,Ba);m.Jt(pc=>{xa.ScreenAvailHeight=pc},()=>window.screen.availHeight,Ba);m.Jt(pc=>{xa.ScreenAvailWidth=pc},()=>window.screen.availWidth,Ba);m.Jt(pc=>{xa.ScreenWidth=pc},()=>window.screen.width,Ba);m.Jt(pc=>{xa.ScreenHeight=pc},()=>window.screen.height,Ba);m.Jt(pc=>{xa.ScreenLogicalXdpi=pc},()=>window.screen.logicalXDPI,Ba);m.Jt(pc=>{xa.ScreenLogicalYdpi=pc},()=>window.screen.logicalYDPI,Ba);m.Jt(pc=>{xa.ScreenDeviceXdpi=
pc},()=>window.screen.deviceXDPI,Ba);m.Jt(pc=>{xa.ScreenDeviceYdpi=pc},()=>window.screen.deviceYDPI,Ba);m.Jt(pc=>{xa.WinInnerHeight=pc},()=>window.self.innerHeight,Ba);m.Jt(pc=>{xa.WinInnerWidth=pc},()=>window.self.innerWidth,Ba);m.Jt(pc=>{xa.WinOuterHeight=pc},()=>window.self.outerHeight,Ba);m.Jt(pc=>{xa.WinOuterWidth=pc},()=>window.self.outerWidth,Ba);m.Jt(pc=>{xa.WinOrientation=pc},()=>window.self.orientation,Ba);m.Jt(pc=>{xa.WinDevicePixelRatio=pc},()=>window.self.devicePixelRatio,Ba);m.Jt(pc=>
{xa.SupportsTouch=pc},()=>n.a.rBc,Ba);m.Jt(pc=>{xa.NavAppName=pc},()=>window.navigator.appName,Ba);m.Jt(pc=>{xa.NavAppVersion=pc},()=>window.navigator.appVersion,Ba);m.Jt(pc=>{xa.NavLanguage=pc},()=>window.navigator.browserLanguage||window.navigator.language,Ba);m.Jt(pc=>{xa.NavUserAgent=pc},()=>window.navigator.userAgent,Ba);m.Jt(pc=>{xa.NavPlatform=pc},()=>window.navigator.platform,Ba);m.Jt(pc=>{xa.NavPlugins=pc},m.sZh,Ba);m.Jt(pc=>{xa.CalculatedDevicePixelRatio=pc},()=>m.devicePixelRatio,Ba);xa.Error=
Ba.toString();return xa}static get devicePixelRatio(){const xa=window.devicePixelRatio;return isNaN(xa)?window.screen.deviceXDPI/window.screen.logicalXDPI:xa}static Jt(xa,Ba,pc){try{const nd=Ba();xa(nd)}catch(nd){pc.isEmpty()||pc.append(" | "),pc.append(nd.message||"null")}}}Object(b.a)(m,"BrowserInfoLogger",null,[]);var x=a(248);class r{get name(){return"Common.App.BrowserInfoLogger"}Xh(){}init(){m.vAi()}dispose(){}static main(){x.a.instance.Ei(new r)}}Object(b.a)(r,"BrowserInfoLoggerPackage",null,
[3,4]);var y=a(80);class t{constructor(xa){this.QGc=xa}Lhf(xa){if(!this.QGc)return!0;xa=y.a.dhd(xa);if(!xa)return!1;xa=xa.toLowerCase();for(let Ba=0;Ba<this.QGc.length;Ba++)if(xa.endsWith(this.QGc[Ba]))return!0;return!1}}Object(b.a)(t,"DomainAllowListManager",null,[]);class v{constructor(xa,Ba){this.haa=null;this.tUc=xa;this.url=Ba}get J1d(){return y.a.Gda(this.url)}get $t(){return this.tUc}AZd(){const xa={},Ba=this.$t;xa.a=this.J1d;xa.b=this.round(Ba.navigationStart);xa.c=this.round(Ba.unloadEventStart);
xa.d=this.round(Ba.unloadEventEnd);xa.e=this.round(Ba.redirectStart);xa.f=this.round(Ba.redirectEnd);xa.g=this.round(Ba.fetchStart);xa.h=this.round(Ba.domainLookupStart);xa.i=this.round(Ba.domainLookupEnd);xa.j=this.round(Ba.connectStart);xa.k=this.round(Ba.connectEnd);xa.l=void 0!==Ba.secureConnectionStart&&null!==Ba.secureConnectionStart?this.round(Ba.secureConnectionStart):0;xa.m=this.round(Ba.requestStart);xa.n=this.round(Ba.responseStart);xa.o=this.round(Ba.responseEnd);xa.q=this.round(Ba.domInteractive);
xa.r=this.round(Ba.domContentLoadedEventStart);xa.s=this.round(Ba.domContentLoadedEventEnd);xa.t=this.round(Ba.domComplete);xa.u=this.round(Ba.loadEventStart);xa.v=this.round(Ba.loadEventEnd);xa.w=this.haa;return xa}round(xa){return Math.round(1E3*xa)/1E3}}Object(b.a)(v,"PerformanceTimingEntry",null,[]);const w=(xa,Ba)=>{const pc={};let nd=null;switch(xa){case 0:nd="ResourceTiming";xa=Ba.a;null!=xa&&(pc.Url=xa);xa=Ba.b;null!=xa&&(pc.InitiatorType=xa);xa=null==Ba.c?null:Ba.c.toString();null!=xa&&(pc.RedirectStart=
xa);xa=null==Ba.d?null:Ba.d.toString();null!=xa&&(pc.RedirectEnd=xa);xa=null==Ba.e?null:Ba.e.toString();null!=xa&&(pc.FetchStart=xa);xa=null==Ba.f?null:Ba.f.toString();null!=xa&&(pc.DomainLookupStart=xa);xa=null==Ba.g?null:Ba.g.toString();null!=xa&&(pc.DomainLookupEnd=xa);xa=null==Ba.h?null:Ba.h.toString();null!=xa&&(pc.ConnectStart=xa);xa=null==Ba.i?null:Ba.i.toString();null!=xa&&(pc.ConnectEnd=xa);xa=null==Ba.j?null:Ba.j.toString();null!=xa&&(pc.SecureConnectionStart=xa);xa=null==Ba.k?null:Ba.k.toString();
null!=xa&&(pc.RequestStart=xa);xa=null==Ba.l?null:Ba.l.toString();null!=xa&&(pc.ResponseStart=xa);xa=null==Ba.m?null:Ba.m.toString();null!=xa&&(pc.ResponseEnd=xa);xa=Ba.n;null!=xa&&(pc.CustomText=xa);xa=null==Ba.o?null:Ba.o.toString();null!=xa&&(pc.DecodedBodySize=xa);xa=null==Ba.p?null:Ba.p.toString();null!=xa&&(pc.EncodedBodySize=xa);Ba=null==Ba.q?null:Ba.q.toString();null!=Ba&&(pc.TransferSize=Ba);break;case 1:nd="PerformanceTiming",xa=Ba.a,null!=xa&&(pc.Url=xa),xa=null==Ba.b?null:Ba.b.toString(),
null!=xa&&(pc.NavigationStart=xa),xa=null==Ba.c?null:Ba.c.toString(),null!=xa&&(pc.UnloadEventStart=xa),xa=null==Ba.d?null:Ba.d.toString(),null!=xa&&(pc.UnloadEventEnd=xa),xa=null==Ba.e?null:Ba.e.toString(),null!=xa&&(pc.RedirectStart=xa),xa=null==Ba.f?null:Ba.f.toString(),null!=xa&&(pc.RedirectEnd=xa),xa=null==Ba.g?null:Ba.g.toString(),null!=xa&&(pc.FetchStart=xa),xa=null==Ba.h?null:Ba.h.toString(),null!=xa&&(pc.DomainLookupStart=xa),xa=null==Ba.i?null:Ba.i.toString(),null!=xa&&(pc.DomainLookupEnd=
xa),xa=null==Ba.j?null:Ba.j.toString(),null!=xa&&(pc.ConnectStart=xa),xa=null==Ba.k?null:Ba.k.toString(),null!=xa&&(pc.ConnectEnd=xa),xa=null==Ba.l?null:Ba.l.toString(),null!=xa&&(pc.SecureConnectionStart=xa),xa=null==Ba.m?null:Ba.m.toString(),null!=xa&&(pc.RequestStart=xa),xa=null==Ba.n?null:Ba.n.toString(),null!=xa&&(pc.ResponseStart=xa),xa=null==Ba.o?null:Ba.o.toString(),null!=xa&&(pc.ResponseEnd=xa),xa=null==Ba.p?null:Ba.p.toString(),null!=xa&&(pc.DomLoading=xa),xa=null==Ba.q?null:Ba.q.toString(),
null!=xa&&(pc.DomInteractive=xa),xa=null==Ba.r?null:Ba.r.toString(),null!=xa&&(pc.DomContentLoadedEventStart=xa),xa=null==Ba.s?null:Ba.s.toString(),null!=xa&&(pc.DomContentLoadedEventEnd=xa),xa=null==Ba.t?null:Ba.t.toString(),null!=xa&&(pc.DomComplete=xa),xa=null==Ba.u?null:Ba.u.toString(),null!=xa&&(pc.LoadEventStart=xa),xa=null==Ba.v?null:Ba.v.toString(),null!=xa&&(pc.LoadEventEnd=xa),Ba=Ba.w,null!=Ba&&(pc.CustomText=Ba)}pc.Table=nd;return Sys.Serialization.JavaScriptSerializer.serialize(pc)};var C=
a(53),B=a(218),z=a(323);class A{constructor(xa,Ba=null,pc=null){this.Ug=xa;this.I1d=this;this.Xvg=Ba||(()=>window.location.href);this.QJc=new t(pc)}run(){if(A.YP(window.performance))try{const Ld=this.Xvg();if(A.tEg.exec(Ld)&&this.QJc.Lhf(Ld)){var xa=new v(window.performance.timing,Ld);z.a.instance.Saj(xa.$t.fetchStart);z.a.instance.Taj(xa.$t.navigationStart);z.a.instance.xEb(C.a.gJh,"connectStart","requestStart");z.a.instance.xEb(C.a.oJh,"requestStart","responseStart");z.a.instance.xEb(C.a.rJh,"responseStart",
"responseEnd");this.I1d.Qe(1,xa.AZd());this.Ug.rn(C.a.tva,xa.$t.fetchStart);this.Ug.rn(C.a.lJh,xa.$t.domainLookupStart);this.Ug.rn(C.a.kJh,xa.$t.domainLookupEnd);this.Ug.rn(C.a.iJh,xa.$t.connectStart);this.Ug.rn(C.a.sJh,xa.$t.secureConnectionStart);this.Ug.rn(C.a.hJh,xa.$t.connectEnd);this.Ug.rn(C.a.pJh,xa.$t.requestStart);this.Ug.rn(C.a.ded,xa.$t.responseStart);this.Ug.rn(C.a.mJh,xa.$t.responseEnd-xa.$t.responseStart);this.Ug.rn(C.a.qJh,xa.$t.responseStart-xa.$t.requestStart);var Ba=0,pc=0,nd=0;
({transferSize:Ba,i$c:pc,T7c:nd}=this.xTj(Ld)).returnValue&&(this.Ug.rn(C.a.tJh,Ba),this.Ug.rn(C.a.jJh,nd),this.Ug.rn(C.a.nJh,pc));this.Ug.rn(C.a.ced,xa.$t.navigationStart)}}catch(Ld){e.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Ld)}}xTj(xa){let Ba,pc,nd;nd=pc=Ba=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Ba,i$c:pc,T7c:nd};xa=window.performance.getEntriesByName(xa,"navigation");
if(void 0===xa||null===xa||1!==xa.length)return{returnValue:!1,transferSize:Ba,i$c:pc,T7c:nd};xa=xa[0];var Ld=xa.transferSize;void 0!==Ba&&null!==Ba&&(Ba=Ld);Ld=xa.decodedBodySize;void 0!==Ld&&null!==Ld&&(nd=Ld);xa=xa.encodedBodySize;void 0!==xa&&null!==xa&&(pc=xa);return{returnValue:!0,transferSize:Ba,i$c:pc,T7c:nd}}Qe(xa,Ba){e.ULS.sendTraceTag(4551815,306,50,w(xa,Ba))}static get instance(){return A.Ma||(A.Ma=new A(B.a.instance,null,h.AFrameworkApplication.fa.qa("PerfTimingLoggerFilterDomainsIsEnabled")?
h.AFrameworkApplication.fa.Cw("ResourceLoggerDomainAllowList"):null))}static YP(xa){return!(void 0===xa||null===xa)&&!(void 0===xa.timing||null===xa.timing)}}A.Ma=null;A.tEg=RegExp("^https?://.*","i");Object(b.a)(A,"PerformanceTimingLogger",null,[479]);var E=a(97),I=a(83);class L{constructor(xa,Ba){this.haa=null;this.tUc=xa;this.behavior=Ba;this.url=this.$t.name}get J1d(){return 2===this.behavior?this.url:y.a.Gda(this.url)}get $t(){return this.tUc}AZd(){const xa={},Ba=this.$t;xa.a=this.J1d;xa.b=Ba.initiatorType;
xa.c=this.round(Ba.redirectStart);xa.d=this.round(Ba.redirectEnd);xa.e=this.round(Ba.fetchStart);xa.f=this.round(Ba.domainLookupStart);xa.g=this.round(Ba.domainLookupEnd);xa.h=this.round(Ba.connectStart);xa.i=this.round(Ba.connectEnd);xa.j=void 0!==Ba.secureConnectionStart&&null!==Ba.secureConnectionStart?this.round(Ba.secureConnectionStart):0;xa.k=this.round(Ba.requestStart);xa.l=this.round(Ba.responseStart);xa.m=this.round(Ba.responseEnd);xa.o=this.round(L.q5a(Ba,"decodedBodySize"));xa.p=this.round(L.q5a(Ba,
"encodedBodySize"));xa.q=this.round(L.q5a(Ba,"transferSize"));xa.n=this.haa;return xa}round(xa){return Math.round(1E3*xa)/1E3}static q5a(xa,Ba){return xa[Ba]}}Object(b.a)(L,"ResourceTimingEntry",null,[525]);var V=a(98),T=a(136),H=a(41),D=a(111),G=a(189);class J{constructor(xa,Ba=null,pc=100){this.z5d=xa;this.GYb=Ba;this.yhb={};this.Gsg=pc}NSj(xa){var Ba=xa.name.toLowerCase();const pc=y.a.dwa(Ba);this.Imj(pc,Ba)&&(pc in this.yhb?e.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
pc):(Ba={},Ba.fetchstart=xa.fetchStart,Ba.responseend=xa.responseEnd,Ba.iscached=this.uti(xa),Ba.encodedsize=L.q5a(xa,"encodedBodySize"),Ba.decodedsize=L.q5a(xa,"decodedBodySize"),this.yhb[pc]=Ba))}Imj(xa,Ba){if(this.z5d)return Array.contains(this.z5d,xa);if(this.GYb)for(xa=y.a.lN(Ba),Ba=0;Ba<this.GYb.length;Ba++)if(this.GYb[Ba]&&xa.endsWith(this.GYb[Ba]))return!0;return!1}uti(xa){try{const Ba=L.q5a(xa,"transferSize");if(void 0!==Ba&&null!==Ba)return!Ba;e.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return xa.responseEnd-xa.fetchStart<this.Gsg}catch(Ba){e.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Ba.message)}return!1}pbj(){if(D.a.rh(this.yhb))e.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var xa=h.AFrameworkApplication.tF?h.AFrameworkApplication.tF.split(";"):[],Ba=Object.assign(new G.a,{extendedProperties:T.a.gs()});Ba.extendedProperties.set("Flights",H.c(xa));
this.DAi(Ba,this.yhb,V.Health.instance)}}DAi(xa,Ba,pc){if(Ba){var nd=0,Ld=0,te=0,af=0,Bf=0,Pf=0,Ef=0,cg=0,Uf=0,ag=0,lg=0;for(let vg in Ba){var Dg=Ba[vg];try{const dg=Object(I.a)(Object,Dg);if(!dg)continue;const ch=dg.iscached?Boolean.parse(dg.iscached.toString()):!1,Jf=dg.fetchstart?this.parseFloat(dg.fetchstart.toString()):0,rg=(dg.responseend?this.parseFloat(dg.responseend.toString()):0)-Jf,hg=dg.encodedsize?this.parseFloat(dg.encodedsize.toString()):0,Jg=dg.decodedsize?this.parseFloat(dg.decodedsize.toString()):
0;nd+=rg;af+=hg;Ef+=Jg;ag++;ch?(te+=rg,Pf+=hg,Uf+=Jg,lg++):(Ld+=rg,Bf+=hg,cg+=Jg)}catch(dg){e.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",dg.message)}}xa.extendedProperties.set("StaticResources",H.c(Ba));xa.extendedProperties.set("TotalResourceDownloadLatency",nd.toString());xa.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Ld.toString());xa.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",te.toString());
xa.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",af.toString());xa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Bf.toString());xa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Pf.toString());xa.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ef.toString());xa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",cg.toString());xa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Uf.toString());
xa.extendedProperties.set("TotalNumberOfResourcesDownloaded",ag.toString());xa.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",lg.toString());pc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);pc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",xa)}}parseFloat(xa){if(!xa)return 0;xa=parseFloat(xa);return isNaN(xa)?0:xa}}Object(b.a)(J,"AppStaticResourceManager",null,[]);class M extends Sys.EventArgs{constructor(xa){super();
this.entries=xa}}Object(b.a)(M,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var Q=a(107);class U{constructor(xa,Ba,pc=null,nd=null,Ld=100){this.ONc=!1;this.Xi=null;this.Aib=0;this.fb=new E.a;this.Dhb=null;this.jT=!1;this.ime=0;this.he=xa;this.r8d=0;this.I1d=this;this.QJc=new t(pc);this.fv=Ba;nd&&(this.Dhb=new J(null,nd,Ld))}get Aye(){try{return!(void 0===this.fv||null===this.fv)&&!(void 0===this.fv.getEntriesByType||null===this.fv.getEntriesByType)}catch(xa){return e.ULS.sendTraceTag(50873240,306,
10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",xa),!1}}get Hih(){return this.r8d}get isActive(){return this.jT}get pZd(){return this.ime}oLg(xa){this.fb.addHandler(U.Q$c,xa)}Igj(xa){this.fb.removeHandler(U.Q$c,xa)}Xh(xa,Ba){const pc=this.pZd!==xa;this.ime=xa;this.isActive&&this.he&&pc&&(this.np(),this.Fg());this.r8d=Ba}activate(){!this.isActive&&this.Aye&&(this.Fg(),this.jT=!0)}deactivate(xa){this.isActive&&(this.np(),xa&&this.flush(),this.jT=!1)}flush(){if(this.isActive&&
this.Aye)try{var xa=window.performance.getEntriesByType("resource");0<xa.length-this.Aib&&e.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",xa.length-this.Aib);const Ba=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Ba&&(window.performance.clearResourceTimings(),this.Aib=0);const pc=[];for(let nd=this.Aib;nd<xa.length;nd++)this.QJc.Lhf(xa[nd].name)&&(this.Dhb&&this.Dhb.NSj(xa[nd]),
pc.push(new L(xa[nd],this.Hih)));Ba||(this.Aib=xa.length);this.fb.raiseEvent(U.Q$c,new M(pc));for(xa=0;xa<pc.length;xa++)0!==pc[xa].behavior&&2!==pc[xa].behavior||this.I1d.Qe(0,pc[xa].AZd());0<pc.length&&e.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",pc.length)}catch(Ba){e.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Ba)}}Qe(xa,Ba){e.ULS.sendTraceTag(4310804,306,50,w(xa,Ba))}Raj(){this.Dhb.pbj()}Fg(){this.he&&
0<this.pZd&&(this.Xi=new Q.a(3,2,1E3*this.pZd,()=>{this.flush()},5),this.he.Fg(this.Xi),this.ONc=!0)}np(){this.ONc&&(this.he.np(this.Xi),this.Xi=null,this.ONc=!1)}}U.Q$c="EntriesAvailable";Object(b.a)(U,"ResourceTimingLogger",null,[458,479]);var Z=a(119);class P{constructor(){this.gb=null}get name(){return"Common.ResourceTiming"}init(){this.gb.resolve("Common.NetworkTiming.IResourceTimingLogger");A.instance.run()}dispose(){}Xh(xa){this.gb=xa;let Ba=null;if(h.AFrameworkApplication.fa.qa("ResourceLoggerFilterDomainsIsEnabled"))try{Ba=
h.AFrameworkApplication.fa.Cw("ResourceLoggerDomainAllowList")}catch(Ld){e.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const pc=[];pc.push(y.a.lN(Z.a.ML).toLowerCase());pc.push(y.a.lN(Z.a.meb).toLowerCase());const nd=h.AFrameworkApplication.fa.rd("AppStaticResourceMonitorCacheThresholdInMs",100);xa.register(458,"Common.NetworkTiming.IResourceTimingLogger").xc().Fc(()=>new U(h.AFrameworkApplication.Fi,window.performance,Ba,pc,nd))}static main(){x.a.instance.Ei(new P)}}
Object(b.a)(P,"ResourceTimingPackage",null,[3,4]);var S=a(84);class ja extends Sys.EventArgs{constructor(xa,Ba){super();this.MOj=xa;this.actualValue=Ba}}Object(b.a)(ja,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var X=a(166);class Y{constructor(){this.mWa=[];this.Q7d=this.eJc=0;this.ufa=null;this.fb=new E.a}init(xa,Ba,pc){this.ufa=xa;this.eJc=Ba;this.Q7d=pc;this.ufa.Ore(Object(S.a)(this,this.TNi,"onCpuMeterFrameAvailable"));this.BMg(Object(S.a)(this,this.s$g,"cpuPercentThresholdExceeded"))}TNi(xa,
Ba){Ba.Vwf&&(Array.enqueue(this.mWa,Ba.Vwf.CP),this.mWa.length>this.Q7d&&(Array.dequeue(this.mWa),this.f2g()))}f2g(){var xa=this.mWa.length;let Ba=0;for(let pc=0;pc<xa;pc++){const nd=Array.dequeue(this.mWa);Ba+=nd;Array.enqueue(this.mWa,nd)}xa=Ba/xa;xa>this.eJc&&this.fb.raiseEvent("CPTTE",new ja(this.eJc,xa))}s$g(xa,Ba){X.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.sbh(Ba.MOj,Ba.actualValue))}BMg(xa){this.fb.addHandler("CPTTE",xa)}sbh(xa,Ba){const pc={};pc.ThresholdValue=
xa;pc.ActualValue=Ba;return pc}}Object(b.a)(Y,"CpuMeterMonitor",null,[496]);var va=a(157);class N{constructor(){this.S=this.T=this.M=this.C=0}}Object(b.a)(N,"ProfileInformation",null,[]);var ea=a(14),Ca=a(45),la=a(264);class Ra{constructor(xa=0,Ba=0){this.nMc=!1;this.pEa={};this.XVb=xa;this.fWb=Ba;this.GUc=0;Ca.a.addHandler(window.self,ea.a.ePg,()=>{this.nMc=!0});Ca.a.addHandler(window.self,ea.a.fPg,()=>{this.nMc=!1})}ite(xa,Ba,pc){const nd=Ra.generateKey(Ba,pc);nd in this.pEa?Ba=this.pEa[nd]:(Ba=
new N,Ba.S=pc?1:0,this.pEa[nd]=Ba,this.GUc++);Ba.C++;Ba.M=xa>Ba.M?xa:Ba.M;Ba.T+=xa}jH(xa,Ba){this.ite(xa,Ba,!1);this.nMc&&this.ite(xa,Ba,!0)}getData(){if(0<this.fWb&&this.GUc>this.fWb)return this.dRh();const xa=0<this.XVb,Ba={},pc=this.pEa;for(let Ld in pc){var nd=Ld;const te=pc[Ld];this.OZf(te);xa&&te.T>=this.XVb&&(Ba[nd]=te)}return xa?D.a.rh(Ba)?null:Ba:this.pEa}dRh(){var xa=0<this.XVb,Ba=[];const pc=this.pEa;for(let nd in pc){const Ld={key:nd,value:pc[nd]};let te=Ld.value;(!xa||te.T>=this.XVb)&&
Array.add(Ba,Ld)}if(Ba.length>this.fWb)Ba.sort((nd,Ld)=>Ld.value.T-nd.value.T),Ba=Ba.slice(0,this.fWb);else if(!Ba.length)return null;xa={};for(const nd of Ba)Ba=nd.value,this.OZf(Ba),xa[nd.key]=Ba;return xa}OZf(xa){xa.M=la.a.A7(xa.M,0);xa.T=la.a.A7(xa.T,0)}reset(){this.pEa={};this.GUc=0}static generateKey(xa,Ba){return Ba?xa+" [it]":xa}}Object(b.a)(Ra,"FunctionCallAggregator",null,[487]);class lb{}lb.hUg="BatchedOperation";lb.replication="Replication";lb.bUj="25";lb.Qjj="9_"+lb.hUg+"_"+lb.replication;
Object(b.a)(lb,"CpuMeterConstants",null,[]);class Aa{}Object(b.a)(Aa,"CpuMeterFrame",null,[]);class da extends Sys.EventArgs{constructor(xa){super();this.Vwf=xa}}Object(b.a)(da,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class aa{}Object(b.a)(aa,"MiniTaskItemInfo",null,[]);class fa{}Object(b.a)(fa,"TaskItemInfo",null,[]);var Oa=a(553),ba=a(99);class ka{static p5h(){if(!ka.oSb&&(ka.oSb=new ba.a,h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.aq("AggregatorIdDisabledList"))){const xa=
h.AFrameworkApplication.fa.Cw("AggregatorIdDisabledList");for(let Ba=0;Ba<xa.length;Ba++)ka.oSb.ia(xa[Ba],!0)}return ka.oSb}}ka.oSb=null;Object(b.a)(ka,"DisabledAggregatorListStore",null,[]);var Pa=a(267);class Fa{constructor(xa,Ba,pc,nd,Ld,te=!0,af=null){this.$X=this.xle=this.Oce=!1;this.he=null;if(!xa)throw Pa.a.argument("taskManagerLazy");if(!Ld)throw Pa.a.argument("dataAggregator");this.JDg=xa;this.iQc=Ba;this._id=pc;this.ibe=6E4*nd;this.zTb=Ld;this.Mie=te;this.tmb=af;ka.p5h().lb(this._id.toString())&&
(this.$X=!0)}get taskManager(){return this.he||(this.he=this.JDg.value)}track(xa,Ba=null){this.$X||(this.bsh(),this.lqj(),this.zTb.jH(xa,Ba))}lqj(){!this.Oce&&0<this.ibe&&(this.Oce=!0,this.A0f())}A0f(){const xa=new Q.a(5,1,this.ibe,()=>{this.fsj()},19,this._id.toString());this.taskManager.Fg(xa)}fsj(){!this.tmb||this.tmb.EBj()?this.J1f():this.Mie&&this.zTb.reset();this.A0f()}J1f(){const xa=this.zTb.getData();if(xa){const Ba=parseInt(String(xa.length));if(isNaN(Ba)||0<Ba)this.xxc(xa),this.Mie&&this.zTb.reset()}}xxc(xa){e.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:xa})}bsh(){this.xle||(this.iQc(()=>{this.J1f()}),this.xle=!0)}static iN(xa,Ba,pc,nd,Ld){return new Fa(new Oa.a(()=>h.AFrameworkApplication.Fi),h.AFrameworkApplication.HOb,xa,Ba,pc,nd,Ld)}static x4a(xa,Ba,pc){return Fa.iN(xa,Ba,pc,!0,null)}}Object(b.a)(Fa,"Aggregator",null,[486]);class oa{constructor(xa=null){this.jn=null;this.reset();this.tmb=xa}jH(xa,Ba){if(!this.tmb||this.tmb.EBj())Ba in this.jn||(this.jn[Ba]=[]),this.jn[Ba].push(xa)}getData(){return D.a.count(this.jn)?
this.jn:null}reset(){this.jn={}}}Object(b.a)(oa,"NamedValuesAggregator",null,[487]);var La=a(263);class Ea{constructor(xa,Ba,pc,nd,Ld){this.PFa=0;this.BE=null;this.QXb=this.hle=0;this.wje=!1;this.KWa=0;this.nkb=!1;this.kra=null;this.dVb=0;this.rge=new E.a;this.UYb=[];this.fM=xa;this.fPc=Ba;this.eLc=pc;this.Eee=nd;h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.qa("WrapSetTimeoutForTelemetryIsEnabled")&&this.Nud();this.cvg=Ld;this.fLc=new Ra(100);this.Yyg=Fa.x4a(1,5,new oa)}Ore(xa){this.rge.addHandler("OnCpuMeterFrameAvailable",
xa)}Cbb(xa,Ba,pc,nd=null){pc=nd?nd.priority:7;const Ld=this.fM();this.start(Ba,pc);try{xa()}finally{this.stop(Ba,nd),xa=this.fM()-Ld,this.Eee.track(xa,Ba)}}DW(xa,Ba){const pc=this.fM();try{xa()}finally{xa=this.fM()-pc,this.eLc.jH(xa,Ba),0<this.PFa&&this.fLc.jH(xa,Ba),this.Eee.track(xa,Ba)}}REd(xa){const Ba=new fa;Ba.TN=xa.jmc;Ba.TP=xa.priority;this.AQf(1,Ba)}O9a(xa){this.dVb|=xa}start(xa,Ba){if(!this.PFa){this.fLc.reset();const pc=this.enf(xa);pc&&this.Myd(1);this.BE=new fa;this.BE.TN=xa;this.BE.TP=
Ba;this.BE.ST=(new Date).toISOString();this.BE.STS=la.a.A7(this.fM(),2);pc?this.BE.UI=1:this.Zoi(xa)?this.BE.UI=2:this.BE.UI=0}this.PFa++}Myd(xa){this.KWa|=xa}x2c(xa=!0,Ba=0){this.KWa=xa?0:this.KWa&~Ba}stop(xa,Ba=null){let pc;this.PFa--;0>=this.PFa&&this.BE&&(pc=this.fM()-this.BE.STS,this.QXb+=pc,this.fPc.jH(pc,xa),this.enf(xa)&&this.x2c(!1,1),this.BE.TRT=la.a.A7(pc,2),Ba&&(this.BE.TQT=la.a.A7(Ba.w8i,2),this.BE.TDT=la.a.A7(Ba.zof,2)),this.cvg&&(this.AQf(0,this.BE),this.xkj()),this.PFa=0);0<=xa.indexOf(lb.bUj)&&
this.O9a(2);0<=xa.indexOf(lb.Qjj)&&this.O9a(4);1===(this.KWa&1)&&this.O9a(1);2===(this.KWa&2)&&this.O9a(8)}xkj(){var xa=this.BE.TRT;if(750<xa){let pc=this.fLc.getData();if(pc){const nd={};for(let Ld in pc){var Ba=pc[Ld];const te=Ld;te.startsWith("SiOp_")||te.endsWith("[it]")||(nd[te]=Math.round(100*Ba.T/xa))}pc=nd}xa=Object.assign(new aa,{B:this.BE.STS,T:xa,S:pc});this.Yyg.track(xa,this.BE.TN)}}bJj(){var xa=this.fM()-this.hle,Ba=la.a.A7(this.QXb/xa*100,2);xa=new Aa;xa.CP=Ba;xa.II=this.dVb;Ba=this.fPc.getData();
D.a.count(Ba)&&(xa.LRT=Ba);Ba=this.eLc.getData();D.a.count(Ba)&&(xa.FP=Ba);this.rge.raiseEvent("OnCpuMeterFrameAvailable",new da(xa));this.gag()}gag(){this.fPc.reset();this.eLc.reset();this.QXb=this.PFa=0;this.hle=this.fM();this.dVb=0;this.BE=null}run(){this.wje?this.bJj():(this.gag(),this.wje=!0);this.kra?this.kra(Object(S.a)(this,this.run,"run"),1E3):window.setTimeout(Object(S.a)(this,this.run,"run"),1E3)}pWc(xa,Ba,pc){const nd=Array(2);nd[0]=Ba;nd[1]=pc;this.UYb[xa]||(this.UYb[xa]=[]);this.UYb[xa].push(nd)}AQf(xa,
Ba){xa=this.UYb[xa];if(!La.a.rh(xa))for(let nd=0;nd<xa.length;nd++){var pc=xa[nd];const Ld=pc[0];pc=pc[1];Ld&&!Ld(Ba)||pc(Ba)}}Nud(){if(!this.nkb){const xa=window.setTimeout;this.kra=(Ba,pc)=>xa(Ba,pc);this.nkb=!0}}enf(xa){return xa.startsWith("key")||xa.startsWith("input")}Zoi(xa){return xa.startsWith("click")||xa.startsWith("mouse")||xa.startsWith("pointer")}}Object(b.a)(Ea,"CpuMeter",null,[79]);class ca{constructor(xa){this.zib=null;this.xk=new va.a;this.fM=xa}initialize(xa,Ba,pc,nd=!1){this.zib||
(this.zib=new Ea(this.fM,xa,Ba,pc,nd),this.xk.setResult(this.zib));return this.zib}}Object(b.a)(ca,"CpuMeterProvider",null,[494]);class $a{constructor(xa=1){this.Dx=[];this.HTb=[];this._count=xa}fGh(){let xa=0;for(let Ba=0;Ba<this.Dx.length;Ba++)this.Dx[Ba]<this.Dx[xa]&&(xa=Ba);return xa}jH(xa,Ba){xa=la.a.A7(xa,2);if(this.Dx.length<this._count)Array.add(this.Dx,xa),Array.add(this.HTb,Ba);else{var pc=this.fGh();xa>this.Dx[pc]&&(this.Dx[pc]=xa,this.HTb[pc]=Ba)}}getData(){return this.Dx.length?{["Vals"]:this.Dx,
["Desc"]:this.HTb}:null}reset(){this.Dx=[];this.HTb=[]}}Object(b.a)($a,"MaxDataAggregator",null,[487]);var Qa=a(39),Va=a(82);class fb{get name(){return"Common.App.CpuMeter"}Xh(xa){xa.register(ca,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").xc().Fc(()=>new ca(Qa.a.Ud));xa.register(Y,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").xc().Fc(()=>new Y)}init(){const xa=h.AFrameworkApplication.fa;if(xa.qa("CpuMeterIsEnabled")){const Ba=Va.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
z.a.instance.kue.continueWith(()=>{fb.Rei(xa,Ba)})}}dispose(){}static Rei(xa,Ba){const pc=Fa.x4a(10,5,new Ra(xa.rd("TaskManagerLoggingThreshold",0),xa.rd("CpuMeterMaximumEntriesToLog",0)));Ba=Ba.initialize(new $a(5),new Ra,pc,xa.qa("CPUMeterExposeTaskDetailsIsEnabled"));Ba.run();xa.qa("CpuMeterMonitorIsEnabled")&&Va.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ba,xa.Lva("CpuMeterAverageCpuPercentThreshold",80),xa.rd("CpuMeterRollingAverageFramesCount",15));X.a(16827671,306,50,"Initializing CpuMeter")}static main(){x.a.instance.Ei(new fb)}}
Object(b.a)(fb,"CpuMeterPackage",null,[3,4]);var Ka=a(942);class hb{get name(){return"Common.App.EventsCachePackage"}Xh(){}init(){Ka.a.instance.init()}dispose(){}static main(){x.a.instance.Ei(new hb)}}Object(b.a)(hb,"EventsCachePackage",null,[3,4]);var fc=a(9),dc=a(222),wb=a(1240),Tb=a(164),xb=a(376),cb=a(204),jb=a(148),qa=a(59),za=a(92),Na=a(1),ua=a(22),Xa=a(159),ha=a(762);class ta extends wb.a{constructor(xa,Ba,pc){super(Ba,pc);this.Ra=new E.a;this.nbi=nd=>{if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Ld=
nd.Values.m_Origin;h.AFrameworkApplication.wopiHostOriginFromPostMessage||(h.AFrameworkApplication.wopiHostOriginFromPostMessage=Ld)}switch(nd.MessageId){case Tb.a.Hmd:Xa.a(this.$).x$e(nd);break;case Tb.a.uwd:jb.a.ltas(null);break;case Tb.a.Rfc:this.nSi();break;case Tb.a.Kmd:this.mSi(nd)}};this.$=xa;pc!==ha.a.m$&&this.vGa(pc);this.bgi();this.mfi();xa=this.nbi;this.dm(Tb.a.Hmd,xa);this.dm(Tb.a.uwd,xa);this.dm(Tb.a.Rfc,xa);this.dm(Tb.a.Kmd,xa)}dispose(){this.$=null;super.dispose()}bgi(){this.so(Tb.a.jAe);
this.so(Tb.a.Hmd);this.so(Tb.a.Rfc);this.so(Tb.a.Kmd);this.jWc(Tb.a.uwd);this.so(Tb.a.Jmd)}mfi(){this.Yga(Tb.a.znb);this.Yga(Tb.a.tua);this.Yga("App_CloseTab");this.Yga(Tb.a.rVa);this.Yga(Tb.a.sVa);this.Yga(Tb.a.Bcf);this.Yga(Tb.a.Ofc)}nSi(){const xa={};xa.hostMessageReceived=(new Date).getTime();e.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");h.AFrameworkApplication.mtd=!0;xa.appUnloadStart=(new Date).getTime();xa.sendBeaconFlight=h.AFrameworkApplication.fa.qa("SendBeaconOnShuttingDownRequestsEnabled");
xa.sendBeaconSupported=qa.a.cea();qa.a.tue();xa.appUnloadEnd=(new Date).getTime();xa.appMessageSent=(new Date).getTime();this.Rj(Tb.a.uQg,xa)}mSi(xa){e.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");xa.Values&&xb.a.PAd in xa.Values&&ua.a.equals(xa.Values[xb.a.PAd],cb.a.edit,!0)&&!this.$.isEditMode&&(e.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${xa.Values[xb.a.PAd]}`),xa=new za.a(-8805455,0,1,0,null),this.$.Ja.Lb(xa))}}Object(b.a)(ta,"EwaHostMessenger",
wb.a,[474,119,2]);class wa extends dc.a{constructor(xa){super();this.rFe=!1;this.$=xa;this.Fb()}create(){const xa=this.$.da,Ba=Va.a.instance;if(!this.rFe){this.rFe=!0;let pc;pc=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.va.DocumentHostInfo.PostMessageOrigin||ha.a.m$:h.AFrameworkApplication.gHd||ha.a.m$;Ba.register(ta,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").xc().Fc(()=>new ta(this.$,window.parent,
pc,h.AFrameworkApplication.fa.qa("HostSendReadyToAcceptPostMessage")))}this.nb(xa.Aa(21)||xa.Ga(21,Ba.resolve("Postmessage.IHostPostmessenger")))}}Object(b.a)(wa,"HostMessengerFactory",dc.a,[]);var db=a(120),Jb=a(147),Pb=a(684),eb=a(554),Ma=a(78),ob=a(132),Ia=a(462),Da=a(46),nb=a(320),Ua=a(354),W=a(357),sa=a(496),vb=a(5),gc=a(51),Bc=a(76);class Sa{constructor(xa,Ba,pc){this.correlations=this.properties=this.operation=null;this.operation=xa;this.properties=Ba;this.correlations=pc}static EDh(xa,Ba,
pc){const nd={},Ld=gc.b();switch(xa.command){case -1537138325:nd.Action=Ba.LabelText;break;case -1104934572:nd.PrevTab=Ld.uj(parseInt(Ba.OldContextCommand,10));nd.NextTab=Ld.uj(parseInt(Ba.NewContextCommand,10));break;case 802602464:nd.Origin=Ba[vb.a.DQ];break;case -1027730316:case -1059615499:nd.MenuType=Ba.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Ba&&(nd.SqmControlId=Ba.SqmControlId);break;case 1371713064:case 875133075:Bc.a.Jc in
Ba&&(nd.SampleTableId=Ba[Bc.a.Jc])}nd.InputMethod=Ua.a[xa.method];nd.Location=W.a[xa.af];nd.Mode=sa.a[xa.mode];nd.ParentName=xa.tabName;nd.IsSystemInitiated="IsSystemInitiated"in Ba?Ba.IsSystemInitiated:!1;nd.NoReporting="NoReporting"in Ba?Ba.NoReporting:!1;"ControlIdToLog"in Ba&&(nd.ControlId=Ba.ControlIdToLog);"TerminalParentControlIdToLog"in Ba&&(nd.TerminalParentControlId=Ba.TerminalParentControlIdToLog);for(const te of Object.keys(pc))nd[te]=pc[te];return nd}}Object(b.a)(Sa,"InteractivityRecord",
null,[]);class na extends Sa{constructor(xa,Ba,pc){super(xa.operation,xa.properties,xa.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Ba;this.timeFromNavigationStart=pc}}Object(b.a)(na,"FirstUserInteractivityRecord",Sa,[]);var ib=a(640);class Ib{constructor(){this.commandSurface=this.triggerMethod=db.a.rgb}static efi(){Ib.O3a||(Ib.O3a=new ib.a(eb.a.ak()),Ib.O3a.add("InputMethod"),Ib.O3a.add("Location"),Ib.O3a.add("Mode"))}}Ib.O3a=null;Object(b.a)(Ib,
"ExcelUserAction",null,[]);var ec=a(202),qb=a(42),Ha=a(432),Ab=a(190);class Yb extends Ma.a{constructor(xa){super();this.yff=0;this.vYe=!1;this.fvd=Array(Yb.R9a);this.V6b=0;this.$=xa;this.dBb=Na.EwaSettings.ma(77);this.Dmf=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");this.Gpi=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");db.a.LYh();this.Dba={};Yb.RZb||(Yb.RZb=new Pb.a(eb.a.ak()),Yb.pei(Yb.RZb));Ib.efi();if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(xa=
0;xa<Yb.R9a;xa++)this.fvd[xa]="NA"}dispose(){this.$=this.Dba=null;super.dispose()}$Wf(xa,Ba,pc){if(this.dBb){var nd=gc.b().uj(xa.command),Ld=JSON.stringify(xa);nd||e.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${nd}, command: ${xa.command}, commandInfo: ${Ld}`);Ba=Sa.EDh(xa,Ba,pc);pc=!!Ba&&(!("IsSystemInitiated"in Ba)||!Ba.IsSystemInitiated);this.$&&this.$.ea.tg&&pc&&Ka.a.instance.aSf("OtelUserAction",new Ha.a(nd,xa.tabName,Date.now()));
this.nXf(nd,Ba,null,!0,!0)}}ud(xa,Ba,pc=null,nd=!1){this.dBb&&this.nXf(xa,Ba,pc,!1,nd)}aXd(xa){if(this.dBb)if(this.Dba){++this.yff;this.Dba[xa]||(this.Dba[xa]=[]);var Ba=this.yff.toString();this.Dba[xa].push(Ba);e.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${xa}', correlation=${Ba}`)}else e.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${xa}] == null`)}sXd(xa){if(this.dBb)if(this.Dba&&this.Dba[xa]){var Ba=
this.Dba[xa],pc=Ba.pop().toString();Ba.length||delete this.Dba[xa];e.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${xa}', correlation=${pc}`)}else e.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${xa}] == null`)}oQ(xa,Ba,pc=!1){return this.dBb?nb.a(nd=>{this.ud(xa,nd(),void 0,pc)},Yb.OOj,this.ka,Da.a.Xhi,!1,!Ba):null}sNd(){let xa="";for(let Ba=0;Ba<Yb.R9a;Ba++)xa+=this.fvd[(this.V6b+Yb.R9a-Ba-
1)%Yb.R9a]+",";e.ULS.sendTraceTag(557188890,0,15,`Last operations ${xa}`)}iYj(xa){xa&&(this.fvd[this.V6b]=xa,this.V6b=(this.V6b+1)%Yb.R9a)}AAi(xa,Ba,pc){h.AFrameworkApplication.D9b();const nd=xa.operation,Ld=xa.properties;void 0!==pc?Ia.a(this.$,432,433,0,te=>{te.qbj(nd,Ld,pc)}):this.kUj(xa);this.lUj(xa);this.N_i(Ba,Ld,nd)}kUj(xa){this.dIj(xa)||(this.vYe=!0,xa=new na(xa,qb.PageLoadTrackingInfo.instance.gwa(new Date),qb.PageLoadTrackingInfo.Au()),xa=Sys.Serialization.JavaScriptSerializer.serialize(xa),
e.ULS.sendTraceTag(458261331,0,50,`${xa}`))}dIj(xa){const Ba=xa.properties;xa=xa.operation;return this.vYe||void 0===xa||null===xa||xa===ob.a.PVc||xa===ob.a.zQd||xa===ob.a.DHd||qa.a.usd(xa)||!!Ba&&"IsSystemInitiated"in Ba&&Ba.IsSystemInitiated}lUj(xa){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.iYj(xa.operation);xa=Sys.Serialization.JavaScriptSerializer.serialize(xa);e.ULS.sendTraceTag(21542793,0,50,`${xa}`)}N_i(xa,Ba,pc){db.a.xla()&&(Ba?"NoReporting"in
Ba&&Ba.NoReporting||"IsSystemInitiated"in Ba&&Ba.IsSystemInitiated||!xa&&!this.Dmf||((xa=db.a.Zj(Ba,Yb.RZb,Ib.O3a))?(Ba=Yb.MDh(Ba))?Jb.a.sendUserActionEvent(db.a.y6b(pc,null,Ba.triggerMethod,Ba.commandSurface,xa)):e.ULS.sendTraceTag(537155550,0,50,"user action was null"):e.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):e.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${pc}`))}nXf(xa,Ba,pc,nd,Ld){const te=
ec.a(this.$);if(this.Dmf){let Bf=null;ua.a.equals(xa,ob.a.mxc,!0)&&Ba&&"InputMethod"in Ba&&(Bf=ob.a.pZe(xa,Ba.InputMethod));te.IKb(Bf||xa,pc)}else ua.a.equals(xa,ob.a.mxc,!0)&&Ba&&"InputMethod"in Ba&&(xa=ob.a.pZe(xa,Ba.InputMethod)),te.IKb(xa,pc);Ba&&(Ba.IsCommand=nd);let af=void 0;this.Gpi&&(af="ActionRelativeTime"in Ba?Ba.ActionRelativeTime:qb.PageLoadTrackingInfo.Au());Object(Ab.c)(()=>{const Bf=new Sa(xa,Ba,this.Dba);this.AAi(Bf,Ld,af)},this.$.ka,50)}static MDh(xa){if(!xa)return null;const Ba=
new Ib;"InputMethod"in xa&&(Ba.triggerMethod=xa.InputMethod);"Location"in xa&&(Ba.commandSurface=xa.Location);return Ba}static pei(xa){xa?(xa.add("Origin",2),xa.add("InputMethod",2),xa.add("ButtonType",2),xa.add("selectedRange",2),xa.add("SelectedRanges",2),xa.add("editRange",2),xa.add("Location",2),xa.add("Mode",2),xa.add("CurrentSelectionMode",2),xa.add("Action",2),xa.add("type",2),xa.add("floatingObjectType",2),xa.add("PrevTab",2),xa.add("NextTab",2),xa.add("DialogName",2),xa.add("dx",3),xa.add("dy",
3),xa.add("NumberOfSelectedRanges",3),xa.add("IsCommand",1),xa.add("IsInFormulaBarEdit",1),xa.add("isLink",1),xa.add("isSheetRef",1),xa.add("isEmptyText",1),xa.add("isFormula",1),xa.add("IsResizingHiddenHeader",1)):e.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}Yb.OOj=1E3;Yb.R9a=40;Yb.RZb=null;Object(b.a)(Yb,"InteractivityLogger",Ma.a,[12]);var Bb=a(7);class Qb{constructor(){this.appInfoProperties=this.appState=null}}Object(b.a)(Qb,"CurrentAppInfo",null,[]);
const sc=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])},{name:"headers",actions:new Set(["header_resize_start","header_resize_autofit"])}].forEach(xa=>{xa.actions.forEach(Ba=>{sc.set(Ba,xa.name)})});class kb{constructor(){this.value=this.key=null}}Object(b.a)(kb,"AppInfoProperty",null,[]);class Eb{constructor(xa){this.$=xa}getAppState(){const xa=qb.PageLoadTrackingInfo.instance.gwa(new Date);
return-1===xa?"boot":3E4>xa?"postboot":"steady"}isChangeGateEnabled(xa){return Na.EwaSettings.isChangeGateEnabled(xa)}getBooleanFeatureGate(xa,Ba){return Na.EwaSettings.getBooleanFeatureGate(xa,Ba)}getCurrentAppInfo(){return Object(Bb.a)(new Qb,{appState:this.getAppState(),appInfoProperties:[Object(Bb.a)(new kb,{key:"coauthCount",value:this.$.ea.Xm.length.toString()})]})}sendBeaconTraceTag(xa,Ba,pc,nd){this.$.sendBeaconTraceTag(xa,Ba,pc,nd)}getActionBucket(xa){return c(xa)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.oFi}`}}
Object(b.a)(Eb,"InteractivityTrackerCallbacks",null,[506]);class Gc{constructor(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}}Object(b.a)(Gc,"InteractivityTrackerOptions",null,[]);class zc{constructor(xa){this.Eba=null;zc.rjf?e.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(xa),zc.rjf=!0)}initialize(xa){e.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");
if(this.Eba=interactivity.InteractivityTrackerFactoryGlobal.create()){const Ba=new Gc;Na.EwaSettings.Utd()&&zc.Zbg.push(ea.a.z$);Ba.events=zc.Zbg;Ba.durationThresholdInMs=zc.durationThresholdInMs;Ba.callbacks=new Eb(xa);Ba.patchTaskScheduling=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);xa=this.Eba.start(Ba);xa.started?e.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):e.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+
xa.failureReason)}else e.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}kCa(xa,Ba,pc){this.Eba?this.Eba.track(xa,Ba,pc):e.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Ba}`)}jJe(){return this.Eba?this.Eba.createActionsRetriever():(e.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),
null)}dispose(){this.Eba&&(this.Eba.stop(),this.Eba=null)}}zc.durationThresholdInMs=100;zc.Zbg="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");zc.rjf=!1;Object(b.a)(zc,"InteractivityTrackerService",null,[386]);var yb=a(49),gb=a(37),Kb=a(185),sd=a(697);class Sb extends dc.a{constructor(xa){super();this.$=xa;this.Fb()}create(){if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){const xa=yb.GetServiceTaskFactory.Oa(this.$.da,
283,284,this.Ya);gb.TaskExtensions.za(xa,()=>{gb.TaskExtensions.za(Kb.c(xa.result.kn.loadScript("interactivity")),()=>{this.nb(Object(sd.a)(this.$.da,443,()=>new zc(this.$)))},this.$.ka,3)},this.$.ka,3)}else this.nb(Object(sd.a)(this.$.da,443,()=>new zc(this.$)))}static la(xa){xa.da.Ga(444,new Sb(xa))}}Object(b.a)(Sb,"InteractivityTrackerServiceFactory",dc.a,[]);var yc=a(89),Fc=a(386),Zc=a(8),Rd=a(47),Ed=a(58);class ne{constructor(xa){this.GIj=xa}getCustomProperties(xa){const Ba=new Map;if(xa.hasOwnProperty("startTimeInMs")&&
xa.hasOwnProperty("totalExecutionTimeInMs")){const pc=xa.startTimeInMs;xa=this.GIj.retrieveSlowActionsBetweenTimeRange(pc,pc+xa.totalExecutionTimeInMs);Ba.set("actions",Ed.a.hc(xa))}return Ba}}Object(b.a)(ne,"CallTreeCustomPropertiesRetriever",null,[533]);class ze{constructor(){this.customProperties=new Map}addCustomProperty(xa,Ba){this.customProperties.set(xa,Ba)}getCustomProperties(){return this.customProperties}}Object(b.a)(ze,"CustomPropertiesRetriever",null,[528]);class Be{isFeatureEnabled(xa,
Ba){return Na.EwaSettings.getBooleanFeatureGate(xa,Ba)}}Object(b.a)(Be,"ExcelFeatureChecker",null,[529]);class td{isProfilingEnabled(){return!0}}Object(b.a)(td,"ExcelProfilingFeatureChecker",null,[527]);class Se{constructor(xa,Ba){this.NXi=xa;this.PXi=Ba}onProfilerEvent(xa){switch(xa.eventId){case 1:this.NXi(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.PXi();break;default:e.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${xa.eventId}`)}}}
Object(b.a)(Se,"JSCPUProfilerObserver",null,[526]);class $b{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(b.a)($b,"JSCPUProfilerInitOptions",null,[]);class Xc{constructor(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=
this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=
this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(b.a)(Xc,"JSCPUProfilingPackageInitOptions",null,[]);class ed{constructor(xa,Ba){this.interactivityTrackerService=this.nag=this.JId=this.Dbb=this.KId=this.cPf=this.dPf=null;this.g7i=new Set([1,0]);e.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");
this.$=xa;this.interactivityTrackerService=Ba;this.Zfi();this.Yfi();this.mvi=this.$.va.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=Na.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.hGe=Na.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.j0i=Na.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.PKj()}dispose(){e.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");
yc.a.Ia(this.nag);this.JId=this.$=null;this.KId.clear();this.Dbb.clear()}fKj(){const xa=Math.random()*this.hGe;e.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${xa}`);this.nag=Rd.a.instance.create(()=>{this.Yhd("ExcelOnlineContinuousSessionProfiler",2).start()},xa,Da.a.UAj,!0)}rKj(){e.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.Yhd("ExcelOnlineFullSessionProfiler",3).start()}yKj(xa){e.ULS.sendTraceTag(537155524,
0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Skf(xa)?this.Yhd(xa,0,1E4).start():e.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")}yLj(xa){this.Skf(xa)?(xa=this.c6e(xa))&&xa.stop():e.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")}IId(xa){return this.Dbb.has(xa)}PKj(){Na.EwaSettings.G6e()||(Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",
!1)?this.rKj():this.fKj())}createProfiler(xa,Ba,pc,nd,Ld,te){e.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const af=new $b;af.samplingIntervalInMs=Ba;af.maximumNumberOfSamplesToTake=pc;af.idleIntervalInMs=nd;af.profilingIntervalInMs=Ld;return this.xeh(xa,te,af)}Yfi(){const xa=new td,Ba=new Xc;Ba.ulsInstance=new Fc.a;Ba.deObfuscationEndpoint="ProfilerReporting.ashx";Ba.shouldCompressSerializedCallTrees=!1;Ba.shouldKeepSamplesOutsideOfProfilingInterval=
!1;Ba.shouldSendAllCallTreesFromProfileInASingleRequest=!Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);Ba.shouldUseSendBeaconForSendingCallTrees=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);Ba.callTreeFilteringThresholdInMs=Na.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);Ba.deObfuscationRequestQueryParamsRetriever=this.kbh();
Ba.deObfuscationRequestBodyPropertiesRetriever=this.jbh();Ba.featureEnabledChecker=new Be;Ba.useMainEventLoopForProfilerTraceProcessing=!1;Ba.profilerTraceProcessingWebWorkerSourceURL=this.$.va.JSProfilerProcessingWebWorkerJsScriptUrl;Ba.shouldProcessProfileCapturedWhileUserIsIdle=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");this.JId=this.dPf.retrievePackage(xa,Ba).retrieveProfilerFactory()}kbh(){const xa=new ze;xa.addCustomProperty(Zc.a.EPf,
h.AFrameworkApplication.userType);xa.addCustomProperty(h.AFrameworkApplication.iVa,h.AFrameworkApplication.userSessionId);xa.addCustomProperty(Zc.a.ZAd,this.$.va.SkipAuthentication?Zc.a.kxf:null);xa.addCustomProperty(Zc.a.cJd,this.$.va.MachineCluster);return xa}jbh(){const xa=new ze;xa.addCustomProperty("appName","Excel");xa.addCustomProperty("buildVersion",h.AFrameworkApplication.buildVersion);xa.addCustomProperty("shouldUseSourceMaps","true");xa.addCustomProperty("shouldFilterSensitiveResources",
"true");xa.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator",this.vEj().toString());return xa}xeh(xa,Ba,pc){const nd=new ze;nd.addCustomProperty("ProfilerName",xa);this.cPf.set(xa,nd);Ba=this.JId.createProfiler(Ba,pc,nd);this.Dbb.set(xa,Ba);xa=this.Jch(xa);Ba.subscribeProfilerObserver(xa,this.g7i);return Ba}c6e(xa){return this.IId(xa)?this.Dbb.get(xa):(e.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${xa}) does not exist`),null)}Yhd(xa,
Ba,pc=null){xa=this.j0i||xa;if(this.IId(xa))return this.c6e(xa);const nd=this.mvi;return this.createProfiler(xa,nd,null!=pc&&0<nd?pc/nd:2E6,2===Ba?this.hGe:null,0===Ba?null:this.profilingIntervalInMs,Ba)}Jch(xa){var Ba=this.interactivityTrackerService;if(Ba){const pc=Ba.jJe();if(pc){Ba=this.Dbb.get(xa);const nd=new ne(pc);Ba.subscribeCallTreeCustomPropertiesRetriever(nd);Ba=new Se(Ld=>{pc.startCollectingSlowActions(Ld)},Object(S.a)(pc,pc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.KId.set(xa,
Ba);return Ba}e.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}e.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}Zfi(){this.dPf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.cPf=new Map;this.KId=new Map;this.Dbb=new Map}Skf(xa){return!!xa}vEj(){return!Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6967854_ESNextEnabled")}}
Object(b.a)(ed,"JsSelfProfilerManager",null,[477,2]);class Rc extends dc.a{constructor(xa){super();this.$=xa;this.Fb()}create(){e.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");const xa=yb.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Ya);gb.TaskExtensions.za(xa,()=>{this.$.da.$a(443,Ba=>{this.Lch(xa.result,Ba)})},this.$.ka,3)}Lch(xa,Ba){gb.TaskExtensions.za(Kb.c(xa.kn.loadScript("officeOnlineCpuProfiling")),()=>{const pc=Object(sd.a)(this.$.da,
437,()=>new ed(this.$,Ba));this.nb(pc)},this.$.ka,3)}static la(xa){xa.da.Ga(438,new Rc(xa))}}Object(b.a)(Rc,"JsSelfProfilerManagerFactory",dc.a,[]);class Fd{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(b.a)(Fd,"ActionData",null,[]);class Nd{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(b.a)(Nd,"BlockedEngagementInfo",null,[]);class zd extends Fd{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(b.a)(zd,
"SuccessfulActionData",Fd,[]);class Sd{constructor(){this.successfulActions=[]}}Object(b.a)(Sd,"SuccessfulEngagementInfo",null,[]);var se=a(44);class He{constructor(xa){this.rKa=new Set;this.KOb=null;this.uYe=this.Rbg=!1;this.ug=()=>{this.rzi();this.KOb=Rd.a.instance.create(()=>{this.QDb()},He.pMj,Da.a.QDb)};this.yc=()=>{this.QDb()};this.lHb=(Ba,pc)=>{Ba=this.mqb.blockedActions.length;const nd=pc.details?pc.actionName+"_"+pc.details:pc.actionName;pc=Object(Bb.a)(new Fd,{order:Ba+1,name:nd,componentName:pc.componentName,
timeFromNavigationStart:pc.timeFromNavigationStart});this.mqb.blockedActions.push(pc)};this.rJd=()=>{this.$.Xc(2009315810,-1,0,null);this.uUd=!1};this.mqb=new Nd;this.mqb.hasBlockedActions=!1;this.rfb=new Sd;this.eFh();this.$=xa;this.$.ea.Xk(this.ug);this.$.Xj(this.yc);this.sMj=0;this.uUd=!1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.FGe=new Promise(Ba=>{this.R9g=Ba}))}dispose(){this.$.ea&&this.$.ea.jo(this.ug);this.$.Jl(this.yc);yc.a.Ia(this.KOb);
this.$=this.KOb=null}qbj(xa,Ba,pc){if(void 0!==xa&&null!==xa&&Ba){var nd=this.rfb.successfulActions.length+1,Ld="InputMethod"in Ba?Ba.InputMethod:"",te="IsCommand"in Ba&&Ba.IsCommand;if(this.Lti(xa,Ba,Ld,te)){Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerformanceSurveys",!1)&&this.sMj++===He.H_j?(this.uUd=!0,this.m2i=Rd.a.instance.create(this.rJd,5E3,Da.a.rJd)):this.uUd&&this.m2i.tq();if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const af=
!te&&xa;this.uYe||af===ob.a.Llg||af===ob.a.Mlg||af===ob.a.Ilg||af===ob.a.Jlg||(this.uYe=!0,this.R9g(void 0))}nd>He.Duf||(xa=Object(Bb.a)(new zd,{order:nd,name:xa,componentName:"Location"in Ba?Ba.Location:"",timeFromNavigationStart:pc,inputMethod:Ld,isCommand:te}),this.rfb.successfulActions.push(xa),1===nd?this.iAi():nd===He.Duf&&this.QDb())}}}abj(xa){se.a(this.$).o0b(this.lHb);this.mqb.hasBlockedActions=!0;this.lHb(null,xa)}rzi(){e.ULS.sendTraceTag(254546634,0,50,`${H.c(this.mqb)}`)}iAi(){qb.PageLoadTrackingInfo.instance.gwa(new Date)>
He.rFh?e.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${H.c(this.rfb.successfulActions[0])}`):e.ULS.sendTraceTag(254563592,0,50,`${H.c(this.rfb.successfulActions[0])}`)}QDb(){!this.Rbg&&this.rfb.successfulActions.length&&(this.Rbg=!0,yc.a.Ia(this.KOb),this.KOb=null,this.$.sendBeaconTraceTag(254559496,50,!1,H.c(this.rfb)))}eFh(){this.rKa.add(ob.a.PVc);this.rKa.add(ob.a.zQd);this.rKa.add(ob.a.DHd);this.rKa.add(ob.a.HNf);this.rKa.add(ob.a.JNf);this.rKa.add(ob.a.LNf)}Lti(xa,Ba,
pc,nd){pc=!pc||"unknown"===pc;const Ld="IsSystemInitiated"in Ba&&Ba.IsSystemInitiated;Ba="NoReporting"in Ba&&Ba.NoReporting;const te=this.rKa.has(xa);xa=ua.a.equals(xa,ob.a.mxc,!0)&&pc;return!Ld&&!Ba&&!te&&!xa&&!(nd&&pc)}}He.Duf=10;He.rFh=6E4;He.pMj=12E4;He.H_j=25;Object(b.a)(He,"PageLoadEngagementInfo",null,[476]);class Gd extends dc.a{constructor(xa){super();this.$=xa;this.Fb()}create(){this.nb(this.$.da.Aa(432)||this.$.da.Ga(432,new He(this.$)))}static la(xa){xa.da.Ga(433,new Gd(xa))}}Object(b.a)(Gd,
"PageLoadEngagementInfoFactory",dc.a,[]);var fe=a(54),$d=a(135),qe=a(517),pe=a(38),Ne=a(74),Le=a(423),gf=a(35),Ye=a(236);class $e extends Sys.EventArgs{constructor(xa){super();this.VU=xa}}Object(b.a)($e,"ErrorDataArgs",Sys.EventArgs,[]);var Ya=a(645),ra=a(110),ya=a(28);class mb{constructor(xa,Ba){this.ZSb=null;this.r7b=this.Cmd=!1;this.Hje=this.Ije=null;this.j6a=this.i6a=0;this.G0f=xa;this.Wge=Ba}get SKf(){return this.Wge}get LLb(){return this.Ije}get F0f(){return this.Hje}get kvi(){return this.Yze(this.G0f.getTime())}get B0i(){return this.Yze(this.F0f.getTime())}get o7f(){return!(this.r7b||
void 0===window.bsqmXLSPageLoadStartTime)}get V2c(){try{return this.ZSb||(this.ZSb=ra.toUtc(window.bsqmXLSPageLoadStartTime)),this.ZSb}catch(xa){return null}}set V2c(xa){this.ZSb=xa}ryj(xa){this.r7b||(this.Ije=xa,this.Hje=ra.toUtc(this.LLb))}tbi(xa){if(xa.Values&&(!this.i6a||!this.j6a))try{xb.a.Fcf in xa.Values&&(this.i6a=parseInt(xa.Values[xb.a.Fcf].toString(),10));xb.a.Gcf in xa.Values&&(this.j6a=parseInt(xa.Values[xb.a.Gcf].toString(),10));const Ba=z.a.instance;0<this.i6a&&(this.srf(this.i6a,"PageLoadFromHostClick"),
Ba.ubj(this.i6a));0<this.j6a&&(this.srf(this.j6a,"PageLoadFromHostFrameCreation"),Ba.vbj(this.j6a));const pc=xa.Values[xb.a.wbi]||0,nd=xa.Values[xb.a.ubi]||xa.Values[xb.a.vbi]||0;0<nd&&Ba.cbj(nd);Ba.dbj(pc)}catch(Ba){}}$lj(){this.G0f=this.V2c=ya.a.Qa.zb;this.Wge=0;this.Cmd=this.r7b=!1}Yze(xa){const Ba=this.V2c.getTime();return Ba>=xa?0:xa-Ba+this.SKf}srf(xa,Ba){if(xa){const pc=gc.b();pc.uOb("UserAction",Ba,Ba,ya.a.pEb(xa),Ya.EcmaDateClock.instance.appStart);pc.Dub(Ba,ra.toTimestamp(this.LLb))}}}Object(b.a)(mb,
"PageLoadPerfInfo",null,[]);var Hb=a(71);class Zb{constructor(xa,Ba,pc){this.BTc=xa.keyCode;this.wMb(xa.ctrlKey,1);this.wMb(xa.shiftKey,2);this.wMb(xa.altKey,4);this.wMb(Hb.b(xa),8);this.wMb(pc,16);this.BTc=this.gfb|Ba<<24}get gfb(){return this.BTc}get keyCode(){return this.gfb&65535}wMb(xa,Ba){xa&&(this.BTc=this.gfb|Ba<<16)}}Object(b.a)(Zb,"ShortcutSqmData",null,[]);class mc{constructor(){this.yxd=null;this.F5g={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.vYf()}A0g(xa,Ba,pc){0===
pc&&(pc=this.F5g[Ba.toString()]);return mc.n7f(xa,pc)&&(xa=new Zb(xa,pc,n.a.isMac),!gf.a.zg(this.yxd,xa.gfb.toString()))?(this.yxd[xa.gfb.toString()]=!0,xa):null}vYf(){this.yxd={}}static pni(xa){return 112<=xa&&123>=xa||61440<=xa&&61451>=xa}static Eoi(xa){return 17!==xa&&18!==xa&&16!==xa&&91!==xa&&93!==xa}static n7f(xa,Ba){let pc=xa.ctrlKey||xa.altKey||Hb.b(xa);xa=xa.keyCode;pc=mc.pni(xa)||pc;pc=mc.Eoi(xa)&&pc;return 0!==Ba&&pc}}Object(b.a)(mc,"UnhandledShortcutLogger",null,[]);class Pc{constructor(xa){this.M4b=
[];this.tQg=null;this.sqmManager=xa}y_b(xa){this.M4b.push(xa)}k6(xa,Ba,pc){try{if(Ba)Ba.endTime=pc,this.sqmManager.cpe(Ba);else for(let nd=0,Ld=this.M4b.length;nd<Ld;nd++){const te=this.M4b[nd];xa?(te.endTime=te.startTime,te.IEe=0):te.endTime=pc;this.sqmManager.cpe(te)}}catch(nd){}finally{this.M4b.length=0}}}Object(b.a)(Pc,"UserInteractionPerfInfo",null,[]);var fd=a(36),id=a(70),Dd=a(233);class Zd extends Ma.a{constructor(xa,Ba){super();this.rld=this.MKb=!1;this.q7f=!0;this.Ra=new pe.a;this.hJc=!1;
this.yc=()=>{const pc=id.a(this.$).hd.activityState,nd=gf.a.zg(pc,fd.a.Hoe);gf.a.zg(pc,fd.a.Snb)||nd||this.upload()};this.$=xa;this.$wb=Ba;this.ea=xa.ea;this.$.Xj(this.yc);this.Hgg=new mc;this.kQa=new mb(qa.a.QPd,xa.va.PageGenerationMetrics.TimeToCompleteFirstFlush);this.KEc=new Pc(this)}fXc(xa){this.Ra.addHandler("EREK",xa)}kMd(xa){this.Ra.removeHandler("EREK",xa)}get lhh(){return this.hJc}get Dhi(){return this.$.frame.mR?Zc.a.Fhi:Zc.a.Ehi}get workbookContext(){return this.$.workbookContext}get eU(){Zd.Mhb||
(Zd.Mhb=this.QPe());Zd.T_c||(Zd.T_c=!0,this.wef());return Zd.Mhb}set eU(xa){Zd.Mhb=xa;Zd.Mhb||(Zd.T_c=!1)}get o3(){return Ne.a(this.$.va,3)}dispose(){this.lhh&&h.AFrameworkApplication.Tn&&h.AFrameworkApplication.Tn.disable();this.$&&this.$.Jl(this.yc);this.$=this.KEc=this.kQa=this.eU=null;super.dispose()}x$e(xa){this.kQa.tbi(xa);this.pAi()}lRd(xa){this.setDw(9415,xa)}y_b(xa){this.KEc.y_b(xa)}k6(xa,Ba,pc){this.KEc.k6(xa,Ba,pc)}Xwd(xa){if(this.o3){const Ba=this.ea.isNamedObjectViewMode&&1===this.workbookContext.NovMode;
xa=this.$.isEditMode||xa&&this.ea.workbookContext.Options&512?2:Ba?9:this.ea.dc.inEmbedView?14:1;this.setDw(8721,xa);this.iHh(xa);this.hJc=!1}}Grf(){const xa=this.kQa;this.o3&&xa.o7f&&(this.setDw(9450,xa.SKf),this.setDw(9085,xa.kvi))}Hrf(xa){if(!this.MKb){this.MKb=!0;const Ba=this.kQa;let pc=0;this.o3&&Ba.o7f?(Ba.ryj(xa),this.KEc.tQg=Ba.F0f,this.setDw(9086,Ba.B0i),Ba.r7b=!0,pc=this.kQa.LLb.getTime()):pc=xa.getTime();gb.TaskExtensions.za(this.$wb.value,nd=>{nd.result.Rj(Tb.a.mQg,{[xb.a.nQg]:pc})},
this.ka,3)}}cpe(xa){this.o3&&xa&&1!==xa.sea&&this.dha(8327,Ye.b(xa),Ye.l(xa),Ye.a(xa),2,xa.IEe,Ye.m(xa),Ye.d(xa),Ye.e(xa))}oNd(xa,Ba){xa&&xa.MessageIdHash&&this.nNd(xa.MessageIdHash,xa.MessageIdName,xa.MessageId,xa.ErrorCause?xa.ErrorCause:fe.a.eDc,!1,Ba,xa,null)}nNd(xa,Ba,pc,nd,Ld,te,af,Bf){Zd.appEncounteredFirstError||(Zd.appEncounteredFirstError=!0,$d.a.get_instance().isCompleted(13)||($d.a.get_instance().Xt(13),e.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));
xa=this.Mub(xa);const Pf=!!af,Ef={};Ef.ErrorName=Ba;Ef.ErrorHashCode=xa.toString();Ef.ErrorId=pc.toString();Ef.ErrorCause=nd.toString();Ef.ErrorType=0===te?"ErrorDialog":"BusinessBar";Ef.BusinessBarEntryName=Bf||"null";Ef.ServerCorrelationId=Pf?af.CorrelationId:"null";Ef.WebMethodName=Pf?af.WebMethodName:"null";Ef.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Ef.WfeServerId=Pf?af.WfeServerId:"null";Ba=Ed.a.hc(Ef);this.Ra.raiseEvent("EREK",new $e(Ef));e.ULS.sendTraceTag(1881314,
0,15,Ba);this.o3&&(T.a.dSf(xa.toString()),this.dha(9134,xa,nd,fe.a.l0d),this.ea.Fv||Ld||(this.setDw(10459,xa),this.Xwd(!0),this.rld=!0,this.upload(),this.wef()))}Mub(xa){return 5439488|(xa>>>16^xa&65535)&65535}rxd(xa,Ba,pc){xa=this.Hgg.A0g(xa,Ba,pc);this.o3&&xa&&this.dha(11007,xa.gfb)}upload(){!this.o3||!this.MKb&&!this.rld||n.a.Jf&&h.AFrameworkApplication.Og?n.a.Jf&&h.AFrameworkApplication.Og&&e.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.eU.RQb(),this.hJc=!0);
h.AFrameworkApplication.Tn=this.eU=null;this.kQa.$lj();this.MKb=!1;h.AFrameworkApplication.Tn=this.eU=this.QPe();this.Hgg.vYf()}pAi(){const xa=this.kQa;if(this.o3&&!xa.Cmd){var Ba=xa.i6a,pc=xa.j6a,nd=xa.LLb.getTime();h.AFrameworkApplication.YM=xa.LLb;Ba&&this.setDw(10324,Ba>nd?0:nd-Ba);pc&&this.setDw(10325,pc>nd?0:nd-pc);xa.Cmd=!0}}dha(xa,...Ba){this.o3&&this.eU.dha(xa,...Ba)}setDw(xa,Ba){this.o3&&this.eU.setDw(xa,Ba)}QPe(){Le.a.nQe(this.$.va);return h.AFrameworkApplication.Tn}iHh(xa){let Ba;try{Ba=
Object(I.a)(Object,Ed.a.ki(h.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(pc){e.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${pc.message}`);return}if(Ba){let pc=Object(I.a)(String,Ba.ApplicationModeExtended),nd=Object(I.a)(String,Ba.ApplicationMode);pc&&nd&&(pc=pc.toUpperCase(),2!==xa&&16!==xa||"VIEW"!==pc&&"UNIFIED"!==pc?1!==xa||"EDIT"!==pc&&"UNIFIED"!==pc||(pc="VIEW",nd="View"):(pc="EDIT",nd="Edit"),Ba.ApplicationModeExtended=pc,Ba.ApplicationMode=
nd,h.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=Ed.a.hc(Ba))}}wef(){const xa=this.$.va;this.eU.nR=!0;this.eU.GQb(xa.BWsaStartTime);this.setDw(59,83);this.MKb=!1;if(this.o3){const Ba=xa.DocumentHostInfo;this.Nfh();this.setDw(8491,this.$.GG);this.setDw(9236,xa.RequestedUILcid);this.setDw(8473,xa.WacHostId);this.setDw(9902,Ye.c(Ba.ClusterId));Na.EwaSettings.ma(447)?this.eU.J3f(""):this.eU.J3f(xa.FlightHolder?xa.FlightHolder.FlightId:"");this.lRd(this.ea.dc.inEmbedView?1:0);this.rld=!1;
this.setDw(9104,Ye.c(Ba.FileSourceId));this.setDw(10309,this.Dhi);this.nAj();h.AFrameworkApplication.ub.oTf(qe.a.getInstance(!1))}}nAj(){z.a.instance.uei(this.eU);if(this.q7f){const xa=z.a.instance;xa.Xaj();xa.obj();xa.nbj();xa.mbj();xa.ibj();this.q7f=!1}}Nfh(){this.createStream(8327,1,Dd.a.ejh,Dd.a.n2a);this.createStream(9134,1,3,Dd.a.n2a);this.createStream(11007,1,1,Dd.a.n2a)}createStream(xa,Ba,pc,nd){this.eU.createStream(xa,Ba,pc,nd)}}Zd.Mhb=null;Zd.T_c=!1;Zd.appEncounteredFirstError=!1;Object(b.a)(Zd,
"SqmManager",Ma.a,[151,457]);var bc=a(739);class Qc{constructor(xa,Ba=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=xa;this.buffered=Ba}}Object(b.a)(Qc,"PerformanceObserverInit",null,[]);class pd extends Sys.EventArgs{constructor(xa){super();this.qQe=xa}}Object(b.a)(pd,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class ce extends Sys.EventArgs{constructor(xa){super();this.Dgc=xa}}Object(b.a)(ce,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class ke{constructor(xa){this.Ra=
new pe.a;this.AMc=!1;this.ug=()=>{if(n.a.Bp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.wCi)).observe(new Qc([Zc.a.Bxd])),this.AMc=!0)}catch(Ba){this.AMc=!1,e.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Ba}`)}this.Ra.raiseEvent("ltpoiek",new ce(this.Dgc))}};this.wCi=Ba=>{this.Ra.raiseEvent("ltoek",new pd(Ba))};this.$=xa;this.$.ea.tg?this.ug(this,Sys.EventArgs.Empty):this.$.ea.Xk(this.ug)}get Dgc(){return this.AMc}Dre(xa){this.Ra.addHandler("ltoek",
xa)}whj(xa){this.Ra.removeHandler("ltoek",xa)}mMg(xa){this.Ra.addHandler("ltpoiek",xa)}xhj(xa){this.Ra.removeHandler("ltpoiek",xa)}dispose(){this.$.ea.jo(this.ug);yc.a.Ia(this.Ra);this.$=this.Ra=null}}Object(b.a)(ke,"LongTaskPerformanceObserver",null,[2]);var Oe=a(172);class Fe{constructor(xa=0,Ba=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=xa;this.longTaskDuration=Ba}get Exd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:
0}gui(xa){return 100*this.Exd>xa}SJg(xa){this.vqe(xa.longTaskDuration);this.QWc(xa.activeSessionDuration)}vqe(xa){this.longTaskDuration+=xa}QWc(xa){this.activeSessionDuration+=xa}}Object(b.a)(Fe,"LongTaskPerformanceData",null,[]);class Xe{constructor(xa,Ba,pc,nd,Ld){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=xa;this.entireSessionData=Ba;this.worstWindowData=pc;this.postBootWindowData=nd;this.maxUsersCount=
Ld}get reportName(){return"LongTaskPerformance"}static get Eqh(){return new Xe(!1,new Fe,new Fe,new Fe,0)}}Object(b.a)(Xe,"LongTaskPerformanceDataStatistics",null,[537]);class pf extends Sys.EventArgs{constructor(xa){super();this.Cxd=xa}}Object(b.a)(pf,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Ae=a(380),Ie=a(288);class Hf{constructor(xa,Ba){this.Ra=new pe.a;this.iOa=this.n6=this.PS=this.De=null;this.nof=this.MUd=this.lkc=!1;this.MOa=null;this.maxUsersCount=0;this.Kpc=(pc,nd)=>{pc=nd.qQe.getEntriesByType(Zc.a.Bxd);
for(const Ld of pc)this.De.BD(Ld.duration)||h.AFrameworkApplication.RNa||(this.PS.vqe(Ld.duration),this.Ra.raiseEvent("lttek",new pf(Ld)),pc={},pc.LongTaskDuration=Ld.duration,pc.LongTaskStartTime=Ld.startTime,e.ULS.sendTraceTag(187982418,0,50,JSON.stringify(pc)))};this.ug=()=>{this.MUd=!0;this.PAc()};this.LB=(pc,nd)=>{nd&&(this.maxUsersCount=Math.max(this.maxUsersCount,nd.a2d));this.n6.maxUsersCount=this.maxUsersCount};this.ed=()=>{this.PAc()};this.yc=()=>{this.ebg()};this.OEf=(pc,nd)=>{nd.Dgc&&
this.PAc()};this.ksf=()=>{this.PS.QWc(ra.getElapsedMilliseconds(this.iOa,ya.a.Qa.zb));this.PWd(!0);var pc=!1;this.n6.postBootWindowData.activeSessionDuration?(!this.nof&&Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.zkg&&gc.b().qXf(2),V.Health.instance.recordKpiUsage(Ie.a.longJsTask,0,Ae.a.lvi,null),this.nof=!0),!this.n6.isVetoSession&&this.PS.gui(this.wlg)&&(this.n6.isVetoSession=!0,Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.zkg&&gc.b().rXf(2,this.uCi),V.Health.instance.recordKpiFailure(Ie.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.n6.worstWindowData.Exd<=this.PS.Exd&&(this.n6.worstWindowData=this.PS),this.n6.entireSessionData.SJg(this.PS)):(this.n6.postBootWindowData=new Fe(this.PS.activeSessionDuration,this.PS.longTaskDuration),pc=!0);const nd={};nd.LastWindowScore=this.PS;nd.postBootWindow=pc;nd.CoauthersNumber=this.$.ea.Xm.length;pc=JSON.stringify(nd);e.ULS.sendTraceTag(20779346,0,50,pc);this.PS=
new Fe};this.Coc=()=>{this.De.si||h.AFrameworkApplication.RNa||this.PWd(!1)};this.Boc=()=>{this.PS.QWc(ra.getElapsedMilliseconds(this.iOa,ya.a.Qa.zb));this.iOa=null;this.MOa.cancel()};this.$=xa;this.wlg=xa.va.LongTaskPerformanceVetoThreshold;this.uCi="PercentageOver_"+this.wlg.toString();this.Dxd=xa.va.LongTaskPerformanceWindowDurationInMs;this.QN=Ba;this.zkg=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.$a(291,pc=>{this.De=pc;this.PAc()});this.$.ea.tg?this.ug(this,
Sys.EventArgs.Empty):this.$.ea.Xk(this.ug);this.QN.mMg(this.OEf);this.$.ll(this.ed);this.$.Xj(this.yc)}nMg(xa){this.Ra.addHandler("lttek",xa)}yhj(xa){this.Ra.removeHandler("lttek",xa)}dispose(){this.MUd=!1;this.ebg();this.$.Kl(this.ed);this.$.Jl(this.yc);this.QN.xhj(this.OEf);yc.a.Ia(this.MOa);this.QN=this.$=this.MOa=null;void 0!==this.De&&null!==this.De&&yc.a.Ia(this.De)}PAc(){void 0===this.De||null===this.De?e.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):
this.QN.Dgc?this.lkc?e.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.MUd?(this.lkc=!0,this.n6=Xe.Eqh,this.PS=new Fe,this.$.ea.d$(this.LB),this.maxUsersCount=this.$.ea.Xm.length,this.QN.Dre(this.Kpc),this.De.EGa(this.Boc),this.De.FGa(this.Coc),h.AFrameworkApplication.WWc(this.Boc),h.AFrameworkApplication.XWc(this.Coc),this.MOa=Rd.a.instance.create(this.ksf,this.Dxd,Da.a.wrf,!1),ec.a(this.$).HY(this.n6),
this.De.si||h.AFrameworkApplication.RNa||this.PWd(!0),e.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):e.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):e.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}ebg(){this.lkc&&
(this.lkc=!1,this.$.ea.jo(this.ug),this.QN.whj(this.Kpc),this.$.ea.u7(this.LB),void 0!==this.De&&null!==this.De&&(this.De.Bcb(this.Boc),this.De.uRa(this.Coc)),h.AFrameworkApplication.YUf(this.Boc),h.AFrameworkApplication.ZUf(this.Coc),this.MOa.cancel(),this.iOa=this.PS=this.n6=null,this.maxUsersCount=0)}PWd(xa){xa||void 0===this.iOa||null===this.iOa?(this.iOa=ya.a.Qa.zb,this.MOa=Oe.AsyncMethodContext.Pdh(this.ksf,xa?this.Dxd:this.Dxd-this.PS.activeSessionDuration,Da.a.wrf,this.MOa)):e.ULS.sendTraceTag(589875356,
0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(b.a)(Hf,"LongTaskPerformanceTracker",null,[2]);class xe extends pe.a{constructor(xa,Ba){super();this.statusBarManager=this.De=null;this.PEf=(pc,nd)=>{nd.Cxd&&nd.Cxd.duration>=this.xCi&&(this.xsf++,this.Nof=nd.Cxd.duration)};this.$=xa;this.$.da.$a(29,pc=>{this.statusBarManager=pc;pc.HJ(this)});this.$.da.$a(291,pc=>{this.De=
pc});this.Nof=this.xsf=0;this.xCi=xa.va.LongTaskThresholdMs;this.A9a=Ba;this.A9a.nMg(this.PEf)}Jq(xa){this.addHandler("LTSCEK",xa)}dr(xa){this.removeHandler("LTSCEK",xa)}Pz(){this.Fn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}ps(xa,Ba){if("QueryLongTasksCount"!==xa)return!1;this.H8h(Ba);return!0}Fn(){return Na.EwaSettings.ma(574)}dispose(){this.statusBarManager&&(this.statusBarManager.jG(this),this.statusBarManager=null);this.A9a.yhj(this.PEf);super.dispose()}H8h(xa){xa.Value=`Long Tasks: ${this.xsf} | Last Task Duration: ${Math.round(this.Nof)}ms`}}
Object(b.a)(xe,"LongTasksStatusBarManager",pe.a,[2,281,185]);var Ze=a(11);class nf{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(b.a)(nf,"NetworkInfoData",null,[]);class hf extends pe.a{constructor(xa){super();this.statusBarManager=null;this.EWc=!1;this.Fxf=()=>{this.raiseEvent("NetworkInformation")};this.$=xa;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.c0=this.O_d("connection")||
this.O_d("mozConnection")||this.O_d("webkitConnection"))&&Na.EwaSettings.ma(463)&&xa.da.$a(29,Ba=>{this.statusBarManager=Ba;Ba.HJ(this);this.c0.addEventListener("change",this.Fxf);this.EWc=!0})}Jq(xa){this.addHandler("NetworkInformation",xa)}dr(xa){this.removeHandler("NetworkInformation",xa)}e5a(){return this.c0?Object(Bb.a)(new nf,{bandwidthMps:this.c0.downlink,rttMs:this.c0.rtt,connectionType:this.c0.type,effectiveConnection:this.c0.effectiveType,downlinkMaxMps:this.c0.downlinkMax}):null}ps(xa,
Ba){if("QueryNetworkInformation"!==xa)return!1;this.I8h(Ba);return!0}Fn(){return this.EWc}dispose(){this.EWc&&(this.statusBarManager&&(this.statusBarManager.jG(this),this.statusBarManager=null),this.c0&&this.c0.removeEventListener("change",this.Fxf));this.$=null;super.dispose()}O_d(xa){return Ze.HelperMethods.En(window.navigator,xa)?window.navigator[xa]:null}I8h(xa){xa.Value="Network: "+this.c0.downlink.toString()+" Mbps, "+this.c0.rtt.toString()+" ms"}}Object(b.a)(hf,"NetworkInformationManager",
pe.a,[281,185]);var bb=a(187),Lb=a(21);class nc{constructor(xa="",Ba=-1,pc=-1,nd=-1,Ld=!1,te=!0,af=!0,Bf=!1,Pf="",Ef=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=xa;this.startTime=Ba;this.startToNextFrame=pc;this.startToResponseRenderEnd=nd;this.wasHidden=Ld;this.isUserOperation=te;this.isGroupBreaking=
af;this.operationThatLedToLogging=Pf;this.startToOperationThatLedToLogging=Ef;this.isPartOfGroup=Bf}}Object(b.a)(nc,"OperationStatisticsData",null,[]);var Lc=a(79);class od{constructor(){this.operationsGroups=null;this.Odi()}isGroup(xa,Ba,pc){const nd=new bb.a;nd.addRange(xa);nd.addRange(Ba);for(let Ld=0;Ld<this.operationsGroups.count;Ld++)if(this.bqi(this.operationsGroups.na(Ld),nd,pc))return e.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${pc}' is part of a group ( operationsList: ${this.zKf(xa)} , frameOperationsList: ${this.zKf(Ba)})`),
!0;e.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${pc}' is NOT part of a group.`);return!1}bqi(xa,Ba,pc){let nd=0;for(let Ld=0;Ld<Ba.count;Ld++)if(Ba.na(Ld).isGroupBreaking){if(xa.count<=nd||!ua.a.equals(Ba.na(Ld).name,xa.na(nd),!0))return!1;nd++}return xa.count>nd&&ua.a.equals(pc,xa.na(nd),!0)}zKf(xa){xa=Lc.select(xa,Ba=>Ba.name);return`[${Lc.toArray(xa).join(", ")}]`}Odi(){this.operationsGroups=new bb.a;let xa;this.vZa((xa=new bb.a,xa.add("Paste"),xa.add("SelectingRange_unknown"),
xa));let Ba;this.vZa((Ba=new bb.a,Ba.add("AutoSum"),Ba.add("SelectingRange_unknown"),Ba));let pc;this.vZa((pc=new bb.a,pc.add("ChangeSheetDirection"),pc.add("ActiveItemChanged"),pc));let nd;this.vZa((nd=new bb.a,nd.add("InsertSheet"),nd.add("ActiveItemChanged"),nd.add("SelectingRange_unknown"),nd));let Ld;this.vZa((Ld=new bb.a,Ld.add("DeleteSheet"),Ld.add("DialogButtonClick"),Ld.add("ActiveItemChanged"),Ld.add("SelectingRange_unknown"),Ld));let te;this.vZa((te=new bb.a,te.add("EditBoxEndEdit"),te.add("SetCell"),
te.add("SelectingRange_keyboard"),te.add("MoveDownWithinSelectionOrCommitEdit"),te))}vZa(xa){this.operationsGroups.add(xa)}}Object(b.a)(od,"OperationsGroupDetector",null,[]);var wd=a(25);class Pd{constructor(xa,Ba,pc,nd){this.framePerformanceTracker=this.zKb=this.o0=this.g1=null;this.lkj=()=>{this.vYc=-1;const Ld=Ze.HelperMethods.Tb();this.FZj(Ld);Na.EwaSettings.ma(364)&&(this.ULb&&(e.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.HQb(this.kF,Ld),this.ULb=!1),this.Dic&&(this.HQb(this.PD,Ld),this.ULb||this.HQb(this.kF,Ld)));window.setTimeout(this.nAi,0)};this.nAi=()=>{var Ld=[];const te=this.$.va.OperationToPrevOperationThreshold;for(var af=0;af<this.kF.count;af++){var Bf=this.kF.na(af);af<te&&Ld.push(Bf);this.PD.add(Bf)}Lb.h(this.$)&&Lb.h(this.$).Da?((af=this.sessionStatisticsManager.Yfd(0))?(Bf=JSON.stringify(this.WDb),Ld=JSON.stringify(Ld),e.ULS.sendTraceTag(237798547,1,50,`DOM count: (${af.hGi}, ${af.STg}, ${af.TEi}), long tasks: ${Bf}, operations count: ${this.kF.count}, operations: ${Ld}`)):
e.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.kF.count>te&&e.ULS.sendTraceTag(537153875,1,50,`More than ${te} operations are in the operationsList. count: ${this.kF.count}`),this.kF.clear(),this.WDb.clear()):e.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Kpc=(Ld,te)=>{this.vCi(te.qQe)};this.$=xa;this.NI=Ba;this.Ph=this.Ph||ya.a.Qa;this.PD=new bb.a;this.kF=new bb.a;this.vYc=this.T8a=-1;this.WDb=new bb.a;this.operationsGroupDetector=
new od;this.ULb=this.Dic=!1;this.kei();this.Qdi();this.Pdi();this.sessionStatisticsManager=pc;this.QN=nd;this.QN.Dre(this.Kpc);this.$.da.$a(263,Ld=>{this.framePerformanceTracker=Ld})}IKb(xa,Ba){var pc=Ze.HelperMethods.Tb();const nd=Na.EwaSettings.ma(364)?this.operationsGroupDetector.isGroup(this.PD,this.kF,xa):!1;this.Dic=this.wkf(xa);Na.EwaSettings.ma(364)?this.Dic&&0<this.PD.count&&!nd&&(this.KYj(),this.Zig(xa,pc),this.NYe()):0<this.PD.count&&this.wkf(xa)&&(this.Zig(xa,pc),this.NYe());this.T8a=
-1;if(Lb.h(this.$)&&Lb.h(this.$).Da){var Ld=!this.g1.contains(xa);pc=new nc(xa,pc,void 0,void 0,void 0,Ld,this.Dic,nd);this.kF.add(pc);this.framePerformanceTracker&&this.framePerformanceTracker.GKj(pc.name,Ba);Na.EwaSettings.ma(364)&&!this.ULb&&this.zKb.contains(xa)&&(this.ULb=!0);-1===this.vYc&&(this.vYc=window.requestAnimationFrame(this.lkj))}else e.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}wvc(){this.T8a=Ze.HelperMethods.Tb()}Cvc(){this.PD.count||this.kF.count?(this.HQb(this.kF,
this.T8a),this.HQb(this.PD,this.T8a)):e.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.T8a}`);this.T8a=-1}wkf(xa){return!this.o0.contains(xa)&&!xa.includes("Menu")&&!xa.includes("TellMe")}NYe(){for(let xa=0;xa<this.PD.count;xa++){const Ba=this.PD.na(xa);this.NI.JFg(Ba);this.UAi(Ba)}this.PD.clear()}FZj(xa){for(let Ba=0;Ba<this.kF.count;Ba++)this.kF.na(Ba).startToNextFrame=this.Shd(this.kF.na(Ba).startTime,xa),this.kF.na(Ba).wasHidden=
bc.a.BD(this.kF.na(Ba).startToNextFrame)}Zig(xa,Ba){for(let pc=0;pc<this.PD.count;pc++)-1===this.PD.na(pc).startToResponseRenderEnd&&(this.PD.na(pc).operationThatLedToLogging=xa,this.PD.na(pc).startToOperationThatLedToLogging=this.Shd(this.PD.na(pc).startTime,Ba))}KYj(){var xa=!1;for(let Ba of this.PD)if(Ba.isPartOfGroup){xa=!0;break}if(xa)for(xa=0;xa<this.PD.count;xa++)this.PD.na(xa).isPartOfGroup=this.PD.na(xa).isGroupBreaking}HQb(xa,Ba){for(let pc=0;pc<xa.count;pc++)xa.na(pc).startToResponseRenderEnd=
this.Shd(xa.na(pc).startTime,Ba),xa.na(pc).wasHidden=bc.a.BD(xa.na(pc).startToResponseRenderEnd)}UAi(xa){xa=JSON.stringify(xa);e.ULS.sendTraceTag(2020372336,1,50,`${xa}`)}Shd(xa,Ba){return-1===xa?-1:-1===Ba?-2:Ba-xa}vCi(xa){xa=xa.getEntriesByType(Zc.a.Bxd);for(let Ba=0;Ba<xa.length;Ba++)if(30>this.WDb.count)if(this.kF.count)this.WDb.add(this.k2i(xa[Ba]));else{const pc=xa[Ba];if(null===pc||void 0===pc?0:pc.attribution)void 0!==pc.attribution.containerSrc&&null!==pc.attribution.containerSrc&&(pc.attribution.containerSrc=
""),void 0!==pc.attribution.containerId&&null!==pc.attribution.containerId&&(pc.attribution.containerId=""),void 0!==pc.attribution.containerName&&null!==pc.attribution.containerName&&(pc.attribution.containerName="");e.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{e.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${xa.length} First long task: ${this.WDb.na(0)}`);break}}k2i(xa){return`name:${xa.name}, startTime:${xa.startTime}, duration:${xa.duration}`}kei(){this.g1||
(this.g1=new ib.a(eb.a.ak()),this.g1.add("ActiveItemChanged"),this.g1.add(gc.b().uj(-1398645260)),this.g1.add(gc.b().uj(722290388)),this.g1.add(gc.b().uj(974713501)),this.g1.add(wd.a.QQ(wd.a.B4b)),this.g1.add(wd.a.QQ(wd.a.A4b)),this.g1.add(wd.a.QQ(wd.a.Jrb)),this.g1.add(wd.a.QQ(wd.a.tPf)),this.g1.add(wd.a.QQ(wd.a.Cna)))}Qdi(){this.o0||(this.o0=new ib.a(eb.a.ak()),this.o0.add("PromptEditInBrowser"),this.o0.add(gc.b().uj(-1398645260)),this.o0.add(gc.b().uj(722290388)),this.o0.add(gc.b().uj(974713501)),
this.o0.add(wd.a.QQ(wd.a.B4b)),this.o0.add(wd.a.QQ(wd.a.A4b)),this.o0.add(wd.a.QQ(wd.a.Jrb)),this.o0.add(wd.a.QQ(wd.a.tPf)),this.o0.add(wd.a.QQ(wd.a.Cna)))}Pdi(){this.zKb||(this.zKb=new ib.a(eb.a.ak()),this.zKb.add("SelectingRange_keyboard"),this.zKb.add("SelectingRange_mouse"))}}Object(b.a)(Pd,"OperationStatistics",null,[]);var je=a(581);class be{constructor(xa,Ba){this.messageIdName=null;this.errorCause=0;this.messageIdName=xa;this.errorCause=Ba}}Object(b.a)(be,"RequestError",null,[]);class Qe{constructor(xa,
Ba,pc,nd,Ld,te,af,Bf,Pf,Ef,cg,Uf,ag,lg,Dg,vg,dg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=
0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=xa;this.isUserTriggeredRequest=Qe.VVh(xa);this.isFullyLoggedKPIRequest=Qe.QVh(xa);this.isPromotedUTRRequest=Qe.RVh(xa);this.requestDuration=Ba;this.totalOperationDuration=pc;this.requestTimeInQueue=nd;this.requestInvokedTime=Ld;this.ecsOperationDuration=te.EcsOperationDuration;this.EcsRequestDuration=te.EcsRequestDuration;this.WfeRequestDuration=
te.WfeRequestDuration;this.TimeFromLastEcsFreeze=te.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=te.DuringLoadOnDemand;this.correlationID=af;this.errors=Qe.$7g(Bf);this.httpStatus=Pf;this.requestResourceTiming=Ef;this.communicationErrorRetryCount=cg;this.successfulCall=Uf;this.isDocumentHidden=ag;this.coauthorsCount=lg;this.responseSize=Dg;this.networkInfoData=vg;this.responseToCallbackTime=dg}static $7g(xa){if(!xa)return[];const Ba=[];for(const pc of xa)Ba.push(new be(pc.MessageIdName,pc.ErrorCause));
return Ba}static VVh(xa){return!Qe.ZIi.contains(xa)}static fYh(){const xa=new ib.a(eb.a.ak());xa.add("CheckPersistedContentUpdate");xa.add("GetContentBundle");xa.add("GetSessionStatus");xa.add("GetStatusBarAggregates");xa.add("PollSessionStatus");xa.add("UpdatePresenceUsers");xa.add("UploadLatencyTelemetry");return xa}static QVh(xa){return Qe.JJh.contains(xa)}static RVh(xa){return Qe.l7i.contains(xa)}static wUh(){const xa=new ib.a(eb.a.ak());xa.add("SetRichTextCell");xa.add("Copy");xa.add("FormatCells");
xa.add("PasteRange");xa.add("FindCell");xa.add("ApplyToRangesV2");xa.add("ResizeRowsColumns");xa.add("InsertDeleteCells");xa.add("FillRange");xa.add("PasteHtmlContent");xa.add("ApplyFilter");xa.add("PasteString");xa.add("Undo");xa.add("LineageUpdateView");xa.add("FindAll");xa.add("ApplyHyperlink");xa.add("AutoFit");xa.add("GetPrintSettings");xa.add("GetEdgeCell");xa.add("Paste");xa.add("MoveAndResizeFloatingObject");xa.add("FindRange");xa.add("SetCustomFilter");xa.add("RenameSheet");xa.add("ApplyThreadedComment");
xa.add("SortFilterColumn");xa.add("InsertCopiedCutCells");xa.add("InsertSheet");xa.add("ToggleAutoFilter");xa.add("ReorderSheets");xa.add("SetOutlineLevel");xa.add("RefreshAll");xa.add("LineageOpenPaneOrChangeFilter");xa.add("ApplySlicerSelection");xa.add("GetCardViewCardByCell");xa.add("AutoSum");xa.add("LineageClosePane");xa.add("Sort");xa.add("ClearAutoFilter");xa.add("DeleteSheet");xa.add("Redo");Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(xa.add("RemovePageBreak"),
xa.add("InsertPageBreak"),xa.add("SetPrintArea"),xa.add("ClearPrintArea"));return xa}static SVh(){const xa=new ib.a(eb.a.ak());xa.add("DeleteConditionalFormattingRules");xa.add("GetConditionalFormattingRules");xa.add("AddConditionalFormattingRule");xa.add("QuickEditConditionalFormattingRule");xa.add("GetPrintSettings");xa.add("UpdatePresenceUsers");xa.add("GetThemeInfo");xa.add("InsertCopiedCutCells");xa.add("PasteRange");Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&
(xa.add("LineageOpenPaneOrChangeFilter"),xa.add("LineageUpdateView"),xa.add("LineageRefreshView"),xa.add("LineageLoadMore"));return xa}}Qe.ZIi=Qe.fYh();Qe.JJh=Qe.wUh();Qe.l7i=Qe.SVh();Object(b.a)(Qe,"RequestStatisticsData",null,[]);class jc{constructor(xa,Ba,pc){this.$=xa;this.NI=Ba;this.ema=pc}Hvc(xa,Ba,pc,nd,Ld,te,af,Bf,Pf,Ef,cg,Uf,ag,lg){Uf=je.a(Uf);xa=new Qe(xa,Ba,pc,nd,Ld,te,af,Bf,Pf,Uf,Ef,cg,bc.a.BD(Ba),this.thd(null),ag,this.ema.e5a(),lg);this.FNd(xa)}gh(xa,Ba){xa="UnknownMethodName";let pc=
-1;void 0!==Ba.context&&null!==Ba.context&&(xa=Ba.context.methodName,pc=Ba.context.communicationErrorRetryCount);let nd,Ld={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Ba.nd?(nd=Ba.nd.Errors||[],this.NI.dkj(Ba.nd.EditSessionIsDirty),void 0!==Ba.nd.RequestTelemetryData&&null!==Ba.nd.RequestTelemetryData&&(Ld=Ba.nd.RequestTelemetryData)):nd=[];const te=Ba.duration,af=je.a(Ba.url);Ba=new Qe(xa,te,Ba.totalOperationDuration,Ba.cZd,
Ba.MF,Ld,Ba.WQd,nd,Ba.httpStatus,af,pc,!0,bc.a.BD(te),this.thd(Ba.nd),Ba.responseSize,this.ema.e5a(),Ba.responseToCallbackTime);this.FNd(Ba)}zm(xa,Ba){xa="UnknownMethodName";let pc=-1;void 0!==Ba.context&&null!==Ba.context&&(xa=Ba.context.methodName,pc=Ba.context.communicationErrorRetryCount);const nd=Ba.duration,Ld=je.a(Ba.url);Ba=new Qe(xa,nd,Ba.totalOperationDuration,Ba.cZd,Ba.MF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},
Ba.WQd,Ba.errors||[],Ba.httpStatus,Ld,pc,!1,bc.a.BD(nd),this.thd(null),-1,this.ema.e5a(),Ba.responseToCallbackTime);this.FNd(Ba)}FNd(xa){this.NI.jPg(xa);if(Na.EwaSettings.ma(226)){var Ba=xa.requestName;if(Ba!==Zc.a.fwa&&"SetCell"!==Ba&&"FindRange"!==Ba&&"FindAll"!==Ba&&"FindCell"!==Ba)return}Ba=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===xa.requestName||null===xa.requestName)&&xa.isPromotedUTRRequest;jc.Koh(xa,Ba);this.NI.KFg(xa)}thd(xa){var Ba;if(null===
(Ba=null===xa||void 0===xa?void 0:xa.CollaborationResult)||void 0===Ba?0:Ba.Users)return xa.CollaborationResult.Users.length;xa=this.$.ea.Xm.length;return 0<xa?xa:1}static Koh(xa,Ba){Ba?gc.b().yxc(388829456,0,15,xa):(Ba=Sys.Serialization.JavaScriptSerializer.serialize(xa),e.ULS.sendTraceTag(388829456,0,50,Ba));if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==xa.requestName&&null!==xa.requestName&&xa.isFullyLoggedKPIRequest){Ba=new Map;Ba.set("isUserTriggeredRequest",
xa.isUserTriggeredRequest.toString());Ba.set("requestDuration",xa.requestDuration.toString());Ba.set("totalOperationDuration",xa.totalOperationDuration.toString());Ba.set("requestTimeInQueue",xa.requestTimeInQueue.toString());Ba.set("requestInvokedTime",xa.requestInvokedTime.toString());Ba.set("ecsOperationDuration",xa.ecsOperationDuration.toString());Ba.set("ecsRequestDuration",xa.EcsRequestDuration.toString());Ba.set("wfeRequestDuration",xa.WfeRequestDuration.toString());Ba.set("timeFromLastEcsFreeze",
xa.TimeFromLastEcsFreeze.toString());Ba.set("duringLoadOnDemand",xa.DuringLoadOnDemand.toString());Ba.set("correlationID",xa.correlationID);Ba.set("errors",xa.errors.toString());Ba.set("httpStatus",xa.httpStatus.toString());if(xa.networkInfoData){var pc=xa.networkInfoData;Ba.set("networkInfoData_bandwidthMps",void 0===pc.bandwidthMps||null===pc.bandwidthMps?"NA":pc.bandwidthMps.toString());Ba.set("networkInfoData_rttMs",void 0===pc.rttMs||null===pc.rttMs?"NA":pc.rttMs.toString());Ba.set("networkInfoData_effectiveConnection",
void 0===pc.effectiveConnection||null===pc.effectiveConnection?"NA":pc.effectiveConnection)}xa.requestResourceTiming&&(pc=xa.requestResourceTiming,Ba.set("requestResourceTiming_fetchStart",void 0===pc.downloadDuration||null===pc.downloadDuration?"NA":pc.downloadDuration.toString()));Ba.set("communicationErrorRetryCount",xa.communicationErrorRetryCount.toString());Ba.set("successfulCall",xa.successfulCall.toString());Ba.set("isDocumentHidden",xa.isDocumentHidden.toString());Ba.set("coauthorsCount",
xa.coauthorsCount.toString());Ba.set("responseSize",xa.responseSize.toString());Ba.set("responseToCallbackTime",xa.responseToCallbackTime.toString());gc.b().Evc(xa.requestName,xa.successfulCall,Ba)}}}Object(b.a)(jc,"RequestStatistics",null,[]);var Tc=a(207),ub=a(60),Vb=a(316);class tc{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(b.a)(tc,
"OperationTypeStatisticsData",null,[]);class Sc{constructor(xa,Ba){this.data=new tc;this.data.operationName=xa;this.data.isUserOperation=Ba;this.data.totalCount=0;this.xag=[];this.yag=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}ud(xa){this.data.totalCount<Sc.x9c&&(this.xag.push(xa.startToNextFrame),this.yag.push(xa.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<
xa.startToNextFrame&&(this.data.longestStartToNextFrame=xa.startToNextFrame);this.data.longestStartToResponse<xa.startToResponseRenderEnd&&(this.data.longestStartToResponse=xa.startToResponseRenderEnd)}Dcd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.I5e(this.xag),this.data.startToResponsePercentiles=this.I5e(this.yag))}I5e(xa){xa.sort(Ze.HelperMethods.HB);let Ba;Ba="("+bc.a.Mva(xa,25).toString();Ba=Ba+", "+bc.a.Mva(xa,50).toString();Ba=Ba+", "+bc.a.Mva(xa,75).toString();
Ba=Ba+", "+bc.a.Mva(xa,95).toString();return Ba+")"}}Sc.x9c=1E3;Object(b.a)(Sc,"OperationTypeStatistics",null,[]);class jd{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=
this.requestDurationPercentile25=0}}Object(b.a)(jd,"RequestTypeStatisticsData",null,[]);class pb{constructor(xa){this.data=new jd;this.data.requestName=xa;this.data.totalCount=0;this.Wcb=[];this.i_d=this.a_d=this.b_d=this.f_d=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}Ikj(xa){this.data.totalCount<pb.x9c&&this.Wcb.push(xa.requestDuration);this.data.totalCount++;this.f_d+=xa.requestDuration;this.b_d+=pb.bfd(xa.ecsOperationDuration);this.a_d+=pb.bfd(xa.EcsRequestDuration);this.i_d+=pb.bfd(xa.WfeRequestDuration);0<xa.TimeFromLastEcsFreeze&&xa.TimeFromLastEcsFreeze<pb.xJh&&this.data.callsDuringEcsFreeze++;xa.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;xa.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||
null===this.data.longestRequest||this.data.longestRequest.requestDuration<xa.requestDuration)this.data.longestRequest=xa}Dcd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.f_d/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.b_d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.a_d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.i_d/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=
0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Wcb.sort(Ze.HelperMethods.HB),this.data.requestDurationPercentile25=bc.a.Mva(this.Wcb,25),this.data.requestDurationPercentile50=bc.a.Mva(this.Wcb,50),this.data.requestDurationPercentile75=bc.a.Mva(this.Wcb,75),this.data.requestDurationPercentile95=bc.a.Mva(this.Wcb,95))}static bfd(xa){return 0>xa?0:xa}}pb.xJh=3E3;pb.x9c=1E3;Object(b.a)(pb,"RequestTypeStatistics",null,[]);class Rb{constructor(xa,Ba,pc,nd,Ld,te,af,Bf){this.mode=null;
this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=xa;this.ocsCapable=Ba;this.endedBySplashScreen=pc;this.dirtySessionOnLastRecordedRequest=nd;this.loadOnDemandCount=Ld;this.maxCoauthorsCount=te;this.everConnectedToOcs=af;xa=[];for(let Pf in Bf)Ba=Bf[Pf],Ba.Dcd(),xa.push(Ba.data);this.requests=xa}}Object(b.a)(Rb,"SessionStatisticsData",null,[]);class oc{constructor(xa){this.dirtySessionOnLastRecordedRequest=
this.KWd=!1;this.oqf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=xa;this.Bnb={};this.Anb={};this.u7c={}}yc(){var xa=this.Ngh();if(qa.a.cea()){var Ba={};Ba.xlendJson=xa;this.$.Rna(Tc.a.Q3j,Ba,!1)}else ub.N(this.$.pa.ya,xa,null,null,null,null,null);xa=this.Ogh();qa.a.cea()?(Ba={},Ba.xlenoJson=xa,this.$.Rna(Tc.a.R3j,Ba,!1)):e.ULS.sendTraceTag(388776782,0,50,xa);Na.EwaSettings.ma(68)&&(xa=this.gbh(),qa.a.cea()?(Ba={},Ba.xlencJson=xa,this.$.Rna(Tc.a.P3j,Ba,!1)):e.ULS.sendTraceTag(388776770,
0,50,xa));this.olj()}mkc(){this.everConnectedToOcs=this.$.ea.A8a||this.everConnectedToOcs;V.Health.instance&&V.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}ug(){const xa=new Vb.a;let Ba="";const pc=!this.$.isAnonymousUser(),nd=xa.te();if(nd){if(pc){xa.qyc("UMI_Linkable","true");return}Ba=xa.$4a("UMI_Linkable")}pc||e.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${nd}, UMIIsLinkable:${!!Ba}`)}Ucb(){this.KWd=
!0}dkj(xa){this.dirtySessionOnLastRecordedRequest=xa}jPg(xa){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,xa.coauthorsCount);V.Health.instance&&V.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}KFg(xa){if(!(xa.requestName in this.Bnb)){const Ba=new pb(xa.requestName);this.Bnb[xa.requestName]=Ba}this.Bnb[xa.requestName].Ikj(xa)}JFg(xa){if(!(xa.name in this.Anb)){const Ba=new Sc(xa.name,xa.isUserOperation);this.Anb[xa.name]=Ba}this.Anb[xa.name].ud(xa)}HY(xa){this.u7c[xa.reportName]=
xa}olj(){this.dirtySessionOnLastRecordedRequest=this.KWd=!1;this.oqf=this.$.ea.owd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.Bnb={};this.Anb={};this.u7c={}}Ngh(){const xa=new Rb(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.KWd,this.dirtySessionOnLastRecordedRequest,this.$.ea.owd-this.oqf,this.maxCoauthorsCount,this.everConnectedToOcs,this.Bnb);return Sys.Serialization.JavaScriptSerializer.serialize(xa)}Ogh(){var xa=new bb.a;const Ba=this.Anb;for(let pc in Ba){const nd=
Ba[pc];nd.Dcd();xa.add(nd.data)}xa=xa.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(xa)}gbh(){return Sys.Serialization.JavaScriptSerializer.serialize(this.u7c)}}Object(b.a)(oc,"SessionStatistics",null,[]);class Jc extends Ma.a{constructor(xa){super();this.zna=this.Nma=null;this.dKe=Array(1);this.ePc=this.Fxd=null;this.gh=(Ba,pc)=>{Na.EwaSettings.ma(39)&&(this.zna=this.zna||new jc(this.$,this.NI,this.ema),this.zna.gh(Ba,pc))};this.zm=(Ba,pc)=>{Na.EwaSettings.ma(39)&&(this.zna=this.zna||
new jc(this.$,this.NI,this.ema),this.zna.zm(Ba,pc))};this.yc=(Ba,pc)=>{Na.EwaSettings.ma(39)&&this.NI.yc(Ba,pc)};this.ug=(Ba,pc)=>{Na.EwaSettings.ma(39)&&this.NI.ug(Ba,pc)};this.mkc=(Ba,pc)=>{Na.EwaSettings.ma(39)&&this.NI.mkc(Ba,pc)};this.$=xa;Na.EwaSettings.ma(39)&&(bc.a.gei(this.$),this.QN=new ke(this.$),this.$ch(),Na.EwaSettings.ma(574)&&this.A9a&&(this.Fxd=new xe(this.$,this.A9a)),this.NI=new oc(this.$),this.ema=new hf(this.$),this.$.Xj(this.yc),this.$.pa.Kq(this.gh),this.$.pa.iw(this.zm),this.$.ea.tre(this.mkc),
Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Xk(this.ug))}get A9a(){return this.ePc}dispose(){this.$&&Na.EwaSettings.ma(39)&&(this.$.Jl(this.yc),this.$.pa.Mr(this.gh),this.$.pa.gx(this.zm),this.$.ea.GVf(this.mkc),Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.jo(this.ug));yc.a.Ia(this.ema);yc.a.Ia(this.A9a);this.ePc=null;yc.a.Ia(this.QN);this.QN=null;yc.a.Ia(this.Fxd);this.$=this.Fxd=null;super.dispose()}Ucb(){Na.EwaSettings.ma(39)&&
this.NI.Ucb()}Hvc(xa,Ba,pc,nd,Ld,te,af,Bf,Pf,Ef,cg,Uf,ag,lg){Na.EwaSettings.ma(39)&&(this.zna=this.zna||new jc(this.$,this.NI,this.ema),this.zna.Hvc(xa,Ba,pc,nd,Ld,te,af,Bf,Pf,Ef,cg,Uf,ag,lg))}IKb(xa,Ba){Na.EwaSettings.ma(39)&&(this.Nma=this.Nma||new Pd(this.$,this.NI,this,this.QN),this.Nma.IKb(xa,Ba))}wvc(){Na.EwaSettings.ma(39)&&(this.Nma=this.Nma||new Pd(this.$,this.NI,this,this.QN),this.Nma.wvc())}Cvc(){Na.EwaSettings.ma(39)&&(this.Nma=this.Nma||new Pd(this.$,this.NI,this,this.QN),this.Nma.Cvc())}HY(xa){Na.EwaSettings.ma(39)&&
this.NI.HY(xa)}Yfd(xa){return Na.EwaSettings.ma(39)?this.dKe[xa]:null}s3f(xa){xa&&(this.dKe[xa.type]=xa)}e5a(){return this.ema.e5a()}$ch(){n.a.Bp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.ePc=new Hf(this.$,this.QN))}}Object(b.a)(Jc,"SessionStatisticsManager",Ma.a,[11]);var ud=a(101),Fb=a(1117),pa=a(118),tb=a(127);class Nb{constructor(xa,Ba){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=xa;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=Ba}wZd(){return Ed.a.hc(this)}}Object(b.a)(Nb,"AppUnloadInfo",null,[]);var vc=a(693),Ic=a(121),kd=a(563);class xd{constructor(xa){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=xa.aEe+xa.zgg;this.dataLossReason=xa.fAe;this.IZg(xa.$1d)}IZg(xa){const Ba=new vc.a(kd.a.zK());let pc=0,nd=0;for(const Ld of xa)Ba.lb(Ld)||Ba.ia(Ld,0),xa=Ba.ia(Ld,Ba.na(Ld)+1),xa>
pc&&(pc=xa,nd=Ld);pc>this.mostCommonOperationCount&&(this.mostCommonOperationName=Ic.a(nd),this.mostCommonOperationCount=pc)}}Object(b.a)(xd,"DataLossInfo",null,[]);var ae=a(57);class oe{constructor(xa){this.DYc="AppUnloadInfo";this.Gm=this.$=this.workbookHashedId=this.iz=null;this.s5d=this.M8d=!1;this.Re=null;this.Idf=0;this.Yca=(Ba,pc)=>{this.Idf=pc.iCc};this.AJf=(Ba,pc)=>{pc.$1d.length&&this.$.AD&&(this.iz.dataLossInfo=new xd(pc),this.iz.wasDataLostDuringUnload=!0,this.vdb())};this.ug=()=>{this.P1f();
this.$.ea.jo(this.ug)};this.yPa=()=>{this.iz.wasUpdatedOnBeforeUnload=!0;this.iz.inactivityDurationBeforeUnloadSeconds=this.Re.Lfb<oe.iFi?this.Idf:this.Re.Lfb;this.Vig()};this.bHb=()=>{this.iz.wasUpdatedOnUnload=!0;this.Vig();Sys.Application.remove_unload(this.bHb)};this.AXi=()=>{this.iz.lastSilentReopenStartTime=ya.a.Qa.zb;this.iz.lastSilentReopenEndTime=null;this.vdb();this.$.ll(this.AIf)};this.AIf=()=>{this.iz.lastSilentReopenEndTime=ya.a.Qa.zb;this.vdb();this.$.Kl(this.AIf)};this.localStorage=
new Vb.a;this.localStorage.te()&&(this.$=xa,this.workbookHashedId=ae.a(this.$),this.iz=new Nb(this.workbookHashedId,this.$.va.UserSessionId),this.Gm=tb.a.instance.sH(),this.Gm.la("beforeunload",this.yPa),this.$.userOperationManager.bOg(this.AJf),xa.ea.tg?this.P1f():this.$.ea.Xk(this.ug),this.Re=this.$.ea.Re,this.Re.hha(this.Yca),Sys.Application.add_unload(this.bHb),this.$.ea.IXc(this.AXi))}get dialogPromptedOnUnload(){return this.M8d}set dialogPromptedOnUnload(xa){this.M8d=xa;this.iz?(this.iz.dialogPromptedOnUnload=
xa,this.vdb()):this.localStorage.te()&&e.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.te()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.s5d}set apiBeforeCloseNotificationEnabledOnUnload(xa){this.s5d=xa;this.iz?(this.iz.apiBeforeCloseNotificationEnabledOnUnload=xa,this.vdb()):this.localStorage.te()&&e.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.te()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.Uij(this.AJf);this.Re&&(this.Re.BAa(this.Yca),this.Re=null);this.Gm.hD();this.$=this.Gm=null}Vig(){this.izj();this.vdb()}izj(){this.iz.wasOfflineDuringUnload=this.$.Te.E5;this.iz.timeFromLastConnectivity=pa.a(ya.a.Qa,this.$.Te.kpf);this.iz.timeFromLastDisconnectionStart=pa.a(ya.a.Qa,this.$.Te.Zvi);this.iz.disconnectionSource=Enum.toString(Fb.a,this.$.Te.disconnectionSource);this.iz.hadConnectivityIssuesDuringUnload=this.$.Te.dla;this.iz.timeFromLastStatusCode0=
pa.a(ya.a.Qa,this.$.Te.jpf)}vdb(){this.iz.timestamp=Date.now();this.localStorage.qyc(this.DYc,this.iz.wZd())}P1f(){const xa=this.localStorage.$4a(this.DYc);if(xa)try{const Ba=Ed.a.ki(xa);this.localStorage.QJb(this.DYc);const pc=this.CDi(Ba);e.ULS.sendTraceTag(574677456,0,50,pc)}catch(Ba){e.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Ba.message}`)}else e.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}CDi(xa){const Ba=
{};Ba.WACSessionID=xa.wacSessionId;Ba.wasRefreshed=this.v2g(xa,this.$.va.MaxAppReloadDurationIndicatingRefresh);Ba.closedWithDialogConfirmation=xa.dialogPromptedOnUnload;Ba.wasOfflineDuringUnload=xa.wasOfflineDuringUnload;Ba.TimeFromLastConnectivityMs=xa.timeFromLastConnectivity;Ba.TimeFromLastDisconnectionStart=xa.timeFromLastDisconnectionStart;Ba.wasDataLostDuringUnload=xa.wasDataLostDuringUnload;Ba.DataLossInfo=xa.dataLossInfo;Ba.flushedOnUnload=xa.wasUpdatedOnUnload;Ba.flushedOnBeforeUnload=xa.wasUpdatedOnBeforeUnload;
Ba.InactivityDurationBeforeUnload=xa.inactivityDurationBeforeUnloadSeconds;Ba.DisconnectionSource=xa.disconnectionSource;Ba.hadConnectivityIssuesDuringUnload=xa.hadConnectivityIssuesDuringUnload;Ba.TimeFromLastStatusCode0=xa.timeFromLastStatusCode0;Ba.LastSilentReopenStartTime=xa.lastSilentReopenStartTime;Ba.LastSilentReopenEndTime=xa.lastSilentReopenEndTime;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Ba.ApiBeforeCloseNotificationEnabledOnUnload=
xa.apiBeforeCloseNotificationEnabledOnUnload);return H.c(Ba)}v2g(xa,Ba){const pc=window.performance.timing.navigationStart-xa.timestamp;(xa=this.workbookHashedId===xa.workbookHashedId&&pc<Ba)&&e.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return xa}static la(xa){xa.ea.dc.inWebPart||xa.da.Ga(410,new oe(xa))}}oe.iFi=10;Object(b.a)(oe,"AppUnloadTelemetryManager",null,[547,2]);var ve=a(171),Ge=a(109);class ye{constructor(xa,Ba){this.stopped=!1;this.chainedCallsTracer=
xa;this.Jsg=Ba}get call(){return this.Jsg}Yag(){e.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.zLj(this))}dispose(){this.Yag()}}Object(b.a)(ye,"CallMeasureContext",null,[493,2]);class qf{constructor(xa,Ba){this.Dbd=0;this.JVe=this.startTime=Ze.HelperMethods.Tb();this._name=xa;this.yC=Ba}get name(){return this._name}get type(){return this.yC}N8g(){this.JVe=
Ze.HelperMethods.Tb()}Vag(){this.Dbd+=Ze.HelperMethods.Tb()-this.JVe}yVh(){return Ze.HelperMethods.Tb()-this.startTime}sLj(){this.Vag();return this.Dbd}}Object(b.a)(qf,"MeasuredCall",null,[]);class Ja{constructor(xa){this.Zsa=[];this.I1c=null;this.cGi=100;this.documentVisibilityObserver=null;this.bGi=xa}kag(xa,Ba){this.udh();this.vLj();xa=new qf(xa,Ba);this.Zsa.push(xa);return new ye(this,xa)}udh(){0<this.Zsa.length?e.ULS.shipAssertTag(537151054,1,!!this.I1c,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):
this.I1c=ve.a.create().toString()}zLj(xa){const Ba=this.Zsa.pop();if(xa.call!==Ba)e.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",xa.call.name,Ba?Ba.name:"null"),this.Zsa=[];else{xa=Ba.yVh();var pc=Ba.sLj();e.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var nd=
this.documentVisibilityObserver?this.documentVisibilityObserver.BD(xa+this.cGi):null;this.aAi(Ba,xa,pc,nd);this.O8g()}}vLj(){const xa=this.c4e();xa&&xa.Vag()}O8g(){const xa=this.c4e();xa&&xa.N8g()}c4e(){return this.Zsa.length?this.Zsa[this.Zsa.length-1]:null}aAi(xa,Ba,pc,nd){if(!(Ba<this.bGi)){var Ld=Ge.f(this.Zsa,te=>te.name).join();e.ULS.sendTraceTag(537151051,0,50,`ChainedCallsTracer: Inclusive duration: ${Ba.toFixed(2)} Exclusive duration: ${pc.toFixed(2)} Chain ID: ${this.I1c} Call ID: ${xa.name} Type: ${xa.type} Document hidden: ${nd} Call chain: ${Ld}`)}}static la(xa){if(Na.EwaSettings.ma(668)){var Ba=
new Ja(xa.va.ChainedCallsTracerMinThresholdToLogInMs);xa.da.$a(291,pc=>{Ba.documentVisibilityObserver=pc});xa.da.Ga(425,Ba);pe.a.Buj(Ba)}}}Object(b.a)(Ja,"ChainedCallsTracer",null,[460]);var Db=a(520);class rc{constructor(xa){this.De=null;this.$Qj=Ba=>{const pc={["TaskName"]:Ba.TN,["TotalRunInMs"]:Ba.TRT,["TotalDelayInMs"]:Ba.TDT,["TotalQueueInMs"]:Ba.TQT,["TaskPriority"]:Ba.TP,["CoauthorsCount"]:this.ea.Xm.length};Ba.TDT>this.lZd||Ba.TRT>this.jZd?e.ULS.sendTraceTag(321938518,0,15,D.a.toJSON(pc)):
(Ba.TDT>this.kZd||Ba.TRT>this.iZd)&&e.ULS.sendTraceTag(321938508,0,50,D.a.toJSON(pc))};this.vFh=Ba=>this.De.BD(Ba.TRT+Ba.TQT+3E3)?!1:Ba.TDT>Math.min(this.kZd,this.lZd)||Ba.TRT>Math.min(this.iZd,this.jZd);this.lZd=xa.va.TimeToReportOnLongWaitingTaskInMsAsWarning;this.kZd=xa.va.TimeToReportOnLongWaitingTaskInMsAsMedium;this.jZd=xa.va.TimeToReportOnLongRunningTaskInMsAsWarning;this.iZd=xa.va.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=xa.ea;xa.da.$a(291,Ba=>{this.De=Ba});e.ULS.sendTraceTag(537151046,
0,50,`TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = ${this.kZd}, TimeToReportOnLongWaitingTaskInMsAsWarning = ${this.lZd}, TimeToReportOnLongRunningTaskInMsAsMedium = ${this.iZd}, TimeToReportOnLongRunningTaskInMsAsWarning = ${this.jZd}`)}}Object(b.a)(rc,"TaskEventProcessor",null,[]);const Yc=xa=>{e.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");gb.TaskExtensions.za(Db.a.jr(Va.a.instance.Ub("Common.ICpuMeterProvider")),
Ba=>{e.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");gb.TaskExtensions.za(Ba.result.xk.task,pc=>{e.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");const nd=new rc(xa);pc.result.pWc(0,nd.vFh,nd.$Qj)},xa.ka,3)},xa.ka,3)};var qd=a(13);class Od{constructor(xa){this.OKe=!1;this.QKe=null;this.Pc=()=>{this.Noj();Lb.h(this.$).ha&&Lb.h(this.$).ha.DI(this.Pc)};
this.Gh=(Ba,pc)=>{pc.oa&&!this.RYd.has(pc.oa.name)&&(this.RYd.add(pc.oa.name),Lb.h(this.$).ha&&(Lb.h(this.$).ha.DI(this.Pc),Lb.h(this.$).ha.PE(this.Pc)))};this.$=xa;this.ldg=new Set;this.RYd=new Set;this.$.xa&&this.$.xa.oa&&this.RYd.add(this.$.xa.oa.name);Lb.h(this.$).ha.PE(this.Pc);this.$.xa.Xf(this.Gh)}dispose(){this.$=null}Noj(){this.QKe||this.QZg();const xa=Lb.d(Lb.h(this.$));if(!this.OKe){const Ba=qd.a.instance.Ua(281).split(",");xa.push(...Ba);this.OKe=!0}for(const Ba of xa)Ba&&!this.ldg.has(Ba)&&
(this.kAi(Ba),this.ldg.add(Ba))}kAi(xa){this.P_g(xa)}QZg(){this.QKe=Od.V4a("monospace");Od.V4a("sans-serif");Od.V4a("serif")}P_g(xa){Od.V4a(`${xa},${"monospace"}`);Od.V4a(`${xa},${"sans-serif"}`);Od.V4a(`${xa},${"serif"}`)}static la(xa){if(Na.EwaSettings.ma(61)){const Ba=new Od(xa);xa.da.Ga(210,Ba)}}static V4a(xa){const Ba=document.createElement("div"),pc=document.createElement("div");Ba.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Od.Uyj(pc,xa);document.body.appendChild(Ba);
Ba.appendChild(pc);Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7190190_ReduceInnerHTMLUsageForFontTelemetryManager")?pc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+":pc.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";xa=pc.offsetWidth+"x"+pc.offsetHeight;document.body.removeChild(pc.parentNode);return xa}static Uyj(xa,Ba){xa.style.cssText=
"display: inline; visibility: hidden;";xa.style.fontSize="100px";xa.style.fontWeight="normal";xa.style.fontStyle="normal";xa.style.letterSpacing="normal";xa.style.lineHeight="normal";xa.style.whiteSpace="nowrap";xa.style.fontFamily=Ba}}Object(b.a)(Od,"FontTelemetryManager",null,[2]);var ie=a(235),le=a(161),bf;(function(xa){xa[xa.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";xa[xa.reactSingleLineRibbon=1]="reactSingleLineRibbon";xa[xa.reactMultiLineRibbon=2]="reactMultiLineRibbon";xa[xa.invalid=
3]="invalid"})(bf||(bf={}));Object(b.b)("RibbonMode",bf);var Ce=a(105);class uf extends pe.a{constructor(){super();this.mM=!1;this.nde=this.mde=null;this.aDd=()=>{this.Mig()};this.RUi=()=>{yc.a.Ia(this.wZ);yc.a.Ia(this.Gm)};this.wZ=tb.a.instance.HIa();this.Gm=tb.a.instance.sH();this.wZ.la("visibilitychange",this.aDd);this.Gm.la("pagehide",this.RUi);this.Mig()}get si(){return this.mM}get Aof(){return this.mde}get Rkc(){return this.nde}EGa(xa){this.addHandler("ekdh",xa)}Bcb(xa){this.removeHandler("ekdh",
xa)}FGa(xa){this.addHandler("ekduh",xa)}uRa(xa){this.removeHandler("ekduh",xa)}BD(xa){return this.si?!0:this.Rkc?ra.getElapsedMilliseconds(this.Rkc,ya.a.Qa.zb)<xa:!1}dispose(){yc.a.Ia(this.wZ);yc.a.Ia(this.Gm);super.dispose()}Mig(){this.mM="hidden"===window.document.visibilityState;this.si?(this.raiseEvent("ekdh"),this.mde=ya.a.Qa.zb):(this.raiseEvent("ekduh"),this.nde=ya.a.Qa.zb)}}Object(b.a)(uf,"DocumentVisibilityObserver",pe.a,[524,2]);class rf{constructor(){this.longFramesOverThresholdOpsPercentage=
this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(b.a)(rf,"FramePerformanceData",null,[]);class De{constructor(xa){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new rf;this.l2FramePerformanceData=new rf;this.l3FramePerformanceData=new rf;this.name=xa}}Object(b.a)(De,"FramePerformanceDataGroup",null,[]);class If{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName=
"FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(b.a)(If,"FramePerformanceSessionEndsReport",null,[537]);class Tf{constructor(xa){this.sFd={};this.lha=null;this.Egb=(Ba,pc)=>{Ba.longFramesOverThresholdOps++;Ba.maxLongFrameDuration=Math.max(Ba.maxLongFrameDuration,pc)};this.kf=new If;this.Ldh();xa.da.$a(276,()=>{ec.a(xa).HY(this.kf)})}Ldh(){this.lha=new De("AllGridOperationsData");this.kf.operationsGroups.push(this.lha);this.Hsb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.Hsb("DragScroll",["DragScroll"]);this.Hsb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.Hsb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.Hsb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}Bkj(xa,Ba,pc,nd){const Ld=this.sUh(xa);Ld&&(Ge.b(this.kf.operationsGroups,te=>ua.a.equals(te.name,Ld.name,!1))||this.kf.operationsGroups.push(Ld),Ld.count++,this.eEc(Ba,Ld),this.aEc(pc,Ld),this.lha.count++,
this.eEc(Ba,this.lha),this.aEc(pc,this.lha),0<nd&&this.rYj(nd,Ld),0<=Ba&&this.IXj(Ba,Ld))}UYj(){for(const xa of this.kf.operationsGroups)Tf.MXj(xa)}Hsb(xa,Ba){xa=new De(xa);for(const pc of Ba)this.sFd[pc]=xa}sUh(xa){return xa in this.sFd?this.sFd[xa]:null}IXj(xa,Ba){30>xa&&this.G0d(pc=>{pc.l1FramePerformanceData.fpsUnderThresholdOps++},Ba);15>xa&&this.G0d(pc=>{pc.l2FramePerformanceData.fpsUnderThresholdOps++},Ba);5>xa&&this.G0d(pc=>{pc.l3FramePerformanceData.fpsUnderThresholdOps++},Ba)}rYj(xa,Ba){100<=
xa&&(this.Fgb(Ba.l1FramePerformanceData,xa,this.Egb),this.Fgb(this.lha.l1FramePerformanceData,xa,this.Egb));300<=xa&&(this.Fgb(Ba.l2FramePerformanceData,xa,this.Egb),this.Fgb(this.lha.l2FramePerformanceData,xa,this.Egb));600<=xa&&(this.Fgb(Ba.l3FramePerformanceData,xa,this.Egb),this.Fgb(this.lha.l3FramePerformanceData,xa,this.Egb))}G0d(xa,Ba){Ba&&(xa(Ba),xa(this.lha))}Fgb(xa,Ba,pc){xa&&pc(xa,Ba)}eEc(xa,Ba){Ba.minFPS=-1===Ba.minFPS?xa:Math.min(Ba.minFPS,xa)}aEc(xa,Ba){Ba.maxFPS=Math.max(Ba.maxFPS,
xa)}static MXj(xa){Tf.g1d(xa.l1FramePerformanceData,xa.count);Tf.g1d(xa.l2FramePerformanceData,xa.count);Tf.g1d(xa.l3FramePerformanceData,xa.count)}static g1d(xa,Ba){xa.fpsUnderThresholdOpsPercentage=100*xa.fpsUnderThresholdOps/Ba;xa.longFramesOverThresholdOpsPercentage=100*xa.longFramesOverThresholdOps/Ba}}Object(b.a)(Tf,"FramePerformanceSessionEndsReportManager",null,[]);class kg{constructor(){this.f=null}}Object(b.a)(kg,"FpsDataWrapper",null,[]);class ng{constructor(xa=-1,Ba=-1){this.duration=
this.startSecond=0;this.startSecond=xa;this.duration=Ba}}Object(b.a)(ng,"LongFrameData",null,[]);var fg=a(349);class ab{constructor(xa=null,Ba=0,pc=-1,nd=-1,Ld=0,te=-1,af=0,Bf=-1,Pf=-1,Ef=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=xa;this.count=Ba;this.start=pc;this.end=nd;this.Avg=Ld;this.Max=te;this.Min=fg.a.wog;this.longFrameCount=af;this.coauth=Bf||1;this.tfAppInt=Pf;this.Props=
Ef;this.LFrame=null}}Object(b.a)(ab,"OperationFPSData",null,[]);var zb=a(34),Xb=a(792);class xc extends Ma.a{constructor(xa){super();this.$ob=-1;this.evd=0;this.dya=new Date(0);this.UY=null;this.zia={};this.Mua=new bb.a;this.JOd=this.Y8a=!1;this.e4a=null;this.$Bc=this.s$a=0;this.isSynthetic=!1;this.FZe=()=>{const Ba=new Date;var pc=Ba.getMinutes();const nd=Ba.getSeconds();this.$Cb&&Ba.getTime()-this.$Cb.getTime()>this.LOj?(this.stop(),this.pdd(Ba)):(pc!==this.evd&&(this.pdd(Ba),this.evd=pc),this.Y8a&&
(this.De.si?this.UY[nd]=xc.m8b:(this.mMe(nd),this.Y8a=!1,this.Mua.clear(),this.zia={})),this.UY[nd]!==xc.m8b&&(this.UY[nd]++,pc=Ba.getTime()-this.dya.getTime(),pc>this.usf&&this.IAi(this.dya,pc)),this.$ob=window.requestAnimationFrame(this.FZe),this.dya=Ba)};this.gW=()=>{this.Y8a=!0};this.fzf=()=>{this.pause()};this.hzf=()=>{this.JOd&&this.resume()};this.Ij=()=>{this.Da.l5()&&this.AYj()};this.$Cb=new Date;this.De=new uf;this.De.EGa(this.gW);h.AFrameworkApplication.WWc(this.fzf);h.AFrameworkApplication.XWc(this.hzf);
this.$=xa;this.usf=xa.va.LongFrameThresholdMs;this.tCi="MoreThan_"+this.usf.toString()+"_Ms";this.KOj=xa.va.ThresholdToEndOperationTrackingSeconds;this.LOj=xa.va.ThresholdToStopFPSTrackingMS;this.Da=Lb.h(this.$).Da;h.AFrameworkApplication.Qb&&h.AFrameworkApplication.Qb.IsSynthetic&&(this.isSynthetic=ua.a.compare(h.AFrameworkApplication.Qb[Zc.a.isSynthetic],"True",!0)?!1:!0);this.Da.hw(this.Ij);this.bOd();this.JAi=this.$.lla&&Na.EwaSettings.ma(573)}start(){this.JOd=!0;this.resume()}stop(){this.JOd=
!1;this.pause()}dispose(){this.stop();this.De.Bcb(this.gW);h.AFrameworkApplication.YUf(this.fzf);h.AFrameworkApplication.ZUf(this.hzf);yc.a.Ia(this.De);this.Da.ex(this.Ij);super.dispose()}GKj(xa,Ba){const pc=xa in this.zia?this.zia[xa]:null;this.$Cb=new Date;this.start();const nd=this.$Cb.getSeconds(),Ld=nd+this.KOj;pc&&nd<=pc.end?(pc.count++,pc.end=Ld):(pc&&nd>pc.end&&this.Mua.add(pc),this.zia[xa]=new ab(xa,1,nd,Ld,void 0,void 0,void 0,this.$.ea.Xm.length,qb.PageLoadTrackingInfo.instance.gwa(this.$Cb),
Ba))}$bh(){this.e4a||(this.pdd(new Date),this.e4a=new Tf(this.$))}resume(){this.lif()||!this.Da.tL||this.isSynthetic||(this.Y8a=this.De.si,this.dya=new Date,this.evd=this.dya.getMinutes(),this.bOd(),this.mMe(this.dya.getSeconds()),this.$ob=window.requestAnimationFrame(this.FZe))}lif(){return 0<=this.$ob}pause(){this.lif()&&(this.Y8a||(this.nMe((new Date).getSeconds()),e.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.UY.toString()}`)),window.cancelAnimationFrame(this.$ob),this.$ob=-1)}pdd(xa){if(xa.getTime()-
this.dya.getTime()<xc.$Fi&&(this.Y8a&&this.nMe(this.dya.getSeconds()),this.Xqh(),0<this.Mua.count&&(xa={},xa.NonEmptyCellsCount=this.s$a,xa.TextCellsCount=this.$Bc,xa.xlfpsJson=Object(Bb.a)(new kg,{f:this.Mua.toArray()}),xa.memoryInfo=this.xFi(),xa.zoom=zb.a(this.$)?zb.a(this.$).zoom:1,xa.RibbonMode=le.a(this.$)?bf[le.a(this.$).BO]:xc.invalid,xa.deviceMemory=navigator.deviceMemory||0,xa.hardwareConcurrency=navigator.hardwareConcurrency||0,xa=JSON.stringify(xa),e.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.UY.toString()}`),
!this.isSynthetic))){if(qa.a.cea()){var Ba={};Ba.xlfpsJson=xa;this.$.Rna(Tc.a.S3j,Ba,!1)}else e.ULS.sendTraceTag(388781010,0,50,`${xa}`);if(this.JAi)for(let pc of this.Mua){Ba=1E3>=this.s$a?"0_1000":3E3>=this.s$a?"1000_3000":"3000_inf";const nd=new Map;nd.set("Operation",pc.Op);nd.set("BucketOfRenderedCells",Ba);V.Health.instance.recordKpiUsage(Ie.a.longFrame,0,Ae.a.canvas,nd);0<pc.longFrameCount&&V.Health.instance.recordKpiFailure(Ie.a.longFrame,"LongFrame",!1,!0,Object(Bb.a)(new G.a,{extendedProperties:nd}));
3E4<pc.tfAppInt&&(0<pc.longFrameCount?gc.b().oXf(0,this.tCi,nd):gc.b().pXf(0,nd))}e.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${xa.length}`)}this.reset()}xFi(){const xa={};if(window.performance){const Ba=window.performance.memory;Ba&&(xa.jsHeapSizeLimit=Ba.jsHeapSizeLimit,xa.usedJSHeapSize=Ba.usedJSHeapSize,xa.totalJSHeapSize=Ba.totalJSHeapSize)}return xa}reset(){this.Mua.clear();this.zia={};this.bOd()}Xqh(){if(this.UY){for(const xa of Xb.a(this.zia)){const Ba=this.zia[xa];Ba.end=
Math.min(this.UY.length-1,Ba.end);this.Mua.add(Ba)}this.b_g(this.Mua,this.UY)}}b_g(xa,Ba){for(let pc of xa){let nd=xa=0;if(pc.end<Ba.length){for(let Ld=pc.start;Ld<=pc.end;Ld++){const te=Ba[Ld];0<=te&&(pc.Max=Math.round(Math.max(pc.Max,te)),pc.Min=Math.round(Math.min(pc.Min,te)),xa+=te,nd++)}0<nd&&(pc.Avg=Math.round(xa/nd));this.e4a&&this.e4a.Bkj(pc.Op,pc.Min,pc.Max,pc.LFrame?pc.LFrame.duration:-1);pc.Props&&(this.vTj(pc),pc.Props=null)}}this.e4a&&this.e4a.UYj()}bOd(){this.UY=[0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}mMe(xa){xa++;for(let Ba=0;Ba<xa;Ba++)this.UY[Ba]=xc.m8b}nMe(xa){for(;60>xa;xa++)this.UY[xa]=xc.m8b}IAi(xa,Ba){xa=xa.getSeconds();var pc=Xb.a(this.zia);if(0<pc.length)for(const nd of pc)if(pc=this.zia[nd],xa>=pc.start&&xa<pc.end)pc.LFrame?pc.LFrame.duration<Ba&&(pc.LFrame.startSecond=xa,pc.LFrame.duration=Ba,pc.longFrameCount++):(pc.LFrame=new ng(xa,Ba),pc.longFrameCount++)}AYj(){this.$Bc=this.s$a=
0;for(const xa of Lb.h(this.$).Mn){const Ba=xa.OCa;for(let pc in Ba){const nd=this.Da.Fl(Ba[pc].hashCode);if(null===nd||void 0===nd?0:nd.Pk)this.s$a+=nd.ke.NonEmptyCellsCount,this.$Bc+=nd.ke.TextValueCellsCount}}}vTj(xa){const Ba=xa.Props;if(vb.a.wNb in Ba&&Ba[vb.a.wNb]&&vb.a.pPb in Ba){let pc;(pc=Object(I.a)(ie.a,Ba[vb.a.pPb]))&&pc.continueWith(nd=>{Ce.TextEditorTelemetry.instance.aIg(xa.Op,xa.Min,!!xa.LFrame,xa.LFrame?xa.LFrame.duration:0,nd.result)})}}}xc.m8b=-1;xc.$Fi=6E4;xc.invalid="Invalid";
Object(b.a)(xc,"FramePerformanceTracker",Ma.a,[482,2]);class Uc extends dc.a{constructor(xa){super();this.$=xa;this.Fb()}create(){let xa=this.$.da.Aa(263);xa||(xa=this.$.da.Ga(263,new xc(this.$)));this.nb(xa)}static la(xa){xa.da.Ga(264,new Uc(xa))}}Object(b.a)(Uc,"FramePerformanceTrackerFactory",dc.a,[]);var dd=a(1283),Cd=a(939);class de{Qg(xa,Ba){return new Cd.a(xa,Ba)}Bc(xa,Ba){xa=this.Qg(xa,Ba);xa.start();return xa}}Object(b.a)(de,"DefaultStopwatchBuilder",null,[156]);class Yd{constructor(){this.tqa=
new de}Qg(xa,Ba){return this.tqa.Qg(xa,Ba)}Bc(xa,Ba){return this.tqa.Bc(xa,Ba)}}Object(b.a)(Yd,"StopwatchBuilder",null,[156]);var vd=a(419),Re=a(1031),Te=a(926),l;(function(xa){xa[xa.actions=0]="actions";xa[xa.correlationStart=1]="correlationStart";xa[xa.reorderSheetOp=2]="reorderSheetOp";xa[xa.formatCellOp=3]="formatCellOp";xa[xa.copyOp=4]="copyOp";xa[xa.pasteOp=5]="pasteOp";xa[xa.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";xa[xa.instantaneousSetData=7]="instantaneousSetData";xa[xa.immediateSetData=
8]="immediateSetData";xa[xa.dependentCellsCalc=9]="dependentCellsCalc";xa[xa.dependentCellsGraphStat=10]="dependentCellsGraphStat";xa[xa.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";xa[xa.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";xa[xa.gridBlockUpdates=13]="gridBlockUpdates";xa[xa.browserAppStart=14]="browserAppStart";xa[xa.linkedObjects=15]="linkedObjects";xa[xa.longFrames=16]="longFrames";xa[xa.task=17]="task";xa[xa.conflictInEditing=18]="conflictInEditing";
xa[xa.incomingPresenceData=19]="incomingPresenceData";xa[xa.editorTableDelay=20]="editorTableDelay";xa[xa.presenceStartup=21]="presenceStartup";xa[xa.presenceDelete=22]="presenceDelete";xa[xa.editorEvent=23]="editorEvent";xa[xa.editorTime=24]="editorTime";xa[xa.gridScreenReaderOps=25]="gridScreenReaderOps";xa[xa.sendPresenceToService=26]="sendPresenceToService";xa[xa.IME=27]="IME";xa[xa.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";xa[xa.customizeStatusBar=29]="customizeStatusBar";xa[xa.clientWebRequests=
30]="clientWebRequests";xa[xa.showCommentTaskPane=31]="showCommentTaskPane";xa[xa.applyThreadedCommentChange=32]="applyThreadedCommentChange";xa[xa.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";xa[xa.findNextOrPreviousComment=34]="findNextOrPreviousComment";xa[xa.goto=35]="goto";xa[xa.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";xa[xa.richApiInvocation=37]="richApiInvocation";xa[xa.fxLibrary=38]="fxLibrary";xa[xa.embeddedApiSession=39]="embeddedApiSession";xa[xa.numberFormattingCalculator=
40]="numberFormattingCalculator";xa[xa.requestDataAfterSend=41]="requestDataAfterSend";xa[xa.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";xa[xa.copy=43]="copy";xa[xa.paste=44]="paste";xa[xa.dragDrop=45]="dragDrop";xa[xa.clearCopyState=46]="clearCopyState";xa[xa.webWorkerRecalcStats=47]="webWorkerRecalcStats";xa[xa.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";xa[xa.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";xa[xa.customSort=50]="customSort";
xa[xa.namedSheetViewUserAction=51]="namedSheetViewUserAction";xa[xa.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";xa[xa.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";xa[xa.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";xa[xa.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";xa[xa.namedSheetViewTempViewSaveDialog=56]="namedSheetViewTempViewSaveDialog";xa[xa.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";
xa[xa.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";xa[xa.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";xa[xa.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(l||(l={}));Object(b.b)("UsageTable",l);var Ob=a(425),qc=a(476),Ec=a(599),ld=a(646),yd=a(268);class Jd extends Sys.EventArgs{constructor(){super();this.sIi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(b.a)(Jd,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Ud{constructor(xa,
Ba=1){this.wPd=Ba;this.total=xa}get average(){return this.total/this.wPd}x5g(xa){return new Ud(this.total+xa.total,this.wPd+xa.wPd)}static kXg(xa,Ba){return`${xa}_${Ba}`}}Object(b.a)(Ud,"StopwatchAverage",null,[]);var ee;(function(xa){xa[xa.longFrame=0]="longFrame";xa[xa.longGetRange=1]="longGetRange";xa[xa.longJsTask=2]="longJsTask";xa[xa.viewportCalculationLoops=3]="viewportCalculationLoops"})(ee||(ee={}));Object(b.b)("UtrKpiVeto",ee);class Je{static B5a(xa){return Enum.toString(ee,xa)}}Je.kVa=
"UTR";Object(b.a)(Je,"KpiConstants",null,[]);class Ga{}Ga.Gkg="UTRVetoName";Ga.ykg="UTRErrorName";Ga.d0j="UTROperationName";Ga.d2d="UTRDuration";Ga.e0j="UTREndedInPhase";Ga.Dkg="UTRMessage";Ga.Fkg="UtrUnavailabilityType";Ga.operationName="OperationName";Ga.duration="Duration";Ga.message="Message";Object(b.a)(Ga,"UtrAdditionalData",null,[]);class Cb{}Cb.S1j="VetoLike";Cb.Zoh="E2EOperationPerf";Cb.elj="RequestPerf";Cb.qUj="UnavailabilityDurations";Object(b.a)(Cb,"UtrTypes",null,[]);class cc{HKb(xa,
Ba,pc=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(pc=pc?Object(Bb.a)(new G.a,{extendedProperties:pc}):null,xa=Je.B5a(xa),V.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+xa,Ba,!1,!0,"",pc))}oMb(xa,Ba,pc,nd,Ld,te){te[Je.kVa]=Cb.S1j;te[Ga.Gkg]=Je.B5a(nd);te[Ga.ykg]=Ld;e.ULS.sendTraceTag(xa,Ba,pc,Ed.a.hc(te));delete te[Je.kVa];delete te[Ga.Gkg];delete te[Ga.ykg]}}Object(b.a)(cc,"UtrKpiVetoReporter",null,[]);class uc{LKb(xa,Ba=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
V.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Je.B5a(xa),0,"",Ba)}HKb(xa,Ba,pc=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(xa=Je.B5a(xa),V.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+xa,Ba,!1,!0,this.t5c(pc)))}qkj(xa,Ba=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Je.B5a(xa),"",this.t5c(Ba))}pkj(xa,Ba,pc=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(xa=Je.B5a(xa),V.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+xa,Ba,!1,!0,"",this.t5c(pc)))}t5c(xa){return xa?Object(Bb.a)(new G.a,{extendedProperties:xa}):null}}Object(b.a)(uc,"UtrKpiVetoUsageReporter",null,[]);class Kc{xvc(xa,Ba,pc=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+xa,"",Object(Bb.a)(new G.a,{extendedProperties:pc,durationMs:Ba}))}Evc(xa,Ba,pc=null){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Ba?V.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+xa,"",Object(Bb.a)(new G.a,{extendedProperties:pc})):V.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+xa,"",!1,!1,"",Object(Bb.a)(new G.a,{extendedProperties:pc})))}lMb(xa,Ba,pc,nd,Ld,te,af,...Bf){af=String.format(af,...Bf);Bf={};Bf[Je.kVa]=Cb.Zoh;Bf[Ga.d0j]=nd;Bf[Ga.e0j]=Ld;Bf[Ga.d2d]=te;Bf[Ga.Dkg]=af;e.ULS.sendTraceTag(xa,Ba,pc,Ed.a.hc(Bf))}nMb(xa,Ba,pc,nd,Ld,te){this.E5f(te,nd,Ld);e.ULS.sendTraceTag(xa,Ba,pc,Ed.a.hc(te));
this.$jh(te)}mMb(xa,Ba,pc,nd,Ld,te,...af){te=String.format(te,...af);af={};this.E5f(af,nd,Ld,te);e.ULS.sendTraceTag(xa,Ba,pc,Ed.a.hc(af))}yxc(xa,Ba,pc,nd){nd[Je.kVa]=Cb.elj;e.ULS.sendTraceTag(xa,Ba,pc,Ed.a.hc(nd));delete nd[Je.kVa]}E5f(xa,Ba,pc,nd=null){xa[Je.kVa]=Cb.qUj;xa[Ga.Fkg]=Ba;xa[Ga.d2d]=pc;nd&&(xa[Ga.Dkg]=nd)}$jh(xa){delete xa[Je.kVa];delete xa[Ga.Fkg];delete xa[Ga.d2d]}}Object(b.a)(Kc,"UtrOperationPerfReporter",null,[]);class gd extends pe.a{constructor(xa,Ba=null,pc=null,nd=null,Ld=null,
te=!1){super();this.CCh=[vb.a.gye,vb.a.TQe,vb.a.UQe,vb.a.sgc,vb.a.Plc,vb.a.Bqf,vb.a.renderCachedContent,vb.a.renderServerContent,vb.a.A6b,vb.a.Lpj,vb.a.f0f,vb.a.g0f,vb.a.jtj];this.mmb=this.PDa=this.UQb=this.Pgb=this.uee=this.lxe=this.ZXa=this.qle=null;this.PLf=this.eye=!1;this.Ckg=this.Bkg=this.Ekg=this.ONd=this.Wlg=null;this.VGf=(af,Bf)=>{for(af=0;af<Bf.entries.length;af++){const Uf=Bf.entries[af];Uf.url=y.a.removeParameter(Uf.url,h.AFrameworkApplication.LP);var Pf=y.a.Gda(Uf.url);!Na.EwaSettings.ma(483)&&
this.Tqi(Uf.url,Pf)&&(Uf.behavior=1);if("img"===Uf.$t.initiatorType&&Pf.endsWith(Re.a.gOe)){var Ef=y.a.$Z(Uf.url,Re.a.fOe),cg=y.a.$Z(Uf.url,Re.a.hOe);Uf.haa=`${Uf.haa}imageID=${Ef}, imgStateID=${cg}`}Ef=Uf.$t.transferSize;let ag;cg=Uf.$t.decodedBodySize;void 0!==Ef&&null!==Ef&&void 0!==cg&&null!==cg?ag=0===Ef&&0<cg:void 0!==Ef&&null!==Ef&&(ag=0===Ef);qb.PageLoadTrackingInfo.instance.dJg(Pf,Math.round(Uf.$t.fetchStart),Math.round(Uf.$t.responseEnd),ag,this.zsi);ua.a.contains(Pf,vb.a.richTextEditor,
!0)&&(Pf=Ce.TextEditorTelemetry.instance,Pf.ME(vb.a.Fmj,Math.round(Uf.$t.fetchStart)),Pf.ME(vb.a.Hmj,Math.round(Uf.$t.responseEnd)))}};this.gW=()=>{const af=this.Z7;for(let Bf in af)af[Bf].h=!0};this.userSessionId=xa;this.G1a=Ba=Ba||new Ec.a;this.Ph=pc||ya.a.Qa;this.FLj=nd||this;this.De=Ld;this.zsi=te;this.JKe=Ba.M9a();this.De&&this.De.EGa(this.gW)}get Z7(){return this.qle||(this.qle={})}get QJe(){return this.Pgb||this.JKe}get $Je(){return this.PDa||gd.jxf}get zXd(){return this.lxe=this.lxe||{}}get Nrc(){return this.ZXa||
"undefined"===typeof Stw?this.ZXa:this.ZXa=Stw.swpc}get rsf(){return this.uee=this.uee||{}}get LRa(){return this.mmb||(this.mmb=Va.a.instance.Ub("Common.NetworkTiming.IResourceTimingLogger"))}get Akg(){return this.Bkg||(this.Bkg=new cc)}get Tgb(){return this.Ekg||(this.Ekg=new Kc)}get NEc(){return this.Ckg||(this.Ckg=new uc)}cXd(xa,Ba,pc){this.uOb(xa,Ba,pc,ya.a.pEb(ya.a.Qa.zb.getTime()))}uOb(xa,Ba,pc,nd,Ld=null){if(this.Z7[pc])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.Z7[pc]=this.mJe(xa,Ba,pc,nd,Ld)}t$c(xa){this.Dub(xa,ya.a.pEb(ya.a.Qa.zb.getTime()))}Dub(xa,Ba){const pc=this.Z7[xa];pc&&(this.oFe(pc,Ba),this.kWj(pc),delete this.Z7[xa])}MUf(xa){delete this.Z7[xa]}zag(xa,Ba){this.Pgb||this.mag(xa,Ba)}hag(){this.zag(gd.xkd,this.Ph.we)}HPe(xa,Ba=!1){if(this.Pgb){if(this.PDa===gd.NFd||this.PDa===gd.xkd){const pc=z.a.instance;pc.userSessionId=this.userSessionId;if(this.PDa===gd.NFd){this.eye||(this.Nla(xa.m,Object(S.a)(pc,pc.Waj,"recordContentFetchEnd")),this.eye=
!0);if(Ba){this.PLf||(this.Nla(xa.m,Object(S.a)(pc,pc.jbj,"recordPerceivedContentDisplayed")),this.PLf=!0);return}this.Nla(xa.m,Object(S.a)(pc,pc.Vaj,"recordContentDisplayed"))}else this.PDa===gd.xkd&&(Ba=this.Z7[this.UQb])&&this.Nla(yd.a(xa,Ba.s),Object(S.a)(pc,pc.gbj,"recordInteractivityContentDisplayed"),!1)}this.Dub(this.UQb,xa);this.UQb=this.PDa=this.Pgb=null}}Nla(xa,Ba,pc=!0){z.a.YP&&Object(vd.a)(ld.PerformanceClock,ya.a.Qa)&&pc&&(xa+=window.performance.timing.navigationStart);Ba(xa)}uj(xa){return Ob.a(xa)}Qe(xa,
Ba,pc=!1){try{if(this.rsf[l[xa]]=!0,pc){var nd=e.ULS,Ld=nd.sendTraceTag;const Mc={};let Gf=null;switch(xa){case 0:Gf="Actions";var te=Ba.a;null!=te&&(Mc.Id=te);var af=null==Ba.b?null:Ba.b;null!=af&&(Mc.Operation=af);var Bf=Ba.c;null!=Bf&&(Mc.Target=Bf);var Pf=null==Ba.d?null:Ba.d.toString();null!=Pf&&(Mc.StartTime=Pf);var Ef=null==Ba.e?null:Ba.e.toString();null!=Ef&&(Mc.Duration=Ef);var cg=Ba.f;null!=cg&&(Mc.CorrelationId=cg);var Uf=Ba.g;null!=Uf&&(Mc.ParentAction=Uf);var ag=null==Ba.h?null:Ba.h.toString();
null!=ag&&(Mc.DocumentHidden=ag);break;case 1:Gf="CorrelationStart";var lg=Ba.a;null!=lg&&(Mc.CorrelationId=lg);var Dg=Ba.b;null!=Dg&&(Mc.UserSessionId=Dg);var vg=Ba.c;null!=vg&&(Mc.UserAction=vg);break;case 2:Gf="ReorderSheetOp";var dg=Ba.a;null!=dg&&(Mc.UserSessionId=dg);var ch=null==Ba.b?null:Ba.b.toString();null!=ch&&(Mc.IsDragReorder=ch);var Jf=null==Ba.c?null:Ba.c.toString();null!=Jf&&(Mc.DocumentUp=Jf);var rg=null==Ba.d?null:Ba.d.toString();null!=rg&&(Mc.OldIndex=rg);var hg=null==Ba.e?null:
Ba.e.toString();null!=hg&&(Mc.NewIndex=hg);var Jg=null==Ba.f?null:Ba.f.toString();null!=Jg&&(Mc.TotalSheets=Jg);break;case 3:Gf="FormatCellOp";var yg=Ba.a;null!=yg&&(Mc.UserSessionId=yg);var zg=null==Ba.b?null:Ba.b.toString();null!=zg&&(Mc.TaskId=zg);var vh=null==Ba.c?null:Ba.c.toString();null!=vh&&(Mc.NumberOfRanges=vh);var Yg=Ba.d;null!=Yg&&(Mc.Ranges=Yg);var wh=Ba.e;null!=wh&&(Mc.ActiveCell=wh);var gh=null==Ba.f?null:Ba.f.toString();null!=gh&&(Mc.ActionId=gh);var Og=Ba.g;null!=Og&&(Mc.CommandParameters=
Og);var Zg=Ba.h;null!=Zg&&(Mc.UserActionStopwatchId=Zg);break;case 4:Gf="CopyOp";var Kg=Ba.a;null!=Kg&&(Mc.UserSessionId=Kg);var hh=null==Ba.b?null:Ba.b.toString();null!=hh&&(Mc.IsChrome=hh);var mf=null==Ba.c?null:Ba.c.toString();null!=mf&&(Mc.IsIE=mf);var ma=null==Ba.d?null:Ba.d.toString();null!=ma&&(Mc.IsFromUI=ma);var sb=null==Ba.e?null:Ba.e.toString();null!=sb&&(Mc.IsCopyInLoadedRange=sb);var ic=null==Ba.f?null:Ba.f.toString();null!=ic&&(Mc.IsRepeatedCopy=ic);var Cc=null==Ba.g?null:Ba.g.toString();
null!=Cc&&(Mc.IsClipboarAccessSupported=Cc);var rd=null==Ba.h?null:Ba.h.toString();null!=rd&&(Mc.IsClipboarAccessInstallationSupported=rd);var Hd=null==Ba.i?null:Ba.i.toString();null!=Hd&&(Mc.RibbonCommand=Hd);var ge=null==Ba.j?null:Ba.j.toString();null!=ge&&(Mc.CutCopyPasteFlags=ge);var Ee=null==Ba.k?null:Ba.k.toString();null!=Ee&&(Mc.IsDrag=Ee);var Wd=null==Ba.l?null:Ba.l.toString();null!=Wd&&(Mc.IsIeBeforeAlowDenyPopUp=Wd);var k=Ba.m;null!=k&&(Mc.IsPasteMatchCopy=k);var K=Ba.n;null!=K&&(Mc.WaitMessageInClipboard=
K);var ia=null==Ba.o?null:Ba.o.toString();null!=ia&&(Mc.CallCount=ia);break;case 5:Gf="PasteOp";var Za=Ba.a;null!=Za&&(Mc.UserSessionId=Za);var Mb=null==Ba.b?null:Ba.b.toString();null!=Mb&&(Mc.IsChrome=Mb);var Wb=null==Ba.c?null:Ba.c.toString();null!=Wb&&(Mc.IsIE=Wb);var ac=null==Ba.d?null:Ba.d.toString();null!=ac&&(Mc.IsCopyActive=ac);var Nc=null==Ba.e?null:Ba.e.toString();null!=Nc&&(Mc.IsFromUI=Nc);var ad=null==Ba.f?null:Ba.f.toString();null!=ad&&(Mc.IsClipboarAccessSupported=ad);var bd=null==Ba.g?
null:Ba.g.toString();null!=bd&&(Mc.IsClipboarAccessInstallationSupported=bd);var Kd=null==Ba.h?null:Ba.h.toString();null!=Kd&&(Mc.RibbonCommand=Kd);var Xd=null==Ba.i?null:Ba.i.toString();null!=Xd&&(Mc.CutCopyPasteFlags=Xd);var ue=Ba.j;null!=ue&&(Mc.WaitMessageInClipboard=ue);var me=Ba.k;null!=me&&(Mc.PopupDialog=me);var Ke=Ba.l;null!=Ke&&(Mc.SimplePopupMessage=Ke);var We=Ba.m;null!=We&&(Mc.DialogCloseButton=We);var Ve=Ba.n;null!=Ve&&(Mc.UserPressedInstallLink=Ve);var cf=null==Ba.o?null:Ba.o.toString();
null!=cf&&(Mc.CallCount=cf);break;case 6:Gf="GetNumberViewModelDataOp";var tf=Ba.a;null!=tf&&(Mc.UserSessionId=tf);var xf=Ba.b;null!=xf&&(Mc.NumberFormatOptionsPreviousOutputJson=xf);var zf=Ba.c;null!=zf&&(Mc.NumberFormatOptionsNewInputJson=zf);break;case 7:Gf="InstantaneousSetData";var df=Ba.a;null!=df&&(Mc.Id=df);var Wf=null==Ba.b?null:Ba.b.toString();null!=Wf&&(Mc.WasEmpty=Wf);var wf=null==Ba.c?null:Ba.c.toString();null!=wf&&(Mc.ValueNotChanged=wf);var Vg=Ba.d;null!=Vg&&(Mc.Source=Vg);var ug=null==
Ba.e?null:Ba.e.toString();null!=ug&&(Mc.ProcessingCompleted=ug);break;case 8:Gf="ImmediateSetData";var xh=Ba.a;null!=xh&&(Mc.ClientStopwatchId=xh);var Yh=Ba.b;null!=Yh&&(Mc.Operation=Yh);var Eh=Ba.c;null!=Eh&&(Mc.Parameters=Eh);var Vf=null==Ba.d?null:Ba.d.toString();null!=Vf&&(Mc.WasUpdatedByImmediate=Vf);var Pg=null==Ba.e?null:Ba.e.toString();null!=Pg&&(Mc.areHtmlElementsEqualClientComparison=Pg);var wg=null==Ba.f?null:Ba.f.toString();null!=wg&&(Mc.WasDecisionMadeByHtmlComparison=wg);var Qg=null==
Ba.g?null:Ba.g.toString();null!=Qg&&(Mc.IsNumeric=Qg);var Ih=null==Ba.h?null:Ba.h.toString();null!=Ih&&(Mc.IsDateTime=Ih);var Qi=null==Ba.i?null:Ba.i.toString();null!=Qi&&(Mc.HasCurrencySymbol=Qi);var Zh=null==Ba.j?null:Ba.j.toString();null!=Zh&&(Mc.HasPercentSymbol=Zh);var $h=null==Ba.k?null:Ba.k.toString();null!=$h&&(Mc.IsFunc=$h);var ai=null==Ba.l?null:Ba.l.toString();null!=ai&&(Mc.DiffInWrappingWhitespace=ai);var Ag=Ba.m;null!=Ag&&(Mc.ImmediatePattern=Ag);var jh=null==Ba.n?null:Ba.n.toString();
null!=jh&&(Mc.TextAlignmentMatch=jh);var bi=null==Ba.o?null:Ba.o.toString();null!=bi&&(Mc.FontColorMatch=bi);var qi=null==Ba.p?null:Ba.p.toString();null!=qi&&(Mc.FormulaTextMatch=qi);var ri=null==Ba.q?null:Ba.q.toString();null!=ri&&(Mc.isFormula=ri);var Ri=Ba.r;null!=Ri&&(Mc.FormulaText=Ri);var Si=Ba.s;null!=Si&&(Mc.InstantaneousPattern=Si);var Bh=null==Ba.t?null:Ba.t.toString();null!=Bh&&(Mc.AreHtmlInnerTextElementsEqualClientComparison=Bh);var dh=Ba.u;null!=dh&&(Mc.HtmlComparisonDecision=dh);break;
case 9:Gf="DependentCellsCalc";var si=Ba.a;null!=si&&(Mc.CalcStatus=si);var Nh=null==Ba.b?null:Ba.b.toString();null!=Nh&&(Mc.SuccessfullyCalculatedRanges=Nh);var nh=null==Ba.c?null:Ba.c.toString();null!=nh&&(Mc.RangesSkipped=nh);var ci=null==Ba.d?null:Ba.d.toString();null!=ci&&(Mc.TotalErrors=ci);var oh=null==Ba.e?null:Ba.e.toString();null!=oh&&(Mc.Partial=oh);var Fi=null==Ba.f?null:Ba.f.toString();null!=Fi&&(Mc.Canceled=Fi);var di=null==Ba.g?null:Ba.g.toString();null!=di&&(Mc.Aggregate=di);var Vc=
null==Ba.h?null:Ba.h.toString();null!=Vc&&(Mc.Unknown=Vc);var Ad=null==Ba.i?null:Ba.i.toString();null!=Ad&&(Mc.UnavailableData=Ad);var Rg=null==Ba.j?null:Ba.j.toString();null!=Rg&&(Mc.Cycle=Rg);var Gi=null==Ba.k?null:Ba.k.toString();null!=Gi&&(Mc.NotImplemented=Gi);var ti=null==Ba.l?null:Ba.l.toString();null!=ti&&(Mc.InvalidInput=ti);var ei=null==Ba.m?null:Ba.m.toString();null!=ei&&(Mc.AreDepCells=ei);break;case 10:Gf="DependentCellsGraphStat";var Hi=null==Ba.a?null:Ba.a.toString();null!=Hi&&(Mc.ParsedFormulas=
Hi);var eh=null==Ba.b?null:Ba.b.toString();null!=eh&&(Mc.GraphNodes=eh);var sg=null==Ba.c?null:Ba.c.toString();null!=sg&&(Mc.GraphArcs=sg);var Ii=null==Ba.d?null:Ba.d.toString();null!=Ii&&(Mc.AnalyzedBlocks=Ii);var ph=null==Ba.e?null:Ba.e.toString();null!=ph&&(Mc.IterationId=ph);var fi=Ba.f;null!=fi&&(Mc.UniqueId=fi);var gi=null==Ba.g?null:Ba.g.toString();null!=gi&&(Mc.Aborted=gi);break;case 11:Gf="DependentCellsGraphSectionStat";var Ji=null==Ba.a?null:Ba.a.toString();null!=Ji&&(Mc.IterationId=Ji);
var Jh=Ba.b;null!=Jh&&(Mc.BlockHash=Jh);var hi=Ba.c;null!=hi&&(Mc.Functions=hi);var Kh=Ba.d;null!=Kh&&(Mc.Operators=Kh);var og=null==Ba.e?null:Ba.e.toString();null!=og&&(Mc.CrossDocRefs=og);var xg=null==Ba.f?null:Ba.f.toString();null!=xg&&(Mc.CrossSheetRefs=xg);var ui=null==Ba.g?null:Ba.g.toString();null!=ui&&(Mc.ErrRefs=ui);var yh=null==Ba.h?null:Ba.h.toString();null!=yh&&(Mc.LargeRanges=yh);var Ki=null==Ba.i?null:Ba.i.toString();null!=Ki&&(Mc.NameRefs=Ki);var ii=null==Ba.j?null:Ba.j.toString();
null!=ii&&(Mc.ParserErrors=ii);var zh=null==Ba.k?null:Ba.k.toString();null!=zh&&(Mc.RowRefs=zh);var ji=null==Ba.l?null:Ba.l.toString();null!=ji&&(Mc.ColumnRefs=ji);var kf=null==Ba.m?null:Ba.m.toString();null!=kf&&(Mc.TableRefs=kf);var Ch=Ba.n;null!=Ch&&(Mc.UniqueId=Ch);var Sg=null==Ba.o?null:Ba.o.toString();null!=Sg&&(Mc.UnreachableReferences=Sg);break;case 12:Gf="GetRangeContentPrefetchFailures";var Bg=Ba.a;null!=Bg&&(Mc.UserSessionId=Bg);var Cg=Ba.b;null!=Cg&&(Mc.ClientStopwatchId=Cg);var Oh=null==
Ba.c?null:Ba.c.toString();null!=Oh&&(Mc.StateId=Oh);break;case 13:Gf="GridBlockUpdates";var Ph=Ba.a;null!=Ph&&(Mc.UserSessionId=Ph);var qh=Ba.b;null!=qh&&(Mc.CorrelationId=qh);var ih=Ba.c;null!=ih&&(Mc.Operation=ih);var Wg=null==Ba.d?null:Ba.d.toString();null!=Wg&&(Mc.PerformanceType=Wg);var ki=Ba.e;null!=ki&&(Mc.BlockHash=ki);var Qh=null==Ba.f?null:Ba.f.toString();null!=Qh&&(Mc.DurationInMs=Qh);break;case 14:Gf="BrowserAppStart";var Rh=null==Ba.a?null:Te.a.Dta(Ba.a.getTime());null!=Rh&&(Mc.ScriptExecutionStart=
Rh);var Ti=Ba.b;null!=Ti&&(Mc.UserSessionId=Ti);var Ui=Ba.c;null!=Ui&&(Mc.ClockMechanism=Ui);var Hg=null==Ba.d?null:Ba.d.toString();null!=Hg&&(Mc.ScreenDPI=Hg);var Li=null==Ba.e?null:Ba.e.toString();null!=Li&&(Mc.NavigationToScriptExecutionDelta=Li);break;case 15:Gf="LinkedObjects";var vi=Ba.a;null!=vi&&(Mc.ChildId=vi);var li=Ba.b;null!=li&&(Mc.ParentId=li);var wi=Ba.c;null!=wi&&(Mc.ChildTable=wi);var rh=Ba.d;null!=rh&&(Mc.ParentTable=rh);break;case 16:Gf="LongFrames";var mi=null==Ba.a?null:Te.a.Dta(Ba.a.getTime());
null!=mi&&(Mc.StartTime=mi);var xi=null==Ba.b?null:Ba.b.toString();null!=xi&&(Mc.DurationInMs=xi);break;case 17:Gf="Task";var Eg=Ba.a;null!=Eg&&(Mc.StopwatchId=Eg);var Sh=null==Ba.b?null:Ba.b.toString();null!=Sh&&(Mc.Status=Sh);var Tg=null==Ba.c?null:Ba.c.toString();null!=Tg&&(Mc.CreateTime=Tg);var Fh=null==Ba.d?null:Ba.d.toString();null!=Fh&&(Mc.TaskId=Fh);break;case 18:Gf="ConflictInEditing";var yi=Ba.a;null!=yi&&(Mc.OtherUserState=yi);var Dh=Ba.b;null!=Dh&&(Mc.UserSessionId=Dh);var pg=null==Ba.c?
null:Te.a.Dta(Ba.c.getTime());null!=pg&&(Mc.ConflictTime=pg);break;case 19:Gf="IncomingPresenceData";var Gh=Ba.a;null!=Gh&&(Mc.UserSessionId=Gh);var zi=Ba.b;null!=zi&&(Mc.UserId=zi);var Vi=null==Ba.c?null:Ba.c.toString();null!=Vi&&(Mc.Disconnected=Vi);var Rf=null==Ba.d?null:Te.a.Dta(Ba.d.getTime());null!=Rf&&(Mc.ReceivedTime=Rf);break;case 20:Gf="EditorTableDelay";var sh=Ba.a;null!=sh&&(Mc.UserSessionId=sh);var Wi=Ba.b;null!=Wi&&(Mc.UserId=Wi);var Th=null==Ba.c?null:Ba.c.toString();null!=Th&&(Mc.Received=
Th);var kh=null==Ba.d?null:Ba.d.toString();null!=kh&&(Mc.DurationInMs=kh);var $g=null==Ba.e?null:Ba.e.toString();null!=$g&&(Mc.NotAloneAtLogTime=$g);var Ai=null==Ba.f?null:Te.a.Dta(Ba.f.getTime());null!=Ai&&(Mc.Time=Ai);break;case 21:Gf="PresenceStartup";var Mi=Ba.a;null!=Mi&&(Mc.UserSessionId=Mi);var ah=null==Ba.b?null:Ba.b.toString();null!=ah&&(Mc.EverReceived=ah);var ni=null==Ba.c?null:Ba.c.toString();null!=ni&&(Mc.NotAloneOnOpen=ni);var Ni=null==Ba.d?null:Ba.d.toString();null!=Ni&&(Mc.NotAloneAtLogTime=
Ni);var Uh=null==Ba.e?null:Ba.e.toString();null!=Uh&&(Mc.EditorCount=Uh);var Bi=null==Ba.f?null:Ba.f.toString();null!=Bi&&(Mc.WorkbookOpenToFirstReceivedInMs=Bi);break;case 22:Gf="PresenceDelete";var sf=Ba.a;null!=sf&&(Mc.UserSessionId=sf);var Ci=Ba.b;null!=Ci&&(Mc.UserId=Ci);var Oi=Ba.c;null!=Oi&&(Mc.Context=Oi);var lh=Ba.d;null!=lh&&(Mc.Reason=lh);var oi=null==Ba.e?null:Te.a.Dta(Ba.e.getTime());null!=oi&&(Mc.Time=oi);break;case 23:Gf="EditorEvent";var Vh=Ba.a;null!=Vh&&(Mc.UserSessionId=Vh);var eg=
Ba.b;null!=eg&&(Mc.UserId=eg);var Lh=Ba.c;null!=Lh&&(Mc.Context=Lh);var mh=null==Ba.d?null:Te.a.Dta(Ba.d.getTime());null!=mh&&(Mc.Time=mh);break;case 24:Gf="EditorTime";var Mh=Ba.a;null!=Mh&&(Mc.UserSessionId=Mh);var R=Ba.b;null!=R&&(Mc.UserId=R);var Wa=null==Ba.c?null:Ba.c.toString();null!=Wa&&(Mc.DurationInMs=Wa);break;case 25:Gf="GridScreenReaderOps";var rb=Ba.a;null!=rb&&(Mc.UserSessionId=rb);var Ub=Ba.b;null!=Ub&&(Mc.CommandTaskId=Ub);var lc=null==Ba.c?null:Ba.c.toString();null!=lc&&(Mc.CommandId=
lc);var Hc=null==Ba.d?null:Ba.d.toString();null!=Hc&&(Mc.ClientSideOnly=Hc);var Dc=null==Ba.e?null:Ba.e.toString();null!=Dc&&(Mc.DurationInMS=Dc);var Ac=null==Ba.f?null:Ba.f.toString();null!=Ac&&(Mc.ReachedMaxReadoutCells=Ac);var kc=null==Ba.g?null:Ba.g.toString();null!=kc&&(Mc.RequstedCellCount=kc);var Oc=null==Ba.h?null:Ba.h.toString();null!=Oc&&(Mc.NonEmptyCellCount=Oc);var cd=null==Ba.i?null:Ba.i.toString();null!=cd&&(Mc.Succeeded=cd);var Wc=null==Ba.j?null:Ba.j.toString();null!=Wc&&(Mc.Canceled=
Wc);var Id=Ba.k;null!=Id&&(Mc.ErrorType=Id);break;case 26:Gf="SendPresenceToService";var Vd=Ba.a;null!=Vd&&(Mc.UserSessionId=Vd);var re=null==Ba.b?null:Ba.b.toString();null!=re&&(Mc.TotalCount=re);var Me=null==Ba.c?null:Ba.c.toString();null!=Me&&(Mc.SendCount=Me);break;case 27:Gf="IME";var ef=Ba.a;null!=ef&&(Mc.UserSessionId=ef);break;case 28:Gf="FreezePaneFloatingObjects";var yf=Ba.a;null!=yf&&(Mc.UserSessionId=yf);var Sf=null==Ba.b?null:Ba.b.toString();null!=Sf&&(Mc.ObjectType=Sf);var jf=Ba.c;null!=
jf&&(Mc.ObjectID=jf);var Df=null==Ba.d?null:Ba.d.toString();null!=Df&&(Mc.SpannedPanesCount=Df);break;case 29:Gf="CustomizeStatusBar";var lf=Ba.a;null!=lf&&(Mc.UserSessionId=lf);var Zf=Ba.b;null!=Zf&&(Mc.UIControlName=Zf);var qg=null==Ba.c?null:Ba.c.toString();null!=qg&&(Mc.IsControlVisible=qg);break;case 30:Gf="ClientWebRequests";var Fg=Ba.a;null!=Fg&&(Mc.Path=Fg);var Gg=Ba.b;null!=Gg&&(Mc.ProxyStopwatchId=Gg);var Ug=Ba.c;null!=Ug&&(Mc.RequestStatus=Ug);var th=null==Ba.d?null:Ba.d.toString();null!=
th&&(Mc.ResponseSizeInBytes=th);var vf=Ba.e;null!=vf&&(Mc.ClientRequestId=vf);var ff=null==Ba.f?null:Ba.f.toString();null!=ff&&(Mc.StateId=ff);break;case 31:Gf="ShowCommentTaskPane";var Cf=Ba.a;null!=Cf&&(Mc.UserSessionId=Cf);var Mf=null==Ba.b?null:Ba.b.toString();null!=Mf&&(Mc.IsFromKeyboardShortcut=Mf);var Qf=null==Ba.c?null:Ba.c.toString();null!=Qf&&(Mc.IsShowPane=Qf);var Kf=null==Ba.d?null:Ba.d.toString();null!=Kf&&(Mc.ShowForDeepLink=Kf);var Lf=null==Ba.e?null:Ba.e.toString();null!=Lf&&(Mc.DeepLinkFound=
Lf);break;case 32:Gf="ApplyThreadedCommentChange";var Nf=Ba.a;null!=Nf&&(Mc.UserSessionId=Nf);var Of=null==Ba.b?null:Ba.b.toString();null!=Of&&(Mc.Operation=Of);var ig=Ba.c;null!=ig&&(Mc.CommentId=ig);var Xg=null==Ba.d?null:Ba.d.toString();null!=Xg&&(Mc.CommentsCount=Xg);break;case 33:Gf="UpgradeLegacyCommentsChange";var Ff=Ba.a;null!=Ff&&(Mc.UserSessionId=Ff);var pi=null==Ba.b?null:Ba.b.toString();null!=pi&&(Mc.OperationSuccessful=pi);break;case 34:Gf="FindNextOrPreviousComment";var Di=Ba.a;null!=
Di&&(Mc.UserSessionId=Di);var Pi=null==Ba.b?null:Ba.b.toString();null!=Pi&&(Mc.Succeeded=Pi);break;case 35:Gf="Goto";var Ei=Ba.a;null!=Ei&&(Mc.UserSessionId=Ei);var bg=null==Ba.b?null:Ba.b.toString();null!=bg&&(Mc.IsSucceeded=bg);var Lg=null==Ba.c?null:Ba.c.toString();null!=Lg&&(Mc.IsNOVMode=Lg);break;case 36:Gf="LaunchOfficeAddInDialog";var bh=Ba.a;null!=bh&&(Mc.UserSessionId=bh);var Xf=Ba.b;null!=Xf&&(Mc.SourceId=Xf);var jg=Ba.c;null!=jg&&(Mc.SourceLabel=jg);var fh=Ba.d;null!=fh&&(Mc.Flight=fh);
var uh=Ba.e;null!=uh&&(Mc.Experiment=uh);var Ah=Ba.f;null!=Ah&&(Mc.UICultureTag=Ah);var Wh=null==Ba.g?null:Ba.g.toString();null!=Wh&&(Mc.UICultureTagLcid=Wh);var $i=null==Ba.h?null:Ba.h.toString();null!=$i&&(Mc.WacHostId=$i);break;case 37:Gf="RichApiInvocation";var aj=Ba.a;null!=aj&&(Mc.UserSessionId=aj);var bj=null==Ba.b?null:Ba.b.toString();null!=bj&&(Mc.Succeeded=bj);var cj=Ba.c;null!=cj&&(Mc.ErrorType=cj);var dj=Ba.d;null!=dj&&(Mc.ResultInfo=dj);var jj=Ba.e;null!=jj&&(Mc.Source=jj);break;case 38:Gf=
"FxLibrary";var kj=Ba.a;null!=kj&&(Mc.EntityName=kj);var Xi=null==Ba.b?null:Ba.b.toString();null!=Xi&&(Mc.EntryPoint=Xi);var ej=null==Ba.c?null:Ba.c.toString();null!=ej&&(Mc.Action=ej);var fj=null==Ba.d?null:Ba.d.toString();null!=fj&&(Mc.InsertLocation=fj);break;case 39:Gf="EmbeddedApiSession";var gj=Ba.a;null!=gj&&(Mc.UserSessionId=gj);break;case 40:Gf="NumberFormattingCalculator";var hj=Ba.a;null!=hj&&(Mc.Id=hj);var lj=Ba.b;null!=lj&&(Mc.CounterName=lj);var ij=Ba.c;null!=ij&&(Mc.Values=ij);break;
case 41:Gf="RequestDataAfterSend";var mj=Ba.a;null!=mj&&(Mc.ClientStopwatchId=mj);var Yi=Ba.b;null!=Yi&&(Mc.RequestStatus=Yi);var nj=null==Ba.c?null:Ba.c.toString();null!=nj&&(Mc.SendDuration=nj);var oj=null==Ba.d?null:Ba.d.toString();null!=oj&&(Mc.RequestId=oj);break;case 42:Gf="FloatingObjectsStopwatchData";var pj=Ba.a;null!=pj&&(Mc.StopMessage=pj);var qj=null==Ba.b?null:Ba.b.toString();null!=qj&&(Mc.Type=qj);var rj=Ba.c;null!=rj&&(Mc.GUID=rj);var sj=null==Ba.d?null:Ba.d.toString();null!=sj&&(Mc.Pane=
sj);var tj=null==Ba.e?null:Ba.e.toString();null!=tj&&(Mc.IsAboveGrid=tj);var Af=Ba.f;null!=Af&&(Mc.StartCorrelation=Af);var Zi=Ba.g;null!=Zi&&(Mc.LoadImageCorrelation=Zi);var O=null==Ba.h?null:Ba.h.toString();null!=O&&(Mc.SkippedGetEffectsExtents=O);var Ta=null==Ba.i?null:Ba.i.toString();null!=Ta&&(Mc.Version=Ta);break;case 43:Gf="Copy";var Gb=Ba.a;null!=Gb&&(Mc.UserSessionId=Gb);var hc=Ba.b;null!=hc&&(Mc.Trigger=hc);var wc=Ba.c;null!=wc&&(Mc.RibbonCommandName=wc);var $c=Ba.d;null!=$c&&(Mc.SourceItem=
$c);var hd=null==Ba.e?null:Ba.e.toString();null!=hd&&(Mc.SourceRangeCellCount=hd);var md=Ba.f;null!=md&&(Mc.ClientSideStopwatchId=md);var Bd=Ba.g;null!=Bd&&(Mc.CopyOperationId=Bd);var Qd=null==Ba.h?null:Ba.h.toString();null!=Qd&&(Mc.IsAsync=Qd);var Pe=null==Ba.i?null:Ba.i.toString();null!=Pe&&(Mc.IsFromCache=Pe);var Ue=null==Ba.j?null:Ba.j.toString();null!=Ue&&(Mc.IsSuccessiveCopy=Ue);var of=null==Ba.k?null:Ba.k.toString();null!=of&&(Mc.IsSelectionAllowed=of);var tg=null==Ba.l?null:Ba.l.toString();
null!=tg&&(Mc.IsSuccess=tg);var gg=null==Ba.m?null:Ba.m.toString();null!=gg&&(Mc.IsExpectedError=gg);var Yf=Ba.n;null!=Yf&&(Mc.ExpectedErrorReason=Yf);var $f=Ba.o;null!=$f&&(Mc.ErrorMessage=$f);var mg=null==Ba.p?null:Ba.p.toString();null!=mg&&(Mc.ClientSideCopyTimeInMs=mg);var Mg=null==Ba.q?null:Ba.q.toString();null!=Mg&&(Mc.TotalTimeInMs=Mg);var Ig=null==Ba.r?null:Ba.r.toString();null!=Ig&&(Mc.PlainTextPayloadSize=Ig);var Ng=Ba.s;null!=Ng&&(Mc.CopyPasteTargetType=Ng);var Hh=null==Ba.t?null:Ba.t.toString();
null!=Hh&&(Mc.ShadowWorkbookPayloadSize=Hh);var Xh=null==Ba.u?null:Ba.u.toString();null!=Xh&&(Mc.HtmlPayloadSize=Xh);var kk=null==Ba.v?null:Ba.v.toString();null!=kk&&(Mc.HtmlSizeExceedsLimit=kk);var lk=null==Ba.w?null:Ba.w.toString();null!=lk&&(Mc.CopyTotalSizeExceedsLimit=lk);var mk=null==Ba.x?null:Ba.x.toString();null!=mk&&(Mc.ErrorReason=mk);var nk=Ba.y;null!=nk&&(Mc.ErrorName=nk);var ok=null==Ba.z?null:Ba.z.toString();null!=ok&&(Mc.IsSucceededWithAlert=ok);var pk=null==Ba.ba?null:Ba.ba.toString();
null!=pk&&(Mc.EncounteredDeploymentErrors=pk);var qk=null==Ba.bb?null:Ba.bb.toString();null!=qk&&(Mc.ShadowWorkbookSizeExceedsLimit=qk);var rk=Ba.bc;null!=rk&&(Mc.CopyPasteTargetName=rk);var sk=Ba.bd;null!=sk&&(Mc.CCPSliceName=sk);var tk=Ba.be;null!=tk&&(Mc.SyncClipboardItemsKeys=tk);var uk=Ba.bf;null!=uk&&(Mc.AsyncClipboardItemsKeys=uk);var vk=Ba.bg;null!=vk&&(Mc.CopyPasteHandlerName=vk);var wk=Ba.bh;null!=wk&&(Mc.SucceededPopulatingSystemClipboardSync=wk);var xk=Ba.bi;null!=xk&&(Mc.SucceededPopulatingSystemClipboardAsync=
xk);var yk=Ba.bj;null!=yk&&(Mc.Location=yk);var zk=Ba.bk;null!=zk&&(Mc.CopyContextId=zk);var Ak=null==Ba.bl?null:Ba.bl.toString();null!=Ak&&(Mc.ServerRequestTimeInMs=Ak);var Bk=null==Ba.bm?null:Ba.bm.toString();null!=Bk&&(Mc.EcsOperationDuration=Bk);var Ck=null==Ba.bn?null:Ba.bn.toString();null!=Ck&&(Mc.EcsRequestDuration=Ck);var Dk=null==Ba.bo?null:Ba.bo.toString();null!=Dk&&(Mc.WfeRequestDuration=Dk);var Ek=null==Ba.bp?null:Ba.bp.toString();null!=Ek&&(Mc.OriginalSourceRangesCountExceedsLimit=Ek);
var Fk=null==Ba.bq?null:Ba.bq.toString();null!=Fk&&(Mc.UploadToClipServiceAttempted=Fk);var Gk=null==Ba.br?null:Ba.br.toString();null!=Gk&&(Mc.FloatingObjectType=Gk);break;case 44:Gf="Paste";var Hk=Ba.a;null!=Hk&&(Mc.UserSessionId=Hk);var Ik=Ba.b;null!=Ik&&(Mc.Trigger=Ik);var Jk=Ba.c;null!=Jk&&(Mc.RibbonCommandName=Jk);var Kk=null==Ba.d?null:Ba.d.toString();null!=Kk&&(Mc.PasteTypeFlagValue=Kk);var Lk=Ba.e;null!=Lk&&(Mc.PasteOperationId=Lk);var Mk=Ba.f;null!=Mk&&(Mc.CopyOperationId=Mk);var Nk=Ba.g;
null!=Nk&&(Mc.ClientSideStopwatchId=Nk);var Ok=Ba.h;null!=Ok&&(Mc.OriginalDestinationRange=Ok);var Pk=Ba.i;null!=Pk&&(Mc.ExpandDestinationRange=Pk);var Qk=Ba.j;null!=Qk&&(Mc.SourceItem=Qk);var Rk=null==Ba.k?null:Ba.k.toString();null!=Rk&&(Mc.SourceRangeCellCount=Rk);var Sk=null==Ba.l?null:Ba.l.toString();null!=Sk&&(Mc.IsSuccess=Sk);var Tk=null==Ba.m?null:Ba.m.toString();null!=Tk&&(Mc.IsExpectedError=Tk);var Uk=Ba.n;null!=Uk&&(Mc.ClipboardFormatReadTimeInMs=Uk);var Vk=Ba.o;null!=Vk&&(Mc.ClipboardFormatReadStatus=
Vk);var Wk=null==Ba.p?null:Ba.p.toString();null!=Wk&&(Mc.ClipboardReadPermissionPromptShown=Wk);var Xk=null==Ba.q?null:Ba.q.toString();null!=Xk&&(Mc.AsyncApiReadTimedOut=Xk);var Yk=Ba.r;null!=Yk&&(Mc.ExpectedErrorReason=Yk);var Zk=Ba.s;null!=Zk&&(Mc.ErrorMessage=Zk);var $k=null==Ba.t?null:Ba.t.toString();null!=$k&&(Mc.TotalTimeInMs=$k);var al=null==Ba.u?null:Ba.u.toString();null!=al&&(Mc.PlainTextPayloadSize=al);var bl=null==Ba.v?null:Ba.v.toString();null!=bl&&(Mc.ShadowWorkbookPayloadSize=bl);var cl=
null==Ba.w?null:Ba.w.toString();null!=cl&&(Mc.HtmlPayloadSize=cl);var dl=Ba.x;null!=dl&&(Mc.CopyPasteTargetType=dl);var el=null==Ba.y?null:Ba.y.toString();null!=el&&(Mc.IsLastCopyWasExternal=el);var fl=null==Ba.z?null:Ba.z.toString();null!=fl&&(Mc.IsClipboardDataContainShadowWorkbook=fl);var gl=null==Ba.ba?null:Ba.ba.toString();null!=gl&&(Mc.IsShadowWorkbookParsedSuccessfully=gl);var hl=Ba.bb;null!=hl&&(Mc.ActiveSelectionType=hl);var il=Ba.bc;null!=il&&(Mc.PasteResult=il);var jl=null==Ba.bd?null:
Ba.bd.toString();null!=jl&&(Mc.ErrorReason=jl);var kl=Ba.be;null!=kl&&(Mc.ErrorName=kl);var ll=null==Ba.bf?null:Ba.bf.toString();null!=ll&&(Mc.IsSucceededWithAlert=ll);var ml=null==Ba.bg?null:Ba.bg.toString();null!=ml&&(Mc.IsAfterCut=ml);var nl=null==Ba.bh?null:Ba.bh.toString();null!=nl&&(Mc.EncounteredDeploymentErrors=nl);var ol=null==Ba.bi?null:Ba.bi.toString();null!=ol&&(Mc.IsCrossSession=ol);var pl=null==Ba.bj?null:Ba.bj.toString();null!=pl&&(Mc.ShadowWorkbookSizeExceedsLimit=pl);var Qj=null==
Ba.bk?null:Ba.bk.toString();null!=Qj&&(Mc.ClipboardContainXLOPayload=Qj);var ql=Ba.bl;null!=ql&&(Mc.CopyPasteTargetName=ql);var rl=Ba.bm;null!=rl&&(Mc.ChromeExtensionId=rl);var sl=Ba.bn;null!=sl&&(Mc.PayloadOrigin=sl);var tl=Ba.bo;null!=tl&&(Mc.PayloadType=tl);var ul=Ba.bp;null!=ul&&(Mc.CCPSliceName=ul);var vl=Ba.bq;null!=vl&&(Mc.ClipboardItemsKeys=vl);var wl=Ba.br;null!=wl&&(Mc.CopyPasteHandlerName=wl);var xl=null==Ba.bs?null:Ba.bs.toString();null!=xl&&(Mc.IsSourceItemOriginSameSession=xl);var yl=
Ba.bt;null!=yl&&(Mc.Location=yl);var zl=Ba.bu;null!=zl&&(Mc.ExternalAppSource=zl);var Al=Ba.bv;null!=Al&&(Mc.PasteContextId=Al);var sm=null==Ba.bw?null:Ba.bw.toString();null!=sm&&(Mc.ServerRequestTimeInMs=sm);var uj=null==Ba.bx?null:Ba.bx.toString();null!=uj&&(Mc.IndicationDisplayScheduled=uj);var vj=Ba.by;null!=vj&&(Mc.PasteIndicationDisplayStatus=vj);var wj=null==Ba.bz?null:Ba.bz.toString();null!=wj&&(Mc.PasteRecoveryUIDisplayed=wj);var xj=null==Ba.ca?null:Ba.ca.toString();null!=xj&&(Mc.IsFromPasteRecoveryUI=
xj);var yj=null==Ba.cb?null:Ba.cb.toString();null!=yj&&(Mc.EcsOperationDuration=yj);var zj=null==Ba.cc?null:Ba.cc.toString();null!=zj&&(Mc.EcsRequestDuration=zj);var Aj=null==Ba.cd?null:Ba.cd.toString();null!=Aj&&(Mc.WfeRequestDuration=Aj);var Bl=null==Ba.ce?null:Ba.ce.toString();null!=Bl&&(Mc.OriginalSourceRangesCountExceedsLimit=Bl);var Cl=Ba.cf;null!=Cl&&(Mc.PasteRecoveryUndoStopwatchId=Cl);var Rj=null==Ba.cg?null:Ba.cg.toString();null!=Rj&&(Mc.PasteRecoveryUndoTimeInMs=Rj);var Sj=null==Ba.ch?
null:Ba.ch.toString();null!=Sj&&(Mc.PasteCSEPerformed=Sj);var Tj=null==Ba.ci?null:Ba.ci.toString();null!=Tj&&(Mc.CSEStatus=Tj);var Uj=null==Ba.cj?null:Ba.cj.toString();null!=Uj&&(Mc.IsFromEnterShortcut=Uj);var Dl=null==Ba.ck?null:Ba.ck.toString();null!=Dl&&(Mc.pasteDestinationHasMergedCells=Dl);break;case 45:Gf="DragDrop";var Bj=Ba.a;null!=Bj&&(Mc.UserSessionId=Bj);var Cj=Ba.b;null!=Cj&&(Mc.Trigger=Cj);var Dj=Ba.c;null!=Dj&&(Mc.RibbonCommandName=Dj);var Ej=Ba.d;null!=Ej&&(Mc.OperationId=Ej);var Fj=
Ba.e;null!=Fj&&(Mc.ClientSideStopwatchId=Fj);var Gj=Ba.f;null!=Gj&&(Mc.SourceRange=Gj);var Hj=Ba.g;null!=Hj&&(Mc.DestinationRange=Hj);var Ij=Ba.h;null!=Ij&&(Mc.CutCopyType=Ij);var Jj=null==Ba.i?null:Ba.i.toString();null!=Jj&&(Mc.IsShiftKeyDown=Jj);var Kj=null==Ba.j?null:Ba.j.toString();null!=Kj&&(Mc.IsDragInsert=Kj);var Lj=null==Ba.k?null:Ba.k.toString();null!=Lj&&(Mc.IsSuccess=Lj);var Mj=null==Ba.l?null:Ba.l.toString();null!=Mj&&(Mc.IsExpectedError=Mj);var Nj=Ba.m;null!=Nj&&(Mc.ExpectedErrorReason=
Nj);var Oj=Ba.n;null!=Oj&&(Mc.ErrorMessage=Oj);var Pj=null==Ba.o?null:Ba.o.toString();null!=Pj&&(Mc.TotalTimeInMs=Pj);var El=Ba.p;null!=El&&(Mc.ErrorName=El);var Fl=null==Ba.q?null:Ba.q.toString();null!=Fl&&(Mc.IsSucceededWithAlert=Fl);var Gl=Ba.r;null!=Gl&&(Mc.CopyPasteTargetType=Gl);var Hl=null==Ba.s?null:Ba.s.toString();null!=Hl&&(Mc.EncounteredDeploymentErrors=Hl);break;case 46:Gf="ClearCopyState";var Il=Ba.a;null!=Il&&(Mc.UserSessionId=Il);var Jl=Ba.b;null!=Jl&&(Mc.ClientSideStopwatchId=Jl);
var Kl=Ba.c;null!=Kl&&(Mc.Trigger=Kl);var Ll=null==Ba.d?null:Ba.d.toString();null!=Ll&&(Mc.IsClearClipboard=Ll);var Ml=null==Ba.e?null:Ba.e.toString();null!=Ml&&(Mc.IsExplicit=Ml);var Nl=null==Ba.f?null:Ba.f.toString();null!=Nl&&(Mc.IsSuccess=Nl);var Ol=Ba.g;null!=Ol&&(Mc.ErrorMessage=Ol);var Pl=Ba.h;null!=Pl&&(Mc.ErrorName=Pl);var Ql=null==Ba.i?null:Ba.i.toString();null!=Ql&&(Mc.TotalTimeInMs=Ql);var Rl=Ba.j;null!=Rl&&(Mc.CopyPasteTargetType=Rl);break;case 47:Gf="WebWorkerRecalcStats";var Sl=null==
Ba.a?null:Ba.a.toString();null!=Sl&&(Mc.SuccessCount=Sl);var Tl=null==Ba.b?null:Ba.b.toString();null!=Tl&&(Mc.FailureCount=Tl);var Ul=null==Ba.c?null:Ba.c.toString();null!=Ul&&(Mc.ValueTypeMismatchCount=Ul);var Vl=null==Ba.d?null:Ba.d.toString();null!=Vl&&(Mc.CellValueMismatchCount=Vl);var Wl=null==Ba.e?null:Ba.e.toString();null!=Wl&&(Mc.IfmtMismatchCount=Wl);var Xl=null==Ba.f?null:Ba.f.toString();null!=Xl&&(Mc.FormattedTextMismatchCount=Xl);var Yl=null==Ba.g?null:Ba.g.toString();null!=Yl&&(Mc.CellValueStringMismatchCount=
Yl);var Zl=null==Ba.h?null:Ba.h.toString();null!=Zl&&(Mc.CellValueNumberMismatchCount=Zl);var $l=null==Ba.i?null:Ba.i.toString();null!=$l&&(Mc.CellValueBooleanMismatchCount=$l);var am=null==Ba.j?null:Ba.j.toString();null!=am&&(Mc.CellValueBlankMismatchCount=am);var bm=null==Ba.k?null:Ba.k.toString();null!=bm&&(Mc.CellValueErrorMismatchCount=bm);var cm=null==Ba.l?null:Ba.l.toString();null!=cm&&(Mc.FormattedTextStringMismatchCount=cm);var dm=null==Ba.m?null:Ba.m.toString();null!=dm&&(Mc.FormattedTextNumberMismatchCount=
dm);var em=null==Ba.n?null:Ba.n.toString();null!=em&&(Mc.FormattedTextBooleanMismatchCount=em);var fm=null==Ba.o?null:Ba.o.toString();null!=fm&&(Mc.FormattedTextBlankMismatchCount=fm);var gm=null==Ba.p?null:Ba.p.toString();null!=gm&&(Mc.FormattedTextErrorMismatchCount=gm);var hm=null==Ba.q?null:Ba.q.toString();null!=hm&&(Mc.StringMismatchCount=hm);var im=null==Ba.r?null:Ba.r.toString();null!=im&&(Mc.NumericMismatchCount=im);var jm=null==Ba.s?null:Ba.s.toString();null!=jm&&(Mc.ErrorMismatchCount=jm);
var km=null==Ba.t?null:Ba.t.toString();null!=km&&(Mc.StringValuesCount=km);var lm=null==Ba.u?null:Ba.u.toString();null!=lm&&(Mc.NumericValuesCount=lm);var mm=null==Ba.v?null:Ba.v.toString();null!=mm&&(Mc.BooleanValuesCount=mm);var nm=null==Ba.w?null:Ba.w.toString();null!=nm&&(Mc.BlankValuesCount=nm);var om=null==Ba.x?null:Ba.x.toString();null!=om&&(Mc.ErrorValuesCount=om);var pm=null==Ba.y?null:Ba.y.toString();null!=pm&&(Mc.NumericValuesDiffAverage=pm);var qm=Ba.z;null!=qm&&(Mc.NumericEvaluatedValuesMismatchSamples=
qm);var Vj=Ba.ba;null!=Vj&&(Mc.NumericFormattedTextMismatchSamples=Vj);var Wj=Ba.bb;null!=Wj&&(Mc.NumericMismatchSamples=Wj);var Xj=Ba.bc;null!=Xj&&(Mc.CellValueTypeMismatchSamples=Xj);var Yj=Ba.bd;null!=Yj&&(Mc.IfmtMismatchSamples=Yj);var Zj=Ba.be;null!=Zj&&(Mc.BlockHashCode=Zj);break;case 48:Gf="DataValidationEditOpenDialog";var ak=Ba.a;null!=ak&&(Mc.ServerCommand=ak);var tm=null==Ba.b?null:Ba.b.toString();null!=tm&&(Mc.SubDialogOpened=tm);var rm=Ba.c;null!=rm&&(Mc.SubDialogButtonClicked=rm);var bk=
null==Ba.d?null:Ba.d.toString();null!=bk&&(Mc.DialogOpened=bk);var ck=Ba.e;null!=ck&&(Mc.RuleType=ck);var dk=Ba.f;null!=dk&&(Mc.ConditionType=dk);var ek=null==Ba.g?null:Ba.g.toString();null!=ek&&(Mc.LowerBoundaryFilled=ek);var fk=null==Ba.h?null:Ba.h.toString();null!=fk&&(Mc.UpperBoundaryFilled=fk);var gk=null==Ba.i?null:Ba.i.toString();null!=gk&&(Mc.IgnoreBlank=gk);var hk=null==Ba.j?null:Ba.j.toString();null!=hk&&(Mc.InCellDropdown=hk);var ik=null==Ba.k?null:Ba.k.toString();null!=ik&&(Mc.ShowInputMessage=
ik);var jk=null==Ba.l?null:Ba.l.toString();null!=jk&&(Mc.InputTitleFilled=jk);var zm=null==Ba.m?null:Ba.m.toString();null!=zm&&(Mc.InputMessageFilled=zm);var Am=null==Ba.n?null:Ba.n.toString();null!=Am&&(Mc.ShowErrorAlert=Am);var Bm=null==Ba.o?null:Ba.o.toString();null!=Bm&&(Mc.AlertBlocking=Bm);var Cm=null==Ba.p?null:Ba.p.toString();null!=Cm&&(Mc.AlertTitleFilled=Cm);var Dm=null==Ba.q?null:Ba.q.toString();null!=Dm&&(Mc.AlertMessageFilled=Dm);var Em=Ba.r;null!=Em&&(Mc.StopWatchId=Em);break;case 49:Gf=
"DataValidationEditSubmitRule";var Fm=Ba.a;null!=Fm&&(Mc.RuleType=Fm);var Gm=Ba.b;null!=Gm&&(Mc.ConditionType=Gm);var Hm=null==Ba.c?null:Ba.c.toString();null!=Hm&&(Mc.LowerBoundaryFilled=Hm);var Im=null==Ba.d?null:Ba.d.toString();null!=Im&&(Mc.UpperBoundaryFilled=Im);var Jm=null==Ba.e?null:Ba.e.toString();null!=Jm&&(Mc.IgnoreBlank=Jm);var Km=null==Ba.f?null:Ba.f.toString();null!=Km&&(Mc.InCellDropdown=Km);var Lm=null==Ba.g?null:Ba.g.toString();null!=Lm&&(Mc.ShowInputMessage=Lm);var Mm=null==Ba.h?
null:Ba.h.toString();null!=Mm&&(Mc.InputTitleFilled=Mm);var Nm=null==Ba.i?null:Ba.i.toString();null!=Nm&&(Mc.InputMessageFilled=Nm);var Om=null==Ba.j?null:Ba.j.toString();null!=Om&&(Mc.ShowErrorAlert=Om);var Pm=null==Ba.k?null:Ba.k.toString();null!=Pm&&(Mc.AlertBlocking=Pm);var Qm=null==Ba.l?null:Ba.l.toString();null!=Qm&&(Mc.AlertTitleFilled=Qm);var Rm=null==Ba.m?null:Ba.m.toString();null!=Rm&&(Mc.AlertMessageFilled=Rm);var Sm=null==Ba.n?null:Ba.n.toString();null!=Sm&&(Mc.ClearAllPressed=Sm);var Tm=
Ba.o;null!=Tm&&(Mc.ActionStatus=Tm);var Um=Ba.p;null!=Um&&(Mc.Error=Um);var Vm=Ba.q;null!=Vm&&(Mc.StopWatchId=Vm);break;case 50:Gf="CustomSort";var Wm=Ba.a;null!=Wm&&(Mc.RangeType=Wm);var Xm=null==Ba.b?null:Ba.b.toString();null!=Xm&&(Mc.HasHeaders=Xm);var Ym=null==Ba.c?null:Ba.c.toString();null!=Ym&&(Mc.SortTopToBottom=Ym);var Zm=null==Ba.d?null:Ba.d.toString();null!=Zm&&(Mc.ColumnCount=Zm);var $m=null==Ba.e?null:Ba.e.toString();null!=$m&&(Mc.RowCount=$m);var an=null==Ba.f?null:Ba.f.toString();null!=
an&&(Mc.RangeLimitExceeded=an);var bn=null==Ba.g?null:Ba.g.toString();null!=bn&&(Mc.CaseSensitive=bn);var cn=null==Ba.h?null:Ba.h.toString();null!=cn&&(Mc.GetSortInfoDuration=cn);var dn=null==Ba.i?null:Ba.i.toString();null!=dn&&(Mc.LevelCount=dn);var en=null==Ba.j?null:Ba.j.toString();null!=en&&(Mc.SortOnValuesCount=en);var fn=null==Ba.k?null:Ba.k.toString();null!=fn&&(Mc.SortOnCellColorCount=fn);var gn=null==Ba.l?null:Ba.l.toString();null!=gn&&(Mc.SortOnFontColorCount=gn);var hn=null==Ba.m?null:
Ba.m.toString();null!=hn&&(Mc.SortOnIconCount=hn);var jn=null==Ba.n?null:Ba.n.toString();null!=jn&&(Mc.CustomOrderCount=jn);var kn=null==Ba.o?null:Ba.o.toString();null!=kn&&(Mc.AvgCellColorCount=kn);var ln=null==Ba.p?null:Ba.p.toString();null!=ln&&(Mc.MaxCellColorCount=ln);var mn=null==Ba.q?null:Ba.q.toString();null!=mn&&(Mc.AvgFontColorCount=mn);var nn=null==Ba.r?null:Ba.r.toString();null!=nn&&(Mc.MaxFontColorCount=nn);var on=null==Ba.s?null:Ba.s.toString();null!=on&&(Mc.AvgIconsCount=on);var pn=
null==Ba.t?null:Ba.t.toString();null!=pn&&(Mc.MaxIconsCount=pn);var qn=null==Ba.u?null:Ba.u.toString();null!=qn&&(Mc.Executed=qn);break;case 51:Gf="NamedSheetViewUserAction";var rn=Ba.a;null!=rn&&(Mc.UserSessionId=rn);var sn=Ba.b;null!=sn&&(Mc.UserActionName=sn);var tn=null==Ba.c?null:Ba.c.toString();null!=tn&&(Mc.UserActionSource=tn);var un=Ba.d;null!=un&&(Mc.UserActionData=un);var vn=Ba.e;null!=vn&&(Mc.OtherData=vn);break;case 52:Gf="NamedSheetViewTeachingCallout";var wn=Ba.a;null!=wn&&(Mc.UserSessionId=
wn);var xn=null==Ba.b?null:Ba.b.toString();null!=xn&&(Mc.TeachingCalloutSequence=xn);var yn=null==Ba.c?null:Ba.c.toString();null!=yn&&(Mc.TeachingCalloutIndex=yn);var zn=null==Ba.d?null:Ba.d.toString();null!=zn&&(Mc.UserActionName=zn);var An=Ba.e;null!=An&&(Mc.UserActionData=An);var Bn=null==Ba.f?null:Ba.f.toString();null!=Bn&&(Mc.DurationInMs=Bn);break;case 53:Gf="NamedSheetViewTeachingDialog";var Cn=Ba.a;null!=Cn&&(Mc.UserSessionId=Cn);var Dn=Ba.b;null!=Dn&&(Mc.UserActionName=Dn);var En=Ba.c;null!=
En&&(Mc.ButtonClicked=En);var Fn=null==Ba.d?null:Ba.d.toString();null!=Fn&&(Mc.DurationInMs=Fn);var Gn=null==Ba.e?null:Ba.e.toString();null!=Gn&&(Mc.IsNewTeachingDialog=Gn);break;case 54:Gf="NamedSheetViewOptionsDialog";var Hn=Ba.a;null!=Hn&&(Mc.UserSessionId=Hn);var In=null==Ba.b?null:Ba.b.toString();null!=In&&(Mc.OptionsAction=In);var Jn=Ba.c;null!=Jn&&(Mc.OptionsActionData=Jn);var Kn=Ba.d;null!=Kn&&(Mc.OptionsOtherData=Kn);var Ln=null==Ba.e?null:Ba.e.toString();null!=Ln&&(Mc.DurationInMs=Ln);break;
case 55:Gf="NamedSheetViewTempViewApplyDialog";var Mn=Ba.a;null!=Mn&&(Mc.UserSessionId=Mn);var Nn=Ba.b;null!=Nn&&(Mc.TriggeredFrom=Nn);var On=Ba.c;null!=On&&(Mc.ButtonClicked=On);var Pn=null==Ba.d?null:Ba.d.toString();null!=Pn&&(Mc.DurationInMs=Pn);break;case 56:Gf="NamedSheetViewTempViewSaveDialog";var Qn=Ba.a;null!=Qn&&(Mc.UserSessionId=Qn);var Rn=Ba.b;null!=Rn&&(Mc.TriggeredFrom=Rn);var Sn=Ba.c;null!=Sn&&(Mc.ButtonClicked=Sn);var Tn=null==Ba.d?null:Ba.d.toString();null!=Tn&&(Mc.NameUpdated=Tn);
var Un=null==Ba.e?null:Ba.e.toString();null!=Un&&(Mc.DurationInMs=Un);break;case 57:Gf="TemporaryViewStartedDataRestore";var Vn=Ba.a;null!=Vn&&(Mc.UserSessionId=Vn);var Wn=null==Ba.b?null:Ba.b.toString();null!=Wn&&(Mc.CountOfTempViews=Wn);break;case 58:Gf="TemporaryViewFetchedVersion";var Xn=Ba.a;null!=Xn&&(Mc.UserSessionId=Xn);var Yn=null==Ba.b?null:Ba.b.toString();null!=Yn&&(Mc.NumberOfBytes=Yn);break;case 59:Gf="RaiseEventsAndGenerateBlockRequests";var Zn=null==Ba.a?null:Ba.a.toString();null!=
Zn&&(Mc.ReturnContentStatus=Zn);var $n=null==Ba.b?null:Ba.b.toString();null!=$n&&(Mc.CacheState=$n);var ao=null==Ba.c?null:Ba.c.toString();null!=ao&&(Mc.FromXhrCallback=ao);var bo=null==Ba.d?null:Ba.d.toString();null!=bo&&(Mc.AreGeneralErrorsPresent=bo);var co=Ba.e;null!=co&&(Mc.BlockCacheItemHash=co);var eo=Ba.f;null!=eo&&(Mc.StopwatchId=eo);var fo=Ba.g;null!=fo&&(Mc.BlockCacheItemProcessingStopwatchId=fo);var go=null==Ba.h?null:Ba.h.toString();null!=go&&(Mc.StateId=go);var ho=null==Ba.i?null:Ba.i.toString();
null!=ho&&(Mc.IsHighPriority=ho);var io=null==Ba.j?null:Ba.j.toString();null!=io&&(Mc.CalcComplete=io);var jo=null==Ba.k?null:Ba.k.toString();null!=jo&&(Mc.EditedCellsUpdatedByCse=jo);var ko=null==Ba.l?null:Ba.l.toString();null!=ko&&(Mc.DependentCellsUpdatedByCse=ko);var lo=null==Ba.m?null:Ba.m.toString();null!=lo&&(Mc.Revision=lo);var mo=null==Ba.n?null:Ba.n.toString();null!=mo&&(Mc.SheetProcessedDataVersion=mo);var no=null==Ba.o?null:Ba.o.toString();null!=no&&(Mc.RefCount=no);var oo=null==Ba.p?
null:Ba.p.toString();null!=oo&&(Mc.ExistsInView=oo);var po=null==Ba.q?null:Ba.q.toString();null!=po&&(Mc.ContentSource=po);break;case 60:Gf="LaunchMakerCodeEditor";var qo=Ba.a;null!=qo&&(Mc.SessionId=qo);var ro=Ba.b;null!=ro&&(Mc.Command=ro);var so=null==Ba.c?null:Ba.c.toString();null!=so&&(Mc.IsPreviewGallery=so);var to=Ba.d;null!=to&&(Mc.MenuItemId=to);var uo=Ba.e;null!=uo&&(Mc.ScriptId=uo);var vo=Ba.f;null!=vo&&(Mc.ShareId=vo);var wo=null==Ba.g?null:Ba.g.toString();null!=wo&&(Mc.IsOwner=wo);var xo=
null==Ba.h?null:Ba.h.toString();null!=xo&&(Mc.PublishedScriptCount=xo);var yo=null==Ba.i?null:Ba.i.toString();null!=yo&&(Mc.RecentScriptCount=yo);var zo=null==Ba.j?null:Ba.j.toString();null!=zo&&(Mc.WorkbookScriptCount=zo)}Mc.Table=Gf;var Eo=Sys.Serialization.JavaScriptSerializer.serialize(Mc);Ld.call(nd,3704927,0,50,Eo)}}catch(Mc){e.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${xa} exception: ${Mc}`)}}q$c(xa,Ba,pc){if(this.Nrc){const nd=this.ZXa[xa+Ba];nd&&(nd.e=pc,this.Ecd(nd));
delete this.ZXa[xa+Ba]}}Gwd(xa,Ba){l[xa]in this.rsf||this.Qe(xa,Ba)}u2i(){this.Ph.appStart&&this.mag(gd.NFd,this.Ph.appStart)}VBi(xa){const Ba={};Ba.a=xa.i;Ba.b=xa.o;Ba.c=xa.t;Ba.d=yd.a(xa.s,xa.p||this.Ph.appStart);Ba.e=yd.a(xa.e,xa.s);Ba.f=xa.c;Ba.g=xa.a;Ba.h=xa.h;this.Qe(0,Ba,this.Cpi(Ba.b,Ba.c))}Cpi(xa,Ba){return["CommandTask","QueuedTask","Task"].includes(xa)&&!this.CCh.includes(Ba)?!1:!0}PA(xa,Ba,pc,nd,Ld=!0){if(xa&&Ba){const te={};te.a=xa;te.b=Ba;te.c=pc.toString();te.d=nd.toString();this.Qe(15,
te,Ld)}}bsf(xa,Ba,pc,nd){const Ld={};xa&&(Ld.c=yd.a(xa,this.Ph.appStart));Ld.b=Ba;Ld.a=pc;Ld.d=nd;this.Qe(17,Ld)}dispose(){this.LRa.execute(xa=>{xa.deactivate(!0);xa.Igj(this.VGf)});this.De&&this.De.Bcb(this.gW);super.dispose()}O8e(){return this.Wlg=this.Wlg||new Yd}mJe(xa,Ba,pc=null,nd=null,Ld=null){const te={};te.o=xa;te.t=Ba;te.p=Ld;te.s=nd||this.Ph.we;this.nod(te,pc);return te}oFe(xa,Ba=null){xa&&(xa.e=Ba||this.Ph.we,xa.i=xa.i||this.G1a.M9a(),xa.c=xa.c||this.QJe,xa.a=xa.a||this.$Je,xa.h=void 0!==
xa.h&&null!==xa.h?xa.h:this.De?this.De.si:!1,this.Ecd(xa))}jsf(xa){const Ba=xa.context;xa.duration>gd.Roh&&(Ba.methodName===Zc.a.Kxb||Ba.methodName===Zc.a.fwa)&&this.Avc(1,gd.u_h);if("GetSessionStatus"!==Ba.methodName){const pc={};pc.a=Ba.methodName;pc.b=Ba.stopwatch.id;pc.c=xa.Lvc;pc.d=xa.responseSize;pc.e=Ba.aIa;pc.f=xa.nd?xa.nd.StateId:Zc.a.g0d;this.Qe(30,pc,!0);this.PA(pc.b,xa.nd.ServerCorrelationId,"clientWebRequests","ServerActions")}}fbg(){if(this.Nrc){const xa=this.ZXa.LoadingUIShownSplashScreen;
xa&&qb.PageLoadTrackingInfo.instance.Twj(xa.s)}}Avc(xa,Ba){this.Akg.HKb(xa,Ba,null)}pXf(xa,Ba=null){this.NEc.qkj(xa,Ba)}oXf(xa,Ba,pc=null){this.NEc.pkj(xa,Ba,pc)}qXf(xa){this.NEc.LKb(xa,null)}rXf(xa,Ba){this.NEc.HKb(xa,Ba,null)}xvc(xa,Ba,pc=null){this.Tgb.xvc(xa,Ba,pc)}Evc(xa,Ba,pc=null){this.Tgb.Evc(xa,Ba,pc)}sendDNMTraceTag(xa,Ba,pc,nd,...Ld){Na.EwaSettings.ma(215)&&e.ULS.sendTraceTag.apply(null,[xa,Ba,pc,nd].concat(Ld))}lMb(xa,Ba,pc,nd,Ld,te,af,...Bf){this.Tgb.lMb(xa,Ba,pc,nd,Ld,te,af,...Bf)}nMb(xa,
Ba,pc,nd,Ld,te){this.Tgb.nMb(xa,Ba,pc,nd,Ld,te)}mMb(xa,Ba,pc,nd,Ld,te,...af){this.Tgb.mMb(xa,Ba,pc,nd,Ld,te,...af)}oMb(xa,Ba,pc,nd,Ld,te){this.Akg.oMb(xa,Ba,pc,nd,Ld,te)}yxc(xa,Ba,pc,nd){this.Tgb.yxc(xa,Ba,pc,nd)}Ecd(xa){this.FLj.VBi(xa)}v2i(){if(this.Nrc){Stw.swpc=null;const xa=this.Nrc;for(let Ba in xa)this.nod(xa[Ba])}}DFh(){const xa=window[qc.a.namespace];if(xa){const Ba=xa[qc.a.vEe];Ba&&(delete xa[qc.a.vEe],Ba.forEach(pc=>{this.nod(pc);this.Ecd(pc)}))}}Tqi(xa,Ba){if("about:blank"===xa||"renamehandler.ashx"===
Ba&&"2"===y.a.iy(xa,"u"))return!0;for(xa=0;xa<this.ONd.length;xa++)if(Ba.endsWith(this.ONd[xa]))return!0;return!1}szi(){this.LRa.execute(xa=>{xa.Xh(gd.FTg,0);xa.oLg(this.VGf);xa.activate()})}lzi(){const xa={};xa.a=new Date(Ya.EcmaDateClock.instance.appStart.m);xa.b=this.userSessionId;xa.c=this.Ph.Ydg;xa.d=gd.Jih*m.devicePixelRatio;xa.e=ya.a.Qa.appStart.m;this.Qe(14,xa,!0);this.Nla(ya.a.Qa.appStart.m,Object(S.a)(z.a.instance,z.a.instance.Naj,"recordAppInitStart"))}mag(xa,Ba){this.Pgb=this.G1a.M9a();
this.UQb=this.G1a.M9a();this.PDa=xa;this.uOb("UserAction",xa,this.UQb,Ba);this.drf(xa,this.Pgb)}LNj(){const xa=window[qc.a.namespace];xa&&!gd.AHe&&(xa[qc.a.AKj]=(Ba,pc)=>this.mJe(Ba,pc),xa[qc.a.Zqh]=Ba=>{this.oFe(Ba)},gd.AHe=!0)}kWj(xa){const Ba=Ud.kXg(xa.o,xa.t),pc=new Ud(yd.a(xa.e,xa.s)),nd=Ba in this.zXd?this.zXd[Ba].x5g(pc):pc;this.zXd[Ba]=nd;if(pc===nd||pc.average!==nd.average)xa=Object(Bb.a)(new Jd,{operation:xa.o,target:xa.t,sIi:nd.average,sender:this}),this.raiseEvent(Ba,xa)}drf(xa,Ba){const pc=
{};pc.a=Ba;pc.b=this.userSessionId;pc.c=xa;this.Qe(1,pc,!0)}afi(){this.ONd=[Zc.a.rej,Zc.a.getSessionStatus,Zc.a.fwa,Zc.a.l5g,Zc.a.c2g,Zc.a.Igb,Zc.a.ldc,Zc.a.getObjectMetadata,Zc.a.setRichTextCell,Zc.a.kwa,Zc.a.r_j,Zc.a.pollSessionStatus,Zc.a.o2h,Zc.a.z0h,Zc.a.KVh]}nod(xa,Ba=null){xa.i=Ba||this.G1a.M9a();xa.a=this.$Je;xa.c=this.QJe;xa.h=this.De?this.De.si:!1}static la(xa){var Ba=new uf;xa.da.Ga(291,Ba);Ba=new gd(xa.va.UserSessionId,void 0,void 0,void 0,Ba,!0);Ba.drf(gd.jxf,Ba.JKe);e.ULS.sendTraceTag(524166239,
0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Ba.szi();Ba.LNj();Ba.u2i();Ba.lzi();Ba.DFh();Ba.v2i();Ba.afi();gd.Juj(xa);ud.a.Tl.Ga(41,Ba)}static Juj(xa){const Ba=m.devicePixelRatio;1<Ba&&xa.dc.kx(!0,2<=Ba?8388608:4194304)}}gd.jxf="UnassignedUserAction";gd.NFd="PageLoad";gd.xkd="GridUpdateOperation";gd.Roh=5E3;gd.u_h="MoreThan_5000_Ms";gd.Jih=96;gd.FTg=30;gd.AHe=!1;Object(b.a)(gd,"TelemetryManager",pe.a,[452,453,454,455]);var Td=a(200),he=a(104);class Md{constructor(xa,
Ba,pc){this.v1j=xa;this.ZU=Ba;this.name=pc}}Object(b.a)(Md,"Validation",null,[]);class we{constructor(xa){this.Mca=()=>{this.ULf(this.DYe)};this.Ij=()=>{this.ULf(this.NUg)};this.$=xa;this.NUg=new bb.a;this.DYe=new bb.a;Lb.h(this.$).Da.hw(this.Ij);Lb.h(this.$).Da.VWc(this.Mca)}zWc(xa,Ba,pc,nd,Ld){if(xa&&nd){const te=Td.a.xz(Ba,pc);this.B_b(()=>!!he.a(xa).Qq(te),nd.StateId,Ld)}}B_b(xa,Ba,pc){this.dKg(this.DYe,xa,Ba,pc)}dKg(xa,Ba,pc,nd){xa&&Ba&&pc!==Zc.a.re&&xa.add(new Md(Ba,pc,nd))}ULf(xa){if(xa){var Ba=
new bb.a;for(let pc of xa){if(pc.ZU===this.$.ea.ze)try{pc.v1j()||e.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${pc.name}]`)}catch(nd){e.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${pc.name}]. Exception: [${nd}]`)}Ba.add(pc)}for(let pc of Ba)xa.remove(pc)}else e.ULS.shipAssertTag(537151011,0,!!xa,
"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Lb.h(this.$)&&Lb.h(this.$).Da&&(Lb.h(this.$).Da.ex(this.Ij),Lb.h(this.$).Da.aKb(this.Mca));this.$=null}static la(xa){const Ba=new we(xa);xa.da.Ga(277,Ba)}}Object(b.a)(we,"ValidationTelemetryManager",null,[451,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");r.main();Type.registerNamespace("CNT");P.main();Type.registerNamespace("CACPU");fb.main();Type.registerNamespace("Common.App.EventsCacheManager");
hb.main();(()=>{fc.a.Fa(xa=>{xa.da.Ga(137,new wa(xa))})})();(()=>{fc.a.Fa(xa=>{xa.da.Ga(37,new Yb(xa))})})();(()=>{fc.a.Fa(xa=>{Sb.la(xa)})})();(()=>{fc.a.Fa(xa=>{Rc.la(xa)})})();(()=>{fc.a.Fa(xa=>{Gd.la(xa)})})();(()=>{fc.a.Fa(xa=>{xa.da.Ga(40,new Zd(xa,new Oa.a(()=>yb.GetServiceTaskFactory.create(xa.da,137,xa.ka,1))))})})();(()=>{fc.a.Fa(xa=>{xa.da.Ga(276,new Jc(xa))})})();(()=>{fc.a.Fa(xa=>{ud.a.Tl.$a(135,()=>{gd.la(xa);Od.la(xa);we.la(xa);Uc.la(xa);Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",
!1)||Yc(xa);oe.la(xa);Ja.la(xa);dd.RenderingFidelityTracker.la(xa)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tm.js.map/b914d288bb95f1095311e7568404d3b0/EwaDSEsNext.tm.js.map